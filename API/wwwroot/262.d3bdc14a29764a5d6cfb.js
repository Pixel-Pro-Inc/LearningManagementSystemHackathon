"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[262],{9262:(la,xn,Ne)=>{Ne.r(xn),Ne.d(xn,{DocModule:()=>Qs});var ni=Ne(8583),lo=Ne(4762),Fe=Ne(639),Mt=Ne(1177),a=Ne(1727),tt=Ne(8386),se=Ne(8760),M=Ne(1355),pt=Ne(707),J=Ne(3773),Te=Ne(1155),ho=Ne(7409),Ue=Ne(4811),ri=Ne(310),ke=Ne(5509),co=Ne(4062);ke.kL2.Inject(ke.f62,ke.yXf,ke.QG9,ke.fWg,ke.gtc,ke.H$u,ke.nCZ,ke.FnG,ke.sZs,ke.ou1,ke.dXD,ke.f5i,ke.ehF,ke.b40,ke.W5V,ke.iXV,ke.s1u,ke.wEc,ke.WDG,ke.DeQ,ke.ua7,ke.D7U),ke.WCS.Inject(ke.prM,ke.fWg,ke.V_J,ke.w3Q);var s,uo=function(){function s(){}return s.prototype.chartRender=function(e){this.chartType=e.chartType,this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType;var t=this.chartData(e,this.chartType),i={enableAnimation:!1,width:e.width*(96/72)+"px",height:e.height*(96/72)+"px"};this.isPieType?this.chart=new ke.WCS(i):(this.chart=new ke.kL2(i),this.chart.primaryXAxis=this.chartPrimaryXAxis(e.chartPrimaryCategoryAxis,this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(e.chartPrimaryValueAxis)),this.chart.series=this.chartSeries(e.chartSeries,t,this.chartType);for(var n=0;n<this.chart.series.length;n++)this.chart.series[n].animation.enable=!1;this.chart.title=e.chartTitle,this.chart.legendSettings=this.parseChartLegend(e.chartLegend)},s.prototype.convertChartToImage=function(e,t,i){var n=this;return new Promise(function(o,l){var h=0,d=0,c=n.getControlsValue([e],t,i);h=h||c.width,d=d||c.height;var u=(0,a.az)("canvas"),p=Math.max(1,window.devicePixelRatio||1);u.width=h*p,u.height=d*p,u.style.width=h+"px",u.style.height=d+"px";var f=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(c.svg)],{type:"image/svg+xml"})),g=new Image,m=u.getContext("2d");m.scale(p,p),g.onload=function(){m.drawImage(g,0,0),window.URL.revokeObjectURL(f);var v=u.toDataURL("image/png");o(v)},g.onerror=function(){l("Invalid data")},g.src=f})},s.prototype.getControlsValue=function(e,t,i){var n=0,r=0,l=new co.jz("").createSvg({id:"Image_Export",width:200,height:200});return e.map(function(h){if(h){var d=h.svgObject.cloneNode(!0),c=h.renderer.createGroup({style:"transform: translateY("+r+"px)"});c.appendChild(d),n=Math.max(h.availableSize.width,t),r+=h.availableSize.height,l.appendChild(c)}}),l.setAttribute("width",n+""),l.setAttribute("height",r+""),{width:n,height:r,svg:l}},s.prototype.officeChartType=function(e){var t="";switch(e){case"Area_Stacked":t="StackingArea";break;case"Area":t="Area";break;case"Area_Stacked_100":t="StackingArea100";break;case"Bar_Clustered":t="Bar";break;case"Bar_Stacked":t="StackingBar";break;case"Bar_Stacked_100":t="StackingBar100";break;case"Column_Clustered":t="Column";break;case"Column_Stacked":t="StackingColumn";break;case"Column_Stacked_100":t="StackingColumn100";break;case"Scatter_Markers":t="Scatter";break;case"Bubble":t="Bubble";break;case"Doughnut":case"Pie":t="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":t="StackingLine100";break;case"Line":case"Line_Markers":t="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":t="StackingLine"}return t},s.prototype.chartSeries=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var l=this.writeChartSeries(e[r],t,i,r);n.push(l)}return n},s.prototype.writeChartSeries=function(e,t,i,n){var h,r=this.officeChartType(i),o=e.dataPoints[n],l={};if(l.type=r,l.dataSource=t,l.name=e.seriesName,l.xName="x",l.yName="y"+n,"Bubble"===i&&(l.size="size"+n),this.isPieType?(l.pointColorMapping="color","Doughnut"===i&&(l.innerRadius="75%",l.radius="70%")):((0,a.le)(o)&&(o=e.dataPoints[0]),h=this.chartFormat(o,r),l.fill=h,(0,a.le)(o.fill.foreColor)||(l.pointColorMapping="color")),("Line_Markers"===i||"Line_Markers_Stacked"===i||"Line_Markers_Stacked_100"===i)&&(l.marker={visible:!0}),e.hasOwnProperty("dataLabel"))if(this.isPieType)l.dataLabel=this.parseDataLabels(e.dataLabel);else{var d={};d.dataLabel=this.parseDataLabels(e.dataLabel),l.marker=d}if(e.hasOwnProperty("errorBar")&&(l.errorBar=this.parseErrorBars(e.errorBar)),e.hasOwnProperty("trendLines"))for(var u=e.trendLines,p=[],f=0;f<u.length;f++){var m;m=this.parseTrendLines(u[f],h),p.push(m),l.trendlines=p}return l},s.prototype.parseDataLabels=function(e){var t={visible:!0};return t.position=this.isPieType?"BestFit"===e.position||"Inside"===e.position?"Inside":"Outside":this.dataLabelPosition(e.position),t},s.prototype.parseErrorBars=function(e){var t={visible:!0};return t.type=e.type,t.direction=e.direction,t.errorBarCap="Cap"===e.endStyle?{width:1}:{width:0},t},s.prototype.parseTrendLines=function(e,t){var i={};return i.type=e.type,i.name=e.name,i.forwardForecast=e.forward,i.backwardForecast=e.backward,i.intercept="NaN"===e.intercept?0:e.intercept,i.fill=t,i},s.prototype.dataLabelPosition=function(e){var t="Auto";switch(e){case"Outside":t="Outer";break;case"Center":t="Middle";break;case"Inside":t="Top";break;case"OutsideBase":t="Bottom"}return t},s.prototype.chartFormat=function(e,t){return"Line"===t||"StackingLine"===t||"StackingLine100"===t?e.line.rgb:e.fill.rgb},s.prototype.chartPrimaryXAxis=function(e,t){var i={};e.chartTitle&&(i.title=e.chartTitle);var n=this.chartCategoryType(e.categoryType);return i.valueType=n,"DateTime"===n&&(i.intervalType="Days",i.labelFormat="M/d/yyyy",i.edgeLabelPlacement="Shift"),("Scatter_Markers"===t||"Bubble"===t)&&this.checkAndSetAxisValue(i,e),e.hasMajorGridLines&&(i.majorGridLines={width:1}),e.hasMinorGridLines&&(i.minorTicksPerInterval=4),i},s.prototype.chartCategoryType=function(e){var t="";switch(e){case"Time":t="DateTime";break;case"Automatic":t="Category"}return t},s.prototype.chartPrimaryYAxis=function(e){var t={};return e.chartTitle&&(t.title=e.chartTitle),this.checkAndSetAxisValue(t,e),e.hasMajorGridLines&&(t.majorGridLines={width:1}),e.hasMinorGridLines&&(t.minorTicksPerInterval=4),t},s.prototype.checkAndSetAxisValue=function(e,t){0!==t.minimumValue&&(e.minimum=t.minimumValue),0!==t.maximumValue&&(e.maximum=t.maximumValue),0!==t.majorUnit&&(e.interval=t.majorUnit)},s.prototype.chartData=function(e,t){for(var i=e.chartCategory,n=[],r=0;r<i.length;r++){var l=this.chartPlotData(i[r],e,t,r);n.push(l)}return n},s.prototype.chartPlotData=function(e,t,i,n){var r={},o=t.chartSeries;if("m/d/yyyy"===t.chartPrimaryCategoryAxis.numberFormat){var h=e.categoryXName.split("/"),d=Number(h[0]),c=Number(h[1]),u=Number(h[2]);r.x=new Date(u,d-1,c)}else r.x=e.categoryXName;for(var p=0;p<o.length;p++){var f=e.chartData[p];if(r["y"+p]=f.yValue,"Bubble"===i&&(r["size"+p]=f.size),"Pie"===t.chartType||"Doughnut"===t.chartType||"Column_Stacked"===t.chartType){var g=o[p],m=g.dataPoints.find(function(v){return v.id===n});(0,a.le)(m)?g.dataPoints.length>1&&0===g.dataPoints[n].id?r.color=this.chartFormat(m=g.dataPoints[n],i):!(0,a.le)(g.seriesFormat)&&!(0,a.le)(g.seriesFormat.fill)&&g.seriesFormat.fill.rgb.length>7&&(r.color=this.getColor(g.seriesFormat.fill.rgb)):r.color=this.chartFormat(m,i)}}return r},s.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},s.prototype.parseChartLegend=function(e){var t={},i=e.position;return"Corner"===i&&(i="right"),i?(t.visible=!0,t.position=i.charAt(0).toUpperCase()+i.slice(1)):t.visible=!1,t},s.prototype.destroy=function(){this.chart&&this.chart.destroy(),this.chart=void 0},s}(),Ie=Ne(4295),We=Ne(3041),z=(()=>{return(s=z||(z={}))[s.LeftToRight=0]="LeftToRight",s[s.RightToLeft=1]="RightToLeft",s[s.WordSplit=2]="WordSplit",s[s.Number=4]="Number",s[s.Tab=6]="Tab",z;var s})(),Qe=(()=>{return(s=Qe||(Qe={}))[s.English=0]="English",s[s.Hindi=1]="Hindi",s[s.Korean=2]="Korean",s[s.Chinese=3]="Chinese",s[s.Arabic=4]="Arabic",s[s.Hebrew=5]="Hebrew",s[s.Japanese=6]="Japanese",Qe;var s})(),U=function(){function s(){this.keysInternal=[],this.valuesInternal=[]}return Object.defineProperty(s.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),s.prototype.add=function(e,t){if((0,a.le)(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},s.prototype.get=function(e){if((0,a.le)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(!(t<0||t>this.keysInternal.length-1))return this.valuesInternal[t]},s.prototype.set=function(e,t){if((0,a.le)(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[i]=t},s.prototype.remove=function(e){if((0,a.le)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},s.prototype.containsKey=function(e){if((0,a.le)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return!(t<0||t>this.keysInternal.length-1)},s.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},s.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},s}(),ne=function(){function s(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new U}return s.prototype.isEqual=function(e,t,i){var n=!1;switch(this.uniqueFormatType){case 1:n=this.isBorderEqual(e,t,i);break;case 2:n=this.isCharacterFormatEqual(e,t,i);break;case 3:n=this.isParagraphFormatEqual(e,t,i);break;case 4:n=this.isCellFormatEqual(e,t,i);break;case 5:n=this.isShadingEqual(e,t,i);break;case 6:n=this.isRowFormatEqual(e,t,i);break;case 7:n=this.isListFormatEqual(e,t,i);break;case 8:n=this.isTableFormatEqual(e,t,i);break;case 9:n=this.isListLevelEqual(e,t,i);break;case 10:n=this.isSectionFormatEqual(e,t,i)}return n},s.prototype.isNotEqual=function(e,t,i,n,r){var o=void 0,l=s.getPropertyType(r,e);this.propertiesHash.containsKey(l)&&(o=this.propertiesHash.get(l));var h=void 0;return e===i?h=n:t.containsKey(l)&&(h=t.get(l)),!(o===h||!(0,a.le)(o)&&!(0,a.le)(h)&&o===h)},s.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t)}return i},s.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:"leftMargin"===e?11:"topMargin"===e?12:"bottomMargin"===e?13:"rightMargin"===e?14:"leftIndent"===e?15:0},s.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:0},s.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:"bidi"===e?10:"allowAutoFit"===e?11:"horizontalPositionAbs"===e?12:"horizontalPosition"===e?13:0},s.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:0},s.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},s.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},s.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},s.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:"bidi"===e?10:"bdo"===e?11:"boldBidi"===e?12:"italicBidi"===e?13:"fontFamilyBidi"===e?14:"fontSizeBidi"===e?15:"allCaps"===e?16:"localeIdBidi"===e?17:"complexScript"===e?18:0},s.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:"bidi"===e?10:"contextualSpacing"===e?11:"keepWithNext"===e?12:"keepLinesTogether"===e?13:"widowControl"===e?14:"spaceBeforeAuto"===e?15:"spaceAfterAuto"===e?16:0},s.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:"bidi"===e?11:"restartPageNumbering"===e?12:"pageStartingNumber"===e?13:"endnoteNumberFormat"===e?14:"endnotePosition"===e?15:"footNoteNumberFormat"===e?16:"footnotePosition"===e?17:"restartIndexForEndnotes"===e?18:"restartIndexForFootnotes"===e?19:"initialFootNoteNumber"===e?20:"initialEndNoteNumber"===e?21:"pageNumberStyle"===e?22:0},s.prototype.isBorderEqual=function(e,t,i){return!(this.isNotEqual("color",e,t,i,1)||this.isNotEqual("lineStyle",e,t,i,1)||this.isNotEqual("lineWidth",e,t,i,1)||this.isNotEqual("shadow",e,t,i,1)||this.isNotEqual("space",e,t,i,1)||this.isNotEqual("hasNoneStyle",e,t,i,1))},s.prototype.isCharacterFormatEqual=function(e,t,i){return!(this.isNotEqual("fontColor",e,t,i,2)||this.isNotEqual("fontFamily",e,t,i,2)||this.isNotEqual("fontSize",e,t,i,2)||this.isNotEqual("bold",e,t,i,2)||this.isNotEqual("italic",e,t,i,2)||this.isNotEqual("underline",e,t,i,2)||this.isNotEqual("strikethrough",e,t,i,2)||this.isNotEqual("baselineAlignment",e,t,i,2)||this.isNotEqual("highlightColor",e,t,i,2)||this.isNotEqual("bidi",e,t,i,2)||this.isNotEqual("bdo",e,t,i,2)||this.isNotEqual("fontColor",e,t,i,2)||this.isNotEqual("fontFamilyBidi",e,t,i,2)||this.isNotEqual("fontSizeBidi",e,t,i,2)||this.isNotEqual("boldBidi",e,t,i,2)||this.isNotEqual("italicBidi",e,t,i,2)||this.isNotEqual("allCaps",e,t,i,2)||this.isNotEqual("localeIdBidi",e,t,i,2)||this.isNotEqual("complexScript",e,t,i,2))},s.prototype.isParagraphFormatEqual=function(e,t,i){return!(this.isNotEqual("leftIndent",e,t,i,3)||this.isNotEqual("rightIndent",e,t,i,3)||this.isNotEqual("firstLineIndent",e,t,i,3)||this.isNotEqual("textAlignment",e,t,i,3)||this.isNotEqual("beforeSpacing",e,t,i,3)||this.isNotEqual("afterSpacing",e,t,i,3)||this.isNotEqual("spaceBeforeAuto",e,t,i,3)||this.isNotEqual("spaceAfterAuto",e,t,i,3)||this.isNotEqual("lineSpacing",e,t,i,3)||this.isNotEqual("lineSpacingType",e,t,i,3)||this.isNotEqual("outlineLevel",e,t,i,3)||this.isNotEqual("bidi",e,t,i,3)||this.isNotEqual("contextualSpacing",e,t,i,3)||this.isNotEqual("keepWithNext",e,t,i,3)||this.isNotEqual("keepLinesTogether",e,t,i,3)||this.isNotEqual("widowControl",e,t,i,3))},s.prototype.isCellFormatEqual=function(e,t,i){return!(this.isNotEqual("leftMargin",e,t,i,4)||this.isNotEqual("rightMargin",e,t,i,4)||this.isNotEqual("topMargin",e,t,i,4)||this.isNotEqual("bottomMargin",e,t,i,4)||this.isNotEqual("columnSpan",e,t,i,4)||this.isNotEqual("rowSpan",e,t,i,4)||this.isNotEqual("verticalAlignment",e,t,i,4)||this.isNotEqual("preferredWidthType",e,t,i,4)||this.isNotEqual("preferredWidth",e,t,i,4)||this.isNotEqual("cellWidth",e,t,i,4))},s.prototype.isShadingEqual=function(e,t,i){return!(this.isNotEqual("backgroundColor",e,t,i,5)||this.isNotEqual("foregroundColor",e,t,i,5)||this.isNotEqual("textureStyle",e,t,i,5))},s.prototype.isRowFormatEqual=function(e,t,i){return!(this.isNotEqual("allowBreakAcrossPages",e,t,i,6)||this.isNotEqual("isHeader",e,t,i,6)||this.isNotEqual("height",e,t,i,6)||this.isNotEqual("heightType",e,t,i,6)||this.isNotEqual("gridBefore",e,t,i,6)||this.isNotEqual("gridBeforeWidth",e,t,i,6)||this.isNotEqual("gridBeforeWidthType",e,t,i,6)||this.isNotEqual("gridAfter",e,t,i,6)||this.isNotEqual("gridAfterWidth",e,t,i,6)||this.isNotEqual("gridAfterWidthType",e,t,i,6)||this.isNotEqual("leftMargin",e,t,i,6)||this.isNotEqual("topMargin",e,t,i,6)||this.isNotEqual("bottomMargin",e,t,i,6)||this.isNotEqual("rightMargin",e,t,i,6)||this.isNotEqual("leftIndent",e,t,i,6))},s.prototype.isListFormatEqual=function(e,t,i){return!(this.isNotEqual("listId",e,t,i,7)||this.isNotEqual("listLevelNumber",e,t,i,7))},s.prototype.isTableFormatEqual=function(e,t,i){return!(this.isNotEqual("leftMargin",e,t,i,8)||this.isNotEqual("rightMargin",e,t,i,8)||this.isNotEqual("topMargin",e,t,i,8)||this.isNotEqual("bottomMargin",e,t,i,8)||this.isNotEqual("cellSpacing",e,t,i,8)||this.isNotEqual("leftIndent",e,t,i,8)||this.isNotEqual("tableAlignment",e,t,i,8)||this.isNotEqual("preferredWidth",e,t,i,8)||this.isNotEqual("preferredWidthType",e,t,i,8)||this.isNotEqual("bidi",e,t,i,8)||this.isNotEqual("allowAutoFit",e,t,i,8)||this.isNotEqual("horizontalPositionAbs",e,t,i,8)||this.isNotEqual("horizontalPosition",e,t,i,8))},s.prototype.isListLevelEqual=function(e,t,i){return!(this.isNotEqual("listLevelPattern",e,t,i,9)||this.isNotEqual("startAt",e,t,i,9)||this.isNotEqual("followCharacter",e,t,i,9)||this.isNotEqual("numberFormat",e,t,i,9)||this.isNotEqual("restartLevel",e,t,i,9))},s.prototype.isSectionFormatEqual=function(e,t,i){return!(this.isNotEqual("headerDistance",e,t,i,10)||this.isNotEqual("footerDistance",e,t,i,10)||this.isNotEqual("differentFirstPage",e,t,i,10)||this.isNotEqual("differentOddAndEvenPages",e,t,i,10)||this.isNotEqual("pageWidth",e,t,i,10)||this.isNotEqual("pageHeight",e,t,i,10)||this.isNotEqual("leftMargin",e,t,i,10)||this.isNotEqual("topMargin",e,t,i,10)||this.isNotEqual("rightMargin",e,t,i,10)||this.isNotEqual("bottomMargin",e,t,i,10)||this.isNotEqual("bidi",e,t,i,10)||this.isNotEqual("restartPageNumbering",e,t,i,10)||this.isNotEqual("pageStartingNumber",e,t,i,10)||this.isNotEqual("endnoteNumberFormat",e,t,i,10)||this.isNotEqual("endnotePosition",e,t,i,10)||this.isNotEqual("footNoteNumberFormat",e,t,i,10)||this.isNotEqual("footnotePosition",e,t,i,10)||this.isNotEqual("restartIndexForEndnotes",e,t,i,10)||this.isNotEqual("restartIndexForFootnotes",e,t,i,10)||this.isNotEqual("initialFootNoteNumber",e,t,i,10)||this.isNotEqual("initialEndNoteNumber",e,t,i,10)||this.isNotEqual("pageNumberStyle",e,t,i,10))},s.prototype.cloneItems=function(e,t,i,n){for(var r=s.getPropertyType(n,t),o=e.propertiesHash.keys,l=0;l<o.length;l++)o[l]===r?this.propertiesHash.add(r,i):this.propertiesHash.add(o[l],e.propertiesHash.get(o[l]));e.propertiesHash.containsKey(r)||this.propertiesHash.add(r,i)},s.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,n=0;n<i.length;n++)t.containsKey(i[n])||t.add(i[n],this.propertiesHash.get(i[n]));return t},s.prototype.cloneProperties=function(){for(var e=new U,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},s.prototype.destroy=function(){(0,a.le)(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},s}(),rt=function(){function s(){this.items=[]}return s.prototype.addUniqueFormat=function(e,t){for(var i=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e,void 0,void 0)){i=this.items[n];break}return(0,a.le)(i)?((i=new ne(t)).propertiesHash=e,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},s.prototype.updateUniqueFormat=function(e,t,i){for(var n=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(e.propertiesHash,t,i)){n=this.items[r];break}return(0,a.le)(n)?((n=new ne(e.uniqueFormatType)).cloneItems(e,t,i,e.uniqueFormatType),n.referenceCount=1,this.items.push(n)):n.referenceCount++,this.remove(e),e=void 0,n},s.prototype.remove=function(e){e.referenceCount--,e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},s.prototype.clear=function(){if((0,a.le)(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},s.prototype.destroy=function(){this.clear(),this.items=void 0},s}(),xt=function(){function s(){this.mode=!0}return s.prototype.send=function(e,t){var i=this;this.xmlHttpRequest=new XMLHttpRequest;var n=0;(0,a.le)(t)||(this.xmlHttpRequest.withCredentials=t.withCredentials,n=t.timeout>=0?t.timeout:0,this.customHeaders=t.headers),this.xmlHttpRequest.onreadystatechange=function(){i.stateChange(i)},this.xmlHttpRequest.onerror=function(){i.error(i)},this.mode?this.sendRequest(e,n):setTimeout(function(){i.sendRequest(e,n)})},s.prototype.sendRequest=function(e,t){this.xmlHttpRequest.open("POST",this.url,!0),this.xmlHttpRequest.timeout=t,this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var i=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(i)},s.prototype.stateChange=function(e){4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status?e.successHandler({name:"onSuccess",data:this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status}):4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status&&e.failureHandler({name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url})},s.prototype.error=function(e){e.errorHandler({name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText})},s.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},s.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},s.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},s.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.xmlHttpRequest.setRequestHeader(r,t[r])}},s}(),oi="internalZoomFactorChange",Tn="contentChange",Sn="documentChange",Pn="selectionChange",vt="afterFormFieldFill",Hn="beforeFormFieldFill",In="serviceFailure",Ln="customContextMenuSelect",En="customContextMenuBeforeOpen",si="contentControl",yt="beforeCommentAction",kn="commentDelete",Ot="beforePaneSwitch",li="trackChange",hi="searchResultsChange",di="internalviewChange",Tt="beforeXmlHttpRequestSend",ci="protectionTypeChange",ui="internalDocumentEditorSettingsChange",zt="internalStyleCollectionChange",Wn=function(){function s(){}return s.prototype.getModuleName=function(){return"Print"},s.prototype.print=function(e,t){this.printWindow(e,navigator.userAgent,t)},s.prototype.printWindow=function(e,t,i){var n=this.getPageHeight(e.pages),r=this.getPageWidth(e.pages),o=document.createElement("div");o.style.width="100%",o.style.height="100%",o.style.overflow="scroll",this.generatePrintContent(e,o),(0,a.le)(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no"));var l=r.toString()+"px "+n.toString()+"px";r>n&&(l="landscape"),-1!==t.indexOf("Chrome")||-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+l+"; }@media print{ body { margin: 0cm; size:"+l+"; }</style></head> <body><center>")):i.document.write("<html><head><style>@page{margin:0;size:"+l+";}</style></head><body><center>"),i.document.write(o.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),o=void 0,i.document.close(),i.focus();var h=setInterval(function(){i.ready&&(i.print(),i.close(),clearInterval(h))},500)},s.prototype.exportAsImage=function(e,t,i){var n;if(!(0,a.le)(t)&&t<=e.pages.length&&t>=1){var r=e.pages[t-1],o=r.boundingRectangle.height,l=r.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,0,0);var h=e.render.pageCanvas.toDataURL(i,1);e.render.isPrinting=!1,(n=new Image).src=h,n.setAttribute("style","margin:0px;display:block;width:"+l.toString()+"px;height:"+o.toString()+"px;")}return n},s.prototype.generatePrintContent=function(e,t){for(var i="",n=0;n<e.pages.length;n++){var r=e.pages[n],o=r.boundingRectangle.height,l=r.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,0,0);var h=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1,i+="<div><img src="+h+' style="margin:0px;display:block;width: '+l.toString()+"px; height:"+o.toString()+'px; "/></div><br/>'}t.innerHTML=i},s.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},s.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},s.prototype.destroy=function(){},s}(),je=function(){function s(e){this.uniqueSectionFormat=void 0,this.ownerBase=e}return Object.defineProperty(s.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){(0,a.le)(this.uniqueSectionFormat)||s.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueSectionFormat)){var t=ne.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":case"bidi":case"restartPageNumbering":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"pageStartingNumber":case"initialFootNoteNumber":case"initialEndNoteNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":case"pageNumberStyle":t="Arabic"}return t},s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(i))return this.uniqueSectionFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(e,t);else{var i=ne.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);if(this.uniqueSectionFormat.propertiesHash.containsKey(i)&&this.uniqueSectionFormat.propertiesHash.get(i)===t)return;this.uniqueSectionFormat=s.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,e,t)}},s.prototype.initializeUniqueSectionFormat=function(e,t){var i=new U;this.addUniqueSectionFormat("headerDistance",e,t,i),this.addUniqueSectionFormat("footerDistance",e,t,i),this.addUniqueSectionFormat("differentFirstPage",e,t,i),this.addUniqueSectionFormat("differentOddAndEvenPages",e,t,i),this.addUniqueSectionFormat("pageWidth",e,t,i),this.addUniqueSectionFormat("pageHeight",e,t,i),this.addUniqueSectionFormat("leftMargin",e,t,i),this.addUniqueSectionFormat("topMargin",e,t,i),this.addUniqueSectionFormat("rightMargin",e,t,i),this.addUniqueSectionFormat("bottomMargin",e,t,i),this.addUniqueSectionFormat("bidi",e,t,i),this.addUniqueSectionFormat("restartPageNumbering",e,t,i),this.addUniqueSectionFormat("pageStartingNumber",e,t,i),this.addUniqueSectionFormat("endnoteNumberFormat",e,t,i),this.addUniqueSectionFormat("endnotePosition",e,t,i),this.addUniqueSectionFormat("footNoteNumberFormat",e,t,i),this.addUniqueSectionFormat("footnotePosition",e,t,i),this.addUniqueSectionFormat("restartIndexForEndnotes",e,t,i),this.addUniqueSectionFormat("restartIndexForFootnotes",e,t,i),this.addUniqueSectionFormat("initialFootNoteNumber",e,t,i),this.addUniqueSectionFormat("initialEndNoteNumber",e,t,i),this.addUniqueSectionFormat("pageNumberStyle",e,t,i),this.uniqueSectionFormat=s.uniqueSectionFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueSectionFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);n.add(r,e===t?i:s.getPropertyDefaultValue(e))},s.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?this.uniqueSectionFormat=e.uniqueSectionFormat:(0,a.le)(e)||!(0,a.le)(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&this.updateUniqueSectionFormat(e)},s.prototype.updateUniqueSectionFormat=function(e){var t=void 0;this.uniqueSectionFormat&&(t=this.uniqueSectionFormat.mergeProperties(e.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(s.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new ne(s.uniqueFormatType),(0,a.le)(t)&&(t=this.uniqueSectionFormat.mergeProperties(e.uniqueSectionFormat)),this.uniqueSectionFormat=s.uniqueSectionFormats.addUniqueFormat(t,s.uniqueFormatType)},s.prototype.cloneFormat=function(){var e=new s;return e.uniqueSectionFormat=this.uniqueSectionFormat,e},s.clear=function(){this.uniqueSectionFormats.clear()},s.uniqueSectionFormats=new rt,s.uniqueFormatType=10,s}(),ve=function(){function s(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(s.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueBorderFormat)){var n=this.uniqueBorderFormat.propertiesHash.get(i);if(!(0,a.le)(n))return n}}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueBorderFormat))this.initializeUniqueBorder(e,t);else{var i=ne.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);if(this.uniqueBorderFormat.propertiesHash.containsKey(i)&&this.uniqueBorderFormat.propertiesHash.get(i)===t)return;this.uniqueBorderFormat=s.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,e,t)}},s.prototype.initializeUniqueBorder=function(e,t){var i=new U;this.addUniqueBorderFormat("color",e,t,i),this.addUniqueBorderFormat("lineStyle",e,t,i),this.addUniqueBorderFormat("lineWidth",e,t,i),this.addUniqueBorderFormat("shadow",e,t,i),this.addUniqueBorderFormat("space",e,t,i),this.addUniqueBorderFormat("hasNoneStyle",e,t,i),this.uniqueBorderFormat=s.uniqueBorderFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueBorderFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":case"space":t=0;break;case"shadow":case"hasNoneStyle":t=!1}return t},s.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":case"DashDotStroked":case"Outset":return this.lineWidth;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75}return this.lineWidth},s.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var n=0;n<i.length;n++)i[n]=i[n]>=0?i[n]*t:Math.abs(i[n]);return i},s.prototype.getBorderWeight=function(){var e=0,i=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*i;break;case"Dot":case"DashLargeGap":e=1}return e},s.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},s.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case"SingleWavy":case"DashDotStroked":case"Outset":case"Inset":case"Thick":e=1;break;case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"Emboss3D":case"Engrave3D":e=3;break;case"Triple":case"ThinThickThinSmallGap":case"ThinThickThinMediumGap":case"ThinThickThinLargeGap":e=5;break;case"DoubleWavy":e=2}return e},s.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},s.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueBorderFormat)){var t=ne.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.color=this.color,e.lineStyle=this.lineStyle,e.lineWidth=this.lineWidth,e.shadow=this.shadow,e.space=this.space,e},s.prototype.destroy=function(){(0,a.le)(this.uniqueBorderFormat)||s.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},s.prototype.isEqualFormat=function(e){var t=!1;return this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow==e.shadow&&this.space===e.space&&(t=!0),t},s.prototype.copyFormat=function(e){!(0,a.le)(e)&&!(0,a.le)(e.uniqueBorderFormat)&&(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},s.clear=function(){this.uniqueBorderFormats.clear()},s.uniqueBorderFormats=new rt,s.uniqueFormatType=1,s}(),_e=function(){function s(e){this.leftIn=new ve(this),this.rightIn=new ve(this),this.topIn=new ve(this),this.bottomIn=new ve(this),this.horizontalIn=new ve(this),this.verticalIn=new ve(this),this.diagonalUpIn=new ve(this),this.diagonalDownIn=new ve(this),this.isParsing=!1,this.ownerBase=e}return Object.defineProperty(s.prototype,"left",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"right",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"top",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottom",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"horizontal",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"vertical",{get:function(){return this.ownerBase instanceof ue?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing||t.hasValues())return t;var i=this.ownerBase.baseStyle;if(!(0,a.le)(i)){for(var n=this;!(0,a.le)(i);){var r=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(r=i.paragraphFormat.getListPargaraphFormat(e)),i.paragraphFormat.borders.getBorder(e).hasValues()){n=i.paragraphFormat.borders;break}if(!(0,a.le)(r)&&r.borders.getBorder(e).hasValues()){n=r.borders;break}i=i.basedOn}if(!(0,a.le)(i))return n.getBorder(e)}return this.getDefaultValue(e)},s.prototype.getDefaultValue=function(e){var i,t=this.documentParagraphFormat();return!(0,a.le)(t)&&!(0,a.le)(t.borders)&&(i=t.borders.getBorder(e)),i},s.prototype.documentParagraphFormat=function(){var e;return this.ownerBase instanceof ue&&(e=this.ownerBase.getDocumentParagraphFormat()),e},s.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},s.prototype.destroy=function(){(0,a.le)(this.leftIn)||this.leftIn.destroy(),(0,a.le)(this.topIn)||this.topIn.destroy(),(0,a.le)(this.bottomIn)||this.bottomIn.destroy(),(0,a.le)(this.rightIn)||this.rightIn.destroy(),(0,a.le)(this.horizontalIn)||this.horizontalIn.destroy(),(0,a.le)(this.verticalIn)||this.verticalIn.destroy(),(0,a.le)(this.diagonalDown)||this.diagonalDown.destroy(),(0,a.le)(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.top=(0,a.le)(this.topIn)?void 0:this.topIn.cloneFormat(),e.bottom=(0,a.le)(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),e.left=(0,a.le)(this.leftIn)?void 0:this.leftIn.cloneFormat(),e.right=(0,a.le)(this.rightIn)?void 0:this.rightIn.cloneFormat(),e.horizontal=(0,a.le)(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),e.vertical=(0,a.le)(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),e.diagonalUp=(0,a.le)(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),e.diagonalDown=(0,a.le)(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),e},s.prototype.copyFormat=function(e){if(!(0,a.le)(e.getBorder("left"))&&e.getBorder("left")instanceof ve){var t=new ve(this);t.copyFormat(e.getBorder("left")),this.left=t}if(!(0,a.le)(e.getBorder("right"))&&e.getBorder("right")instanceof ve){var i=new ve(this);i.copyFormat(e.getBorder("right")),this.right=i}if(!(0,a.le)(e.getBorder("top"))&&e.getBorder("top")instanceof ve){var n=new ve(this);n.copyFormat(e.getBorder("top")),this.top=n}if(!(0,a.le)(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof ve){var r=new ve(this);r.copyFormat(e.getBorder("bottom")),this.bottom=r}if(!(0,a.le)(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof ve){var o=new ve(this);o.copyFormat(e.getBorder("horizontal")),this.horizontal=o}if(!(0,a.le)(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof ve){var l=new ve(this);l.copyFormat(e.getBorder("vertical")),this.vertical=l}!(0,a.le)(e.diagonalDown)&&e.diagonalDown instanceof ve&&(this.diagonalDown=new ve(this),this.diagonalDown.copyFormat(e.diagonalDown)),!(0,a.le)(e.diagonalUp)&&e.diagonalUp instanceof ve&&(this.diagonalUp=new ve(this),this.diagonalUp.copyFormat(e.diagonalUp))},s}(),It=function(){function s(){}return s.prototype.destroy=function(){(0,a.le)(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},s.prototype.clone=function(){var e=new s;return e.startAt=this.startAt,e.levelNumber=this.levelNumber,(0,a.le)(this.overrideListLevel)||(e.overrideListLevel=this.overrideListLevel.clone(e)),e},s}(),ft=function(){function s(){this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return s.prototype.getListLevel=function(e){var i=this.getLevelOverride(e);return(0,a.le)(i)||(0,a.le)(i.overrideListLevel)?this.abstractList.levels[e]:i.overrideListLevel},s.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[t]instanceof It){var i=this.levelOverrides[t];if(i.levelNumber===e)return i}},s.prototype.destroy=function(){(0,a.le)(this.levelOverrides)||(this.levelOverrides=[]),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0,this.levelOverrides=void 0},s.prototype.mergeList=function(e){!(0,a.le)(this.abstractListId)&&-1!==this.abstractListId&&(this.abstractListId=e.abstractListId),!(0,a.le)(this.listId)&&-1!==this.listId&&(this.listId=e.listId),!(0,a.le)(this.sourceListId)&&-1!==this.sourceListId&&(this.sourceListId=e.sourceListId),!(0,a.le)(this.levelOverrides)&&0!==this.levelOverrides.length&&(this.levelOverrides=e.levelOverrides)},s.prototype.clone=function(){for(var e=new s,t=0;t<this.levelOverrides.length;t++)e.levelOverrides.push(this.levelOverrides[t].clone());return e},s}(),bt=function(){function s(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(s.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){if(e>=0){if(!(0,a.le)(this.ownerBase)){var t=this.ownerBase.getDocumentHelperObject();(0,a.le)(t)||(this.list=t.getListById(e))}}else!(0,a.le)(this.list)&&e<0&&(this.list=void 0);this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"listLevel",{get:function(){var e=void 0;if((0,a.le)(this.list))for(var t=this.baseStyle;!(0,a.le)(t)&&t instanceof Xe;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;if(!(0,a.le)(e))return e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(i))return this.uniqueListFormat.propertiesHash.get(i)}else if(this.baseStyle instanceof Xe){for(var t=this.baseStyle;!(0,a.le)(t)&&!t.paragraphFormat.listFormat.hasValue(e);)t=t.basedOn;if(!(0,a.le)(t))return i=ne.getPropertyType(s.uniqueFormatType,e),t.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueListFormat))this.initializeUniqueListFormat(e,t);else{var i=ne.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);if(this.uniqueListFormat.propertiesHash.containsKey(i)&&this.uniqueListFormat.propertiesHash.get(i)===t)return;this.uniqueListFormat=s.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,e,t)}},s.prototype.initializeUniqueListFormat=function(e,t){var i=new U;this.addUniqueListFormat("listId",e,t,i),this.addUniqueListFormat("listLevelNumber",e,t,i),this.uniqueListFormat=s.uniqueListFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueListFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0}return t},s.prototype.copyFormat=function(e){(0,a.le)(e)||((0,a.le)(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber),(0,a.le)(e.baseStyle)||(this.baseStyle=e.baseStyle),(0,a.le)(e.list)||(this.list=e.list))},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueListFormat)){var t=ne.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},s.prototype.clearFormat=function(){!(0,a.le)(this.uniqueListFormat)&&0===this.uniqueListFormat.referenceCount&&s.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},s.prototype.destroy=function(){this.clearFormat()},s.clear=function(){this.uniqueListFormats.clear()},s.prototype.applyStyle=function(e){this.baseStyle=e},s.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},s.prototype.mergeFormat=function(e){(0,a.le)(this.getValue("listId"))&&(this.listId=e.getValue("listId")),(0,a.le)(this.getValue("listLevelNumber"))&&(this.listLevelNumber=e.getValue("listLevelNumber")),(0,a.le)(e.list)||((0,a.le)(this.list)&&(this.list=new ft),this.list.mergeList(e.list))},s.prototype.cloneListFormat=function(){var e=new s(void 0);return e.list=this.list,e.listId=this.listId,e.baseStyle=this.baseStyle,e.listLevelNumber=this.listLevelNumber,e.uniqueListFormat=this.uniqueListFormat,e},s.uniqueListFormats=new rt,s.uniqueFormatType=7,s}(),Rn=function(){function s(){}return Object.defineProperty(s.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},s}(),ue=function(){function s(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new bt(this),this.borders=new _e(this),this.tabs=[]}return s.prototype.getUpdatedTabs=function(){for(var e=[],t=new U,n=0,r=this.getTabStopsFromListFormat();n<r.length;n++){var o=r[n];t.containsKey(o.position)||t.add(o.position,o)}if(!(0,a.le)(this.baseStyle)&&this.baseStyle instanceof Xe){for(var l=this.baseStyle;!(0,a.le)(l);){for(var h=0,d=l.paragraphFormat.tabs;h<d.length;h++){var c=d[h];t.containsKey(c.position)||t.add(c.position,c)}l=l.basedOn}for(var u=0,p=t.keys;u<p.length;u++){var f=p[u];this.hasTabStop(parseFloat(f.toFixed(4)))||e.push(t.get(f))}e=(e=e.concat(this.tabs.filter(function(g){return 0!==g.position&&0===g.deletePosition}))).sort(function(g,m){return g.position-m.position})}return e},s.prototype.getTabStopsFromListFormat=function(){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},s.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(s.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),s.prototype.getListFormatParagraphFormat=function(e){var t=this.getListPargaraphFormat(e);if(!(0,a.le)(t))return t.uniqueParagraphFormat.propertiesHash.get(ne.getPropertyType(s.uniqueFormatType,e))},s.prototype.getListPargaraphFormat=function(e){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var t=this.listFormat.listLevel,i=ne.getPropertyType(s.uniqueFormatType,e);return(0,a.le)(t)||(0,a.le)(t.paragraphFormat.uniqueParagraphFormat)||!t.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(i)?void 0:t.paragraphFormat}if(this.listFormat.hasValue("listId")&&-1===this.listFormat.listId&&("leftIndent"===e||"firstLineIndent"===e)){var n=new s;return this.hasValue("leftIndent")||(n.leftIndent=0),this.hasValue("firstLineIndent")||(n.firstLineIndent=0),n}},s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var o=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(o))return this.uniqueParagraphFormat.propertiesHash.get(o)}else{var t=this.getListFormatParagraphFormat(e);if(this.baseStyle instanceof Xe){for(var i=this,n=this.baseStyle;!(0,a.le)(n);){var r=void 0;if(this.listFormat.hasValue("listId")||(r=n.paragraphFormat.getListPargaraphFormat(e)),n.paragraphFormat.hasValue(e)){i=n.paragraphFormat;break}if(!(0,a.le)(r)&&r.hasValue(e)){i=r;break}n=n.basedOn}if(!(0,a.le)(n))return!(0,a.le)(t)&&this.listFormat.hasValue("listId")&&-1===i.listFormat.listId&&i.listFormat.listLevelNumber<=1||!(0,a.le)(t)&&this.listFormat.listId!==i.listFormat.listId&&i.listFormat.listLevelNumber<=1?t:(o=ne.getPropertyType(s.uniqueFormatType,e),i.uniqueParagraphFormat.propertiesHash.get(o))}if(!(0,a.le)(t))return t}return this.getDefaultValue(e)},s.prototype.getDefaultValue=function(e){var t=ne.getPropertyType(s.uniqueFormatType,e),i=this.getDocumentParagraphFormat(),n=!0;this.ownerBase&&this.ownerBase instanceof I&&(n=this.ownerBase.containerWidget instanceof Ye||this.ownerBase.containerWidget instanceof be||this.ownerBase.containerWidget instanceof V);var r=!(0,a.le)(this.ownerBase)&&!(0,a.le)(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!(0,a.le)(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor.isPaste;if(n&&!r&&!(0,a.le)(i)&&!(0,a.le)(i.uniqueParagraphFormat)){var o=i.uniqueParagraphFormat.propertiesHash.get(t);if(!(0,a.le)(o))return o}return s.getPropertyDefaultValue(e)},s.prototype.getDocumentParagraphFormat=function(){var e;if(!(0,a.le)(this.ownerBase)){var t=this.getDocumentHelperObject();(0,a.le)(t)||(e=t.paragraphFormat)}return e},s.prototype.getDocumentHelperObject=function(){var e;if(this.ownerBase instanceof I){var t=this.ownerBase.bodyWidget;!(0,a.le)(t)&&!(0,a.le)(t.page)&&!(0,a.le)(t.page.documentHelper)&&(e=t.page.documentHelper)}return e},s.prototype.setPropertyValue=function(e,t,i){if(((0,a.le)(t)||""===t&&!i)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(e,t);else{var n=ne.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);if(this.uniqueParagraphFormat.propertiesHash.containsKey(n)&&this.uniqueParagraphFormat.propertiesHash.get(n)===t)return;this.uniqueParagraphFormat=s.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,e,t)}},s.prototype.initializeUniqueParagraphFormat=function(e,t){var i=new U;this.addUniqueParaFormat("leftIndent",e,t,i),this.addUniqueParaFormat("rightIndent",e,t,i),this.addUniqueParaFormat("firstLineIndent",e,t,i),this.addUniqueParaFormat("textAlignment",e,t,i),this.addUniqueParaFormat("beforeSpacing",e,t,i),this.addUniqueParaFormat("afterSpacing",e,t,i),this.addUniqueParaFormat("spaceBeforeAuto",e,t,i),this.addUniqueParaFormat("spaceAfterAuto",e,t,i),this.addUniqueParaFormat("lineSpacing",e,t,i),this.addUniqueParaFormat("lineSpacingType",e,t,i),this.addUniqueParaFormat("outlineLevel",e,t,i),this.addUniqueParaFormat("bidi",e,t,i),this.addUniqueParaFormat("contextualSpacing",e,t,i),this.addUniqueParaFormat("keepWithNext",e,t,i),this.addUniqueParaFormat("keepLinesTogether",e,t,i),this.addUniqueParaFormat("widowControl",e,t,i),this.uniqueParagraphFormat=s.uniqueParagraphFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueParaFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":case"beforeSpacing":case"afterSpacing":t=0;break;case"textAlignment":t="Left";break;case"spaceBeforeAuto":case"spaceAfterAuto":case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"widowControl":t=!0}return t},s.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},s.prototype.clearPropertyValue=function(e){if(this.setPropertyValue(e,void 0,!0),!(0,a.le)(this.uniqueParagraphFormat)){var t=ne.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);this.uniqueParagraphFormat.propertiesHash.containsKey(t)&&this.uniqueParagraphFormat.propertiesHash.remove(t)}},s.prototype.clearFormat=function(){(0,a.le)(this.listFormat)||this.listFormat.clearFormat(),!(0,a.le)(this.uniqueParagraphFormat)&&0===this.uniqueParagraphFormat.referenceCount&&s.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,this.baseStyle=void 0},s.prototype.destroy=function(){if(this.clearFormat(),(0,a.le)(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,void 0!==this.tabs){for(var e=0;e<this.tabs.length;e++)this.tabs[e].destroy();this.tabs=void 0}(0,a.le)(this.borders)||this.borders.destroy(),this.borders=void 0},s.prototype.copyFormat=function(e){if(!(0,a.le)(e)&&((0,a.le)(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),(0,a.le)(e.borders)||this.borders.copyFormat(e.borders),(0,a.le)(e.listFormat)||this.listFormat.copyFormat(e.listFormat),(0,a.le)(e.baseStyle)||(this.baseStyle=e.baseStyle),!(0,a.le)(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},s.prototype.updateUniqueParagraphFormat=function(e){var t=void 0;this.uniqueParagraphFormat&&(t=this.uniqueParagraphFormat.mergeProperties(e.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(s.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new ne(s.uniqueFormatType),(0,a.le)(t)&&(t=this.uniqueParagraphFormat.mergeProperties(e.uniqueParagraphFormat)),this.uniqueParagraphFormat=s.uniqueParagraphFormats.addUniqueFormat(t,s.uniqueFormatType)},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.uniqueParagraphFormat=this.uniqueParagraphFormat,e.baseStyle=this.baseStyle,(0,a.le)(this.listFormat)?e.listFormat=void 0:(e.listFormat=this.listFormat.cloneListFormat(),e.listFormat.ownerBase=e),e.borders=(0,a.le)(this.borders)?void 0:this.borders.cloneFormat(),e},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueParagraphFormat)&&!(0,a.le)(this.uniqueParagraphFormat.propertiesHash)){var t=ne.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},s.clear=function(){this.uniqueParagraphFormats.clear()},s.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},s.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},s.prototype.mergeFormat=function(e,t){t=!(0,a.le)(t)&&t,(0,a.le)(this.getValue("leftIndent"))&&(this.leftIndent=e.getValue("leftIndent")),(0,a.le)(this.getValue("rightIndent"))&&(this.rightIndent=e.getValue("rightIndent")),(0,a.le)(this.getValue("firstLineIndent"))&&(this.firstLineIndent=e.getValue("firstLineIndent")),(0,a.le)(this.getValue("beforeSpacing"))&&(this.beforeSpacing=e.getValue("beforeSpacing")),(0,a.le)(this.getValue("afterSpacing"))&&(this.afterSpacing=e.getValue("afterSpacing")),(0,a.le)(this.getValue("spaceBeforeAuto"))&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),(0,a.le)(this.getValue("spaceAfterAuto"))&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),(0,a.le)(this.getValue("lineSpacing"))&&(this.lineSpacing=e.getValue("lineSpacing")),(0,a.le)(this.getValue("lineSpacingType"))&&(this.lineSpacingType=e.getValue("lineSpacingType")),(0,a.le)(this.getValue("textAlignment"))&&(this.textAlignment=e.getValue("textAlignment")),(0,a.le)(this.getValue("outlineLevel"))&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&(0,a.le)(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),(0,a.le)(this.getValue("contextualSpacing"))&&(this.contextualSpacing=e.getValue("contextualSpacing")),(0,a.le)(this.getValue("keepWithNext"))&&(this.keepWithNext=e.getValue("keepWithNext")),(0,a.le)(this.getValue("keepLinesTogether"))&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),(0,a.le)(this.getValue("widowControl"))&&(this.widowControl=e.getValue("widowControl")),(0,a.le)(this.listFormat)&&this.listFormat.mergeFormat(e.listFormat)},s.uniqueParagraphFormats=new rt,s.uniqueFormatType=3,s}(),De=function(){function s(e){this.uniqueRowFormat=void 0,this.borders=new _e(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}return Object.defineProperty(s.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(i))return this.uniqueRowFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueRowFormat))this.initializeUniqueRowFormat(e,t);else{var i=ne.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);if(this.uniqueRowFormat.propertiesHash.containsKey(i)&&this.uniqueRowFormat.propertiesHash.get(i)===t)return;this.uniqueRowFormat=s.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,e,t)}},s.prototype.initializeUniqueRowFormat=function(e,t){var i=new U;this.addUniqueRowFormat("allowBreakAcrossPages",e,t,i),this.addUniqueRowFormat("isHeader",e,t,i),this.addUniqueRowFormat("height",e,t,i),this.addUniqueRowFormat("heightType",e,t,i),this.addUniqueRowFormat("gridBefore",e,t,i),this.addUniqueRowFormat("gridBeforeWidth",e,t,i),this.addUniqueRowFormat("gridBeforeWidthType",e,t,i),this.addUniqueRowFormat("gridAfter",e,t,i),this.addUniqueRowFormat("gridAfterWidth",e,t,i),this.addUniqueRowFormat("gridgridAfterWidth",e,t,i),this.addUniqueRowFormat("gridBeforeWidthType",e,t,i),this.addUniqueRowFormat("leftMargin",e,t,i),this.addUniqueRowFormat("rightMargin",e,t,i),this.addUniqueRowFormat("topMargin",e,t,i),this.addUniqueRowFormat("bottomMargin",e,t,i),this.addUniqueRowFormat("leftIndent",e,t,i),this.uniqueRowFormat=s.uniqueRowFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueRowFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":case"gridBefore":case"gridBeforeWidth":case"gridAfter":case"gridAfterWidth":case"leftIndent":t=0;break;case"heightType":t="Auto";break;case"gridBeforeWidthType":case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0}return t},s.prototype.containsMargins=function(){return!((0,a.le)(this.leftMargin)&&(0,a.le)(this.rightMargin)&&(0,a.le)(this.bottomMargin)&&(0,a.le)(this.topMargin))},s.prototype.cloneFormat=function(){var e=new s;return e.allowBreakAcrossPages=this.allowBreakAcrossPages,e.heightType=this.heightType,e.height=this.height,e.isHeader=this.isHeader,e.gridBefore=this.gridBefore,e.gridBeforeWidth=this.gridBeforeWidth,e.gridBeforeWidthType=this.gridBeforeWidthType,e.gridAfter=this.gridAfter,e.gridAfterWidth=this.gridAfterWidth,e.gridAfterWidthType=this.gridAfterWidthType,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.leftIndent=this.leftIndent,e.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice(),e},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueRowFormat)){var t=ne.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},s.prototype.copyFormat=function(e){(0,a.le)(e)||((0,a.le)(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),(0,a.le)(e.borders)||(this.borders=new _e(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),this.removedIds=e.revisions.length>0?Ke.cloneRevisions(e.revisions):e.removedIds.slice())},s.prototype.destroy=function(){(0,a.le)(this.borders)||this.borders.destroy(),(0,a.le)(this.uniqueRowFormat)||s.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},s.clear=function(){this.uniqueRowFormats.clear()},s.uniqueRowFormats=new rt,s.uniqueFormatType=6,s}(),Ke=function(){function s(e,t,i){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,this.date=i,this.owner=e}return s.prototype.handleAcceptReject=function(e){this.owner.selection.selectRevision(this);var t=this.owner.selection,i=t.start,n=t.end;t.start.isExistBefore(t.end)||(i=t.end,n=t.start);var r=t.getParagraphInfo(i);if(this.owner.editor.initHistory(e?"Accept Change":"Reject Change"),"Deletion"===this.revisionType?(r=t.getParagraphInfo(this.owner.selection.start),t.editPosition=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())):t.editPosition=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.owner.editor.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType)for(var o=0;this.range.length>0&&(this.range[o]instanceof fe||this.range[o]instanceof ie||this.range[o]instanceof De);){if(this.range[o]instanceof O&&e&&"Deletion"===this.revisionType){var l=this.range[o];this.owner.documentHelper.bookmarks.containsKey(l.name)&&this.owner.documentHelper.bookmarks.remove(l.name)}this.unlinkRangeItem(this.range[o],this,e)?o++:o=0}if(this.isTableRevision=!1,this.isContentRemoved){var d=t.getTextPosBasedOnLogicalIndex(t.editPosition);this.owner.selection.selectContent(d,!0),this.owner.editor.updateEndPosition()}else t.selectRange(i,n),this.owner.editor.updateHistoryPosition(n,!1);if(this.owner.editorHistory&&"BackSpace"!==this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistory){this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistory.currentBaseHistoryInfo.action="TrackingPageBreak");var c=this.owner.editorHistory;c.currentHistoryInfo&&("Accept All"===c.currentHistoryInfo.action||"Reject All"===c.currentHistoryInfo.action)&&this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),c.updateHistory()}this.owner.editor.reLayout(this.owner.selection),r.paragraph.isInHeaderFooter&&this.owner.editor.updateHeaderFooterWidget()},s.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editor.initComplexHistory(e?"Accept All":"Reject All");for(var t=this.owner.trackChangesPane.tableRevisions.get(this),i=0;i<t.length;i++)t[i].handleAcceptReject(!!e);this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}},s.prototype.accept=function(){this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof De&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0))},s.prototype.reject=function(){this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof De&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1))},s.prototype.unlinkRangeItem=function(e,t,i){if(this.isTableRevision)return this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1;var n=!(0,a.le)(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i;if(this.owner.selection.isTOC()){if(n)this.owner.editor.deleteSelectedContents(this.owner.selection,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;)this.removeRangeRevisionForItem(this.range[0]),0===t.range.length&&this.owner.revisions.remove(t);this.owner.editor.addRemovedNodes(this.revisionID),this.owner.editorHistory.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(e instanceof fe&&!this.canSkipTableItems)if(n){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0,!0;this.owner.editor.addRemovedNodes(e.clone())}else this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID();else if(!this.canSkipTableItems&&e instanceof ie&&!n)this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID();else if(e instanceof De&&!n){this.isTableRevision=!0;var o=e.ownerBase.ownerTable,l=e.ownerBase;this.owner.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editor.cloneTableToHistoryInfo(o)}if(n=n&&!this.canSkipTableItems,e instanceof fe&&n){var h=e.line.paragraph;this.removeRevisionItemsFromRange(e),this.removeItem(e),this.isContentRemoved=!0,this.owner.documentHelper.layout.reLayoutParagraph(h,0,0)}else if(e instanceof ie&&n){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editor.deleteSelectedContents(this.owner.selection,!0);else{this.owner.editor.deleteSelectedContents(this.owner.selection,!0);var d=t.range.indexOf(e);for(t.range.splice(d,1);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace"}else e instanceof De&&n&&(o=e.ownerBase.ownerTable,l=e.ownerBase,this.removeRevisionItemsFromRange(e),this.owner.editorHistory.currentBaseHistoryInfo.action="DeleteCells",this.owner.editor.cloneTableToHistoryInfo(o),this.owner.editor.removeDeletedCellRevision(l),this.isContentRemoved=!0,o.removeChild(o.childWidgets.indexOf(l)),this.canSkipTableItems=!0,this.owner.editor.removeFieldInBlock(l,!0),this.owner.editor.removeFieldInBlock(l,void 0,!0),l.destroy(),0===o.childWidgets.length?(this.owner.selection.editPosition=this.owner.selection.getHierarchicalIndex(o,"0"),this.owner.editor.removeBlock(o),o.destroy()):this.owner.editor.updateTable(o));return(!(e instanceof De)||!n)&&(this.skipUnLinkElement||this.removeRangeRevisionForItem(e)),0===t.range.length&&this.owner.revisions.remove(t),!1},s.prototype.updateRevisionID=function(){for(this.owner.editor.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])},s.prototype.removeRevisionItemsFromRange=function(e){if(e.revisions.length>0)for(var t=0;t<e.revisions.length;t++){var i=e.revisions[t];if(this.revisionID!==i.revisionID){var n=i.range.indexOf(e);e.revisions[t].range.splice(n,1)}0===i.range.length&&this.owner.revisions.remove(i)}},s.prototype.removeRangeRevisionForItem=function(e){var t=e.revisions.indexOf(this);if(t>=0){e.revisions.splice(t,1);var i=this.range.indexOf(e);this.range.splice(i,1)}},s.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(t.characterFormat.revisions.length>0)for(var i=0;i<t.characterFormat.revisions.length;i++)if(t.characterFormat.revisions[i].range.indexOf(e)>=0)return!0;return!1},s.prototype.removeRevisionFromRow=function(e){this.owner.editor.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++)this.owner.editor.removeRevisionForCell(e.childWidgets[t],!1)},s.prototype.removeItem=function(e){var t=e.line.paragraph;this.owner.editor.unLinkFieldCharacter(e);var i=e.line.children.indexOf(e);e.line.children.splice(i,1);var n=e.line.paragraph.floatingElements.indexOf(e);e.line.paragraph.floatingElements.splice(n,1);var r=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);r>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(r,1),this.owner.editor.removeEmptyLine(t)},s.prototype.canSkipCloning=function(){return!((0,a.le)(this.owner)||!this.owner.editorHistory||!this.owner.editorHistory.currentBaseHistoryInfo||"DeleteCells"!==this.owner.editorHistory.currentBaseHistoryInfo.action)},s.prototype.destroy=function(){this.author=void 0,this.revisionType=void 0,this.revisionID=void 0,this.date=void 0,this.range=[],this.range=void 0,this.owner=void 0},s.prototype.clone=function(){if(this.canSkipCloning())return this;var e=new s(void 0,this.author,this.date);return e.revisionID=this.revisionID,e.revisionType=this.revisionType,e},s.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t},s}(),xo=function(){function s(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}return s.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(s.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),s.prototype.remove=function(e){(0,a.le)(e)||this.changes.indexOf(e)<0||this.changes.splice(this.changes.indexOf(e),1)},s.prototype.acceptAll=function(){!this.owner.isReadOnly&&!this.owner.documentHelper.isTrackedOnlyMode&&this.handleRevisionCollection(!0)},s.prototype.rejectAll=function(){!this.owner.isReadOnly&&!this.owner.documentHelper.isTrackedOnlyMode&&this.handleRevisionCollection(!1)},s.prototype.handleRevisionCollection=function(e,t){this.skipGroupAcceptReject=!0;var i=this.owner.selection,n=i.start,r=i.end;i.start.isExistBefore(i.end)||(n=i.end,r=i.start),n=n.clone(),r=r.clone(),this.owner.editor.initComplexHistory(e?"Accept All":"Reject All");for(var o=t||this.changes;o.length>0;)e?o[0].accept():o[0].reject(),t&&o.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget();var l=i.getTextPosBasedOnLogicalIndex(i.editPosition);this.owner.selection.selectContent(l,!0),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory(),this.owner.editor.reLayout(this.owner.selection,!1),this.skipGroupAcceptReject=!1},s.prototype.destroy=function(){this.changes=[]},s}(),ie=function(){function s(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}return Object.defineProperty(s.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var u=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(u))return this.uniqueCharacterFormat.propertiesHash.get(u)}else{var t=this.checkCharacterStyle(e);if(!(0,a.le)(t))return t;if(!(0,a.le)(this.baseCharStyle)){var n=this.ownerBase.line;if(!(0,a.le)(this.ownerBase.paragraph)&&!(0,a.le)(n))for(var r=n.children.length,o=0;o<r;o++){var l=this.ownerBase.line.children[o];if(l instanceof S){var h=l.text;h.startsWith("HYPERLINK")&&-1!==h.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}}var c=this.checkBaseStyle(e);if(!(0,a.le)(c))return c}return this.getDefaultValue(e)},s.prototype.getDefaultValue=function(e){var t=ne.getPropertyType(s.uniqueFormatType,e),i=this.documentCharacterFormat();return(0,a.le)(i)||(0,a.le)(i.uniqueCharacterFormat)||!i.uniqueCharacterFormat.propertiesHash.containsKey(t)?s.getPropertyDefaultValue(e):i.uniqueCharacterFormat.propertiesHash.get(t)},s.prototype.documentCharacterFormat=function(){var e;return(0,a.le)(this.ownerBase)||((0,a.le)(this.ownerBase.paragraph)||(0,a.le)(this.ownerBase.paragraph.bodyWidget)?(0,a.le)(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),e},s.prototype.checkBaseStyle=function(e){var t;for((0,a.le)(this.ownerBase)||((0,a.le)(this.ownerBase.paragraph)?this.ownerBase instanceof I&&!(0,a.le)(this.ownerBase.paragraphFormat)?t=this.ownerBase.paragraphFormat.baseStyle:(0,a.le)(this.ownerBase instanceof Xe)||(t=this.ownerBase.basedOn):t=this.ownerBase.paragraph.paragraphFormat.baseStyle);!(0,a.le)(t)&&!t.characterFormat.hasValue(e);)t=t.basedOn;if(!(0,a.le)(t)){var i=ne.getPropertyType(s.uniqueFormatType,e);return t.characterFormat.uniqueCharacterFormat.propertiesHash.get(i)}},s.prototype.checkCharacterStyle=function(e){var t=this.baseCharStyle;if(!(0,a.le)(t))for(;!(0,a.le)(t)&&"Default Paragraph Font"!==t.name;){if(t.characterFormat.hasValue(e)){var n=ne.getPropertyType(s.uniqueFormatType,e);return t.characterFormat.uniqueCharacterFormat.propertiesHash.get(n)}t=t.basedOn}},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(e,t);else{var i=ne.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);if(this.uniqueCharacterFormat.propertiesHash.containsKey(i)&&this.uniqueCharacterFormat.propertiesHash.get(i)===t)return;this.uniqueCharacterFormat=s.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,e,t)}},s.prototype.initializeUniqueCharacterFormat=function(e,t){var i=new U;this.addUniqueCharacterFormat("fontColor",e,t,i),this.addUniqueCharacterFormat("fontFamily",e,t,i),this.addUniqueCharacterFormat("fontSize",e,t,i),this.addUniqueCharacterFormat("bold",e,t,i),this.addUniqueCharacterFormat("italic",e,t,i),this.addUniqueCharacterFormat("underline",e,t,i),this.addUniqueCharacterFormat("strikethrough",e,t,i),this.addUniqueCharacterFormat("baselineAlignment",e,t,i),this.addUniqueCharacterFormat("highlightColor",e,t,i),this.addUniqueCharacterFormat("styleName",e,t,i),this.addUniqueCharacterFormat("bidi",e,t,i),this.addUniqueCharacterFormat("bdo",e,t,i),this.addUniqueCharacterFormat("fontFamilyBidi",e,t,i),this.addUniqueCharacterFormat("fontSizeBidi",e,t,i),this.addUniqueCharacterFormat("boldBidi",e,t,i),this.addUniqueCharacterFormat("italicBidi",e,t,i),this.addUniqueCharacterFormat("allCaps",e,t,i),this.addUniqueCharacterFormat("localeIdBidi",e,t,i),this.addUniqueCharacterFormat("complexScript",e,t,i),this.uniqueCharacterFormat=s.uniqueCharacterFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueCharacterFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":case"bidi":case"boldBidi":case"italicBidi":case"allCaps":case"complexScript":t=!1;break;case"fontSize":case"fontSizeBidi":t=11;break;case"underline":case"strikethrough":case"bdo":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":case"fontFamilyBidi":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"localeIdBidi":t=0}return t},s.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.localeIdBidi===e.localeIdBidi&&this.complexScript===e.complexScript},s.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.uniqueCharacterFormat=this.uniqueCharacterFormat,e.baseCharStyle=this.baseCharStyle,e.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice(),e},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueCharacterFormat)&&!(0,a.le)(this.uniqueCharacterFormat.propertiesHash)){var t=ne.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},s.prototype.clearFormat=function(){!(0,a.le)(this.uniqueCharacterFormat)&&0===this.uniqueCharacterFormat.referenceCount&&s.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},s.prototype.destroy=function(){this.clearFormat()},s.prototype.copyFormat=function(e){(0,a.le)(e)||(!(0,a.le)(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),(0,a.le)(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),this.removedIds=e.revisions.length>0?Ke.cloneRevisions(e.revisions):e.removedIds.slice())},s.prototype.updateUniqueCharacterFormat=function(e){var t=void 0;this.uniqueCharacterFormat&&(t=this.uniqueCharacterFormat.mergeProperties(e.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(s.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new ne(s.uniqueFormatType),(0,a.le)(t)&&(t=this.uniqueCharacterFormat.mergeProperties(e.uniqueCharacterFormat)),this.uniqueCharacterFormat=s.uniqueCharacterFormats.addUniqueFormat(t,s.uniqueFormatType)},s.clear=function(){this.uniqueCharacterFormats.clear()},s.prototype.applyStyle=function(e){this.baseCharStyle=e},s.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},s.prototype.mergeFormat=function(e){(0,a.le)(this.getValue("bold"))&&(this.bold=e.getValue("bold")),(0,a.le)(this.getValue("italic"))&&(this.italic=e.getValue("italic")),(0,a.le)(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),(0,a.le)(this.getValue("fontFamily"))&&(this.fontFamily=e.getValue("fontFamily")),(0,a.le)(this.getValue("underline"))&&(this.underline=e.getValue("underline")),(0,a.le)(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),(0,a.le)(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),(0,a.le)(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),(0,a.le)(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),(0,a.le)(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),(0,a.le)(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),(0,a.le)(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),(0,a.le)(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),(0,a.le)(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript"))},s.prototype.hasValueWithParent=function(e){var t=this.hasValue(e);!t&&!(0,a.le)(this.baseCharStyle)&&this.baseCharStyle instanceof gt&&(t=this.baseCharStyle.characterFormat.hasValue(e));var i=this.documentCharacterFormat();return!t&&!(0,a.le)(i)&&(t=i.hasValue(e)),t},s.uniqueCharacterFormats=new rt,s.uniqueFormatType=2,s}(),w=function(){function s(){}return s.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},s.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},s.indexOfAny=function(e,t){for(var i=void 0,n=0;n<t.length;n++){var r=e.indexOf(t[n]);(-1!==r&&(0,a.le)(i)||-1!==r&&r<i)&&(i=r)}return(0,a.le)(i)?-1:i},s.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var n=0;n<=t.length-1;n++)if(e[i]===t[n])return i;return-1},s.convertArgbToRgb=function(e){return e.length>=8?e.substr(0,6):e},s.convertRgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},s.convertHexToRgb=function(e){var t,i,n;if(e){e=e.replace(/[^0-9A-\xe2\u20ac\u0152\xe2\u20ac\u2039F]/gi,"");var r=parseInt(e,16);return 8==e.length?(t=r>>32&255,i=r>>16&255,n=r>>8&255):6==e.length&&(t=r>>16&255,i=r>>8&255,n=255&r),{r:t,g:i,b:n}}},s.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},s.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},s.isVeryDark=function(e){var t=e.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},s.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},s.convertPointToPixel=function(e){return s.round(96*e/72,5)},s.convertPixelToPoint=function(e){return s.round(72*e/96,5)},s.isLinkedFieldCharacter=function(e){return e instanceof H&&0===e.fieldType?!(0,a.le)(e.fieldEnd):e instanceof H&&2===e.fieldType?!(0,a.le)(e.fieldBegin)&&!(0,a.le)(e.fieldEnd):!(0,a.le)(e.fieldBegin)},s.removeSpace=function(e){if(!(0,a.le)(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},s.trimStart=function(e){for(var t=0;t<e.length&&" "===e[t];t++);return e.substring(t,e.length)},s.trimEnd=function(e){for(var t=e.length-1;t>=0&&" "===e[t];t--);return e.substring(0,t+1)},s.endsWith=function(e){return!(0,a.le)(e)&&0!==e.length&&" "===e[e.length-1]},s.addSpace=function(e){var t="";if(e>0)for(var i=0;i<e;i++)t+=" ";return t},s.writeCharacterFormat=function(e,t,i){e.bold=t?i.bold:i.getValue("bold"),e.italic=t?i.italic:i.getValue("italic"),e.fontSize=t?this.toWriteInline(i,"fontSize"):i.getValue("fontSize"),e.fontFamily=t?this.toWriteInline(i,"fontFamily"):i.getValue("fontFamily"),e.underline=t?i.underline:i.getValue("underline"),e.strikethrough=t?i.strikethrough:i.getValue("strikethrough"),e.baselineAlignment=t?i.baselineAlignment:i.getValue("baselineAlignment"),e.highlightColor=t?i.highlightColor:i.getValue("highlightColor"),e.fontColor=t?this.toWriteInline(i,"fontColor"):i.getValue("fontColor"),e.styleName=(0,a.le)(i.baseCharStyle)?void 0:i.baseCharStyle.name,e.bidi=t?i.bidi:i.getValue("bidi"),e.bdo=t?i.bdo:i.getValue("bdo"),e.boldBidi=t?i.boldBidi:i.getValue("boldBidi"),e.italicBidi=t?i.italicBidi:i.getValue("italicBidi"),e.fontSizeBidi=t?i.fontSizeBidi:i.getValue("fontSizeBidi"),e.fontFamilyBidi=t?i.fontFamilyBidi:i.getValue("fontFamilyBidi"),e.allCaps=t?i.allCaps:i.getValue("allCaps"),e.localeIdBidi=t?i.localeIdBidi:i.getValue("localeIdBidi"),e.complexScript=t?i.complexScript:i.getValue("complexScript")},s.toWriteInline=function(e,t){return!(0,a.le)(e.ownerBase)&&e.ownerBase instanceof fe?e.hasValue(t)?e[t]:e.getValue(t):e[t]},s.round=function(e,t){for(var i=e,n=0;n<t;n++)i*=10;for(i=Math.round(i),n=0;n<t;n++)i/=10;return i},s.reverseString=function(e){if(!(0,a.le)(e)&&""!==e){var t=e.split("");e=t.reverse().join("")}return e},s.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},s.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},s.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},s.formatNumber=function(e,t){var i=new a.eC,n=t.split("."),r=i.parseNumber(t=n[0]);return"NaN"===t.toString()?"":(""===e&&(e="0"),i.formatNumber(r,{format:e}))},s.formatDate=function(e,t){var i=new a.eC,n=new Date(t);return isNaN(n.getDate())?"":""===e?t:(-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a")),i.formatDate(n,{format:e}))},s.capitaliseFirst=function(e,t,i){var n="";if("Titlecase"===t){for(var r=e.split(i||" "),o=0;o<r.length;o++)n+=i?r[o].charAt(0).toUpperCase()+r[o].slice(1,r[o].length):this.capitaliseFirstInternal(r[o]),r.length>=0&&!i&&(n+=" ");i||(n=this.capitaliseFirst(n,"Titlecase","\r"))}else"FirstCapital"===t&&(n=this.capitaliseFirstInternal(e));return n},s.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},s.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},s.getModifiedDate=function(e){var t=s.getLocaleDate(e);return t.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+t.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},s.getUtcDate=function(){var e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},s.getLocaleDate=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},s.getCompatibilityModeValue=function(e){var t;switch(e){case"Word2003":t="11";break;case"Word2007":t="12";break;case"Word2010":t="14";break;default:t="15"}return t},s.getUniqueElementId=function(){return"de_element"+Date.now().toString(36)+Math.random().toString(36).substring(2)},s.wordBefore="\\b",s.wordAfter="\\b",s.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","\u201d","\u3000","\u060c","\u061f","\u061b","\u2019","\u2018"],s}(),ce=function(){function s(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(s.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),s.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},s.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},s}(),Nn=function(){function s(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return s.prototype.encodeString=function(e){var i,n,r,o,l,h,d,t="",c=0;for(e=this.unicodeEncode(e);c<e.length;)o=(i=e.charCodeAt(c++))>>2,l=(3&i)<<4|(n=e.charCodeAt(c++))>>4,h=(15&n)<<2|(r=e.charCodeAt(c++))>>6,d=63&r,isNaN(n)?h=d=64:isNaN(r)&&(d=64),t=t+this.keyStr.charAt(o)+this.keyStr.charAt(l)+this.keyStr.charAt(h)+this.keyStr.charAt(d);return t},s.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?i+=String.fromCharCode(r):r>127&&r<2048?(i+=String.fromCharCode(r>>6|192),i+=String.fromCharCode(63&r|128)):(i+=String.fromCharCode(r>>12|224),i+=String.fromCharCode(r>>6&63|128),i+=String.fromCharCode(63&r|128))}return i},s.prototype.decodeString=function(e){var i,n,r,o,l,h,d=0,c=0,u=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&u--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&u--,u%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var p=new Uint8Array(0|u);d<e.length;)r=this.keyStr.indexOf(e.charAt(d++)),i=(15&(o=this.keyStr.indexOf(e.charAt(d++))))<<4|(l=this.keyStr.indexOf(e.charAt(d++)))>>2,n=(3&l)<<6|(h=this.keyStr.indexOf(e.charAt(d++))),p[c++]=r<<2|o>>4,64!==l&&(p[c++]=i),64!==h&&(p[c++]=n);return p},s.prototype.destroy=function(){this.keyStr=void 0},s}(),To=function(){function s(e,t){this.x=0,this.width=0,this.x=e,this.width=t}return Object.defineProperty(s.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),s}(),Dn=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),An=function(){return function(){}}(),Xe=function(s){function e(t){var i=s.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new ue(i),i.characterFormat=new ie(i),i}return Dn(e,s),e.prototype.destroy=function(){this.characterFormat.destroy(),this.paragraphFormat.destroy()},e.prototype.copyStyle=function(t){this.name=t.name,this.ownerBase=t.ownerBase,this.type=t.type,this.next=t.next,this.basedOn=t.basedOn,this.link=t.link,this.characterFormat.copyFormat(t.characterFormat),this.paragraphFormat.copyFormat(t.paragraphFormat)},e}(An),gt=function(s){function e(t){var i=s.call(this)||this;return i.ownerBase=t,i.characterFormat=new ie(i),i}return Dn(e,s),e.prototype.destroy=function(){this.characterFormat.destroy()},e.prototype.copyStyle=function(t){this.name=t.name,this.ownerBase=t.ownerBase,this.type=t.type,this.next=t.next,this.basedOn=t.basedOn,this.characterFormat.copyFormat(t.characterFormat)},e}(An),pi=function(){function s(){this.collection=[]}return Object.defineProperty(s.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),s.prototype.remove=function(e){this.collection=this.collection.filter(function(t){return t.name!==e.name})},s.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},s.prototype.getItem=function(e){return this.collection.length>e?this.collection[e]:null},s.prototype.indexOf=function(e){return this.collection.indexOf(e)},s.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},s.prototype.clear=function(){for(;this.collection.length>0;)this.collection.pop()},s.prototype.findByName=function(e,t){for(var i,n=0,r=this.collection;n<r.length;n++){var o=r[n];o.name===e&&(i=o,(0,a.le)(t)||o.type!==t&&(i=void 0))}return i},s.prototype.getStyleNames=function(e){return this.collection.filter(function(t){return t.type===e}).map(function(t){return t.name})},s.prototype.getStyles=function(e){for(var i=[],n=0,r=this.collection.filter(function(d){return d.type===e}).map(function(d){return d});n<r.length;n++){var o=r[n],l={},h={characterFormat:{}};w.writeCharacterFormat(h.characterFormat,!0,o.characterFormat),l.name=o.name,l.style=JSON.stringify(h),i.push(l)}return i},s}(),ot=function(){function s(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(s.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(i))return this.uniqueShadingFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueShadingFormat))this.initializeUniqueShading(e,t);else{var i=ne.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);if(this.uniqueShadingFormat.propertiesHash.containsKey(i)&&this.uniqueShadingFormat.propertiesHash.get(i)===t)return;this.uniqueShadingFormat=s.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,e,t)}},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},s.prototype.initializeUniqueShading=function(e,t){var i=new U;this.addUniqueShading("backgroundColor",e,t,i),this.addUniqueShading("foregroundColor",e,t,i),this.addUniqueShading("textureStyle",e,t,i),this.uniqueShadingFormat=s.uniqueShadingFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueShading=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);n.add(r,e===t?i:s.getPropertyDefaultValue(e))},s.prototype.destroy=function(){(0,a.le)(this.uniqueShadingFormat)||s.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.backgroundColor=this.backgroundColor,e.foregroundColor=this.foregroundColor,e.textureStyle=this.textureStyle,e},s.prototype.copyFormat=function(e){!(0,a.le)(e)&&!(0,a.le)(e.uniqueShadingFormat)&&(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueShadingFormat)){var t=ne.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},s.clear=function(){this.uniqueShadingFormats.clear()},s.uniqueShadingFormats=new rt,s.uniqueFormatType=5,s}(),Oe=function(){function s(e){this.uniqueTableFormat=void 0,this.borders=new _e(this),this.shading=new ot(this),this.ownerBase=void 0,this._styleName=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(s.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(i))return this.uniqueTableFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueTableFormat))this.initializeUniqueTableFormat(e,t);else{var i=ne.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);if(this.uniqueTableFormat.propertiesHash.containsKey(i)&&this.uniqueTableFormat.propertiesHash.get(i)===t)return;this.uniqueTableFormat=s.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,e,t)}},s.prototype.initializeUniqueTableFormat=function(e,t){var i=new U;this.addUniqueTableFormat("allowAutoFit",e,t,i),this.addUniqueTableFormat("cellSpacing",e,t,i),this.addUniqueTableFormat("leftMargin",e,t,i),this.addUniqueTableFormat("topMargin",e,t,i),this.addUniqueTableFormat("bottomMargin",e,t,i),this.addUniqueTableFormat("rightMargin",e,t,i),this.addUniqueTableFormat("leftIndent",e,t,i),this.addUniqueTableFormat("tableAlignment",e,t,i),this.addUniqueTableFormat("preferredWidth",e,t,i),this.addUniqueTableFormat("preferredWidthType",e,t,i),this.addUniqueTableFormat("bidi",e,t,i),this.addUniqueTableFormat("horizontalPositionAbs",e,t,i),this.addUniqueTableFormat("horizontalPosition",e,t,i),this.uniqueTableFormat=s.uniqueTableFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueTableFormat=function(e,t,i,n){var r;r=ne.getPropertyType(s.uniqueFormatType,e),e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":case"bidi":t=!1;break;case"cellSpacing":case"topMargin":case"bottomMargin":case"leftIndent":case"preferredWidth":case"horizontalPosition":t=0;break;case"leftMargin":case"rightMargin":t=5.4;break;case"tableAlignment":t="Left";break;case"preferredWidthType":t="Point";break;case"horizontalPositionAbs":t=null}return t},s.prototype.assignTableMarginValue=function(e,t,i,n){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=n},s.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},s.prototype.destroy=function(){(0,a.le)(this.borders)||this.borders.destroy(),(0,a.le)(this.shading)||this.shading.destroy(),(0,a.le)(this.uniqueTableFormat)||s.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.borders=void 0,this.shading=void 0},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.leftIndent=this.leftIndent,e.tableAlignment=this.tableAlignment,e.cellSpacing=this.cellSpacing,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.preferredWidth=this.preferredWidth,e.preferredWidthType=this.preferredWidthType,e.horizontalPositionAbs=this.horizontalPositionAbs,e.horizontalPosition=this.horizontalPosition,e.borders=(0,a.le)(this.borders)?void 0:this.borders.cloneFormat(),e.shading=(0,a.le)(this.shading)?void 0:this.shading.cloneFormat(),e.bidi=this.bidi,e.allowAutoFit=this.allowAutoFit,e.styleName=this.styleName,e},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueTableFormat)){var t=ne.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},s.prototype.copyFormat=function(e){(0,a.le)(e)||((0,a.le)(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),(0,a.le)(e.borders)||(this.borders=new _e(this),this.borders.copyFormat(e.borders)),(0,a.le)(e.shading)||(this.shading=new ot(this),this.shading.copyFormat(e.shading)))},s.clear=function(){this.uniqueTableFormats.clear()},s.uniqueTableFormats=new rt,s.uniqueFormatType=8,s}(),it=function(){function s(e){this.uniqueCellFormat=void 0,this.borders=new _e(this),this.shading=new ot(this),this.ownerBase=e,this.borders=new _e(this),this.shading=new ot(this)}return Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var i=ne.getPropertyType(s.uniqueFormatType,e);if(!(0,a.le)(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(i))return this.uniqueCellFormat.propertiesHash.get(i)}return s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueCellFormat))this.initializeUniqueCellFormat(e,t);else{var i=ne.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);if(this.uniqueCellFormat.propertiesHash.containsKey(i)&&this.uniqueCellFormat.propertiesHash.get(i)===t)return;this.uniqueCellFormat=s.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,e,t)}},s.prototype.initializeUniqueCellFormat=function(e,t){var i=new U;this.addUniqueCellFormat("leftMargin",e,t,i),this.addUniqueCellFormat("topMargin",e,t,i),this.addUniqueCellFormat("bottomMargin",e,t,i),this.addUniqueCellFormat("rightMargin",e,t,i),this.addUniqueCellFormat("cellWidth",e,t,i),this.addUniqueCellFormat("columnSpan",e,t,i),this.addUniqueCellFormat("rowSpan",e,t,i),this.addUniqueCellFormat("preferredWidth",e,t,i),this.addUniqueCellFormat("verticalAlignment",e,t,i),this.addUniqueCellFormat("preferredWidthType",e,t,i),this.uniqueCellFormat=s.uniqueCellFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueCellFormat=function(e,t,i,n){var r=ne.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":case"preferredWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},s.prototype.containsMargins=function(){return!((0,a.le)(this.leftMargin)&&(0,a.le)(this.rightMargin)&&(0,a.le)(this.bottomMargin)&&(0,a.le)(this.topMargin))},s.prototype.destroy=function(){(0,a.le)(this.borders)||this.borders.destroy(),(0,a.le)(this.shading)||this.shading.destroy(),(0,a.le)(this.uniqueCellFormat)||s.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.verticalAlignment=this.verticalAlignment,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.preferredWidth=this.preferredWidth,e.preferredWidthType=this.preferredWidthType,e.cellWidth=this.cellWidth,e.borders=(0,a.le)(this.borders)?void 0:this.borders.cloneFormat(),e.shading=(0,a.le)(this.shading)?void 0:this.shading.cloneFormat(),e},s.prototype.hasValue=function(e){if(!(0,a.le)(this.uniqueCellFormat)){var t=ne.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},s.prototype.copyFormat=function(e){(0,a.le)(e)||((0,a.le)(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),(0,a.le)(e.shading)||(this.shading=new ot(this),this.shading.copyFormat(e.shading)),(0,a.le)(e.borders)||(this.borders=new _e(this),this.borders.copyFormat(e.borders)))},s.clear=function(){this.uniqueCellFormats.clear()},s.uniqueCellFormats=new rt,s.uniqueFormatType=4,s}(),et=function(){function s(){this.abstractListIdIn=-1,this.levels=[]}return Object.defineProperty(s.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){if(!(0,a.le)(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[e];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},s.prototype.clone=function(){for(var e=new s,t=0;t<this.levels.length;t++)e.levels.push(this.levels[t].clone(e));return e},s}(),nt=function(){function s(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,this.ownerBase=e,this.characterFormat=new ie(void 0),this.paragraphFormat=new ue(void 0)}return Object.defineProperty(s.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){var t=ne.getPropertyType(s.uniqueFormatType,e);return!(0,a.le)(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(t)?this.uniqueListLevel.propertiesHash.get(t):s.getPropertyDefaultValue(e)},s.prototype.setPropertyValue=function(e,t){if(((0,a.le)(t)||""===t)&&(t=s.getPropertyDefaultValue(e)),(0,a.le)(this.uniqueListLevel))this.initializeUniqueWListLevel(e,t);else{var i=ne.getPropertyType(this.uniqueListLevel.uniqueFormatType,e);if(this.uniqueListLevel.propertiesHash.containsKey(i)&&this.uniqueListLevel.propertiesHash.get(i)===t)return;this.uniqueListLevel=s.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,e,t)}},s.prototype.initializeUniqueWListLevel=function(e,t){var i=new U;this.addUniqueWListLevel("listLevelPattern",e,t,i),this.addUniqueWListLevel("startAt",e,t,i),this.addUniqueWListLevel("followCharacter",e,t,i),this.addUniqueWListLevel("numberFormat",e,t,i),this.addUniqueWListLevel("restartLevel",e,t,i),this.uniqueListLevel=s.uniqueListLevels.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueWListLevel=function(e,t,i,n){var r;r=ne.getPropertyType(s.uniqueFormatType,e),n.add(r,e===t?i:s.getPropertyDefaultValue(e))},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":case"restartLevel":t=0;break;case"followCharacter":t="Tab";break;case"numberFormat":t=""}return t},s.prototype.destroy=function(){(0,a.le)(this.characterFormat)||this.characterFormat.destroy(),(0,a.le)(this.paragraphFormat)||this.paragraphFormat.destroy(),(0,a.le)(this.uniqueListLevel)||s.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0},s.clear=function(){this.uniqueListLevels.clear()},s.prototype.clone=function(e){var t=new s(e);return t.paragraphFormat=this.paragraphFormat.cloneFormat(),t.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(t.uniqueListLevel=this.uniqueListLevel,t.uniqueListLevel.referenceCount++),t},s.dotBullet=String.fromCharCode(61623),s.squareBullet=String.fromCharCode(61607),s.arrowBullet=String.fromCharCode(10148),s.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),s.uniqueListLevels=new rt,s.uniqueFormatType=9,s}(),Bn=function(){function s(e){this.paragraphMarkInfo={},this.documentHelper=e,(0,a.le)(e)||(this.context=e.containerContext)}return Object.defineProperty(s.prototype,"paragraphMark",{get:function(){return"\xb6"},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineBreakMark",{get:function(){return"\u21b2"},enumerable:!0,configurable:!0}),s.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},s.prototype.repeatChar=function(e,t){for(var i="",n=0;n<t;n++)i+=e;return i},s.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},s.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);if(this.paragraphMarkInfo[t])return this.paragraphMarkInfo[t];var i=this.getWidth(this.paragraphMark,e),n=this.getHeight(e);return this.paragraphMarkInfo[t]={Width:i,Height:n.Height,BaselineOffset:n.BaselineOffset}},s.prototype.getTextSize=function(e,t){var i=0,n=t.bidi||this.isRTLText(e.text),r=this.setText(e.text,n,t.bdo);i=this.getWidth(r,t),e.width=i;var o=this.getHeight(t);return e.height=o.Height,e.baselineOffset=o.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(w.trimEnd(e.text),t)),e.trimEndWidth=i,i},s.prototype.getHeight=function(e){var t=this.getFormatText(e);if(!(0,a.le)(this.documentHelper.heightInfoCollection[t]))return this.documentHelper.heightInfoCollection[t];var i=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e);return this.documentHelper.heightInfoCollection[t]=i,i},s.prototype.getFormatText=function(e){var t=e.fontFamily.toLocaleLowerCase();return t+=";"+e.fontSize,e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},s.prototype.measureTextExcludingSpaceAtEnd=function(e,t){return this.getWidth(w.trimEnd(e),t)},s.prototype.getWidth=function(e,t){e.match("\v")&&e.replace("\v",this.lineBreakMark);var o=t.fontSize;return this.context.font=(t.bold?"bold":"")+" "+(t.italic?"italic":"")+" "+(o=0===o?.5:o/("Normal"===t.baselineAlignment?1:1.5))+"pt "+t.fontFamily,t.allCaps&&(e=e.toUpperCase()),this.context.measureText(e).width},s.prototype.setText=function(e,t,i,n){if((0,a.le)(n)&&(n=!1),0===e.length)return"";var r=t;if(!r&&"RTL"===i||r&&"LTR"===i)e=w.reverseString(e);else if(n&&r&&w.endsWith(e)){var o=e.length-w.trimEnd(e).length;e=w.addSpace(o)+w.trimEnd(e)}return e},s.prototype.measureText=function(e,t){var i=this.getWidth(e,t),n=this.getHeight(t);return{Width:i,Height:n.Height,BaselineOffset:n.BaselineOffset}},s.prototype.updateTextSize=function(e,t){var i=new ie(void 0),n=e.listLevel.characterFormat,r=t.characterFormat;i.fontSize=n.hasValue("fontSize")?n.fontSize:r.fontSize,i.fontFamily=n.hasValue("fontFamily")?n.fontFamily:r.fontFamily;var o,l,h="Normal"===n.baselineAlignment?r.baselineAlignment:n.baselineAlignment;o=n.hasValue("bold")?n.bold?"bold":"":r.bold?"bold":"",l=n.hasValue("italic")?n.italic?"italic":"":r.italic?"italic":"",i.baselineAlignment=h,o&&(i.bold=!0),l&&(i.italic=!0);var d=i.bidi||this.isRTLText(e.text),c=this.setText(e.text,d,i.bdo);e.width=this.getWidth(c,i);var u=this.getHeight(i);e.height=u.Height,e.baselineOffset=u.BaselineOffset},s.prototype.containsSpecialCharAlone=function(e){for(var i=0;i<e.length;i++)if(-1==="*|.:[]{}-`;()@&$#%!~?, '".indexOf(e.charAt(i)))return!1;return!0},s.prototype.containsNumberAlone=function(e){if(""===e)return!1;for(var i=0;i<e.length;i++)if(-1==="0123456789".indexOf(e.charAt(i)))return!1;return!0},s.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},s.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},s.prototype.containsSpecialChar=function(e){for(var i=0;i<e.length;i++)if(-1!=="*|.:[]{}-`;()@&$#%!~? ".indexOf(e.charAt(i)))return!0;return!1},s.prototype.isRTLText=function(e){var t=!1;if(!(0,a.le)(e))for(var i=0;i<e.length;i++){var n=e[i];if(n>=String.fromCharCode(1424)&&n<=String.fromCharCode(1535)||n>=String.fromCharCode(64285)&&n<=String.fromCharCode(64335)||n>=String.fromCharCode(1536)&&n<=String.fromCharCode(1791)||n>=String.fromCharCode(1872)&&n<=String.fromCharCode(1919)||n>=String.fromCharCode(2208)&&n<=String.fromCharCode(2303)||n>=String.fromCharCode(64336)&&n<=String.fromCharCode(65023)||n>=String.fromCharCode(65136)&&n<=String.fromCharCode(65279)||n>=String.fromCharCode(43392)&&n<=String.fromCharCode(43487)||n>=String.fromCharCode(1792)&&n<=String.fromCharCode(1871)||n>=String.fromCharCode(1920)&&n<=String.fromCharCode(1983)||n>=String.fromCharCode(2112)&&n<=String.fromCharCode(2143)||n>=String.fromCharCode(1984)&&n<=String.fromCharCode(2047)||n>=String.fromCharCode(2048)&&n<=String.fromCharCode(2111)||n>=String.fromCharCode(11568)&&n<=String.fromCharCode(11647)){t=!0;break}}return t},s.prototype.getRtlLanguage=function(e){return(0,a.le)(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},s.prototype.splitTextByConsecutiveLtrAndRtl=function(e,t,i,n,r,o){var l=n.length,h=[];if((0,a.le)(e)||""===e)return h;for(var d=-1,c="",u="",p="",f="",g=0;g<e.length;g++){var m=0,v=!1;((0,a.le)(r.value)?t:!r.value)&&this.isNumber(e[g])?(f+=e[g],m=4):this.isWordSplitChar(e[g])?(m=2,v=t||32==e.charCodeAt(g)&&""==p,p+=e[g]):this.isRTLText(e[g])&&!this.isNumber(e[g])?(r.value=!1,o.value=!0,u+=e[g],m=1):(r.value=!0,c+=e[g]),""!=f&&4!=m&&(h.push(f),n.push(z.Number),f=""),""!=u&&1!=m&&(h.push(u),n.push(z.RightToLeft),u=""),""!=c&&0!=m&&(h.push(c),d=h.length-1,n.push(z.LeftToRight),c=""),""!=p&&(2!=m||v)&&(h.push(p),n.push(z.WordSplit),p="")}if(""!=f?(h.push(f),n.push(z.Number)):""!=u?(h.push(u),n.push(z.RightToLeft)):""!=c?(h.push(c),d=h.length-1,n.push(z.LeftToRight)):""!=p&&(h.push(p),n.push(z.WordSplit)),o.value||!(0,a.le)(r.value)&&!r.value)for(g=1;g<h.length;g++)(y=n[g+l])==z.WordSplit&&1==h[g].length&&g+l+1<n.length&&n[g+l-1]!=z.WordSplit&&(n[g+l-1]!=z.Number||s.isNumberNonReversingCharacter(h[g],t))&&n[g+l-1]==n[g+l+1]&&(h[g-1]=h[g-1]+h[g]+h[g+1],h.splice(g,1),h.splice(g,1),n.splice(g+l,1),n.splice(g+l,1),g--);else if(-1!=d)if(t){for(g=1;g<d;g++)if((y=n[g+l])==z.WordSplit&&g<d&&n[g+l-1]==z.LeftToRight){c="";for(var b=g+1;b<=d;b++)c+=h[b],h.splice(b,1),n.splice(b+l,1),b--,d--;h[g-1]=h[g-1]+h[g]+c,h.splice(g,1),n.splice(g+l,1),g--,d--}}else h.length=0,h.push(e);else t||(h.length=0,h.push(e));if(t)for(g=1;g<h.length;g++){var y;(y=n[g+l])==z.WordSplit&&1==h[g].length&&g+l+1<n.length&&n[g+l-1]!=z.WordSplit&&(n[g+l-1]!=z.Number||s.isNumberNonReversingCharacter(h[g],t)||!i)&&n[g+l-1]==n[g+l+1]?(h[g-1]=h[g-1]+h[g]+h[g+1],h.splice(g,1),h.splice(g,1),n.splice(g+l,1),n.splice(g+l,1),g--):y==z.WordSplit&&n[g+l-1]==z.Number&&this.isNonWordSplitCharacter(h[g])&&!i?(h[g-1]=h[g-1]+h[g],h.splice(g,1),n.splice(g+l,1),g--):y==z.LeftToRight&&(n[g+l-1]==z.Number||n[g+l-1]==z.LeftToRight)&&(h[g-1]=h[g-1]+h[g],n[g+l-1]=z.LeftToRight,h.splice(g,1),n.splice(g+l,1),g--)}return h},s.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},s.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785)},s.prototype.isWordSplitChar=function(e){for(var t=0;t<s.wordSplitCharacters.length;t++)if(s.wordSplitCharacters[t]===e)return!0;return!1},s.isNumberNonReversingCharacter=function(e,t){for(var i=0;i<s.numberNonReversingCharacters.length;i++){var n=s.numberNonReversingCharacters[i];if(e[0]==n&&(47!=n.charCodeAt(0)||!t))return!0}return!1},s.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var n=e.charCodeAt(i);if(35!=n&&36!=n&&37!=n){t=!1;break}t=!0}return t},s.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},s.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],s.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)],s}(),Mn=function(){function s(e){this.islayoutFootnote=!1,this.allowLayout=!0,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.layoutedFootnoteElement=[],this.documentHelper=e}return s.prototype.isSameStyle=function(e,t){var i=void 0;if(t?e.nextWidget instanceof I&&(i=e.nextWidget):e.previousWidget instanceof I&&(i=e.previousWidget),(0,a.le)(i))return!1;if(e.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle){if(e.paragraphFormat.listFormat.listId>=0&&i.paragraphFormat.listFormat.listId>=0&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing}return!1},Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.layout=function(){},s.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0},s.prototype.layoutItems=function(e,t){for(var n,i=this,r=0;r<e.length;r++){var o=e[r];if(r>0&&e[r-1].lastChild.isEndsWithPageBreak&&0===this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0].childWidgets.length&&this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1),n=this.viewer.createNewPage(o),this.addBodyWidget(this.viewer.clientActiveArea,o),this.documentHelper.pages.length>1){for(var h=0,d=0;d<this.documentHelper.pages.length;d++){var c=this.documentHelper.pages[d];if(c.sectionIndex>o.index||c===n)break;h++}h<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(h,n)}this.layoutSection(o,0)}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout(function(){i.documentHelper&&(i.documentHelper.isScrollHandler=!0,i.documentHelper.owner.isSpellCheck&&i.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(i.documentHelper.triggerElementsOnLoading=!0),i.documentHelper.clearContent(),i.viewer.updateScrollBars(),i.documentHelper.isScrollHandler=!1,i.isInitialLoad=!1)},50)},s.prototype.layoutComments=function(e){(0,a.le)(e)||this.viewer.owner.commentReviewPane.layoutComments()},s.prototype.layoutSection=function(e,t){var n,r,i=e.firstChild;do{i instanceof k&&"Auto"===i.tableFormat.preferredWidthType&&!i.tableFormat.allowAutoFit&&i.calculateGrid(),this.viewer.updateClientAreaForBlock(i,!0,void 0,!0),n=this.layoutBlock(i,t),t=0,this.viewer.updateClientAreaForBlock(i,!1),i=n}while(i);for((i=e.firstChild)&&i.bodyWidget&&i.bodyWidget.page&&(r=i.bodyWidget.page);r;)r.footnoteWidget&&this.layoutfootNote(r.footnoteWidget),r=r.nextPage;r=void 0,i=void 0},s.prototype.layoutHeaderFooter=function(e,t,i){var n=t.getCurrentPageHeaderFooter(e,!0);if(n){var r=n;(0,a.le)(n.page)&&(n.page=i,n.height=0,this.clearBlockWidget(n.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,n)),(n=r.clone()).parentHeaderFooter=r,this.clearBlockWidget(n.childWidgets,!0,!0,!0);var o=n;o.page=i,o.height=0,this.updateRevisionsToHeaderFooter(o,i),t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,o)}if(n=t.getCurrentPageHeaderFooter(e,!1)){r=n,(0,a.le)(n.page)&&(n.page=i,n.height=0,this.clearBlockWidget(n.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,n)),(n=r.clone()).parentHeaderFooter=r,this.clearBlockWidget(n.childWidgets,!0,!0,!0);var l=n;l.page=i,l.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(l,i),i.footerWidget=this.layoutHeaderFooterItems(t,l)}},s.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),n=e.clone();this.documentHelper.headersFooters[t][i]=n;for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o instanceof k&&this.clearTableWidget(o,!1,!0)}return n},s.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof Ce&&i.length>0)for(var n=0;n<i.length;n++)if(i[n].childWidgets.length>0)for(var r=i[n].childWidgets,o=0;o<r.length;o++){var l=r[o].children;if(l)for(var h=0;h<l.length;h++)if(l[h].removedIds.length>0)for(var d=l[h].removedIds,c=0;c<d.length;c++){var u=this.documentHelper.revisionsInternal.get(d[c]);l[h].revisions[c]=u,this.updateRevisionRange(u,t)}}},s.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var n=e.range[i];n.line.paragraph.bodyWidget.page||(n.line.paragraph.bodyWidget.page=t)}},s.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof I?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},s.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(r instanceof H&&(0!==r.fieldType||0===r.fieldType&&-1===this.documentHelper.fields.indexOf(r))&&r.linkFieldCharacter(this.documentHelper),r instanceof st&&r.fieldBegin!==r.previousElement.fieldBegin&&(r.fieldBegin=r.previousElement.fieldBegin),r instanceof de){var o=r.textFrame.firstChild;if(o)do{o instanceof I?this.linkFieldInParagraph(o):this.linkFieldInTable(o)}while(o=o.nextWidget)}else if(r instanceof ae){var l=this.getCommentById(r.commentId);(0,a.le)(l)||(0===r.commentType?l.commentStart=r:l.commentEnd=r,r.comment=l)}}},s.prototype.getCommentById=function(e){for(var t=0;t<this.documentHelper.comments.length;t++){var i=this.documentHelper.comments[t];if(i.commentId===e)return i}},s.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var l=r.childWidgets[o];l instanceof I?this.linkFieldInParagraph(l):this.linkFieldInTable(l)}},s.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new I,n=new oe(i);i.childWidgets.push(n),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o instanceof k&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&!o.isGridUpdated&&o.calculateGrid(),e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var l=t.headerFooterType;return("OddFooter"===l||"EvenFooter"===l||"FirstPageFooter"===l)&&this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},s.prototype.shiftChildLocation=function(e,t){var i=t.y+e;e=(i=Math.max(i,t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40))-t.y;for(var r=t.y=i,o=0;o<t.childWidgets.length;o++){var l=t.childWidgets[o];if(l instanceof I){l.x=l.x,l.y=0===o?l.y+e:r,r+=l.height;for(var h=0;h<l.childWidgets.length;h++)for(var d=l.childWidgets[h],c=0;c<d.children.length;c++){var u=d.children[c];if(u instanceof Pe&&"Inline"!==u.textWrappingStyle){if("Paragraph"===u.verticalOrigin||"Line"===u.verticalOrigin)u.y=l.y+u.verticalPosition;else{var p=this.getFloatingItemPoints(u);u.y=p.y}u instanceof de&&this.updateChildLocationForCellOrShape(u.y+u.textFrame.marginTop,u)}}}else this.shiftChildLocationForTableWidget(l,e),r+=l.height}},s.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n instanceof Q&&this.shiftChildLocationForTableRowWidget(n,t)}},s.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},s.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof I?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},s.prototype.layoutBlock=function(e,t){var i;if(e instanceof I){e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0),i=this.layoutParagraph(e,t);var n=this.checkAndRelayoutPreviousOverlappingBlock(e);n&&(i=n)}else i=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(i);return i.nextRenderedWidget},s.prototype.updateTableYPositionBasedonTextWrap=function(e){var t=this;if(!(0,a.le)(e.bodyWidget)){var i=e.y,n=new re(e.x,e.y,e.width,e.height);e.bodyWidget.floatingElements.forEach(function(r){if(r instanceof de&&!r.paragraph.isInsideTable){var o=new re(r.x,r.y,r.width,r.height);"TopAndBottom"!==r.textWrappingStyle&&"Square"!==r.textWrappingStyle||!n.isIntersecting(o)||(e.y=r.y+r.height+r.distanceBottom,t.updateChildLocationForTable(e.y,e),t.viewer.cutFromTop(t.viewer.clientActiveArea.y+(e.y-i)))}})}},s.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof be||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof I)if(e.floatingElements.length>0)for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i];if("InFrontOfText"!==n.textWrappingStyle&&"Behind"!==n.textWrappingStyle&&"Inline"!==n.textWrappingStyle){for(var r=new re(n.x,n.y,n.width,n.height);t;){if(t instanceof I){var o=new re(t.x,t.y,t.width,t.height);r.isIntersecting(o)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}}else{var l=e.getSplitWidgets();if(l)return l[l.length-1]}else{var h=e;if(!h.wrapTextAround)return h;for(var d=new re(h.x,h.y,h.getTableCellWidth(),h.height);t;){if(t instanceof I){var c=new re(t.x,t.y,t.width,t.height);d.isIntersecting(c)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},s.prototype.addParagraphWidget=function(e,t){if(!t.isEmpty()||(0,a.le)(t.paragraphFormat)||"Center"!==t.paragraphFormat.textAlignment&&"Right"!==t.paragraphFormat.textAlignment||-1!==t.paragraphFormat.listFormat.listId)this.viewer.clientActiveArea.width<=0&&this.viewer instanceof Se?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0;else{var i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat);t.clientX=e.x;var n=e.x;n+="Center"===t.paragraphFormat.textAlignment?(e.width-i)/2:e.width-i,t.width=i,t.x=n,t.y=e.y}return t},s.prototype.addLineWidget=function(e){var t=void 0;return(t=new oe(e)).width=e.width,e.childWidgets.push(t),t.paragraph=e,t},s.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof ye){var i=e.childWidgets[0];if(i)for(var n=i.children[0];n;){if(!(n instanceof O&&n.name.indexOf("_")>=0)){n instanceof S&&"\f"===n.text&&(t=!0);break}n=n.nextElement}}return t},s.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){var t=this.viewer.clientActiveArea.clone(),i=this.viewer.clientArea.clone();"Footnote"===e.footNoteType&&this.viewer.updateFootnoteClientArea(e.sectionFormat,e),e.height=0;var n=void 0,r=0;this.isRelayoutFootnote=!1;for(var o=0,l=0;l<e.bodyWidgets.length;l++){if(0===l){var h=new I;h.characterFormat=new ie,h.paragraphFormat=new ue,h.index=0;var d=new oe(h);h.childWidgets.push(d),r=this.documentHelper.textHelper.getParagraphMarkSize(h.characterFormat).Height,e.height+=r,e.y=this.viewer.clientActiveArea.y,this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r),e.margin=new $e(0,r,0,0)}for(var c=0;c<e.bodyWidgets[l].childWidgets.length;c++)(n=e.bodyWidgets[l].childWidgets[c]).index=o,o++,n.containerWidget=e.bodyWidgets[l],n.containerWidget.page=e.page,n.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(n,!0),n instanceof k&&(this.clearTableWidget(n,!0,!0,!0),this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY),this.layoutBlock(n,0),"Footnote"===e.footNoteType&&(e.height+=n.height),this.viewer.updateClientAreaForBlock(n,!1)}"Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),this.viewer.clientActiveArea=t,this.viewer.clientArea=i,!this.islayoutFootnote&&this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y&&(this.viewer.clientActiveArea.height-=e.height,this.viewer.clientActiveArea.height-=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y)}return this.footnoteHeight=0,e},s.prototype.shiftChildWidgetInFootnote=function(e){var t=e.page,i=e.y-e.height;if(1===t.bodyWidgets[0].childWidgets.length&&t.bodyWidgets[0].firstChild){var n=t.bodyWidgets[0].firstChild.y,r=this.getBodyWidgetHeight(t.bodyWidgets[0]);i<n+r&&(i=n+r)}e.y=i,i+=e.margin.top;for(var o=0;o<e.bodyWidgets.length;o++)for(var l=0;l<e.bodyWidgets[o].childWidgets.length;l++){var h=e.bodyWidgets[o].childWidgets[l];h instanceof I?(h.y=i,i+=h.height):(this.shiftChildLocationForTableWidget(h,i-h.y),i+=h.height)}},s.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},s.prototype.layoutParagraph=function(e,t){this.addParagraphWidget(this.viewer.clientActiveArea,e);var i=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e),i=!1),e.isEmpty())this.layoutEmptyLineWidget(e,!0);else{var r=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(!this.isRelayoutOverlap&&!(e.containerWidget instanceof be)&&this.layoutFloatElements(e);r instanceof oe;){if(e!==r.paragraph&&0===r.indexInOwner&&i&&this.layoutListItems(r.paragraph),r.isFirstLine()&&(0,a.le)(this.fieldBegin)&&!(0,a.le)(e.paragraphFormat)){var o=-w.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(o)}r.marginTop=0,e=(r=this.layoutLine(r,0)).paragraph,r=r.nextLine}}return this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e},s.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},s.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach(function(i){i instanceof Pe&&"Inline"!==i.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(i))})},s.prototype.layoutShape=function(e){if("Inline"!==e.textWrappingStyle){var t=this.getFloatingItemPoints(e);e.x=t.x,e.y=t.y,0!==e.paragraph.indexInOwner&&e.verticalPosition>=0&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&this.moveToNextPage(this.viewer,e.line);var i=e.paragraph.bodyWidget;-1===i.floatingElements.indexOf(e)&&(i.floatingElements.push(e),i.floatingElements.sort(function(c,u){return c.y-u.y})),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)}else if(0===e.width&&0!==e.widthScale){var n=w.convertPointToPixel(e.line.paragraph.getContainerWidth());e.width=n/100*e.widthScale}var r=this.viewer.clientArea,o=this.viewer.clientActiveArea;if(e instanceof de){var l=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var h=0;h<l.length;h++){var d=l[h];this.viewer.updateClientAreaForBlock(d,!0),d instanceof k&&this.clearTableWidget(d,!0,!0),this.layoutBlock(d,0),this.viewer.updateClientAreaForBlock(d,!1)}}this.viewer.clientActiveArea=o,this.viewer.clientArea=r},s.prototype.moveElementFromNextLine=function(e){for(var t=e.nextLine;t instanceof oe;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},s.prototype.layoutLine=function(e,t){var i=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var n=e.children[t],r=!0;if(n instanceof H&&e.children[e.children.length-1]instanceof H){r=!1;for(var o=0;o<e.children.length;o++)if(2==e.children[o].fieldType&&null!=e.children[o].nextElement&&!(e.children[o].nextElement instanceof H)){r=!0;break}}for(this.clearLineMeasures(),e.marginTop=0;n instanceof fe;)if(n.padding.left=0,r?this.layoutElement(n,i):(this.layoutElement(n,i,!0),r=!0),e=n.line,n instanceof S&&!(0,a.le)((l=n).errorCollection)&&l.errorCollection.length>0&&(l.ischangeDetected=!0),this.isRTLLayout)n=void 0,this.isRTLLayout=!1;else{var h=i.childWidgets.indexOf(n.line);if(h>0&&this.hasFloatingElement)this.hasFloatingElement=!1,i.bodyWidget.floatingElements.length>0&&n instanceof S&&!(i.containerWidget instanceof V)&&(n=i.childWidgets[h].children[0]);else{if(this.hasFloatingElement=!1,this.is2013Justification&&!(0,a.le)(this.nextElementToLayout))n=this.nextElementToLayout;else if((n=n.nextElement)instanceof S&&0==n.text.indexOf(" ")&&n.text.length>2&&(0,a.le)(n.nextElement)&&n.text.trim().length>0){n.text=n.text.substring(1,n.text.length);var l,d=n.line.children.indexOf(n);n.line.children.splice(d,1),(l=new S).text=" ",l.line=n.line,l.characterFormat.copyFormat(n.characterFormat),n.line.children.splice(d,0,l),n.line.children.splice(d+1,0,n),n=l}this.nextElementToLayout=void 0}}return e},s.prototype.layoutElement=function(e,t,i){var n=e.line,r="",o=e.indexInOwner;if(e instanceof H){if(0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),!(0,a.le)(e.formFieldData)&&-1===this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&(0,a.le)(e.nextNode)&&!this.isFieldCode)2!==e.fieldType&&(0,a.le)(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n);else if((0,a.le)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine())this.moveElementFromNextLine(n),e.line.isLastLine()&&(0,a.le)(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&(0,a.le)(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n));else if((0,a.le)(e.nextElement)&&0===this.viewer.clientActiveArea.width)this.moveToNextLine(n),n.paragraph.lastChild===n&&!(0,a.le)(n.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(n);else if(i){var l=this.documentHelper.textHelper.getHeight(t.characterFormat);e.height=l.Height}}else{if(e instanceof _||this.isFieldCode||e instanceof O||e instanceof He||e instanceof xe||e instanceof $||e instanceof Pe&&"Inline"!==e.textWrappingStyle){if(e instanceof O)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name))if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){var h=this.documentHelper.bookmarks.get(e.name);((0,a.le)(h.reference)||(0,a.le)(h.reference.paragraph.bodyWidget))&&(h.reference=e,e.reference=h)}else 0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&(0,a.le)(e.reference)&&this.documentHelper.bookmarks.remove(e.name);else this.documentHelper.bookmarks.add(e.name,e);if(e instanceof Pe&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof de&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e)&&t.bodyWidget.floatingElements.push(e)),e instanceof $&&-1===this.documentHelper.contentControlCollection.indexOf(e))if(0===e.type)this.documentHelper.contentControlCollection.push(e);else if(1===e.type)for(var d=e.paragraph.bodyWidget.page,c=0;c<this.documentHelper.contentControlCollection.length;c++){var u=this.documentHelper.contentControlCollection[c],p=u.line.paragraph.isInHeaderFooter;(p&&e.contentControlProperties===u.contentControlProperties&&d===u.line.paragraph.bodyWidget.page||!p&&e.contentControlProperties===u.contentControlProperties)&&(e.reference=u,u.reference=e)}return(0,a.le)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(n),void(e.line.isLastLine()&&(0,a.le)(e.nextElement)&&(this.hasValidElement(n.paragraph)&&!t.isContainsShapeAlone()?this.moveToNextLine(n):this.isInitialLoad||this.hasValidElement(n.paragraph)||!n.paragraph.paragraphFormat.bidi||-1===n.paragraph.paragraphFormat.listFormat.listId?this.layoutEmptyLineWidget(n.paragraph,!1,n,!1):this.moveToNextLine(n)))}var y,f=e.width;if(e instanceof st&&!this.isTocField(e.fieldBegin)?""!==(r=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=r:r=e.text:e instanceof Ee?""!==(r=this.startAt(e,r))&&(e.text=r):e instanceof S&&(this.checkAndSplitTabOrLineBreakCharacter(e.text,e),r=e.text),e instanceof S&&(f=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),"\t"===e.text?(f=this.getTabWidth(t,this.viewer,o,n,e),e.width=f):"\x1f"===e.text&&(e.width=f=0)),!(0,a.le)(t.containerWidget)&&t.bodyWidget.floatingElements.length>0&&!(e instanceof de)&&!(t.containerWidget instanceof be)&&this.adjustPosition(e,e.line.paragraph.bodyWidget),this.viewer instanceof ye&&(e instanceof de&&"Inline"===e.textWrappingStyle||!(e instanceof de))&&this.viewer.clientActiveArea.height<e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&((e instanceof S&&"\f"!==e.text||!(e instanceof S))&&this.moveToNextPage(this.viewer,n),e instanceof st&&this.updateFieldText(e),e.previousElement&&(e.previousElement instanceof de&&"Inline"===e.previousElement.textWrappingStyle||!(e.previousElement instanceof de))&&this.cutClientWidth(e.previousElement)),e instanceof de&&"Inline"===e.textWrappingStyle&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),this.layoutShape(e)),e instanceof Ee&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(e),e instanceof Ee&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),e.previousElement&&(e.previousElement instanceof de&&"Inline"===e.previousElement.textWrappingStyle||!(e.previousElement instanceof de))&&this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height)&&(this.viewer.clientActiveArea.height-=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y),parseFloat(f.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap)this.addElementToLine(t,e),(0,a.le)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(n):!e.line.isLastLine()&&(0,a.le)(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(n),n.paragraph.lastChild===n&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(n));else if(e instanceof S){if("\t"===e.text){var m=e.line,v=!1;if(0!==e.indexInOwner&&e instanceof at?(v=!0,this.addSplittedLineWidget(m,m.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(m,m.children.indexOf(e))),this.moveToNextLine(m),m.paragraph.bodyWidget.floatingElements.length>0&&v)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,o,e.line,e),v&&(this.addElementToLine(t,e),(0,a.le)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line))}else do{if(n=e.line,e.previousElement instanceof H&&2==e.previousElement.fieldType&&!(0,a.le)(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof Ge||this.splitTextForClientArea(n,e,e.text,e.width,e.characterFormat),this.checkLineWidgetWithClientArea(n,e),e instanceof st&&this.updateFieldText(e),e.line!==n&&!(0,a.le)(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==n&&this.cutClientWidth(e))}else do{n=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(n,e),e instanceof st&&this.updateFieldText(e)}while(e.line!==n&&this.cutClientWidth(e));if(!(0,a.le)(e.nextNode)&&e.nextNode instanceof $&&(y=e.nextNode),("\v"===r||"\f"===r)&&!y){var b=n.children.indexOf(e);b>-1&&this.addSplittedLineWidget(n,b)}if(e.line.isLastLine()&&(0,a.le)(e.nextElement)||"\v"===r||"\f"===r){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);this.moveToNextLine(e.line),"\v"===r&&(0,a.le)(e.nextNode)?this.layoutEmptyLineWidget(t,!0,n,!0):"\f"===r&&this.viewer instanceof ye&&((0,a.le)(e.nextNode)||e.nextNode instanceof $?this.moveToNextPage(this.viewer,e.line,!0):(0,a.le)(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1))}this.isXPositionUpdated=!1}},s.prototype.adjustPosition=function(e,t){var i=this.viewer.clientActiveArea,n=this.viewer.clientActiveArea.x,r=this.viewer.clientActiveArea.y,o=this.viewer.clientActiveArea.width,l=this.adjustClientAreaBasedOnTextWrap(e,new re(i.x,i.y,i.width,i.height));if(this.viewer.clientActiveArea.width=l.width,e.padding.left=this.viewer.clientActiveArea.x-n,o!==this.viewer.clientActiveArea.width){var d=new To(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width);this.updateWrapPosition(d)}0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated&&(e.line.isFirstLine()?e.line.paragraph.y=this.viewer.clientActiveArea.y:e.line.marginTop+=this.viewer.clientActiveArea.y-r,e.line.paragraph.containerWidget instanceof Ce&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-r),e instanceof _||(this.isYPositionUpdated=!1))},s.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++)if(!(Math.abs(this.wrapPosition[t].right-e.right)>1))return;this.wrapPosition.push(e)},s.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},s.prototype.isTextFitBelow=function(e,t,i){return!1},s.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,n,r,o,l,h,d,c,u,p,f){return e.floatingElements.length>0&&i!==h&&n!==h&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(u.y+f)>Math.round(o.y)||this.isTextFitBelow(o,u.y+f,d))&&Math.round(u.y)<Math.round(o.y+o.height)&&!(l&&(c||t instanceof ee&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},s.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,n,r,o,l,h,d,c,u,p,f){return e.floatingElements.length>0&&i!==h&&n!==h&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(u.y+f)>=Math.round(o.y)&&Math.round(u.y)<Math.round(o.bottom)||Math.round(u.y+f)<=Math.round(o.bottom)&&Math.round(u.y+f)>=Math.round(o.y))&&!(l&&c)},s.prototype.isNeedToWrapLeafWidget=function(e,t){return e.bodyWidget.floatingElements.length>0&&!(t instanceof Pe&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},s.prototype.getMinWidth=function(e,t,i,n){var r=e.text,o=r.split(" ");""!==r&&""===r.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]);var l=this.documentHelper.textHelper.measureText(o[0],e.characterFormat).Width,h=this.getNextSibling(e);return 1===o.length&&h&&(l+=this.getNextTextRangeWidth(h,h.text,t,i,n)),l},s.prototype.getNextTextRangeWidth=function(e,t,i,n,r){for(var o=e,l=new re(0,0,0,0),h=this.isNextSibligSizeNeedToBeMeasure(l,e,r,i,n);h&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+l.width<r.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(l,o,r,i,n)););return l.width},s.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){var t=this.getNextSibling(e);return!!(t&&t instanceof S)},s.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,n,r){var o=null,l=t;if(l){if(-1!==(o=l.text).indexOf(" ")||-1!==o.indexOf("-")||-1!==o.indexOf("_")&&n+e.width+this.documentHelper.textHelper.measureText(o.split("-")[0],l.characterFormat).Width<i.width||"\t"===l.text){var h=l.width;return o!==o.split(" ")[0]&&(h=this.documentHelper.textHelper.measureText(o.split(" ")[0],l.characterFormat).Width),n+e.width+h>i.width&&o.indexOf("-")&&o!==o.split("-")[0]+"-"&&(h=this.documentHelper.textHelper.measureText(o.split("-")[0]+"-",l.characterFormat).Width),e.width+=h,!1}if(l.text.length>0){var d=this.documentHelper.textHelper.measureText(l.text,l.characterFormat);e.height+=d.Height,e.width+=d.Width}}return!0},s.prototype.isNeedDoIntermediateWrapping=function(e,t,i,n,r,o,l,h,d){return e>d&&((Math.round(i.width)<=Math.round(h)||i.width<n&&l.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-r.x+r.leftIndent)<d||l instanceof S&&this.isFloatingItemOnLeft(i,h,o))&&("Left"!==t||e<d)},s.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},s.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof H||t instanceof O||i||t instanceof _)t instanceof H&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof S)break;t=t.nextNode}return t},s.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var i=e.line.paragraph,n=i.bodyWidget,r=this.viewer;if(this.isFirstitemInPage(e,t.y),(0,a.le)(i.previousWidget),this.isNeedToWrapLeafWidget(i,e)){var h=r.clientArea;n.floatingElements.sort(function(ct,ut){return ct.y-ut.y}),n.floatingElements.sort(function(ct,ut){return ct.x-ut.x});for(var d=0;d<n.floatingElements.length;d++){var u,c=n.floatingElements[d];if(u=c instanceof Pe?c.allowOverlap:c.positioning.allowOverlap,(!(i.isInsideTable&&c instanceof k)||c.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(c instanceof k?c:c.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(c instanceof k?c:c.line.paragraph,this.endOverlapWidget))){var f=0,g=0,m=0,v=0,y=0;c instanceof Pe?(f=c.distanceLeft,g=c.distanceTop,m=c.distanceRight,v=c.distanceBottom,y=c.width):(y=c.getTableCellWidth(),f=c.positioning.distanceLeft,g=c.positioning.distanceTop,m=c.positioning.distanceRight,v=c.positioning.distanceBottom);var b=new re(c.x-f,c.y-g,y+f+m,c.height+g+v),C=c instanceof k?"Square":c.textWrappingStyle,F=c instanceof k?"Both":c.textWrappingType,T=24;if(!(h.x>b.right+T||h.right<b.x-T)&&this.isNeedToWrapForSquareTightAndThrough(n,e,-1,-1,C,b,u,1,c,!1,t,e.width,e.height)){var P=0,E=0,L=0,W=w.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),R=w.convertPointToPixel(i.paragraphFormat.leftIndent),N=w.convertPointToPixel(i.paragraphFormat.rightIndent);W=0===e.indexInOwner&&e.line.isFirstLine()&&W>0?W:0;var B=e instanceof S||e instanceof _?e:null,q=c instanceof k?c.containerWidget:c.line.paragraph.containerWidget,A=!1;if(e.line.paragraph){t.x>=b.x&&"Left"!==F&&(P=N),t.x<b.x&&"Right"!==F&&(E=R);var X=i.paragraphFormat.listFormat,le=this.getListLevel(X.list,X.listLevelNumber);t.x===h.x+R&&X&&X.baseStyle&&le&&0!==le.paragraphFormat.leftIndent&&(L=R,A=!0)}var K=0,he=!1,ge=void 0,te=0,G=void 0;if(c instanceof k&&(ge=c,G=c.positioning.horizontalAlignment,K=this.getMaximumRightCellBorderWidth(c),he=this.getDefaultBorderSpacingValue(K,he,G),te=c.tableFormat.borders.left.lineWidth/2),t.x+te>=b.x&&t.x<b.right&&"Left"!==F)if(t.width=t.width-(b.right-t.x)-P,this.isWrapText=!0,(0,a.le)(ge)||(T=this.getMinimumWidthRequiredForTable(he,G,K)),Math.round(t.width)<T||t.width<e.width&&"\t"===e.text||b.x<i.x+R){t.width=this.viewer.clientArea.right-b.right-(A?L:0);var pe=0;if(pe=(0,a.le)(B)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<T||t.width<pe){if(b.x-(i.x+i.leftIndent)>T&&this.viewer.clientArea.right-b.right>T)t.width=0;else{var me=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+me-t.y,t.y=b.bottom+me}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var Be=t.x;t.x=b.right+(A?L:0)+W,t.width-=W,"Square"===C&&t.width<0&&e.width>0&&(me=0,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+me-t.y,t.y=b.bottom+me,t.x=Be),this.viewer.updateClientAreaForTextWrap(t)}}else Be=t.x,t.x=b.right+(A?L:0)+W,t.width=this.viewer.clientArea.right-b.right-(A?L:0)-W,"Square"===C&&t.width<0&&e.width>0&&(me=0,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+me-t.y,t.y=b.bottom+me,t.x=Be),this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t);else if(b.x>=t.x&&t.right>b.x){t.width=b.x-t.x-P;var Me=this.viewer.clientArea.right-b.right;if(Me=Me>0?Me:0,this.isWrapText=!0,pe=0,pe=(0,a.le)(B)?e.width:this.getMinWidth(B,e.width,e.height,t),(0,a.le)(ge)||(T=this.getMinimumWidthRequiredForTable(he,G,K)),this.isNeedDoIntermediateWrapping(Me,F,t,e.width,e.paragraph,b,e,pe,T)){if(t.width=Me,this.isWrapText=!0,(t.x+pe>b.x||"Right"===F||h.x>b.x-24)&&(t.x=b.right,(t.width>pe||"Right"===F)&&this.viewer.updateClientAreaForTextWrap(t)),t.width<T&&!(pe<Me&&"Tight"===C)||t.width<pe&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===F){var dt=b;Math.round(t.x)===Math.round(n.sectionFormat.leftMargin+i.paragraphFormat.leftIndent)?(t.y=dt.bottom+(me=0),this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(dt.height+me),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1):Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===F?(t.y=dt.bottom+(me=0),t.width=this.viewer.clientArea.width,t.height=t.height-(dt.height+me),t.x=this.viewer.clientArea.x+E,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1):(t.width=0,this.viewer.updateClientAreaForTextWrap(t))}}else(e.line.isFirstLine()&&0===e.indexInOwner||0===Me)&&"Square"===C&&Math.round(t.width)<=Math.round(pe)&&i.containerWidget===q?(t.x=h.x,t.y=b.bottom,t.width=h.width,t.height-=b.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(pe)&&Math.round(t.x-E)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t)}"Both"!==F&&(this.isWrapText=!1)}}}}return t},s.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if((0,a.le)(e.containerWidget)||(0,a.le)(e.bodyWidget))return t;var i=e.bodyWidget,n=this.viewer;if((0,a.le)(e.previousWidget),i.floatingElements.length>0){var l=n.clientActiveArea;i.floatingElements.sort(function(B,q){return B.y-q.y}),i.floatingElements.sort(function(B,q){return B.x-q.x});for(var h=0;h<i.floatingElements.length;h++){var c,d=i.floatingElements[h];if(c=d instanceof Pe?d.allowOverlap:d.positioning.allowOverlap,(!(e.isInsideTable&&d instanceof k)||d.isInsideTable)&&!(d instanceof k&&d.wrapTextAround&&d.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap)){var u=e.getTableCellWidth(),p=d instanceof Pe,f=p?d.distanceLeft:d.positioning.distanceLeft,g=p?d.distanceTop:d.positioning.distanceTop,m=p?d.distanceRight:d.positioning.distanceRight,v=p?d.distanceBottom:d.positioning.distanceBottom,y=p?d.width:d.getTableCellWidth(),b=new re(d.x-f,d.y-g,y+f+m,d.height+g+v),C=d instanceof k?"Square":d.textWrappingStyle,F=d instanceof k?"Both":d.textWrappingType,T=24;if(!(l.x>b.right+T||l.right<b.x-T)&&this.isNeedToWrapForSquareTightAndThroughForTable(i,e,-1,-1,C,b,c,1,d,!1,t,u,e.childWidgets.length>0?e.childWidgets[0].rowFormat.height:0)&&t.x>=b.x&&t.x<b.right&&"Left"!==F)if(t.width=t.width-(b.right-t.x),this.isWrapText=!0,Math.round(t.width)<T||t.width<u||b.x<e.x){t.width=this.viewer.clientArea.right-b.right;var E=u;if(Math.round(t.width)<T||t.width<E){if(b.x-e.x>T&&this.viewer.clientArea.right-b.right>T)t.width=0;else{var L=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+L-t.y,t.y=b.bottom+L}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var R=t.x;t.x=b.right,"Square"===C&&t.width<0&&u>0&&(this.isYPositionUpdated=!0,t.height-=b.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=b.bottom+0,t.x=R),this.viewer.updateClientAreaForTextWrap(t)}}else R=t.x,t.x=b.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-b.right,"Square"===C&&t.width<0&&u>0&&(L=0,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+L-t.y,t.y=b.bottom+L,t.x=R),this.viewer.updateClientAreaForTextWrap(t)}}}return t},s.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat)),t},s.prototype.layoutFootEndNoteElement=function(e){this.isFootnoteContentChanged=!0;var t,i=!1,n=this.documentHelper.footnoteCollection.indexOf(e),r=1;this.islayoutFootnote=!0;var o,l=new re(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),h=new re(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),d=e.paragraph.bodyWidget,c=!1,u=0;if(d.page.footnoteWidget)for(var p=0;p<d.page.footnoteWidget.bodyWidgets.length;p++){r=d.page.footnoteWidget.bodyWidgets.length;var f=this.documentHelper.footnoteCollection.indexOf(d.page.footnoteWidget.bodyWidgets[p].footNoteReference);if(f>n&&f-n==1){r=p,i=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){if(d.page.footnoteWidget&&d.page.footnoteWidget instanceof Y)t=d.page.footnoteWidget;else{c=!0,(t=new Y).footNoteType="Footnote",t.page=d.page;var g=new I;g.characterFormat=new ie,g.paragraphFormat=new ue,g.index=0;var m=new oe(g);g.childWidgets.push(m),u=this.documentHelper.textHelper.getParagraphMarkSize(g.characterFormat).Height,t.margin=new $e(0,u,0,0)}this.isFootNoteLayoutStart=!0,c&&(d.page.footnoteWidget=t);var v=e.bodyWidget;this.viewer.updateClientArea(t.sectionFormat,t.page),this.viewer.clientArea.y=l.y,this.viewer.clientActiveArea.y=h.y;for(var y=0;y<e.bodyWidget.childWidgets.length;y++){var b=e.bodyWidget.childWidgets[y];b.containerWidget=v,v.page=d.page,v.sectionFormat=t.sectionFormat,b.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(b,!0),b instanceof k&&this.clearTableWidget(b,!0,!0),this.layoutBlock(b,0),u+=b.height,b.y=0,this.viewer.updateClientAreaForBlock(b,!1),v.height+=b.height}if(this.isFootNoteLayoutStart=!1,o=!1,u>=h.height&&(this.isfootMove=!0),i?t.bodyWidgets.splice(r,0,v):t.bodyWidgets.push(v),e.line.paragraph.isInsideTable){var C=this.getParentTable(e.line.paragraph.associatedCell.ownerTable);(0,a.le)(C.footnoteElement)&&(C.footnoteElement=[]),-1==C.footnoteElement.indexOf(e)&&(C.footnoteElement.push(e),this.layoutedFootnoteElement.push(e))}t.height+=u,o=!0,this.viewer.clientActiveArea=h,this.viewer.clientActiveArea.height-=u,this.footnoteHeight+=u,this.viewer.clientArea=l}return o},s.prototype.layoutEndNoteElement=function(){if(this.documentHelper.endnoteCollection.length>0){for(var t=void 0,i=void 0,n=void 0,r=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0],o=0;o<this.documentHelper.endnoteCollection.length;o++){t=this.documentHelper.endnoteCollection[o],r.page.endnoteWidget instanceof Y&&"Endnote"===r.page.endnoteWidget.footNoteType?i=r.page.endnoteWidget:(n=!0,(i=new Y).footNoteType="Endnote",i.page=r.page);var l=t.bodyWidget;l.page=i.page;for(var h=0;h<t.bodyWidget.childWidgets.length;h++)t.bodyWidget.childWidgets[h].containerWidget=l;-1===i.bodyWidgets.indexOf(l)&&(i.bodyWidgets.push(l),l.sectionFormat=i.sectionFormat),n&&(r.page.endnoteWidget=i)}this.layoutfootNote(i)}},s.prototype.hasValidElement=function(e){var t=e.firstChild;if(t&&!(0,a.le)(this.documentHelper.selection))for(var i=t.children[0];i;){if(i instanceof H&&(i=this.documentHelper.selection.getNextValidElementForField(i),!(0,a.le)(i)&&!i.line.paragraph.equals(e)))return!1;if(i instanceof S||i instanceof ee)return!0;(0,a.le)(i)||(i=i.nextNode)}return!1},s.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},s.prototype.checkLineWidgetWithClientArea=function(e,t){(e!==t.line||t.line===e&&(0,a.le)(t.nextElement)&&!t.line.isLastLine())&&(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable&&(t.line.paragraph.previousRenderedWidget instanceof k&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-w.convertPointToPixel(t.line.paragraph.previousRenderedWidget.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1),e!==t.line&&(this.isRTLLayout=!1)),t.line!==e&&this.viewer instanceof ye&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&(0,a.le)(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},s.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var n=w.indexOfAny(e,["\t","\v","\f"]);if(n>-1){var r=e[n];("\t"===r&&"\t"!==e||"\v"===r&&"\v"!==e||"\f"===r&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,n,r)}},s.prototype.moveFromNextPage=function(e){var t=e.nextLine;if(t&&-1===e.paragraph.childWidgets.indexOf(t)){var i=t.paragraph;t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph,0===i.childWidgets.length&&i.destroy()}},s.prototype.cutClientWidth=function(e){if(this.is2013Justification)return!1;this.clearLineMeasures();var t=e.line;t.marginTop=0;for(var i=0,n=0;n<t.children.length;n++){var r=t.children[n];if(i+=r.width,e===r)break}var o=this.viewer.clientActiveArea.width-i<0,h=e.line.paragraph.bodyWidget;return h&&h.floatingElements.length>0?(this.hasFloatingElement=!0,this.isXPositionUpdated=!0,!1):(o?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+i),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof S&&this.splitTextElementWordByWord(e),(0,a.le)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(t)),o)},s.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType)!(0,a.le)(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),!this.isFieldCode&&(!(0,a.le)(e.fieldEnd)||e.hasFieldEnd)&&(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isFieldCode=!0,e.hasFieldEnd=!0);else if(this.documentHelper.fieldStacks.length>0)if(2===e.fieldType)(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator===e&&(!(0,a.le)(t.fieldEnd)||t.hasFieldEnd)&&(this.isFieldCode=!1);else{var t;e===(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1)}},s.prototype.checkAndUpdateFieldData=function(e){if(e.hasFieldEnd&&!(0,a.le)(e.fieldEnd)){if((0,a.le)(e.fieldSeparator)){var t=new H(2);t.fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t}var i=e.fieldEnd.previousNode;if(i instanceof H&&2===i.fieldType){var n=e.formFieldData;if(n instanceof qe){var r=new S;r.line=e.line;var o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,r),r.characterFormat.copyFormat(e.characterFormat),r.text=String.fromCharCode(n.checked?9745:9744),r.characterFormat.fontSize="Auto"!==n.sizeType?1.4*n.size:1.4*r.characterFormat.fontSize}else if(n instanceof Ge){var l=new S;l.characterFormat.copyFormat(e.characterFormat),l.line=e.line,l.text=n.dropdownItems.length>0?n.dropdownItems[n.selectedIndex]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),o=e.line.children.indexOf(e.fieldEnd),e.line.children.splice(o,0,l)}}}},s.prototype.layoutEmptyLineWidget=function(e,t,i,n){var r=e.paragraphFormat,o=0,l=0;n=!(0,a.le)(n)&&n;var f,h=r.borders,d=this.documentHelper.canRenderBorder(e),u=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height,p=this.getBeforeSpacing(e);if(e.childWidgets.length>0&&!n){if((f=e.childWidgets[0]).children.length>0){(r.bidi||this.isContainsRtl(f))&&this.shiftElementsForRTLLayouting(f,r.bidi);var g=f.isFirstLine(),m=f.isLastLine(),v=0;if(g&&(p=this.getBeforeSpacing(e),v=w.convertPointToPixel(r.firstLineIndent)),"Left"!==(y=r.textAlignment)&&this.viewer.textWrap&&("Justify"!==y||!m||"Justify"===y&&r.bidi)){var b=this.getSubWidth(f,"Justify"===y,l,v,m);o=b[0].subWidth,l=b[0].spaceCount}}}else f=t?this.addLineWidget(e):i;if(!(0,a.le)(e.containerWidget)&&e.bodyWidget.floatingElements.length>0&&!(e.containerWidget instanceof be)){var C=new S;C.line=f,f.children.push(C),C.text="\xb6",C.characterFormat=e.characterFormat,C.width=this.documentHelper.textHelper.getTextSize(C,C.characterFormat),this.adjustPosition(C,e.bodyWidget),e.x+=C.padding.left,t&&this.checkInbetweenShapeOverlap(f),f.children.splice(C.indexInOwner,1)}this.viewer instanceof ye&&this.viewer.clientActiveArea.height<p+u&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!f.isFirstLine()||!(0,a.le)(f.paragraph.previousWidget))&&this.moveToNextPage(this.viewer,f);var F=this.getLineSpacing(e,u);!isNaN(this.maxTextHeight)&&u<this.maxTextHeight&&(u=this.maxTextHeight);var T=0,x=0,P=0,E=u,L=e.paragraphFormat.lineSpacingType;"Multiple"===L?F>u?x+=F-u:T+=F-u:("Exactly"===L||F>T+E+x)&&(T+=F-(T+E+x)),T+=p,x+=w.convertPointToPixel(this.getAfterSpacing(e)),"None"!=h.top.lineStyle&&f.isFirstLine()&&!d.skipTopBorder&&(T+=w.convertPointToPixel(h.top.lineWidth+h.top.space)),"None"!=h.bottom.lineStyle&&f.isLastLine()&&!d.skipBottomBorder&&(x+=w.convertPointToPixel(h.bottom.lineWidth+h.bottom.space));for(var W=0;W<f.children.length;W++){var y,R=f.children[W];0===W&&R instanceof _&&("Right"===(y=e.paragraphFormat.textAlignment)?P=o:"Center"===y&&(P=o/2),R.margin=new $e(P,T,0,x),R.line=f,f.height=T+E+x)}f.margin=new $e(0,T,0,x),f.height=T+E+x,this.adjustPositionBasedOnTopAndBottom(f),(0,a.le)(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof k&&1==e.childWidgets.length&&(f.height=0),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+f.height),this.wrapPosition=[]},s.prototype.adjustPositionBasedOnTopAndBottom=function(e){!(0,a.le)(e.paragraph.bodyWidget)&&!(0,a.le)(e.paragraph.bodyWidget.page.headerWidget)&&e.paragraph.bodyWidget.page.headerWidget.floatingElements.length>0&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},s.prototype.layoutListItems=function(e){this.isFieldCode||(!(0,a.le)(e.paragraphFormat)&&!(0,a.le)(e.paragraphFormat.listFormat)&&!(0,a.le)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},s.prototype.layoutList=function(e,t){var i=t.getListById(e.paragraphFormat.listFormat.listId),n=this.getListLevel(i,e.paragraphFormat.listFormat.listLevelNumber);if(!(0,a.le)(n)&&!(0,a.le)(n.numberFormat)&&""!==n.numberFormat){this.viewer.updateClientWidth(-w.convertPointToPixel(e.paragraphFormat.firstLineIndent));var r=e.childWidgets[0];(0,a.le)(r)&&(r=new oe(e),e.childWidgets.push(r));var h,o=new _(n,!1);if(o.line=r,o.text="Bullet"===n.listLevelPattern?n.numberFormat:this.getListNumber(e.paragraphFormat.listFormat),this.documentHelper.isIosDevice){var l=o.text;(l=l===String.fromCharCode(61623)?String.fromCharCode(9679):l===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):l)!==o.text&&(o.text=l)}t.textHelper.updateTextSize(o,e),this.viewer instanceof ye&&this.viewer.clientActiveArea.height<o.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(h=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+o.width);var d=o;if(r.children.splice(0,0,o),"None"!==n.followCharacter){if(o=new _(n,!0),"Tab"===n.followCharacter){o.text="\t";var c=r.children.indexOf(o),u=this.getTabWidth(e,this.viewer,c,r,o);t.textHelper.updateTextSize(o,e),o.width=u}else o.text=" ",t.textHelper.updateTextSize(o,e);this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+o.width),r.children.splice(1,0,o),o.line=r}if(!(0,a.le)(e.containerWidget)&&e.bodyWidget.floatingElements.length>0&&!(d instanceof de)&&!(e.containerWidget instanceof be)&&(this.adjustPosition(d,d.line.paragraph.bodyWidget),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>d.width+o.width&&(this.viewer.clientActiveArea.width-=d.width+o.width),this.isYPositionUpdated=!1)),h)return this.moveToNextPage(this.viewer,r),this.cutClientWidth(o),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==n.followCharacter&&this.viewer.updateClientWidth(w.convertPointToPixel(e.paragraphFormat.firstLineIndent))}},s.prototype.addBodyWidget=function(e,t){var i;return(i=t||new j).width=e.width,i.x=e.x,i.y=e.y,i},s.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new nt(e),n=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===n?String.fromCharCode(61623):1===n?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(n),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new ue(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},s.prototype.addSplittedLineWidget=function(e,t,i){if(this.isWrapText)(0,a.le)(i)||(e.children.splice(t+1,0,i),i.line=e);else{var n=e.paragraph,r=[],o=n.childWidgets.indexOf(e);(0,a.le)(i)||r.push(i);for(var l=void 0,h=t+1;h<e.children.length;h++)r.push(e.children[h]);if(r.length>0){l=o===n.childWidgets.length-1?new oe(n):n.childWidgets[o+1];for(var d=0;d<r.length;d++)r[d].line=l;e.children.splice(t+1,e.children.length-1),l.children=r.concat(l.children),-1===n.childWidgets.indexOf(l)&&n.childWidgets.splice(o+1,0,l)}}},s.prototype.addElementToLine=function(e,t){t instanceof Pe&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof S&&this.splitTextElementWordByWord(t)},s.prototype.splitElementForClientArea=function(e,t){if(t.line.children.length>0){var n=t.indexInOwner;t.line.children.length>1&&t.previousElement&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(n-=1),this.addSplittedLineWidget(t.line,n)}},s.prototype.splitByWord=function(e,t,i,n,r,o){var l=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,n,r,o);if(l>0&&l<i.length){var h=e.children.indexOf(i),d=new S;n=n.substring(l),d.text=n," "===n[0]&&(l+=n.length-(n=w.trimStart(n)).length),d.characterFormat.copyFormat(i.characterFormat),d.width=this.documentHelper.textHelper.getWidth(d.text,o),d.trimEndWidth=d.width,d.characterRange=i.characterRange,i.text=i.text.substr(0,l),i.width-=d.width,i.trimEndWidth=i.width,i.revisions.length>0&&(this.updateRevisionForSplittedElement(i,d,!0),d.isMarkedForRevision=i.isMarkedForRevision),d.height=i.height,d.baselineOffset=i.baselineOffset,this.splitErrorCollection(i,d),this.addSplittedLineWidget(e,h,d),this.addElementToLine(t,i),0===i.width&&e.children.splice(h,1)}},s.prototype.splitErrorCollection=function(e,t){if(e.errorCollection.length>0){for(var i=[],n=e.ignoreOnceItems,r=0;r<e.errorCollection.length;r++)i.push(e.errorCollection[r]);for(var o=0;o<e.errorCollection.length;o++){var l=e.text.indexOf(e.errorCollection[o].text),h=e.errorCollection[o];l<0?(i.splice(0,1),t.errorCollection.push(h)):t.text.indexOf(h.text)>0&&t.errorCollection.push(h)}t.ignoreOnceItems=n,e.ignoreOnceItems=[],e.errorCollection=i}},s.prototype.splitByCharacter=function(e,t,i,n,r){var o=e.paragraph,l=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,n,r),h=0;if(l<t.length&&(h=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,l),r),i=i.substring(l)),h>this.viewer.clientActiveArea.width&&t.indexInOwner>0)this.addSplittedLineWidget(e,t.indexInOwner-1);else{var d=e.children.indexOf(t);if(l<t.length){var c=new S;c.text=i,c.errorCollection=t.errorCollection,t.text=t.text.substr(0,l),c.characterFormat.copyFormat(t.characterFormat),c.width=this.documentHelper.textHelper.getWidth(c.text,r),c.trimEndWidth=c.width,c.characterRange=t.characterRange,t.width-=c.width,t.trimEndWidth=t.width,c.height=t.height,c.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,c),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,c,l>0),c.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(o,t),this.addSplittedLineWidget(e,d),0===t.width&&e.children.splice(d,1)}else this.addSplittedLineWidget(e,d),this.addElementToLine(o,t)}},s.prototype.updateRevisionForSplittedElement=function(e,t,i,n){if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var o=e.revisions[r];if(i){t.revisions.push(o);var l=o.range.indexOf(e);l<0?o.range.push(t):o.range.splice(n?l:l+1,0,t)}else o.range.splice(o.range.length-1,1),o.range.push(t),t.revisions.push(o)}},s.prototype.splitTextElementWordByWord=function(e){var t=e.line,i=t.children.indexOf(e),n=i,r=e.padding.left;e.padding.left=0;var l,o=e.text;if(o.trim().indexOf(" ")>=0){t.children.splice(i,1),l=e.characterFormat;for(var d=e.length-w.trimStart(o).length;d<e.length&&0!==(d=this.getTextIndexAfterSpace(o,d))&&d!==e.length;)if(d<e.length){var c=new S,u=o.substring(0,d);" "===(o=o.substring(d)).substring(0,1)&&(d+=o.length-w.trimStart(o).length),c.text=u,c.characterFormat.copyFormat(e.characterFormat),c.line=t,c.width=this.documentHelper.textHelper.getWidth(c.text,l),c.trimEndWidth=c.width,c.height=e.height,c.baselineOffset=e.baselineOffset,c.characterRange=e.characterRange,t.children.splice(i,0,c),e.revisions.length>0&&(this.updateRevisionForSplittedElement(e,c,d>0,!0),c.isMarkedForRevision=e.isMarkedForRevision),e.text=o,e.width-=c.width,e.trimEndWidth=e.width,0===e.width&&-1!==t.children.indexOf(e)&&t.children.splice(t.children.indexOf(e),1),d=0,i++}e.text=o,t.children.splice(i,0,e)}t.children[n].padding.left=r},s.prototype.isSplitByHyphen=function(e,t){if(!(0,a.le)(e.previousElement)&&(e.previousElement instanceof S||e.previousElement instanceof _)){var i=e.previousElement.text;return"-"===t.substring(0,1)&&" "!==i.substring(i.length-1,i.length)}return"-"===t.substring(0,1)},s.prototype.splitTextForClientArea=function(e,t,i,n,r){var o=e.paragraph,l=!0,h=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))h=1;else{var d=n,c=0;if(0==(c=w.trimEnd(i).indexOf(" ")+1)&&(c=w.trimEnd(i).indexOf("-")+1),(h=c)>0&&(d=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,h),r)),this.viewer.clientActiveArea.width<d&&(l=this.checkPreviousElement(e,e.children.indexOf(t),r)))return}n<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):l&&(h>0||-1!==i.indexOf(" ")||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,n,r):this.splitByCharacter(e,t,i,n,r)},s.prototype.splitByLineBreakOrTab=function(e,t,i,n){var r=t.line.children.indexOf(t),o=t.text,l=o.substring(i),h="\t"===n?new at:new S;if(h.line=t.line,this.updateRevisionForSplittedElement(t,h,!0),h.characterFormat.copyFormat(t.characterFormat),h.characterRange=t.characterRange,t.line.children.splice(r+1,0,h),i>0&&1===l.length)h.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){h.text=n;var d=new S;d.line=t.line,d.text=o.substring(i+1),this.updateRevisionForSplittedElement(t,d,!0),d.characterFormat.copyFormat(t.characterFormat),d.characterRange=t.characterRange,t.line.children.splice(r+2,0,d),t.text=o.substring(0,i)}else""!==l&&(h.text=o.substring(i+1),t.text=n)},s.prototype.moveToNextLine=function(e){var t=e.paragraph,i=t.paragraphFormat,n=e.isFirstLine(),r=e.isLastLine(),o=0,l=0,h=0,d=0,c=0,u=0,p=i.borders;this.updateLineWidget(e),l=(o=this.maxTextHeight)-this.maxTextBaseline;var f=0,g=!1,m=this.documentHelper.canRenderBorder(t);if(t.bodyWidget&&!(t.bodyWidget instanceof Ce)&&(f=this.documentHelper.pages.indexOf(t.bodyWidget.page)),n&&(d=this.getBeforeSpacing(t,f),u=w.convertPointToPixel(i.firstLineIndent)),r&&(h=w.convertPointToPixel(this.getAfterSpacing(t))),(i.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,i.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight)){var v=this.documentHelper.textHelper.measureText("a",t.characterFormat);l=(o=v.Height)-v.BaselineOffset}else l=(o=this.maxTextHeight)-this.maxTextBaseline;c=this.getLineSpacing(t,o),"Exactly"===i.lineSpacingType&&c<l+this.maxBaseline&&(c=l+this.maxBaseline);var C,y=0,b=0,F=i.textAlignment,T=0;if("Left"!==F&&this.viewer.textWrap&&(!("Justify"===F&&r)||"Justify"===F&&i.bidi||this.is2013Justification&&r)&&(y=(C=this.getSubWidth(e,"Justify"===F,b,u,r))[0].subWidth,b=C[0].spaceCount,T=C[0].totalSpaceCount,g=e.isEndsWithPageBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!g&&C&&1===C.length&&this.viewer.clientActiveArea.width>0&&!r&&!this.is2013Justification&&"Justify"===F&&"Word2013"===this.documentHelper.compatibilityMode){var R,x=this.viewer.clientActiveArea.width,P=this.getTotalSpaceWidth(e);return this.viewer.clientActiveArea.x-=R=x/T/(P/T)*100<=33?P/8:P/4,this.viewer.clientActiveArea.width+=R,this.is2013Justification=!0,this.moveElementFromNextLine(e),void(this.nextElementToLayout=e.children[e.children.length-1])}this.is2013Justification&&r&&y>0&&(y=0,b=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var N=!1,B=0,q=i.lineSpacingType,A=!1,X=e.renderedElements,le=0;le<X.length;le++){var K=0,he=0,ge=0,te=X[le];if(!(0,a.le)(C)&&A&&te.padding.left>0&&C.length>B+1){var G=y;"Justify"===F?G=y*C[B].spaceCount:"Center"===F&&(G=y/2),te.padding.left=te.padding.left-G;var Ae=C[++B];y=Ae.subWidth,b=Ae.spaceCount}if(!(te instanceof Pe&&"Inline"!==te.textWrappingStyle)){A=!0;var pe=this.alignLineElements(te,K,he,l,N,y,F,b,le===X.length-1);e.maxBaseLine=this.maxBaseline,K=pe.topMargin,he=pe.bottomMargin,N=pe.addSubWidth,b=pe.whiteSpaceCount,"Multiple"===q?c>o?he+=c-o:K+=c-o:("Exactly"===q||c>K+te.height+he)&&(K+=c-(K+te.height+he)),K+=f>0&&t===t.bodyWidget.childWidgets[0]&&this.documentHelper.pages[f].sectionIndex===this.documentHelper.pages[f-1].sectionIndex?0:d,"None"!=p.top.lineStyle&&e.isFirstLine()&&!m.skipTopBorder&&(K+=w.convertPointToPixel(p.top.lineWidth+p.top.space)),"None"!=p.bottom.lineStyle&&e.isLastLine()&&!m.skipBottomBorder&&(he+=w.convertPointToPixel(p.bottom.lineWidth+p.bottom.space)),he+=h,(0===le||!(te instanceof Pe&&"Inline"!==te.textWrappingStyle)&&te.previousElement instanceof Pe&&"Inline"!==te.previousElement.textWrappingStyle||te.padding.left>0)&&(e.height=K+te.height+he,"Right"===F||"Justify"===F&&i.bidi&&r?ge=y:"Center"===F&&(ge=y/2)),te.margin=new $e(ge,K,0,he),te.line=e}}if(this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl){var me=e.paragraph.previousSplitWidget;if(!(0,a.le)(me)&&!me.isEndsWithPageBreak){var ze=me.childWidgets.length-1;2===me.childWidgets.length&&(ze=0),this.splitParagraph(me,ze,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph)}}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]},s.prototype.checkInbetweenShapeOverlap=function(e,t){var i=this;if(!(e.paragraph.containerWidget instanceof be)&&e.paragraph.bodyWidget){var n,r=this.getLineY(e),o=e.paragraph.isInsideTable,l=e.paragraph.y,h=!0;(0,a.le)(t)&&(h=!1,t=e.paragraph.bodyWidget.floatingElements),t.sort(function(d,c){return d.y-c.y}),t.forEach(function(d){if(!(o&&d.line&&!d.line.paragraph.isInsideTable||(0,a.le)(d.line))){var c;c="TopAndBottom"===d.textWrappingStyle&&d instanceof ee&&!e.paragraph.isEmpty()?new re(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.children[0].height):new re(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.height);var u=new re(d.x,d.y-d.distanceTop,d.width,d.height);if(!(d.line&&i.isRelayout&&!i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(d.line.paragraph,e.paragraph)||i.isRelayout&&i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(d.line.paragraph,i.endOverlapWidget))){var p="TopAndBottom"===d.textWrappingStyle,f=d.y+d.height+d.distanceBottom-r;n&&p&&n.y+n.height+n.distanceBottom+e.height>d.y-d.distanceTop&&n.y-n.distanceTop<d.y-d.distanceTop&&d.y+d.height+d.distanceBottom>n.y+n.height+n.distanceBottom?(n=d,e.paragraph.isEmpty()&&h?(e.paragraph.y=l,e.paragraph.y+=f):e.marginTop=f):p&&!n&&c.isIntersecting(u)&&(n=d,e.paragraph.isEmpty()&&h?e.paragraph.y+=f:e.marginTop=f)}}}),n?this.viewer.cutFromTop(n.y+n.height+n.distanceBottom):this.isRelayoutOverlap&&(e.marginTop=0)}},s.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var n=t.firstChild;n!==e;)i=i+n.height+n.marginTop,n=n.nextLine;return i},s.prototype.updateLineWidget=function(e){for(var t=0,i=0,n=!1,r=!1,o=0;o<e.children.length;o++){var l=e.children[o];if(l instanceof H&&2===l.fieldType&&(r=!1),!(r||(l instanceof H&&0===l.fieldType&&(r=!0),l instanceof Pe&&"Inline"!==l.textWrappingStyle))){if(l instanceof S&&0===l.text.replace(/\s+/g,"").length){t<l.height&&(t=l.height,i=l.baselineOffset);continue}if(l instanceof S||l instanceof _){var h=l.height,d=l.baselineOffset;l instanceof S&&l.isCheckBoxElement&&(h/=1.4,d/=1.4),this.maxTextHeight<h&&(this.maxTextHeight=h,this.maxTextBaseline=d),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}else this.maxBaseline<l.height&&(this.maxBaseline=l.height,l instanceof ee&&(n=!0))}}if(0===this.maxTextHeight&&0!==t)if(n)this.maxTextHeight=0,this.maxTextBaseline=0;else{if(e.isLastLine()&&this.documentHelper.selection){var c=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0);this.maxTextHeight=c.height,this.maxTextBaseline=i}else this.maxTextHeight=t,this.maxTextBaseline=i;this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}},s.prototype.moveToNextPage=function(e,t,i){if(!this.isFootNoteLayoutStart){var r,n=t.paragraph,l=!1,h=!1;if(n&&((0,a.le)(n.containerWidget)||(0,a.le)(n.containerWidget.containerWidget)||!(n.containerWidget.containerWidget instanceof Y))){var d=0;if(n instanceof Y)return;if(!(0,a.le)(t)&&(0!==(d=n.childWidgets.indexOf(t))&&(n.paragraphFormat.keepLinesTogether&&!(0,a.le)(n.previousWidget)||1==d&&!t.previousLine.isEndsWithPageBreak&&n.paragraphFormat.widowControl&&!(0,a.le)(n.previousWidget))&&(d=0,l=!0),(d>0||i)&&(n.height=e.clientActiveArea.y-n.y),0===d&&!n.isEndsWithPageBreak)){var c=this.alignBlockElement(n);(0,a.le)(c.node)||(n=r=c.node instanceof Q?this.splitRow(c.node):c.node,d=r instanceof k?0:parseInt(c.position.index,10),l=!1,h=!0)}!(0,a.le)(n.bodyWidget)&&!(0,a.le)(n.bodyWidget.containerWidget)&&!(n.bodyWidget.containerWidget instanceof Y)&&void 0!==n.bodyWidget.page.footnoteWidget&&this.layoutfootNote(n.bodyWidget.page.footnoteWidget);var u=this.moveBlocksToNextPage(n,0===d);if(this.viewer.updateClientArea(u.sectionFormat,u.page),this.viewer.updateClientAreaForBlock(n,!0),d>0){if(t.isLastLine()&&i)return;var p=void 0;p=u.firstChild instanceof I&&u.firstChild.equals(n)?u.firstChild:new I,(p=this.addParagraphWidget(this.viewer.clientActiveArea,p)).index=n.index;for(var f=0,g=d;g<n.childWidgets.length;g++){var m=n.childWidgets[g];m.paragraph=p,p.childWidgets.splice(f,0,m),m.paragraph=p,f++}p.paragraphFormat=n.paragraphFormat,p.characterFormat=n.characterFormat,n.childWidgets.splice(d),p.containerWidget=u;var v=this.getFootNoteWidgetsOf(p);this.moveFootNotesToPage(v,n.bodyWidget,u),n=p,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(v)}else i||(n.containerWidget.removeChild(n.indexInOwner),n instanceof I&&n.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(n,n.containerWidget,!1));if(!i){if(-1===u.childWidgets.indexOf(n)&&(u.childWidgets.splice(0,0,n),n instanceof I&&n.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(n,u,!0)),n.containerWidget=u,this.viewer.updateClientAreaLocation(n,this.viewer.clientActiveArea),l||h){n.bodyWidget.page.footnoteWidget&&this.layoutfootNote(n.bodyWidget.page.footnoteWidget),t.paragraph!==n&&(n instanceof k&&this.clearTableWidget(n,!0,!0,!1),this.layoutBlock(n,0),e.updateClientAreaForBlock(n,!1));var y=t.paragraph;if(h){var b=n.nextWidget;if(!(0,a.le)(b))do{if(e.updateClientAreaForBlock(b,!0),b===y){this.viewer.updateClientAreaLocation(b,this.viewer.clientActiveArea);break}b instanceof k&&this.clearTableWidget(b,!0,!0,!1),this.layoutBlock(b,0),e.updateClientAreaForBlock(b,!1),b=b.nextWidget}while(b)}this.updateClientAreaForNextBlock(t,y)}if(t.isFirstLine()&&0===t.indexInOwner&&!(t.children[0]instanceof _)){var C=-w.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(C)}}}if(n instanceof I&&n.floatingElements.length>0&&!i)for(var F=0;F<n.floatingElements.length;F++){var T=n.floatingElements[F],x=this.getFloatingItemPoints(T);T.y=x.y,T.x=x.x,T instanceof de&&this.updateChildLocationForCellOrShape(T.y,T)}if(this.isRelayoutOverlap&&this.endOverlapWidget){var P=this.endOverlapWidget.previousRenderedWidget,E=t.paragraph;for(this.startOverlapWidget=E,E=(t=this.endOverlapWidget.childWidgets[0]).paragraph;E;)E.floatingElements.forEach(function(L){-1!==P.bodyWidget.floatingElements.indexOf(L)&&"Inline"!==L.textWrappingStyle&&(P.bodyWidget.floatingElements.splice(P.bodyWidget.floatingElements.indexOf(L),1),t.paragraph.bodyWidget.floatingElements.push(L))}),E=E!==this.endOverlapWidget?E.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},s.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(e.floatingElements.length>0)for(var n=0;n<e.floatingElements.length;n++)i?-1===t.floatingElements.indexOf(e.floatingElements[n])&&"Inline"!==e.floatingElements[n].textWrappingStyle&&t.floatingElements.push(e.floatingElements[n]):-1!==t.floatingElements.indexOf(e.floatingElements[n])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[n]),1)},s.prototype.alignBlockElement=function(e){if(e instanceof I&&e.isEndsWithPageBreak)return{node:void 0,position:{index:""}};for(var t,i=0,n=this.getPreviousBlock(e);n;){if(n instanceof I){if(!n.paragraphFormat.keepWithNext||n.isEndsWithPageBreak)break;if(t=n,n.paragraphFormat.keepLinesTogether)(0,a.le)(this.getPreviousBlock(n))?t=void 0:i=0;else if((0,a.le)(this.getPreviousBlock(n))&&1===n.childWidgets.length)t=void 0;else if(n.paragraphFormat.widowControl){if((1==(i=n.lastChild.indexInOwner-1)||i<0)&&(i=0),0!==i)break}else i=n.lastChild.indexInOwner}else if(n instanceof Q){var r=n.childWidgets[0];if(!(r.childWidgets.length>0))break;var o=this.documentHelper.selection.getFirstParagraphInCell(r);if(!o.paragraphFormat.keepWithNext)break;o.paragraphFormat.keepWithNext&&((0,a.le)(this.getPreviousBlock(n))?t=void 0:i=(t=n).indexInOwner)}n=this.getPreviousBlock(n)}return{node:t,position:{index:i.toString()}}},s.prototype.getPreviousBlock=function(e){var t;return e instanceof I?t=e.previousWidget:e instanceof Q&&(0,a.le)(t=e.previousWidget)&&(t=e.ownerTable.previousWidget),t instanceof k&&(t=t.lastChild),t},s.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),n=e.indexInOwner;n<t.childWidgets.length;){var r=t.childWidgets.splice(n,1)[0];i.childWidgets.push(r),r.containerWidget=i,t.height-=r.height,i.height+=r.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},s.prototype.splitParagraph=function(e,t,i){if(0===t&&(0,a.le)(i))return e;var n=!1;if((0,a.le)(i))(i=new I).containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,i),i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index;else if(0===t){n=!0;var r=e;e=i,i=r}for(var o=0,l=t;l<e.childWidgets.length;l++){var h=e.childWidgets[l];h.paragraph=i,n?i.childWidgets.push(h):i.childWidgets.splice(o,0,h),i.height+=h.height,e.height-=h.height,h.paragraph=i,o++}return n?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=e.y,i.x=e.x,i.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(i)):e.childWidgets.splice(t),(0===e.childWidgets.length||n)&&e.containerWidget.childWidgets.splice(e.indexInOwner,1),i},s.prototype.updateClientPositionForBlock=function(e,t){var i=e instanceof Q?e.ownerTable:e,n=!1;do{if(this.viewer.updateClientAreaForBlock(i,!0),i instanceof I){if(t instanceof I&&t.equals(i)){n=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}else if(i instanceof k){this.addTableWidget(this.viewer.clientActiveArea,[i]);var r=i.firstChild;if(t instanceof Q&&i.equals(t.ownerTable)&&!(0,a.le)(r))do{if(r.equals(t)){n=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[r]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),i.height+=r.height,r=r.nextWidget}while(r);else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}i=i.nextWidget}while(i&&!n)},s.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(e===n)break;this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height)}},s.prototype.layoutStartEndBlocks=function(e,t){var n,i=e;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y,n=e instanceof k?this.documentHelper.selection.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(n);i;)this.viewer.updateClientAreaForBlock(i,!0),i instanceof I?this.layoutParagraph(i,0):(this.clearTableWidget(i,!0,!0,!0),this.layoutTable(i,0)),this.viewer.updateClientAreaForBlock(i,!1),i=i!==t?i.nextWidget:void 0},s.prototype.alignLineElements=function(e,t,i,n,r,o,l,h,d){if(e.width>0&&(e instanceof S||e instanceof _)){var c=e instanceof S?e:void 0,u=e instanceof S?c.baselineOffset:e.baselineOffset;if(t+=this.maxBaseline-u,i+=n-(e.height-u),!(0,a.le)(c)&&"Justify"===l&&h>0){var p=c.width,f=c.text;if(r||(r=(f=w.trimStart(f)).length>0),r){var g=f.length-w.removeSpace(f).length;d&&(g-=f.length-w.trimEnd(f).length),h<g&&(p=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(f,c.characterFormat),g=h),g>0&&(c.width=p+o*g,h-=g)}}}else r=!0,t+=this.maxBaseline-e.height,i+=n;return{topMargin:t,bottomMargin:i,addSubWidth:r,whiteSpaceCount:h}},s.prototype.updateWidgetToPage=function(e,t){if(t.isInsideTable){var i=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,(0,a.le)(t.associatedCell)||(0,a.le)(t.associatedCell.ownerRow)||(0,a.le)(t.associatedCell.ownerRow.rowFormat))return;i.height="Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?w.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):[i].length<=1&&"AtLeast"===t.associatedCell.ownerRow.rowFormat.heightType?Math.max(w.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(i)):i.height+t.height,t.containerWidget=i}else(!t.isEndsWithPageBreak||e instanceof Se)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof Y&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof Ce&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer)),e instanceof Se&&t.containerWidget instanceof j&&(t.containerWidget.height+=t.height)},s.prototype.shiftFooterChildLocation=function(e,t){var i=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var o,r=w.convertPointToPixel(i-e.page.bodyWidgets[0].sectionFormat.footerDistance);e.y+e.height>r?o=r-(e.y+e.height):e.y+e.height<r&&(o=e.y+e.height-r),(0,a.le)(o)||(this.shiftChildLocation(o=r-(e.y+e.height),e),t.clientActiveArea.y+=o)}},s.prototype.shiftFootnoteChildLocation=function(e,t){var l,o=w.convertPointToPixel(e.page.bodyWidgets[0].sectionFormat.pageHeight-e.page.bodyWidgets[0].sectionFormat.bottomMargin);e.y+e.height>o?l=o-(e.y+e.height):e.y+e.height<o&&(l=e.y+e.height-o),(0,a.le)(l)||(this.shiftChildLocation(l=o-(e.y+e.height),e),t.clientActiveArea.y+=l)},s.prototype.checkPreviousElement=function(e,t,i){for(var n=e.paragraph,r=!1,o=0,l=t-1;l>=0;l--){var h=e.children[l];if(h instanceof S&&h.width>0){var d=h.text;if(o=l,d.length>0&&(" "===d[d.length-1]||"-"===d[d.length-1])){if(l===t-1)return this.addSplittedLineWidget(e,t-1),!0;r=!0;break}if("\t"===d)return!1;if(d.indexOf(" ")>=0){r=!0;var c=d.lastIndexOf(" ")+1,u=new S;u.text=d.substr(c),u.characterFormat.copyFormat(h.characterFormat),u.characterRange=h.characterRange,h.revisions.length>0&&(this.updateRevisionForSplittedElement(h,u,c>0),u.isMarkedForRevision=h.isMarkedForRevision),h.text=d.substr(0,c),this.documentHelper.textHelper.getTextSize(u,i),h.width-=u.width,h.height=u.height,0===h.width&&e.children.splice(l,1),e.children.splice(l+1,0,u);break}}else if(!(h instanceof _||h instanceof H||h instanceof S&&0===h.width)){o=l,r=!0;break}}if(r&&++o<e.children.length){var p=0;for(l=o;l<e.children.length;l++)p+=e.children[l].width,this.addSplittedLineWidget(e,l-1),l--;"Justify"===n.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(p)}return r},s.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!(0,a.le)(t.children)){for(var i=t.children.length-1;i>0&&t.children[i]instanceof _;i--)t.children.splice(i,1);for(i=0;i<t.children.length&&t.children[i]instanceof _;i++)t.children.splice(i,1),i--}}},s.prototype.clearInvalidList=function(e){e&&(-1===e.abstractListId&&-1!==this.documentHelper.abstractLists.indexOf(e.abstractList)&&this.documentHelper.abstractLists.splice(this.documentHelper.abstractLists.indexOf(e.abstractList),1),-1===e.listId&&-1!==this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(e),1))},s.prototype.getListNumber=function(e,t){var i=this.documentHelper.getListById(e.listId),n=e.listLevelNumber,r=this.getListLevel(i,e.listLevelNumber),o=(0,a.le)(i.levelOverrides)?void 0:i.levelOverrides[n];if(!(0,a.le)(o)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(o)&&(0,a.le)(o.overrideListLevel)){this.documentHelper.renderedLevelOverrides.push(o);var l=this.documentHelper.getAbstractListById(i.abstractListId);if(this.documentHelper.renderedLists.containsKey(l)){var h=this.documentHelper.renderedLists.get(l);h.containsKey(n)&&(h.remove(n),this.ClearSubListLevelValues(i,l,n))}}return(0,a.le)(t)&&this.updateListValues(i,n),this.getListText(i,n,r)},s.prototype.ClearSubListLevelValues=function(e,t,i){for(var n=this.documentHelper.renderedLists.get(t),r=i+1;r<t.levels.length;){var o=this.getListLevel(e,r);n.containsKey(r)&&o.restartLevel>i&&n.remove(r),r++}},s.prototype.getListStartValue=function(e,t){var i=(0,a.le)(t.levelOverrides)?void 0:t.levelOverrides[e];if(!(0,a.le)(i)&&(0,a.le)(i.overrideListLevel))return i.startAt;var n=this.getListLevel(t,e);return(0,a.le)(n)?0:n.startAt},s.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId);if(this.documentHelper.renderedLists.containsKey(i)){var l=this.documentHelper.renderedLists.get(i);if(l.containsKey(t)){var h=l.get(t);l.set(t,h+1);for(var d=t+1;d<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){var r=this.getListLevel(e,d);l.containsKey(d)&&r.restartLevel>t&&l.remove(d),d++}}else{for(d=t;!l.containsKey(d-1)&&d>0;)r=this.getListLevel(e,d-1),l.add(d-1,this.getListStartValue(d-1,e)),d--;h=this.getListStartValue(t,e),l.add(t,h)}}else{var n=new U;this.documentHelper.renderedLists.add(i,n),r=this.getListLevel(e,t);for(var o=0;o<=t;o++)n.add(o,this.getListStartValue(o,e))}},s.prototype.getListText=function(e,t,i){var n=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var r=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),o=r.keys,l=0;l<o.length;l++){var h=o[l],d="%"+(h+1).toString(),c=this.getListLevel(e,h);if(n.match(d)){if(h>t)return"";n=r.containsKey(h)&&!(0,a.le)(c)?n.replace(d,this.getListTextListLevel(c,r.get(h))):n.replace(d,"0")}}return n},s.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var n=String.fromCharCode(64+i),r="";t>=0;)r+=n.toString(),t--;return r},s.prototype.getListTextListLevel=function(e,t){switch(e.listLevelPattern){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":case"Number":case"OrdinalText":case"Ordinal":case"FarEast":case"Special":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);default:return""}},s.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},s.prototype.generateNumber=function(e,t,i){for(var n="";e>=t;)n+=i,this.value=e-=t;return n.toString()},s.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},s.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},s.prototype.getListLevel=function(e,t){if(!(0,a.le)(e)){var i=this.documentHelper.getAbstractListById(e.abstractListId);!(0,a.le)(e)&&i.levels.length<=t&&t>=0&&t<9&&this.addListLevels(i);var n=void 0;if(!((0,a.le)(e.levelOverrides)||(0,a.le)(n=e.levelOverrides[t])||(0,a.le)(n.overrideListLevel)||(0,a.le)(n.startAt)))return n.overrideListLevel;if(!(0,a.le)(i)&&t>=0&&t<i.levels.length)return i.levels[t]}},s.prototype.getTabWidth=function(e,t,i,n,r){var o=0,l=!1,h=e.paragraphFormat.getUpdatedTabs(),d=!1;w.convertPointToPixel(e.bodyWidget.sectionFormat.leftMargin),(0,a.le)(e.paragraphFormat.listFormat.listLevel)||(0,a.le)(e.paragraphFormat.listFormat.listLevel.paragraphFormat)||e.paragraphFormat.leftIndent!==e.paragraphFormat.listFormat.listLevel.paragraphFormat.leftIndent&&(d=!0);var f=0,g=t.clientActiveArea.x,m=w.convertPointToPixel(e.paragraphFormat.firstLineIndent),v=w.convertPointToPixel(e.paragraphFormat.leftIndent);if(!(0,a.le)(r)&&n.isFirstLine()?(f=this.viewer.clientArea.x+m,d&&(g+=m)):f=this.viewer.clientArea.x,g<f)return t.clientArea.x-t.clientActiveArea.x;if(n.isFirstLine()&&v>0&&m<0){if(t.clientArea.x-t.clientActiveArea.x>0)return t.clientArea.x-t.clientActiveArea.x;0===h.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(h=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var y=t.clientActiveArea.x-(t.clientArea.x-w.convertPointToPixel(e.paragraphFormat.leftIndent)),b=w.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===h.length&&(y>0&&b>Math.round(y)&&d||b===this.defaultTabWidthPixel&&b>Math.round(y)))return b-y;var C=!1;if(h.length>0){for(var F=h.length-1;F>-1;F--){var x=w.convertPointToPixel(h[F].position);if(!(parseFloat(x.toFixed(2))>parseFloat(y.toFixed(2)))){if(F>0&&w.convertPointToPixel(h[F-1].position)>parseFloat(y.toFixed(2)))continue;if(F!=h.length-1){var P=this.getJustificationTabWidth(h[F+1],r,n,e,b,y,o);b=P.defaultTabWidth,o=P.fPosition,y=P.position,l=!0}C=!0;break}}if(!C){var E=this.getJustificationTabWidth(h[0],r,n,e,b,y,o);b=E.defaultTabWidth,o=E.fPosition,y=E.position,l=!0}}return l||(o=((y-parseFloat((100*y%(100*b)/100).toFixed(2)))/b+1)*b),parseFloat(o.toFixed(1))===parseFloat(y.toFixed(1))?b:o-y>0?o-y:b},s.prototype.getJustificationTabWidth=function(e,t,i,n,r,o,l){var h=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;if("Left"===e.tabJustification||"List"===e.tabJustification)l=w.convertPointToPixel(e.position),t instanceof at&&(t.tabLeader=e.tabLeader,t.tabText="");else{var d=w.convertPointToPixel(e.position)-o,c=this.getRightTabWidth(t.indexInOwner+1,i,n);if(c<d&&"Decimal"!=e.tabJustification)if("Right"===e.tabJustification){r=d-c;var u=w.convertPointToPixel(n.rightIndent),p=this.viewer.clientActiveArea.width+u-r;this.viewer.clientActiveArea.width+=u,p<0?r+=p-c:c>p&&(r-=c-p)}else r=d-c/2;else if("Center"===e.tabJustification&&c/2<d)r=d-c/2;else if("Decimal"===e.tabJustification)if(!(0,a.le)(t.nextElement)&&t.nextElement instanceof S){var f=t.nextElement;if(-1!=f.text.indexOf(".")){var g=f.text.indexOf("."),m=f.text.substring(0,g);r=d-this.documentHelper.textHelper.getWidth(m,f.characterFormat)}else r=c<d?d-c:d}else r=d;else r="Right"===e.tabJustification?0:h;l=o,t instanceof at&&(t.tabLeader=e.tabLeader,t.tabText="")}return{defaultTabWidth:r,fPosition:l,position:o}},s.prototype.getRightTabWidth=function(e,t,i){for(var n=0,r=!1,o=t.children[e];o;){if(o instanceof H||o instanceof O||r)o instanceof H&&(0===o.fieldType?r=!0:2===o.fieldType&&(r=!1)),o.width=0;else{if(o instanceof st&&!this.isTocField(o.fieldBegin)){var l=this.documentHelper.getFieldResult(o.fieldBegin,o.paragraph.bodyWidget.page);""!==l&&(o.text=l)}o instanceof S&&this.documentHelper.textHelper.getTextSize(o,o.characterFormat)}if(o instanceof S&&"\t"===o.text)return n;n+=o.width,o=o.nextNode}return n},s.prototype.getSplitIndexByWord=function(e,t,i,n){for(var r=0,o=t.length;r<o;){var l=this.getTextIndexAfterSpace(t,r);(0===l||l===o)&&(l=o-1);var h=i;if((l<o-1||l===o-1&&" "===t[l-1])&&r!==l&&(h=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,l),n)),!(h<=e)){0===r&&" "===t[0]&&(r=this.getTextIndexAfterSpace(t,0));break}r=l}return r},s.prototype.getTextSplitIndexByCharacter=function(e,t,i,n,r){for(var o=i.length,l=0;l<o;l++){var h=n;if(l+1<o&&(h=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,l+1),r)),h>t)return 0===l&&h>e?o>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:l}return 0},s.prototype.getSubWidth=function(e,t,i,n,r){var o=0,l=!0,h="",d=0;if(this.wrapPosition.length>0){var c=this.getSubWidthBasedOnTextWrap(e,t,i,n,r);if(c.length>0)return c}for(var u=e.renderedElements,p=u.length-1;p>=0;p--){var f=u[p];if(f.width>0&&f instanceof S){var g=f.text;if(h=g+h,!l||""===g.trim()&&"\t"!==g)l?d+=f.width:o+=f.width;else{if(w.endsWith(g)){var m=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(g,f.characterFormat);o+=m,d+=f.width-m}else o+=f.width;l=!1}}else{if(h="a"+h,l=!1,f instanceof Pe&&"Inline"!==f.textWrappingStyle)continue;o+=f.width}t||(o=Math.round(o))}var v=h.length-w.removeSpace(h).length;i=(h=h.trim()).length-w.removeSpace(h).length;var y=this.viewer.clientArea.width-n-o;return y<=0&&!this.is2013Justification||0===i&&t&&!e.paragraph.paragraphFormat.bidi?(i=0,y=0):t?!r&&i>0||r&&this.is2013Justification&&i>0?y/=i:i=0:d>0&&e.paragraph.paragraphFormat.bidi&&r&&(y-=d),[{subWidth:y,spaceCount:i,totalSpaceCount:v}]},s.prototype.getSubWidthBasedOnTextWrap=function(e,t,i,n,r){for(var o=[],l=0,h="",d=this.wrapPosition.length-1,c=!0,u=e.children.length-1;u>=0;u--){var p=e.children[u];if(p.width>0&&p instanceof S){var f=p.text;h=f+h,!c||""===f.trim()&&"\t"!==f?c||(l+=p.width):(w.endsWith(f)?l+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(f,p.characterFormat):l+=p.width,c=!1)}else h="a"+h,c=!1,p instanceof Pe&&"Inline"!==p.textWrappingStyle||(l+=p.width);if((p.padding.left>0||0===u)&&d>=0){for(var g=this.wrapPosition[d--];g.width<=0&&d>=0;)g=this.wrapPosition[d--];var m=this.getSubWidthInfo(e,g.width,l,h,i,t,r);(0,a.le)(m)||(l=0,h="",o.unshift(m))}}return o},s.prototype.getTotalSpaceWidth=function(e){var t=0;if(e)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(n instanceof S){var r=n.text.length-w.removeSpace(n.text).length;r>0&&(t+=r*this.documentHelper.textHelper.getWidth(" ",n.characterFormat))}}return t},s.prototype.getSubWidthInfo=function(e,t,i,n,r,o,l){if(t>0){var h=t-i;r=(n=n.trim()).length-w.removeSpace(n).length;var d=h;return d<=0||0===r&&o&&!e.paragraph.paragraphFormat.bidi?(r=0,d=0):o&&(!l&&r>0?d/=r:r=0),{subWidth:d,spaceCount:r,totalSpaceCount:r}}},s.prototype.getBeforeSpacing=function(e,t){var i=0;if(this.documentHelper.dontUseHtmlParagraphAutoSpacing)i=e.paragraphFormat.beforeSpacing;else{var n=e.previousWidget;if(n instanceof I){var r=this.getAfterSpacing(n),o=e.paragraphFormat.beforeSpacing;e.paragraphFormat.spaceBeforeAuto&&(o=14),r<o&&(i=o-r)}else n instanceof k?i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:t>0&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):i=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing}return this.isSameStyle(e,!1)?0:w.convertPointToPixel(i)},s.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=(0,a.le)(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},s.prototype.getLineSpacing=function(e,t,i){if((0,a.le)(e.paragraphFormat))return 0;var n=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":n=w.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:n=e.paragraphFormat.lineSpacing,i&&(n-=1),n*=t}return n},s.prototype.isParagraphFirstLine=function(e,t){var i=e;return!(!(0,a.le)(i.childWidgets)&&0!==i.childWidgets.indexOf(t)||t.children.length>0&&!(0,a.le)(e.previousWidget)&&e.previousWidget instanceof I&&t.paragraph.index===e.previousWidget.index)},s.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],n=i.children[i.children.length-1];return e===n&&(n instanceof H||!(n instanceof S&&"\v"===n.text))},s.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,n=0,r=0;n=e.indexOf(" ",t)+1,1==(r=e.indexOf("-",t)+1)&&(r=e.indexOf("-",r+1)+1),r>0&&n>0?n=Math.min(n,r):r>0&&0==n&&(n=r);var o=n;if(0===o||o===i)return o;for(;(" "===e[o]||"-"===e[o])&&++o!==i;);return o},s.prototype.moveNextWidgetsToTable=function(e,t,i){var n=t.indexInOwner,r=e[e.length-1];i&&(n+=1);for(var o=t.containerWidget.childWidgets.splice(n),l=0;l<o.length;l++)r.childWidgets.push(o[l]),o[l].containerWidget=r},s.prototype.addTableCellWidget=function(e,t,i,n){var o,r=0,l=0,h=i,d=0,c=n;(0,a.le)(e.cellFormat)||(e.cellFormat.containsMargins()?(l=(0,a.le)(e.cellFormat.leftMargin)?w.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):w.convertPointToPixel(e.cellFormat.leftMargin),d=(0,a.le)(e.cellFormat.rightMargin)?w.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):w.convertPointToPixel(e.cellFormat.rightMargin)):(l=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?w.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):w.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),d=e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?w.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):w.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new $e(l,h,d,c);var p=e.cellFormat.cellWidth;if("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&p<=0){var f=w.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth()));p=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,f,e)}e.width=w.convertPointToPixel(p),(0,a.le)(e.previousWidget)||(r=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),o=(0,a.le)(e.ownerTable)||(0,a.le)(e.ownerTable.tableFormat)?0:w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var g=0;r<e.columnIndex&&(g=w.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(r,e.columnIndex)),0===r&&(g-=o/2)),e.x=t.x+g+e.margin.left,e.y=t.y+e.margin.top+o,e.width=e.width-e.margin.left-e.margin.right,o>0&&(e.x+=o,e.width-=1===e.ownerTable.tableHolder.columns.length?2*o:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?2*o-o/2:o);var m=w.convertPointToPixel(V.getCellLeftBorder(e).getLineWidth()),v=w.convertPointToPixel(V.getCellRightBorder(e).getLineWidth()),y=!1;e.leftBorderWidth=e.ownerTable.isBidiTable?v:m;var b="None"===e.cellFormat.borders.left.lineStyle,C="None"===e.cellFormat.borders.right.lineStyle;return e.x+=b?e.leftBorderWidth>0?0:e.leftBorderWidth:0,e.width-=b?e.leftBorderWidth>0?0:e.leftBorderWidth:0,(o>0||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?m:v,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(y=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=C&&!y?0:e.rightBorderWidth,e.width<e.sizeInfo.minimumWidth/2&&!this.isInitialLoad&&(e.width=e.sizeInfo.minimumWidth/2),e},s.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)if("None"!==i.childWidgets[i.childWidgets.length-1].cellFormat.borders.right.lineStyle)return!0;return!1},s.prototype.addWidgetToTable=function(e,t,i,n,r,o,l,h){var d=t[0],c=d.childWidgets.length,u=void 0,p=i.indexOf(n),f=[];if(p>0?u=i[p-1]:n.previousRenderedWidget instanceof Q&&n.previousRenderedWidget.ownerTable.equals(n.ownerTable)&&(u=n.previousRenderedWidget),!(0,a.le)(u)){if(c=(d=u.containerWidget).childWidgets.indexOf(u)+1,Math.round(n.y)!==Math.round(u.y+u.height)){var g=t.indexOf(d);g+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),c=(d=t[g+1]).childWidgets.length}p>0&&(c=0)}if(this.updateRowHeightBySpannedCell(d,n,c),this.updateRowHeightByCellSpacing(t,n,e),n.containerWidget&&n.containerWidget!==d&&-1!==n.containerWidget.childWidgets.indexOf(n)&&n.containerWidget.childWidgets.splice(n.containerWidget.childWidgets.indexOf(n),1),-1===d.childWidgets.indexOf(n)&&d.childWidgets.splice(c,0,n),n.containerWidget=d,!n.ownerTable.isInsideTable){if(r.length>0)(0,a.le)(r)||(f=this.getFootnoteBody(r));else if(!(0,a.le)(n))for(var m=0;m<n.childWidgets.length;m++)for(var v=n.childWidgets[m],y=0;y<v.childWidgets.length;y++)for(var b=this.getFootNoteWidgetsOf(v.childWidgets[y],!0),C=0;C<b.length;C++)f.splice(f.length,0,b[C]);f.length>0&&(0,a.le)(f[0].containerWidget)?this.layoutFootnoteInSplittedRow(n,f):!(0,a.le)(f)&&f.length>0&&void 0!==n.bodyWidget.previousRenderedWidget&&h!==n.bodyWidget.page.index&&f[0].containerWidget.page.index!==n.bodyWidget.page.index?this.moveFootNotesToPage(f,f[0].containerWidget.page.bodyWidgets[0],n.bodyWidget):!this.isInitialLoad&&!(0,a.le)(n.bodyWidget.page.footnoteWidget)&&this.layoutfootNote(n.bodyWidget.page.footnoteWidget),r.length=0}d.height=d.height+n.height,this.viewer instanceof ye&&!(0,a.le)(d.containerWidget)&&d.containerWidget.childWidgets.indexOf(d)>=0&&!(d.containerWidget instanceof Ce)&&(d.containerWidget.height+=n.height),this.updateHeightForRowWidget(e,!1,t,i,n,!1,o,l),e.cutFromTop(n.y+n.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(f),this.existFootnoteHeight=0},s.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&t.length>0){(0,a.le)(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var i=e.ownerTable.bodyWidget.page.footnoteWidget;if(i){for(var n=0;n<t.length;n++)i.bodyWidgets.push(t[n]),t[n].containerWidget=i;this.layoutfootNote(i)}}},s.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i]);else t=this.getFootnoteHeightInternal(e);return t},s.prototype.getFootnoteHeightInternal=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height,0===e.indexInOwner&&(t+=e.containerWidget.margin.top);return t},s.prototype.updateRowHeightBySpannedCell=function(e,t,i){var n=1;if(0!==e.childWidgets.length&&0!==i){for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];n=(0,a.le)(o)||(0,a.le)(o.cellFormat)?n:o.cellFormat.rowSpan,this.updateSpannedRowCollection(n,t,o)}if(!(0,a.le)(t.ownerTable))for(r=0;r<t.ownerTable.spannedRowCollection.length;r++)if(t.ownerTable.spannedRowCollection.keys[r]===t.index){for(var l=0;l<i;l++)this.updateRowHeight(e.childWidgets[l],t);t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[r]);break}}else this.updateRowHeight(t,t)},s.prototype.updateRowHeight=function(e,t){for(var i=t.index,n=1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(n=(0,a.le)(o)||(0,a.le)(o.cellFormat)?n:o.cellFormat.rowSpan,this.updateSpannedRowCollection(n,t,o),i-o.rowIndex==n-1){var l=o.y+o.height+o.margin.bottom-t.y;("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>l)&&t.height<l&&(t.height=l)}}},s.prototype.updateSpannedRowCollection=function(e,t,i){e>1&&!(0,a.le)(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},s.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof ye&&(t.height=t.height-w.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},s.prototype.isRowSpanEnd=function(e,t){for(var i=e.index,n=1,r=0;r<this.documentHelper.splittedCellWidgets.length;r++){var o=this.documentHelper.splittedCellWidgets[r];if(n=(0,a.le)(o)||(0,a.le)(o.cellFormat)?n:o.cellFormat.rowSpan,i-o.rowIndex==n-1)return!0}return!1},s.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t<n.columnIndex)return!0;t+=n.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},s.prototype.splitWidgets=function(e,t,i,n,r,o,l){if(this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(r=this.getSplittedWidgetForRow(t.clientArea.bottom,i,n,e,l),this.documentHelper.splittedCellWidgets.length>0||r!==e){if(o)for(var h=0;h<r.childWidgets.length;h++)r.childWidgets[h].rowIndex!==r.index&&(r.childWidgets.splice(h,1),h--);this.insertSplittedCellWidgets(t,i,r,e.index-1)}}else this.insertSplittedCellWidgets(t,i,r,e.index-1);return r},s.prototype.getSplittedWidgetForRow=function(e,t,i,n,r){var o=void 0,l=n.index;this.isRelayoutneed=!1;for(var h=!1,d=0;d<n.childWidgets.length;d++){var c=n.childWidgets[d],u=this.getSplittedWidget(e,!0,t,i,c,r);if(r=[],!(0,a.le)(u)){if(u===c)return n;-1!==n.childWidgets.indexOf(u)&&n.childWidgets.splice(n.childWidgets.indexOf(u),1),n.height-=u.height,(0===d||n.height<c.height+c.margin.top+c.margin.bottom)&&(n.height=c.height+c.margin.top+c.margin.bottom),(0,a.le)(o)&&((o=new Q).containerWidget=n.containerWidget,o.index=n.index,o.rowFormat=n.rowFormat,this.updateWidgetLocation(n,o),i.push(o));var p=1;p=(0,a.le)(u)||(0,a.le)(u.cellFormat)?p:u.cellFormat.rowSpan,l-u.rowIndex==p-1&&o.height<u.height+u.margin.top+u.margin.bottom?o.height=u.height+u.margin.top+u.margin.bottom:("Exactly"===n.rowFormat.heightType||"AtLeast"===n.rowFormat.heightType&&o.height<n.rowFormat.height)&&(o.height=n.rowFormat.height),o.childWidgets.push(u),u.containerWidget=o,this.isRelayoutneed=!0;for(var f=d;f>0&&!h;)u=this.getSplittedWidget(e,!0,t,i,n.childWidgets[f-1],r),o.childWidgets.splice(0,0,u),u.containerWidget=o,f--;h=!0}}return o},s.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Ee&&(t+=this.getFootNoteHeight(n.bodyWidget))}return t},s.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof Ee&&t.push(e.children[i])},s.prototype.updateWidgetsToTable=function(e,t,i,n){var p,r=i.bodyWidget.page.index,o=this.getRowHeight(i,[i]),l=this.viewer,h=i.rowFormat.isHeader,d=void 0,c=i.rowFormat.allowBreakAcrossPages,u=i.rowFormat.heightType,f=0,g=i,m=!1,v=this.layoutedFootnoteElement;void 0!==g.bodyWidget.page.footnoteWidget?(this.footHeight=g.bodyWidget.page.footnoteWidget.height,0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,i.ownerTable.continueHeader&&!h&&(i.ownerTable.continueHeader=!1);var y=i.ownerTable.isInsideTable,b=!1;for(p=(0,a.le)(i.ownerTable)||(0,a.le)(i.ownerTable.tableFormat)?0:w.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);f<t.length;){if(f=t.length,this.isRowSpanEnd(i,l)&&"Exactly"===i.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),i.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&g.y+g.height+p+this.footnoteHeight<=l.clientArea.bottom)this.isVerticalMergedCellContinue(i)&&(g.y===l.clientArea.y||g.y===this.viewer.clientArea.y+g.ownerTable.headerHeight)&&this.insertSplittedCellWidgets(l,e,g,g.index-1),this.addWidgetToTable(l,e,t,g,v,void 0,y,r),this.documentHelper.splittedCellWidgets.length>0&&(0,a.le)(t[t.length-1].nextRow)&&(f--,b=!0),y=!1;else{if(v=[],y=!1,this.documentHelper.splittedCellWidgets.length>0&&g.y+g.height+this.footHeight<=l.clientArea.bottom&&!this.isRowSpanEnd(i,l)){this.isVerticalMergedCellContinue(i)&&(g.y===l.clientArea.y||g.y===this.viewer.clientArea.y+g.ownerTable.headerHeight)&&this.insertSplittedCellWidgets(l,e,g,g.indexInOwner-1),this.addWidgetToTable(l,e,t,g,v);continue}var F=g,T=e[e.length-1];if(o+g.y+this.footHeight>l.clientArea.bottom)if(!c||h&&i.ownerTable.continueHeader||"AtLeast"===u&&w.convertPointToPixel(i.rowFormat.height)<l.clientArea.bottom){if(("AtLeast"===u&&w.convertPointToPixel(i.rowFormat.height)<l.clientActiveArea.height&&(c||0===i.indexInOwner)||"Exactly"!==u&&g.y===l.clientArea.y||"Auto"===u&&c)&&(F=this.splitWidgets(g,l,e,t,F,b,v),(0,a.le)(F)&&g.y===l.clientArea.y&&this.addWidgetToTable(l,e,t,g,v)),"Exactly"===u&&g.y===l.clientArea.y&&(this.addWidgetToTable(l,e,t,g,v),f++),h&&i.ownerTable.continueHeader){var x=void 0;if(l instanceof ye&&(x=this.documentHelper.pages),!(0,a.le)(x))for(var P=0;P<x.length;P++)x[P].repeatHeaderRowTableWidget&&!(0,a.le)(x[P].bodyWidgets[0].firstChild)&&!(x[P].bodyWidgets[0].firstChild instanceof k&&x[P].bodyWidgets[0].firstChild.header)&&(x[P].repeatHeaderRowTableWidget=!1,i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0)}}else"Auto"!==u&&"AtLeast"!==u||!c?"Exactly"===u&&g.y===l.clientArea.y&&(this.addWidgetToTable(l,e,t,g,v),f++):(!(w.convertPointToPixel(i.rowFormat.height)>l.clientArea.bottom)||g.y===l.clientArea.y)&&(F=this.splitWidgets(g,l,e,t,F,b,v),(0,a.le)(F)&&g.y===l.clientArea.y&&this.addWidgetToTable(l,e,t,g,v));else{var E=!1;if(this.isVerticalMergedCellContinue(i)&&(c||(E=g.y===l.clientArea.y||g.y===this.viewer.clientArea.y+g.ownerTable.headerHeight))){if(E)this.insertSplittedCellWidgets(l,e,F,g.indexInOwner-1);else if(F=this.splitWidgets(g,l,e,t,F,b,v),(0,a.le)(F)&&(E=g.y===l.clientArea.y||g.y===this.viewer.clientArea.y+g.ownerTable.headerHeight)){this.insertSplittedCellWidgets(l,e,g,g.indexInOwner-1),f--;continue}}else b&&!c&&(F=this.splitWidgets(g,l,e,t,F,b,v))}if(!((0,a.le)(F)||this.documentHelper.owner.editor.isTableInsert||F.bodyWidget.containerWidget instanceof Y)){if(F!==g)this.addWidgetToTable(l,e,t,g,v,g.nextRow),this.updateWidgetsToPage(e,t,i.ownerTable,n,g.nextRow),e.indexOf(g.containerWidget)+1>=e.length&&this.addTableWidget(l.clientActiveArea,e,!0),g=F;else{if(i.index>0)if(this.updateWidgetsToPage(e,t,i.ownerTable,n,i),i.previousRenderedWidget instanceof Q){var W=i.previousRenderedWidget;w.round(g.y,2)===w.round(W.y+W.height,2)?e.indexOf(W.containerWidget)+1>=e.length&&this.addTableWidget(l.clientActiveArea,e,!0):this.addTableWidget(l.clientActiveArea,e,!0)}else this.addTableWidget(l.clientActiveArea,e,!0);m=!0,f--}T=e[e.length-1];var N=void 0;(0,a.le)(N=e.length>1?e[e.length-2].containerWidget:i.ownerTable.previousRenderedWidget.containerWidget)||this.documentHelper.pages.indexOf(N.page);var A=i,X=!1,K=void 0,he=void 0;he=m&&1===e.length?e[e.length-1]:e[e.length-2];var ge=!0;if(m&&1===t.length){var te=this.alignBlockElement(i);if(!(0,a.le)(te.node)){var G=te.node;G instanceof Q&&0===G.indexInOwner?e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),(T=e[e.length-1]).height=0):te.node instanceof I&&(he=this.splitParagraph(te.node,parseInt(te.position.index,10)),e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),T=e[e.length-1]),ge=!1),G instanceof Q&&((A=G).ownerTable.equals(i.ownerTable)||(ge=!1)),X=!0}}K=this.moveBlocksToNextPage(he instanceof I?he.previousWidget:he,X);var pe=e[e.length-1];if(m&&ge&&0===A.index&&pe.containerWidget&&-1!==pe.containerWidget.childWidgets.indexOf(pe)&&pe.containerWidget.childWidgets.splice(pe.containerWidget.childWidgets.indexOf(pe),1),ge&&(-1!==K.childWidgets.indexOf(pe)&&K.childWidgets.splice(K.childWidgets.indexOf(pe),1),K.childWidgets.unshift(pe),this.shiftFloatingItemsFromTable(pe,K)),pe.containerWidget=K,m&&A.index>0||t.length>1){var me=m?t[t.length-1]:t[t.length-2];X&&(me=A),this.moveNextWidgetsToTable(e,me,!m),A=i}if(X&&this.updateClientPositionForBlock(ge?pe:he,i),m=!1,A.ownerTable.header&&g.height<l.clientArea.bottom&&!X?(l instanceof ye&&(l.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0),l.updateClientAreaForBlock(A.ownerTable,!0,e),F.x=F.x,F.y=T.y+A.ownerTable.headerHeight,this.updateChildLocationForRow(T.y+A.ownerTable.headerHeight-p/2,F)):(l.updateClientAreaForBlock(A.ownerTable,!0,e),F.x=F.x,F.y=T.y,this.updateChildLocationForRow(T.y-p/2,F)),ge&&this.shiftedFloatingItemsFromTable.length>0){for(P=0;P<this.shiftedFloatingItemsFromTable.length;P++){var Be=this.shiftedFloatingItemsFromTable[P],Me=this.getFloatingItemPoints(Be);Be.y=Me.y,Be.x=Me.x,Be instanceof de&&this.updateChildLocationForCellOrShape(Be.y,Be)}this.shiftedFloatingItemsFromTable=[]}}b=!1}if(h&&(i.ownerTable.continueHeader&&(i.ownerTable.header=!0,i.ownerTable.headerHeight=o+i.ownerTable.headerHeight),d=this.getHeader(i.ownerTable),!(0,a.le)(d)&&i.index===d.index)){var lt=this.getHeaderHeight(i.ownerTable,i,t);if((lt>i.ownerTable.headerHeight||lt>i.ownerTable.headerHeight)&&(i.ownerTable.headerHeight=lt),i.ownerTable.headerHeight>l.clientArea.height)for(i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0,x=this.documentHelper.pages,P=0;P<x.length;P++)x[P].repeatHeaderRowTableWidget&&(x[P].repeatHeaderRowTableWidget=!1)}e.length>2&&i.ownerTable.header&&g.height<l.clientActiveArea.bottom&&!l.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(l.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},s.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.rowFormat.isHeader?t=r:i=!1,!i)break}return t},s.prototype.getHeaderHeight=function(e,t,i){var n=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(!o.rowFormat.isHeader)break;n+=o.height}return n},s.prototype.updateWidgetToRow=function(e){var t=e.ownerRow;if(e.containerWidget=t,!(0,a.le)(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&w.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(t.height=t.height+w.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var i;i="Exactly"===t.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,t.height-w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<i&&(t.height=i+w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},s.prototype.updateHeightForRowWidget=function(e,t,i,n,r,o,l,h){for(var d=0;d<r.childWidgets.length;d++){var f,c=0,u=void 0;if(f=(u=r.childWidgets[d]).cellFormat.rowSpan,c=w.convertPointToPixel(u.ownerTable.tableFormat.cellSpacing),f>1){var g=r.containerWidget.childWidgets.indexOf(r),m=g+f-1-(r.index-u.rowIndex);!h&&(e.clientArea.bottom<u.y+u.height+u.margin.bottom||m>=g+1)&&(1===n.length||n.length>=1&&r===n[n.length-1])&&this.splitSpannedCellWidget(u,i,n,e);var v=r;if(m>0)if(m<r.containerWidget.childWidgets.length){var y=r.containerWidget.childWidgets[m];y instanceof Q&&(v=y)===l&&(v=r)}else v=r.containerWidget.childWidgets[r.containerWidget.childWidgets.length-1];u.y+u.height+u.margin.bottom<v.y+v.height?u.height=v.y+v.height-u.y-u.margin.bottom:o&&v&&0!==v.y&&0!==v.height&&u.y+u.height+u.margin.bottom>v.y+v.height&&("Exactly"!==v.rowFormat.heightType||"Exactly"===v.rowFormat.heightType&&v.rowFormat.height>u.y+u.height+u.margin.bottom-v.y?v.height=u.y+u.height+u.margin.bottom-v.y:u.height=v.y-u.y+v.height)}else c>0&&i.length>1&&r.y===e.clientArea.y&&e instanceof ye&&(c/=2),u.height=r.height-u.margin.top-u.margin.bottom-c;this.updateHeightForCellWidget(e,i,n,u);for(var b=r.containerWidget;b.containerWidget instanceof Ze;)b=b.containerWidget;var C=void 0;b instanceof j&&(C=b.page),(e instanceof ye&&-1!==e.visiblePages.indexOf(C)||t)&&this.updateCellVerticalPosition(u,!1,u.ownerTable.isInsideTable)}},s.prototype.updateHeightForCellWidget=function(e,t,i,n){for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof k&&this.updateHeightForTableWidget(t,i,n.childWidgets[r])},s.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var n=0;n<t.length;n++)t[n]instanceof Q&&(i=t[n].height+i);i=Math.max(i,e.rowFormat.height)}return i},s.prototype.splitSpannedCellWidget=function(e,t,i,n){var r=this.getSplittedWidget(n.clientArea.bottom,!1,t,i,e,void 0);(0,a.le)(r)||this.documentHelper.splittedCellWidgets.push(r)},s.prototype.insertSplittedCellWidgets=function(e,t,i,n){if(!(0,a.le)(i)){var o,r=i.x,l=0;o=w.convertPointToPixel(i.ownerTable.tableHolder.tableWidth);for(var h=0;h<i.childWidgets.length;h++){var d=i.childWidgets[h];if(Math.round(r)<Math.round(d.x-d.margin.left)){if(this.insertRowSpannedWidget(i,e,r,h)){h--;continue}var c=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,r,h,n),c<i.childWidgets.length){if(h===l)break;h--;continue}}if(r+=d.margin.left+d.width+d.margin.right,l++,h===i.childWidgets.length-1&&Math.round(r)<Math.round(i.x+o)){if(this.insertRowSpannedWidget(i,e,r,h+1))continue;this.insertEmptySplittedCellWidget(i,t,r,h+1,n)}}if(((0,a.le)(i.childWidgets)||0===i.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(var u=0;u<this.documentHelper.splittedCellWidgets.length;u++){var p=this.documentHelper.splittedCellWidgets[u];if(Math.round(r)<=Math.round(p.x-p.margin.left)){if(this.insertRowSpannedWidget(i,e,r,u)){u--;continue}var f=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,r,u,n),f<i.childWidgets.length){u--;continue}}if(r+=p.margin.left+p.width+p.margin.right,u===i.childWidgets.length-1&&Math.round(r)<Math.round(i.x+o)){if(this.insertRowSpannedWidget(i,e,r,u+1))continue;this.insertEmptySplittedCellWidget(i,t,r,u+1,n)}}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},s.prototype.insertRowSpannedWidget=function(e,t,i,n){var r=0;e.ownerTable.tableFormat.cellSpacing>0&&(r=w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<this.documentHelper.splittedCellWidgets.length;o++){var l=this.documentHelper.splittedCellWidgets[o];if(Math.round(i)===Math.round(l.x-l.margin.left))return e.childWidgets.splice(n,0,l),l.containerWidget=e,l.height>e.height&&(e.height=l.height),l.y!==e.y+l.margin.top+r&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(o,1),!0}return!1},s.prototype.insertEmptySplittedCellWidget=function(e,t,i,n,r){for(var l,o=t[t.length-1],h=t.length-1;h>=0;h--)for(var d=t[h],c=d.childWidgets.length-1;c>=0;c--){var u=d.childWidgets[c];if(u.index===r){l=u;break}}l&&(o=l.ownerTable,r=l.indexInOwner);for(var p=r;p>=0;p--){var f=o.childWidgets[p],g=f.x;for(h=0;h<f.childWidgets.length;h++){var m=1,v=f.childWidgets[h];if(Math.round(i)===Math.round(g)&&(m=(0,a.le)(v)||(0,a.le)(v.cellFormat)?m:v.cellFormat.rowSpan)>1){var y=this.createCellWidget(v);return e.childWidgets.splice(n,0,y),y.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}g+=v.margin.left+v.width+v.margin.right}}},s.prototype.getSplittedWidget=function(e,t,i,n,r,o){var l=void 0;if(r.y+r.height>e-this.footHeight-r.margin.bottom)for(var h=0;h<r.childWidgets.length;h++)if(r.childWidgets[h]instanceof I){var d=r.childWidgets[h],c=this.getSplittedWidgetForPara(e-r.margin.bottom,d,o);if(!(0,a.le)(c)){if(0===h&&c===d)return r;-1!==r.childWidgets.indexOf(c)&&(r.childWidgets.splice(r.childWidgets.indexOf(c),1),h--),r.height-=c.height,(0,a.le)(l)&&(l=this.createCellWidget(r)),l.height+=c.height,l.childWidgets.push(c),c.containerWidget=l}}else{var u=r.childWidgets[h];if(e-r.margin.bottom<u.y+u.height){var f=u.height,g=this.getSplittedWidgetForTable(e-r.margin.bottom,[u],u,o);if((0,a.le)(g)&&!u.childWidgets[0].rowFormat.allowBreakAcrossPages&&(g=u),!(0,a.le)(g)){if(0===h&&g===u)return r;-1!==r.childWidgets.indexOf(g)?(r.childWidgets.splice(r.childWidgets.indexOf(g),1),h--,r.height-=g.height):r.height-=f-u.height,(0,a.le)(l)&&(l=this.createCellWidget(r)),l.height+=g.height,l.childWidgets.push(g),g.containerWidget=l}}}return(0,a.le)(l)&&t&&this.isRelayoutneed&&(l=this.createCellWidget(r)),l},s.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},s.prototype.createCellWidget=function(e){var t=new V;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},s.prototype.createTableWidget=function(e){var t=new k;return e.header&&(t.header=e.header,t.headerHeight=e.headerHeight),t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.footnoteElement=e.footnoteElement,t.isGridUpdated=e.isGridUpdated,t.wrapTextAround=e.wrapTextAround,t.positioning=e.positioning,t.isContainInsideTable=e.isContainInsideTable,t.isBidiTable=e.isBidiTable,t},s.prototype.getSplittedWidgetForPara=function(e,t,i){for(var n=t.y,r=void 0,o=!1,l=0;l<t.childWidgets.length;l++){var h=t.childWidgets[l],d=this.getFootNoteHeightInLine(h);if(d+=this.existFootnoteHeight,!(0,a.le)(i))for(var c=0;c<i.length;c++)d+=this.getFootNoteHeight(i[c].bodyWidget);if(e<n+d+h.height){if((t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!(0,a.le)(t.associatedCell.ownerRow.previousWidget))||t.paragraphFormat.widowControl&&1===l)&&(o=!0,l=0,h=t.childWidgets[0]),0===l){if(h.paragraph.containerWidget instanceof V&&!o&&h.paragraph.containerWidget.y===t.y){n+=h.height;continue}r=t;break}-1!==t.childWidgets.indexOf(h)&&(t.childWidgets.splice(t.childWidgets.indexOf(h),1),l--),t.height-=h.height,(0,a.le)(r)?((r=new I).characterFormat=t.characterFormat,r.paragraphFormat=t.paragraphFormat,r.index=t.index,this.updateWidgetLocation(t,r),r.height=h.height):r.height+=h.height,r.childWidgets.push(h),h.paragraph=r}this.getFootnoteFromLine(h,i),n+=h.height}return r},s.prototype.getSplittedWidgetForTable=function(e,t,i,n){for(var r=i.y,o=void 0,l=0;l<i.childWidgets.length;l++){var h,c=(h=i.childWidgets[l]).height;if(e<r+c||!(0,a.le)(o)){var u=void 0,p=!0;if(!(0,a.le)(h)&&!(0,a.le)(h.rowFormat)&&(p=h.rowFormat.allowBreakAcrossPages),p?u=(0,a.le)(o)&&this.isFirstLineFitForRow(e,h)?this.getSplittedWidgetForRow(e,t,[h],h,n):h:(0,a.le)(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,h)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?u=this.getSplittedWidgetForRow(e,t,[h],h,n):(0,a.le)(i.containerWidget.containerWidget.previousWidget)||(u=h),!(0,a.le)(u)){if(0===l&&u===h)return i;-1!==i.childWidgets.indexOf(u)?(i.childWidgets.splice(i.childWidgets.indexOf(u),1),l--,i.height-=u.height):i.height-=c-h.height,(0,a.le)(o)?(o=this.createTableWidget(i),this.updateWidgetLocation(i,o),o.height=u.height):o.height+=u.height,o.childWidgets.push(u),u.containerWidget=o}}r+=h.height}return o},s.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],n=i.height,r=this.getFootNoteHeightInLine(i);n+=r+=this.existFootnoteHeight,t.paragraphFormat.keepLinesTogether&&(n=t.height);var o=i.paragraph.containerWidget;if(this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+n>=e)return!0}else if(!o.ownerTable.isInsideTable&&o.containerWidget.y===this.viewer.clientArea.y&&t.y+n>=e)return!0;return t.y+n<=e},s.prototype.isFirstLineFitForTable=function(e,t){var i,n=!1;return(0,a.le)(i=t.childWidgets[0])||(n=this.isFirstLineFitForRow(e,i)),n},s.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(!this.isFirstLineFitForCell(e,t.childWidgets[i]))return!1;return!0},s.prototype.isFirstLineFitForCell=function(e,t){return 0===t.childWidgets.length||(t.childWidgets[0]instanceof I?this.isFirstLineFitForPara(e-t.margin.bottom,t.childWidgets[0]):this.isFirstLineFitForTable(e-t.margin.bottom,t.childWidgets[0]))},s.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},s.prototype.updateChildLocationForTable=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];n.y=e,this.updateChildLocationForRow(e,n),e+=n.height}},s.prototype.updateChildLocationForRow=function(e,t){var i=0;t.ownerTable.tableFormat.cellSpacing>0&&(i=w.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var n=0;n<t.childWidgets.length;n++){var r=t.childWidgets[n];r.index=r.cellIndex,r.y=e+r.margin.top+i,this.updateChildLocationForCellOrShape(r.y,r)}},s.prototype.updateChildLocationForCellOrShape=function(e,t){var i=t;t instanceof de&&(i=t.textFrame);for(var n=0;n<i.childWidgets.length;n++){var r=!1;i.childWidgets[n]instanceof k&&i.childWidgets[n].wrapTextAround&&!(0,a.le)(i.childWidgets[n+1])&&i.childWidgets[n+1].y>i.childWidgets[n].y&&i.childWidgets[n+1].y<i.childWidgets[n].y+i.childWidgets[n].height&&(r=!0),i.childWidgets[n].x=i.childWidgets[n].x,i.childWidgets[n].y=e,i.childWidgets[n]instanceof k&&this.updateChildLocationForTable(e,i.childWidgets[n]),r||(e+=i.childWidgets[n].height)}},s.prototype.updateCellVerticalPosition=function(e,t,i){var n=e.ownerTable.containerWidget;if(n instanceof Ye||n instanceof be||i){var r=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,r,t)}},s.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var n=e.y+t,r=0;r<e.childWidgets.length;r++){if(e.childWidgets[r]instanceof I){var o=e.childWidgets[r];o.y=n,this.updateShapeInsideCell(o,t)}else this.updateTableWidgetLocation(e.childWidgets[r],n,i);n+=e.childWidgets[r].height}},s.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i];n.y+=t,n instanceof de&&this.updateChildLocationForCellOrShape(n.y,n)}},s.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o.y=t;for(var l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];h.y=t+h.margin.top+0,this.updateCellVerticalPosition(h,i,!0)}t+=o.height}return t},s.prototype.getDisplacement=function(e,t){var i,n=e.containerWidget,r=e.margin.top+e.margin.bottom;i=!(0,a.le)(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:((0,a.le)(n)?0:n.height)-r;var o=this.getCellContentHeight(e,!0),l=0;return i>o&&(l=i-o,"Center"===e.cellFormat.verticalAlignment?l/=2:("Top"===e.cellFormat.verticalAlignment||t)&&(l=0)),l},s.prototype.getCellContentHeight=function(e,t){if((0,a.le)(e.childWidgets))return 0;for(var i=0,n=e.y,r=0,o=0,l=!1,h=!1,d=0;d<e.childWidgets.length;d++)if(e.childWidgets[d]instanceof I){var c=e.childWidgets[d];i+=e.childWidgets[d].height;for(var u=0;u<c.floatingElements.length;u++){l=!0;var p=c.floatingElements[u];e.y+e.containerWidget.height>p.y+p.height&&p.y+p.height>o?(r=Math.abs(n-(p.y+p.height)),o=p.y+p.height,h=!1):h=!0}}else this.considerPositionTableHeight(e,e.childWidgets[d])&&(i+=e.childWidgets[d].height);return n+i>o&&(l=!1),t&&l?r:t&&h?e.ownerRow.height:i},s.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t!==n&&(n.y===t.y||n.y+n.height<t.y))return!1}return!0},s.prototype.getTableLeftBorder=function(e){if((0,a.le)(e.left)){var t=new ve(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.left},s.prototype.getTableRightBorder=function(e){if((0,a.le)(e.right)){var t=new ve(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.right},s.prototype.getTableTopBorder=function(e){if((0,a.le)(e.top)){var t=new ve(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.top},s.prototype.getTableBottomBorder=function(e){if((0,a.le)(e.bottom)){var t=new ve(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.bottom},s.prototype.getCellDiagonalUpBorder=function(e){return e.cellFormat.borders.diagonalUp},s.prototype.getCellDiagonalDownBorder=function(e){return e.cellFormat.borders.diagonalDown},s.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var n=e.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++)r+=w.convertPointToPixel(n.childWidgets[o].cellFormat.cellWidth);t<r&&(t=r)}return t},s.prototype.layoutNextItemsBlock=function(e,t,i){var n=e.bodyWidget.sectionIndex,r=e,o=r.getSplitWidgets(),l=o[o.length-1].nextRenderedWidget;((0,a.le)(l)||this.documentHelper.blockToShift===r)&&(this.documentHelper.blockToShift=void 0);for(var h=!0;l instanceof Ve&&l.bodyWidget.sectionIndex===n&&((0,a.le)(i)||!i||l.isLayouted||!this.isInitialLoad);){var d,u,c=r.getSplitWidgets();if(d=c[c.length-1],this.documentHelper.blockToShift===(r=l)&&(this.documentHelper.blockToShift=void 0),h=!1,u=r.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!(0,a.le)(u)&&d.containerWidget===u.containerWidget&&w.round(u.y,2)===w.round(d.y+d.height,2)){(0,a.le)(this.documentHelper.blockToShift)?u.bodyWidget&&u.bodyWidget.floatingElements.length>0&&(this.documentHelper.blockToShift=r):this.documentHelper.blockToShift=r;break}if(h=!0,t.owner.isShiftingEnabled&&0===this.documentHelper.fieldStacks.length){this.documentHelper.blockToShift=r;break}((0,a.le)(this.viewer.owner.editorModule)||!this.viewer.owner.editorModule.isInsertingTOC)&&(r=r.combineWidget(this.viewer),d.containerWidget!==r.containerWidget&&(!(d instanceof I)||d instanceof I&&!d.isEndsWithPageBreak)&&this.updateContainerWidget(r,d.containerWidget,d.indexInOwner+1,!1),r instanceof k&&(this.clearTableWidget(r,!0,!0),r.isGridUpdated=!1),t.updateClientAreaForBlock(r,!0),(this.viewer instanceof Se||r.bodyWidget instanceof Ce)&&(r.containerWidget.height-=r.height),this.documentHelper.layout.layoutBlock(r,0),t.updateClientAreaForBlock(r,!1)),o=l.getSplitWidgets(),l=o[o.length-1].nextRenderedWidget}(!t.owner.isShiftingEnabled||this.documentHelper.blockToShift!==r)&&this.viewer.owner.editorModule.updateListItemsTillEnd(r,h)},s.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var t=this.documentHelper.selection.getTop(e),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t),this.viewer.cutFromLeft(i)},s.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof Ye||t.containerWidget instanceof be)return t;t=t.containerWidget}},s.prototype.reLayoutParagraph=function(e,t,i,n,r){this.allowLayout&&(this.isRelayout=!0,e.containerWidget instanceof be&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),n=!(0,a.le)(n)&&n,this.isRelayout=!0,this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),e.isInsideTable?(this.isBidiReLayout=!0,this.reLayoutTable(e),!this.isFootnoteContentChanged||(0,a.le)(e.bodyWidget)||(0,a.le)(e.bodyWidget.page.footnoteWidget)||this.layoutfootNote(e.bodyWidget.page.footnoteWidget),this.isBidiReLayout=!1):this.reLayoutLine(e,t,n,r),e.bodyWidget instanceof Ce&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer))},s.prototype.getParentRow=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t.ownerRow},s.prototype.reLayoutRow=function(e){e instanceof I&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if((0,a.le)(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var i=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),n=t;this.isVerticalMergedCellContinue(n);){var r=n.previousWidget;if((0,a.le)(r))break;n=r}var o=i.containerWidget;this.viewer instanceof Se&&(o.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||o instanceof be?o instanceof be?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o.sectionFormat,o.page):(e.bodyWidget.isEmpty=!1,o.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),o.page));var l=new re(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),h=new re(l.x,l.y,l.width,l.height);if(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var d=this.documentHelper.selection.getFirstParagraphInFirstCell(i);this.viewer.owner.editorModule.updateWholeListItems(d)}this.viewer.updateClientAreaForBlock(i,!0),this.viewer.cutFromTop(n.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,i.height=0;do{if(this.clearRowWidget(t,!0,!0,!0),this.layoutRow([i],t,!0),n===t)break;n=n.nextRow}while(n&&n!==t);this.updateChildLocationForTable(i.y,i),this.viewer.clientArea=h,this.viewer.clientActiveArea=new re(h.x,h.y,h.width,h.height),this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.shiftTableWidget(i,this.viewer,!0),this.layoutNextItemsBlock(i,this.viewer)}},s.prototype.reLayoutTable=function(e,t){var i=this.getParentTable(e),n=i.combineWidget(this.viewer),r=n.containerWidget;if(this.viewer instanceof Se&&(r.height-=n.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||r instanceof be?r instanceof be?this.viewer.updateClientAreaForTextBoxShape(r.containerShape,!0):this.viewer.updateClientArea(r.sectionFormat,r.page):(e.bodyWidget.isEmpty=!1,r.height-=n.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),r.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var o=this.documentHelper.selection.getFirstParagraphInFirstCell(n);this.viewer.owner.editorModule.updateWholeListItems(o)}this.viewer.updateClientAreaForBlock(n,!0),n.x-=n.leftBorderWidth,n.y-=n.topBorderWidth;var l=this.getYPosition(n);this.viewer.cutFromTop(l),this.clearTableWidget(n,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(n,0),this.viewer.updateClientAreaForBlock(n,!1),this.layoutNextItemsBlock(n,this.viewer,t)},s.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof I)return t.y+t.height;if(t instanceof k){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},s.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&e.footnoteElement.length>0){for(var i=e.bodyWidget.page,n=e.footnoteElement.length-1;n>=0;n--){var r=e.footnoteElement[n];r.isLayout=!1;var o=r.bodyWidget.containerWidget;if(o&&-1!==o.bodyWidgets.indexOf(r.bodyWidget)){var l=this.getFootNoteHeight(r.bodyWidget);o.height-=l,o.bodyWidgets.splice(r.bodyWidget.indexInOwner,1),t&&o.page===i&&(this.viewer.clientActiveArea.height+=l,this.viewer.clientArea.height+=l)}0===o.bodyWidgets.length&&o.page&&(o.page.footnoteWidget=void 0),r.bodyWidget.containerWidget=void 0}e.footnoteElement=void 0}},s.prototype.clearTableWidget=function(e,t,i,n,r){e.height=0,n&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement&&e.footnoteElement.length>0&&this.clearFootnoteReference(e,r));for(var o=0;o<e.childWidgets.length;o++)this.clearRowWidget(e.childWidgets[o],t,i,n)},s.prototype.clearRowWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0);for(var r=0;r<e.childWidgets.length;r++)this.clearCellWidget(e.childWidgets[r],t,i,n)},s.prototype.clearCellWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0),this.clearBlockWidget(e.childWidgets,t,i,n)},s.prototype.clearBlockWidget=function(e,t,i,n){for(var r=0;r<e.length;r++){var o=e[r];o instanceof I?(t&&(o.y=0,o.x=0),i&&(o.height=0)):this.clearTableWidget(o,t,i,n)}},s.prototype.layoutBodyWidgetCollection=function(e,t,i,n,r){if(!(0,a.le)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(t instanceof Ye||t instanceof be){var o=this.checkAndGetBlock(t,e);if((0,a.le)(o))return;if(this.viewer instanceof Se&&(o.containerWidget.height-=o.height),t instanceof Ce)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),o.containerWidget.height-=o.height;else if(t instanceof be)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0);else if(!(0,a.le)(t.containerWidget)&&t.containerWidget instanceof Y){if(this.viewer.updateClientArea(t.sectionFormat,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=o.containerWidget.containerWidget.y}else(0,a.le)(t.page.footnoteWidget),this.viewer.updateClientArea(t.sectionFormat,t.page,!0);if(e>0){var l=o.getSplitWidgets()[0].previousRenderedWidget;if(!(l instanceof I)||l instanceof I&&!l.isEndsWithPageBreak){if(this.viewer.cutFromTop(l.y+l.height),(0,a.le)(r)&&o.containerWidget!==l.containerWidget){var h=o.containerWidget,d=l.containerWidget,c=this.getFootNoteWidgetsOf(o);this.updateContainerWidget(o,d,l.indexInOwner+1,!1),this.moveFootNotesToPage(c,h,d)}}else l instanceof I&&l.isEndsWithPageBreak&&l.containerWidget===o.containerWidget&&this.moveBlocksToNextPage(l,!1)}var u=void 0;(o=o.combineWidget(this.viewer))instanceof k?(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1,u=this.documentHelper.selection.getFirstParagraphInFirstCell(o)):u=o,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(u),this.viewer.updateClientAreaForBlock(o,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(o,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(o,!1),!(0,a.le)(t.containerWidget)&&t.containerWidget instanceof Y&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget),n?this.shiftNextWidgets(o):this.layoutNextItemsBlock(o,this.viewer)}else if(t instanceof V){var p=this.documentHelper.layout.getParentTable(t.ownerTable).getSplitWidgets()[0];this.reLayoutTable(t.ownerTable),this.layoutNextItemsBlock(p,this.viewer)}this.isRelayoutFootnote=!1},s.prototype.checkAndGetBlock=function(e,t){if(e instanceof be)return e.childWidgets[t];for(var i=e.index;e&&e.index===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.index===t)return r}if(!(e instanceof j))break;e=e.nextRenderedWidget}},s.prototype.layoutTable=function(e,t){e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"!==this.documentHelper.compatibilityMode&&!e.isInsideTable&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-w.convertPointToPixel(e.firstChild.firstChild.leftMargin));var i=[e];this.addTableWidget(this.viewer.clientActiveArea,i),this.viewer.updateClientAreaTopOrLeft(e,!0);var n,r,o=0;e.wrapTextAround?(n=this.viewer.clientActiveArea.clone(),r=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(i,e,!0,n,r)):(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(o=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x));var l=e.childWidgets[0].rowFormat.isHeader;e.childWidgets.length>0&&(e.header=l,e.continueHeader=l,e.headerHeight=0);for(var h=e.childWidgets[t];h;)h=(h=this.layoutRow(i,h)).nextRow;return this.documentHelper.viewer instanceof ye&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(i,[],e,!0),o>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-o),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(i,e,!1,n,r),i[i.length-1].isLayouted=!0,"Word2013"!==this.documentHelper.compatibilityMode&&!e.isInsideTable&&!e.wrapTextAround&&(this.viewer.clientArea.x=this.viewer.clientArea.x+w.convertPointToPixel(e.firstChild.firstChild.leftMargin)),i[i.length-1]},s.prototype.updateClientAreaForWrapTable=function(e,t,i,n,r){if(i){if(t.wrapTextAround){this.updateTableFloatPoints(t);var o=this.viewer.clientActiveArea.clone(),l=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea);o.x!==l.x&&(t.x=this.viewer.clientActiveArea.x),o.y!==l.y&&(t.y=this.viewer.clientActiveArea.y)}}else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length)-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t),!(0,a.le)(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable?(this.viewer.clientActiveArea=n.clone(),this.viewer.clientArea=r.clone()):this.viewer.updateClientArea(t.bodyWidget.sectionFormat,t.bodyWidget.page);else{this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget.sectionFormat,t.bodyWidget.page);for(var h=0;h<e.length;h++){var d=e[h].bodyWidget;!(0,a.le)(d)&&-1===d.floatingElements.indexOf(e[h])&&d.floatingElements.push(e[h])}}},s.prototype.addTableWidget=function(e,t,i){var n=t[t.length-1];return i&&(n=this.createTableWidget(n),t.push(n)),n.width=e.width,n.x=e.x,n.y=e.y,n.tableFormat.cellSpacing>0&&(n.height=n.height+w.convertPointToPixel(n.tableFormat.cellSpacing),n.isBidiTable?(n.leftBorderWidth=w.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=w.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth())):(n.leftBorderWidth=w.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=w.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth())),n.topBorderWidth=w.convertPointToPixel(this.getTableTopBorder(n.tableFormat.borders).getLineWidth()),n.bottomBorderWidth=w.convertPointToPixel(this.getTableBottomBorder(n.tableFormat.borders).getLineWidth()),n.x+=n.leftBorderWidth,n.y+=n.topBorderWidth,n.width-=n.leftBorderWidth,n.width-=n.rightBorderWidth,n.height+=n.bottomBorderWidth),n},s.prototype.updateWidgetsToPage=function(e,t,i,n,r){var o=this.viewer,l=e[e.length-1];if(!i.isInsideTable){for(var h=0;h<e.length;h++)this.updateHeightForTableWidget(e,t,e[h],r);l.childWidgets.length>0&&l.y!==l.childWidgets[0].y&&(l.y=l.childWidgets[0].y)}if(i.isBidiTable&&n)for(h=0;h<e.length;h++)for(var d=e[h],c=0;c<d.childWidgets.length;c++)d.childWidgets[c].shiftWidgetForRtlTable();i.tableFormat.cellSpacing>0&&(l.y+l.height+w.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof Se&&(l.height=l.height-w.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(l.y+l.height)),this.viewer instanceof Se&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof Ce&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},s.prototype.updateHeightForTableWidget=function(e,t,i,n){for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];if(o===n)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!0,n)}},s.prototype.layoutRow=function(e,t,i){var n=t.ownerTable.isInsideTable;n||this.updateExistingFootnoteHeight(t);var r=this.viewer;this.addTableRowWidget(r.clientActiveArea,[t]),r.updateClientAreaForRow(t,!0);for(var l=this.getMaxTopCellMargin(t),h=this.getMaxBottomCellMargin(t),d=0;d<t.childWidgets.length;d++)this.layoutCell(t.childWidgets[d],l+t.topBorderWidth,h+t.bottomBorderWidth);r.updateClientAreaForRow(t,!1);var u=[t];return i||this.updateWidgetsToTable(e,u,t,!1),n||(this.layoutedFootnoteElement=[]),u[u.length-1]},s.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],this.existFootnoteHeight=(0,a.le)(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?0:e.bodyWidget.page.footnoteWidget.height},s.prototype.isIntersecting=function(e,t,i,n){return(w.round(i,2)<=w.round(e,2)||w.round(i,2)<w.round(t,2))&&w.round(n,2)>w.round(e,2)},s.prototype.getAdjacentRowCell=function(e,t,i,n){var r=[],o=e.ownerTable.tableHolder.columns.length,l=e.ownerTable.childWidgets[n];if((0,a.le)(l))return r;var h=0,d=0,c=e.cellFormat.columnSpan,u=e.columnIndex;if(l.rowFormat.gridBefore>0){if(l.rowFormat.gridBefore>u+c)return r;h=l.rowFormat.beforeWidth,d=l.rowFormat.gridBefore}for(var p=0;p<l.childWidgets.length;p++){var f=l.childWidgets[p],g=f.x-f.margin.left,m=f.x+f.width+f.margin.right,v=f.columnIndex+f.cellFormat.columnSpan;if(p==l.childWidgets.length-1||w.round(g,2)>w.round(h,2)&&w.round(g,2)>w.round(t,2)){if(p==l.childWidgets.length-1&&l.rowFormat.gridAfter>0&&v+l.rowFormat.gridAfter===o)return r;if(this.isIntersecting(t,i,h,g))for(;c>0;){var b,y=l.getVerticalMergeStartCell(u,c);if((0,a.le)(y))break;var C=y.cellFormat.columnSpan;if(r.push(y),t=b=y.x+y.width+y.margin.right,c-=(d=y.columnIndex+C)-u,u=d,w.round(b,2)>=w.round(i,2))break}}if(this.isIntersecting(t,i,g,m)&&(r.push(f),t=m,c-=v-u,u=v),w.round(m,2)>=w.round(i,2))break;h=m,d=v}return r},s.prototype.addTableRowWidget=function(e,t){var i=t[t.length-1];0===i.rowFormat.beforeWidth&&0===i.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==i.ownerTable.tableFormat.tableAlignment?i.x=e.x:i.x+=0!==i.rowFormat.beforeWidth?i.rowFormat.beforeWidth:i.rowFormat.gridBeforeWidth,i.y=e.y,i.width=e.width;var n=0;if(!(0,a.le)(i.ownerTable)&&!(0,a.le)(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing>0){i.height=i.height+w.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);for(var r=0;r<i.childWidgets.length;r++)if(!(0,a.le)(i.childWidgets[r].cellFormat)&&!(0,a.le)(i.childWidgets[r].cellFormat.borders)){var o=V.getCellBottomBorder(i.childWidgets[r]).getLineWidth();o>n&&(n=o)}if(i.bottomBorderWidth=w.convertPointToPixel(n),i.index>0&&!(0,a.le)(i.previousWidget)){var l=i.previousWidget;n=0;for(var h=0;h<l.childWidgets.length;h++)if(!(0,a.le)(l.childWidgets[h].cellFormat)&&!(0,a.le)(l.childWidgets[h].cellFormat.borders)){var d=V.getCellBottomBorder(l.childWidgets[h]).getLineWidth();d>n&&(n=d)}i.topBorderWidth=w.convertPointToPixel(n)}}if(!(0,a.le)(i.childWidgets))for(h=0;h<i.childWidgets.length;h++)if(!(0,a.le)(i.childWidgets[h].cellFormat)&&!(0,a.le)(i.childWidgets[h].cellFormat.borders)){var c=V.getCellTopBorder(i.childWidgets[h]).getLineWidth();c>n&&(n=c)}if(i.topBorderWidth=w.convertPointToPixel(n),!(0,a.le)(i.ownerTable)&&!(0,a.le)(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing<=0&&i.rowIndex===i.ownerTable.childWidgets.length-1){for(h=0;h<i.childWidgets.length;h++)if(!(0,a.le)(i.childWidgets[h].cellFormat)&&!(0,a.le)(i.childWidgets[h].cellFormat.borders)){var u=V.getCellBottomBorder(i.childWidgets[h]).getLineWidth();u>n&&(n=u)}i.bottomBorderWidth=w.convertPointToPixel(n)}return i},s.prototype.getMaxTopCellMargin=function(e){if((0,a.le)(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r,n=e.childWidgets[i];(r=n.cellFormat.hasValue("topMargin")?w.convertPointToPixel(n.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?w.convertPointToPixel(e.rowFormat.topMargin):w.convertPointToPixel(e.ownerTable.tableFormat.topMargin))>t&&(t=r)}return t},s.prototype.getMaxBottomCellMargin=function(e){if((0,a.le)(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r,n=e.childWidgets[i];(r=n.cellFormat.hasValue("bottomMargin")?w.convertPointToPixel(n.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?w.convertPointToPixel(e.rowFormat.bottomMargin):w.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin))>t&&(t=r)}return t},s.prototype.layoutCell=function(e,t,i){var n=this.viewer;if(this.addTableCellWidget(e,n.clientActiveArea,t,i),this.updateTopBorders(e),n.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var r=new I;r.characterFormat=new ie,r.paragraphFormat=new ue,r.index=0;var o=new oe(r);r.childWidgets.push(o),e.childWidgets.push(r)}for(var l=0;l<e.childWidgets.length;l++){var h=e.childWidgets[l];n.updateClientAreaForBlock(h,!0),h.containerWidget=e,this.layoutBlock(h,0),n.updateClientAreaForBlock(h,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1)},s.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistory||!this.documentHelper.owner.editorHistory.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action)},s.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing){var t=e.cellFormat.borders.top;(!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color"))&&(t=e.ownerRow.rowFormat.borders.horizontal),t.isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var i=e.x-e.margin.left,n=e.x+e.width+e.margin.right,r=this.getAdjacentRowCell(e,i,n,e.ownerRow.indexInOwner-1),o=0;o<r.length;o++){var l=r[o],h=l.cellFormat.borders.bottom;(!h.isBorderDefined||h.isBorderDefined&&"None"===h.lineStyle&&0===h.lineWidth&&h.hasValue("color"))&&(h=l.ownerRow.rowFormat.borders.horizontal),h.isBorderDefined||(h=l.ownerRow.ownerTable.tableFormat.borders.horizontal);var d;d="None"===t.lineStyle||"Cleared"===t.lineStyle?h:"Cleared"===h.lineStyle||"None"===h.lineStyle?t:e.getBorderBasedOnPriority(t,h);var c=l.x-l.margin.left,u=l.x+l.width+l.margin.right;if(0===o&&i<c&&e.updatedTopBorders.push({border:t,width:c-i}),d){var p=0;w.round(u,2)===w.round(n,2)&&w.round(c,2)===w.round(i,2)?p=n-i:w.round(c,2)>=w.round(i,2)&&w.round(u,2)>=w.round(n,2)?p=n-c:w.round(c,2)>=w.round(i,2)&&w.round(u,2)<=w.round(n,2)?p=u-c:w.round(c,2)<=w.round(i,2)&&w.round(u,2)<=w.round(n,2)?p=u-i:(w.round(c,2)<=w.round(i,2)&&(w.round(u,2),w.round(n,2)),p=n-i),p<0&&(p=0),e.updatedTopBorders.push({border:d,width:p})}o===r.length-1&&n>u&&e.updatedTopBorders.push({border:t,width:n-u})}}},s.prototype.shiftLayoutedItems=function(e){if((0,a.le)(this.documentHelper.blockToShift)||(0,a.le)(this.documentHelper.blockToShift.containerWidget))return this.documentHelper.blockToShift=void 0,void this.checkAndShiftEndnote();var t=this.documentHelper.blockToShift,i=t.bodyWidget.index;this.reLayoutOrShiftWidgets(t,this.viewer);for(var n=!0,r=t.getSplitWidgets(),o=r[r.length-1].nextRenderedWidget;o instanceof Ve&&o.bodyWidget.index===i;){var l,h=t.getSplitWidgets();l=h[h.length-1],n=!1;var d=void 0;if(h=(t=o).getSplitWidgets(),(t instanceof I||t instanceof k)&&(d=h[0]),l.containerWidget===d.containerWidget&&w.round(d.y,2)===w.round(this.viewer.clientActiveArea.y,2)&&(0,a.le)(d.nextWidget))break;(0,a.le)(l.floatingElements),n=!0,this.reLayoutOrShiftWidgets(t,this.viewer),o=(r=t.getSplitWidgets())[r.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(t,n),this.documentHelper.blockToShift=void 0;var c=this.viewer;this.documentHelper.removeEmptyPages(),this.updateFieldElements(),(!this.documentHelper.owner.enableLockAndEdit||!e)&&c.updateScrollBars()},s.prototype.checkAndShiftEndnote=function(){if(this.documentHelper.owner.selection){var e=this.documentHelper.owner.selection.end.paragraph;e.isInsideTable&&(e=this.getParentTable(e)),!e.isInHeaderFooter&&!(e.bodyWidget.containerWidget instanceof Y)&&(0,a.le)(e.nextRenderedWidget)&&!(e.bodyWidget instanceof Y)&&!this.isRelayoutFootnote&&e.bodyWidget.page.endnoteWidget&&this.layoutfootNote(e.bodyWidget.page.endnoteWidget)}},s.prototype.updateFieldElements=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[e];if((this.viewer instanceof ye||this.viewer instanceof Se&&!(t.line.paragraph.bodyWidget instanceof Ce))&&!(0,a.le)(this.documentHelper.selection)){var i=this.documentHelper.selection.getFieldCode(t);if(!(0,a.le)(i)&&(i.toLowerCase().match("numpages")||i.toLowerCase().match("sectionpages"))&&!(0,a.le)(t.fieldSeparator)){var n=t.fieldSeparator.nextNode;if(!(0,a.le)(n)){var r=n.text;n.text=this.documentHelper.pages.length.toString();var o=t.line.paragraph;if(!(0,a.le)(o.bodyWidget)&&!(0,a.le)(o.bodyWidget.page)&&r!==n.text){var l=o.childWidgets.indexOf(t.line),h=t.line.children.indexOf(n);this.reLayoutParagraph(o,l,h)}}}}}},s.prototype.reLayoutOrShiftWidgets=function(e,t){var i=e,n=!1;if(this.isNeedToRelayout(e.bodyWidget)?(this.updateContainerForTable(i,t),i instanceof k&&(i=i.combineWidget(this.viewer),this.clearTableWidget(i,!0,!0,!0)),t.updateClientAreaForBlock(i,!0),this.layoutBlock(i,0),t.updateClientAreaForBlock(i,!1),n=!0):this.shiftWidgetsBlock(i,t),this.documentHelper.pages.indexOf(i.bodyWidget.page)>0&&i===i.bodyWidget.childWidgets[0]&&i instanceof I)for(var o=i.bodyWidget.childWidgets[0].childWidgets[0].children,l=0;l<o.length;l++){var h=o[l];h.margin.top>0&&h.margin.top===this.getBeforeSpacing(h.paragraph)&&(h.margin.top-=this.getBeforeSpacing(h.paragraph))}this.viewer.owner.editorModule&&!n&&this.viewer.owner.editorModule.updateRenderedListItems(i),!this.isRelayoutFootnote&&i.bodyWidget.page.footnoteWidget&&this.layoutfootNote(i.bodyWidget.page.footnoteWidget),!(i.bodyWidget instanceof Y)&&!this.isRelayoutFootnote&&i.bodyWidget.page.endnoteWidget&&this.layoutfootNote(i.bodyWidget.page.endnoteWidget)},s.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof k||i instanceof Pe&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},s.prototype.shiftWidgetsBlock=function(e,t){e instanceof I?this.shiftWidgetsForPara(e,t):e instanceof k&&this.shiftWidgetsForTable(e,t)},s.prototype.shiftWidgetsForPara=function(e,t){if(!(e.height>t.clientArea.height+t.clientArea.y))for(var n=this.getBodyWidgetOfPreviousBlock(e,0),r=n.bodyWidget,o=n.index,l=void 0,h=!1,d=0;d<e.getSplitWidgets().length;d++){var c=e.getSplitWidgets()[d];if(!(0,a.le)(l)){if(this.shiftToPreviousWidget(c,t,l,u=!!l.lastChild&&l.lastChild.isEndsWithPageBreak),((0,a.le)(c.childWidgets)||0===c.childWidgets.length)&&!u){d--;continue}l=void 0,r!==c.containerWidget&&(r=c.containerWidget,u&&t.updateClientAreaByWidget(c))}var p=[];if(h||(p=this.getFootNoteWidgetsOf(c)),h=!1,this.isFitInClientArea(c,t,p)){if(this.keepWithNext&&(this.updateClientPositionForBlock(c.containerWidget.firstChild,c),this.keepWithNext=!1),l=c,c.y=t.clientActiveArea.y,c.floatingElements.length>0)for(var f=0;f<c.floatingElements.length;f++){var g=c.floatingElements[f],m=0;if(g instanceof de&&"Inline"===g.textWrappingStyle){var v=g.line.indexInOwner,y=0;m=g.textFrame.marginTop;for(var b=0;b<v;b++)y+=c.childWidgets[b].height;g.y=c.y+y}else{var C=this.getFloatingItemPoints(g);g.y=C.y,g.x=C.x}g instanceof de&&this.updateChildLocationForCellOrShape(g.y+m,g)}if(t.cutFromTop(t.clientActiveArea.y+c.height),!(0,a.le)(r)&&r!==c.containerWidget&&(o++,r.lastChild.isEndsWithPageBreak||this.updateContainerWidget(c,r,o,!0,p),p.length>0&&r.page.footnoteWidget))for(f=0;f<p.length;f++)-1===r.page.footnoteWidget.bodyWidgets.indexOf(p[f])&&c.bodyWidget.page.index!=p[f].page.index&&(r.page.footnoteWidget.bodyWidgets.push(p[f]),r.page.footnoteWidget.height+=p[f].height);if(c.isEndsWithPageBreak&&this.viewer instanceof ye){var F=this.createOrGetNextBodyWidget(r,this.viewer);F=this.moveBlocksToNextPage(c,!0),t.updateClientArea(F.sectionFormat,F.page)}}else{var T=c.previousRenderedWidget,u=!1;T instanceof I&&T.isEndsWithPageBreak&&this.viewer instanceof ye&&(u=!0);var x=this.splitWidget(c,t,r,o+1,u,p);l=void 0,r!==c.containerWidget&&(r=c.containerWidget,d--,p.length>0&&(h=!0)),o=r.childWidgets.indexOf(c),x&&(r=e.getSplitWidgets()[d+1].containerWidget)}}},s.prototype.getFootNotesOfBlock=function(e,t){if((0,a.le)(t)&&(t=[]),e.childWidgets.length>0)for(var i=0;i<this.documentHelper.footnoteCollection.length;i++)this.documentHelper.footnoteCollection[i].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[i]);return t},s.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Ee&&t.push(n)}return this.getFootNoteWidgetsBy(e.paragraph,t)},s.prototype.getFootNoteWidgetsBy=function(e,t){var i=[];if(e.bodyWidget.page.footnoteWidget)for(var n=0;n<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(var r=0;r<t.length;r++)e.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[n]);if(0===i.length&&!(0,a.le)(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(n=0;n<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n]);else if(!(0,a.le)(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n]);else if(!(0,a.le)(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n]);return i},s.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],n=[];if(e instanceof k)for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++)for(var h=o.childWidgets[l],d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d];n=this.getFootNotesOfBlock(c,n);for(var u=this.getFootNoteWidgetsBy(c,n),p=0;p<u.length;p++)-1===i.indexOf(u[p])&&i.push(u[p])}else if((n=this.getFootNotesOfBlock(e)).length>0&&(i=this.getFootNoteWidgetsBy(e,n)),t&&0===i.length)for(var f=0;f<n.length;f++)i.push(n[f].bodyWidget);return i},s.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var r,t=e.getSplitWidgets(),i=[],n=e.containerWidget,o=0;o<t.length;o++)for(var l=this.getFootNoteWidgetsOf(t[o]),h=0;h<l.length;h++)n!==(r=l[h].containerWidget)&&i.push(l[h]);return{footNoteWidgets:i,fromBodyWidget:r,toBodyWidget:n}},s.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1);var r,o,n=[e];this.addTableWidget(this.viewer.clientActiveArea,n),this.viewer.updateClientAreaTopOrLeft(e,!0),e.wrapTextAround&&(r=this.viewer.clientActiveArea.clone(),o=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(n,e,!0,r,o));for(var l=e.childWidgets[0];l;)l=(l=this.shiftRowWidget(n,l,i)).nextRow;return this.updateWidgetsToPage(n,[],e,!0),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(n,e,!1,r,o),n[n.length-1]},s.prototype.shiftRowWidget=function(e,t,i){void 0===i&&(i=!1);var n=this.viewer;i&&(t.height=0);var r=t.ownerTable.isInsideTable;r||this.updateExistingFootnoteHeight(t);var o=[t];this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var l=0;l<t.childWidgets.length;l++){var h=t.childWidgets[l];i&&(h.height=0),this.shiftCellWidget(h,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}if(n.updateClientAreaForRow(t,!1),!r){var d=this.footnoteHeight;this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=d}return this.updateWidgetsToTable(e,o,t,!1),r||(this.layoutedFootnoteElement=[]),o[o.length-1]},s.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),(0,a.le)(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var i=0;i<t.length;i++)e.ownerTable.footnoteElement.push(t[i])},s.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},s.prototype.shiftCellWidget=function(e,t,i,n){(0,a.le)(n)&&(n=!1);var r=this.viewer;this.addTableCellWidget(e,r.clientActiveArea,t,i);var o=this.viewer.clientActiveArea.height;r.updateClientAreaForCell(e,!0);for(var l=0;l<e.childWidgets.length;l++){var h=e.childWidgets[l];r.updateClientAreaForBlock(h,!0),h instanceof I?this.shiftParagraphWidget(h):this.shiftTableWidget(h,r,n),r.updateClientAreaForBlock(h,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=o)},s.prototype.shiftParagraphWidget=function(e){this.addParagraphWidget(this.viewer.clientActiveArea,e),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var t=this.getFootNoteWidgetsOf(e,!0),i=0;i<t.length;i++)this.layoutedFootnoteElement.push(t[i].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(t),this.updateWidgetToPage(this.viewer,e)},s.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),n=i.bodyWidget,r=i.index;n!==e.containerWidget&&(n.lastChild.lastChild.isEndsWithPageBreak?t.updateClientArea(e.bodyWidget.sectionFormat,e.bodyWidget.page):this.updateContainerWidget(e,n,r+1,!0)),(e.isInHeaderFooter||this.viewer instanceof Se)&&(e.containerWidget.height-=e.height)},s.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0);var i=this.viewer.clientArea.x;"Word2013"!==this.documentHelper.compatibilityMode&&!e.isInsideTable&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-w.convertPointToPixel(e.firstChild.firstChild.leftMargin)),this.updateVerticalPositionToTop(e,!0);var n=e.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(n.y,n),this.clearTableWidget(n,!0,!1,!1,!0),this.shiftTableWidget(n,this.viewer),this.updateVerticalPositionToTop(e,!1),"Word2013"!==this.documentHelper.compatibilityMode&&!e.isInsideTable&&(this.viewer.clientArea.x=i),this.viewer.updateClientAreaForBlock(e,!1)},s.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var n=e.getSplitWidgets()[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],l=0;l<o.childWidgets.length;l++)this.documentHelper.layout.updateCellVerticalPosition(o.childWidgets[l],t,!1)},s.prototype.splitWidget=function(e,t,i,n,r,o){var l=e.childWidgets[0],d=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?e.height:this.getMaxElementHeight(l),c=e.getSplitWidgets(),u=e.containerWidget;d=this.getMaximumLineHeightToSplit(e,d,t);var p=this.getFootNotesWidgetsInLine(l);if((0,a.le)(e.previousWidget)&&p.length>0)for(var f=0;f<p.length;f++)for(var g=0;g<p[f].childWidgets.length;g++)d+=p[f].childWidgets[g].height;if(t.clientActiveArea.height>=d&&!r){var m=void 0,v=c.indexOf(e);if(v<c.length-1?u=(m=c[v+1]).containerWidget:((m=new I).index=e.index,m.characterFormat=e.characterFormat,m.paragraphFormat=e.paragraphFormat,m.width=e.width,m.x=e.x,m.y=e.y,c.push(m)),i!==e.containerWidget){var y=e.containerWidget;(-1!==e.childWidgets.indexOf(this.documentHelper.selection.start.currentWidget)||-1!==e.childWidgets.indexOf(this.documentHelper.selection.end.currentWidget))&&(this.updateContainerWidget(e,i,n,!0),this.moveFootNotesToPage(o,y,i))}for(f=e.childWidgets.length-1;f>0;f--){var b=e.childWidgets[f];if(this.isFitInClientArea(e,t,void 0)){1===m.childWidgets.length&&this.updateParagraphWidgetInternal(b,m,0);break}this.updateParagraphWidgetInternal(b,m,0)}if((0,a.le)(m.containerWidget)&&m.childWidgets.length>0){var C=t.clientActiveArea.y,F=new re(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),T=new re(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height);if((u=this.moveBlocksToNextPage(e,!1)).childWidgets.splice(0,0,m),u.height+=m.height,m.containerWidget=u,u!=i&&i.page.footnoteWidget&&(o=this.getFootNoteWidgetsOf(m,!0),this.moveFootNotesToPage(o,i,u)),1===u.childWidgets.length&&u.firstChild instanceof I&&u.firstChild.equals(e))return e.y=C,!0;t.clientArea=F,t.clientActiveArea=T}}else if(u=this.createOrGetNextBodyWidget(i,this.viewer),e.containerWidget!==u){var x=e,P=this.alignBlockElement(e);(0,a.le)(P.node)||(e=x=P.node instanceof Q?this.splitRow(P.node):this.splitParagraph(P.node,parseInt(P.position.index,10)),this.keepWithNext=!0),u=this.moveBlocksToNextPage(e,!0),this.updateContainerWidget(e,u,0,!0),(0,a.le)(i.page.footnoteWidget)||this.moveFootNotesToPage(o,i,u)}else!(0,a.le)(i)&&(0,a.le)(e.previousWidget)&&(this.updateContainerWidget(e,i,i.childWidgets.length,!1),x=e,P=this.alignBlockElement(e),(0,a.le)(P.node)?this.updateContainerWidget(e,u,0,!0):(x=P.node instanceof Q?this.splitRow(P.node):this.splitParagraph(P.node,parseInt(P.position.index,10)),this.keepWithNext=!0,u=this.moveBlocksToNextPage(x.previousWidget,!0),this.updateClientPositionForBlock(e.previousWidget,e)));return i===e.containerWidget?(e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(u.sectionFormat,u.page),!1},s.prototype.getMaximumLineHeightToSplit=function(e,t,i){if(i.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!(0,a.le)(e.previousWidget)&&(0,a.le)(e.previousSplitWidget))for(var n=e.height,r=e.childWidgets.length-1;r>=0;r--){var o=e.childWidgets[r],l=this.getMaxElementHeight(o);if(o.height>l&&(n-=o.height-l),i.clientActiveArea.height>=n){0===r&&(t=e.height);break}n-=o.height}return t},s.prototype.moveFootNotesToPage=function(e,t,i){if(e.length>0&&t.page.footnoteWidget){for(var n=-1,r=void 0,o=0,l=!1,h=0;h<e.length;h++)if((n=t.page.footnoteWidget.bodyWidgets.indexOf(r=e[h]))>=0){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var d=0;d<i.page.footnoteWidget.bodyWidgets.length;d++)i.page.footnoteWidget.bodyWidgets[d].footNoteReference===r.footNoteReference&&(l=!0);if(t.page.footnoteWidget.bodyWidgets.splice(n,1),i.page.footnoteWidget.bodyWidgets.indexOf(r)<0&&!l){var p=this.documentHelper.pages.indexOf(t.page),f=this.documentHelper.pages.indexOf(i.page);r.containerWidget=i.page.footnoteWidget,r.page=i.page,p>f?(i.page.footnoteWidget.bodyWidgets.push(r),o++):i.page.footnoteWidget.bodyWidgets.splice(o++,0,r),i.page.footnoteWidget.height+=r.height}t.page.footnoteWidget.height-=r.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},s.prototype.addEmptyFootNoteToBody=function(e){var t=new Y;t.footNoteType="Footnote",t.page=e.page;var i=new I;i.characterFormat=new ie,i.paragraphFormat=new ue,i.index=0;var n=new oe(i);i.childWidgets.push(n),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new $e(0,t.height,0,0),e.page.footnoteWidget=t},s.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof _||2===e.children.length&&e.children[0]instanceof _&&e.children[1]instanceof _)t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height,t+=0,e.children.length>0&&t<(r=e.children[0]).margin.top+r.height&&(t=r.margin.top+r.height);else for(var o=0;o<e.children.length;o++){var r;t<(r=e.children[o]).margin.top+r.height&&(t=r.margin.top+r.height)}return t},s.prototype.createOrGetNextBodyWidget=function(e,t){var n,i=void 0;n=this.documentHelper.pages.indexOf(e.page);var o,r=void 0;if(o=e.index,n===this.documentHelper.pages.length-1||this.documentHelper.pages[n+1].sectionIndex!==o){var l=new j;l.sectionFormat=e.sectionFormat,l.index=e.index,r=t.createNewPage(l),this.documentHelper.pages[n+1].sectionIndex!==o&&this.documentHelper.insertPage(n+1,r),i=r.bodyWidgets[0]}else i=(r=this.documentHelper.pages[n+1]).bodyWidgets[0];return i},s.prototype.isFitInClientArea=function(e,t,i){var n=e.childWidgets[e.childWidgets.length-1],r=e.height,o=this.getMaxElementHeight(n);n.height>o&&(r-=n.height-o);var l=0;if(!(0,a.le)(i)&&i.length>0){i[0].containerWidget instanceof Y&&(l=i[0].containerWidget.margin.top);for(var h=0;h<i.length;h++)for(var d=0;d<i[h].childWidgets.length;d++)l+=i[h].childWidgets[d].height}return t.clientActiveArea.height>=r+l},s.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},s.prototype.shiftToPreviousWidget=function(e,t,i,n){var r=e.containerWidget,o=i.containerWidget,l=[],h=[];o!==r&&(l=this.getFootNotesOfBlock(e));for(var d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[d],u=this.getMaxElementHeight(c);if(this.isLineInFootNote(c,l)){for(var p=this.getFootNoteWidgetsBy(c.paragraph,l),f=0,g=0;g<p.length;g++)for(var m=p[g],v=0;v<m.childWidgets.length;v++)f+=m.childWidgets[v].height;p.length>0&&p[0].containerWidget&&(f+=p[0].containerWidget.margin.top),u+=f}if(!(t.clientActiveArea.height>=u)||n){var y=i.containerWidget,b=this.createOrGetNextBodyWidget(y,t);e.containerWidget!==b&&(b=this.moveBlocksToNextPage(e,!0)),y!==b&&((l=this.getFootNotesOfBlock(e)).length>0&&(h=h.concat(this.getFootNoteWidgetsBy(e,l)),o=b),this.updateContainerWidget(e,b,0,!0)),t.updateClientArea(r.sectionFormat,r.page);break}if(l.length>0&&this.isLineInFootNote(c,l)&&(h=h.concat(this.getFootNoteWidgetsBy(c.paragraph,l))),this.updateParagraphWidgetInternal(c,i,i.childWidgets.length),d--,t.cutFromTop(t.clientActiveArea.y+c.height),(0,a.le)(e.childWidgets))break}!(0,a.le)(h)&&h.length>0&&r.page.footnoteWidget&&r!=o&&this.moveFootNotesToPage(h,r,o)},s.prototype.updateParagraphWidgetInternal=function(e,t,i){(0,a.le)(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,(0,a.le)(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),((0,a.le)(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),t.childWidgets.splice(i,0,e),e.paragraph=t,t.height+=e.height,(0,a.le)(t.containerWidget)||(t.containerWidget.height+=e.height)},s.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof Ve;)this.reLayoutOrShiftWidgets(t=t.nextWidget,this.viewer)},s.prototype.updateContainerWidget=function(e,t,i,n,r){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof Y)){var o=e.containerWidget;if(!(0,a.le)(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,((0,a.le)(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof j&&e.containerWidget!==t&&n)){var l=e.containerWidget.page;this.documentHelper.pages[this.documentHelper.pages.length-1]===l&&-1!==this.viewer.visiblePages.indexOf(l)&&this.documentHelper.scrollToBottom(),((0,a.le)(l.nextPage)||l.nextPage.bodyWidgets[0].index!==e.containerWidget.index)&&e.containerWidget.destroyInternal(this.viewer)}if(t.childWidgets.splice(i,0,e),e instanceof I&&!(0,a.le)(e.floatingElements))for(var h=0;h<e.floatingElements.length;h++){var d=e.floatingElements[h];"Inline"!==d.textWrappingStyle&&(t.floatingElements.push(d),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(d),1),t.floatingElements.sort(function(c,u){return c.y-u.y}))}e instanceof k&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,o&&o.page&&o.page.footnoteWidget&&r&&r.length>0&&this.moveFootNotesToPage(r,o,t)}},s.prototype.getBodyWidgetOfPreviousBlock=function(e,t){var i=void 0,n=e.previousRenderedWidget;return i=n&&n.containerWidget.equals(e.containerWidget)?n.containerWidget:e.containerWidget,t=n&&n.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(n):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},s.prototype.moveBlocksToNextPage=function(e,t){var i=e.bodyWidget,r=i.page.index+1,o=void 0,l=void 0,h=!1;for(this.documentHelper.pages.length>r&&(0!==(o=this.documentHelper.pages[r]).bodyWidgets.length&&i.equals(o.bodyWidgets[0])?this.viewer.updateClientArea((l=o.bodyWidgets[0]).sectionFormat,l.page):(o=void 0,h=!0)),(0,a.le)(o)&&(l=this.createSplitBody(i),o=this.viewer.createNewPage(l,r),h&&this.documentHelper.insertPage(r,o),this.clearLineMeasures());;){var d=void 0;if(d=i.lastChild instanceof Y?i.lastChild.previousWidget:i.lastChild,t){var c=this.getFootNoteWidgetsOf(d);this.moveFootNotesToPage(c,i,l)}if(e===d)break;if(i.childWidgets.splice(i.childWidgets.indexOf(d),1),l.childWidgets.splice(0,0,d),d instanceof k&&-1!==i.floatingElements.indexOf(d)&&i.floatingElements.splice(i.floatingElements.indexOf(d),1),d instanceof I&&d.floatingElements.length>0)for(var u=0;u<d.floatingElements.length;u++)-1!==i.floatingElements.indexOf(d.floatingElements[u])&&"Inline"!==d.floatingElements[u].textWrappingStyle&&(i.floatingElements.splice(i.floatingElements.indexOf(d.floatingElements[u]),1),l.floatingElements.push(d.floatingElements[u]));d.containerWidget=l,l.height+=d.height}return l},s.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},s.prototype.reLayoutLine=function(e,t,i,n){var r;this.isFootnoteContentChanged=!1,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(e);var o=(r=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t]).previousLine;(0,a.le)(o)&&(o=r),o.paragraph.splitTextRangeByScriptType(o.indexInOwner),o.paragraph.splitLtrAndRtlText(o.indexInOwner),o.paragraph.combineconsecutiveRTL(o.indexInOwner);var l=e.containerWidget;if(l.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||l instanceof be?l instanceof be?this.viewer.updateClientAreaForTextBoxShape(l.containerShape,!0):this.viewer.updateClientArea(l.sectionFormat,l.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),l.page)),this.viewer.updateClientAreaForBlock(e,!0),!(0,a.le)(e.containerWidget)&&!(0,a.le)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof Y)return this.viewer.cutFromTop(e.bodyWidget.containerWidget.y),this.documentHelper.owner.editor.isFootNoteInsert=!0,void this.layoutfootNote(e.containerWidget.containerWidget);if(o.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(o),this.layoutListItems(o.paragraph),o.isFirstLine()&&!(0,a.le)(e.paragraphFormat)){var d=-w.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(d)}do{e=(o=this.layoutLine(o,0)).paragraph,o=o.nextLine}while(o);this.updateWidgetToPage(this.viewer,e),this.viewer.updateClientAreaForBlock(e,!1)}this.layoutNextItemsBlock(e,this.viewer);var c=e.getSplitWidgets()[0].previousRenderedWidget;if(!(0,a.le)(c)&&(!(c instanceof I)||c instanceof I&&!c.isEndsWithPageBreak)&&(this.viewer.cutFromTop(e.y+e.height),e.containerWidget!==c.containerWidget&&!(0,a.le)(c.containerWidget))){var u=e.containerWidget,p=c.containerWidget,f=this.getFootNoteWidgetsOf(e);(0,a.le)(p.page.footnoteWidget)||this.moveFootNotesToPage(f,p,u)}var m,v=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0];if(this.isFootnoteContentChanged&&!(0,a.le)(e.bodyWidget.page.footnoteWidget)&&this.layoutfootNote(m=e.bodyWidget.page.footnoteWidget),this.isEndnoteContentChanged&&!(0,a.le)(v.page.endnoteWidget)){m=v.page.endnoteWidget;var y=this.viewer.clientArea.clone(),b=this.viewer.clientActiveArea.clone();this.viewer.cutFromTop(v.childWidgets[v.childWidgets.length-1].y+v.childWidgets[v.childWidgets.length-1].height),this.layoutfootNote(m),this.viewer.clientArea=y,this.viewer.clientActiveArea=b}},s.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof S&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},s.prototype.shiftElementsForRTLLayouting=function(e,t){var i=this.hasTextRangeBidi(e);if(this.isContainsRTLText(e)||t||i){for(var n=[],r=[],o=0;o<e.children.length;o++){var l=e.children[o];if(l instanceof S&&l.height>0&&!l.isPageBreak)r.push((h=l).characterFormat.bidi),n.push("\t"==h.text?z.Tab:h.characterRange),l.isRightToLeft=n[n.length-1]==z.RightToLeft;else if(l instanceof ae||l instanceof O||l instanceof xe||l instanceof He||l instanceof $||l instanceof H){var d=this.isStartMarker(l),c=this.isEndMarker(l);if(d&&o<e.children.length-1){var h,u=this.getNextValidWidget(o+1,e);!(0,a.le)(u)&&u instanceof S&&u.height>0?(r.push((h=u).characterFormat.bidi),n.push("\t"===u.text?z.Tab:h.characterRange)):(r.push(!1),n.push(z.LeftToRight))}else!c&&o>0?(r.push(r[r.length-1]),n.push(n[n.length-1])):(r.push(!1),n.push(z.LeftToRight))}else l instanceof _&&t?(r.push(t),n.push(z.RightToLeft)):(r.push(!1),n.push(z.LeftToRight))}var p=-1,f=void 0;for(o=0;o<n.length;o++)if(o+1<r.length&&r[o]!=r[o+1])-1!=p&&(this.updateCharacterRange(e,o,p,r,n),p=-1),f=null;else{if(o>0&&o!=n.length-1&&n[o]==z.WordSplit&&r[o]&&n[o-1]==z.Number&&r[o-1]&&n[o+1]==z.Number&&r[o+1]&&this.isNumberNonReversingCharacter(e.children[o]))n[o]=z.Number;else if(n[o]==z.RightToLeft||n[o]==z.LeftToRight||n[o]==z.Number&&-1!=p||((0,a.le)(f)||!f)&&r[o])if(-1==p&&n[o]!=z.LeftToRight)p=o;else{if(-1==p){n[o]==z.LeftToRight?f=!0:n[o]==z.RightToLeft&&(f=!1);continue}n[o]==z.LeftToRight&&(this.updateCharacterRange(e,o,p,r,n),p=n[o]==z.RightToLeft||n[o]==z.Number&&-1!=p?o:-1)}n[o]==z.LeftToRight?f=!0:n[o]==z.RightToLeft&&(f=!1)}if(-1!=p&&p<n.length-1&&(this.updateCharacterRange(e,n.length-1,p,r,n),p=-1),n.length!=e.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");var g=this.reorderElements(e,n,r,t);r.length=0,n.length=0,e.children.length>0&&(e.layoutedElements=g)}return t},s.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof S){var t=e;if(!t.characterFormat.hasValueWithParent("localeIdBidi"))return Bn.isNumberNonReversingCharacter(t.text,t.characterFormat.bidi);var i=t.text.charCodeAt(0);if(47==i&&!this.isNumberReverseLangForSlash(t.characterFormat.localeIdBidi)||(35==i||36==i||37==i||43==i||45==i)&&!this.isNumberReverseLangForOthers(t.characterFormat.localeIdBidi)||44==i||46==i||58==i||1548==i)return!0}return!1},s.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},s.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},s.prototype.isStartMarker=function(e){return e instanceof ae?0===e.commentType:e instanceof O?0===e.bookmarkType:e instanceof xe||(e instanceof $?0===e.type:e instanceof H&&0===e.fieldType)},s.prototype.isEndMarker=function(e){return e instanceof ae?1===e.commentType:e instanceof O?1===e.bookmarkType:e instanceof xe||(e instanceof $?1===e.type:e instanceof H&&1===e.fieldType)},s.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var n=t.children[i];if(!(n instanceof ae||n instanceof O||n instanceof xe||n instanceof He||n instanceof $||n instanceof H))return n[i]}return null},s.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof S&&i.characterFormat.bidi)return!0}return!1},s.prototype.isContainsRTLText=function(e){for(var i=e.paragraph.bodyWidget.page.documentHelper.textHelper,n=!1,r=0;r<e.children.length&&!(e.children[r]instanceof S&&(n=e.children[r].characterFormat.bidi||1==e.children[r].characterFormat.bidi||i.isRTLText(e.children[r].text),n));r++);return n},s.prototype.updateCharacterRange=function(e,t,i,n,r){var o=t;if(!n[t]){r[t]===z.LeftToRight&&o--;for(var l=o;l>=i;l--)if(r[l]!=z.WordSplit){o=l;break}}for(l=i;l<=o;l++)if(r[l]==z.WordSplit){r[l]=z.RightToLeft|z.WordSplit;var h=l-1,d=l+1;if(h>=0&&d<r.length&&r[h]==z.RightToLeft&&(r[d]==z.RightToLeft||r[d]==z.Number)&&e.children[l]instanceof S){var c=e.children[l];if("Times New Roman"==c.characterFormat.fontFamilyBidi){var f=c.text.split("").reverse().join("");c.text=f}}}},s.prototype.reorderElements=function(e,t,i,n){for(var r=0,o=-1,l=0,h=0,d=[],c=z.LeftToRight,u=!1,p=0;p<e.children.length;p++){var f=e.children[p],g=f;g.characterRange=t[p];var m=(g.characterRange&z.RightToLeft)==z.RightToLeft||g.characterRange==z.Number,v=i[p];if(t[p]==z.Tab){if(n){o=-1,l=0,c=z.LeftToRight,u=!1,d.splice(r=0,0,f);continue}v&&(v=!1)}p>0&&u!=v&&(n?(r=0,o=-1,l=0):o=d.length-1,h=0),v||m?m||v&&g.characterRange==z.WordSplit&&(c==z.RightToLeft||this.isInsertWordSplitToLeft(t,i,p))?(l++,r=o+1,g.characterRange==z.Number&&(c==z.Number&&(r+=h),h++),d.splice(r,0,f)):(d.splice(r,0,f),r++,l=0):(n?(l>0&&u==v&&(r+=l),d.splice(r,0,f),r++):(d.push(f),r=p+1),l=0,o=n?r-1:d.length-1),g.characterRange!=z.Number&&(h=0),g.characterRange!=z.WordSplit&&(c=g.characterRange),u=v}return d},s.prototype.isInsertWordSplitToLeft=function(e,t,i){for(var n=i+1;n<e.length;n++){if((e[n]&z.RightToLeft)==z.RightToLeft)return!0;if(e[n]==z.LeftToRight)return!t[n]}return!0},s.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i),r=n.y-i.y;if(i.x=n.x,i.y=n.y,i instanceof de)for(var o=0;o<i.textFrame.childWidgets.length;o++){var l=i.textFrame.childWidgets[o];l instanceof I?l.y=l.y+r:l instanceof k&&this.shiftChildLocationForTableWidget(l,r)}}},s.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,n=0,r=0;if(t){var o=w.convertPointToPixel(i.leftMargin),l=w.convertPointToPixel(i.rightMargin),h=w.convertPointToPixel(i.topMargin),d=i.bottomMargin>0?w.convertPointToPixel(i.bottomMargin):48,c=w.convertPointToPixel(i.headerDistance),u=w.convertPointToPixel(i.footerDistance),p=w.convertPointToPixel(i.pageWidth),f=w.convertPointToPixel(i.pageHeight),g=p-(o+l),m=f-h-d;h=t.isInHeaderFooter&&i.topMargin<=0?Math.abs(h)>0?Math.abs(h):w.convertPointToPixel(i.headerDistance)+t.height:h>0?h:48,!t.isInHeaderFooter&&h<this.viewer.clientArea.y&&(h=this.viewer.clientArea.y);var y="InFrontOfText",b=!1,C=e.verticalOrigin,F=e.horizontalOrigin,T=e.horizontalAlignment,x=e.verticalAlignment,P=e.verticalRelativePercent,L=e.height,W=e.width,R=e.verticalPosition,N=e.horizontalPosition,q=void 0;if(e instanceof de&&(q=e.autoShapeType),t.isInsideTable&&e.layoutInCell)b=!0,r=this.getVerticalPosition(e,R,C,y),n=this.getHorizontalPosition(e.width,e,T,F,N,y,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof Se)r="Line"===C?this.documentHelper.selection.getTop(e.line):this.viewer.clientActiveArea.y,n="Character"===F?this.viewer.clientActiveArea.x:"Center"===T?this.viewer.clientArea.width/2-e.width/2:this.viewer.clientArea.x;else{switch(C){case"Page":case"TopMargin":switch(r=R,x){case"Top":r=R;break;case"Center":r="TopMargin"===C?(h-L)/2:(f-L)/2;break;case"Outside":case"Bottom":r="Page"===C&&"Bottom"===x?f-L:"TopMargin"===C?h-L:(t.bodyWidget.page.index+1)%2!=0?f-L-u/2:c/2;break;case"Inside":"Page"===C?r=(t.bodyWidget.page.index+1)%2==0?f-L-u/2:c/2:(t.bodyWidget.page.index+1)%2==0&&(r=(h-L)/2-c);break;case"None":r=Math.abs(P)<=1e3?f*(P/100):R}break;case"Line":switch(r=R,x){case"Inside":case"Top":r=this.viewer.clientActiveArea.y;break;case"Center":r=this.viewer.clientActiveArea.y-L/2;break;case"Outside":case"Bottom":r=this.viewer.clientActiveArea.y-L;break;case"None":r=Math.round(t.y)+R}break;case"BottomMargin":switch(r=R,x){case"Inside":case"Top":r=f-d;break;case"Center":r=f-d+(d-L)/2;break;case"Outside":case"Bottom":r=t.bodyWidget.page.index+1!==0&&"Outside"===x?f-d:f-L;break;case"None":r=f-d+R}break;case"InsideMargin":case"OutsideMargin":switch(r=R,x){case"Inside":r="InsideMargin"===C?"InsideMargin"===C&&t.bodyWidget.page.index+1===0?f-L:0:(t.bodyWidget.page.index+1)%2!=0?f-d:h-L;break;case"Top":r="InsideMargin"===C?(t.bodyWidget.page.index+1)%2==0?f-d:0:(t.bodyWidget.page.index+1)%2!=0?f-d:0;break;case"Center":r="OutsideMargin"===C?(t.bodyWidget.page.index+1)%2!=0?f-d+(d-L)/2:(h-L)/2:(t.bodyWidget.page.index+1)%2==0?f-d+(d-L)/2:(h-L)/2;break;case"Outside":r="InsideMargin"===C?(t.bodyWidget.page.index+1)%2==0?f-d:h-L:(t.bodyWidget.page.index+1)%2!=0?h-L:f-d;break;case"Bottom":r="OutsideMargin"===C?t.bodyWidget.page.index+1!==0?f-L:h-L:(t.bodyWidget.page.index+1)%2==0?f-L:h-L}break;case"Paragraph":r=Math.round(t.y)+0+R;break;case"Margin":switch(r=t.isInHeaderFooter&&c>h?c+t.height+R:h+R,x){case"Top":r=h;break;case"Center":r=h+(m-L)/2;break;case"Outside":case"Bottom":r=(t.bodyWidget.page.index+1)%2!=0?h+m-L:h;break;case"Inside":r=(t.bodyWidget.page.index+1)%2==0?h+m-L:h}break;default:r=this.viewer.clientArea.y-R}switch(F){case"Page":switch(n=N,T){case"Center":n=b?(t.associatedCell.cellFormat.cellWidth-W)/2:(p-W)/2;break;case"Left":n=0;break;case"Outside":case"Right":n=b?t.associatedCell.cellFormat.cellWidth-W:p-W;break;case"None":n=b?t.associatedCell.x+N:N}n<0&&b&&(n=t.associatedCell.x);break;case"Column":var X=!1;switch(this.viewer.clientActiveArea.x<t.x||e.paragraph.isInsideTable||"StraightConnector"!==q&&"Rectangle"!==q?n=t.x+N:(X=!0,n=N+w.convertPointToPixel(i.leftMargin)),t.paragraphFormat.leftIndent&&!X&&(n-=w.convertPointToPixel(t.leftIndent)),T){case"Center":n=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-W)/2;break;case"Left":n=this.viewer.clientActiveArea.x;break;case"Right":n=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-W}break;case"Margin":if(t.bodyWidget)switch(n=o+N,T){case"Center":n=o+(g-W)/2;break;case"Left":n=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(n=o+g-W);break;case"Right":n=o+g-W;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(n=o+g-W)}else n=this.viewer.clientArea.x+N;break;case"Character":n="Right"===T||"Center"===T?this.getLeftMarginHorizPosition(o,T,N,W,y):this.viewer.clientArea.x+N;break;case"LeftMargin":n=this.getLeftMarginHorizPosition(o,T,N,W,y);break;case"RightMargin":n=this.getRightMarginHorizPosition(p,l,T,N,W,y);break;case"InsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(p,l,T,N,W,y):this.getLeftMarginHorizPosition(o,T,N,W,y);break;case"OutsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,T,N,W,y):this.getRightMarginHorizPosition(p,l,T,N,W,y);break;default:n=this.viewer.clientArea.x+N}}t&&("Paragraph"===C||"Line"===C)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&"Word2013"===this.documentHelper.compatibilityMode&&(t.isInHeaderFooter||(r+e.height>this.viewer.clientArea.bottom&&(r=this.viewer.clientArea.bottom-e.height),r<i.topMargin&&(r=i.topMargin)))}return new ce(n,r)},s.prototype.getLeftMarginHorizPosition=function(e,t,i,n,r){var o=i;switch(t){case"Center":o=(e-n)/2;break;case"Left":o=0;break;case"Right":o=e-n}return o<0&&"InFrontOfText"!==r&&"Behind"!==r&&(o=0),o},s.prototype.getRightMarginHorizPosition=function(e,t,i,n,r,o){var l=e-t,h=l+n;switch(i){case"Center":h=l+(t-r)/2;break;case"Left":h=l;break;case"Right":h=e-r}return(h<0||h+r>e)&&"InFrontOfText"!==o&&"Behind"!==o&&(h=e-r),h},s.prototype.getVerticalPosition=function(e,t,i,n){var r=e.line.paragraph,o=0,l=r.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":o=l+t;break;case"Line":case"Paragraph":o=r.y+t+0;break;default:o=this.viewer.clientActiveArea.y+t}return o},s.prototype.getHorizontalPosition=function(e,t,i,n,r,o,l){var h=0,c=t.line.paragraph.associatedCell,u=l-c.leftMargin-c.rightMargin,p=c.cellFormat.cellWidth,f=c.x,g=f-c.leftMargin;switch(n){case"Page":switch(h=r,i){case"Center":h=g+(u-e)/2;break;case"Left":h=g;break;case"Right":h=g+(u-e);break;case"None":h=g+r}break;case"Column":case"Margin":switch(i){case"Center":h=f+(p-e)/2;break;case"Left":h=f;break;case"Right":h=f+(p-e);break;case"None":h=f+r}break;default:h=f+r}return h},s.prototype.updateTableFloatPoints=function(e){if(e.wrapTextAround){var t=e.getTableCellWidth(),i=e.positioning,n=e.bodyWidget.sectionFormat;if(this.documentHelper.viewer instanceof Se)("Margin"===i.horizontalOrigin||"Page"===i.horizontalOrigin||"Column"===i.horizontalOrigin)&&(this.viewer.clientActiveArea.x="Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientArea.width-t:this.viewer.clientArea.x);else if(e.containerWidget instanceof be||e.isInsideTable){if(e.isInsideTable){var r=e.containerWidget,o=r.cellFormat;"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=r.y,this.viewer.clientActiveArea.y+=w.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y+=w.convertPointToPixel(i.verticalPosition),(this.viewer.clientActiveArea.y<r.y||"Top"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=r.y)):this.viewer.clientActiveArea.y+w.convertPointToPixel(i.verticalPosition)<r.y?this.viewer.clientActiveArea.y=r.y:this.viewer.clientActiveArea.y+=w.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x:("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-t):("Margin"===i.horizontalOrigin||"Column"===i.horizontalOrigin)&&("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x+r.leftMargin:("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-(t+r.rightMargin))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=r.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=r.leftMargin),this.viewer.clientActiveArea.x+=w.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=o.preferredWidth/2-t/2)}}else"Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:((0,a.le)(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=w.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?this.viewer.clientActiveArea.y="Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?w.convertPointToPixel(n.topMargin):0==Math.round(i.verticalPosition)||(0,a.le)(n.topMargin)?w.convertPointToPixel(i.verticalPosition):w.convertPointToPixel(n.topMargin+i.verticalPosition):"Paragraph"===i.verticalOrigin&&((0,a.le)(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y+=w.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=w.convertPointToPixel(n.pageWidth)-t:"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=(w.convertPointToPixel(n.pageWidth)-t)/2):("Margin"===i.horizontalOrigin||"Column"===i.horizontalOrigin)&&("Left"===i.horizontalAlignment?(this.viewer.clientActiveArea.x=w.convertPointToPixel(n.leftMargin),"Word2013"!==this.documentHelper.compatibilityMode&&!e.isInsideTable&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-w.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=w.convertPointToPixel(n.leftMargin):"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=w.convertPointToPixel(n.pageWidth)-(w.convertPointToPixel(n.rightMargin)+t):"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=w.convertPointToPixel(n.leftMargin)+(w.convertPointToPixel(n.pageWidth-n.rightMargin-n.leftMargin)-t)/2)),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x+=w.convertPointToPixel(i.horizontalPosition))}e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},s.prototype.isTocField=function(e){if(e instanceof H){var t=e.nextNode;if(e instanceof H&&0===e.fieldType&&t instanceof S&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},s.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,n=0;n<t.childWidgets.length;n++)i+=t.childWidgets[n].cellFormat.columnSpan;return i},s.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],o=n.childWidgets[n.childWidgets.length-1].cellFormat.borders.right.lineWidth;t<o&&(t=o)}return t},s.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},s.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var n;return n="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3,w.convertPointToPixel(n)},s.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof j)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var n=e.containerWidget.floatingElements[i];!(n instanceof k)&&n.paragraph.containerWidget instanceof V&&n.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(n),i--)}},s}(),So=function(){function s(e){this.isPrinting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.documentHelper=e}return Object.defineProperty(s.prototype,"pageCanvas",{get:function(){return this.isPrinting?((0,a.le)(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):(0,a.le)(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionCanvas",{get:function(){return(0,a.le)(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.renderWidgets=function(e,t,i,n,r){if(!(0,a.le)(this.pageCanvas)&&!(0,a.le)(e)){if(this.pageContext.fillStyle=w.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof Se){var o=i;0===e.index&&(o=i-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,o,n+this.viewer.padding.left,(r=r>this.documentHelper.visibleBounds.height?r:this.documentHelper.visibleBounds.height)+this.viewer.padding.top)}else this.pageContext.fillRect(t,i,n,r);this.pageContext.closePath(),this.viewer instanceof ye&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,i,n,r)),this.pageLeft=t,this.pageTop=i,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,i,n,r),this.pageContext.clip()),this.height=r,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,n,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,n,!1);for(var l=0;l<e.bodyWidgets.length;l++)this.render(e,e.bodyWidgets[l]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,n);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,n),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},s.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,n=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);(this.pageCanvas.width!==t*n||this.pageCanvas.height!==i*n)&&(this.pageCanvas.height=i*n,this.pageCanvas.width=t*n,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(n,n)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},s.prototype.renderHFWidgets=function(e,t,i,n){this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var r=!1,o=0,l=0,h=e.boundingRectangle.height/100*40;if(n){var d=w.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin);Math.max(t.y+t.height,d)>h&&(r=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(h)),this.pageContext.clip())}else{var p,u=w.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance);p=(0,a.le)(e.footerWidget.sectionFormat)?e.boundingRectangle.height-Math.max(e.footerWidget.height+u,w.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)):e.boundingRectangle.height-Math.max(e.footerWidget.height+u,w.convertPointToPixel(e.footerWidget.sectionFormat.bottomMargin)),o=Math.max(e.boundingRectangle.height-h,p),l=e.boundingRectangle.height-u}this.renderFloatingItems(e,t.floatingElements,"Behind");for(var f=0;f<t.childWidgets.length;f++){var g=t.childWidgets[f];n||(o+=g.height),(n||!n&&this.getScaledValue(Math.round(o))<=this.getScaledValue(Math.round(l)))&&this.renderWidget(e,g)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),r&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.65:1)},s.prototype.renderHeaderSeparator=function(e,t,i,n){var r=w.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),o=this.getScaledValue(Math.max(n.y+n.height,r)),l=this.getScaledValue(e.boundingRectangle.width),h=this.pageContext;h.save(),h.globalAlpha=.65;var d=this.getScaledValue(e.boundingRectangle.height)/100*40;o=Math.min(o,d),this.renderDashLine(h,t,i+o,l,"#000000",!1);var c=this.getHeaderFooterType(e,!0);h.font="9pt Arial";var u=h.measureText(c).width;if(this.renderHeaderFooterMark(h,t+5,i+o,u+10,20),this.renderHeaderFooterMarkText(h,c,t+10,o+i+15),e.footerWidget){var p=w.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),f=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidget.height+p,w.convertPointToPixel(e.footerWidget.sectionFormat.bottomMargin)));f=Math.max(this.getScaledValue(e.boundingRectangle.height)-d,f),this.renderDashLine(h,t,i+f,l,"#000000",!1),c=this.getHeaderFooterType(e,!1),u=h.measureText(c).width,this.renderHeaderFooterMark(h,t+5,i+f-20,u+10,20),this.renderHeaderFooterMarkText(h,c,t+10,i+f-5),h.restore()}},s.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=w.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),n=e.boundingRectangle.height-Math.max(e.footerWidget.height+i,w.convertPointToPixel(e.footerWidget.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,n)},s.prototype.getHeaderFooterType=function(e,t){var i,n=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);return n.setLocale(this.documentHelper.owner.locale),i=n.getConstant(t?"Header":"Footer"),e.bodyWidgets[0].sectionFormat.differentFirstPage&&((0,a.le)(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?i=n.getConstant(t?"First Page Header":"First Page Footer"):e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(e)+1)%2==0?n.getConstant(t?"Even Page Header":"Even Page Footer"):n.getConstant(t?"Odd Page Header":"Odd Page Footer")),i},s.prototype.renderDashLine=function(e,t,i,n,r,o){e.beginPath(),e.strokeStyle=r,e.lineWidth=1,e.setLineDash(o?[3,2]:[6,4]),e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.setLineDash([]),e.closePath()},s.prototype.renderSolidLine=function(e,t,i,n,r){e.beginPath(),e.strokeStyle=r,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.closePath()},s.prototype.renderHeaderFooterMark=function(e,t,i,n,r){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,n,r),e.strokeStyle="black",e.strokeRect(t,i,n,r),e.closePath()},s.prototype.renderHeaderFooterMarkText=function(e,t,i,n){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,n),e.closePath()},s.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1),this.renderFloatingItems(e,e.bodyWidgets[0].floatingElements,"Behind");for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];0===i&&t.childWidgets[0]instanceof k&&t.childWidgets[0].childWidgets.length>0&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,n,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,n)}this.renderFloatingItems(e,e.bodyWidgets[0].floatingElements,"InFrontOfText")},s.prototype.renderFloatingItems=function(e,t,i){if(!(0,a.le)(t)&&t.length>0){t.sort(function(h,d){return h instanceof k||d instanceof k?0:h.zOrderPosition-d.zOrderPosition});for(var n=0;n<t.length;n++)if(!(t[n]instanceof k)){var r=t[n];if(!("Behind"===i&&"Behind"!==r.textWrappingStyle||"Behind"!==i&&"Behind"===r.textWrappingStyle))if(r instanceof ee)this.renderImageElementBox(r,r.x,r.y,0);else if(r instanceof de){var o=this.getScaledValue(r.x,1),l=this.getScaledValue(r.y,2);this.renderShapeElementBox(r,o,l,e)}}}},s.prototype.renderShapeElementBox=function(e,t,i,n){var r=0===e.height,o=e.autoShapeType,l=e.textFrame.childWidgets;this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&(this.pageContext.fillStyle=e.fillFormat.color,this.pageContext.fillRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height))),(0,a.le)(o)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=w.getColor(e.lineFormat.color),this.pageContext.strokeRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height))),this.pageContext.closePath();var h=!1;0!=e.width&&0!=e.height&&(h=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var d=0;d<l.length;d++)this.renderWidget(n,l[d]),r&&"StraightConnector"!==o&&(e.height+=l[d].height);r&&(r=!1),h&&this.pageContext.restore()},s.prototype.renderWidget=function(e,t){this.documentHelper.owner.enableLockAndEdit&&this.renderLockRegionBorder(e,t),t instanceof I?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},s.prototype.renderLockRegionBorder=function(e,t){if(!t.isInsideTable&&t instanceof Ve&&t.locked){var i=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,n=e.bodyWidgets[0].sectionFormat,r=w.convertPointToPixel(n.leftMargin)-5,o=n.pageWidth-n.leftMargin-n.rightMargin;o=w.convertPointToPixel(o)+10,this.viewer instanceof Se&&(r=t.x-5,o=(this.documentHelper.visibleBounds.width-5*this.viewer.padding.right)/this.documentHelper.zoomFactor);var l=t.previousRenderedWidget,h=t.nextRenderedWidget,d=t.lockedBy===this.documentHelper.owner.currentUser?i.editableRegionColor:i.lockedRegionColor,c=t.y,u=t.y+t.height;this.renderSingleBorder(d,r,c,r,u,1,"Single"),((0,a.le)(l)||!l.locked||t.lockedBy!==l.lockedBy)&&this.renderSingleBorder(d,r,c,r+o,c,1,"Single"),this.renderSingleBorder(d,r+o,c,r+o,u,1,"Single"),((0,a.le)(h)||!h.locked||t.lockedBy!==h.lockedBy)&&this.renderSingleBorder(d,r,u,r+o,u,1,"Single")}},s.prototype.renderHeader=function(e,t,i){if(!(0,a.le)(i)){e.viewer.updateClientArea(e.bodyWidgets[0].sectionFormat,e);for(var n=e.viewer.clientArea.y,r=i.ownerTable.getSplitWidgets()[0],o=0;o<=i.rowIndex;o++){if(0===r.childWidgets.length)return;var l=r.childWidgets[o];if(-1===t.childWidgets.indexOf(l)){var h=l.clone();h.containerWidget=l.containerWidget,e.viewer.updateClientAreaLocation(h,new re(e.viewer.clientArea.x,n,h.width,h.height)),e.documentHelper.layout.updateChildLocationForRow(n,h);for(var c=0;c<h.childWidgets.length;c++)this.renderTableCellWidget(e,h.childWidgets[c]);n+=h.height}}t.y!==n&&e.documentHelper.layout.updateChildLocationForTable(n,t)}},s.prototype.renderParagraphWidget=function(e,t){var i=t.y,n=t.x;this.renderParagraphBorder(e,t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];this.renderLine(o,e,n,i+=o.marginTop),i+=o.height}},s.prototype.renderParagraphBorder=function(e,t){var i=t.paragraphFormat.borders.left,n=t.paragraphFormat.borders.top,r=t.paragraphFormat.borders.right,o=t.paragraphFormat.borders.bottom,l=0,h=0,d=0,c=0,u=0,p=t.firstChild,f=t.lastChild,g=this.documentHelper.canRenderBorder(t);"None"!==i.lineStyle&&(d=l=this.documentHelper.getParagraphLeftPosition(t)-w.convertPointToPixel(i.space),c=h+t.height,c="None"!==n.lineStyle&&p.isFirstLine()&&!g.skipTopBorder?(h=t.y+this.getTopMargin(t)-w.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-w.convertPointToPixel(n.lineWidth+n.space)):(h=t.y)+t.height,"None"!==o.lineStyle&&f.isLastLine()&&!g.skipBottomBorder&&(c=c+w.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),u=w.convertPointToPixel(i.lineWidth),this.renderSingleBorder(i.color,l,h,d,c,u,i.lineStyle)),"None"!==n.lineStyle&&p.isFirstLine()&&!g.skipTopBorder&&(d=(l=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),c=h=t.y+this.getTopMargin(t)-w.convertPointToPixel(n.lineWidth+n.space),"None"!==i.lineStyle&&(l-=w.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(d+=w.convertPointToPixel(r.space)),u=w.convertPointToPixel(n.lineWidth),this.renderSingleBorder(n.color,l,h,d,c,u,n.lineStyle)),"None"!==r.lineStyle&&(d=l=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+w.convertPointToPixel(r.space),c=(h=c)+t.height,c="None"!==n.lineStyle&&p.isFirstLine()&&!g.skipTopBorder?(h=t.y+this.getTopMargin(t)-w.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-w.convertPointToPixel(n.lineWidth+n.space)):(h=t.y)+t.height,"None"!==o.lineStyle&&f.isLastLine()&&!g.skipBottomBorder&&(c=c+w.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),u=w.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,l,h,d,c,u,r.lineStyle)),"None"!==o.lineStyle&&f.isLastLine()&&!g.skipBottomBorder&&(d=(l=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),c=h=t.y+t.height+w.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t),"None"!==i.lineStyle&&(l-=w.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(d+=w.convertPointToPixel(r.space)),u=w.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,l,h,d,c,u,o.lineStyle))},s.prototype.getContainerWidth=function(e,t){var i=0;if(e.paragraphFormat.firstLineIndent<0&&(i=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable){var n=e.associatedCell;return n.width+n.margin.left+n.margin.right-n.leftBorderWidth}if(this.viewer instanceof Se){var r=w.convertPointToPixel(e.leftIndent+e.rightIndent);return(this.documentHelper.visibleBounds.width-r-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor}var o=t.bodyWidgets[0].sectionFormat;return w.convertPointToPixel(o.pageWidth-o.leftMargin-o.rightMargin+i-(e.rightIndent+e.leftIndent))},s.prototype.getTopMargin=function(e){return e.isEmpty()?e.childWidgets[0].margin.top:e.childWidgets[0].children[0].margin.top},s.prototype.getBottomMargin=function(e){if(e.isEmpty())return e.childWidgets[e.childWidgets.length-1].margin.bottom;var t=e.childWidgets[e.childWidgets.length-1],i=0;return t.children.length>0?i=t.children[t.children.length-1].margin.bottom:(0,a.le)(t.margin)||(i=t.margin.bottom),i},s.prototype.renderfootNoteWidget=function(e,t,i){1===t.page.bodyWidgets.length&&1===t.page.bodyWidgets[0].childWidgets.length&&null!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty();var r=this.getFooterHeight(e),o=t.y+t.height;o>r&&(o=r-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(i),this.getScaledValue(o)),this.pageContext.clip();for(var l=0;l<t.bodyWidgets.length;l++)for(var h=t.bodyWidgets[l],d=h.footNoteReference,c=0;c<h.childWidgets.length;c++){var u=h.childWidgets[c];0===l&&0===c&&this.renderSolidLine(this.pageContext,this.getScaledValue(96,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000"),0===c&&!(0,a.le)(d)&&u.childWidgets[0].children[0]instanceof S&&!this.documentHelper.owner.editor.isFootNoteInsert&&(u.childWidgets[0].children[0].text=u.childWidgets[0].children[0].text.replace(u.childWidgets[0].children[0].text,d.text)),this.renderWidget(e,u)}this.pageContext.restore()},s.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++)this.renderTableRowWidget(e,t.childWidgets[i]),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t)},s.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)this.renderTableCellWidget(e,t.childWidgets[i])},s.prototype.renderTableCellWidget=function(e,t){var i,n;if(!this.isPrinting&&(i=t.margin.top-t.containerWidget.topBorderWidth,n=t.margin.bottom-t.containerWidget.bottomBorderWidth,this.getScaledValue(t.y,2)+t.height+n*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-i>this.documentHelper.visibleBounds.height))return;this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(t.width+t.margin.left+t.margin.right-t.leftBorderWidth),this.getScaledValue(this.height)),this.renderWidget(e,o),this.pageContext.restore()}},s.prototype.checkHeaderFooterLineWidget=function(e,t){var i;if(e instanceof oe?i=e.paragraph.bodyWidget:e instanceof V&&(i=e.bodyWidget),!(0,a.le)(i.parentHeaderFooter)){i=i.parentHeaderFooter;for(var n=0;n<t.length;n++){var r=t[n];if(r instanceof oe&&e instanceof oe){var o=r.getHierarchicalIndex(""),l=e.getHierarchicalIndex("");if(r.paragraph.isInHeaderFooter&&i===r.paragraph.bodyWidget&&o.substring(o.indexOf(";"))===l.substring(l.indexOf(";")))return r}else if(r instanceof V&&e instanceof V&&(o=r.getHierarchicalIndex(""),l=e.getHierarchicalIndex(""),r.ownerTable.isInHeaderFooter&&i===r.ownerTable.bodyWidget&&o.substring(o.indexOf(";"))===l.substring(l.indexOf(";"))))return r}}},s.prototype.renderEditRegionHighlight=function(e,t,i){if(e.documentHelper.selection&&!(0,a.le)(e.documentHelper.selection.editRegionHighlighters)){var n=e.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!n&&t.paragraph.isInHeaderFooter&&(t=this.checkHeaderFooterLineWidget(t,e.documentHelper.selection.editRegionHighlighters.keys),(0,a.le)(t)||(n=!0)),n)for(var o=e.documentHelper.selection.editRegionHighlighters.get(t),l=0;l<o.length;l++)this.pageContext.fillStyle=""!==o[l].color?o[l].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(o[l].left,1),this.getScaledValue(i,2),this.getScaledValue(o[l].width),this.getScaledValue(t.height))}},s.prototype.renderSearchHighlight=function(e,t,i){if(this.documentHelper.owner.searchModule&&!(0,a.le)(e.documentHelper.owner.searchModule.searchHighlighters)){var n=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(!n&&t.paragraph.isInHeaderFooter&&(t=this.checkHeaderFooterLineWidget(t,e.documentHelper.owner.searchModule.searchHighlighters.keys),(0,a.le)(t)||(n=!0)),n)for(var o=e.documentHelper.owner.searchModule.searchHighlighters.get(t),l=0;l<o.length;l++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(o[l].left,1),this.getScaledValue(i,2),this.getScaledValue(o[l].width),this.getScaledValue(t.height))}},s.prototype.renderSelectionHighlight=function(e,t,i){if(!this.isPrinting&&e.documentHelper.owner.selection&&!this.documentHelper.isScrollToSpellCheck&&e.documentHelper.owner.selection.selectedWidgets.length>0){var n=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);!n&&t.paragraph.isInHeaderFooter&&(t=this.checkHeaderFooterLineWidget(t,e.documentHelper.owner.selection.selectedWidgets.keys),(0,a.le)(t)||(n=!0)),n&&e.documentHelper.owner.selection.addSelectionHighlight(this.selectionContext,t,i,e)}},s.prototype.renderSelectionHighlightOnTable=function(e,t){if(!this.isPrinting&&e.documentHelper.owner.selection&&e.documentHelper.owner.selection.selectedWidgets.length>0){var i=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);!i&&t.ownerTable.isInHeaderFooter&&(t=this.checkHeaderFooterLineWidget(t,e.documentHelper.owner.selection.selectedWidgets.keys),(0,a.le)(t)||(i=!0)),i&&e.documentHelper.owner.selection.addSelectionHighlightTable(this.selectionContext,t,e)}},s.prototype.renderLine=function(e,t,i,n){this.renderSelectionHighlight(t,e,n);var r=e.paragraph.paragraphFormat,o=i;if(e.isFirstLine()&&!r.bidi&&(i+=w.convertPointToPixel(r.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!(0,a.le)(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var l=t.documentHelper.selection.formFieldHighlighters.get(e),h=0;h<l.length;h++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var d=e.height,c=!1;if(e.isLastLine()&&(d-=w.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),e.paragraph.paragraphFormat.lineSpacing>1)){var p=this.getFormfieldInLine(e);if(!(0,a.le)(p)){var f=this.documentHelper.textHelper.getHeight(p.characterFormat);"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?d-=w.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,f.Height,!0)):(n+=w.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),d=f.Height,c=!0)}}this.pageContext.fillRect(this.getScaledValue(l[h].left,1),this.getScaledValue(n,2),this.getScaledValue(l[h].width),this.getScaledValue(d)),c&&(c=!1,n-=w.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(t,e,n),this.renderEditRegionHighlight(t,e,n);var m=!1,v=e.renderedElements,y=this.getUnderlineYPosition(e);for(h=0;h<v.length;h++){var b=v[h];if(!(b instanceof Pe&&"Inline"!==b.textWrappingStyle)){if(b instanceof ae||b instanceof xe){var C=0;this.viewer instanceof ye&&(C=this.viewer.pageGap);var F="display:block;position:absolute;",T=this.getScaledValue(n-10+(t.boundingRectangle.y-C*(t.index+1)))+C*(t.index+1)+"px;";if(b instanceof xe)if(this.documentHelper.owner.enableLockAndEdit){(x=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),b.renderLockMark(this.documentHelper.owner.currentUser,x);var P=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings;F+="color:"+(E=b.user===this.documentHelper.owner.currentUser?P.editableRegionColor:P.lockedRegionColor)+";";var L=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.leftMargin),W=t.boundingRectangle.x+this.getScaledValue(L-20)+"px;";this.viewer instanceof Se&&(W=e.paragraph.x-5+"px;"),b.editRangeMark.setAttribute("style",F=F+"left:"+W+"top:"+T)}else b.editRangeMark&&b.editRangeMark.setAttribute("style","display:none");else if(b instanceof ae&&0===b.commentType&&this.documentHelper.owner.selectionModule)if(this.documentHelper.owner.enableComment&&!m){m=!0,b.renderCommentMark();var R=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.rightMargin),N=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageWidth);W=t.boundingRectangle.x+this.getScaledValue(N-R+R/4)+"px;",this.viewer instanceof Se&&(W=t.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;"),b.commentMark.setAttribute("style",F=F+"left:"+W+"top:"+T)}else b.commentMark&&b.commentMark.setAttribute("style","display:none")}if(b instanceof H||this.isFieldCode||0===b.width&&0===b.height){this.isFieldCode&&(b.width=0),i+=b.width+b.margin.left,this.toSkipFieldCode(b);continue}if(!this.isPrinting&&(this.getScaledValue(n+b.margin.top,2)+b.height*this.documentHelper.zoomFactor<0||this.getScaledValue(n+b.margin.top,2)>this.documentHelper.visibleBounds.height)){i+=b.width+b.margin.left,b instanceof S&&(b.canTrigger=!0,b.isVisible=!1,(!b.isSpellChecked||b.line.paragraph.isChangeDetected)&&(b.ischangeDetected=!0));continue}if(b instanceof _)this.renderListTextElementBox(b,i,n,y);else if(b instanceof ee)this.renderImageElementBox(b,i+=b.padding.left,n,y);else if(b instanceof de){var B=this.getScaledValue(i,1),q=this.getScaledValue(n,2);this.renderShapeElementBox(b,B,q,t)}else b.isVisible=!0,this.renderTextElementBox(b,i+=b.padding.left,n,y);i+=b.width+b.margin.left,e.paragraph.bidi?o+=b.margin.left:o=i}}if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var x,A="",X=e.paragraph.characterFormat,le=0,K=this.retriveCharacterformat(X);if((x=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),this.pageContext.fillStyle=w.getColor(X.fontColor),0!=v.length||e.isEndsWithLineBreak||(0,a.le)(e.paragraph)?le=1===e.paragraph.childWidgets.length?n+e.maxBaseLine+this.documentHelper.layout.getBeforeSpacing(e.paragraph):n+e.maxBaseLine:(le=e.paragraph.y+this.documentHelper.textHelper.getHeight(X).BaselineOffset,!e.isEndsWithLineBreak&&e.indexInOwner>0&&0==v.length&&(le=n+e.previousLine.maxBaseLine)),X.revisions.length>0){var E=this.documentHelper.authors.get(X.revisions[0].author);this.pageContext.fillStyle=w.getColor(E)}if(e.isEndsWithPageBreak){K=this.retriveCharacterformat(X,.7),A=e.paragraph.bidi?String.fromCharCode(182)+"....."+x.getConstant("Page Break")+".....":"....."+x.getConstant("Page Break")+"....."+String.fromCharCode(182);var he=this.documentHelper.textHelper.getWidth(A,X);this.viewer instanceof ye?e.paragraph.bidi?o<he+this.viewer.clientActiveArea.x&&(A="....."):o>this.viewer.clientActiveArea.width&&(A="....."):e.paragraph.bidi?o-he<this.viewer.clientActiveArea.x&&(A="....."):o+he>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(A=".....")}else e.isEndsWithLineBreak?A=String.fromCharCode(e.paragraph.bidi?8627:8629):e.paragraph.isInsideTable&&(0,a.le)(e.nextLine)&&(0,a.le)(e.paragraph.nextWidget)?0!=e.height&&(A=String.fromCharCode(164)):(0,a.le)(e.nextLine)&&(A=String.fromCharCode(182));e.paragraph.containerWidget instanceof j&&!(0,a.le)(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()&&(A=":::::"+x.getConstant("Section Break Next Page")+":::::",K=this.retriveCharacterformat(X,.7),e.isEndsWithPageBreak&&(A=e.paragraph.bidi?A+String.fromCharCode(182)+"....."+x.getConstant("Page Break")+".....":"....."+x.getConstant("Page Break")+"....."+String.fromCharCode(182)+A),he=this.documentHelper.textHelper.getWidth(A,X),this.viewer instanceof ye?e.paragraph.bidi?o<he+this.viewer.clientActiveArea.x&&(A=":::::",e.isEndsWithPageBreak&&(A=":::::.....")):o+he-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(A=":::::",e.isEndsWithPageBreak&&(A=".....:::::")):e.paragraph.bidi?o-he<this.viewer.clientActiveArea.x&&(A=":::::",e.isEndsWithPageBreak&&(A=":::::.....")):o+he-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(A=":::::",e.isEndsWithPageBreak&&(A=".....:::::"))),A.length>0&&(e.paragraph.bidi&&(o-=this.documentHelper.textHelper.getWidth(A,X)),this.pageContext.font=K,this.pageContext.fillText(A,this.getScaledValue(o,1),this.getScaledValue(le,2)))}},s.prototype.retriveCharacterformat=function(e,t){return(0,a.le)(t)&&(t=1),this.pageContext.textBaseline="alphabetic",(e.bold?"bold":"")+" "+(e.italic?"italic":"")+" "+(0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5))*this.documentHelper.zoomFactor*t+'pt "'+e.fontFamily+'"'},s.prototype.toSkipFieldCode=function(e){e instanceof H&&(0===e.fieldType?(!(0,a.le)(e.fieldEnd)||e.hasFieldEnd)&&(this.isFieldCode=!0):(2===e.fieldType||1===e.fieldType)&&(this.isFieldCode=!1))},s.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,n=0;n<e.children.length;n++)e.children[n]instanceof H||0===e.children[n].width&&0===e.children[n].height||e.children[n]instanceof de||t<e.children[n].height+e.children[n].margin.top&&(t=e.children[n].margin.top+e.children[n].height,i=e.children[n]instanceof ee?.9:e.children[n].height/20);return t-2*i},s.prototype.renderListTextElementBox=function(e,t,i,n){var r=e.margin.top,o=e.margin.left,l=e.listLevel.characterFormat,h=e.line.paragraph.characterFormat,d=l.hasValue("fontColor")?l.fontColor:h.fontColor;this.pageContext.textBaseline="alphabetic";var c,u,p=l.hasValue("fontFamily")?l.fontFamily:h.fontFamily;this.documentHelper.isIosDevice&&(e.text===String.fromCharCode(9679)||e.text===String.fromCharCode(9675))&&(p="");var f=l.hasValue("fontSize")?l.fontSize:h.fontSize,g=l.hasValue("baselineAlignment")?l.baselineAlignment:h.baselineAlignment;c=l.hasValue("bold")?l.bold?"bold":"":h.bold?"bold":"",u=l.hasValue("italic")?l.italic?"italic":"":h.italic?"italic":"",f=0===f?.5:f/("Normal"===g?1:1.5),f=this.isPrinting?f:f*this.documentHelper.zoomFactor;var m=l.hasValue("strikethrough")?l.strikethrough:h.strikethrough,v=l.hasValue("highlightColor")?l.highlightColor:h.highlightColor;"NoColor"!==v&&(this.pageContext.fillStyle="#"!==v.substring(0,1)?w.getHighlightColorCode(v):w.getColor(v),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+o,1)-1),Math.floor(this.getScaledValue(i+r,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=c+" "+u+" "+f+'pt "'+p+'"',"Subscript"===g&&(r+=e.height-e.height/1.5);var y=e.baselineOffset;r="Normal"===l.baselineAlignment?r+y:r+y/1.5;var b=e.text,C=e.paragraph.paragraphFormat.bidi;if(C&&(this.pageContext.direction="rtl",t+=e.width),"empty"===d||"#00000000"===d){var F=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(F)}else this.pageContext.fillStyle=w.getColor(d);this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof _&&"\t"===e.text&&this.tabMark(e,l,t,i,o,r),this.pageContext.fillText(this.replaceSpace(b),this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width))):this.pageContext.fillText(b,this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width)),C&&(this.pageContext.direction="ltr",t-=e.width),"None"!==l.underline&&!(0,a.le)(l.underline)&&this.renderUnderline(e,t,i,n,d,l.underline,g),"None"!==m&&this.renderStrikeThrough(e,t,i,l.strikethrough,d,g)},s.prototype.getDefaultFontColor=function(e){return w.isVeryDark(e)?"#FFFFFF":"#000000"},s.prototype.renderTextElementBox=function(e,t,i,n){var r=!1,o=e.line.paragraph.containerWidget;o instanceof V&&(r="Exactly"===o.ownerRow.rowFormat.heightType);var l=e.margin.top,h=e.margin.left;r&&o instanceof V&&this.clipRect(o.x-o.margin.left,o.y,this.getScaledValue(o.width+o.margin.left+o.margin.right-o.leftBorderWidth),this.getScaledValue(o.height));var c=e.characterFormat;"NoColor"!==c.highlightColor&&(this.pageContext.fillStyle="#"!==c.highlightColor.substring(0,1)?w.getHighlightColorCode(c.highlightColor):w.getColor(c.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+h,1)-1),Math.floor(this.getScaledValue(i+l,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1)));var u=this.checkRevisionType(e),p=u.length>0?this.getRevisionColor(u):c.fontColor;this.pageContext.textBaseline="alphabetic";var m=11;m=0===c.fontSize?.5:c.fontSize/("Normal"===c.baselineAlignment?1:1.5),this.pageContext.font=(c.bold?"bold":"")+" "+(c.italic?"italic":"")+" "+(m=this.isPrinting?m:m*this.documentHelper.zoomFactor)+'pt "'+c.fontFamily+'"',"Subscript"===c.baselineAlignment&&(l+=e.height-e.height/1.5);var v=e.baselineOffset;if(l="Normal"===c.baselineAlignment?l+v:l+v/1.5,"empty"===p||"#00000000"===p){var y=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(y)}else this.pageContext.fillStyle=w.getColor(p);var b=this.getScaledValue(e.width),C=e.text;if(e instanceof at){var F=e;""!==F.tabText||(0,a.le)(F.tabLeader)||"None"===F.tabLeader?""!==F.tabText&&(C=F.tabText):(C=this.getTabLeader(e),F.tabText=C)}var T=c.bidi||this.documentHelper.textHelper.isRTLText(e.text);C=this.documentHelper.textHelper.setText(C,T,c.bdo,!0),c.allCaps&&(C=C.toUpperCase());var x=e.characterRange;if((x==z.WordSplit||(x&z.WordSplit)==z.WordSplit&&(x&z.RightToLeft)==z.RightToLeft)&&c.bidi&&(C=this.inverseCharacter(C)),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?((e instanceof at||e instanceof S)&&"\t"===e.text&&this.tabMark(e,c,t,i,h,l),this.pageContext.fillText(this.replaceSpace(C),this.getScaledValue(t+h,1),this.getScaledValue(i+l,2),b)):this.pageContext.fillText(C,this.getScaledValue(t+h,1),this.getScaledValue(i+l,2),b),this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||e.canTrigger)&&" "!==e.text&&!this.documentHelper.isScrollHandler&&((0,a.le)(e.previousNode)||!(e.previousNode instanceof H))&&(!this.documentHelper.selection.isSelectionInsideElement(e)||this.documentHelper.triggerElementsOnLoading||this.documentHelper.owner.editor.triggerPageSpellCheck)){e.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var P=this.spellChecker.checktextElementHasErrors(e.text,e,t);if(P.errorFound&&!this.isPrinting){p="#FF0000";for(var E=o instanceof V?o.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,L=0;L<P.elements.length;L++){var W=P.elements[L];-1===e.ignoreOnceItems.indexOf(this.spellChecker.manageSpecialCharacters(W.text,void 0,!0))&&this.renderWavyLine(W,(0,a.le)(W.start)?t:W.start.location.x,(0,a.le)(W.start)?i:W.start.location.y-e.margin.top,n,p,"Single",c.baselineAlignment,E)}}else(e.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(e.ischangeDetected=!1,this.handleChangeDetectedElements(e,n,t,i,c.baselineAlignment))}var R=this.getRevisionType(u,!0);("None"!==c.underline&&!(0,a.le)(c.underline)||!(0,a.le)(R)&&("Insertion"===R.type||"MoveTo"===R.type))&&this.renderUnderline(e,t,i,n,p,c.underline,c.baselineAlignment,R),R=this.getRevisionType(u,!1),("None"!==c.strikethrough&&!(0,a.le)(c.strikethrough)||!(0,a.le)(R)&&("Deletion"===R.type||"MoveFrom"===R.type))&&this.renderStrikeThrough(e,t,i,c.strikethrough,p,c.baselineAlignment,R),r&&this.pageContext.restore()},s.prototype.tabMark=function(e,t,i,n,r,o){var l=String.fromCharCode(e.paragraph.bidi?8592:8594),h=this.documentHelper.textHelper.getWidth(l,t),d=e.width/2,c=h/2;this.pageContext.font=this.retriveCharacterformat(e.characterFormat),d>h?this.pageContext.fillText(l,this.getScaledValue(i+r+d-c,1),this.getScaledValue(n+o,2)):this.pageContext.fillText(l,this.getScaledValue(i+r,1),this.getScaledValue(n+o,2),this.getScaledValue(e.width))},s.prototype.replaceSpace=function(e){return(e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183))).replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},s.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},s.prototype.getBackgroundColorHeirachy=function(e){var t;if(e.paragraph.isInsideTable){var i=e.paragraph.containerWidget;if("empty"!==(t=i.cellFormat.shading.backgroundColor)&&"#00000000"!==t)return t;if("empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof be&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},s.prototype.handleChangeDetectedElements=function(e,t,i,n,r){var o=this,l=e.text.trim(),h=this.pageIndex;if("\v"!==e.text&&!this.spellChecker.checkElementCanBeCombined(e,t,h,!0)){var d=l.split(/[\s]+/),c=e.line.getOffset(e,0);if(d.length>1)for(var p=0;p<d.length;p++){var f=d[p],g=this.spellChecker.manageSpecialCharacters(f,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(g)&&-1===e.ignoreOnceItems.indexOf(g)&&(this.handleUnorderedElements(g,e,t,p,c,p===d.length-1,h),c+=f.length+1)}else if(g=this.spellChecker.manageSpecialCharacters(l,void 0,!0),l.length>0&&-1===this.spellChecker.ignoreAllItems.indexOf(g)&&-1===e.ignoreOnceItems.indexOf(g)){var m=e.indexInOwner,v=e.line.paragraph.indexInOwner,y=this.spellChecker.checkSpellingInPageInfo(g);if(y.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var b=JSON.parse('{"HasSpellingError":'+y.hasSpellError+"}");this.spellChecker.handleWordByWordSpellCheck(b,e,i,n,t,r,!0)}else if(this.spellChecker.isInUniqueWords(g)){var C=!!this.spellChecker.isErrorWord(g);b=JSON.parse('{"HasSpellingError":'+C+"}"),this.spellChecker.handleWordByWordSpellCheck(b,e,i,n,t,r,!0)}else(!this.documentHelper.owner.editor.triggerPageSpellCheck||this.documentHelper.triggerElementsOnLoading)&&this.spellChecker.callSpellChecker(this.spellChecker.languageID,l,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(T){var x=JSON.parse(T);o.spellChecker.handleWordByWordSpellCheck(x,e,i,n,t,r,(h===o.pageIndex||e.isVisible)&&m===e.indexInOwner&&v===e.line.paragraph.indexInOwner)})}}},s.prototype.handleUnorderedElements=function(e,t,i,n,r,o,l){var h=this,d=t.indexInOwner,c=t.line.paragraph.indexInOwner;if(e.length>0){var u=this.spellChecker.checkSpellingInPageInfo(e);if(u.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var p=JSON.parse('{"HasSpellingError":'+u.hasSpellError+"}");this.spellChecker.handleSplitWordSpellCheck(p,e,t,!0,i,n,r,o)}else{var f=t.isVisible&&d===t.indexInOwner&&c===t.line.paragraph.indexInOwner;if(this.spellChecker.isInUniqueWords(e)){var g=!!this.spellChecker.isErrorWord(e);p=JSON.parse('{"HasSpellingError":'+g+"}"),this.spellChecker.handleSplitWordSpellCheck(p,e,t,f,i,n,r,o)}else(!this.documentHelper.owner.editor.triggerPageSpellCheck||this.documentHelper.triggerElementsOnLoading)&&this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(m){var v=JSON.parse(m);h.spellChecker.handleSplitWordSpellCheck(v,e,t,f,i,n,r,o)})}}},s.prototype.renderWavyLine=function(e,t,i,n,r,o,l,h){if(e.text.length>1){var d=e.height/("Normal"===l?1:1.5),c=e.margin.top,m=0;"Subscript"===l||e instanceof _?(m=d-d/20*2+i,m+=(c+=e.height-d)>0?c:0):m=n+i;var v=this.spellChecker.getSpecialCharactersInfo(e.text,e.characterFormat),y=this.spellChecker.getWhiteSpaceCharacterInfo(e.text,e.characterFormat),C=(t+v.beginningWidth+(y.isBeginning?y.width:0)+e.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,F=m*this.documentHelper.zoomFactor+this.topPosition,T=C+this.getScaledValue(e.width-(v.beginningWidth+v.endWidth)-y.width),x=new ce(C,F),P=new ce(T,F);this.drawWavy(x,P,.5*(T-C),1,.7,r,e.height,h)}},s.prototype.drawWavy=function(e,t,i,n,r,o,l,h,d){this.pageContext.save(),this.pageContext.fillStyle=(0,a.le)(h)?this.documentHelper.backgroundColor:h,this.pageContext.fillRect(e.x,e.y-n,t.x-e.x,3*n),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=o,this.pageContext.beginPath();for(var c=0,u=0,p=e.x,f=e.y,g=t.x,m=t.y,v=0,y=0,b=Math.atan2(m-f,g-p),C=Math.sqrt((p-g)*(p-g)+(f-m)*(f-m)),F=1*n,T=Math.PI*i;v<=C;v+=r)y=Math.sin(v/C*T)*F,c=e.x+Math.cos(b)*v+Math.cos(b-Math.PI/2)*y,u=e.y+Math.sin(b)*v+Math.sin(b-Math.PI/2)*y,v>0?this.pageContext.lineTo(c,u):this.pageContext.moveTo(c,u);this.pageContext.stroke(),this.pageContext.restore()},s.prototype.getTabLeader=function(e){var t,i=this.getTabLeaderString(e.tabLeader),n=i;t=this.documentHelper.textHelper.getWidth(n,e.characterFormat);var r=Math.floor(e.width/t);0==t&&(r=0);for(var o=0;o<=r;o++)n+=i;return n.slice(0,-1)},s.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":t="_"}return t},s.prototype.clipRect=function(e,t,i,n){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,n),this.pageContext.clip()},s.prototype.renderUnderline=function(e,t,i,n,r,o,l,h){var d=e.height/("Normal"===l?1:1.5),c=e.margin.top,u=d/20,p=0,f=d/20;"Subscript"===l||e instanceof _?(p=d-2*u+i,p+=(c+=e.height-d)>0?c:0):p=n+i;var g=0;for((0,a.le)(h)||(o="MoveTo"===h.type?"Double":"Single"),"Double"===o&&(p-=f),e instanceof ee&&(u=.9);g<("Double"===o?2:1);){g++;var m=e.width;e instanceof S&&!(e instanceof at)&&(0,a.le)(e.nextNode)&&(m=this.documentHelper.textHelper.getWidth(w.trimEnd(e.text),e.characterFormat)),this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(p,2),this.getScaledValue(m),this.getScaledValue(u)),p+=2*f}},s.prototype.renderStrikeThrough=function(e,t,i,n,r,o,l){var h=e.height/("Normal"===o?1:1.5),d=e.margin.top;"Subscript"===o&&(d+=e.height-h),i+=d>0?d:0;var c=h/20,u=h/2+.5*c,p=0;for((0,a.le)(l)||(n="Deletion"===l.type?"SingleStrike":"DoubleStrike"),e instanceof ee&&(c=.9),"DoubleStrike"===n&&(u-=c);p<("DoubleStrike"===n?2:1);)p++,this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(u+i,2),this.getScaledValue(e.width),this.getScaledValue(c)),u+=2*c},s.prototype.renderImageElementBox=function(e,t,i,n){var r=e.margin.top,o=e.margin.left,l=this.checkRevisionType(e),h=l.length>0?this.getRevisionColor(l):"black";this.pageContext.textBaseline="top";var c=!1,u=e.line.paragraph.containerWidget,p=!1;if(u instanceof V&&(p="Exactly"===u.ownerRow.rowFormat.heightType),"Inline"===e.textWrappingStyle)if(r<0||e.line.paragraph.width<e.width){if(u instanceof V){var f=0;u.childWidgets[0]instanceof I&&(f=u.childWidgets[0].paragraphFormat.leftIndent),c=!0,this.clipRect(t+o,i+r,this.getScaledValue(u.width+u.margin.left-u.leftBorderWidth-f),this.getScaledValue(u.height))}}else p&&(c=!0,this.clipRect(u.x,u.y,this.getScaledValue(u.width+u.margin.left-u.leftBorderWidth),this.getScaledValue(u.height)));if(e.isMetaFile&&!(0,a.le)(e.metaFileImageString))this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width),this.getScaledValue(e.height));else try{e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width),this.getScaledValue(e.height)):this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}catch(b){e.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC",this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+r,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}this.pageContext.fillStyle=w.getColor(h);var v=this.getRevisionType(l,!1);if(!(0,a.le)(v)&&("Deletion"===v.type||"MoveFrom"===v.type)&&this.renderStrikeThrough(e,t,i,"SingleStrike",h,"Normal",v),v=this.getRevisionType(l,!0),!(0,a.le)(v)&&("Insertion"===v.type||"MoveTo"===v.type)){var y=this.getUnderlineYPosition(e.line);this.renderUnderline(e,t,i,y,h,"Single","Normal")}c&&this.pageContext.restore()},s.prototype.renderTableOutline=function(e){var t=new Mn(this.documentHelper),i=e;e.width=this.documentHelper.layout.getTableWidth(i);var n=i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders),r=0;r=w.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r/2,e.y,e.x-e.margin.left-r/2,e.y+e.height,r,n.lineStyle),n=t.getTableTopBorder(i.tableFormat.borders),r=0,r=w.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y-r/2,e.x+e.width+r+e.margin.right,e.y-r/2,r,n.lineStyle),n=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),r=0,r=w.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x+e.width+e.margin.right+r/2,e.y,e.x+e.width+e.margin.right+r/2,e.y+e.height,r,n.lineStyle),n=t.getTableBottomBorder(i.tableFormat.borders),r=0,r=w.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y+e.height-r/2,e.x+e.width+r+e.margin.right,e.y+e.height-r/2,r,n.lineStyle)},s.prototype.renderTableCellOutline=function(e,t){var h,d,c,i=e.layout,r=t,o=0,l=0,u=t.ownerTable.isBidiTable;t.containerWidget instanceof Q&&(l=t.margin.bottom-t.containerWidget.bottomBorderWidth,o=t.margin.top-t.containerWidget.topBorderWidth),h=t.margin.left-t.leftBorderWidth,d=t.margin.right-t.rightBorderWidth,c=(0,a.le)(r.ownerRow)||"Exactly"!==r.ownerRow.rowFormat.heightType?!(0,a.le)(r.ownerRow)&&[r.ownerRow].length<=1?Math.max(w.convertPointToPixel(r.ownerRow.rowFormat.height),t.height)+o+l:t.height+o+l:w.convertPointToPixel(r.ownerRow.rowFormat.height)+o+l;var p=u?V.getCellRightBorder(r):V.getCellLeftBorder(r),f=0;f=w.convertPointToPixel(p.getLineWidth()),this.renderCellBackground(c,t,h,f);var g=f;if(0===r.index||1===r.cellFormat.rowSpan||r.cellFormat.rowSpan>1&&0===r.columnIndex)this.renderSingleBorder(p.color,t.x-h-f,t.y-t.margin.top,t.x-h-f,t.y+t.height+l,f,p.lineStyle);else for(var m=0;m<r.ownerTable.childWidgets.length;m++){for(var v=r.ownerTable.childWidgets[m],y=void 0,b=0;b<v.childWidgets.length;b++){var C=v.childWidgets[b];if(C.columnIndex+C.cellFormat.columnSpan-1==r.columnIndex-1){y=C;break}if(v.childWidgets[b].columnIndex>=r.columnIndex&&v.childWidgets[b].previousWidget){y=v.childWidgets[b].previousWidget;break}}if(y&&y.columnIndex+y.cellFormat.columnSpan-1==r.columnIndex-1){var F=u?V.getCellLeftBorder(y):V.getCellRightBorder(y),T=F.lineWidth;if(y.y+y.height<r.y)continue;if(y.y<r.y&&y.y+y.height>r.y)this.renderSingleBorder(F.color,r.x-h-T,r.y-o,r.x-h-T,y.y+y.height+y.margin.bottom,T,F.lineStyle);else if(y.y===r.y||y.y>r.y&&y.y+y.height<r.y+r.height)this.renderSingleBorder(F.color,r.x-h-T,y.y-y.margin.top,r.x-h-T,y.y+y.height+y.margin.bottom,T,F.lineStyle);else if(y.y<r.y+r.height&&y.y+y.height>=r.y+r.height)this.renderSingleBorder(F.color,r.x-h-T,y.y-y.margin.top,r.x-h-T,y.y+y.height+l,T,F.lineStyle);else if(y.y>r.y+r.height)break}}if(r.updatedTopBorders&&r.updatedTopBorders.length>1)for(var x=t.x-t.margin.left-g/2,P=t.y-t.margin.top,E=0;E<r.updatedTopBorders.length;E++){var L=r.updatedTopBorders[E];"None"!==(p=L.border).lineStyle&&p.lineWidth<V.getCellTopBorder(r).lineWidth&&(p.lineWidth=V.getCellTopBorder(r).lineWidth),(0,a.le)(p)||(f=w.convertPointToPixel(p.getLineWidth()),this.renderSingleBorder(p.color,x,P+f/2,x+L.width,P+f/2,f,p.lineStyle),x+=L.width)}else p=V.getCellTopBorder(r),f=w.convertPointToPixel(p.getLineWidth()),this.renderSingleBorder(p.color,t.x-t.margin.left-g/2,t.y-t.margin.top+f/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+f/2,f,p.lineStyle);var R;R=u?0===r.cellIndex:r.cellIndex===r.ownerRow.childWidgets.length-1;for(var N=r.containerWidget.getPreviousRowSpannedCells(),B=!1,q=0;q<N.length;q++){var A=N[q];if(r.rowIndex<A.rowIndex+A.cellFormat.rowSpan&&r.columnIndex<A.columnIndex){B=!0;break}}(r.ownerTable.tableFormat.cellSpacing>0||R)&&(u||r.columnIndex+r.cellFormat.columnSpan===r.ownerTable.tableHolder.columns.length||!B)&&(p=u?V.getCellLeftBorder(r):V.getCellRightBorder(r),f=w.convertPointToPixel(p.getLineWidth()),this.renderSingleBorder(p.color,t.x+t.width+t.margin.right-f/2,t.y-t.margin.top,t.x+t.width+t.margin.right-f/2,t.y+t.height+l,f,p.lineStyle));var X=r.ownerRow.nextWidget,le=!1,K=void 0;if(!(0,a.le)(X)){if(X.lastChild){var he=X.lastChild;K=he.columnIndex+he.cellFormat.columnSpan}var ge;(ge=X)instanceof Q&&t.containerWidget instanceof Q&&t.containerWidget.containerWidget instanceof k&&(le=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(ge))}if(r.ownerTable.tableFormat.cellSpacing>0||r.ownerRow.rowIndex===r.ownerTable.childWidgets.length-1||r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan>=r.ownerTable.childWidgets.length||!le||K&&X.childWidgets.length<r.ownerRow.childWidgets.length&&K<r.columnIndex+r.cellFormat.columnSpan){var te=r.cellFormat.borders.bottom;p=((0,a.le)(te)||"Cleared"!==te.lineStyle)&&r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan===r.ownerTable.childWidgets.length?r.getBorderBasedOnPriority(r.getBorderBasedOnPriority(r.cellFormat.borders.bottom,r.ownerRow.rowFormat.borders.bottom),r.ownerTable.tableFormat.borders.bottom):V.getCellBottomBorder(r),f=w.convertPointToPixel(p.getLineWidth()),this.renderSingleBorder(p.color,t.x-t.margin.left-g/2,t.y+t.height+l+f/2,t.x+t.width+t.margin.right,t.y+t.height+l+f/2,f,p.lineStyle)}p=i.getCellDiagonalUpBorder(r),(f=w.convertPointToPixel(p.getLineWidth()))>0&&this.renderSingleBorder(p.color,t.x-h,t.y+t.height+l,t.x+t.width+d,t.y-o,f,p.lineStyle),p=i.getCellDiagonalDownBorder(r),(f=w.convertPointToPixel(p.getLineWidth()))>0&&this.renderSingleBorder(p.color,t.x-h,t.y-o,t.x+t.width+d,t.y+t.height+l,f,p.lineStyle)},s.prototype.renderCellBackground=function(e,t,i,n){var r=t.cellFormat,o="#ffffff"===r.shading.backgroundColor?t.ownerTable.tableFormat.shading.backgroundColor:r.shading.backgroundColor,l=t.x-i-n,d=t.y-(t.margin.top-t.containerWidget.topBorderWidth),c=t.width+i+t.margin.right+n;t.ownerRow.rowFormat.revisions.length>0&&(o="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4"),this.pageContext.beginPath(),"empty"!==o&&(this.pageContext.fillStyle=w.getColor(o),this.pageContext.fillRect(this.getScaledValue(l,1),this.getScaledValue(d,2),this.getScaledValue(c),this.getScaledValue(e)),this.pageContext.closePath()),r.shading.hasValue("foregroundColor")&&"TextureNone"!==r.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(r.shading.textureStyle,w.getColor(r.shading.foregroundColor),w.getColor(r.shading.backgroundColor),"empty"===r.shading.foregroundColor,"empty"===r.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(l,1),this.getScaledValue(d,2),this.getScaledValue(c),this.getScaledValue(e)),this.pageContext.closePath())},s.prototype.drawTextureStyle=function(e,t,i,n,r){if(r&&(i="#ffffff"),n&&(t="#000000"),e.indexOf("Percent")>-1){var o=e.replace("Texture","").replace("Percent","").replace("Pt","."),l=parseInt(o);return this.getForeColor(t,i,l,n,r)}return"TextureSolid"===e?t:"#FFFFFF"},s.prototype.getForeColor=function(e,t,i,n,r){var o,l,h,d=w.convertHexToRgb(e),c=w.convertHexToRgb(t);return o=this.getColorValue(d.r,c.r,i,n,r),l=this.getColorValue(d.g,c.g,i,n,r),h=this.getColorValue(d.b,c.b,i,n,r),"#"+w.convertRgbToHex(o)+w.convertRgbToHex(l)+w.convertRgbToHex(h)},s.prototype.getColorValue=function(e,t,i,n,r){return 100==i?e:n?r?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):r?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},s.prototype.renderSingleBorder=function(e,t,i,n,r,o,l){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(n,1),this.getScaledValue(r,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=w.getColor(e),"None"!==l&&"Cleared"!==l&&this.pageContext.stroke(),this.pageContext.closePath()},s.prototype.getScaledValue=function(e,t){return this.isPrinting?e:((0,a.le)(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},s.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,n=0;n<i;n++){var r=e.revisions[n],o=this.documentHelper.authors.get(r.author);t.push({type:r.revisionType,color:o})}return t},s.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return e.length>0?e[0].color:void 0},s.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var n=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return this.pageContext.fillStyle=w.getColor((n=e[i]).color),e.splice(i,1),n;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return this.pageContext.fillStyle=w.getColor((n=e[i]).color),e.splice(i,1),n}},s.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof H&&!(0,a.le)(e.children[t].formFieldData))return e.children[t]},s.prototype.destroy=function(){this.documentHelper=void 0,(0,a.le)(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},s}(),Po=function(){function s(e){var t=this;this.onMouseWheelInternal=function(i){if(!0===i.ctrlKey&&(i.preventDefault(),i.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth)){var r=navigator.userAgent.match("Firefox"),l=t.documentHelper.zoomFactor;(r?i.detail<0:a.AR.isIE?i.wheelDelta>0:i.deltaY<0)?l<=4.9?l+=.1:l=5:l>=.2?l-=.1:l=.1,t.documentHelper.zoomFactor=l}},this.documentHelper=e}return s.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),(0,a.le)(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),(0,a.le)(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},s.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},s.prototype.destroy=function(){this.documentHelper=void 0},s}(),Ho=function(){function s(e){var t=this;this.show=function(){var i=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),t.target||t.initUserDialog(i,t.documentHelper.owner.enableRtl),t.documentHelper.dialog.header=i.getConstant("Add Users"),t.documentHelper.dialog.height="auto",t.documentHelper.dialog.width="auto",t.documentHelper.dialog.content=t.target,t.documentHelper.dialog.beforeOpen=t.loadUserDetails,t.documentHelper.dialog.close=t.documentHelper.updateFocus,t.documentHelper.dialog.buttons=[{click:t.okButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:t.hideDialog,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat"}},{click:t.deleteButtonClick,buttonModel:{content:i.getConstant("Delete"),cssClass:"e-flat e-user-delete"}}],t.documentHelper.dialog.dataBind(),t.documentHelper.dialog.show()},this.loadUserDetails=function(){t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.documentHelper.restrictEditingPane.addedUser.dataSource=t.documentHelper.userCollection.slice(),t.documentHelper.restrictEditingPane.addedUser.dataBind()},this.okButtonClick=function(){t.documentHelper.restrictEditingPane.isAddUser=!0,t.documentHelper.restrictEditingPane.showStopProtectionPane(!1),t.documentHelper.restrictEditingPane.addUserCollection(),t.documentHelper.restrictEditingPane.isAddUser=!1,t.documentHelper.dialog.hide()},this.hideDialog=function(){t.textBoxInput.value="",t.documentHelper.dialog.hide()},this.onKeyUpOnDisplayBox=function(){t.addButton.disabled=""===t.textBoxInput.value},this.addButtonClick=function(){t.validateUserName(t.textBoxInput.value)?(-1===t.documentHelper.userCollection.indexOf(t.textBoxInput.value)&&t.documentHelper.userCollection.push(t.textBoxInput.value),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.textBoxInput.value=""):se.hZ.alert("Invalid user name")},this.deleteButtonClick=function(){var i=t.documentHelper.userCollection.indexOf(t.userList.getSelectedItems().text);i>-1&&(t.documentHelper.userCollection.splice(i,1),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind())},this.documentHelper=e}return s.prototype.initUserDialog=function(e,t){this.target=(0,a.az)("div",{className:"e-de-user-dlg"});var i=e.getConstant("Enter User"),n=(0,a.az)("div",{innerHTML:i,className:"e-bookmark-dlgfields"});this.target.appendChild(n);var r=(0,a.az)("div",{className:"e-de-user-dlg-common"});this.target.appendChild(r);var o=(0,a.az)("div",{className:"e-de-user-dlg-list"});r.appendChild(o),t&&o.classList.add("e-de-rtl"),this.textBoxInput=(0,a.az)("input",{className:"e-input e-de-user-dlg-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),o.appendChild(this.textBoxInput),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnDisplayBox);var l=(0,a.az)("button",{innerHTML:e.getConstant("Add"),attrs:{type:"button"}});o.appendChild(l),l.addEventListener("click",this.addButtonClick),this.addButton=new M.zx({cssClass:"e-de-user-add-btn"}),this.addButton.disabled=!0,this.addButton.appendTo(l),this.addButton.addEventListener("click",this.addButtonClick);var h=(0,a.az)("div");r.appendChild(h);var d=(0,a.az)("div",{innerHTML:e.getConstant("Users"),className:"e-de-user-dlg-user"});h.appendChild(d);var c=(0,a.az)("div");h.appendChild(c),this.userList=new pt.Bv({cssClass:"e-de-user-listview"}),this.userList.appendTo(c)},s.prototype.validateUserName=function(e){if(-1===e.indexOf("@"))return!1;var i=e.split("@")[1];if(-1===i.indexOf("."))return!1;var n=i.split("."),r=n[1];return!(n.length>2||r.length>4||r.length<2)},s.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.userList&&(this.userList.destroy(),this.userList=void 0),this.documentHelper=void 0},s}(),Io=function(){function s(e,t){var i=this;this.show=function(){i.localeValue=new a.E7("documenteditor",i.viewer.owner.defaultLocale),i.localeValue.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localeValue),i.documentHelper.dialog.header=i.localeValue.getConstant("Start Enforcing Protection"),i.documentHelper.dialog.height="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.width="auto",i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localeValue.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localeValue.getConstant("Cancel"),cssClass:"e-flat"}}],i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.show()},this.hideDialog=function(){i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.hide()},this.okButtonClick=function(){i.passwordTextBox.value!==i.confirmPasswordTextBox.value?se.hZ.alert(i.localeValue.getConstant("Password Mismatch")):(i.password=i.passwordTextBox.value,i.viewer.owner.editor.addProtection(i.password,i.owner.protectionType))},this.documentHelper=e,this.owner=t}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.initDialog=function(e){this.target=(0,a.az)("div",{className:"e-de-enforce"});var t=(0,a.az)("div",{className:"e-de-container-row"});this.passwordTextBox=(0,a.az)("input",{attrs:{type:"password",autofocus:"true"},className:"e-input"}),t.appendChild(this.passwordTextBox);var i=(0,a.az)("div");this.confirmPasswordTextBox=(0,a.az)("input",{attrs:{type:"password"},className:"e-input"}),i.appendChild(this.confirmPasswordTextBox),this.target.appendChild(t),this.target.appendChild(i),new J.zC({placeholder:e.getConstant("Enter new password"),floatLabelType:"Always",cssClass:"e-de-enforce-dlg-input"},this.passwordTextBox),new J.zC({placeholder:e.getConstant("Reenter new password to confirm"),floatLabelType:"Always"},this.confirmPasswordTextBox)},s.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},s}(),Lo=function(){function s(e,t){var i=this;this.show=function(){i.localObj=new a.E7("documenteditor",i.viewer.owner.defaultLocale),i.localObj.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localObj),i.documentHelper.dialog.header="Unprotect Document",i.documentHelper.dialog.height="auto",i.documentHelper.dialog.width="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localObj.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localObj.getConstant("Cancel"),cssClass:"e-flat"}}],i.documentHelper.dialog.dataBind(),i.passwordTextBox.value="",i.documentHelper.dialog.show()},this.okButtonClick=function(){var n=i.passwordTextBox.value;""!==n?i.viewer.owner.editor.stopProtection(n):se.hZ.alert(i.localObj.getConstant("The password is incorrect"))},this.hideDialog=function(){i.passwordTextBox.value="",i.documentHelper.dialog.hide()},this.documentHelper=e,this.owner=t}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.initDialog=function(e){this.target=(0,a.az)("div",{id:this.viewer.owner.containerId+"_enforce_protection",className:"e-de-enforce"});var i=(0,a.az)("div"),n=(0,a.az)("div",{className:"e-de-unprotect-dlg-title",innerHTML:e.getConstant("Password")});this.passwordTextBox=(0,a.az)("input",{attrs:{type:"password"},id:this.viewer.owner.containerId+"_display_text",className:"e-input e-de-enforce-dlg-input"}),i.appendChild(n),i.appendChild(this.passwordTextBox),this.target.appendChild(i)},s.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},s}(),Eo=function(){function s(e){var t=this;this.addRemove=!0,this.protectionType="ReadOnly",this.previousProtectionType="Read only",this.isShowRestrictPane=!1,this.isAddUser=!1,this.usersCollection=["Everyone"],this.closePane=function(){t.restrictPane.style.display="none",t.documentHelper.updateViewerSize()},this.onYesButtonClick=function(){t.viewer.owner.editor.removeAllEditRestrictions(),t.documentHelper.dialog.hide()},this.onCancelButtonClick=function(i){t.protectionTypeDrop.value=t.previousProtectionType,t.documentHelper.dialog.hide()},this.onNoButtonClick=function(){t.documentHelper.dialog.hide()},this.showAllRegion=function(){t.documentHelper.selection.showAllEditingRegion()},this.documentHelper=e,this.addUserDialog=new Ho(e),this.enforceProtectionDialog=new Io(e,this),this.unProtectDialog=new Lo(e,this),this.base64=new Nn}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.showHideRestrictPane=function(e){this.restrictPane||(this.localObj=new a.E7("documenteditor",this.viewer.owner.defaultLocale),this.localObj.setLocale(this.viewer.owner.locale),this.initPane(this.localObj,this.documentHelper.owner.enableRtl)),e?(this.restrictPane.style.display="block",this.isShowRestrictPane=!0,this.documentHelper.selection.isHighlightEditRegion=!0,this.wireEvents(),this.documentHelper.updateViewerSize(),this.loadPaneValue()):(this.closePane(),this.documentHelper.updateFocus())},s.prototype.initPane=function(e,t){this.restrictPane=(0,a.az)("div",{className:"e-de-restrict-pane"}),t&&this.restrictPane.classList.add("e-rtl");var i=(0,a.az)("div",{className:"e-de-rp-whole-header"}),n=(0,a.az)("div",{innerHTML:e.getConstant("Restrict Editing"),className:"e-de-rp-header"});this.closeButton=(0,a.az)("button",{className:"e-de-rp-close-icon e-de-close-icon e-btn e-flat e-icon-btn",attrs:{type:"button"}}),i.appendChild(this.closeButton),i.appendChild(n);var r=(0,a.az)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(r),this.restrictPane.appendChild(i),this.initRestrictEditingPane(e),this.documentHelper.optionsPaneContainer.setAttribute("style","display:inline-flex;"),this.documentHelper.optionsPaneContainer.insertBefore(this.restrictPane,this.documentHelper.viewerContainer)},s.prototype.initRestrictEditingPane=function(e){this.restrictPaneWholeDiv=(0,a.az)("div");var t=(0,a.az)("div",{className:"e-de-rp-sub-div"}),i=(0,a.az)("div",{innerHTML:e.getConstant("Formatting restrictions"),className:"e-de-rp-format"});t.appendChild(i);var n=(0,a.az)("input",{attrs:{type:"checkbox"}});t.appendChild(n),this.allowFormat=this.createCheckBox(e.getConstant("Allow formatting"),n),this.restrictPaneWholeDiv.appendChild(t);var r=(0,a.az)("div",{className:"e-de-rp-sub-div"}),l=((0,a.az)("input",{attrs:{type:"checkbox"}}),(0,a.az)("input",{className:"e-prop-font-style"}));r.appendChild(l);var h=[{Value:"Read only",Name:e.getConstant("Read only")},{Value:"Filling in forms",Name:e.getConstant("Filling in forms")},{Value:"Comments",Name:e.getConstant("Comments")},{Value:"Tracked changes",Name:e.getConstant("Tracked changes")}];this.protectionTypeDrop=new Te.NB({dataSource:h,cssClass:"e-de-prop-dropdown",floatLabelType:"Always",placeholder:e.getConstant("Editing restrictions"),fields:{text:"Name",value:"Value"},enableRtl:this.documentHelper.owner.enableRtl}),this.protectionTypeDrop.value="Read only",this.protectionTypeDrop.appendTo(l),this.restrictPaneWholeDiv.appendChild(r),this.userWholeDiv=(0,a.az)("div",{className:"e-de-rp-sub-div"});var d=(0,a.az)("div",{innerHTML:e.getConstant("Exceptions Optional"),className:"e-de-rp-format"});this.userWholeDiv.appendChild(d);var c=(0,a.az)("div",{innerHTML:e.getConstant("Select Part Of Document And User"),className:"e-de-rp-sub-content-div"});this.userWholeDiv.appendChild(c);var u=(0,a.az)("div",{className:"e-de-rp-user"});this.userWholeDiv.appendChild(u),this.addedUser=new pt.Bv({cssClass:"e-de-user-listView",dataSource:[{text:"Everyone"}],showCheckBox:!0,select:this.selectHandler.bind(this),enableRtl:this.documentHelper.owner.enableRtl}),this.addedUser.appendTo(u),this.addUser=(0,a.az)("button",{className:"e-btn e-primary e-flat e-de-rp-mu-btn",innerHTML:e.getConstant("More users")+"...",attrs:{type:"button"}}),this.userWholeDiv.appendChild(this.addUser),this.restrictPaneWholeDiv.appendChild(this.userWholeDiv);var p=(0,a.az)("div",{className:"e-de-rp-enforce"});this.restrictPaneWholeDiv.appendChild(p),this.enforceProtection=(0,a.az)("button",{innerHTML:e.getConstant("Enforcing Protection"),className:"e-btn e-de-rp-btn-enforce",attrs:{type:"button"}}),p.appendChild(this.enforceProtection),this.restrictPane.appendChild(this.restrictPaneWholeDiv),this.stopProtectionDiv=(0,a.az)("div",{styles:"display:none"});var f=(0,a.az)("div",{innerHTML:e.getConstant("Your permissions"),className:"e-de-rp-stop-div1"});this.stopProtectionDiv.appendChild(f);var g=(0,a.az)("div",{className:"e-de-rp-stop-div2"});this.stopProtectionDiv.appendChild(g);var m=e.getConstant("Protected Document");this.contentDiv1=(0,a.az)("div",{innerHTML:m}),g.appendChild(this.contentDiv1);var v=e.getConstant("ReadOnlyProtection");this.contentDiv2=(0,a.az)("div",{innerHTML:v}),g.appendChild(this.contentDiv2),this.stopReadOnlyOptions=(0,a.az)("div"),this.stopProtectionDiv.appendChild(this.stopReadOnlyOptions);var y=(0,a.az)("div",{className:"e-de-rp-enforce-nav"}),b=(0,a.az)("button",{innerHTML:e.getConstant("Find Next Region I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});y.appendChild(b),b.addEventListener("click",this.navigateNextRegion.bind(this)),this.stopReadOnlyOptions.appendChild(y);var C=(0,a.az)("div",{className:"e-de-rp-enforce-nav"}),F=(0,a.az)("button",{innerHTML:e.getConstant("Show All Regions I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});C.appendChild(F),F.addEventListener("click",this.showAllRegion),this.stopReadOnlyOptions.appendChild(C);var T=(0,a.az)("div",{className:"e-de-rp-nav-lbl e-de-rp-more-less"}),x=(0,a.az)("input",{attrs:{type:"checkbox"},className:"e-btn e-de-rp-nav-btn"});T.appendChild(x),this.stopReadOnlyOptions.appendChild(T),this.highlightCheckBox=new M.Jg({label:e.getConstant("Highlight the regions I can edit"),enableRtl:this.documentHelper.owner.enableRtl},x);var P=(0,a.az)("div",{className:"e-de-rp-enforce"});this.stopProtection=(0,a.az)("button",{innerHTML:e.getConstant("Stop Protection"),className:"e-btn e-de-rp-btn-stop-enforce",attrs:{type:"button"}}),P.appendChild(this.stopProtection),this.stopProtectionDiv.appendChild(P),this.restrictPane.appendChild(this.stopProtectionDiv)},s.prototype.showStopProtectionPane=function(e){switch(e?(this.stopProtectionDiv.style.display="block",this.restrictPaneWholeDiv.style.display="none"):(this.stopProtectionDiv.style.display="none",this.restrictPaneWholeDiv.style.display="block"),this.documentHelper.protectionType){case"ReadOnly":case"CommentsOnly":this.stopReadOnlyOptions.style.display="block";break;default:this.stopReadOnlyOptions.style.display="none"}},s.prototype.wireEvents=function(){this.addUser.addEventListener("click",this.addUserDialog.show),this.enforceProtection.addEventListener("click",this.protectDocument.bind(this)),this.stopProtection.addEventListener("click",this.stopProtectionTriggered.bind(this)),this.closeButton.addEventListener("click",this.closePane),this.allowFormat.addEventListener("change",this.enableFormatting.bind(this)),this.protectionTypeDrop.addEventListener("change",this.protectionTypeDropChanges.bind(this)),this.highlightCheckBox.addEventListener("change",this.highlightClicked.bind(this))},s.prototype.enableFormatting=function(e){this.documentHelper.restrictFormatting=!e.checked},s.prototype.stopProtectionTriggered=function(e){!(0,a.le)(this.documentHelper.saltValue)&&""!==this.documentHelper.saltValue||!(0,a.le)(this.documentHelper.hashValue)&&""!==this.documentHelper.hashValue?this.unProtectDialog.show():this.documentHelper.owner.editor.unProtectDocument()},s.prototype.protectionTypeDropChanges=function(e){switch(e.value){case"Read only":this.protectionType="ReadOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("ReadOnlyProtection"),this.previousProtectionType=e.previousItemData.Value;break;case"Filling in forms":this.protectionType="FormFieldsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("FormFieldsOnly"),this.previousProtectionType=e.previousItemData.Value;break;case"Comments":this.protectionType="CommentsOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("CommentsOnly"),this.previousProtectionType=e.previousItemData.Value;break;case"Tracked changes":this.protectionType="RevisionsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("TrackChangesOnly"),this.previousProtectionType=e.previousItemData.Value,this.documentHelper.selection&&this.documentHelper.editRanges.length>0&&(this.documentHelper.dialog.height=" Auto",this.documentHelper.dialog.width=" 600px",this.documentHelper.dialog.header=this.localObj.getConstant("Information"),this.documentHelper.dialog.content=this.localObj.getConstant("RemovedIgnoreExceptions")+"<br><br>"+this.localObj.getConstant("RemovedIgnore"),this.documentHelper.dialog.buttons=[{click:this.onYesButtonClick,buttonModel:{content:this.localObj.getConstant("Yes")}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel")}},{click:this.onNoButtonClick,buttonModel:{content:this.localObj.getConstant("No")}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show());break;default:this.protectionType="NoProtection",this.addedUser.uncheckAllItems(),this.viewer.owner.editor.removeAllEditRestrictions()}},s.prototype.selectHandler=function(e){e.isChecked?(this.viewer.owner.editor.insertEditRangeElement(e.text),e.event.target.classList.add("e-check")):this.viewer.owner.editor.removeUserRestrictions(e.text)},s.prototype.highlightClicked=function(e){this.documentHelper.selection.isHighlightEditRegion=e.checked},s.prototype.protectDocument=function(){this.enforceProtectionDialog.show()},s.prototype.createCheckBox=function(e,t){var i=new M.Jg({label:e,enableRtl:this.documentHelper.owner.enableRtl});return i.appendTo(t),i},s.prototype.loadPaneValue=function(){switch(this.allowFormat.checked=!this.documentHelper.restrictFormatting,this.documentHelper.protectionType){case"ReadOnly":this.protectionTypeDrop.value="Read only";break;case"FormFieldsOnly":this.protectionTypeDrop.value="Filling in forms";break;case"CommentsOnly":this.protectionTypeDrop.value="Comments";break;case"RevisionsOnly":this.protectionTypeDrop.value="Tracked changes"}this.highlightCheckBox.checked=!0,this.addedUser.enablePersistence=!0,this.addedUser.dataSource=this.usersCollection.slice(),this.addedUser.dataBind(),this.showStopProtectionPane(this.documentHelper.isDocumentProtected)},s.prototype.navigateNextRegion=function(){this.documentHelper.selection.navigateToNextEditingRegion()},s.prototype.addUserCollection=function(){if(this.documentHelper.selection&&this.documentHelper.selection.editRangeCollection.length>0)for(var e=0;e<this.documentHelper.selection.editRangeCollection.length;e++){var t=this.documentHelper.selection.editRangeCollection[e];""!==t.user&&-1===this.usersCollection.indexOf(t.user)&&this.usersCollection.push(t.user),""!==t.group&&-1===this.usersCollection.indexOf(t.group)&&this.usersCollection.push(t.group)}this.addedUser.dataSource=this.documentHelper.userCollection.slice(),this.addedUser.dataBind()},s.prototype.updateUserInformation=function(){if(this.addedUser.uncheckAllItems(),this.documentHelper.selection.checkSelectionIsAtEditRegion){var e=this.documentHelper.selection.getEditRangeStartElement();if(e){var t=this.addedUser.dataSource.indexOf(e.user);t>-1&&this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check"),(t=this.addedUser.dataSource.indexOf(e.group))>-1&&this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check")}}},s.prototype.destroy=function(){this.addUserDialog&&this.addUserDialog.destroy(),this.addUserDialog=void 0,this.enforceProtectionDialog&&this.enforceProtectionDialog.destroy(),this.enforceProtectionDialog=void 0,this.unProtectDialog&&this.unProtectDialog.destroy(),this.unProtectDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.addedUser&&(this.addedUser.destroy(),this.addedUser=void 0),this.allowFormat&&(this.allowFormat.destroy(),this.allowFormat=void 0),this.protectionTypeDrop&&(this.protectionTypeDrop.destroy(),this.protectionTypeDrop=void 0),this.highlightCheckBox&&(this.highlightCheckBox.destroy(),this.highlightCheckBox=void 0),this.addUser&&(this.addUser.innerHTML="",this.addUser.remove(),this.addUser=void 0),this.restrictPane&&(this.restrictPane.innerHTML="",this.restrictPane.remove(),this.restrictPane=void 0),this.enforceProtection&&(this.enforceProtection.innerHTML="",this.enforceProtection.remove(),this.enforceProtection=void 0),this.stopProtection&&(this.stopProtection.innerHTML="",this.stopProtection.remove(),this.stopProtection=void 0),this.stopProtectionDiv&&(this.stopProtectionDiv.innerHTML="",this.stopProtectionDiv.remove(),this.stopProtectionDiv=void 0),this.stopReadOnlyOptions&&(this.stopReadOnlyOptions.innerHTML="",this.stopReadOnlyOptions.remove(),this.stopReadOnlyOptions=void 0),this.contentDiv1&&(this.contentDiv1.innerHTML="",this.contentDiv1.remove(),this.contentDiv1=void 0),this.contentDiv2&&(this.contentDiv2.innerHTML="",this.contentDiv2.remove(),this.contentDiv2=void 0),this.closeButton&&(this.closeButton.innerHTML="",this.closeButton.remove(),this.closeButton=void 0),this.userWholeDiv&&(this.userWholeDiv.innerHTML="",this.userWholeDiv.remove(),this.userWholeDiv=void 0),this.restrictPaneWholeDiv&&(this.restrictPaneWholeDiv.innerHTML="",this.restrictPaneWholeDiv.remove(),this.restrictPaneWholeDiv=void 0),this.usersCollection=[],this.usersCollection=void 0,this.previousProtectionType=void 0,this.currentHashValue=void 0,this.currentSaltValue=void 0,this.documentHelper=void 0},s}(),ko=function(){function s(e){var t=this;this.applyTextFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.textBoxInstance.value),t.owner.trigger(vt,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyNumberFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.numberInput.value.toString()),t.owner.trigger(vt,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyDateFormFieldValue=function(){(0,a.le)(t.datePickerInstance.value)||(t.owner.editor.updateFormField(t.formField,t.dateInput.value),t.owner.trigger(vt,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup())},this.applyDropDownFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.ddlInstance.index),t.owner.trigger(vt,{fieldName:t.formField.formFieldData.name,value:t.formField.formFieldData.selectedIndex,isCanceled:!1}),t.hidePopup()},this.enableDisableDatePickerOkButton=function(i){i.isInteracted&&(t.dataPickerOkButton.disabled=!1)},this.closeButton=function(){var i=t.formField;t.hidePopup();var n={fieldName:i.formFieldData.name};n.value=i.formFieldData instanceof Re?i.resultText:i.formFieldData instanceof qe?i.formFieldData.checked:i.formFieldData.selectedIndex,n.isCanceled=!0,t.owner.trigger(vt,n)},this.hidePopup=function(){t.owner.documentHelper.isFormFilling=!1,t.formField=void 0,t.target&&(t.target.style.display="none"),t.popupObject&&(t.popupObject.hide(),t.popupObject.destroy(),t.popupObject=void 0)},this.owner=e}return s.prototype.initPopup=function(){var e=(0,a.az)("div",{className:"e-de-form-popup"});this.textBoxContainer=this.initTextBoxInput(),e.appendChild(this.textBoxContainer),e.appendChild(this.initNumericTextBox()),e.appendChild(this.initDatePicker()),e.appendChild(this.initDropDownList()),this.target=e,this.owner.documentHelper.viewerContainer.appendChild(e)},s.prototype.initTextBoxInput=function(){var e=(0,a.az)("div",{className:"e-de-txt-field"}),t=(0,a.az)("input",{className:"e-de-txt-form"}),i=new J.zC;this.textBoxInput=t;var n=(0,a.az)("div",{className:"e-de-cmt-action-button"}),r=(0,a.az)("button"),o=(0,a.az)("button");return r.addEventListener("click",this.applyTextFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new M.zx({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new M.zx({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.textBoxInstance=i,e},s.prototype.initNumericTextBox=function(){var e=(0,a.az)("div",{className:"e-de-num-field"}),t=(0,a.az)("input",{className:"e-de-txt-form"}),i=new J.No;this.numberInput=t;var n=(0,a.az)("div",{className:"e-de-cmt-action-button"}),r=(0,a.az)("button"),o=(0,a.az)("button");return r.addEventListener("click",this.applyNumberFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new M.zx({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new M.zx({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.numericTextBoxInstance=i,e},s.prototype.initDatePicker=function(){var e=(0,a.az)("div",{className:"e-de-date-field"}),t=(0,a.az)("input",{className:"e-de-txt-form"}),i=new ho.xZ({strictMode:!0,change:this.enableDisableDatePickerOkButton});this.dateInput=t;var n=(0,a.az)("div",{className:"e-de-cmt-action-button"}),r=(0,a.az)("button"),o=(0,a.az)("button");return r.addEventListener("click",this.applyDateFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),this.dataPickerOkButton=new M.zx({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new M.zx({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.datePickerInstance=i,e},s.prototype.initDropDownList=function(){var e=(0,a.az)("div",{className:"e-de-ddl-field"}),t=(0,a.az)("input",{className:"e-de-txt-form"}),i=new Te.NB;this.dropDownInput=t;var n=(0,a.az)("div",{className:"e-de-cmt-action-button"}),r=(0,a.az)("button"),o=(0,a.az)("button");return r.addEventListener("click",this.applyDropDownFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new M.zx({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new M.zx({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.ddlInstance=i,e},s.prototype.showPopUp=function(e){var t=this;if(e){this.formField=e,this.owner.selection.selectField(),(0,a.le)(this.target)&&this.initPopup(),(0,a.s1)(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]);var i=e.formFieldData;if(i){if(i instanceof Re){var n=e.resultText,r=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===n.replace(r,"")&&(n="");var h,o=i.maxLength,l=i.type;if(n=n||"","Text"===l)(0,a.s1)(this.target,["e-de-txt-form"],[]),h=this.textBoxInput,this.textBoxInstance.value=n;else if("Number"===i.type)(0,a.s1)(this.target,["e-de-num-form"],[]),h=this.numberInput,this.numericTextBoxInstance.format=i.format,this.numericTextBoxInstance.value=parseFloat(n.replace(/,/gi,""));else if("Date"===l){(0,a.s1)(this.target,["e-de-date-form"],[]),h=this.dateInput;var d=i.format;-1!==d.indexOf("am/pm")&&(d=d.replace(/am\/pm/gi,"a")),this.datePickerInstance.format=d,this.datePickerInstance.value=new Date(n),this.dataPickerOkButton.disabled=!0}h&&(o>0?h.maxLength=o:h.removeAttribute("maxlength"),setTimeout(function(){h.focus()}))}else i instanceof Ge&&((0,a.s1)(this.target,["e-de-ddl-form"],[]),this.ddlInstance.dataSource=i.dropdownItems,this.ddlInstance.index=i.selectedIndex,setTimeout(function(){t.ddlInstance.showPopup()}));var c=this.owner.selection.getLeftInternal(e.line,e,0),u=e.line.height*this.owner.documentHelper.zoomFactor,p=this.owner.selection.getTooltipPosition(e.line,c,this.target,!0);this.popupObject||(this.popupObject=new se.GI(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:p.x,Y:p.y+u}})),this.target.style.display="block",this.popupObject.show()}this.owner.documentHelper.isFormFilling=!0}},s.prototype.destroy=function(){this.formField&&this.formField.destroy(),this.formField=void 0,this.owner=void 0},s}(),Wo=function(){function s(e,t){this.users=[],this.enableButtons=!0,this.viewTypeitems=[],this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.isTrackingPageBreak=!1,this.tableRevisions=new U,this.owner=e,this.commentReviewPane=t,this.locale=new a.E7("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.selectedUser=this.locale.getConstant("All"),this.selectedType=this.locale.getConstant("All"),this.initTrackChangePane(),this.commentReviewPane.reviewTab.items[1].content=this.trackChangeDiv,this.commentReviewPane.reviewTab.refresh(),this.closeButton=(0,a.az)("button",this.owner.enableRtl?{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;left:1px"}}:{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;right:1px"}}),this.closeButton.title=this.locale.getConstant("Close");var i=(0,a.az)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(i),this.commentReviewPane.reviewTab.element.appendChild(this.closeButton),this.closeButton.addEventListener("click",this.commentReviewPane.closePane.bind(this.commentReviewPane))}return Object.defineProperty(s.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.isChangesTabVisible=!e,this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e),this.commentReviewPane.reviewTab.hideTab(1,e),this.owner.notify("reviewPane",{changes:!e,comment:this.commentReviewPane.isCommentTabVisible})},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){var t=(0,a.Ys)(".e-de-trckchanges-inner-select",this.changesInfoDiv);(0,a.le)(e)?(0,a.le)(t)||t.classList.remove("e-de-trckchanges-inner-select"):(e!==this.currentSelectedRevisionInternal||(0,a.le)(t))&&(t&&t.classList.remove("e-de-trckchanges-inner-select"),this.changes.length>0&&this.changes.containsKey(e))&&this.changes.get(e).singleInnerDiv.classList.add("e-de-trckchanges-inner-select"),this.currentSelectedRevisionInternal=e,t=(0,a.Ys)(".e-de-trckchanges-inner-select",this.changesInfoDiv),(0,a.le)(t)||t.parentElement.scrollIntoView({block:"nearest"})},enumerable:!0,configurable:!0}),s.prototype.initTrackChangePane=function(){this.changes=new U,this.renderedChanges=new U,this.trackChangeDiv=(0,a.az)("div",{className:"e-de-tc-pane"}),this.trackChangeDiv.appendChild(this.initPaneHeader()),this.changesInfoDiv=(0,a.az)("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto"}),this.trackChangeDiv.appendChild(this.changesInfoDiv),this.noChangeDivElement=(0,a.az)("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.locale.getConstant("No changes"),this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},s.prototype.initPaneHeader=function(){var e=this;this.toolbarElement=(0,a.az)("div",{className:"e-de-track-toolbar"}),this.toolbar=new tt.o8({enableRtl:this.owner.enableRtl,items:[{template:this.locale.getConstant("User")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:(0,a.az)("div",{id:"e-de-user-list"})},{type:"Separator"},{template:this.locale.getConstant("View")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:(0,a.az)("div",{id:"e-de-revision-list"})},{prefixIcon:"e-de-nav-left-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-left",tooltipText:this.locale.getConstant("Previous Changes"),click:this.navigatePreviousChanges.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-right",tooltipText:this.locale.getConstant("Next Changes"),click:this.navigateNextChanges.bind(this)},{template:(0,a.az)("div",{id:"e-de-menu-option"}),align:"Right",cssClass:"e-de-tc-tbr",tooltipText:this.locale.getConstant("More Options")+"..."}]}),this.toolbar.appendTo(this.toolbarElement),(0,a.Ys)(".e-de-nvgte-left",this.toolbarElement).firstChild.classList.add("e-tc-nvgte"),(0,a.Ys)(".e-de-nvgte-right",this.toolbarElement).firstChild.classList.add("e-tc-nvgte");var n=(0,a.Ys)("#e-de-user-list",this.toolbarElement);this.userDropDownitems=[{text:this.locale.getConstant("All")}],this.userDropDown={items:this.userDropDownitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onUserSelect.bind(this),beforeOpen:this.onUserOpen.bind(this),beforeItemRender:function(h){e.beforeDropDownItemRender(h,e.selectedUser)}},this.userDropDownButton=new Ue.uw(this.userDropDown),this.userDropDownButton.appendTo(n),this.userDropDownButton.content=this.getSpanView(this.userDropDown.items[0].text,0);var r=(0,a.Ys)("#e-de-revision-list",this.toolbarElement);this.viewTypeitems=[{text:this.locale.getConstant("All")},{text:this.locale.getConstant("Inserted")},{text:this.locale.getConstant("Deleted")}],this.viewTypeDropDownButton=new Ue.uw({items:this.viewTypeitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onTypeSelect.bind(this),beforeItemRender:function(h){e.beforeDropDownItemRender(h,e.selectedType)}}),this.viewTypeDropDownButton.content=this.getSpanView(this.viewTypeitems[0].text,1),this.viewTypeDropDownButton.appendTo(r),this.menuoptionEle=(0,a.Ys)("#e-de-menu-option",this.toolbarElement);var l={items:[{text:this.locale.getConstant("Accept all")},{text:this.locale.getConstant("Reject all")}],select:this.onMenuSelect.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide e-tc-btn-bg-clr"};return this.menuDropDownButton=new Ue.uw(l),this.menuDropDownButton.appendTo(this.menuoptionEle),this.toolbarElement},s.prototype.beforeDropDownItemRender=function(e,t){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t?(i.style.marginRight="10px",i.style.alignSelf="center",i.setAttribute("class","e-de-selected-item e-icons")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))},s.prototype.onUserOpen=function(e){var t=e.element;t.style.maxHeight="200px",t.style.overflowY="auto"},s.prototype.enableDisableToolbarItem=function(e){var t=this.toolbar.element.querySelectorAll(".e-de-tc-tbr");this.owner&&this.owner.viewer&&(this.toolbar.enableItems(t[0].parentElement.parentElement,e),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2],e))},s.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},s.prototype.onMenuSelect=function(e){var t=this,i=e.item.text;i.match(this.locale.getConstant("Accept all"))?setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)},0):i.match(this.locale.getConstant("Reject all"))&&setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)},0),this.updateUsers()},s.prototype.onSelection=function(e){this.currentSelectedRevision=e},s.prototype.onUserSelect=function(e){var t=e.item.text;this.selectedUser=t,this.userDropDownButton.content=this.getSpanView(t,0),this.sortCollectionToDisplay()},s.prototype.onTypeSelect=function(e){var t=e.item.text;this.selectedType=t,this.viewTypeDropDownButton.content=this.getSpanView(t,1),this.sortCollectionToDisplay()},s.prototype.updateMenuOptions=function(){var e;this.selectedType!==this.locale.getConstant("All")&&(e=this.selectedType===this.locale.getConstant("Inserted")?this.locale.getConstant("Insertion"):this.locale.getConstant("Deletion")),this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes"),this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")):this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e):this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser):(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser),this.menuDropDownButton.disabled=!!this.owner.documentHelper.isDocumentProtected},s.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),n=i.outerSingleDiv;n.style.display=this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?"block":this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?i.revisionType===this.selectedType?"block":"none":this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?i.user===this.selectedUser?"block":"none":i.user===this.selectedUser&&i.revisionType===this.selectedType?"block":"none","block"===n.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},s.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},s.prototype.isUpdateTrackChanges=function(e){var t=!1,i=!1;return(0,a.le)(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"==this.changesInfoDiv.childNodes[0].className?i=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),(i||e>0)&&(t=!0),t},s.prototype.updateTrackChanges=function(e){if(e||(0,a.le)(e)){this.tableRevisions.clear(),this.renderedChanges.clear(),this.removeAllChanges(),this.enableButtons||this.menuoptionEle.classList.contains("e-de-overlay")?this.menuoptionEle.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isDocumentProtected&&this.menuoptionEle.classList.remove("e-de-overlay"):this.menuoptionEle.classList.add("e-de-overlay"),this.isChangesTabVisible=!0,this.owner.notify("reviewPane",{comment:this.commentReviewPane.isCommentTabVisible,changes:this.isChangesTabVisible});for(var t=0;t<this.owner.revisions.changes.length;t++){var i=this.owner.revisions.changes[t],n=this.owner.revisions.changes[t].range[0];if(!this.changes.containsKey(i))if(n instanceof De){var r=this.groupTableRevisions(this.owner.revisions.changes,t);if(r.length>1)for(var o=void 0,l=0;l<r.length;l++){var h=r[l];0===l?(this.addChanges(h),o=this.changes.get(i)):(o.appendRowToTable(h.range[0],l),this.revisions.push(h),this.changes.add(h,o)),this.tableRevisions.add(h,r)}else this.addChanges(i)}else this.addChanges(i)}for(t=0;t<this.renderedChanges.keys.length;t++)(o=this.renderedChanges.get(this.renderedChanges.keys[t])).updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length);this.sortCollectionToDisplay(),this.updateUsers(),e&&(this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize())}else this.currentSelectedRevision=void 0},s.prototype.groupTableRevisions=function(e,t){for(var i=e[t],n=[i],r=i.revisionType,o=i.range[0].ownerBase,l=o.ownerTable,h=o.index,d=this.owner.documentHelper.layout.getParentTable(l),c=t+1;c<e.length;c++){var u=e[c],p=u.revisionType,f=u.range[0];if(!(f instanceof De)){var y=void 0;if(f instanceof ie?y=f.ownerBase:f instanceof fe&&(y=f.line.paragraph),y instanceof I&&y.isInsideTable){var b=this.owner.documentHelper.layout.getParentTable(m=y.associatedCell.ownerTable);if(l.equals(m)||!l.equals(m)&&d.equals(b))continue}break}var m,g=f.ownerBase,v=g.index;if(l.equals(m=g.ownerTable)||!d.equals(this.owner.documentHelper.layout.getParentTable(m))){if(r!==p||i.author!==u.author||!l.equals(m)||h+1!==v)break;n.push(u),h=v}}return n},s.prototype.updateUsers=function(){this.users.length>0&&(this.userDropDownButton.removeItems(this.users),this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&(this.users.push(this.revisions[e].author),this.userDropDownButton.items.push({text:this.revisions[e].author}))},s.prototype.updateHeight=function(){var e=this.commentReviewPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.changesInfoDiv.style.height=this.commentReviewPane.parentPaneElement.clientHeight-this.toolbarElement.clientHeight-e-2+"px"},s.prototype.removeAllChanges=function(){for(;this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);if(this.revisions=[],this.changes&&this.changes.length>0){for(var e=0;e<this.changes.length;e++)this.changes.get(this.changes.keys[e]).destroy();this.changes.clear()}},s.prototype.clear=function(){this.removeAllChanges(),this.selectedUser=this.locale.getConstant("All"),this.userDropDownButton.content=this.getSpanView(this.selectedUser,0),this.selectedType=this.locale.getConstant("All"),this.viewTypeDropDownButton.content=this.getSpanView(this.selectedType,1),this.currentSelectedRevision=void 0},s.prototype.destroy=function(){this.removeAllChanges(),this.toolbar&&(this.toolbar.destroy(),this.toolbar=void 0),this.closeButton&&this.closeButton.parentElement&&this.closeButton.parentElement.removeChild(this.closeButton),this.closeButton=void 0,this.userDropDownButton&&(this.userDropDownButton.destroy(),this.userDropDownButton=void 0),this.menuDropDownButton&&(this.menuDropDownButton.destroy(),this.menuDropDownButton=void 0),this.viewTypeDropDownButton&&(this.viewTypeDropDownButton.destroy(),this.viewTypeDropDownButton=void 0),this.userDropDown&&(this.userDropDown=void 0),this.users.length>0&&(this.users=[],this.users=void 0),this.trackChangeDiv&&(this.trackChangeDiv=void 0),this.changesInfoDiv&&(this.changesInfoDiv=void 0),this.commentReviewPane&&(this.commentReviewPane=void 0),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0),this.renderedChanges&&(this.renderedChanges.destroy(),this.renderedChanges=void 0),this.currentSelectedRevisionInternal=void 0,this.selectedUser=void 0,this.selectedType=void 0,this.sortedRevisions=[],this.sortedRevisions=void 0,this.viewTypeitems=[],this.viewTypeitems=void 0,this.userDropDownitems=[],this.userDropDownitems=void 0,this.revisions=void 0,this.changes=void 0,this.owner=void 0},s.prototype.addChanges=function(e){var t=new Ro(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),this.changes.add(e,t),this.renderedChanges.add(e,t)},s.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},s.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},s.prototype.revisionNavigateInternal=function(e){var t=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===t.length)return;this.currentSelectedRevision=t[0]}if(this.currentSelectedRevision){var i=t,n=this.currentSelectedRevision,r=i.indexOf(n);if(this.owner.documentHelper.currentSelectedRevision=n=e?r===i.length-1?i[0]:i[r+1]:0===r?i[i.length-1]:i[r-1],n.range[0]instanceof De){var l=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(n));this.owner.selection.selectTableRevision(l)}else this.owner.selection.selectRevision(n)}this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision},s}(),Ro=function(){function s(e,t){this.owner=e,this.locale=new a.E7("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.trackChangesPane=t}return s.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+e.toString()+" "+this.locale.getConstant("of")+" "+t.toString()},s.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=(0,a.az)("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=(0,a.az)("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this)),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=(0,a.az)("div",{className:"e-de-track-usernme-div"}),i=(0,a.az)("div",{innerHTML:e.author,className:"e-de-track-user-nme"});(0,a.le)(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,i,void 0,e));var n=(0,a.az)("div");"Insertion"===e.revisionType?(this.revisionType="Inserted",n.innerHTML=this.locale.getConstant("Inserted").toUpperCase(),n.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",n.innerHTML=this.locale.getConstant("Deleted").toUpperCase(),n.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",n.innerHTML=this.locale.getConstant("Move From").toUpperCase(),n.classList.add("e-de-track-delete"),n.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",n.innerHTML=this.locale.getConstant("Move To").toUpperCase(),n.classList.add("e-de-track-insert"),n.style.whiteSpace="nowrap"),t.appendChild(n),this.singleInnerDiv.appendChild(t);var r=(0,a.az)("div",{className:"e-de-track-date",innerHTML:w.getModifiedDate(e.date)});this.singleInnerDiv.appendChild(r);var o=(0,a.az)("div",{className:"e-de-track-chngs-text"});this.layoutElementText(e.range,o),this.singleInnerDiv.appendChild(o);var l=(0,a.az)("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(l);var h=(0,a.az)("div",{styles:"float:left;"});this.acceptButtonElement=(0,a.az)("button",{className:"e-de-track-accept-button"}),this.acceptButton=new M.zx({cssClass:"e-outline e-success",content:this.locale.getConstant("Accept")}),h.appendChild(this.acceptButtonElement),l.appendChild(h),this.acceptButton.appendTo(this.acceptButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this)),h=(0,a.az)("div",{styles:"float:left;"}),this.rejectButtonElement=(0,a.az)("button",{className:"e-de-track-reject-button"}),this.rejectButton=new M.zx({cssClass:"e-outline e-danger",content:this.locale.getConstant("Reject")}),h.appendChild(this.rejectButtonElement),l.appendChild(h),this.rejectButton.appendTo(this.rejectButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this)),this.changesCount=(0,a.az)("div",{className:"e-de-track-chngs-count",styles:"float:right;"});var d=this.owner.revisions.changes.indexOf(e)+1,c=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+d.toString()+" "+this.locale.getConstant("of")+" "+c.toString(),l.appendChild(this.changesCount),this.outerSingleDiv},s.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},s.prototype.selectRevision=function(){if(this.revision.range[0]instanceof De){var t=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision));this.owner.selection.selectTableRevision(t)}else this.owner.selection.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision)},s.prototype.layoutElementText=function(e,t){t.style.width="100%";for(var i="",n=!1,r=0;r<e.length;r++){var o=e[r];if(o instanceof H&&1===o.fieldType)n=!1;else if(!n)if(o instanceof H&&0===o.fieldType&&(n=!0),o instanceof S)i+=o.text;else if(o instanceof H&&0===o.fieldType){var l=this.owner.selection.getFieldCode(o);if(l.match("TOC ")||l.match("Toc"))return void t.appendChild(this.addSpan(i+="<Table of Content>"));if(l.match("HYPERLINK ")||l.match("MERGEFIELD")||l.match("FORMTEXT")||l.match("PAGE "))i+=this.owner.editor.retrieveFieldResultantText(o.fieldEnd);else if(o.formFieldData){var h=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5);""!==i&&(t.appendChild(this.addSpan(i)),i=""),t.appendChild(this.addSpan(o.formFieldData instanceof Re?""===o.formFieldData.defaultValue?h:o.formFieldData.defaultValue:o.formFieldData instanceof Ge?o.formFieldData.dropdownItems.length>0?o.formFieldData.dropdownItems[0]:h:String.fromCharCode(o.formFieldData.checked?9745:9744),"e-de-tc-field"))}}else if(o instanceof ee){""!==i&&(t.appendChild(this.addSpan(i)),i="");var d=(0,a.az)("img");d.setAttribute("src",o.imageString),d.classList.add("e-de-tc-shrink-img"),t.appendChild(d)}else{if(o instanceof De){this.tableElement=(0,a.az)("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var c=0;c<o.ownerBase.childWidgets.length;c++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[c].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}if(o instanceof ie){""!==i&&(t.appendChild(this.addSpan(i)),i="");var u="\xb6";o.ownerBase instanceof I&&o.ownerBase.isEndsWithPageBreak&&(u="............Page Break............"+u),t.appendChild(this.addSpan(u,"e-de-tc-pmark")),t.appendChild((0,a.az)("br"))}}}t.appendChild(this.addSpan(i))},s.prototype.addSpan=function(e,t){var i=(0,a.az)("span");return i.textContent=e,t&&i.classList.add(t),i},s.prototype.acceptButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv),this.removeFromParentCollec(),this.revision.accept(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},s.prototype.rejectButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv),this.removeFromParentCollec(),this.revision.reject(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},s.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.remove(this.revision),this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},s.prototype.destroy=function(){this.revision&&(this.revision=void 0),this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement=void 0),this.user=void 0,this.revisionType=void 0,this.trackChangesPane=void 0,this.owner=void 0},s}(),On=function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),No=function(){function s(e){var t=this;this.scrollbarWidth=0,this.isWebPrinting=!1,this.isHeaderFooter=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new U,this.revisionsInternal=new U,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new pi,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new ce(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isFormFilling=!1,this.footnotes=new Ut,this.endnotes=new Ut,this.isFootnoteWidget=!1,this.onTextInput=function(i){t.isComposingIME||(i.preventDefault(),t.owner.editor.handleTextInput(i.data))},this.compositionStart=function(){!a.AR.isDevice&&!t.owner.isReadOnlyMode&&(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistory&&t.owner.editor.initComplexHistory("IMEInput")),t.isCompositionStart=!0},this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout(function(){t.owner.editor.insertIMEText(t.getEditableDivTextContent(),!0)},0),t.isCompositionUpdated=!0},this.compositionEnd=function(i){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var n=t.getEditableDivTextContent();""!==n&&t.owner.editor.insertIMEText(n,!1),t.isComposingIME=!1,t.lastComposedText="",t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),t.editableDiv.innerHTML="",t.owner.editorHistory&&(t.owner.editorHistory.updateComplexHistory(),""===n&&(t.owner.editorHistory.undo(),t.owner.editorHistory.redoStack.pop()))}i.preventDefault(),t.isCompositionUpdated=!1,t.isCompositionEnd=!0},this.onKeyPressInternal=function(i){var n=i.which||i.keyCode;t.triggerElementsOnLoading=!1;var r=!(!i.ctrlKey&&!i.metaKey)||17===n;if(a.AR.isIE&&(i.altKey?i.altKey:18===n)&&r&&(r=!1),r&&"v"===i.key||r&&"a"===i.key||(r||t.isControlPressed&&a.AR.isIE)&&"p"===i.key)a.AR.isIE&&(t.isControlPressed=!1);else if(!t.owner.isReadOnlyMode||t.selection&&t.selection.isInlineFormFillMode()){var l=i.keyCode||i.charCode,h="";l?h=String.fromCharCode(l):i.key&&(h=i.key)," "===h||"\r"===h||"\b"===h||h===String.fromCharCode(27)||r?" "===h&&(t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):t.owner.editorModule.handleTextInput(h),i.preventDefault()}},this.onTextInputInternal=function(i){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()},this.onPaste=function(i){(!t.owner.isReadOnlyMode&&t.owner.editor.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(i),t.editableDiv.innerText="",i.preventDefault()},this.onFocusOut=function(){if(!(0,a.le)(t.selection)){if(t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&"block"===t.owner.contextMenuModule.contextMenuInstance.element.style.display)return;t.selection.hideCaret()}},this.updateFocus=function(){if(!(0,a.le)(t.currentSelectedComment))return t.owner.commentReviewPane&&t.owner.commentReviewPane.commentPane.isEditMode&&t.owner.commentReviewPane.commentPane.selectComment(t.currentSelectedComment),void t.selection.hideCaret();t.selection&&(!t.isMobileDevice||!t.owner.isReadOnly)&&(!a.AR.isDevice&&!a.AR.isIE&&!navigator.userAgent.match("Edge")&&!(0,a.le)(t.iframe)&&t.iframe.focus(),(0,a.le)(t.editableDiv)||t.editableDiv.focus(),t.selection.showCaret())},this.scrollHandler=function(){t.scrollTimer&&clearTimeout(t.scrollTimer),t.clearContent(),t.isScrollHandler=!0,!a.AR.isDevice&&!t.isComposingIME&&(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px"),t.owner.viewer.updateScrollBars();var i=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);i>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(i-t.pageContainer.offsetHeight)),t.owner.viewer instanceof ye&&!(0,a.le)(t.owner)&&t.owner.fireViewChange(),t.isScrollHandler=!1,t.scrollTimer=setTimeout(function(){!t.isScrollHandler&&!(0,a.le)(t.owner)&&t.owner.isSpellCheck&&(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())},200)},this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){!(0,a.le)(t.owner)&&!(0,a.le)(t.owner.element)&&(t.updateViewerSize(),t.clearContent(),t.owner.viewer.updateScrollBars(),(0,a.le)(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),t.resizeTimer&&clearTimeout(t.resizeTimer))},200)},this.onContextMenu=function(i){t.owner.contextMenuModule&&(t.isMouseDown&&(t.isMouseDown=!1),t.owner.contextMenuModule.onContextMenuInternal(i))},this.onMouseDownInternal=function(i){var n=i.target;if(!(!(0,a.le)(n)&&n!==t.viewerContainer||t.isTouchInput||i.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||i.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight)||(t.isFootnoteWidget=!1,(0,a.le)(t.selection)))){if(t.updateCursor(i),t.formFillPopup&&t.formFillPopup.hidePopup(),t.isLeftButtonPressed(i)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!(0,a.le)(t.owner.imageResizerModule.selectedResizeElement)){if(t.selection.isInShape){var r=t.owner.selection.getCurrentTextFrame();t.selection.selectShape(r.containerShape)}t.owner.imageResizerModule.isImageResizing=!0}i.preventDefault(),t.isTouchInput||t.selection.hideCaret();var l=new ce(i.offsetX,i.offsetY),h=t.owner.viewer.findFocusedPage(l,!0,!0);if(t.mouseDownOffset.x=h.x,t.mouseDownOffset.y=h.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(l,t.currentPage)&&t.selection.isCursorInFooterRegion(l,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(h)||t.owner.editorModule.tableResize.isInRowResizerArea(h)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(i)&&(t.owner.editorModule.tableResize.startingPoint.x=h.x,t.owner.editorModule.tableResize.startingPoint.y=h.y,t.owner.editorModule.tableResize.handleResize(h)));if(i.ctrlKey&&(t.isControlPressed=!0),t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),3===i.which&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(t.getLineWidget(h),h))return void i.preventDefault();t.isTouchInput=!1,t.isMouseDown=!0,t.updateFocus(),t.timer=setTimeout(function(){t.tapCount++,t.tapCount>1&&(t.tapCount=1)},100)}},this.onMouseMoveInternal=function(i){if(((0,a.le)(i.target)||i.target===t.viewerContainer)&&(i.preventDefault(),!(0,a.le)(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(i));var n=new ce(i.offsetX,i.offsetY),r=t.owner.viewer.findFocusedPage(n,!t.owner.enableHeaderAndFooter);if(t.isMouseDown){if(!(0,a.le)(t.currentPage)){var o=r.x,l=r.y;if(!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var h=t.owner.editorModule.tableResize.currentResizingTable,d=t.selection.setPositionForBlock(h,!0),c=t.selection.setPositionForBlock(h,!1);(!t.owner.documentHelper.isDocumentProtected||t.selection.checkSelectionIsAtEditRegion(d,c))&&t.owner.editorModule.tableResize.handleResizing(r)}else if(t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0||t.updateTextPositionForSelection(r,1),t.isLeftButtonPressed(i)){i.preventDefault();var p=t.owner.selection.end,f=new ce(o,l);(!t.owner.enableImageResizerMode||!t.owner.imageResizerModule.isImageResizerVisible||t.owner.imageResizerModule.isShapeResize)&&t.owner.selection.moveTextPosition(f,p),t.isSelectionChangedOnMouseMoved=!0}}t.selection.checkForCursorVisibility()}!t.isRowOrCellResizing&&!t.isSelectionChangedOnMouseMoved&&t.updateCursor(i),t.isRowOrCellResizing&&t.selection.hideCaret()}},this.onMouseLeaveInternal=function(i){i.preventDefault();var n=new ce(i.offsetX,i.offsetY);if(t.isMouseDown){var r=t.viewerContainer.scrollTop;t.scrollMoveTimer=i.offsetY+r>r?setInterval(function(){t.scrollForwardOnSelection(n)},100):setInterval(function(){t.scrollBackwardOnSelection(n)},100),t.isMouseEntered&&(t.isMouseEntered=!1)}},this.onMouseEnterInternal=function(i){t.isMouseEntered||t.owner.viewer.updateScrollBars(),t.isMouseEntered=!0,t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer),!t.isLeftButtonPressed(i)&&t.isMouseDown&&t.onMouseUpInternal(i)},this.onDoubleTap=function(i){if(((0,a.le)(i.target)||i.target===t.viewerContainer)&&!(0,a.le)(t.selection)){t.isTouchInput=!1;var n=new ce(i.offsetX,i.offsetY),r=t.owner.viewer.findFocusedPage(n,!0);if(t.selection.checkAndEnableHeaderFooter(n,t.owner.viewer.findFocusedPage(n,!0)))return;var o=t.getLineWidget(r),l=t.selection.getHyperLinkFieldInCurrentSelection(o,r,!0);if((0,a.le)(l)&&(l=t.selection.getCurrentFormField()),!t.isDocumentProtected&&t.owner.enableFormField){var h=t.selection.getFormFieldType(l);if(h)switch(""!==h.toString()&&t.selection.selectField(l),h){case"Text":t.owner.textFormFieldDialogModule.show();break;case"CheckBox":t.owner.checkBoxFormFieldDialogModule.show();break;case"DropDown":t.owner.dropDownFormFieldDialogModule.show()}}else t.isDocumentProtected&&l&&l.formFieldData instanceof Re&&"Text"===l.formFieldData.type&&t.selection.selectField();var d=t.selection.start.clone(),c=t.selection.end.clone(),p=d.currentWidget.getInline(d.offset,0).element;if("Pages"===t.owner.layoutType)if(p instanceof Ee)if("Footnote"===p.footnoteType){var f=t.currentPage.footnoteWidget,g=void 0;for(g=0;g<=f.bodyWidgets.length&&p.text!==f.bodyWidgets[g].footNoteReference.text;g++);d.setPositionParagraph(f.bodyWidgets[g].childWidgets[0].childWidgets[0],0),c.setPositionParagraph(f.bodyWidgets[g].childWidgets[0].childWidgets[0],0),t.selection.selectRange(d,c)}else{var v=t.pages[t.pages.length-1].endnoteWidget;if(g=void 0,!(0,a.le)(v))for(g=0;g<=v.childWidgets.length&&p.text!==v.bodyWidgets[g].footNoteReference.text;g++);d.setPositionParagraph(v.childWidgets[g].childWidgets[0],0),c.setPositionParagraph(v.childWidgets[g].childWidgets[0],0),t.selection.selectRange(d,c)}else p instanceof S&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(d,c,p);t.selection.isEmpty&&!(0,a.le)(t.currentPage)&&!(0,a.le)(t.owner.selection.start)&&(t.owner.selection.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}},this.onMouseUpInternal=function(i){if((0,a.le)(i.target)||i.target===t.viewerContainer){i.preventDefault(),t.isListTextSelected=!1;var n=new ce(i.offsetX,i.offsetY),r=t.owner.viewer.findFocusedPage(n,!0);if(!(0,a.le)(t.selection)){var o=1;a.AR.isIE?o=t.tapCount:i.detail>2&&(o=i.detail),t.isRowOrCellResizing&&t.owner.editorModule.tableResize.updateResizingHistory(r),t.isMouseDown&&!t.isSelectionChangedOnMouseMoved&&!(0,a.le)(t.currentPage)&&!(0,a.le)(t.owner.selection.start)&&(!t.owner.enableImageResizerMode||!t.owner.imageResizerModule.isImageResizing)&&(0===t.touchDownOnSelectionMark&&!t.isRowOrCellResizing&&(t.updateTextPositionForSelection(r,o),a.AR.isIE&&2===o&&t.selection.checkAndEnableHeaderFooter(n,r)),t.selection.checkForCursorVisibility(),!(0,a.le)(t.currentSelectedComment)&&t.owner.commentReviewPane&&!t.owner.commentReviewPane.commentPane.isEditMode&&(t.currentSelectedComment=void 0));var l=t.isIosDevice?i.metaKey:i.ctrlKey;if(!(0,a.le)(t.currentPage)&&!(0,a.le)(t.owner.selection.start)&&(t.owner.selection.isEmpty||t.owner.selection.isImageSelected)&&(l&&t.owner.useCtrlClickToFollowHyperlink||!t.owner.useCtrlClickToFollowHyperlink)&&!0===t.isLeftButtonPressed(i)&&t.selection.navigateHyperLinkOnEvent(r,!1),t.isMouseDown&&t.isLeftButtonPressed(i)&&t.isDocumentProtected&&"FormFieldsOnly"===t.protectionType&&t.selection){var h=t.getLineWidget(r),d=t.selection.getHyperLinkFieldInCurrentSelection(h,r,!0);if((0,a.le)(d)&&(d=t.selection.getCurrentFormField(!0)),d&&d.formFieldData&&d.formFieldData.enabled&&!t.selection.isInlineFormFillMode(d)){var c={fieldName:d.formFieldData.name};c.value=d.formFieldData instanceof Re?d.resultText:d.formFieldData instanceof qe?d.formFieldData.checked:d.formFieldData.selectedIndex,t.owner.trigger(Hn,c),"Popup"===t.owner.documentEditorSettings.formFieldSettings.formFillingMode&&!(d.formFieldData instanceof qe)||d.formFieldData instanceof Re&&"Text"!==d.formFieldData.type||d.formFieldData instanceof Ge?t.formFillPopup.showPopUp(d):(t.owner.editor.toggleCheckBoxFormField(d),c.value=d.formFieldData.checked,c.isCanceled=!1,t.owner.trigger(vt,c))}!d&&t.isFormFillProtectedMode&&t.selection.navigateToNextFormField()}else if(t.isMouseDown&&t.formFields.length>0)if((d=t.selection.getCurrentFormField(!0))&&d.formFieldData instanceof Re)t.selection.selectField();else if(t.isLeftButtonPressed(i)&&d&&d.formFieldData instanceof Ge){var u=d.line.getOffset(d,0),p=t.selection.getPhysicalPositionInternal(d.line,u,!1);t.selection.selectInternal(d.line,d,0,p)}if(!t.owner.isReadOnlyMode&&t.isSelectionInListText(r)&&t.selection.selectListText(),!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.scrollToPosition(t.owner.selection.start,t.owner.selection.end),t.owner.imageResizerModule.isImageResizing=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!(0,a.le)(t.selection.caret)&&(t.selection.caret.style.display="none"),t.isMouseDown=!1,t.isFootnoteWidget=!1,t.isSelectionChangedOnMouseMoved=!1,t.isTouchInput=!1,t.useTouchSelectionMark=!0,t.isControlPressed=!1,t.updateFocus(),t.isListTextSelected&&t.selection.hideCaret(),t.owner.enableImageResizerMode){var f=t.owner.imageResizerModule;f.isImageResizing=!1,f.isImageMoveToNextPage=!1,f.leftValue=void 0,f.topValue=void 0}t.isMouseDownInFooterRegion=!1}}},this.onTouchStartInternal=function(i){if(t.selection){if(t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===i.touches.length){t.zoomX=i.touches[0].clientX,t.zoomY=i.touches[0].clientY,t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1;var n=void 0;if(t.isMouseDown&&(n=t.getTouchOffsetValue(i)),n=t.owner.viewer.findFocusedPage(n,!0,!0),t.owner.enableImageResizerMode){var r=t.owner.imageResizerModule.getImagePointOnTouch(n);t.owner.imageResizerModule.selectedResizeElement=r.selectedElement}t.owner.enableImageResizerMode&&!(0,a.le)(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0);var o=t.owner.selection.end.location.x,l=t.selection.getCaretBottom(t.owner.selection.end,t.owner.selection.isEmpty)+9;t.touchDownOnSelectionMark=(n.y<=l&&n.y>=l-20||n.y>=l&&n.y<=l+20)&&(n.x<=o&&n.x>=o-20||n.x>=o&&n.x<=o+20)?1:0,!t.owner.selection.isEmpty&&0===t.touchDownOnSelectionMark&&(o=t.owner.selection.start.location.x,l=t.selection.getCaretBottom(t.owner.selection.start,!1)+9,t.touchDownOnSelectionMark=(n.y<=l&&n.y>=l-20||n.y>=l&&n.y<=l+20)&&(n.x<=o&&n.x>=o-20||n.x>=o&&n.x<=o+20)?2:0)}!(0,a.le)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),(t.touchDownOnSelectionMark||i.touches.length>1)&&i.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,i),t.timer=setTimeout(function(){t.isTimerStarted=!1},200)}},this.onLongTouch=function(i){if(!((0,a.le)(t.owner)||(0,a.le)(t.viewerContainer)||t.isTouchMoved||1!==i.touches.length)){var n=t.getTouchOffsetValue(i),r=t.owner.viewer.findFocusedPage(n,!0),o=t.selection.start,l=t.selection.end;t.selection.isForward||(o=t.selection.end,l=t.selection.start);var d=o.location,c=l.location;1===i.changedTouches.length&&(o.currentWidget!==l.currentWidget?!(r.x>=d.x&&r.x<=c.x||r.y>=d.y&&r.y<=c.y):!(r.x>=d.x&&r.x<=c.x&&r.y>=d.y&&r.y<=c.y))&&(t.updateSelectionOnTouch(n,r),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.selection.isEmpty&&t.selection.selectCurrentWord(),!(0,a.le)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.onContextMenuInternal(i)}},this.onTouchMoveInternal=function(i){t.isTouchMoved=!0;var r,n=i.touches;if(!(0,a.le)(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return i.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(i),t.selection.caret.style.display="none"));if(t.isMouseDown){r=t.getTouchOffsetValue(i);var o=t.owner.viewer.findFocusedPage(r,!0);if(t.touchDownOnSelectionMark>0){i.preventDefault();var h,l=o.y;h=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,o=new ce(o.x,l-=o.y<=26?o.y<0?0:o.y+.5:36.5),t.owner.selection.moveTextPosition(o,h),t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition()}}if(n.length>1){i.preventDefault(),t.isMouseDown=!1,t.zoomX=(n[0].clientX+n[1].clientX)/2,t.zoomY=(n[0].clientY+n[1].clientY)/2;var d=Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2));t.preDifference>-1?d>t.preDifference?t.onPinchOutInternal(i):d<t.preDifference&&t.onPinchInInternal(i):t.zoomFactor<2?-1!==t.preDifference&&d>t.preDifference&&t.onPinchInInternal(i):-1===t.preDifference&&t.zoomFactor>2&&d>t.preDifference&&t.onPinchInInternal(i),t.preDifference=d}t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)},this.onTouchUpInternal=function(i){if(!(0,a.le)(t.selection)){var n=t.getTouchOffsetValue(i),r=t.owner.viewer.findFocusedPage(n,!0);1===i.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(n,r),!(0,a.le)(t.currentPage)&&!(0,a.le)(t.selection.start)&&!t.isSelectionChangedOnMouseMoved&&(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))&&t.selection.navigateHyperLinkOnEvent(r,!0)),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selection.start,t.owner.selection.end)),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none"),i.preventDefault()}t.preDifference=-1,t.isTouchInput=!1,t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0),t.isTimerStarted||(t.tapCount=1),t.isListTextSelected&&t.selection.hideCaret()},this.onKeyUpInternal=function(i){a.AR.isDevice&&i.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length),(i.ctrlKey||17===i.keyCode||17===i.which)&&(t.isControlPressed=!1)},this.onKeyDownInternal=function(i){if((0,a.le)(i.target)||i.target===t.editableDiv){var n=!1,r={event:i,isHandled:!1,source:t.owner};if(t.owner.trigger("keyDown",r),!r.isHandled){var o=i.which||i.keyCode,l=!(!i.ctrlKey&&!i.metaKey)||17===o,h=i.shiftKey?i.shiftKey:16===o,d=i.altKey?i.altKey:18===o;if(l&&!h&&!d)switch(o){case 80:i.preventDefault(),t.owner.print(),n=!0;break;case 83:i.preventDefault(),t.owner.save(""===t.owner.documentName?"sample":t.owner.documentName,"Sfdt"),n=!0}!n&&!(0,a.le)(t.selection)&&t.selection.onKeyDownInternal(i,l,h,d),n&&i.preventDefault()}}},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new So(this),this.characterFormat=new ie(this),this.paragraphFormat=new ue(this),this.renderedLists=new U,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new pi,this.preDefinedStyles=new U,this.initalizeStyles(),this.bookmarks=new U,this.editRanges=new U,this.isIosDevice=/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice=/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.formFillPopup=new ko(this.owner),this.customXmlData=new U,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[]}return Object.defineProperty(s.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"containerCanvas",{get:function(){return(0,a.le)(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),!(0,a.le)(this.pageContainer)&&this.containerCanvasIn.parentElement!==this.pageContainer&&this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionCanvas",{get:function(){return(0,a.le)(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),!(0,a.le)(this.pageContainer)&&this.selectionCanvasIn.parentElement!==this.pageContainer&&this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dialog",{get:function(){return this.dialogInternal||this.initDialog(this.owner.enableRtl),this.dialogInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dialog2",{get:function(){return this.dialogInternal2||this.initDialog2(this.owner.enableRtl),this.dialogInternal2},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dialog3",{get:function(){return this.dialogInternal3||this.initDialog3(this.owner.enableRtl),this.dialogInternal3},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.owner&&this.owner.commentReviewPane&&(this.owner.commentReviewPane.previousSelectedComment=this.currentSelectedCommentInternal),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),s.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("Toc1",'{"type":"Paragraph","name":"Toc1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc2",'{"type":"Paragraph","name":"Toc2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc3",'{"type":"Paragraph","name":"Toc3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc4",'{"type":"Paragraph","name":"Toc4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc5",'{"type":"Paragraph","name":"Toc5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc6",'{"type":"Paragraph","name":"Toc6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc7",'{"type":"Paragraph","name":"Toc7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc8",'{"type":"Paragraph","name":"Toc8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc9",'{"type":"Paragraph","name":"Toc9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}')},s.prototype.clearDocumentItems=function(){this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}this.comments=[],this.bookmarks.clear(),this.styles.clear(),this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.destroy(),this.characterFormat.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.owner.commentReviewPane&&this.owner.commentReviewPane.clear(),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.formFillPopup&&this.formFillPopup.hidePopup(),this.customXmlData.clear(),this.contentControlCollection=[],this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.abstractLists=[],this.lists=[]},s.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(this.owner.paragraphFormat,this.paragraphFormat)},s.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.fontColor="#00000000",e.allCaps=!1},s.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0},s.prototype.getAbstractListById=function(e){if(!(0,a.le)(this.abstractLists))for(var t=0;t<this.abstractLists.length;t++){var i=this.abstractLists[t];if(i instanceof et&&i.abstractListId===e)return i}},s.prototype.getListById=function(e){if(!(0,a.le)(this.lists))for(var t=0;t<this.lists.length;t++)if(!(0,a.le)(this.lists[t])&&this.lists[t].listId===e)return this.lists[t]},s.getListLevelNumber=function(e){return e.ownerBase instanceof It?e.ownerBase.levelNumber:e.ownerBase instanceof et&&!(0,a.le)(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},s.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var n=this.bookmarks.keys[i];(e||0!==n.indexOf("_"))&&t.push(n)}return t},s.prototype.selectComment=function(e){var t=this;this.owner.selection&&this.owner.commentReviewPane&&(this.owner.showComments=!0,setTimeout(function(){t.owner&&t.owner.selection&&t.owner.selection.selectComment(e)}))},s.prototype.showComments=function(e){this.owner&&e&&this.owner.enableComment&&this.owner.trigger(Ot,{type:"Comment"}),this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.reviewTab.hideTab(1,!1),this.owner.commentReviewPane.showHidePane(e&&this.owner.enableComment,"Comments")},s.prototype.showRevisions=function(e){this.showRevision=e,this.owner&&e&&this.owner.trigger(Ot,{type:"comment"}),!e&&this.owner.showComments?(this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.showHidePane(!0,"Comments")):(this.owner.commentReviewPane.showHidePane(e,"Changes"),this.showRevision=!1),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},s.prototype.initializeComponents=function(){var i,e=this.owner.element;(0,a.le)(e)||(this.optionsPaneContainer=(0,a.az)("div",{className:"e-documenteditor-optionspane"}),this.optionsPaneContainer.contentEditable="false",e.appendChild(this.optionsPaneContainer),this.owner.enableRtl&&(i="direction:ltr;"),this.viewerContainer=(0,a.az)("div",{id:this.owner.containerId+"_viewerContainer"}),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;"+i,this.optionsPaneContainer.appendChild(this.viewerContainer),this.viewerContainer.tabIndex=0,this.viewerContainer.style.outline="none",this.pageContainer=(0,a.az)("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",a.AR.isDevice?this.createEditableDiv(e):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(e),this.layout=new Mn(this),this.textHelper=new Bn(this),this.zoomModule=new Po(this),this.initTouchEllipse(),this.wireEvent(),this.restrictEditingPane=new Eo(this),this.owner.commentReviewPane=new Qo(this.owner),this.owner.trackChangesPane=new Wo(this.owner,this.owner.commentReviewPane),(0,se.rj)({target:this.owner.element,cssClass:"e-spin-overlay"}))},s.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div");t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t);var i=document.createElement("div");t.appendChild(i),this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width,t.parentNode.removeChild(t)},s.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable="true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},s.prototype.createEditableIFrame=function(){this.iframe=(0,a.az)("iframe",{attrs:{scrolling:"no",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},s.prototype.initIframeContent=function(){(0,a.le)(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write('<!DOCTYPE html><html><head></head><body spellcheck="false" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px; ><div contenteditable="true" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;></div></body></html>'),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},s.prototype.wireEvent=function(){(0,a.le)(this.selection)||this.selection.initCaret(),this.wireInputEvents(),(0,a.le)(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer.bind(this)),window.addEventListener("touchend",this.onImageResizer.bind(this)),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal.bind(this)),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal.bind(this))},s.prototype.wireInputEvents=function(){(0,a.le)(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),a.AR.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===a.AR.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},s.prototype.onIframeLoad=function(){!(0,a.le)(this.iframe)&&0===this.iframe.contentDocument.body.children.length&&(this.initIframeContent(),this.wireInputEvents())},s.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},s.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},s.prototype.getAvatar=function(e,t,i,n){var r,o;if((0,a.le)(i)?r=n.author:(r=i.author,o=i.initial),!(0,a.le)(r)){var l=(0,a.az)("div",{className:"e-de-cmt-avatar"}),h=(0,a.az)("div",{className:"e-de-ff-cmt-avatar"});if(h.style.backgroundColor=this.owner.documentHelper.getAuthorColor(r),""===o||(0,a.le)(o)){var d=r.split(" "),c=d[0].charAt(0);d.length>1&&(c+=d[d.length-1][0]),h.innerText=c.toUpperCase()}else h.innerText=o.length>2?o.substring(0,2):o;l.appendChild(h),l.appendChild(t),e.appendChild(l)}},s.prototype.getAuthorColor=function(e){return this.authors.containsKey(e)?this.authors.get(e):(t=0===this.authors.length?"#b5082e":this.generateRandomColor(),this.authors.add(e,t),t);var t},s.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},s.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,n=t.boundingRectangle.x+w.convertPointToPixel(i.leftMargin)*this.zoomFactor,l="left:"+n+"px;";l+="top:"+e.y+"px;",l+="width:"+w.convertPointToPixel(i.pageWidth-i.leftMargin-i.rightMargin)*this.zoomFactor+"px;",this.iframe.setAttribute("style",l+="height:250px;outline-style:none;position:absolute");var h="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";h+="text-indent:"+(e.x-n)+"px;",h+="color:transparent;pointer-events:none;outline-style:none;",h+="font-size:"+w.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",h+="font-family"+this.selection.characterFormat.fontFamily+";",this.editableDiv.setAttribute("style",h+="overflow:hidden;text-decoration:none;white-space:normal;")},s.prototype.onImageResizer=function(e){!(0,a.le)(this.owner)&&!(0,a.le)(this.owner.imageResizerModule)&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?this.onMouseUpInternal(e):e instanceof TouchEvent&&this.onTouchUpInternal(e)),this.scrollMoveTimer&&(this.isMouseEntered=!0,clearInterval(this.scrollMoveTimer))},s.prototype.initDialog=function(e){this.dialogInternal||(this.dialogTarget1=(0,a.az)("div",{className:"e-de-dlg-target"}),this.dialogTarget1.contentEditable="false",document.body.appendChild(this.dialogTarget1),e&&this.dialogTarget1.classList.add("e-de-rtl"),this.dialogInternal=new se.Vq({target:document.body,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex+20,animationSettings:{effect:"None"}}),this.dialogInternal.isStringTemplate=!0,this.dialogInternal.open=this.selection.hideCaret,this.dialogInternal.beforeClose=this.updateFocus,this.dialogInternal.appendTo(this.dialogTarget1))},s.prototype.initDialog3=function(e){this.dialogInternal3||(this.dialogTarget3=(0,a.az)("div",{className:"e-de-dlg-target"}),this.dialogTarget3.contentEditable="false",document.body.appendChild(this.dialogTarget3),e&&this.dialogTarget3.classList.add("e-de-rtl"),this.dialogInternal3=new se.Vq({target:document.body,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex,animationSettings:{effect:"None"}}),this.dialogInternal3.isStringTemplate=!0,this.dialogInternal3.open=this.selection.hideCaret,this.dialogInternal3.beforeClose=this.updateFocus,this.dialogInternal3.appendTo(this.dialogTarget3))},s.prototype.hideDialog=function(){this.dialog.hide(),this.updateFocus()},s.prototype.initDialog2=function(e){this.dialogInternal2||(this.dialogTarget2=(0,a.az)("div",{className:"e-de-dlg-target"}),this.dialogTarget2.contentEditable="false",document.body.appendChild(this.dialogTarget2),e&&this.dialogTarget2.classList.add("e-de-rtl"),this.dialogInternal2=new se.Vq({target:document.body,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"Top"},zIndex:this.owner.zIndex+10}),this.dialogInternal2.isStringTemplate=!0,this.dialogInternal2.appendTo(this.dialogTarget2))},s.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none";if(this.pageContainer){var i=this.pageContainer.getElementsByClassName("e-de-lock-mark");for(t=0;t<i.length;t++)i[t].style.display="none"}},s.prototype.onDocumentChanged=function(e){var t=this;this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.layout.isDocumentContainsRtl=!1,this.updateAuthorIdentity();for(var i=0;i<this.pages.length;i++)this.pages[i].bodyWidgets[0].destroy();this.pages=[],(0,a.le)(this.renderedLists)||this.renderedLists.clear(),(0,a.le)(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),(0,a.le)(this.owner.editorHistory)||this.owner.editorHistory.destroy(),this.owner.isDocumentLoaded=!0,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selection&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selection.highlightFormFields(),this.owner.selection.editRangeCollection=[],this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!0)),this.owner.optionsPaneModule&&this.owner.optionsPaneModule.showHideOptionsPane(!1),this.restrictEditingPane.restrictPane&&!this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!1),!(0,a.le)(this.owner.selection)&&this.owner.selection.isViewPasteOptions&&(this.owner.selection.isViewPasteOptions=!1,this.owner.selection.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange(),setTimeout(function(){!(0,a.le)(t.owner)&&t.owner.showRevisions&&t.showRevisions(!0)})},s.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;";this.touchStart=(0,a.az)("div",{className:"e-touch-ellipse",styles:e});var i=(0,a.az)("div",{styles:t});this.touchEnd=(0,a.az)("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var n=(0,a.az)("div",{styles:t});this.touchStart.appendChild(i),this.touchEnd.appendChild(n),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},s.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!(0,a.le)(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),t=this.selection.getPage(this.selection.start.paragraph),i=t.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1);this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=i+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=i+e*this.zoomFactor+"px"}},s.prototype.scrollForwardOnSelection=function(e){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;(!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)&&(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))}},s.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;(!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)&&(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))},s.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!(0,a.le)(t)&&t.children[0]instanceof _){var i=this.getLeftValue(t);if(this.isInsideRect(i,t.paragraph.y,t.children[0].width,t.children[0].height,e))return this.selectionLineWidget=t,!0}return!1},s.prototype.isInShapeBorder=function(e,t){if(!(0,a.le)(e)){var i=e.width,n=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,i,n,t)){if(e instanceof ee)return!0;if(e instanceof de){var r=e.lineFormat.weight;if(!this.isInsideRect(e.x+r,e.y+r+e.textFrame.marginTop,i-2*r,n-(2*r+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},s.prototype.isInsideRect=function(e,t,i,n,r){return r.x>e&&r.x<=e+i&&r.y>t&&r.y<=t+n},s.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=w.convertPointToPixel(i.firstLineIndent),t-=w.convertPointToPixel(i.leftIndent)):t+=w.convertPointToPixel(i.firstLineIndent));var n=e.children[0];return n instanceof _&&(t+=n.margin.left),t},s.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},s.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,this.isMouseDown&&!this.isSelectionChangedOnMouseMoved&&!(0,a.le)(this.currentPage)&&!(0,a.le)(this.owner.selection.start)&&(!(0,a.le)(this.currentSelectedComment)&&this.owner.commentReviewPane&&!this.owner.commentReviewPane.commentPane.isEditMode&&(this.currentSelectedComment=void 0),0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new ce(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(e,t)),this.owner.selection.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},s.prototype.getTouchOffsetValue=function(e){var i=this.viewerContainer.getBoundingClientRect(),n=e.touches[0];return(0,a.le)(n)&&(n=e.changedTouches[0]),new ce(n.pageX-i.left,n.pageY-i.top)},s.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},s.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},s.prototype.getPageWidth=function(e){return e.boundingRectangle.width},s.prototype.linkPageToHeaderFooter=function(e){e.headerWidget&&e.headerWidget.page===e&&(e.headerWidget.page=void 0),e.footerWidget&&e.footerWidget.page===e&&(e.footerWidget.page=void 0)},s.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0);var t=this.pages.indexOf(e);if(this.pages.splice(t,1),!(0,a.le)(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(e)>-1){var i=this.owner.viewer.visiblePages.indexOf(e);this.owner.viewer.visiblePages.splice(i,1)}for(var r=0;r<this.pages.length;r++);var o=20;if(t>0&&(o+=this.pages[t-1].boundingRectangle.bottom),-1!==t)for(r=t;r<this.pages.length;r++)(e=this.pages[r]).boundingRectangle=new re(e.boundingRectangle.x,o,e.boundingRectangle.width,e.boundingRectangle.height),o=e.boundingRectangle.bottom+20,!(0,a.le)(e.bodyWidgets[0].firstChild)&&!(e.bodyWidgets[0].firstChild instanceof k&&e.bodyWidgets[0].firstChild.header)&&(e.repeatHeaderRowTableWidget=!1)},s.prototype.updateViewerSize=function(){var e=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof Se&&!(0,a.le)(this.owner)&&!(0,a.le)(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout(function(){if(!(0,a.le)(e.owner)){var i;i=(0,a.le)(e.visibleBounds)?0:e.visibleBounds.width,(0,a.le)(e.owner.viewer.preVisibleWidth)&&(e.owner.viewer.preVisibleWidth=0),!(0,a.le)(e.visibleBounds)&&i!==e.owner.viewer.preVisibleWidth&&(e.owner.editorModule.layoutWholeDocument(),e.owner.viewer.preVisibleWidth=i),e.resizerTimer&&clearTimeout(e.resizerTimer)}},50)),(0,a.le)(this.selection)||this.selection.updateCaretPosition()},s.prototype.updateViewerSizeInternal=function(e){if(!(0,a.le)(e)){var t=e.getBoundingClientRect(),i=0,n=0;n=t.height>0?t.height:200;var r=this.restrictEditingPane&&this.restrictEditingPane.isShowRestrictPane?this.restrictEditingPane.restrictPane.getBoundingClientRect():void 0,o=this.owner.optionsPaneModule&&this.owner.optionsPaneModule.isOptionsPaneShow?this.owner.optionsPaneModule.optionsPane.getBoundingClientRect():void 0,l=this.owner.commentReviewPane&&this.owner.commentReviewPane.parentPaneElement?this.owner.commentReviewPane.parentPaneElement.getBoundingClientRect():void 0;if(r||o||l){var h=r?r.width:0;h+=o?o.width:0,i=t.width-(h+=l?l.width:0)>0?t.width-h:200}else i=t.width>0?t.width:200;this.viewerContainer.style.height=n.toString()+"px",this.viewerContainer.style.width=Math.ceil(i)+"px",this.visibleBoundsIn=new re(0,0,i,n),this.containerCanvas.width=i,this.containerCanvas.height=n,this.selectionCanvas.width=i,this.selectionCanvas.height=n,this.measureScrollbarWidth(e)}},s.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var n=e;n<this.pages.length;n++)(t=this.pages[n]).boundingRectangle=new re(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},s.prototype.updateTextPositionForSelection=function(e,t){var i=this.getLineWidget(e);if((0,a.le)(i)||this.selection.updateTextPosition(i,e),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;!(0,a.le)(this.currentPage)&&!(0,a.le)(this.owner.selection.start)&&(t%2==0?this.owner.selection.selectCurrentWord():this.owner.selection.selectParagraph())}},s.prototype.scrollToPosition=function(e,t,i){if(this.skipScrollToPosition||this.isWebPrinting)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var n=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!(0,a.le)(n)){if(this.selection.getTop(n),this.isMouseDown){var o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),l=this.selection.getTop(o);o!==n&&t.location.y>=l&&(n=o)}var d=this.selection.getPage(n.paragraph);this.currentPage=d;var c=0,u=0;if(!(0,a.le)(d)){(c=(this.visibleBounds.width-d.boundingRectangle.width*this.zoomFactor)/2)<30&&(c=30),u=d.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(d)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var m=this.owner.viewer.containerTop,v=this.owner.viewer.containerLeft,y=this.visibleBounds.height,b=this.selection.updateCaretSize(this.owner.selection.end,!0),F=b.height;c+=t.location.x*this.zoomFactor,m+20>(u+=(t.location.y+b.topMargin)*this.zoomFactor)?this.viewerContainer.scrollTop=u-10:m+y<u+F&&(this.viewerContainer.scrollTop=u+F-y+10),i||this.selection.updateCaretToPage(e,d);var T=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;v>c?this.viewerContainer.scrollLeft=c-this.pageContainer.offsetWidth/100*20:v+this.visibleBounds.width<c+T&&(this.viewerContainer.scrollLeft=v+this.pageContainer.offsetWidth/100*15+T)}}}},s.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},s.prototype.getLineWidgetInternal=function(e,t){var i=void 0;if(!(0,a.le)(this.currentPage)){var n=void 0;if(this.owner.enableHeaderAndFooter){var r=this.currentPage,o=r.boundingRectangle.height,l=Math.max(r.headerWidget.y+r.headerWidget.height,w.convertPointToPixel(r.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,h=w.convertPointToPixel(r.bodyWidgets[0].sectionFormat.footerDistance),d=r.boundingRectangle.height-Math.max(r.footerWidget.height+h,2*h);if(t?n=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=o&&e.y>=d?n=this.currentPage.footerWidget:e.y>=0&&e.y<=l&&(n=this.currentPage.headerWidget),(0,a.le)(n))return;var c=this.checkFloatingItems(n,e,t);return c.isShapeSelected?c.isInShapeBorder?c.element.line:this.selection.getLineWidgetBodyWidget(c.element.textFrame,e):this.selection.getLineWidgetBodyWidget(n,e)}var u=this.checkFloatingItems(this.currentPage.bodyWidgets[0],e,t,!1),p=this.checkFloatingItems(this.currentPage.bodyWidgets[0],e,t,!0);if(u.isShapeSelected&&!this.isEmptyShape(u)){if(u.isInShapeBorder)return u.element.line;u.element instanceof de&&(i=this.selection.getLineWidgetBodyWidget(u.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof Y&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof Y&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var f=0;f<this.currentPage.bodyWidgets.length;f++)if(i=this.selection.getLineWidgetBodyWidget(this.currentPage.bodyWidgets[f],e),!(0,a.le)(i)){this.isFootnoteWidget=!1;break}var m=this.checkInlineShapeItems(i,e,t);if(m.isShapeSelected){if(m.isInShapeBorder)return m.element.line;m.element instanceof de&&(i=this.selection.getLineWidgetBodyWidget(m.element.textFrame,e))}else if(!this.checkPointIsInLine(i,e)&&p.isShapeSelected){if(p.isInShapeBorder)return p.element.line;p.element instanceof de&&(i=this.selection.getLineWidgetBodyWidget(p.element.textFrame,e))}}return i},s.prototype.checkInlineShapeItems=function(e,t,i){var o,n=!1,r=!1,l=this.selection.isInShape,h=i&&l;if(!(0,a.le)(e)&&e.children.length>0)if(h){var d=this.owner.selection.getCurrentTextFrame();d&&(o=d.containerShape,n=!0)}else{for(var c=0;c<e.children.length;c++)if(e.children[c]instanceof de&&"Inline"===e.children[c].textWrappingStyle&&t.x<(o=e.children[c]).x+o.margin.left+o.width&&t.x>o.x&&t.y<o.y+o.margin.top+o.height&&t.y>o.y){n=!0,this.isInShapeBorder(o,t)&&(r=!0);break}i&&!l&&(n=!1)}return{element:o,caretPosition:t,isInShapeBorder:r,isShapeSelected:n}},s.prototype.checkPointIsInLine=function(e,t){if(!(0,a.le)(e)&&e.children.length>0)for(var i=void 0,n=e.paragraph.x,r=this.selection.getTop(e),o=e.children.indexOf(e.children[0]);o<e.children.length;o++)if(!((i=e.children[o])instanceof Pe&&"Inline"!==i.textWrappingStyle)){if(t.x<n+i.margin.left+i.width+i.padding.left&&t.x>n&&t.y<r+e.height&&t.y>r)return!0;n+=i.margin.left+i.width+i.padding.left}return!1},s.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var n=0;n<e.bodyWidgets[i].childWidgets.length;n++){var r=e.bodyWidgets[i].childWidgets[n];if(r instanceof Ze&&r.y<=t.y&&r.y+r.height>=t.y)return!0}return!1},s.prototype.checkFloatingItems=function(e,t,i,n){var l,r=!1,o=!1,h=this.selection.isInShape,d=i&&h;if(e.floatingElements.length>0)if(e.floatingElements.sort(function(f,g){return f instanceof k||g instanceof k?0:f.zOrderPosition-g.zOrderPosition}),d){var u=this.owner.selection.getCurrentTextFrame();u&&(l=u.containerShape,r=!0)}else{for(var p=e.floatingElements.length-1;p>=0;p--)if(!(e.floatingElements[p]instanceof k||(!(0,a.le)(n)&&n?"Behind"!==e.floatingElements[p].textWrappingStyle:"Behind"===e.floatingElements[p].textWrappingStyle))&&t.x<(l=e.floatingElements[p]).x+l.margin.left+l.width&&t.x>l.x&&t.y<l.y+l.margin.top+l.height&&t.y>l.y){r=!0,this.isInShapeBorder(l,t)&&(o=!0);break}i&&!h&&(r=!1)}return{element:l,caretPosition:t,isShapeSelected:r,isInShapeBorder:o}},s.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof Ce);){if(!e.containerWidget)return!1;(e=e.containerWidget)instanceof be&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},s.prototype.clearSelectionHighlight=function(){this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},s.prototype.removeEmptyPages=function(){for(var e=!1,t=0;t<this.pages.length;t++){var i=this.pages[t];(0===i.bodyWidgets.length||0===i.bodyWidgets[0].childWidgets.length)&&(t===this.pages.length-1&&this.owner.viewer instanceof ye&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[t])&&(e=!0),this.linkPageToHeaderFooter(this.pages[t]),this.removePage(this.pages[t]),t--)}e&&this.scrollToBottom()},s.prototype.scrollToBottom=function(){this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget&&(this.viewerContainer.scrollTop=this.selection.start.paragraph.bodyWidget.page.boundingRectangle.bottom-this.visibleBounds.height)},s.prototype.getFieldResult=function(e,t){if(!(0,a.le)(t)&&!(0,a.le)(this.selection)){var n=this.selection.getFieldCode(e).split("*"),r=n[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),o="";switch(n.length>1&&" MERGEFORMAT"!==n[1]&&(o=n[1].replace(/[^\w\s]/gi,"").trim()),""==o&&(o=t.bodyWidgets[0].sectionFormat.pageNumberStyle),r=r.match("numpages")||r.match("sectionpages")||!r.match("page")?r:"page"){case"page":if(t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex){var h=t.previousPage;return t.sectionIndex!==h.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(o,t.currentPageNum)):(1===h.currentPageNum&&(h.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=h.currentPageNum+1,this.getFieldText(o,t.currentPageNum))}return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(o,t.currentPageNum)):(t.currentPageNum=(0,a.le)(t.previousPage)?t.index+1:t.previousPage.currentPageNum+1,t.currentPageNum=t.index+1,this.getFieldText(o,t.currentPageNum));case"numpages":return this.getFieldText(o,t.documentHelper.pages.length);case"sectionpages":for(var d=t.sectionIndex,c=0,u=0;u<t.documentHelper.pages.length;u++)if(t.documentHelper.pages[u].sectionIndex===d)c++;else if(0!==c)break;return this.getFieldText(o,c)}}return""},s.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();case"roman":case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();default:return t.toString()}},s.prototype.isEmptyShape=function(e){return e.element instanceof ee||0===e.element.textFrame.childWidgets.length},s.prototype.destroy=function(){(0,a.le)(this.owner)||this.unWireEvent(),this.pages=[],this.pages=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.abstractLists=[],this.abstractLists=void 0,(0,a.le)(this.owner)||this.renderedLists.destroy(),(0,a.le)(this.owner)||this.authors.destroy(),(0,a.le)(this.owner)||this.revisionsInternal.destroy(),(0,a.le)(this.owner)||this.preDefinedStyles.destroy(),(0,a.le)(this.owner)||this.bookmarks.destroy(),(0,a.le)(this.owner)||this.editRanges.destroy(),(0,a.le)(this.owner)||this.customXmlData.destroy(),this.blockToShift=void 0,this.cachedPages=[],this.cachedPages=void 0,this.characterFormat=void 0,this.comments=[],this.comments=void 0,this.compositionEnd=void 0,this.compositionStart=void 0,this.compositionUpdated=void 0,this.contentControlCollection=[],this.contentControlCollection=void 0,this.fieldCollection=[],this.fieldCollection=void 0,this.renderedLevelOverrides=[],this.renderedLevelOverrides=void 0,this.headersFooters=[],this.headersFooters=void 0,this.lists=[],this.lists=void 0,this.comments=[],this.comments=void 0,this.listParagraphs=[],this.listParagraphs=void 0,this.formFields=[],this.formFields=void 0,this.fieldCollection=[],this.fieldCollection=void 0,this.userCollection=[],this.userCollection=void 0,this.cachedPages=[],this.cachedPages=void 0,this.footnoteCollection=[],this.footnoteCollection=void 0,this.endnoteCollection=[],this.endnoteCollection=void 0,this.restrictEditingPane&&(this.restrictEditingPane.destroy(),this.restrictEditingPane=void 0),this.layout&&this.layout.destroy(),this.layout=void 0,(0,a.le)(this.render)||this.render.destroy(),this.render=void 0,this.dialogInternal&&this.dialogInternal.destroy(),this.dialogInternal=void 0,this.dialogInternal2&&(this.dialogInternal2.destroy(),this.dialogInternal2=void 0),this.dialogInternal3&&(this.dialogInternal3.destroy(),this.dialogInternal3=void 0),this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,(0,a.le)(this.touchStart)||(this.touchStart.innerHTML=""),this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,this.touchStart=void 0,(0,a.le)(this.touchEnd)||(this.touchEnd.innerHTML=""),this.touchEnd=void 0,(0,a.le)(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML=""),this.containerCanvasIn=void 0,(0,a.le)(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML=""),this.selectionCanvasIn=void 0,(0,a.le)(this.editableDiv)||(this.editableDiv.innerHTML="",(0,a.le)(this.editableDiv.parentElement)||this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,(0,a.le)(this.pageContainer)||(this.pageContainer.innerHTML=""),this.pageContainer=void 0,(0,a.le)(this.viewerContainer)||(this.viewerContainer.innerHTML=""),(0,a.le)(this.iframe)||(this.iframe.innerHTML="",this.iframe=void 0),this.viewerContainer=void 0,this.owner=void 0,this.heightInfoCollection=void 0},s.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),a.AR.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===a.AR.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),(0,a.le)(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer.bind(this)),window.removeEventListener("touchend",this.onImageResizer.bind(this))},s.prototype.updateCursor=function(e){var h,d,c,t=void 0,i=void 0,n=this.viewerContainer,r=new ce(e.offsetX,e.offsetY),o=this.owner.viewer.findFocusedPage(r,!0),l=this.getLineWidget(o),u=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,p=!!u&&u.tableResize.isInRowResizerArea(o),f=!!u&&u.tableResize.isInCellResizerArea(o),g=this.selection.checkAllFloatingElements(l,o),m="";if(this.owner.enableImageResizerMode){var v=this.owner.imageResizerModule.getImagePoint(o);this.owner.imageResizerModule.selectedResizeElement=v.selectedElement,m=v.resizePosition}var y=0,b=void 0,C=this.checkPointIsInLine(l,o);if(!(0,a.le)(l)){if(y=this.selection.getLineStartLeft(l),t=this.selection.getHyperLinkFieldInCurrentSelection(l,o),(0,a.le)(t)&&(b=this.selection.getHyperLinkFieldInCurrentSelection(l,o,!0)),!(0,a.le)(t)){var F=this.selection.getFieldCode(t);0===F.toLowerCase().indexOf("ref ")&&!F.match("\\h")&&(t=void 0)}if(h=this.selection.updateTextPositionIn(l,void 0,0,o,!0),d=this.selection.getLeft(l),c=this.selection.getTop(l),(0,a.le)(t)&&!(0,a.le)(b)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(b,l,o.x,!0):this.selection.setHyperlinkContentToToolTip(t,l,o.x,!1),b&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&b.formFieldData instanceof Re&&"Text"===b.formFieldData.type&&(b=void 0),this.owner.enableLockAndEdit){var x=!1,P=l.paragraph;P.isInsideTable&&(P=this.layout.getParentTable(P)),P.locked&&P.lockedBy!==this.owner.currentUser&&(x=!0);var E=l.paragraph.bodyWidget.sectionFormat,L=E.pageWidth-E.rightMargin-E.leftMargin;L=w.convertPointToPixel(L)*this.zoomFactor,this.viewer instanceof Se&&(L=(this.visibleBounds.width-5*this.viewer.padding.right)/this.zoomFactor),x&&o.x>=y&&o.x<y+L?this.selection.setLockInfoTooptip(l,o.x,P.lockedBy):this.selection.setLockInfoTooptip(void 0,o.x,"")}}(0,a.le)(l)||(0,a.le)(i)&&"Pages"==this.owner.layoutType&&(i=this.selection.getFootNoteElementInCurrentSelection(l,o))instanceof Ee&&this.selection.setFootnoteContentToToolTip(i,l,o.x);var W=this.isIosDevice?e.metaKey:e.ctrlKey;!(0,a.le)(t)&&(W&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||b?(0,a.le)(b)?n.style.cursor="pointer":this.isFormFillProtectedMode&&(n.style.cursor="default"):(n.style.cursor=o.x>=y&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?"text":this.selection.checkCursorIsInSelection(l,o)?"default":"text":"default",(0,a.le)(m)||""===m?!(0,a.le)(h)&&h.isImageSelected&&d<o.x&&c<o.y&&d+l.width>o.x&&c+l.height>o.y&&(n.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==m)&&(n.style.cursor=m),p?n.style.cursor="row-resize":f&&(n.style.cursor="col-resize"),g.isInShapeBorder&&!C&&(n.style.cursor="all-scroll"))},s.prototype.updateDialogTabHeight=function(e,t){var i=e.getElementsByClassName("e-dlg-header-content")[0],n=e.getElementsByClassName("e-dlg-content")[0],r=e.getElementsByClassName("e-footer-content")[0],o=getComputedStyle(n),l=getComputedStyle(e),h=parseInt(o.paddingTop,10),d=parseInt(o.paddingBottom,10),c=(isNaN(h)?0:h)+(isNaN(d)?0:d),u=parseInt(l.borderTop,10),p=parseInt(l.borderBottom,10),f=(isNaN(u)?0:u)+(isNaN(p)?0:p);t.style.height=e.offsetHeight-(i.offsetHeight+r.offsetHeight+c+f)+"px";var m=parseInt(o.paddingLeft,10),v=parseInt(o.paddingRight,10),y=(isNaN(m)?0:m)+(isNaN(v)?0:v),b=parseInt(l.borderLeft,10),C=parseInt(l.borderRight,10),F=(isNaN(b)?0:b)+(isNaN(C)?0:C);return e.offsetWidth-(y+F)},s.prototype.canRenderBorder=function(e){var n,r,o,l,t=!1,i=!1,h=e.previousRenderedWidget,d=e.nextRenderedWidget,c=this.getParagraphLeftPosition(e),u=0,p=0;return!(0,a.le)(h)&&h instanceof I&&(u=this.getParagraphLeftPosition(h)),!(0,a.le)(d)&&d instanceof I&&(p=this.getParagraphLeftPosition(d)),!(0,a.le)(h)&&h instanceof I&&c===u&&(n=e.paragraphFormat.borders.top.isEqualFormat(h.paragraphFormat.borders.top),r=e.paragraphFormat.borders.bottom.isEqualFormat(h.paragraphFormat.borders.bottom),o=e.paragraphFormat.borders.left.isEqualFormat(h.paragraphFormat.borders.left),l=e.paragraphFormat.borders.right.isEqualFormat(h.paragraphFormat.borders.right),n&&r&&o&&l&&"None"===h.paragraphFormat.borders.horizontal.lineStyle&&(t=!0)),!(0,a.le)(d)&&d instanceof I&&(c===p||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,d))&&(n=e.paragraphFormat.borders.top.isEqualFormat(d.paragraphFormat.borders.top),r=e.paragraphFormat.borders.bottom.isEqualFormat(d.paragraphFormat.borders.bottom),o=e.paragraphFormat.borders.left.isEqualFormat(d.paragraphFormat.borders.left),l=e.paragraphFormat.borders.right.isEqualFormat(d.paragraphFormat.borders.right),r&&n&&o&&l&&(i=!0)),{skipTopBorder:t,skipBottomBorder:i}},s.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=w.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&"Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},s.prototype.skipBottomBorder=function(e,t){var i=0,n=0;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,n=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,(i=e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0)==(t.paragraphFormat.leftIndent>n?t.paragraphFormat.leftIndent-n:0))},s.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,n=this.viewerContainer.scrollTop,r=e.boundingRectangle.height*this.zoomFactor;return t>=n&&t<=n+i||t+r>=n&&t+r<=n+i||t<=n&&t+r>=n+i},s}(),fi=function(){function s(e){this.visiblePages=[],this.padding=new Do(10,10,10,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerLeft=0,this.owner=e}return Object.defineProperty(s.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),s.prototype.updateClientArea=function(e,t,i){var n=0;if(this instanceof Se)(n=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(n=0),this.clientArea=new re(this.padding.left/this.documentHelper.zoomFactor,0,n,Number.POSITIVE_INFINITY),this.clientActiveArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height);else{var l=0,h=48,d=48,c=w.convertPointToPixel(e.pageHeight),u=w.convertPointToPixel(e.bottomMargin);(0,a.le)(e)||(l=w.convertPointToPixel(e.topMargin),h=w.convertPointToPixel(e.headerDistance),d=w.convertPointToPixel(e.footerDistance));var p=!1;(0,a.le)(t.headerWidget)||(!(p=t.headerWidget.isEmpty)||p&&this.owner.enableHeaderAndFooter)&&(l=Math.min(Math.max(h+t.headerWidget.height,l),c/100*40));var f=.667+u;if(!(0,a.le)(t.footerWidget)){p=t.footerWidget.isEmpty;var g=(0,a.le)(t.footnoteWidget)?0:t.footnoteWidget.height;g=Math.min(g,(c-l-f)/100*90),(!p||p&&this.owner.enableHeaderAndFooter)&&(f=.667+Math.min(c/100*40,Math.max(d+t.footerWidget.height,u))),f+=g}(0,a.le)(e)||(n=w.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin)),n<0&&(n=0),this.clientArea=new re(w.convertPointToPixel(e.leftMargin),l,n,c-l-f),t.footnoteWidget&&i&&!this.documentHelper.owner.editor.isFootNote&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y&&(this.clientArea.height-=(this.clientArea.y+this.clientArea.height-t.footnoteWidget.y)/2),this.clientActiveArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},s.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},s.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},s.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new re(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},s.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,n=e;if(t)this.clientActiveArea.x=this.clientArea.x=n.x,this.clientActiveArea.y=n.y,this.clientActiveArea.width=this.clientArea.width=n.width>0?n.width:0,this instanceof ye&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new re(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height);else{if(this.clientActiveArea.x=this.clientArea.x=n.x+n.width+n.margin.right,this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x<0?0:i.x+i.width-this.clientArea.x,this.clientActiveArea.y=n.y-n.margin.top-w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),!e.ownerTable.isInsideTable&&(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&this.documentHelper.layout.existFootnoteHeight>0)){var r=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight;this.clientActiveArea.height=r<0?0:r}this.clientArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new re(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},s.prototype.updateClientAreaForTextBoxShape=function(e,t){if("Inline"===e.textWrappingStyle&&(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t){var i=w.convertPointToPixel(e.textFrame.marginLeft),n=w.convertPointToPixel(e.textFrame.marginRight),r=w.convertPointToPixel(e.textFrame.marginTop),o=w.convertPointToPixel(e.textFrame.marginBottom);this.clientArea=new re(e.x+i,e.y+r,e.width-i-n,Number.POSITIVE_INFINITY-r-o),this.clientActiveArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},s.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},s.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new re(e.x,e.y,e.width,e.height)},s.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},s.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},s.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},s.prototype.updateClientAreaForBlock=function(e,t,i,n){var r=w.convertPointToPixel(e.leftIndent),o=w.convertPointToPixel(e.rightIndent),l=e.bidi,h=0;if(t)if(e instanceof k&&i){var d=i[0];this.clientActiveArea.x=this.clientArea.x=d.x,this.clientActiveArea.width=this.clientArea.width=d.width,(d=i[i.length-1]).x=this.clientActiveArea.x,d.y=this.clientActiveArea.y}else{if(e instanceof k&&!(0,a.le)(e.tableFormat)&&(e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==(c=this.tableAlignmentForBidi(e,l)))){var u=0;u=0===(u=w.convertPointToPixel(e.tableHolder.getTotalWidth(0)))?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:u,this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===e&&0===this.owner.editor.tableResize.resizerPosition&&(u=w.convertPointToPixel(e.tableHolder.tableWidth)),"Center"===c?(this.documentHelper.isRowOrCellResizing||(u=e.getTableCellWidth()),r=(this.clientArea.width-u)/2):r=this.clientArea.width-u,l&&(o=r-=w.convertPointToPixel(e.leftIndent)),this.documentHelper.tableLefts.push(r)}h=this.clientArea.width-(r+w.convertPointToPixel(e.rightIndent)),this.clientActiveArea.x=this.clientArea.x=this.clientArea.x+(l?o:r),this.clientActiveArea.width=this.clientArea.width=h>0?h:0,n&&this.updateParagraphYPositionBasedonTextWrap(e,new re(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))}else{if(e instanceof k&&!(0,a.le)(e.tableFormat)){var c=this.tableAlignmentForBidi(e,l);e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==c&&this.documentHelper.tableLefts.length>0&&(r=this.documentHelper.tableLefts.pop(),l&&(o=r))}h=this.clientArea.width+r+w.convertPointToPixel(e.rightIndent),this.clientActiveArea.width=this.clientArea.width=h>0?h:0,this.clientActiveArea.x=this.clientArea.x=this.clientArea.x-(l?o:r)}this.clientArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new re(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},s.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var i=e.bodyWidget,n=this.clientActiveArea;if(i&&i.floatingElements.length>0&&e instanceof I&&!(e.containerWidget instanceof be)&&!e.isInsideTable&&!(e.containerWidget instanceof Y)){var r="Word2013"===this.documentHelper.compatibilityMode,o=e,l=o.isEmpty();if(!o.isInHeaderFooter||o.isInsideTable||r){var h=t.y,d=!1;i.floatingElements.sort(function(P,E){return P.y-E.y}),i.floatingElements.sort(function(P,E){return P.x-E.x});for(var c=o.previousRenderedWidget,u=0;u<i.floatingElements.length;u++){var f,p=i.floatingElements[u];if(f=p instanceof Pe?p.paragraph.isInHeaderFooter:p.bodyWidget instanceof Ce,!(o.isInsideTable&&p instanceof k)||p.isInsideTable){var g=this.getTextWrappingBound(p),m=p instanceof k?"Square":p.textWrappingStyle,v=p instanceof k?"Both":p.textWrappingType,y=24;if(!(n.x>g.right+y||n.right<g.x-y))if((t.y+o.height>g.y||d)&&t.y<g.bottom&&"Inline"!==m&&"TopAndBottom"!==m&&"InFrontOfText"!==m&&"Behind"!==m){var b=0,C=w.convertPointToPixel(o.paragraphFormat.rightIndent),F=w.convertPointToPixel(o.paragraphFormat.firstLineIndent);if(F=!l&&o.childWidgets[0].isFirstLine()&&F>0?F:0,t.x>=g.x&&"Left"!==v&&(b=C),b=b<0?b:0,t.x<g.x&&t.x>g.x&&"Left"!==v)t.right>g.x&&(t.width=t.width-(t.right-g.right)),t.width<y?((r||!(p instanceof k&&c===p))&&(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!l&&o.childWidgets[0].isFirstLine()||l)&&r||!f)&&(o.y=this.clientActiveArea.y)):t.x=g.right;else if(t.x>=g.x&&t.x<g.right)if(t.width=t.width-(g.right-t.x)-b,t.width<y||d){t.width=this.clientActiveArea.right-g.right-b;var T=!1;if(t.width<y||d){if(this.clientActiveArea.x+y<g.x){var x=this.getIntersectingItemBounds(i.floatingElements,p,h);!(0,a.le)(x)&&x.bottom<=g.bottom&&(this.updateBoundsBasedOnTextWrap(x.bottom),t=this.clientActiveArea,T=!0,o.x=x.x)}r&&!T&&(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!l&&o.childWidgets[0].isFirstLine()||l)&&r||!f)&&(o.y=this.clientActiveArea.y)}else t.x=g.right}else t.x=g.right;else g.x>t.x&&t.right>g.x&&(t.width=g.x-t.x,t.width<y&&(t.width=this.clientActiveArea.right-g.right-b,t.width<y?((r||!(p instanceof k&&c===p))&&(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!l&&o.childWidgets[0].isFirstLine()||l)&&r||!f)&&(o.y=this.clientActiveArea.y)):t.x=g.right))}else i.floatingElements.length>0&&(t.y>=g.y&&t.y<g.bottom||t.y+o.height>=g.y&&t.y+o.height<g.bottom)&&"TopAndBottom"===m&&((r||!(p instanceof k&&c===p))&&(this.updateBoundsBasedOnTextWrap(g.bottom),!r&&(!l&&o.childWidgets[0].isFirstLine()||l)&&(d=!0)),((!l&&o.childWidgets[0].isFirstLine()||l)&&r||!f)&&(o.y=this.clientActiveArea.y))}}}}},s.prototype.getIntersectingItemBounds=function(e,t,i){var n=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,i));if(!(0,a.le)(n))return this.getTextWrappingBound(n)},s.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,n=Number.MAX_VALUE,r=0;e.sort(function(d,c){return d.x-c.x});for(var o=0;o<t.length;o++){var l=e[o],h=this.getTextWrappingBound(l);n>h.bottom&&(l&&t.indexOf(l)+1<t.length?r++:(n=h.bottom,i=t.indexOf(l)))}return i-r==0?t[i]:null},s.prototype.getIntersectingFloatingItems=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var o=e[r],l=this.getTextWrappingBound(o),h=this.getTextWrappingBound(t);i<=l.bottom&&h.bottom>=l.bottom&&l.right>this.clientActiveArea.x&&l.x<h.x&&n.push(o)}return n},s.prototype.getTextWrappingBound=function(e){var t=0,i=0,n=0,r=0,o=0;return e instanceof Pe?(t=e.distanceLeft,i=e.distanceTop,n=e.distanceRight,r=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,n=e.positioning.distanceRight,r=e.positioning.distanceBottom),new re(e.x-t,e.y-i,o+t+n,e.height+i+r)},s.prototype.tableAlignmentForBidi=function(e,t){var i=e.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},s.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},s.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},s.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},s.prototype.findFocusedPage=function(e,t,i){var n=new ce(e.x,e.y);n.x+=this.documentHelper.viewerContainer.scrollLeft,n.y+=this.documentHelper.viewerContainer.scrollTop;for(var r=0;r<this.documentHelper.pages.length;r++){var c,o=this.documentHelper.pages[r],l=(o.boundingRectangle.y-this.pageGap*(r+1))*this.documentHelper.zoomFactor+this.pageGap*(r+1),d=o.boundingRectangle.x;if(c=this instanceof ye?(o.boundingRectangle.right-d)*this.documentHelper.zoomFactor+d:o.boundingRectangle.right+d,l<=n.y&&l+(o.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap)>=n.y)return t&&(this.documentHelper.currentPage=o,i&&((0,a.le)(o.headerWidget)||(o.headerWidget.page=o),(0,a.le)(o.footerWidget)||(o.footerWidget.page=o))),n.y=(n.y-l)/this.documentHelper.zoomFactor,n.x=n.x>c?o.boundingRectangle.right:n.x<d?0:(n.x-d)/this.documentHelper.zoomFactor,n}return n},s.prototype.getPageHeightAndWidth=function(e,t,i,n){e=0;for(var r=0;r<this.documentHelper.pages.length;r++)e+=this.documentHelper.pages[r].boundingRectangle.height;for(t=0,r=0;r<this.documentHelper.pages.length;r++)t<this.documentHelper.pages[r].boundingRectangle.width&&(t=this.documentHelper.pages[r].boundingRectangle.width);return{height:e,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},s.prototype.renderVisiblePages=function(){if(!((0,a.le)(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e];this.owner.viewer.renderPage(t,t.boundingRectangle.x,(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),t.boundingRectangle.width*this.documentHelper.zoomFactor,t.boundingRectangle.height*this.documentHelper.zoomFactor)}}},s.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,i=0,n=!1;if(this.documentHelper.selection&&(0,a.le)(this.documentHelper.zoomX&&(0,a.le)(this.documentHelper.zoomY))){var r=0,o=0,l=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);(r=(this.documentHelper.visibleBounds.width-l.boundingRectangle.width*e)/2)<30&&(r=30),o=l.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(l)+1)*this.pageGap*(1-e);var h=this.documentHelper.selection.updateCaretSize(this.owner.selection.end,!0);o+=(this.documentHelper.selection.end.location.y+h.topMargin)*e,(r+=this.documentHelper.selection.end.location.x*e)>=this.containerLeft&&r<=this.documentHelper.visibleBounds.width&&o>=this.containerTop&&o<=this.containerTop+this.documentHelper.visibleBounds.height&&(n=!0)}for(var u=0;u<this.documentHelper.pages.length;u++)i+=this.documentHelper.pages[u].boundingRectangle.height;var p=0;for(u=0;u<this.documentHelper.pages.length;u++)p<this.documentHelper.pages[u].boundingRectangle.width&&(p=this.documentHelper.pages[u].boundingRectangle.width);var g=p*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-p*this.documentHelper.zoomFactor<60&&(g+=60),i*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height>0){var m=this.containerTop;if(this.visiblePages.length>0){var v=((t=this.visiblePages[0]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,y=this.documentHelper.zoomY;a.le&&(y=this.documentHelper.visibleBounds.height/2);for(var b=m+y;b>v+t.boundingRectangle.height*e;){var C=t.index+1;if(C===this.documentHelper.pages.length)break;v=((t=this.documentHelper.pages[C]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}m=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(b-v<0?b-v:this.documentHelper.zoomFactor/e*(b-v))-y,y=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=m}else this.documentHelper.viewerContainer.scrollTop=0;if(g>0){if(m=this.containerLeft,this.visiblePages.length>0){null===t&&(t=this.visiblePages[0]);var T=this.documentHelper.zoomX;(0,a.le)(T)&&(T=this.documentHelper.visibleBounds.width/2);var P=m+T;m=t.boundingRectangle.x+(P-t.boundingRectangle.x<0?P-t.boundingRectangle.x:this.documentHelper.zoomFactor/(t.boundingRectangle.width*e/t.boundingRectangle.width)*(P-t.boundingRectangle.x))-T,T=this.documentHelper.visibleBounds.width/2}this.documentHelper.viewerContainer.scrollLeft=m}else this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars(),n&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof Se&&this.owner.editorModule.layoutWholeDocument()},s.prototype.updateCanvasWidthAndHeight=function(e,t,i,n,r,o){this instanceof ye?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(e-=this.documentHelper.scrollbarWidth,n-=this.documentHelper.scrollbarWidth),n>e&&(t-=this.documentHelper.scrollbarWidth),r=n>e?n:e,o=i>t?i:t,(parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)!==r||parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)!==r)&&(this.documentHelper.pageContainer.style.width=r.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var l=Math.max(1,window.devicePixelRatio||1);return(this.documentHelper.containerCanvas.width!==Math.floor(e*l)||this.documentHelper.containerCanvas.height!==Math.floor(t*l))&&(this.documentHelper.containerCanvas.width=e*l,this.documentHelper.containerCanvas.height=t*l,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(l,l),this.documentHelper.selectionCanvas.width=e*l,this.documentHelper.selectionCanvas.height=t*l,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(l,l)),{height:o,width:r,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:n}},s.prototype.updateScrollBarPosition=function(e,t,i,n,r,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},s.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},s}(),ye=function(s){function e(t){var i=s.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return On(e,s),Object.defineProperty(e.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.createNewPage=function(t,i){var r=this.pageGap;this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap);var o=new yi(this.documentHelper);return this.updatePageBoundingRectangle(t,o,r),(0,a.le)(i)?this.documentHelper.pages.push(o):this.documentHelper.pages.splice(i,0,o),this.updateClientArea(t.sectionFormat,o),o.bodyWidgets.push(t),o.bodyWidgets[o.bodyWidgets.length-1].page=o,this.documentHelper.layout.layoutHeaderFooter(t,this,o),this.updateClientArea(t.sectionFormat,o),this.documentHelper.layout.footnoteHeight=0,o},e.prototype.updatePageBoundingRectangle=function(t,i,n){var r=(0,a.le)(t.sectionFormat)?816:w.convertPointToPixel(t.sectionFormat.pageWidth),o=(0,a.le)(t.sectionFormat)?1056:w.convertPointToPixel(t.sectionFormat.pageHeight),l=(this.documentHelper.visibleBounds.width-r*this.documentHelper.zoomFactor)/2;l<this.pageLeft&&(l=this.pageLeft),i.boundingRectangle=new re(l,n,r,o)},e.prototype.onPageFitTypeChanged=function(t){var i=this.documentHelper.visibleBounds.width,n=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],o=w.convertPointToPixel(r.sectionFormat.pageWidth),l=w.convertPointToPixel(r.sectionFormat.pageHeight);switch(t){case"FitOnePage":if(n>0&&l>0){var h=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/l;h===this.documentHelper.zoomFactor?!(0,a.le)(this.owner.selection)&&!(0,a.le)(this.owner.selection.start)&&!(0,a.le)(this.owner.selection.end)&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.documentHelper.zoomFactor=h}break;case"FitPageWidth":i>0&&o>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/o);break;default:this.documentHelper.zoomFactor=1}},e.prototype.getCurrentPageHeaderFooter=function(t,i){return this.getCurrentHeaderFooter(this.getHeaderFooterType(t,i),t.index)},e.prototype.getHeaderFooterType=function(t,i){var n;n=i?"OddHeader":"OddFooter";var r=t.page;return t.sectionFormat.differentFirstPage&&((0,a.le)(r.previousPage)||r.sectionIndex!==r.previousPage.sectionIndex)?n=i?"FirstPageHeader":"FirstPageFooter":t.sectionFormat.differentOddAndEvenPages&&this.documentHelper.pages.length%2==0&&(n=i?"EvenHeader":"EvenFooter"),n},e.prototype.getCurrentHeaderFooter=function(t,i){if(this.documentHelper.headersFooters[i]){var n=this.getHeaderFooter(t),r=this.documentHelper.headersFooters[i][n];if(!r){for(var o=i>0?i-1:i;!r&&-1!==o&&this.documentHelper.headersFooters[o][n];)r=this.documentHelper.headersFooters[o][n],o--;r||((r=this.createHeaderFooterWidget(t)).isEmpty=!0),this.documentHelper.headersFooters[i][n]=r}return r}if(i>0)return this.getCurrentHeaderFooter(t,i-1)},e.prototype.createHeaderFooterWidget=function(t){var i=new Ce(t),n=new I;return n.childWidgets.push(new oe(n)),i},e.prototype.getHeaderFooter=function(t){switch(t){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},e.prototype.updateHFClientArea=function(t,i){var n=w.convertPointToPixel(t.pageWidth-t.leftMargin-t.rightMargin);n<0&&(n=0),this.clientArea=new re(w.convertPointToPixel(t.leftMargin),w.convertPointToPixel(i?t.headerDistance:t.pageHeight-t.footerDistance),n,Number.POSITIVE_INFINITY),this.clientActiveArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},e.prototype.updateHeaderFooterClientAreaWithTop=function(t,i,n){this.updateHFClientArea(t,i),i||n.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=n.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},e.prototype.updateFootnoteClientArea=function(t,i,n,r){var o=w.convertPointToPixel(t.pageWidth-t.leftMargin-t.rightMargin),l=w.convertPointToPixel(t.leftMargin),h=w.convertPointToPixel(t.bottomMargin),d=w.convertPointToPixel(t.footerDistance),c=w.convertPointToPixel(t.pageHeight)-Math.max(d+i.page.footerWidget.height,h);this.clientArea=new re(l,c,o,Number.POSITIVE_INFINITY),this.clientActiveArea=new re(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},e.prototype.scrollToPage=function(t){for(var i=0,n=0;n<this.documentHelper.pages.length&&(i=this.documentHelper.pages[n].boundingRectangle.y-this.pageGap/2,n!==t);n++);this.documentHelper.viewerContainer.scrollTop=i,this.updateScrollBars()},e.prototype.updateScrollBars=function(){var t,r,i=(t=this.getPageHeightAndWidth(0,0,0,0)).width*this.documentHelper.zoomFactor+2*this.pageLeft,n=t.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap;n=(r=this.updateCanvasWidthAndHeight(t.viewerWidth,t.viewerHeight,n,i,t.width,t.height)).containerHeight,i=r.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var o=0;o<this.documentHelper.pages.length;o++){var l=(r.width-this.documentHelper.pages[o].boundingRectangle.width*this.documentHelper.zoomFactor)/2;this.documentHelper.pages[o].boundingRectangle=new re(l>this.pageLeft?l:this.pageLeft,this.documentHelper.pages[o].boundingRectangle.y,this.documentHelper.pages[o].boundingRectangle.width,this.documentHelper.pages[o].boundingRectangle.height)}this.updateScrollBarPosition(i,n,r.viewerWidth,r.viewerHeight,r.width,r.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},e.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t],n=(i.boundingRectangle.y-this.pageGap*(t+1))*this.documentHelper.zoomFactor+this.pageGap*(t+1),r=i.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(i,n)&&this.addVisiblePage(i,r,n)}},e.prototype.addVisiblePage=function(t,i,n){var r=this,o=t.boundingRectangle.width*this.documentHelper.zoomFactor,l=t.boundingRectangle.height*this.documentHelper.zoomFactor;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===t&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(i,n,o,l),this.visiblePages.push(t),this.owner.isSpellCheck&&this.owner.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading||this.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(t.index)<0){this.documentHelper.cachedPages.push(t.index);var h=this.owner.spellChecker.getPageContent(t);h.trim().length>0?(t.allowNextPageRendering=!1,this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,h,!0,!1,!1,!0).then(function(d){var c=JSON.parse(d);!(0,a.le)(r.owner)&&!(0,a.le)(r.owner.spellChecker)&&r.owner.spellChecker.updateUniqueWords(c.SpellCollection),t.allowNextPageRendering=!0,r.documentHelper.triggerSpellCheck=!0,r.renderPage(t,i,n,o,l),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1})):this.renderPage(t,i,n,o,l)}else this.renderPage(t,i,n,o,l)},e.prototype.renderPage=function(t,i,n,r,o){this.documentHelper.render.renderWidgets(t,i-this.owner.viewer.containerLeft,n-this.owner.viewer.containerTop,r,o)},e}(fi),Se=function(s){function e(t){var i=s.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return On(e,s),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.createNewPage=function(t,i){var n,r=0;return this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),(n=new yi(this.documentHelper)).boundingRectangle=new re(10,0===this.documentHelper.pages.length?r:r-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(n),this.updateClientArea(void 0,n),n.bodyWidgets.push(t),n.bodyWidgets[n.bodyWidgets.length-1].page=n,n},e.prototype.onPageFitTypeChanged=function(t){this.documentHelper.zoomFactor=1},e.prototype.scrollToPage=function(t){this.updateScrollBars()},e.prototype.getContentHeight=function(){for(var t=0,i=0;i<this.documentHelper.pages.length;i++){var n=this.documentHelper.pages[i];0===i?(t+=this.padding.top,n.boundingRectangle.y=this.padding.top):n.boundingRectangle.y=this.documentHelper.pages[i-1].boundingRectangle.bottom,n.boundingRectangle.height=n.bodyWidgets[0].height,t+=n.bodyWidgets[0].height,i===this.documentHelper.pages.length-1&&(t+=this.padding.bottom)}return t},e.prototype.getContentWidth=function(){for(var t=this.documentHelper.visibleBounds.width,i=t,n=0;n<this.documentHelper.pages.length;n++){for(var r=this.documentHelper.pages[n],o=0;o<r.bodyWidgets[0].childWidgets.length;o++)if(r.bodyWidgets[0].childWidgets[o]instanceof k){var h=w.convertPointToPixel(r.bodyWidgets[0].childWidgets[o].getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+r.boundingRectangle.x;i<h&&(t=h,i=h)}r.boundingRectangle.width=t}return t},e.prototype.updateScrollBars=function(){var t;t=this.getPageHeightAndWidth(0,0,0,0);var r,i=this.getContentWidth()*this.documentHelper.zoomFactor+this.padding.left+this.padding.right,n=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;r=this.updateCanvasWidthAndHeight(t.viewerWidth,t.viewerHeight,n,i,t.width,t.height),this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(i,n,r.viewerWidth,r.viewerHeight,r.width,r.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},e.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var t,i,n=this.documentHelper.visibleBounds.height,r=this.documentHelper.viewerContainer.scrollTop,o=0;o<this.documentHelper.pages.length;o++){var l=(t=this.documentHelper.pages[o]).boundingRectangle.height*this.documentHelper.zoomFactor;((i=t.boundingRectangle.y*this.documentHelper.zoomFactor)>=r&&i<=r+n||i+l>=r&&i+l<=r+n||i<=r&&i+l>=r+n)&&this.addVisiblePage(t,this.padding.left,i)}},e.prototype.addVisiblePage=function(t,i,n){var r=this,o=this.getContentWidth(),l=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===t&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(i,n,o,l),this.visiblePages.push(t),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(t.index)<0){this.owner.documentHelper.cachedPages.push(t.index);var h=this.documentHelper.owner.spellChecker.getPageContent(t);h.trim().length>0?(t.allowNextPageRendering=!1,this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,h,!0,!1,!1,!0).then(function(d){var c=JSON.parse(d);!(0,a.le)(r.owner)&&!(0,a.le)(r.owner.spellChecker)&&r.owner.spellChecker.updateUniqueWords(c.SpellCollection),t.allowNextPageRendering=!0,r.owner.documentHelper.triggerSpellCheck=!0,r.renderPage(t,i,n,o,l),r.owner.documentHelper.triggerSpellCheck=!1,r.owner.documentHelper.triggerElementsOnLoading=!1})):this.renderPage(t,i,n,o,l)}else this.renderPage(t,i,n,o,l)},e.prototype.renderPage=function(t,i,n,r,o){this.documentHelper.render.renderWidgets(t,i-this.owner.viewer.containerLeft,n-this.owner.viewer.containerTop,r,o)},e}(fi),Le=function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),re=function(){function s(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(s.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),s.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height)},s}(),Do=function(){return function(e,t,i,n){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=n}}(),$e=function(){function s(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n}return s.prototype.clone=function(){return new s(this.left,this.top,this.right,this.bottom)},s.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},s}(),Ze=function(){function s(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(s.prototype,"indexInOwner",{get:function(){return this instanceof j&&this.page?this.containerWidget instanceof Y?this.containerWidget.bodyWidgets.indexOf(this):this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof Y?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e instanceof j?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e instanceof j?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof j)if(t>0&&!(e.containerWidget instanceof Y))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof Y&&!e.page.documentHelper.owner.editor.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else e=(i=e.page.previousPage)&&i.bodyWidgets.length>0?i.bodyWidgets[i.bodyWidgets.length-1]:void 0;else if(e instanceof Y)for(var i=e.page;i.previousPage&&(0,a.le)(e=(i=i.previousPage).footnoteWidget););else if(t>0)e=e.containerWidget.childWidgets[t-1];else{var n=void 0;for(e.containerWidget instanceof V?n=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof Y&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.previousWidget?e.containerWidget.previousWidget:e.containerWidget.previousRenderedWidget:e.containerWidget instanceof Q||e.containerWidget instanceof Ce||e.containerWidget&&e.containerWidget.containerWidget instanceof Y||(n=e.containerWidget.previousRenderedWidget);n&&0===n.childWidgets.length&&!(0,a.le)(n=n.previousRenderedWidget););e=n&&n.constructor===e.containerWidget.constructor?n.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof j)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof Y))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof Y){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editor.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else e=e.page.allowNextPageRendering&&(i=e.page.nextPage)&&i.bodyWidgets.length>0?i.bodyWidgets[0]:void 0;else if(e instanceof Y)for(var i=e.page;i.allowNextPageRendering&&i.nextPage&&(0,a.le)(e=(i=i.nextPage).footnoteWidget););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var n=void 0;for(e.containerWidget instanceof V?n=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof Y&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.nextWidget?e.containerWidget.nextWidget:e.containerWidget.nextRenderedWidget:e.containerWidget instanceof Q||e.containerWidget instanceof Ce||e.containerWidget&&e.containerWidget.containerWidget instanceof Y||(n=e.containerWidget.nextRenderedWidget);n&&0===n.childWidgets.length&&!(n instanceof V)&&!(0,a.le)(n=n.nextRenderedWidget););e=n&&n.constructor===e.containerWidget.constructor?n.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousSplitWidget",{get:function(){var e=this;if(e instanceof V)return e.getPreviousSplitWidget();var t=e.previousRenderedWidget;return e instanceof j&&t instanceof j&&e.equals(t)||t instanceof Ve&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextSplitWidget",{get:function(){var e=this;if(e instanceof V)return e.getNextSplitWidget();var t=e.nextRenderedWidget;return e instanceof j&&t instanceof j&&e.equals(t)||t instanceof Ve&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),s.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t;)e.unshift(t),t=t.previousSplitWidget;return e},s.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},s.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var n=i.shift();t.combine(n,e)}return t instanceof k&&t.combineRows(e),t},s.prototype.combine=function(e,t){if(e.childWidgets.length>0){var i=this.lastChild;if(i instanceof k)i.combineWidget(t);else{var n=e.firstChild;!(e instanceof k)&&i instanceof s&&n instanceof s&&i.index===n.index&&i.combine(e.childWidgets.shift(),t)}this.addWidgets(e.childWidgets),e.childWidgets=[]}e.destroyInternal(t)},s.prototype.addWidgets=function(e){for(;e.length>0;){var t=e.shift();if(t instanceof oe&&this instanceof I)t.paragraph=this,this.height+=t.height;else if(t instanceof s){var i=this.lastChild;t.containerWidget=this,t.y=i instanceof s?i.y+i.height:this.y,this.height+=t.height}this.childWidgets.push(t)}},s.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},s.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var e=this.childWidgets.pop();(e instanceof oe||e instanceof s)&&e.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},s}(),Ye=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.floatingElements=[],t.footNoteReference=void 0,t.sectionFormatIn=void 0,t}return Le(e,s),Object.defineProperty(e.prototype,"sectionFormat",{get:function(){var t=this;return t instanceof j?t.sectionFormatIn:t.page&&!(0,a.le)(t.page.bodyWidgets)?t.page.bodyWidgets[0].sectionFormat:void 0},set:function(t){this instanceof j&&(this.sectionFormatIn=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){var t=this,i=0;return t instanceof j?i=t.index:t.page&&(i=t.page.bodyWidgets[0].index),i},enumerable:!0,configurable:!0}),e.prototype.getHierarchicalIndex=function(t){var n=this;return t=n instanceof j?n.index+";"+t:n instanceof Y?"Footnote"===n.footNoteType?"FN;"+t:"EN;"+t:-1!==n.headerFooterType.indexOf("Header")?"H;"+t:"F;"+t,(0,a.le)(n.page)?t:this.page.documentHelper.pages.indexOf(this.page)+";"+t},e}(Ze),j=function(s){function e(){return s.call(this)||this}return Le(e,s),e.prototype.equals=function(t){return t instanceof e&&t.sectionFormat===this.sectionFormat},e.prototype.getHierarchicalIndex=function(t){var n=this;return n.containerWidget instanceof Y?(t=n.containerWidget.bodyWidgets.indexOf(n)+";"+t,t="Footnote"===n.containerWidget.footNoteType?"FN;"+t:"EN;"+t):t=n.index+";"+t,(0,a.le)(n.page)?t:this.page.documentHelper.pages.indexOf(this.page)+";"+t},e.prototype.getTableCellWidget=function(t){for(var i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i]instanceof k){var n=this.childWidgets[i],r=0;if(n.wrapTextAround&&(r=n.getTableCellWidth()),!n.wrapTextAround&&n.y<=t.y&&n.y+n.height>=t.y||n.wrapTextAround&&n.x<=t.x&&n.x+r>=t.x&&n.y<=t.y&&n.y+n.height>=t.y)return n.getTableCellWidget(t)}var o=void 0;return this.childWidgets.length>0&&(o=this.childWidgets[0].y<=t.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(t):this.childWidgets[0].getTableCellWidget(t)),o},e.prototype.destroyInternal=function(t){if(!(0,a.le)(this.childWidgets)){for(var n=0;n<this.childWidgets.length;n++){if(this.childWidgets[n].destroyInternal(t),(0,a.le)(this.childWidgets))break;n--}this.childWidgets=void 0}(0,a.le)(this.page)||this.indexInOwner>-1&&(this.page.bodyWidgets.splice(this.indexInOwner,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof Ce&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof Ce&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0),this.destroy()},e.prototype.destroy=function(){this.sectionFormat=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,s.prototype.destroy.call(this)},e}(Ye),Ce=function(s){function e(t){var i=s.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return Le(e,s),e.prototype.getTableCellWidget=function(t){for(var i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i]instanceof k){var n=this.childWidgets[i],r=0;if(n.wrapTextAround&&(r=n.getTableCellWidth()),!n.wrapTextAround&&n.y<=t.y&&n.y+n.height>=t.y||n.wrapTextAround&&n.x<=t.x&&n.x+r>=t.x&&n.y<=t.y&&n.y+n.height>=t.y)return n.getTableCellWidget(t)}var o=void 0;return this.childWidgets.length>0&&(o=this.childWidgets[0].y<=t.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(t):this.childWidgets[0].getTableCellWidget(t)),o},e.prototype.equals=function(t){return t instanceof e&&t.containerWidget===this.containerWidget},e.prototype.clone=function(){for(var t=new e(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.index=i,n.containerWidget=t}return t.isEmpty=this.isEmpty,t.x=this.x,t.y=this.y,t.height=0,t.width=0,t},e.prototype.destroyInternal=function(t){this.page=void 0,s.prototype.destroy.call(this)},e}(Ye),Ve=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.isLayouted=!1,t.locked=!1,t.lockedBy="",t}return Le(e,s),Object.defineProperty(e.prototype,"bodyWidget",{get:function(){for(var t=this;t.containerWidget;){if(t.containerWidget instanceof be){var i=t.containerWidget.containerShape.line.paragraph;if(i)return i.bodyWidget}else if(t.containerWidget instanceof Ye)return t.containerWidget;t=t.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){var t=this;return t instanceof I&&t.paragraphFormat instanceof ue?t.paragraphFormat.leftIndent:t instanceof k&&t.tableFormat instanceof Oe?t.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){var t=this;return t instanceof I&&t.paragraphFormat instanceof ue?t.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof V},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof Ce},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof V)return this.containerWidget},enumerable:!0,configurable:!0}),e.prototype.isPageBreak=function(){var t=!1;if(this instanceof I){var i=this;null!=i&&1===i.childWidgets.length&&1===i.firstChild.children.length&&(t=i.firstChild.children[0].isPageBreak)}return t},e.prototype.getHierarchicalIndex=function(t){var i=this;if(t=i.containerWidget.childWidgets.indexOf(i)+";"+t,!(0,a.le)(i.containerWidget)){if(i.containerWidget instanceof be)return i.containerWidget.getHierarchicalIndex(t);if(i.containerWidget instanceof e)return i.containerWidget.getHierarchicalIndex(t);i.containerWidget instanceof Ye&&(t=i.containerWidget.getHierarchicalIndex(t))}return t},e.prototype.getIndex=function(){return this instanceof I||this instanceof k?this.containerWidget.childWidgets.indexOf(this):this instanceof Q?this.ownerTable.childWidgets.indexOf(this):this instanceof V?this.ownerRow.childWidgets.indexOf(this):0},e.prototype.getContainerWidth=function(){if(this.isInsideTable){if(this instanceof k&&"Auto"===this.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var i=0,n=this.associatedCell.cellFormat.columnSpan,r=this.associatedCell.columnIndex,o=0;o<n;o++)i+=this.associatedCell.ownerTable.tableHolder.columns[r].preferredWidth,r++;if(i>0)return i}return this.associatedCell.getCellWidth(this)}if(this.containerWidget instanceof be){var l=this.containerWidget.containerShape;return w.convertPixelToPoint(l.width)-w.convertPixelToPoint(l.textFrame.marginLeft)-w.convertPixelToPoint(l.textFrame.marginRight)}var h=this.bodyWidget,d=h.sectionFormat,c=0;if(!(0,a.le)(h.page)&&!(0,a.le)(h.page.documentHelper)&&"Word2013"!==h.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof k){var u=this.firstChild;c=u.firstChild.leftMargin+u.lastChild.rightMargin}return d.pageWidth-(d.leftMargin+d.rightMargin)+c},Object.defineProperty(e.prototype,"bidi",{get:function(){return this instanceof I&&this.paragraphFormat instanceof ue?this.paragraphFormat.bidi:this instanceof k&&this.tableFormat instanceof Oe&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),e}(Ze),Y=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.bodyWidgets=[],t}return Le(e,s),e.prototype.getMinimumAndMaximumWordWidth=function(t,i){throw new Error("Method not implemented.")},e.prototype.getTableCellWidget=function(t){},e.prototype.equals=function(t){return t instanceof e&&t.containerWidget===this.containerWidget},e.prototype.clone=function(){for(var t=new e,i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.index=i,n.containerWidget=t}return t.block=this.block,t},e.prototype.destroyInternal=function(t){this.block=void 0,s.prototype.destroy.call(this)},e}(Ye),I=function(s){function e(){var t=s.call(this)||this;return t.isChangeDetected=!1,t.clientX=void 0,t.floatingElements=[],t.paragraphFormat=new ue(t),t.characterFormat=new ie(t),t}return Le(e,s),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&t.paragraphFormat===this.paragraphFormat},e.prototype.isContainsShapeAlone=function(){for(var t=!1,i=0;i<this.childWidgets.length;i++)for(var n=this.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];if(!(o instanceof Pe)||o instanceof Pe&&"Inline"===o.textWrappingStyle)return!1;t=!0}return!!t},e.prototype.isEmpty=function(){if((0,a.le)(this.childWidgets)||0===this.childWidgets.length)return!0;for(var t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(0!==r.length&&(r instanceof S||r instanceof ee||r instanceof O||r instanceof He||r instanceof xe||r instanceof _t||r instanceof de||r instanceof $||r instanceof H&&w.isLinkedFieldCharacter(r)))return!1}return!0},e.prototype.getInline=function(t,i){for(var n=void 0,r=0,o=!1,l=this.getSplitWidgets(),h=0;h<l.length;h++)for(var d=l[h],c=0;c<d.childWidgets.length;c++)for(var u=d.childWidgets[c],p=0;p<u.children.length;p++)if(!((n=u.children[p])instanceof _)){if((!o&&(n instanceof S||n instanceof ee||n instanceof de||n instanceof O||n instanceof H&&w.isLinkedFieldCharacter(n))||n instanceof _t)&&(o=!0),o&&t<=r+n.length)return{element:n,index:i=t-r};r+=n.length}return t>r&&(i=(0,a.le)(n)?t:n.length),{element:n,index:i}},e.prototype.getLength=function(){for(var t=0,i=0;i<this.childWidgets.length;i++)for(var n=this.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];o instanceof _||(t+=o.length)}return t},e.prototype.getTableCellWidget=function(t){},e.prototype.getMinimumAndMaximumWordWidth=function(t,i){if(t=w.convertPointToPixel(t),i=w.convertPointToPixel(i),this.childWidgets.length>0){for(var n=this.childWidgets[0].children[0],r="",o=new U,l=[];;){if(n instanceof S&&""!==n.text)o.add(n,r.length),r+=n.text;else if(n instanceof H&&0===n.fieldType){var h=n;(0,a.le)(h.fieldEnd)||(n=(0,a.le)(h.fieldSeparator)?h.fieldEnd:h.fieldSeparator)}else n instanceof ee&&l.push(n.width);if((0,a.le)(n)||(0,a.le)(n.nextNode))break;n=n.nextNode}for(var d=new RegExp("\\b\\w+\\b","g"),c=[],u=void 0;!(0,a.le)(u=d.exec(r));)c.push(u);for(var p=0;p<c.length;p++){var f=c[p],g=0;r="";for(var m="",v=0,y=f.index,b=f.index,C=0;C<o.keys.length;C++){var F=o.keys[C],T=o.get(F),x=F.length;if(b<=T+x&&(v=b-T,f.index+f[0].length<=T+x?y=f.index+f[0].length-(T+v):b+=y=x-v,m+=r=F.text.substring(v,v+y)),""!==r&&(g+=this.bodyWidget.page.documentHelper.textHelper.getWidth(r,F.characterFormat)),m===f[0])break}0!==g&&(0===t||g>t)&&(t=g)}var P=0;l.length>0&&(P=Math.max.apply(null,l)),(0===t||P>t)&&(t=P);var E=this.measureParagraph();(0===i||E>i)&&(i=E)}return{maximumWordWidth:w.convertPixelToPoint(i),minimumWordWidth:w.convertPixelToPoint(t)}},e.prototype.measureParagraph=function(){for(var t=0,i=this.childWidgets[0].children[0];;){if(i instanceof S&&""!==i.text)t+=this.bodyWidget.page.documentHelper.textHelper.getWidth(i.text,i.characterFormat);else if(i instanceof H&&0===i.fieldType){var n=i;null!=n.fieldEnd&&(i=(0,a.le)(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator)}else i instanceof ee&&(t+=i.width);if((0,a.le)(i)||(0,a.le)(i.nextNode))break;i=i.nextNode}return this.leftIndent>0&&(t+=this.leftIndent),this.rightIndent>0&&(t+=this.rightIndent),t},e.prototype.isArabicChar=function(t){return t>=String.fromCharCode(1536)&&t<=String.fromCharCode(1791)||t>=String.fromCharCode(1872)&&t<=String.fromCharCode(1919)||t>=String.fromCharCode(2208)&&t<=String.fromCharCode(2303)||t>=String.fromCharCode(64336)&&t<=String.fromCharCode(65023)||t>=String.fromCharCode(65136)&&t<=String.fromCharCode(65279)},e.prototype.isHebrewChar=function(t){return t>=String.fromCharCode(1424)&&t<=String.fromCharCode(1535)||t>=String.fromCharCode(64285)&&t<=String.fromCharCode(64335)},e.prototype.isHindiChar=function(t){return t>=String.fromCharCode(2304)&&t<=String.fromCharCode(2431)||t>=String.fromCharCode(43232)&&t<=String.fromCharCode(43263)||t>=String.fromCharCode(7376)&&t<=String.fromCharCode(7423)},e.prototype.isKoreanChar=function(t){return t>=String.fromCharCode(44032)&&t<=String.fromCharCode(55203)||t>=String.fromCharCode(4352)&&t<=String.fromCharCode(4607)||t>=String.fromCharCode(12592)&&t<=String.fromCharCode(12687)||t>=String.fromCharCode(43360)&&t<=String.fromCharCode(43391)||t>=String.fromCharCode(55216)&&t<=String.fromCharCode(55295)||t>=String.fromCharCode(44032)&&t<=String.fromCharCode(55215)},e.prototype.isJapanese=function(t){return t>=String.fromCharCode(12448)&&t<=String.fromCharCode(12543)||t>=String.fromCharCode(12352)&&t<=String.fromCharCode(12447)},e.prototype.isChineseChar=function(t){return t>=String.fromCharCode(19968)&&t<=String.fromCharCode(40959)||t>=String.fromCharCode(13312)&&t<=String.fromCharCode(19903)||t>=String.fromCharCode(55360)&&t<=String.fromCharCode(55401)||t>=String.fromCharCode(56320)&&t<=String.fromCharCode(57055)||t>=String.fromCharCode(43360)&&t<=String.fromCharCode(43391)||t>=String.fromCharCode(65280)&&t<=String.fromCharCode(65519)||t>=String.fromCharCode(12288)&&t<=String.fromCharCode(12351)},e.prototype.getFontScriptType=function(t){return this.isHindiChar(t)?Qe.Hindi:this.isKoreanChar(t)?Qe.Korean:this.isJapanese(t)?Qe.Japanese:this.isChineseChar(t)?Qe.Chinese:this.isArabicChar(t)?Qe.Arabic:this.isHebrewChar(t)?Qe.Hebrew:Qe.English},e.prototype.splitTextByFontScriptType=function(t,i){var n=[];if((0,a.le)(t)||!(0,a.le)(t)&&""===t)return n;for(var r="",o=Qe.English,l=Qe.English,h=0;h<t.length;h++)t[h]!=String.fromCharCode(32)&&(l=this.getFontScriptType(t[h])),""!=r&&l!==o&&(n.push(r),i.push(o),r=""),r+=t[h],o=l;return""!=r&&(n.push(r),i.push(l),r=""),n},e.prototype.splitTextRangeByScriptType=function(t){var i=!1,n=1;if(this.childWidgets.length>0){for(var r=this.childWidgets[t],o=t+1;o<this.childWidgets.length;o++){for(var l=this.childWidgets[o],h=0;h<l.children.length;h++){var d=l.children[h];r.children.push(d),d.line=r}this.childWidgets.splice(o,1),o--}for(o=0;o<r.children.length;o+=n){var c=r.children[o];n=1;var u=void 0;if(c instanceof S&&(u=c),c instanceof H&&0==c.fieldType?i=!0:c instanceof H&&2===c.fieldType&&(i=!1),null!=u&&!i){var p=[],f=this.splitTextByFontScriptType(u.text,p);if(f.length>1)for(var g=0;g<f.length;g++){var m=f[g];if(g>0){var v=u.clone();v.text=m,v.scriptType=p[g],r.children.splice(o+g,0,v),v.line=r,n++}else u.text=m,u.scriptType=p[g]}else f.length>0&&(u.scriptType=p[0]);p.length=0}}}},e.prototype.splitLtrAndRtlText=function(t){var i={value:null},n=1,r={value:null},o=[],l=!1,d=this.bodyWidget.page.documentHelper.textHelper;if(this.childWidgets.length>0){for(var c=this.childWidgets[t],u=0;u<c.children.length;u+=n){var p=c.children[u];n=1;var f=void 0;if(p instanceof S&&(f=p),p instanceof H&&0==p.fieldType?l=!0:p instanceof H&&2===p.fieldType&&(l=!1),null!=f&&!l){var g=f.text,m=f.characterFormat.bidi,v=!1,y=o.length;m&&(v=d.isRightToLeftLanguage(p.characterFormat.localeIdBidi));var b=d.splitTextByConsecutiveLtrAndRtl(g,m,v,o,i,r);if(b.length>1)for(var C=0;C<b.length;C++)if(g=b[C],C>0){var F=f.clone();F.text=g,F.characterRange=o[C+y],c.children.splice(u+C,0,F),F.line=c,n++,f.revisions.length>0&&this.updateTextElementInRevisionRange(f,F)}else f.text=g,f.characterRange=o[y];else b.length>0&&(f.characterRange=o[y])}}o.length=0}},e.prototype.updateTextElementInRevisionRange=function(t,i){for(var n=0;n<t.revisions.length;n++){var r=t.revisions[n],o=r.range.indexOf(t);r.range.splice(o+1,0,i),i.revisions.push(r),i.removedIds=[]}},e.prototype.combineconsecutiveRTL=function(t){for(var i=!1,r=this.bodyWidget.page.documentHelper.textHelper,o=t;o<this.childWidgets.length;o++)for(var l=this.childWidgets[o],h=0;h<=l.children.length-2;h++){var d=l.children[h];if(d instanceof H&&0===d.fieldType?i=!0:d instanceof H&&2===d.fieldType&&(i=!1),!i&&d instanceof S&&l.children[h+1]instanceof S){var c=d,u=l.children[h+1];(c.characterFormat.complexScript&&c.scriptType==u.scriptType&&c.text.length>0&&u.text.length>0&&!r.isWordSplitChar(c.text[c.text.length-1])&&!r.isWordSplitChar(u.text[0])&&c.characterFormat.isEqualFormat(u.characterFormat)||c.characterRange==z.RightToLeft&&u.characterRange==z.RightToLeft&&c.text.length>0&&u.text.length>0&&r.isWordSplitChar(c.text[c.text.length-1])&&r.isWordSplitChar(u.text[0])&&c.characterFormat.isEqualFormat(u.characterFormat))&&(c.text=c.text+u.text,l.children.splice(h+1,1),h--)}}},e.prototype.clone=function(){var t=new e;t.paragraphFormat.copyFormat(this.paragraphFormat),t.characterFormat.copyFormat(this.characterFormat);for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();t.childWidgets.push(r);for(var o=0;o<r.children.length;o++){var l=r.children[o];(l instanceof ee&&"Inline"!==l.textWrappingStyle||l instanceof de)&&t.floatingElements.push(l)}r.paragraph=t}return t.x=this.x,t.y=this.y,t.height=this.height,t.width=this.width,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e.prototype.destroyInternal=function(t){var i=this.height;if(!(0,a.le)(this.childWidgets)){for(var n=0;n<this.childWidgets.length&&(this.childWidgets[n].destroy(),1===this.childWidgets.length&&(0,a.le)(this.childWidgets[0].children)&&(this.childWidgets=void 0),!(0,a.le)(this.childWidgets));n++)n--;this.childWidgets=void 0}!(0,a.le)(this.containerWidget)&&!(0,a.le)(this.containerWidget.childWidgets)&&-1!==this.containerWidget.childWidgets.indexOf(this)&&(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=i,this.containerWidget=void 0),this.destroy()},e.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,s.prototype.destroy.call(this)},e}(Ve),Ao=function(){function s(){}return s.prototype.clone=function(){var e=new s;return e.allowOverlap=this.allowOverlap,e.distanceTop=this.distanceTop,e.distanceRight=this.distanceRight,e.distanceLeft=this.distanceLeft,e.distanceBottom=this.distanceBottom,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalPosition=this.verticalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalOrigin=this.horizontalOrigin,e.horizontalPosition=this.horizontalPosition,e},s}(),k=function(s){function e(){var t=s.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.margin=new $e(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new Oe(t),t.tableHolder=new Kn,t.spannedRowCollection=new U,t}return Le(e,s),Object.defineProperty(e.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(t){this.flags=251&this.flags|(t?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(t){this.flags=253&this.flags|(t?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(t){this.flags=254&this.flags|(t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(t){this.flags=239&this.flags|(t?1:0)<<4},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&t.tableFormat===this.tableFormat},e.prototype.combineRows=function(t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];0===n.childWidgets.length?(n.destroy(),i--):n.combineCells(t)}},e.prototype.contains=function(t){if(this.equals(t.ownerTable))return!0;for(;t.ownerTable.isInsideTable;){if(this.equals(t.ownerTable))return!0;t=t.ownerTable.associatedCell}return this.equals(t.ownerTable)},e.prototype.getOwnerWidth=function(t){var i=this.getContainerWidth();return(i=i-this.leftIndent-this.rightIndent)>=0?i:0},e.prototype.getTableWidth=function(){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var n=0,r=this.childWidgets[i],o=0;o<r.childWidgets.length;o++)n+=r.childWidgets[o].cellFormat.cellWidth;t<n&&(t=n)}return t},e.prototype.getTableCellWidth=function(){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var n=0,r=this.childWidgets[i],o=0;o<r.childWidgets.length;o++){var l=r.childWidgets[o],h=l.width;0===h&&((h=l.cellFormat.cellWidth)>l.cellFormat.preferredWidth&&0!==l.cellFormat.preferredWidth&&"Percent"!==l.cellFormat.preferredWidthType&&(h=l.cellFormat.preferredWidth),h=w.convertPointToPixel(h-(l.margin.left+l.margin.right))),n+=h+l.margin.left+l.margin.right}t<n&&(t=n)}return t},e.prototype.getTableClientWidth=function(t){var i=t;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?i=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(i=i*this.tableFormat.preferredWidth/100),i},e.prototype.getCellWidth=function(t,i,n,r){var o=t;return"Percent"===i?o=t*n/100:"Point"===i?o=t:(0,a.le)(r)||(o=this.getMinimumPreferredWidth(r)),o},e.prototype.getMinimumPreferredWidth=function(t){return 0===t.cellFormat.preferredWidth&&0!==t.cellFormat.cellWidth?t.cellFormat.cellWidth:t.getMinimumPreferredWidth()},e.prototype.fitCellsToClientArea=function(t){for(var n=t/this.getTableWidth(),r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r];o.rowFormat.gridAfterWidth*=n,o.rowFormat.gridBeforeWidth*=n;for(var l=0;l<o.childWidgets.length;l++)o.childWidgets[l].cellFormat.cellWidth*=n,o.childWidgets[l].cellFormat.preferredWidth*=n}},e.prototype.getTableCellWidget=function(t){for(var i=void 0,n=0;n<this.childWidgets.length;n++)if(this.childWidgets[n].y<=t.y&&this.childWidgets[n].y+this.childWidgets[n].height>=t.y){i=this.childWidgets[n].getTableCellWidget(t);break}return i},e.prototype.calculateGrid=function(t){var i=[],n=[],r=[],o=this.getOwnerWidth(!0),l=this.getTableClientWidth(o);this.tableCellInfo=new U;for(var h=0;h<this.childWidgets.length;h++){var d=this.childWidgets[h],c=new U,u=d.rowFormat,f=d.rowFormat.gridBefore,g=0;i.indexOf(g)<0&&(i.push(g),n.push(g)),g+=this.getCellWidth(u.gridBeforeWidth,u.gridBeforeWidthType,l,null);var m=parseFloat(g.toFixed(2));i.indexOf(m)<0&&(i.push(m),n.push(g));for(var v=0;v<d.childWidgets.length;v++){for(var y=d.childWidgets[v],b=0;b<r.length;b++)if(!(r[b].columnIndex<f)){var C=r[b].cellFormat.rowSpan,F=!0;r[b].columnIndex>f?(F=!1,v===d.childWidgets.length-1&&d.rowFormat.gridAfter>0&&(g+=this.getCellWidth(r[b].cellFormat.preferredWidth,r[b].cellFormat.preferredWidthType,l,null))):(g+=this.getCellWidth(r[b].cellFormat.preferredWidth,r[b].cellFormat.preferredWidthType,l,null),f=r[b].columnIndex+r[b].cellFormat.columnSpan),!F&&v===d.childWidgets.length-1&&(F=!0),F&&h-r[b].ownerRow.rowIndex==C-1&&(r.splice(b,1),b--)}if(y.cellFormat.rowSpan>1)if(0===r.length||r[r.length-1].columnIndex<=f)r.push(y);else for(var T=r.length;T>0;T--)r[T-1].columnIndex>f&&r.splice(T-1,0,y);c.containsKey(y.cellIndex)||c.add(y.cellIndex,parseFloat((g-m).toFixed(2))),f+=y.cellFormat.columnSpan,g+=this.getCellWidth(y.cellFormat.preferredWidth,y.cellFormat.preferredWidthType,l,null);var x=parseFloat(g.toFixed(2));i.indexOf(x)<0&&(i.push(x),n.push(g)),v===d.childWidgets.length-1&&u.gridAfter>0&&(g+=this.getCellWidth(u.gridAfterWidth,"Point",l,null),i.indexOf(parseFloat(g.toFixed(2)))<0&&(i.push(parseFloat(g.toFixed(2))),n.push(g)),f+=u.gridAfter),this.tableCellInfo.containsKey(d.rowIndex)||this.tableCellInfo.add(d.rowIndex,c)}}i.sort(function(P,E){return P-E}),n.sort(function(P,E){return P-E}),this.tableHolder.columns.length>0&&(i.length-1!==this.tableHolder.columns.length||t)&&this.updateColumnSpans(i,l,n),this.tableCellInfo.clear(),this.tableCellInfo=void 0},e.prototype.updateColumnSpans=function(t,i,n){for(var r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r];o.rowFormat.gridBeforeWidth>=0&&(o.rowFormat.gridBefore=o.getGridCount(t,void 0,-1,i,n));for(var l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l],d=o.getGridCount(t,h,h.getIndex(),i,n);d>0&&h.cellFormat.columnSpan!==d&&(h.cellFormat.columnSpan=d)}o.rowFormat.gridAfterWidth>=0&&(o.rowFormat.gridAfter=o.getGridCount(t,void 0,o.childWidgets.length,i,n))}},e.prototype.getMinimumAndMaximumWordWidth=function(t,i){this.checkTableColumns();var n=this.tableHolder.isAllColumnHasPointWidthType(),r=this.tableHolder.getTotalWidth(n?0:1);return r>t&&(t=r),n||(r=this.tableHolder.getTotalWidth(2)),r>i&&(i=r),{minimumWordWidth:t,maximumWordWidth:i}},e.prototype.checkTableColumns=function(){this.isGridUpdated||((this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!1)},e.prototype.isAutoFit=function(){var t=this.bodyWidget;return!(0,a.le)(t)&&!(0,a.le)(t.page)&&t.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},e.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var i,t=0,n=[],r="Auto"===this.tableFormat.preferredWidthType,o=this.tableFormat.allowAutoFit;t=!(!(0,a.le)(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof Se&&o)||this.isInsideTable||this.containerWidget instanceof be?this.getOwnerWidth(!0):w.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right);var l=r&&0===this.tableFormat.preferredWidth&&!o;i=this.getTableClientWidth(t=this.tableFormat.preferredWidth>t?this.tableFormat.preferredWidth:t),l&&!this.isDefaultFormatUpdated&&o&&this.splitWidthToTableCells(i,l);for(var h=!1,d=0;d<this.childWidgets.length;d++){var c=this.childWidgets[d],u=c.rowFormat,p=0,f=0,g=new bi,m=0;u.gridBefore>0&&(0!==c.rowFormat.beforeWidth||0!==c.rowFormat.gridBeforeWidth)&&(!this.bodyWidget.page.documentHelper.alignTablesRowByRow||"Left"===c.ownerTable.tableFormat.tableAlignment)&&(f=this.getCellWidth(u.gridBeforeWidth,c.rowFormat.gridAfterWidthType,i,null),g.minimumWidth=f,this.tableHolder.addColumns(p,p=u.gridBefore,f,g,m=f,"Point"));for(var v=0;v<c.childWidgets.length;v++){var y=c.childWidgets[v];(y.cellFormat.rowSpan>1||y.cellFormat.columnSpan>1)&&(h=!0),0===n.length&&(y.columnIndex=p);for(var b=0;b<n.length;b++){var C=n[b];if(C.columnIndex<p)y.columnIndex=p;else{var F,T=!0;F=C.cellFormat.rowSpan,C.columnIndex>p?(y.columnIndex=p,T=!1):(g=C.getCellSizeInfo(o),f=this.getCellWidth(C.cellFormat.preferredWidth,C.cellFormat.preferredWidthType,i,C),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(p,p=this.tableHolder.columns.indexOf(C.ownerColumn)+C.cellFormat.columnSpan,f,g,m+=f,y.cellFormat.preferredWidthType),y.columnIndex=p):(this.tableHolder.addColumns(p,p=C.columnIndex+C.cellFormat.columnSpan,f,g,m+=f,y.cellFormat.preferredWidthType),y.columnIndex=p)),!T&&v===c.childWidgets.length-1&&(T=!0),T&&d-C.ownerRow.rowIndex==F-1&&(n.splice(b,1),b--)}}if(y.cellFormat.rowSpan>1)if(0===n.length||n[n.length-1].columnIndex<=p)n.push(y);else{for(var x=0,P=n.length;P>0;P--)n[P-1].columnIndex>p&&(x=P-1);n.splice(x,0,y)}g=y.getCellSizeInfo(o),f=this.getCellWidth(y.cellFormat.preferredWidth,y.cellFormat.preferredWidthType,i,y),this.tableHolder.addColumns(p,p+=y.cellFormat.columnSpan,f,g,m+=f,y.cellFormat.preferredWidthType),v===c.childWidgets.length-1&&u.gridAfterWidth>0&&(f=this.getCellWidth(u.gridAfterWidth,"Point",i,null),g.minimumWordWidth=g.maximumWordWidth=g.minimumWidth=f,this.tableHolder.addColumns(p,p+=u.gridAfter,f,g,m+=f,"Point"))}}l&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),o?this.tableHolder.autoFitColumn(t,i,r,this.isInsideTable,h,this.leftIndent+this.rightIndent):this.tableHolder.fitColumns(t,i,r,this.leftIndent+this.rightIndent),this.setWidthToCells(i,r)}},e.prototype.setWidthToCells=function(t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n],o=r.rowFormat;o.gridBefore>0&&(o.beforeWidth=this.tableHolder.getCellWidth(0,o.gridBefore,t));for(var l=0;l<r.childWidgets.length;l++){var h=r.childWidgets[l];h.cellFormat.cellWidth=this.tableHolder.getCellWidth(h.columnIndex,h.cellFormat.columnSpan,t)}o.gridAfter>0&&(o.afterWidth=this.tableHolder.getCellWidth(0,o.gridAfter,t))}},e.prototype.updateProperties=function(t,i,n){if(t&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==n),this===i)if("FixedColumnWidth"===n){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var r=0;r<this.childWidgets.length;r++)for(var o=this.childWidgets[r],l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];h.cellFormat.preferredWidthType="Point",h.cellFormat.preferredWidth=h.cellFormat.cellWidth}}else if("FitToWindow"===n){var d=this.tableHolder.getTotalWidth(0);for(this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent",r=0;r<this.childWidgets.length;r++)for(var c=this.childWidgets[r],u=0;u<c.childWidgets.length;u++)"Percent"!==(p=c.childWidgets[u]).cellFormat.preferredWidthType&&(p.cellFormat.preferredWidthType="Percent",p.cellFormat.preferredWidth=p.cellFormat.cellWidth/d*100)}else for(this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto",r=0;r<this.childWidgets.length;r++)for((c=this.childWidgets[r]).rowFormat.beforeWidth=0,c.rowFormat.gridBefore=0,c.rowFormat.gridBeforeWidth=0,c.rowFormat.gridBeforeWidthType="Auto",c.rowFormat.afterWidth=0,c.rowFormat.gridAfter=0,c.rowFormat.gridAfterWidth=0,c.rowFormat.gridAfterWidthType="Auto",l=0;l<c.childWidgets.length;l++){var p;(p=c.childWidgets[l]).cellFormat.preferredWidth=0,p.cellFormat.preferredWidthType="Auto"}else i.updateProperties(!1,i,n)},e.prototype.getMaxRowWidth=function(t){for(var i=0,n=0;n<this.childWidgets.length;n++){for(var r=this.childWidgets[n],o=0,l=0;l<r.childWidgets.length;l++){var h=r.childWidgets[l];o+=this.getCellWidth(h.cellFormat.preferredWidth,h.cellFormat.preferredWidthType,t,h)}i<o&&(i=o)}return i},e.prototype.updateWidth=function(t){var i=this.tableHolder.getTotalWidth(0),n=this.getOwnerWidth(!0),r=this.getTableClientWidth(n);r<=i&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidth="Point"===this.tableFormat.preferredWidthType?this.getMaxRowWidth(r):i/n*100)},e.prototype.convertPointToPercent=function(t,i){var n=0;return n=t/i*100,(n=Math.round(n))<100?n:100},e.prototype.updateChildWidgetLeft=function(t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.x=t,n.updateChildWidgetLeft(t)}},e.prototype.shiftWidgetsForRtlTable=function(t,i){var n=i.x,r=t.right,o=0;i.tableFormat&&i.tableFormat.cellSpacing>0&&(o=i.tableFormat.cellSpacing);for(var l=0;l<i.childWidgets.length;l++)for(var h=i.childWidgets[l],c=r-(h.x-n),u=0;u<h.childWidgets.length;u++){var p=h.childWidgets[u];p.updateWidgetLeft((c-=p.width+p.margin.left+p.margin.right-p.rightBorderWidth+o)+p.margin.left)}},e.prototype.clone=function(){var t=new e;t.tableHolder=this.tableHolder.clone(),t.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(t.wrapTextAround=this.wrapTextAround,t.positioning=this.positioning.clone());for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.containerWidget=t,n.index=i}return t.x=this.x,t.y=this.y,t.height=this.height,t.width=this.width,t.containerWidget=this.containerWidget,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e.getTableOf=function(t){if(t instanceof _e){var i=Q.getRowOf(t);return(0,a.le)(i)?t.ownerBase instanceof Oe&&t.ownerBase.ownerBase instanceof e?t.ownerBase.ownerBase:void 0:i.ownerTable}},e.prototype.fitChildToClientArea=function(){var t=this.getContainerWidth();Math.round(t)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(t);for(var i=0;i<this.childWidgets.length;i++)for(var n=this.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],l=0;l<o.childWidgets.length;l++)o.childWidgets[l]instanceof e&&o.childWidgets[l].fitChildToClientArea()},e.prototype.getColumnCellsForSelection=function(t,i){for(var n=[],r=t.columnIndex,o=i.columnIndex+i.cellFormat.columnSpan,l=0;l<this.childWidgets.length;l++)for(var h=this.childWidgets[l],d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d],u=c.columnIndex,p=c.cellFormat.columnSpan;u+p>r&&u+p<o||u>r&&u<o||u>r&&u<o&&u+p<o||u<r&&u+p>o?n.indexOf(c)<0&&n.push(c):(u===r||u+p===o)&&n.indexOf(c)<0&&n.push(c)}return n},e.prototype.splitWidthToTableCells=function(t,i){for(var n=0;n<this.childWidgets.length;n++)this.childWidgets[n].splitWidthToRowCells(t,i)},e.prototype.insertTableRowsInternal=function(t,i,n){for(var r=t.length-1;r>=0;r--){var o=t.splice(r,1)[0];o.containerWidget=this,this.childWidgets.splice(i,0,o)}this.updateRowIndex(i),this.isGridUpdated=!1,n&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},e.prototype.updateRowIndex=function(t){for(var i=t;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.index=i;for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r].index=r,n.childWidgets[r].rowIndex=n.rowIndex;t++}},e.prototype.getCellStartOffset=function(t){var i=0;if(t&&this.tableCellInfo&&this.tableCellInfo.containsKey(t.ownerRow.rowIndex)){var n=this.tableCellInfo.get(t.ownerRow.rowIndex);n.containsKey(t.cellIndex)&&(i=n.get(t.cellIndex))}return i},e.prototype.destroyInternal=function(t){var i=this.height;if(!(0,a.le)(this.childWidgets)){for(var n=0;n<this.childWidgets.length;n++){var r=void 0;if((0,a.le)(r=this.childWidgets[n])||r.destroyInternal(t),(0,a.le)(this.childWidgets))break;n--}this.childWidgets=void 0}(0,a.le)(this.containerWidget)||(this.containerWidget instanceof j&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),(0,a.le)(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=i),this.containerWidget=void 0),this.destroy()},e.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.description=void 0,this.title=void 0,this.isDefaultFormatUpdated=void 0,s.prototype.destroy.call(this)},e}(Ve),Q=function(s){function e(){var t=s.call(this)||this;return t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new De(t),t}return Le(e,s),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof k)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRow",{get:function(){var t=this.indexInOwner;if(t>-1&&t<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[t+1]},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&t.rowFormat===this.rowFormat},e.prototype.combineCells=function(t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.combineWidget(t),(0,a.le)(n.cellFormat)||1!==n.cellFormat.rowSpan?(0,a.le)(n.cellFormat)&&i--:this.height-this.ownerTable.tableFormat.cellSpacing<n.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+n.height)}},e.getRowOf=function(t){if(t instanceof _e){var i=V.getCellOf(t);return(0,a.le)(i)?t.ownerBase instanceof De&&t.ownerBase.ownerBase instanceof e?t.ownerBase.ownerBase:void 0:i.ownerRow}},e.prototype.getCell=function(t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];if(r.rowIndex===t&&r.index===i)return r}},e.prototype.splitWidthToRowCells=function(t,i){for(var n=this.childWidgets,r=t/n.length,o=0;o<n.length;o++)if(i&&0===n[o].cellFormat.preferredWidth)n[o].cellFormat.preferredWidth=r,this.ownerTable.isDefaultFormatUpdated=!1;else{if(i){this.ownerTable.isDefaultFormatUpdated=!0;break}n[o].cellFormat.preferredWidth=r}},e.prototype.getGridCount=function(t,i,n,r,o){var l=0,h=0,d=this.ownerTable,c=this.rowFormat;-1===n?h=d.getCellWidth(c.gridBeforeWidth,c.gridBeforeWidthType,r,null):(l+=d.getCellWidth(c.gridBeforeWidth,c.gridBeforeWidthType,r,null),n>=0&&(l+=d.getCellStartOffset(i)),h=n<this.childWidgets.length?d.getCellWidth(i.cellFormat.preferredWidth,i.cellFormat.preferredWidthType,r,null):d.getCellWidth(c.gridAfterWidth,c.gridAfterWidthType,r,null));var p=o[t.indexOf(l)],g=this.getOffsetIndex(t,l),m=parseFloat((h+l).toFixed(2));return(parseFloat((h+p).toFixed(2))===m||(0,a.le)(p)?this.getOffsetIndex(t,l+h):this.getOffsetIndex(t,p+h))-g},e.prototype.getOffsetIndex=function(t,i){i=parseFloat(i.toFixed(2));var n=0;if(t.indexOf(i)>=0)n=t.indexOf(i);else{for(var r=0;r<t.length;r++)if(t[r]>i)return r;n=t.length-1}return n},e.prototype.getCellOffset=function(t,i){for(var n=0,r=this.ownerTable,o=0;o<this.childWidgets.length;o++){var l=this.childWidgets[o].cellFormat;if(o===t)break;n+=r.getCellWidth(l.preferredWidth,l.preferredWidthType,i,null)}return n},e.prototype.updateRowBySpannedCells=function(){for(var t=this.getPreviousRowSpannedCells(),i=this.rowIndex,n=0;n<t.length;n++){var r=t[n];r.ownerRow.rowIndex+r.cellFormat.rowSpan-1>=i&&(r.cellFormat.rowSpan-=1)}},e.prototype.getPreviousRowSpannedCells=function(t){for(var i=[],n=t?this:this.previousWidget;!(0,a.le)(n);){for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o.cellFormat.rowSpan>1&&i.splice(0,0,o)}n=n.previousWidget}return i},e.prototype.isCellsHaveSameWidthUnit=function(){if(this.childWidgets.length>0)for(var t=this.childWidgets[0].cellFormat.preferredWidthType,i=1;i<this.childWidgets.length;i++)if(t!=this.childWidgets[i].cellFormat.preferredWidthType)return!1;return!0},e.prototype.updateUniformWidthUnitForCells=function(){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.cellFormat.preferredWidthType="Point",i.cellFormat.preferredWidth=i.cellFormat.cellWidth}},e.prototype.getTableCellWidget=function(t){for(var i=0;i<this.childWidgets.length;i++){var n=Math.round(this.childWidgets[i].x);if(n-this.childWidgets[i].margin.left-1<=t.x&&n+this.childWidgets[i].width>=t.x)return this.childWidgets[i];if(i===this.childWidgets.length-1&&this.childWidgets[i].x+this.childWidgets[i].width+1<=t.x)return this.childWidgets[i]}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].x<=t.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(t):this.childWidgets[0].getTableCellWidget(t)),r},e.prototype.getCellWidget=function(t,i){var r=this.ownerTable.tableHolder.getValidColumnIndex(t);r>t&&(i-=r-t,t=r);var o=0;this.rowFormat.gridBefore>0&&(o+=this.rowFormat.gridBefore);for(var l=0;l<this.childWidgets.length;l++){var h=this.childWidgets[l],d=h.cellFormat.columnSpan;if(o<h.columnIndex&&(o<=t||o<t+i)&&h.columnIndex>t)return null;if((h.columnIndex<=t||h.columnIndex<t+i)&&h.columnIndex+d>t)return h;if(h.columnIndex>t)break;o+=d}return null},e.prototype.getVerticalMergeStartCell=function(t,i){var n=this.ownerTable.tableHolder.columns;if(this.rowFormat.gridBefore>0&&this.rowFormat.gridBefore>t+i)return null;var r=this.getCellWidget(t,i);if(!(0,a.le)(r))return r;if(t+this.rowFormat.gridAfter===n.length)return null;var o,l=this.previousWidget;return(0,a.le)(l)||(o=l.getVerticalMergeStartCell(t,i)),!(0,a.le)(o)&&o.cellFormat.rowSpan>1&&this.index===o.rowIndex+o.cellFormat.rowSpan-1?o:null},e.prototype.getMinimumAndMaximumWordWidth=function(t,i){return{minimumWordWidth:t,maximumWordWidth:i}},e.prototype.destroyInternal=function(t){var i=this.height;if(!(0,a.le)(this.childWidgets)){for(var n=0;n<this.childWidgets.length&&(this.childWidgets[n].destroyInternal(t),!(0,a.le)(this.childWidgets));n++)n--;this.childWidgets=void 0}(0,a.le)(this.containerWidget)||(0,a.le)(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),((0,a.le)(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof k?this.containerWidget.destroyInternal(t):this.containerWidget.containerWidget instanceof j&&(this.containerWidget.containerWidget.height-=i),this.containerWidget.height-=i),this.destroy()},e.prototype.clone=function(){var t=new e;t.rowFormat.copyFormat(this.rowFormat),t.topBorderWidth=this.topBorderWidth,t.bottomBorderWidth=this.bottomBorderWidth;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.containerWidget=t,n.index=i,n.rowIndex=this.rowIndex}return t.x=this.x,t.y=this.y,t.height=this.height,t.width=this.width,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e.prototype.updateChildWidgetLeft=function(t){var i=0;this.ownerTable.tableFormat.cellSpacing>0&&(i=this.ownerTable.tableFormat.cellSpacing);for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];r.x=t+=i+r.margin.left,r.updateChildWidgetLeft(r.x),t+=r.width+r.margin.right}},e.prototype.shiftWidgetForRtlTable=function(){var t=this.ownerTable,i=t.x,n=0;null!=t.tableFormat&&t.tableFormat.cellSpacing>0&&(n=t.tableFormat.cellSpacing);for(var h=i+w.convertPointToPixel(t.getTableWidth())-(this.x-i),d=0;d<this.childWidgets.length;d++){var c=this.childWidgets[d];c.updateWidgetLeft((h-=c.width+c.margin.left+c.margin.right-c.rightBorderWidth+n)+c.margin.left)}},e.prototype.destroy=function(){this.rowFormat=void 0,this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,s.prototype.destroy.call(this)},e}(Ve),V=function(s){function e(){var t=s.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new bi,t.updatedTopBorders=[],t.margin=new $e(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new it(t),t}return Le(e,s),Object.defineProperty(e.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:!(0,a.le)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:(0,a.le)(this.ownerTable)||(0,a.le)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:!(0,a.le)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:(0,a.le)(this.ownerTable)||(0,a.le)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:!(0,a.le)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:(0,a.le)(this.ownerTable)||(0,a.le)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:!(0,a.le)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:(0,a.le)(this.ownerTable)||(0,a.le)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof Q)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&t.cellFormat===this.cellFormat},e.prototype.getContainerTable=function(){for(var t=this.ownerTable;t instanceof k&&t.associatedCell instanceof e;)t=t.associatedCell.getContainerTable();return t},e.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof Q){var t=this.containerWidget;do{if((0,a.le)(t=t.previousRenderedWidget)||t.index<this.rowIndex)break;var i=t.getCell(this.rowIndex,this.index);if(i&&this.equals(i))return i}while(t)}},e.prototype.getNextSplitWidget=function(){var t=this.cellFormat.rowSpan;if(this.containerWidget instanceof Q){var i=this.containerWidget;do{if((0,a.le)(i=i.nextRenderedWidget)||i.index>this.rowIndex+t)break;var n=i.getCell(this.rowIndex,this.index);if(n&&this.equals(n))return n}while(i)}},e.prototype.getTableCellWidget=function(t){for(var i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=t.y&&this.childWidgets[i].y+this.childWidgets[i].height>=t.y)return this.childWidgets[i].getTableCellWidget(t);var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].y<=t.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(t):this.childWidgets[0].getTableCellWidget(t)),n},e.prototype.updateWidth=function(t){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=t:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(t)),this.cellFormat.cellWidth=t},e.prototype.getCellWidth=function(t){var i=this.ownerTable,n=i?i.getTableClientWidth(i.getOwnerWidth(!0)):0,r=n,o=(0,a.le)(this.leftMargin)?0:this.leftMargin,l=(0,a.le)(this.rightMargin)?0:this.rightMargin;return i&&"Auto"===i.tableFormat.preferredWidthType&&i.tableFormat.allowAutoFit?r=0===this.cellFormat.preferredWidth?n:this.cellFormat.preferredWidth-o-l:"Percent"===this.cellFormat.preferredWidthType?r=this.cellFormat.preferredWidth*n/100-o-l:"Point"===this.cellFormat.preferredWidthType&&(r=t instanceof k&&"Percent"===t.tableFormat.preferredWidthType?this.cellFormat.cellWidth-o-l:this.cellFormat.preferredWidth-o-l),r},e.prototype.convertPointToPercent=function(t){var i=0,n=this.ownerTable.getOwnerWidth(!0);return i=t/this.ownerTable.getTableClientWidth(n)*100,(i=Math.round(i))<100?i:100},e.getCellLeftBorder=function(t){var i=void 0,n=t.cellFormat.borders,r=(0,a.le)(t.ownerRow)?void 0:t.ownerRow.rowFormat.borders,o=(0,a.le)(t.ownerTable)?void 0:t.ownerTable.tableFormat.borders;if((0,a.le)(n.left)||(i=n.left),(0,a.le)(i)&&(i=t.getLeftBorderToRenderByHierarchy(i,r,o)),t.ownerTable.tableFormat.cellSpacing>0)i=t.getLeftBorderToRenderByHierarchy(i,r,o);else{var l=this.getPreviousCell(t);i=t.getPreviousCellLeftBorder(i,l)}return(0,a.le)(i)&&(i=new ve(t.cellFormat.borders)),i},e.getPreviousCell=function(t){var i=void 0;if(!(0,a.le)(t.previousWidget)){var n=t.previousWidget;n.columnIndex+n.cellFormat.columnSpan===t.columnIndex&&(i=n)}return i},e.prototype.getLeftBorderWidth=function(){var t=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(t=e.getCellLeftBorder(this).getLineWidth()),t},e.prototype.getRightBorderWidth=function(){var t=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(t=e.getCellRightBorder(this).getLineWidth()),t},e.prototype.getCellSpacing=function(){var t=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*t:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?t+t/2:t},e.prototype.getCellSizeInfo=function(t){var i=!0,n=void 0;if(!(0,a.le)(this.bodyWidget)&&!(0,a.le)(this.bodyWidget.page)&&((0,a.le)(this.bodyWidget.page.documentHelper)||(n=this.bodyWidget.page.documentHelper.layout)),!(0,a.le)(n)&&!(0,a.le)(n.currentCell)&&(i=!1,this===n.currentCell&&(i=!0)),i&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),t&&i&&!this.sizeInfo.hasMinimumWordWidth){var r=this.getMinimumAndMaximumWordWidth(0,0);this.sizeInfo.minimumWordWidth=r.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=r.maximumWordWidth+this.sizeInfo.minimumWidth}var o=new bi;return o.minimumWidth=this.sizeInfo.minimumWidth,o.minimumWordWidth=this.sizeInfo.minimumWordWidth,o.maximumWordWidth=this.sizeInfo.maximumWordWidth,o},e.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},e.prototype.getPreviousCellLeftBorder=function(t,i){if(((0,a.le)(i)||!(0,a.le)(t)&&"None"===t.lineStyle&&!t.hasNoneStyle)&&!(0,a.le)(t)&&!(t.ownerBase.ownerBase instanceof Oe)&&(t=this.getLeftBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders)),(0,a.le)(i))return t;var n=void 0;return!(0,a.le)(i.cellFormat.borders)&&!(0,a.le)(i.cellFormat.borders.right)&&"None"!==i.cellFormat.borders.right.lineStyle&&(n=i.cellFormat.borders.right),(0,a.le)(n)||"None"===n.lineStyle?(0,a.le)(t)||t.ownerBase.ownerBase instanceof Oe?t:this.getLeftBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(n,t)},e.prototype.getBorderBasedOnPriority=function(t,i){if((0,a.le)(t))return i;if((0,a.le)(i))return t;var n=t.getBorderWeight(),r=i.getBorderWeight();if(n===r){var o=t.getPrecedence(),l=i.getPrecedence();if(o===l){var h=w.convertHexToRgb(t.color),d=h.r,c=h.g,u=h.b,p=w.convertHexToRgb(i.color),g=p.g,m=p.b,v=d+u+2*c,y=p.r+m+2*g;return v===y&&(v=u+2*c)===(y=m+2*g)?c===g?t:c>g?i:t:v>y?i:t}return o>l?t:i}return n>r?t:i},e.prototype.getLeftBorderToRenderByHierarchy=function(t,i,n){var r=e.getCellOf(t.ownerBase);if(!(0,a.le)(r)){var o=!1;(0===r.columnIndex||0===r.cellIndex&&r.ownerRow.rowFormat.gridBefore>0)&&(o=!0),(!(0,a.le)(t)&&"None"===t.lineStyle||(0,a.le)(t))&&(o?(!(0,a.le)(t=i.left)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.left):(!(0,a.le)(t=i.vertical)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.vertical))}return t},e.getCellRightBorder=function(t){var i=void 0,n=t.cellFormat.borders,r=(0,a.le)(t.ownerRow)?void 0:t.ownerRow.rowFormat.borders,o=(0,a.le)(t.ownerTable)?void 0:t.ownerTable.tableFormat.borders;if((0,a.le)(n.right)||(i=n.right),(0,a.le)(i)&&(i=t.getRightBorderToRenderByHierarchy(i,r,o)),t.ownerTable.tableFormat.cellSpacing>0)i=t.getRightBorderToRenderByHierarchy(i,r,o);else{var l=this.getNextCell(t);i=t.getAdjacentCellRightBorder(i,l)}return(0,a.le)(i)&&(i=new ve(t.cellFormat.borders)),i},e.getNextCell=function(t){var i=void 0,n=t.cellFormat.columnSpan;if(!(0,a.le)(t.nextWidget)){var r=t.nextWidget;t.columnIndex+n===r.columnIndex&&(i=r)}return i},e.prototype.getAdjacentCellRightBorder=function(t,i){if(((0,a.le)(i)||!(0,a.le)(t)&&"None"===t.lineStyle&&!t.hasNoneStyle)&&!(0,a.le)(t)&&!(t.ownerBase.ownerBase instanceof Oe)&&(t=this.getRightBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders)),(0,a.le)(i))return t;var n=void 0;return!(0,a.le)(i.cellFormat.borders)&&!(0,a.le)(i.cellFormat.borders.left)&&"None"!==i.cellFormat.borders.left.lineStyle&&(n=i.cellFormat.borders.left),(0,a.le)(n)||"None"===n.lineStyle?(0,a.le)(t)||t.ownerBase.ownerBase instanceof Oe?t:this.getRightBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(t,n)},e.prototype.getRightBorderToRenderByHierarchy=function(t,i,n){var r=e.getCellOf(t.ownerBase);if(!(0,a.le)(r)){var o=!1;(r.columnIndex+r.cellFormat.columnSpan===r.ownerTable.tableHolder.columns.length||r.cellIndex===r.ownerRow.childWidgets.length-1)&&(o=!0),(!(0,a.le)(t)&&"None"===t.lineStyle||(0,a.le)(t))&&(o?(!(0,a.le)(t=i.right)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.right):(!(0,a.le)(t=i.vertical)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.vertical))}return t},e.getCellTopBorder=function(t){var i=void 0,n=t.cellFormat.borders,r=(0,a.le)(t.ownerRow)?void 0:t.ownerRow.rowFormat.borders,o=(0,a.le)(t.ownerTable)?void 0:t.ownerTable.tableFormat.borders;if((0,a.le)(n.top)||(i=n.top),(0,a.le)(i)&&(i=t.getTopBorderToRenderByHierarchy(i,r,o)),t.ownerTable.tableFormat.cellSpacing>0)i=t.getTopBorderToRenderByHierarchy(i,r,o);else{var l=t.getTopAdjacentCell();i=t.getPreviousCellTopBorder(i,l)}return(0,a.le)(i)&&(i=new ve(t.cellFormat.borders)),i},e.prototype.getTopAdjacentCell=function(){var i,t=this.ownerRow.previousWidget;return(0,a.le)(t)||(i=t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)),i},e.prototype.getPreviousCellTopBorder=function(t,i){if(((0,a.le)(i)||!(0,a.le)(t)&&"None"===t.lineStyle&&!t.hasNoneStyle)&&!(0,a.le)(t)&&!(t.ownerBase.ownerBase instanceof Oe)&&(t=this.getTopBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders)),(0,a.le)(i))return t;var n=void 0;return!(0,a.le)(i.cellFormat.borders)&&!(0,a.le)(i.cellFormat.borders.bottom)&&(n=this.getBottomBorderToRenderByHierarchy(i.cellFormat.borders.bottom,i.ownerRow.rowFormat.borders,i.ownerTable.tableFormat.borders)),(0,a.le)(n)||"None"===n.lineStyle?(0,a.le)(t)||t.ownerBase.ownerBase instanceof Oe?t:this.getTopBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(t,n)},e.prototype.getTopBorderToRenderByHierarchy=function(t,i,n){var r=e.getCellOf(t.ownerBase);if(!(0,a.le)(r)){var o=(0,a.le)(r.ownerRow.previousWidget);(!(0,a.le)(t)&&"None"===t.lineStyle||(0,a.le)(t))&&(o?(!(0,a.le)(t=i.top)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.top):(!(0,a.le)(t=i.horizontal)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.horizontal))}return t},e.getCellBottomBorder=function(t){var i=void 0,n=t.cellFormat.borders,r=(0,a.le)(t.ownerRow)?void 0:t.ownerRow.rowFormat.borders,o=(0,a.le)(t.ownerTable)?void 0:t.ownerTable.tableFormat.borders;if((0,a.le)(n.bottom)||(i=n.bottom),(0,a.le)(i)&&(i=t.getBottomBorderToRenderByHierarchy(i,r,o)),t.ownerTable.tableFormat.cellSpacing>0)i=t.getBottomBorderToRenderByHierarchy(i,r,o);else{var l=void 0,h=void 0,d=t.cellFormat.rowSpan;if(1===d)h=t.ownerRow.nextWidget;else if(d>1){var c=t.containerWidget;do{if((0,a.le)(c=c.nextWidget))break;if(c.index===t.rowIndex+d){h=c;break}}while(c)}(0,a.le)(h)||(l=h.getCellWidget(t.columnIndex,t.cellFormat.columnSpan)),i=t.getAdjacentCellBottomBorder(i,l)}return(0,a.le)(i)&&(i=new ve(t.cellFormat.borders)),i},e.prototype.getAdjacentCellBottomBorder=function(t,i){if(((0,a.le)(i)||!(0,a.le)(t)&&"None"===t.lineStyle&&!t.hasNoneStyle)&&!(0,a.le)(t)&&!(t.ownerBase.ownerBase instanceof Oe)&&(t=this.getBottomBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders)),(0,a.le)(i))return t;var n=void 0;return!(0,a.le)(i.cellFormat.borders)&&!(0,a.le)(i.cellFormat.borders.top)&&"None"!==i.cellFormat.borders.top.lineStyle&&(n=i.cellFormat.borders.top),(0,a.le)(n)||"None"===n.lineStyle?(0,a.le)(t)||t.ownerBase.ownerBase instanceof Oe?t:this.getBottomBorderToRenderByHierarchy(t,Q.getRowOf(t.ownerBase).rowFormat.borders,k.getTableOf(t.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(t,n)},e.prototype.getBottomBorderToRenderByHierarchy=function(t,i,n){var r=e.getCellOf(t.ownerBase);if(!(0,a.le)(r)){var o=(0,a.le)(r.ownerRow.nextWidget);(!(0,a.le)(t)&&"None"===t.lineStyle||(0,a.le)(t))&&(o?(!(0,a.le)(t=i.bottom)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.bottom):(!(0,a.le)(t=i.horizontal)&&"None"===t.lineStyle||(0,a.le)(t))&&(t=n.horizontal))}return t},e.getCellOf=function(t){if(t instanceof _e)return t.ownerBase instanceof it&&t.ownerBase.ownerBase instanceof e?t.ownerBase.ownerBase:void 0},e.prototype.updateWidgetLeft=function(t){this.x=t,this.updateChildWidgetLeft(t)},e.prototype.updateChildWidgetLeft=function(t){for(var i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].x=t,this.childWidgets[i]instanceof k){var n=this.childWidgets[i];if(n.updateChildWidgetLeft(t),n.isBidiTable){var r=new re(n.x,n.y,n.width,n.height);n.shiftWidgetsForRtlTable(r,n)}}},e.prototype.getMinimumAndMaximumWordWidth=function(t,i){for(var n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n].getMinimumAndMaximumWordWidth(t,i);t=o.minimumWordWidth,i=o.maximumWordWidth}return{minimumWordWidth:t,maximumWordWidth:i}},e.prototype.destroyInternal=function(t){if(!(0,a.le)(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){this.childWidgets[i].destroyInternal(t),i--}this.childWidgets=void 0}this.destroy()},e.prototype.clone=function(){var t=new e;t.cellFormat.copyFormat(this.cellFormat);for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.containerWidget=t,n.index=i}return t.leftBorderWidth=this.leftBorderWidth,t.rightBorderWidth=this.rightBorderWidth,this.margin&&(t.margin=this.margin.clone()),t.columnIndex=this.columnIndex,t.x=this.x,t.y=this.y,t.height=this.height,t.width=this.width,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,s.prototype.destroy.call(this)},e}(Ve),oe=function(){function s(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.paragraph=e}return Object.defineProperty(s.prototype,"renderedElements",{get:function(){return(0,a.le)(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextLine",{get:function(){var e=this.paragraph,t=this.indexInOwner;if(t<=e.childWidgets.length-2)return e.childWidgets[t+1];if(e.nextSplitWidget){var i=e.nextSplitWidget.firstChild;if(i instanceof s&&i.paragraph.equals(this.paragraph))return i}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousLine",{get:function(){var e=this.paragraph,t=this.indexInOwner,i=e.previousSplitWidget;if(t>0)return e.childWidgets[t-1];if(i instanceof I){var n=i.lastChild;if(n instanceof s&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof S)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isEndsWithLineBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof S)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),s.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(e>-1&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof I&&this.paragraph.previousSplitWidget.isEndsWithPageBreak))&&0===e},s.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},s.prototype.getOffset=function(e,t){if((0,a.le)(e))return t;for(var i=t,n=e.line,r=0;r<n.children.length;r++){var o=n.children[r];if(e===o)break;o instanceof _||(i+=o.length)}return i},s.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var n=this.children[i];0!==n.length&&(n instanceof _||((n instanceof S||n instanceof ae||n instanceof xe||n instanceof ee||n instanceof He||n instanceof O||n instanceof $||n instanceof H&&w.isLinkedFieldCharacter(n))&&(e=t+n.length),t+=n.length))}return e},s.prototype.getInline=function(e,t,i,n){i=(0,a.le)(i)?this.paragraph.bidi:i;var r=void 0,o=0,l=!1;if(0===this.children.length&&this.previousLine){var h=this.previousLine.children[this.previousLine.children.length-1];if(h instanceof S&&"\v"===h.text)return{element:r=this.previousLine.children[this.previousLine.children.length-1],index:t=1}}for(var d=0;d<this.children.length;d++)if(!((r=this.children[d])instanceof _)){if(!l&&(r instanceof S||r instanceof ee||r instanceof de||r instanceof $||r instanceof O||r instanceof He||r instanceof xe||r instanceof ae||r instanceof H&&w.isLinkedFieldCharacter(r))&&(l=!0),l&&e<=o+r.length){if(r instanceof S&&" "===r.text&&0===r.revisions.length&&n){var c=this.getNextTextElement(this,d+1);return{element:r=(0,a.le)(c)?r:c,index:t=(0,a.le)(c)?e-o:0}}return e===o+r.length&&this.children[d+1]instanceof Ee?{element:this.children[d+1],index:t}:{element:r,index:t=e-o}}o+=r.length}return e>o&&(t=(0,a.le)(r)?e:r.length),{element:r,index:t}},s.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},s.prototype.getHierarchicalIndex=function(e){var t=this;return e=t.paragraph.childWidgets.indexOf(t)+";"+e,t.paragraph instanceof Ve?t.paragraph.getHierarchicalIndex(e):e},s.prototype.clone=function(){for(var e=new s(void 0),t=0;t<this.children.length;t++){var n=this.children[t].clone();e.children.push(n),n.line=e}return e.width=this.width,e.height=this.height,(0,a.le)(this.margin)||(e.margin=this.margin.clone()),e},s.prototype.destroy=function(){if(!(0,a.le)(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},s}(),fe=function(){function s(){this.x=0,this.y=0,this.width=0,this.height=0,this.margin=new $e(0,0,0,0),this.padding=new $e(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.characterRange=void 0,this.characterFormat=new ie(this),this.margin=new $e(0,0,0,0)}return Object.defineProperty(s.prototype,"isPageBreak",{get:function(){return this instanceof S&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof O||this instanceof ae||this instanceof xe||this instanceof He||this instanceof $)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCheckBoxElement",{get:function(){var e=this;return e instanceof S&&!(0,a.le)(e.text)&&(e.text===String.fromCharCode(9745)||e.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),s.prototype.linkFieldCharacter=function(e){if(this instanceof H)if(0===this.fieldType){var t=this;(0,a.le)(t.fieldEnd)&&(this.linkFieldTraversingForward(this.line,t,t),-1===e.fields.indexOf(t)&&e.fields.push(t),!(0,a.le)(t.formFieldData)&&-1===e.formFields.indexOf(t)&&e.formFields.push(t))}else if(2===this.fieldType){var i=this;if((0,a.le)(i.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,i,i),!(0,a.le)(i.fieldBegin)){i.fieldBegin.fieldSeparator=i;var n=this.linkFieldTraversingForward(this.line,i.fieldBegin,i);(0,a.le)(i.fieldEnd)&&n&&(i.fieldEnd=i.fieldBegin.fieldEnd),i.fieldEnd&&(i.fieldEnd.fieldSeparator=i)}}else{var r=this;(0,a.le)(r.fieldBegin)&&this.linkFieldTraversingBackward(this.line,r,r)}},s.prototype.linkFieldTraversingBackward=function(e,t,i){var n=e.children.length-1;e.children.indexOf(i)>-1&&(n=e.children.indexOf(i)-1);for(var r=n;r>=0;r--){var o=e.children[r];if(o instanceof H)if(0===o.fieldType){if((0,a.le)(o.fieldEnd))return t.fieldBegin=o,(0,a.le)(o.fieldEnd)&&(o.fieldEnd=t),t.fieldSeparator&&(0,a.le)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=o,(0,a.le)(o.fieldSeparator)&&(o.fieldSeparator=t.fieldSeparator)),!(0,a.le)(t.fieldBegin)}else 2===o.fieldType&&(0,a.le)(o.fieldEnd)&&(t.fieldSeparator=o,o.fieldEnd=t,(0,a.le)(o.fieldBegin)||(t.fieldBegin=o.fieldBegin))}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,t,this);else if(e.paragraph.previousRenderedWidget instanceof I&&e.paragraph.previousRenderedWidget.childWidgets.length>0){var l=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(l.childWidgets[l.childWidgets.length-1],t,this)}return!0},s.prototype.linkFieldTraversingForward=function(e,t,i){var n=0;e.children.indexOf(i)>-1&&(n=e.children.indexOf(i)+1);for(var r=n;r<e.children.length;r++){var o=e.children[r];if(o instanceof H){if(1===o.fieldType)return(0,a.le)(o.fieldBegin)&&(t.fieldEnd=o),t.fieldEnd&&(0,a.le)(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if((0,a.le)(t.fieldSeparator)){if(2!==o.fieldType||!(0,a.le)(o.fieldBegin))return!1;if(t.fieldSeparator=o,t.fieldSeparator&&(0,a.le)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!(0,a.le)(o.fieldEnd))return t.fieldEnd=o.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}return e.nextLine?this.linkFieldTraversingForward(e.nextLine,t,this):e.paragraph.nextRenderedWidget instanceof I&&e.paragraph.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this),!0},s.prototype.linkFieldTraversingBackwardSeparator=function(e,t,i){var n=e.children.length-1;e.children.indexOf(i)>-1&&(n=e.children.indexOf(i)-1);for(var r=n;r>=0;r--){var o=e.children[r];if(o instanceof H&&o instanceof H&&0===o.fieldType)return(0,a.le)(o.fieldSeparator)&&(t.fieldBegin=o),!(0,a.le)(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof I&&e.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;this.linkFieldTraversingBackwardSeparator(e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],t,this)}return!0},Object.defineProperty(s.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"indexInOwner",{get:function(){return this.line instanceof oe&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!(0,a.le)(e)&&(e instanceof O||e instanceof ae||e instanceof xe||e instanceof He||e instanceof $);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!(0,a.le)(e)&&(e instanceof O||e instanceof ae||e instanceof xe||e instanceof He||e instanceof $);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){if(!(0,a.le)(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},s.objectCharacter=String.fromCharCode(65532),s}(),H=function(s){function e(t){var i=s.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return Le(e,s),Object.defineProperty(e.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(t){this.fieldBeginInternal=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(t){this.fieldSeparatorInternal=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(t){this.fieldEndInternal=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultText",{get:function(){if(!(0,a.le)(this.formFieldData)&&0===this.fieldType&&!(0,a.le)(this.fieldSeparator)&&!(0,a.le)(this.fieldEnd)){var t=this.fieldSeparator.nextElement,i="";do{if(t instanceof S&&(i+=t.text),(t=t.nextNode)===this.fieldEnd)break}while(t);return i}},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){var t=new e(this.fieldType);if(0===this.fieldType&&!(0,a.le)(this.formFieldData)&&(t.formFieldData=this.formFieldData.clone()),t.characterFormat.copyFormat(this.characterFormat),this.margin&&(t.margin=this.margin.clone()),t.width=this.width,t.height=this.height,!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t.fieldCodeType=this.fieldCodeType,t},e.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,s.prototype.destroy.call(this)},e}(fe),gi=function(){return function(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""}}(),Re=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return Le(e,s),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.name=this.name,t.enabled=this.enabled,t.helpText=this.helpText,t.statusText=this.statusText,t.maxLength=this.maxLength,t.defaultValue=this.defaultValue,t.format=this.format,t},e.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type}},e.prototype.copyFieldInfo=function(t){(0,a.le)(t.defaultValue)||(this.defaultValue=t.defaultValue),(0,a.le)(t.enabled)||(this.enabled=t.enabled),(0,a.le)(t.format)||(this.format=t.format),(0,a.le)(t.helpText)||(this.helpText=t.helpText),(0,a.le)(t.maxLength)||(this.maxLength=t.maxLength),(0,a.le)(t.type)||(this.type=t.type)},e}(gi),qe=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return Le(e,s),e.prototype.clone=function(){var t=new e;return t.name=this.name,t.enabled=this.enabled,t.helpText=this.helpText,t.statusText=this.statusText,t.sizeType=this.sizeType,t.size=this.size,t.defaultValue=this.defaultValue,t.checked=this.checked,t},e.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType}},e.prototype.copyFieldInfo=function(t){(0,a.le)(t.defaultValue)||(this.defaultValue=t.defaultValue,this.checked=t.defaultValue),(0,a.le)(t.enabled)||(this.enabled=t.enabled),(0,a.le)(t.size)||(this.size=t.size),(0,a.le)(t.helpText)||(this.helpText=t.helpText),(0,a.le)(t.sizeType)||(this.sizeType=t.sizeType)},e}(gi),Ge=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return Le(e,s),e.prototype.clone=function(){var t=new e;return t.name=this.name,t.enabled=this.enabled,t.helpText=this.helpText,t.statusText=this.statusText,t.dropdownItems=this.dropdownItems.slice(),t.selectedIndex=this.selectedIndex,t},e.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText}},e.prototype.copyFieldInfo=function(t){(0,a.le)(t.dropdownItems)||(this.dropdownItems=t.dropdownItems),(0,a.le)(t.enabled)||(this.enabled=t.enabled),(0,a.le)(t.helpText)||(this.helpText=t.helpText)},e}(gi),S=function(s){function e(){var t=s.call(this)||this;return t.baselineOffset=0,t.text="",t.trimEndWidth=0,t.ignoreOnceItems=[],t.istextCombined=!1,t.scriptType=Qe.English,t.errorCollection=[],t}return Le(e,s),e.prototype.getLength=function(){return this.text?this.text.length:0},e.prototype.clone=function(){var t=new e;if(t.characterFormat.copyFormat(this.characterFormat),t.text=this.text,this.margin&&(t.margin=this.margin.clone()),t.baselineOffset=this.baselineOffset,!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t.width=this.width,t.height=this.height,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e.prototype.destroy=function(){this.text=void 0,s.prototype.destroy.call(this)},e}(fe),Ut=function(){function s(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}return s.prototype.clear=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},s.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},s}(),Ee=function(s){function e(){var t=s.call(this)||this;return t.isLayout=!1,t.bodyWidget=new j,t.bodyWidget.footNoteReference=t,t}return Le(e,s),e.prototype.clone=function(){var t=new e;return t.text=this.text,t.characterFormat.copyFormat(this.characterFormat),t.height=this.height,t.footnoteType=this.footnoteType,t.width=this.width,t.symbolCode=this.symbolCode,t.bodyWidget.childWidgets=this.bodyWidget.childWidgets,t.bodyWidget.page=this.bodyWidget.page,this.margin&&(t.margin=this.margin.clone()),t},e.prototype.getLength=function(){return 1},e.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget=void 0},e}(S),wt=function(s){function e(){var t=s.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return Le(e,s),Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(t){this.startIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(t){this.endIn=t},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0},e}(S),st=function(s){function e(){var t=s.call(this)||this;return t.fieldText="",t}return Le(e,s),Object.defineProperty(e.prototype,"text",{get:function(){return this.fieldText},set:function(t){this.fieldText=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;if(t.characterFormat.copyFormat(this.characterFormat),t.fieldBegin=this.fieldBegin,t.text=this.text,this.margin&&(t.margin=this.margin.clone()),!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t.width=this.width,t.height=this.height,t},e}(S),at=function(s){function e(){var t=s.call(this)||this;return t.tabText="",t.tabLeader="None",t}return Le(e,s),e.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},e.prototype.clone=function(){var t=new e;if(t.characterFormat.copyFormat(this.characterFormat),t.tabText=this.tabText,t.tabLeader=this.tabLeader,t.text=this.text,this.margin&&(t.margin=this.margin.clone()),t.width=this.width,t.height=this.height,!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t},e}(S),O=function(s){function e(t){var i=s.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return Le(e,s),Object.defineProperty(e.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.nameIn},set:function(t){this.nameIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reference",{get:function(){return this.refereneceIn},set:function(t){this.refereneceIn=t},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return 1},e.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},e.prototype.clone=function(){var t=new e(this.bookmarkType);return t.name=this.name,t.reference=this.reference,this.margin&&(t.margin=this.margin.clone()),t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice(),t.width=this.width,t.height=this.height,this.contentControlProperties&&(t.contentControlProperties=this.contentControlProperties),t},e}(fe),$=function(s){function e(t){var i=s.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new mi(t),i}return Le(e,s),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){var t=new e(this.contentControlWidgetType);if(t.characterFormat.copyFormat(this.characterFormat),t.contentControlProperties=this.contentControlProperties,t.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(t.margin=this.margin.clone()),!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t.type=this.type,t.width=this.width,t.height=this.height,t.reference=this.reference,t},e.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,s.prototype.destroy.call(this)},e}(fe),mi=function(){function s(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new ie}return s.prototype.destroy=function(){this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},s.prototype.clone=function(){var e=new s(this.contentControlWidgetType);if(e.lockContentControl=this.lockContentControl,e.lockContents=this.lockContents,e.tag=this.tag,e.color=this.color,e.title=this.title,e.appearance=this.appearance,e.type=this.type,e.hasPlaceHolderText=this.hasPlaceHolderText,e.multiline=this.multiline,e.isTemporary=this.isTemporary,e.isChecked=this.isChecked,e.dateCalendarType=this.dateCalendarType,e.dateStorageFormat=this.dateStorageFormat,e.dateDisplayLocale=this.dateDisplayLocale,e.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(var t=0;t<this.contentControlListItems.length;t++)e.contentControlListItems.push(this.contentControlListItems[t].clone());return this.checkedState&&(e.checkedState=this.checkedState.clone()),this.uncheckedState&&(e.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(e.xmlMapping=this.xmlMapping.clone()),e},s}(),Bo=function(){function s(){}return s.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},s.prototype.clone=function(){var e=new s;return e.displayText=this.displayText,e.value=this.value,e},s}(),zn=function(){function s(){}return s.prototype.destroy=function(){this.font=void 0,this.value=void 0},s.prototype.clone=function(){var e=new s;return e.font=this.font,e.value=this.value,e},s}(),Mo=function(){function s(){}return s.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},s.prototype.clone=function(){var e=new s;return e.isMapped=this.isMapped,e.isWordMl=this.isWordMl,e.prefixMapping=this.prefixMapping,e.xPath=this.xPath,e.storeItemId=this.storeItemId,this.customXmlPart&&(e.customXmlPart=this.customXmlPart.clone()),e},s}(),Oo=function(){function s(){}return s.prototype.destroy=function(){this.id=void 0,this.xml=void 0},s.prototype.clone=function(){var e=new s;return e.id=this.id,e.xml=this.xml,e},s}(),zo=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.name="",t.alternativeText="",t.title="",t}return Le(e,s),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){return new de},e}(fe),Pe=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return Le(e,s),e}(zo),de=function(s){function e(){return null!==s&&s.apply(this,arguments)||this}return Le(e,s),e.prototype.clone=function(){var t=new e;if(t.characterFormat.copyFormat(this.characterFormat),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.shapeId=this.shapeId,t.name=this.name,t.alternativeText=this.alternativeText,t.title=this.title,t.widthScale=this.widthScale,t.heightScale=this.heightScale,t.visible=this.visible,t.verticalPosition=this.verticalPosition,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalRelativePercent=this.verticalRelativePercent,t.horizontalPosition=this.horizontalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalRelativePercent=this.horizontalRelativePercent,t.zOrderPosition=this.zOrderPosition,t.allowOverlap=this.allowOverlap,t.textWrappingStyle=this.textWrappingStyle,t.textWrappingType=this.textWrappingType,t.distanceBottom=this.distanceBottom,t.distanceLeft=this.distanceLeft,t.distanceRight=this.distanceRight,t.distanceTop=this.distanceTop,t.layoutInCell=this.layoutInCell,t.lockAnchor=this.lockAnchor,t.autoShapeType=this.autoShapeType,this.lineFormat&&(t.lineFormat=this.lineFormat.clone()),this.fillFormat&&(t.fillFormat=this.fillFormat.clone()),this.textFrame&&(t.textFrame=this.textFrame.clone(),t.textFrame.containerShape=t),this.margin&&(t.margin=this.margin.clone()),!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t},e}(Pe),be=function(s){function e(){var t=null!==s&&s.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return Le(e,s),e.prototype.equals=function(){return!1},e.prototype.destroyInternal=function(){},e.prototype.getHierarchicalIndex=function(t){var i=this.containerShape.line,n=i.getOffset(this.containerShape,0).toString();return i.getHierarchicalIndex(n)},e.prototype.getTableCellWidget=function(){},e.prototype.clone=function(){var t=new e;t.textVerticalAlignment=this.textVerticalAlignment,t.marginBottom=this.marginBottom,t.marginLeft=this.marginLeft,t.marginRight=this.marginRight,t.marginTop=this.marginTop;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();t.childWidgets.push(n),n.index=i,n.containerWidget=t}return t},e}(Ze),Vo=function(){function s(){}return s.prototype.clone=function(){var e=new s;return e.lineFormatType=this.lineFormatType,e.color=this.color,e.weight=this.weight,e.dashStyle=this.dashStyle,e.line=this.line,e},s}(),Uo=function(){function s(){}return s.prototype.clone=function(){var e=new s;return e.color=this.color,e.fill=this.fill,e},s}(),ee=function(s){function e(t){var i=s.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.crop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return Le(e,s),Object.defineProperty(e.prototype,"isCrop",{get:function(){return this.crop},set:function(t){if(this.crop=t,t){var i=0,n=0;this.cropX=0!==this.left?this.left*this.cropWidthScale/100:0,this.cropY=0!==this.top?this.top*this.cropHeightScale/100:0,0!==this.right&&(i=this.right*this.cropWidthScale/100),0!==this.bottom&&(n=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+i),this.cropHeight=this.cropHeightScale-(this.cropY+n)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return(0,a.le)(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageString",{get:function(){return this.imageStr},set:function(t){this.imageStr=t,(0,a.le)(t)||(this.element.src=this.imageStr)},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){var t=new e(this.isInlineImage);if(t.characterFormat.copyFormat(this.characterFormat),t.imageString=this.imageString,t.isMetaFile=this.isMetaFile,t.isCompressed=this.isCompressed,t.metaFileImageString=this.metaFileImageString,t.width=this.width,t.height=this.height,t.top=this.top,t.left=this.left,t.bottom=this.bottom,t.right=this.right,t.cropHeightScale=this.cropHeightScale,t.cropWidthScale=this.cropWidthScale,t.cropX=this.cropX,t.cropY=this.cropY,t.isCrop=this.isCrop,this.margin&&(t.margin=this.margin.clone()),!(0,a.le)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++)t.revisions.push(this.revisions[i].clone())}else t.removedIds=this.revisions.length>0?Ke.cloneRevisions(this.revisions):this.removedIds.slice();return t.name=this.name,t.alternativeText=this.alternativeText,t.title=this.title,t.visible=this.visible,t.widthScale=this.widthScale,t.heightScale=this.heightScale,t.verticalPosition=this.verticalPosition,t.verticalOrigin=this.verticalOrigin,t.verticalAlignment=this.verticalAlignment,t.horizontalPosition=this.horizontalPosition,t.horizontalOrigin=this.horizontalOrigin,t.horizontalAlignment=this.horizontalAlignment,t.allowOverlap=this.allowOverlap,t.textWrappingStyle=this.textWrappingStyle,t.textWrappingType=this.textWrappingType,t.layoutInCell=this.layoutInCell,t.zOrderPosition=this.zOrderPosition,t},e.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,s.prototype.destroy.call(this)},e}(Pe),_=function(s){function e(t,i){var n=s.call(this)||this;return n.baselineOffset=0,n.trimEndWidth=0,n.isFollowCharacter=!1,n.listLevel=t,n.isFollowCharacter=i,n}return Le(e,s),e.prototype.getLength=function(){return this.text?this.text.length:0},e.prototype.clone=function(){var t=new e(this.listLevel,this.isFollowCharacter);return t.text=this.text,t.baselineOffset=this.baselineOffset,this.margin&&(t.margin=this.margin.clone()),t.width=this.width,t.height=this.height,t},e.prototype.destroy=function(){this.text=void 0,s.prototype.destroy.call(this)},e}(fe),He=function(s){function e(){var t=s.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return Le(e,s),e.prototype.getLength=function(){return 1},e.prototype.destroy=function(){this.editRangeStart=void 0},e.prototype.clone=function(){var t=new e;return t.editRangeStart=this.editRangeStart,t.editRangeId=this.editRangeId,t},e}(fe),xe=function(s){function e(){var t=s.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return Le(e,s),e.prototype.getLength=function(){return 1},e.prototype.renderLockMark=function(t,i){if((0,a.le)(this.editRangeMark)){var n=t===this.user?"you":this.user;this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark");var r=document.createElement("span");r.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(r),this.editRangeMark.title=i.getConstant("This region is locked by")+" "+n}this.line&&(0,a.le)(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},e.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},e.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},e.prototype.clone=function(){var t=new e;return t.columnFirst=this.columnFirst,t.columnLast=this.columnLast,t.user=this.user,t.group=this.group,t.editRangeEnd=this.editRangeEnd,t.editRangeId=this.editRangeId,t},e}(fe),_t=function(s){function e(){var t=s.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new Vn,t.chartPlotArea=new Vn,t.chartTitleArea=new vi,t.chartLegend=new jo,t.chartPrimaryCategoryAxis=new Gn,t.chartPrimaryValueAxis=new Gn,t.chartDataTable=new Yo,t}return Le(e,s),e.prototype.getLength=function(){return 1},Object.defineProperty(e.prototype,"title",{get:function(){return this.chartTitle},set:function(t){this.chartTitle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.chartType},set:function(t){this.chartType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(t){this.gapWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(t){this.overlap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetElement",{get:function(){return(0,a.le)(this.div)&&(this.div=(0,a.az)("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(t){t&&(this.officeChartInternal=t,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),e.prototype.onChartLoaded=function(){var t=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then(function(i){t.imageString=i})},e.prototype.clone=function(){var t=new e;t.chartTitle=this.chartTitle,t.chartType=this.chartType,t.height=this.height,t.width=this.width,t.gapWidth=this.gapWidth,t.overlap=this.overlap;for(var i=0;i<this.chartCategory.length;i++){var n=this.chartCategory[i].clone();t.chartCategory.push(n)}for(i=0;i<this.chartSeries.length;i++){var r=this.chartSeries[i].clone();t.chartSeries.push(r)}return t.chartArea=this.chartArea.clone(),t.chartPlotArea=this.chartPlotArea.clone(),t.chartLegend=this.chartLegend.clone(),t.chartTitleArea=this.chartTitleArea.clone(),t.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),t.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),t.chartDataTable=this.chartDataTable.clone(),t},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0},e}(ee),Vn=function(){function s(){}return Object.defineProperty(s.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.foreColor=this.foreColor,e},s.prototype.destroy=function(){this.foreColor=void 0},s}(),_o=function(){function s(){this.categoryXName="",this.chartData=[]}return Object.defineProperty(s.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;e.categoryXName=this.categoryXName;for(var t=0;t<this.chartData.length;t++){var i=this.chartData[t].clone();e.chartData.push(i)}return e},s.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]},s}(),qo=function(){function s(){}return Object.defineProperty(s.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.yValue=this.yValue,e.xValue=this.xValue,e.size=this.size,e},s.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0},s}(),jo=function(){function s(){this.chartTitleArea=new vi}return Object.defineProperty(s.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.legendPostion=this.legendPostion,e.chartTitleArea=this.chartTitleArea.clone(),e},s.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0},s}(),Go=function(){function s(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new Ko,this.dataLabels=new _n,this.seriesFormat=new Un}return Object.defineProperty(s.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;e.name=this.name,e.sliceAngle=this.sliceAngle,e.holeSize=this.holeSize,e.errorBar=this.errorBar.clone(),e.dataLabels=this.dataLabels.clone(),e.seriesFormat=this.seriesFormat.clone();for(var t=0;t<this.chartDataFormat.length;t++){var i=this.chartDataFormat[t].clone();e.chartDataFormat.push(i)}for(t=0;t<this.trendLines.length;t++){var n=this.trendLines[t].clone();e.trendLines.push(n)}return e},s.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]},s}(),Ko=function(){function s(){}return Object.defineProperty(s.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.type=this.type,e.errorDirection=this.errorDirection,e.endStyle=this.endStyle,e.errorValue=this.errorValue,e},s.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0},s}(),Un=function(){function s(){}return Object.defineProperty(s.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.style=this.style,e.color=this.color,e.size=this.size,e},s.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0},s}(),_n=function(){function s(){}return Object.defineProperty(s.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.position=this.position,e.name=this.name,e.color=this.color,e.size=this.size,e.isBubble=this.isBubble,e.isLegend=this.isLegend,e.isCategory=this.isCategory,e.isSeries=this.isSeries,e.isValueEnabled=this.isValueEnabled,e.isPercentageEnabled=this.isPercentageEnabled,e.showLeaderLines=this.showLeaderLines,e},s.prototype.destroy=function(){this.position=void 0},s}(),Xo=function(){function s(){}return Object.defineProperty(s.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.type=this.type,e.name=this.name,e.forward=this.forward,e.backward=this.backward,e.intercept=this.intercept,e.displayEquation=this.displayEquation,e.displayRSquared=this.displayRSquared,e},s.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0},s}(),vi=function(){function s(){this.dataFormat=new qn,this.layout=new Zo}return Object.defineProperty(s.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.fontName=this.fontName,e.fontSize=this.fontSize,e.dataFormat=this.dataFormat.clone(),e.layout=this.layout.clone(),e},s.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0},s}(),qn=function(){function s(){this.fill=new jn,this.line=new jn}return s.prototype.clone=function(){var e=new s;return e.fill=this.fill.clone(),e.line=this.line.clone(),e},s.prototype.destroy=function(){this.fill=void 0,this.line=void 0},s}(),jn=function(){function s(){}return Object.defineProperty(s.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.fillColor=this.fillColor,e.fillRGB=this.fillRGB,e},s.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0},s}(),Zo=function(){function s(){}return Object.defineProperty(s.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.layoutX=this.layoutX,e.layoutY=this.layoutY,e},s.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0},s}(),Gn=function(){function s(){this.chartTitleArea=new vi}return Object.defineProperty(s.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.title=this.title,e.categoryType=this.categoryType,e.numberFormat=this.numberFormat,e.fontSize=this.fontSize,e.fontName=this.fontName,e.hasMajorGridLines=this.hasMajorGridLines,e.hasMinorGridLines=this.hasMinorGridLines,e.minimumValue=this.minimumValue,e.maximumValue=this.maximumValue,e.majorUnit=this.majorUnit,e.majorTickMark=this.majorTickMark,e.minorTickMark=this.minorTickMark,e.tickLabelPostion=this.tickLabelPostion,e.chartTitleArea=this.chartTitleArea.clone(),e},s.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0},s}(),Yo=function(){function s(){}return Object.defineProperty(s.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s;return e.isSeriesKeys=this.isSeriesKeys,e.isHorzBorder=this.isHorzBorder,e.isVertBorder=this.isVertBorder,e.isBorders=this.isBorders,e},s.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0},s}(),ae=function(s){function e(t){var i=s.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return Le(e,s),Object.defineProperty(e.prototype,"comment",{get:function(){return this.commentInternal},set:function(t){this.commentInternal=t},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){var t=new e(this.commentType);return t.commentId=this.commentId,t.commentType=this.commentType,t},e.prototype.renderCommentMark=function(){if(0===this.commentType&&(0,a.le)(this.commentMark)){this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark");var t=document.createElement("span");t.classList.add("e-icons"),t.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(t)}this.line&&(0,a.le)(this.commentMark.parentElement)&&(this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)))},e.prototype.selectComment=function(){var t=this.line.paragraph.bodyWidget.page.documentHelper;t.owner&&(t.owner.commentReviewPane.commentPane.isEditMode?t.owner.showComments=!0:t.selectComment(this.comment))},e.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},e.prototype.destroy=function(){this.commentMark&&this.removeCommentMark()},e}(fe),qt=function(s){function e(t){var i=s.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.createdDate=t,i.replyComments=[],i}return Le(e,s),Object.defineProperty(e.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(t){this.commentStartIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(t){this.commentEndIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"author",{get:function(){return this.authorIn},set:function(t){this.authorIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initial",{get:function(){return this.initialIn},set:function(t){this.initialIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isResolved",{get:function(){return this.done},set:function(t){this.done=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.textIn},set:function(t){this.textIn=t},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return 1},e.prototype.clone=function(){var t=new e(this.date);return t.author=this.author,t.initial=this.initial,t.commentId=this.commentId,t.replyComments=this.replyComments,t.isResolved=this.isResolved,t.text=this.text,t},e.prototype.destroy=function(){this.ownerComment=void 0},e}(ae),yi=function(){function s(e){this.boundingRectangle=new re(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}return Object.defineProperty(s.prototype,"headerWidget",{get:function(){return!(0,a.le)(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"footerWidget",{get:function(){return!(0,a.le)(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!(0,a.le)(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!(0,a.le)(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,(0,a.le)(this.documentHelper)||(0,a.le)(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},s}(),Kn=function(){function s(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(s.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),s.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},s.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,n=e;n<t;n++)i+=this.tableColumns[n].preferredWidth;return i},s.prototype.addColumns=function(e,t,i,n,r,o){for(var l=this.columns.length;l<t;l++)this.columns.push(new Jo);for(var h=0,d=e;d<t;d++)h+=this.columns[d].preferredWidth;!(t-e>1)&&h<i&&(this.columns[t-1].preferredWidth+=i-h),n.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=n.minimumWordWidth),n.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=n.maximumWordWidth),n.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=n.minimumWidth),r>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=r),this.columns[t-1].widthType=o},s.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];t+=0===e?n.preferredWidth:1===e?n.minimumWordWidth:2===e?n.maximumWordWidth:n.minimumWidth}return t},s.prototype.isFitColumns=function(e,t,i){var n=this.getTotalWidth(0);if(this.tableWidth=i&&t>n?n:t,n!==this.tableWidth){var r=this.tableWidth/n;r=isNaN(r)||r===1/0?1:r;for(var o=0;o<this.columns.length;o++){var l=this.columns[o];if(r*l.preferredWidth<l.minWidth)return!1}return!0}return!0},s.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},s.prototype.autoFitColumn=function(e,t,i,n,r,o){for(var l=0,h=0,d=0,c=!0,u=0,p=[],f=0;f<this.columns.length;f++){0===(g=this.columns[f]).minimumWordWidth&&0===g.maximumWordWidth&&0===g.minWidth&&(g.minimumWordWidth=g.preferredWidth,g.maximumWordWidth=g.preferredWidth,g.minWidth=g.preferredWidth),"Point"!==g.widthType&&(c=!1);var m=0;l+=g.preferredWidth>g.maximumWordWidth?g.preferredWidth:g.maximumWordWidth,h+=g.preferredWidth>g.minimumWordWidth?g.preferredWidth:g.minimumWordWidth,d+=(m=g.maximumWordWidth-(0===g.preferredWidth?g.minimumWordWidth:g.preferredWidth>g.minimumWordWidth?g.preferredWidth:g.minimumWordWidth))>0?m:0,g.preferredWidth<g.minimumWordWidth?u+=g.minimumWordWidth-g.preferredWidth:p.push(f)}if(l<=t){for(f=0;f<this.columns.length;f++)"Point"!==(g=this.columns[f]).widthType?g.preferredWidth<g.maximumWordWidth&&(g.preferredWidth=g.maximumWordWidth):g.preferredWidth<g.minimumWordWidth&&(g.preferredWidth=g.minimumWordWidth);i||this.fitColumns(e,t,i)}else{var y=this.getTotalWidth(0);if(c&&!r&&h>e&&(e>y&&(u-=e-y),p.length>0&&u>0)){var b=u/p.length;for(f=0;f<this.columns.length;f++)(g=this.columns[f]).preferredWidth=-1===p.indexOf(f)?g.minimumWordWidth:g.preferredWidth-b;y=this.getTotalWidth(0)}if(!i){var C=!1;return t<h&&h+((0,a.le)(o)?0:o)<e&&(C=!0),void this.fitColumns(e,C?h:t,i)}if(h<=t||h<=e){var F=e>t?e:t;for(F-=h,f=0;f<this.columns.length;f++)if("Point"!==(g=this.columns[f]).widthType){(0===g.preferredWidth||g.preferredWidth<g.minimumWordWidth)&&(g.preferredWidth=g.minimumWordWidth);var T=F*((m=(m=g.maximumWordWidth-g.preferredWidth)>0?m:0)/d);g.preferredWidth+=isNaN(T)?0:T}}else{var x=this.getTotalWidth(1),P=this.getTotalWidth(3);if(P>2112){var E=2112/this.columns.length;for(f=0;f<this.columns.length;f++)this.columns[f].preferredWidth=E}else if(F=0,P<e&&e-P>=1&&!c||c&&!r&&x>e)for(F=e-P,f=0;f<this.columns.length;f++)T=F*(g=this.columns[f]).minimumWordWidth/x,T=isNaN(T)?0:T,g.preferredWidth=(0==g.minimumWidth?1:g.minimumWidth)+T;else if(y>e)for(T=e/y,f=0;f<this.columns.length;f++){var g;(g=this.columns[f]).preferredWidth=g.preferredWidth*T}}}this.tableWidth=this.getTotalWidth(0)},s.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];if(i<e)t=n.endOffset;else{if(t!==n.endOffset)break;e++}}return e},s.prototype.fitColumns=function(e,t,i,n){(0,a.le)(n)&&(n=0);var r=this.getTotalWidth(0);if(i&&(r-=n),this.tableWidth=i?r:t,r!==this.tableWidth){var o=this.tableWidth/r;o=isNaN(o)||o===1/0?1:o;for(var l=0;l<this.columns.length;l++){var h=this.columns[l];h.preferredWidth=o*h.preferredWidth}}},s.prototype.getCellWidth=function(e,t,i){for(var n=0,r=0;r<t;r++)n+=this.tableColumns[r+e].preferredWidth;return n},s.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(this.columns[e].preferredWidth=0===this.columns[e-1].endOffset?this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].endOffset-this.columns[e-1].endOffset)},s.prototype.getPreviousValidOffset=function(e){for(var t=e;t>=0;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},s.prototype.clone=function(){var e=new s;e.tableWidth=this.tableWidth;for(var t=0;t<this.columns.length;t++)e.columns.push(this.columns[t].clone());return e},s.prototype.destroy=function(){if(!(0,a.le)(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},s}(),Jo=function(){function s(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}return s.prototype.clone=function(){var e=new s;return e.preferredWidth=this.preferredWidth,e.minWidth=this.minWidth,e.maxWidth=this.maxWidth,e},s.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},s}(),bi=function(){return function(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1}}(),wi="_contextmenu_lock",Ci="_contextmenu_unlock",Fi="_contextmenu_copy",xi="_contextmenu_cut",Ti="_contextmenu_paste",Si="_add_comment",Pi="_contextmenu_update_field",Hi="_contextmenu_edit_field",Ii="_contextmenu_hyperlink",Li="_contextmenu_open_hyperlink",Ei="_contextmenu_copy_hyperlink",ki="_contextmenu_remove_hyperlink",Wi="_properties",Ri="_contextmenu_edit_hyperlink",Ni="_contextmenu_font_dialog",Di="_contextmenu_paragraph_dialog",Ai="_contextmenu_table_dialog",Xn="_contextmenu_insert_table",Zn="_contextmenu_delete_table",Yn="_contextmenu_insert_above",Jn="_contextmenu_insert_below",Qn="_contextmenu_insert_right",$n="_contextmenu_insert_left",er="_contextmenu_complete_table_delete",tr="_contextmenu_delete_row",ir="_contextmenu_delete_column",Bi="_contextmenu_merge_cell",nr="_contextmenu_auto_fit",rr="_contextmenu_auto_fit_contents",or="_contextmenu_auto_fit_window",sr="_contextmenu_fixed_column_width",Mi="_contextmenu_continue_numbering",Oi="_contextmenu_restart_at",ar="_contextmenu_spelling_dialog",lr="_contextmenu_otherSuggestions_spellcheck_",hr="_contextmenu_no_suggestion",zi="_contextmenu_accept_changes",Vi="_contextmenu_reject_changes",Ui="_contextmenu_note_options",dr=function(){function s(e){var t=this;this.contextMenuInstance=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[],this.spellContextItems=[],this.customItems=[],this.onContextMenuInternal=function(i){if(MouseEvent,t.documentHelper.owner.isSpellCheck&&t.spellChecker.allowSpellCheckAndSuggestion){i.preventDefault(),t.currentContextInfo=t.spellChecker.findCurretText();var r,o,l=t.spellChecker.manageSpecialCharacters(t.currentContextInfo.text,void 0,!0);!(0,a.le)(l)&&t.spellChecker.errorWordCollection.containsKey(l)?(t.spellChecker.currentContextInfo=t.currentContextInfo,t.spellChecker.errorSuggestions.containsKey(l)?(o=t.spellChecker.errorSuggestions.get(l).slice(),r=t.spellChecker.handleSuggestions(o),t.processSuggestions(o,r,i)):t.spellChecker.enableOptimizedSpellCheck?t.spellChecker.callSpellChecker(t.spellChecker.languageID,l,!1,!0,!1,!1).then(function(h){var d=JSON.parse(h);(0,a.le)(o=d.Suggestions)||(t.spellChecker.errorSuggestions.add(l,o.slice()),r=t.spellChecker.handleSuggestions(o)),t.processSuggestions(o,r,i)}):t.processSuggestions(o,r,i)):(t.hideSpellContextItems(),t.showContextMenuOnSel(i))}else t.hideSpellContextItems(),t.showContextMenuOnSel(i)},this.documentHelper=e,this.locale=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale),this.locale.setLocale(this.documentHelper.owner.locale),this.initContextMenu(this.locale,this.documentHelper.owner.enableRtl)}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"ContextMenu"},s.prototype.initContextMenu=function(e,t){var i=this,n=this.documentHelper.owner.element.id;this.contextMenu=document.createElement("div"),this.contextMenu.id=this.documentHelper.owner.containerId+"e-de-contextmenu",document.body.appendChild(this.contextMenu);var r=document.createElement("ul");r.contentEditable="false",r.style.width="auto",r.id=this.documentHelper.owner.containerId+"e-de-contextmenu-list",r.style.listStyle="none",r.style.margin="0px",r.style.maxHeight="auto",r.oncontextmenu=this.disableBrowserContextmenu,this.contextMenu.appendChild(r),this.menuItems=[{text:e.getConstant("Lock"),iconCss:"e-icons e-de-ctnr-lock",id:n+wi},{text:e.getConstant("Unlock"),iconCss:"e-icons",id:n+Ci},{text:e.getConstant("Cut"),iconCss:"e-icons e-de-cut",id:n+xi},{text:e.getConstant("Copy"),iconCss:"e-icons e-de-copy",id:n+Fi},{text:e.getConstant("Paste"),iconCss:"e-icons e-de-paste",id:n+Ti},{separator:!0},{text:e.getConstant("New Comment"),iconCss:"e-icons e-de-cmt-add",id:n+Si},{separator:!0},{text:e.getConstant("Accept Changes"),iconCss:"e-icons e-de-acceptchange",id:n+zi},{text:e.getConstant("Reject Changes"),iconCss:"e-icons e-de-rejectchange",id:n+Vi},{text:e.getConstant("Update Field"),iconCss:"e-icons e-de-update-field",id:n+Pi},{text:e.getConstant("Edit Field")+"...",iconCss:"e-icons e-de-edit_field",id:n+Hi},{text:e.getConstant("Continue Numbering"),iconCss:"e-icons e-de-continue-numbering",id:n+Mi},{text:e.getConstant("Restart At")+" 1",iconCss:"e-icons e-de-restart-at",id:n+Oi},{separator:!0},{text:e.getConstant("Hyperlink")+"...",iconCss:"e-icons e-de-insertlink",id:n+Ii},{text:e.getConstant("Edit Hyperlink")+"...",iconCss:"e-icons e-de-edit-hyperlink",id:n+Ri},{text:e.getConstant("Open Hyperlink"),iconCss:"e-icons e-de-open-hyperlink",id:n+Li},{text:e.getConstant("Copy Hyperlink"),iconCss:"e-icons e-de-copy-hyperlink",id:n+Ei},{text:e.getConstant("Remove Hyperlink"),iconCss:"e-icons e-de-remove-hyperlink",id:n+ki},{text:e.getConstant("Properties"),iconCss:"e-icons e-de-formproperties",id:n+Wi},{separator:!0},{text:e.getConstant("Font")+"...",iconCss:"e-icons e-de-fonts",id:n+Ni},{text:e.getConstant("Paragraph")+"...",iconCss:"e-icons e-de-paragraph",id:n+Di},{text:e.getConstant("Notes Options")+"...",id:n+Ui},{separator:!0},{text:e.getConstant("Table Properties")+"...",id:n+Ai,iconCss:"e-icons e-de-table"},{text:e.getConstant("Merge Cells"),id:n+Bi,iconCss:"e-icons e-de-ctnr-mergecell"},{text:e.getConstant("AutoFit"),id:n+nr,iconCss:"e-icons",items:[{text:e.getConstant("AutoFit to Contents"),id:n+rr,iconCss:"e-icons e-de-icon-autofit e-de-autofit-contents"},{text:e.getConstant("AutoFit to Window"),id:n+or,iconCss:"e-icons e-de-icon-auto-fitwindow e-de-autofit-window"},{text:e.getConstant("Fixed Column Width"),id:n+sr,iconCss:"e-icons e-de-icon-fixed-columnwidth e-de-fixed-column"}]},{text:e.getConstant("Insert"),id:n+Xn,iconCss:"e-icons",items:[{text:e.getConstant("Insert Above"),id:n+Yn,iconCss:"e-icons e-de-insertabove"},{text:e.getConstant("Insert Below"),id:n+Jn,iconCss:"e-icons e-de-insertbelow"},{text:e.getConstant("Insert Left"),id:n+$n,iconCss:"e-icons e-de-insertleft"},{text:e.getConstant("Insert Right"),id:n+Qn,iconCss:"e-icons e-de-insertright"}]},{text:e.getConstant("Delete"),id:n+Zn,iconCss:"e-icons",items:[{text:e.getConstant("Delete Table"),id:n+er,iconCss:"e-icons e-de-delete-table"},{text:e.getConstant("Delete Row"),id:n+tr,iconCss:"e-icons e-de-deleterow"},{text:e.getConstant("Delete Column"),id:n+ir,iconCss:"e-icons e-de-deletecolumn"}]}];var o={target:"#"+this.documentHelper.owner.containerId+"e-de-contextmenu",enableRtl:t,items:this.addMenuItems(this.menuItems),select:function(l){i.handleContextMenuItem(l.element.id)}};this.contextMenuInstance=new tt.xV(o,"#"+this.documentHelper.owner.containerId+"e-de-contextmenu-list"),this.contextMenuInstance.beforeOpen=function(){for(var l=0;l<i.customMenuItems.length;l++)i.ids[l]=void 0!==i.customMenuItems[l].id?i.customMenuItems[l].id:i.customMenuItems[l+1].id;if(i.documentHelper.owner.fireCustomContextMenuBeforeOpen(i.ids),i.enableCustomContextMenu)for(l=0;l<i.menuItems.length;l++)void 0!==i.menuItems[l].id?document.getElementById(i.menuItems[l].id).style.display="none":document.getElementById(i.menuItems[l-1].id).nextSibling.style.display="none";i.viewer&&i.documentHelper.selection&&((0,a.s1)(i.documentHelper.selection.caret,[],["e-de-cursor-animation"]),i.documentHelper.selection.showCaret())},this.contextMenuInstance.onClose=function(){i.viewer&&i.documentHelper.selection&&((0,a.s1)(i.documentHelper.selection.caret,["e-de-cursor-animation"],[]),i.documentHelper.updateFocus())}},s.prototype.disableBrowserContextmenu=function(){return!1},s.prototype.handleContextMenuItem=function(e){var t=this.documentHelper.owner.element.id;switch(e){case t+wi:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.lockContent(this.documentHelper.owner.currentUser);break;case t+Ci:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.unlockContent(this.documentHelper.owner.currentUser);break;case t+Fi:this.documentHelper.selection.copy();break;case t+xi:this.documentHelper.owner.editor.cut();break;case t+Ti:this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.editorModule.pasteInternal(void 0);break;case t+Si:(!this.documentHelper.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode)&&(this.documentHelper.owner.editor.isUserInsert=!0,this.documentHelper.owner.editorModule.insertComment(),this.documentHelper.owner.editor.isUserInsert=!1);break;case t+Pi:var i=this.documentHelper.owner.isReadOnlyMode;this.documentHelper.selection.isReferenceField()&&(!i||i&&"FormFieldsOnly"===this.documentHelper.protectionType)?this.documentHelper.selection.updateRefField():this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.editorModule.updateToc();break;case t+Hi:this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.tableOfContentsDialogModule.show();break;case t+Ni:this.documentHelper.owner.fontDialogModule&&this.documentHelper.owner.fontDialogModule.showFontDialog();break;case t+Li:this.documentHelper.selection.navigateHyperlink();break;case t+Ei:this.documentHelper.selection.copyHyperlink();break;case t+Ri:case t+Ii:this.documentHelper.owner.hyperlinkDialogModule&&this.documentHelper.owner.hyperlinkDialogModule.show();break;case t+ki:this.documentHelper.owner.editor.removeHyperlink();break;case t+Di:this.documentHelper.owner.paragraphDialogModule&&this.documentHelper.owner.paragraphDialogModule.show();break;case t+Ai:this.documentHelper.owner.tablePropertiesDialogModule.show();break;case t+Bi:this.documentHelper.owner.editor.mergeCells();break;case t+Yn:this.documentHelper.owner.editor.insertRow(!0);break;case t+Jn:this.documentHelper.owner.editor.insertRow(!1);break;case t+$n:this.documentHelper.owner.editor.insertColumn(!0);break;case t+Qn:this.documentHelper.owner.editor.insertColumn(!1);break;case t+er:this.documentHelper.owner.editor.deleteTable();break;case t+tr:this.documentHelper.owner.editor.deleteRow();break;case t+ir:this.documentHelper.owner.editor.deleteColumn();break;case t+Mi:this.documentHelper.owner.editorModule.applyContinueNumbering();break;case t+Oi:this.documentHelper.owner.editorModule.applyRestartNumbering(this.documentHelper.selection);break;case t+rr:this.documentHelper.owner.editor.autoFitTable("FitToContents");break;case t+or:this.documentHelper.owner.editor.autoFitTable("FitToWindow");break;case t+sr:this.documentHelper.owner.editor.autoFitTable("FixedColumnWidth");break;case t+ar:var n=this.spellChecker.retriveText();this.currentContextInfo=null,this.documentHelper.owner.spellCheckDialog.show(n.text,n.element);break;case t+zi:this.documentHelper.selection.handleAcceptReject(!0);break;case t+Vi:this.documentHelper.selection.handleAcceptReject(!1);break;case t+Wi:var r=this.documentHelper.selection.getCurrentFormField();r instanceof H&&(r.formFieldData instanceof Re?this.documentHelper.owner.textFormFieldDialogModule.show():r.formFieldData instanceof qe?this.documentHelper.owner.checkBoxFormFieldDialogModule.show():r.formFieldData instanceof Ge&&this.documentHelper.owner.dropDownFormFieldDialogModule.show());break;case t+Ui:this.documentHelper.owner.showFootNotesDialog();break;default:var o=this.documentHelper.owner.element.id+lr;if(e.substring(0,o.length)===o){var l=e.substring(e.lastIndexOf("_")+1);this.callSelectedOption(l);break}this.documentHelper.owner.fireCustomContextMenuSelect(e)}},s.prototype.callSelectedOption=function(e){"Add to Dictionary"===e?this.spellChecker.handleAddToDictionary():"Ignore All"===e?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(e)},s.prototype.addCustomMenu=function(e,t,i){var n=JSON.parse(JSON.stringify(e));this.destroy(),0===this.spellContextItems.length&&(this.customItems=e);for(var r=0;r<n.length;r++)this.customMenuItems.push(n[r]),this.customMenuItems[r].id=this.documentHelper.owner.element.id+this.customMenuItems[r].id;this.enableCustomContextMenu=t,this.enableCustomContextMenuBottom=i,this.initContextMenu(this.locale)},s.prototype.addMenuItems=function(e){return this.enableCustomContextMenuBottom?e.concat(this.customMenuItems):this.customMenuItems.concat(e)},s.prototype.showContextMenuOnSel=function(e){var t=!(e instanceof MouseEvent),i=0,n=0;if(t){var r=this.documentHelper.getTouchOffsetValue(e);i=r.x,n=r.y}else n=(a.AR.isIE?e.clientY:e.y)+document.body.scrollTop+document.documentElement.scrollTop,i=(a.AR.isIE?e.clientX:e.x)+document.body.scrollLeft+document.documentElement.scrollLeft;this.showHideElements(this.documentHelper.selection)&&(t&&(this.documentHelper.isMouseDown=!1),this.contextMenuInstance.open(n,i),e.preventDefault())},s.prototype.hideSpellContextItems=function(){if(this.spellContextItems.length>0)for(var e=0;e<this.spellContextItems.length;e++){var t=document.getElementById(this.documentHelper.owner.element.id+this.spellContextItems[e].id);(0,a.le)(t)||(t.style.display="none")}},s.prototype.processSuggestions=function(e,t,i){this.spellContextItems=this.constructContextmenu(e,t),this.addCustomMenu(this.spellContextItems),this.noSuggestion=document.getElementById(this.documentHelper.owner.element.id+hr),(0,a.le)(this.noSuggestion)||(this.noSuggestion.style.display="block",(0,a.s1)(this.noSuggestion,["e-disabled"],["e-focused"])),this.showContextMenuOnSel(i)},s.prototype.constructContextmenu=function(e,t){var i=this.customItems.length>0?this.customItems.slice():[];if((0,a.le)(e)||0===e.length)i.push({text:this.locale.getConstant("no suggestions"),id:hr,classList:["e-focused"],iconCss:""});else for(var n=0;n<e.length;n++)i.push({text:e[n],id:lr+e[n],iconCss:""});return i.push({separator:!0,id:"_contextmenu_suggestion_separator"}),!(0,a.le)(t)&&t.length>1?(i.push({text:this.locale.getConstant("More Suggestion"),items:t}),i.push({separator:!0,id:"_contextmenu_moreSuggestion_separator"})):i.push({text:this.locale.getConstant("Add to Dictionary"),id:"_contextmenu_otherSuggestions_spellcheck_Add to Dictionary",iconCss:""}),i.push({text:this.locale.getConstant("Ignore Once"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore Once",iconCss:""}),i.push({text:this.locale.getConstant("Ignore All"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore All",iconCss:""}),i.push({separator:!0,id:"_contextmenu_change_separator"}),i.push({text:this.locale.getConstant("Spelling"),id:ar,iconCss:"e-icons e-de-spellcheck",items:[]}),i.push({separator:!0,id:"_contextmenu_spelling_separator"}),i},s.prototype.showHideElements=function(e){if((0,a.le)(e))return!1;e.hideToolTip();var t=this.documentHelper.owner,i=t.element.id,n=document.getElementById(i+wi),r=document.getElementById(i+Ci),o=document.getElementById(i+Fi),l=document.getElementById(i+xi),h=document.getElementById(i+Ti),d=document.getElementById(i+Pi),c=document.getElementById(i+Hi),u=document.getElementById(i+Ni),p=document.getElementById(i+Di),f=document.getElementById(i+Ai),g=document.getElementById(i+Xn),m=document.getElementById(i+Zn),v=document.getElementById(i+Bi),y=document.getElementById(i+Ii),b=document.getElementById(i+Li),C=document.getElementById(i+Ri),F=document.getElementById(i+Ei),T=document.getElementById(i+ki),x=document.getElementById(i+Wi),P=document.getElementById(i+Mi),E=document.getElementById(i+Oi),L=document.getElementById(i+nr),W=document.getElementById(i+Si),R=document.getElementById(i+Ui);this.documentHelper.owner.enableLockAndEdit?this.documentHelper.editRanges.containsKey(this.documentHelper.owner.currentUser)?(n.style.display="none",r.style.display="block",this.documentHelper.selection.isSelectionInEditRegion()?(0,a.s1)(r,["e-blankicon"],["e-disabled"]):(0,a.s1)(r,["e-disabled","e-blankicon"],[])):(n.style.display="block",this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.canLock()?(0,a.s1)(r,["e-disabled"],[]):(0,a.s1)(r,[],["e-disabled"]),r.style.display="none"):(n.style.display="none",r.style.display="none");var N=!1;l.style.display="none",h.style.display="none",h.nextSibling.style.display="none";var B=document.getElementById(i+zi),q=document.getElementById(i+Vi);y.style.display="none",R.style.display="none",R.nextSibling.style.display="none",u.previousSibling.style.display="none",b.style.display="none",F.style.display="none",C.style.display="none",T.style.display="none",T.nextSibling.style.display="none",x.style.display="none",v.style.display="none",L.style.display="none",u.style.display="none",p.style.display="none",g.style.display="none",m.style.display="none",f.style.display="none",d.style.display="none";var A=e.getHyperlinkField(),X=!1;B.style.display="none",q.style.display="none",A instanceof H&&e.isReferenceField(A)&&(X=!0),A instanceof H&&X&&("FormFieldsOnly"===this.documentHelper.protectionType||!this.documentHelper.owner.isReadOnlyMode)&&(d.style.display="block"),c.style.display="none",P.style.display="none",E.style.display="none",E.nextSibling.style.display="none";var le=e.isEmpty;(0,a.s1)(l,le?["e-disabled"]:[],le?[]:["e-disabled"]),(0,a.s1)(o,le?["e-disabled"]:[],le?[]:["e-disabled"]);var K=this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment;if(W.style.display=K?"none":"block",this.documentHelper.isCommentOnlyMode&&(W.style.display="block"),W.previousSibling.style.display=K?"none":"block",W.nextSibling.style.display=K?"none":"block",t.isReadOnlyMode)return!0;this.viewer&&this.documentHelper.owner&&this.documentHelper.owner.commentReviewPane&&this.documentHelper.owner.commentReviewPane.commentPane.isEditMode?(0,a.s1)(W,["e-disabled"],[]):(0,a.s1)(W,[],["e-disabled"]),B.previousSibling.style.display="none",l.style.display="block",h.style.display="block",h.nextSibling.style.display="block",(0,a.s1)(g,["e-blankicon"],[]),(0,a.s1)(m,["e-blankicon"],[]),(0,a.s1)(c,["e-blankicon"],[]),(0,a.s1)(L,["e-blankicon"],[]);var he=t.enableLocalPaste&&!(0,a.le)(t.editor.copiedData);if((0,a.s1)(h,he?[]:["e-disabled"],he?["e-disabled"]:[]),"TableOfContents"===e.contextType)d.style.display="block",c.style.display="block";else{var ge=e.start,te=e.end;"List"===e.contextType&&"Bullet"!==t.selection.getListLevel(ge.paragraph).listLevelPattern&&(P.style.display="block",E.style.display="block",E.nextSibling.style.display="block"),!ge.paragraph.isInsideTable||te.paragraph.isInsideTable&&ge.paragraph.associatedCell===te.paragraph.associatedCell&&!e.isCellSelected(ge.paragraph.associatedCell,ge,te)?y.classList.contains("e-disabled")&&y.classList.remove("e-disabled"):y.classList.add("e-disabled"),A instanceof H&&!e.isImageField()&&!X?(b.style.display="block",F.style.display="block",t.hyperlinkDialogModule&&(C.style.display="block"),T.style.display="block",T.nextSibling.style.display="block",N=!0,x.style.display="none"):t.hyperlinkDialogModule&&(y.style.display="block",u.previousSibling.style.display="block",N=!0),e.isFormField()&&this.documentHelper.owner.enableFormField&&(y.style.display="none",x.style.display="block"),A instanceof H&&X&&(y.style.display="none",d.style.display="block")}return this.documentHelper.owner.selection.start.paragraph.isInsideTable&&this.documentHelper.owner.selection.end.paragraph.isInsideTable&&(t.tablePropertiesDialogModule&&(f.style.display="block"),g.style.display="block",m.style.display="block",this.documentHelper.owner.editor.canMergeCells()&&(v.style.display="block"),L.style.display=this.documentHelper.selection.isTableSelected()?"block":"none"),this.documentHelper.owner.fontDialogModule&&(u.style.display="block"),this.documentHelper.owner.paragraphDialogModule?p.style.display="block":!N&&!this.documentHelper.owner.fontDialogModule&&!K&&(W.nextSibling.style.display="none"),"Image"===e.contextType&&(u.style.display="none",p.style.display="none",u.previousSibling.style.display="none",T.nextSibling.style.display="none"),this.documentHelper.selection.hasRevisions()&&(B.previousSibling.style.display=this.documentHelper.owner.enableHeaderAndFooter?"none":"block",this.documentHelper.isTrackedOnlyMode?(B.style.display="none",q.style.display="none"):(B.style.display="block",q.style.display="block")),(this.documentHelper.selection.isinFootnote||this.documentHelper.selection.isinEndnote)&&(R.style.display="block"),!0},s.prototype.destroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.contextMenuInstance=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[]},s}(),Qo=function(){function s(e){var t=this;this.isNewComment=!1,this.isUserClosed=!1,this.selectedTab=0,this.onTabSelection=function(n){t.selectedTab=n.selectedIndex,1===t.selectedTab?t.owner.trackChangesPane.updateHeight():t.commentPane.updateHeight(),setTimeout(function(){t.owner&&t.owner.resize()},10)},this.owner=e;var i=new a.E7("documenteditor",this.owner.defaultLocale);i.setLocale(this.owner.locale),this.initReviewPane(i),this.parentPaneElement.style.display="none"}return Object.defineProperty(s.prototype,"previousSelectedComment",{get:function(){return this.previousSelectedCommentInt},set:function(e){if(!(0,a.le)(e)&&e!==this.previousSelectedCommentInt&&this.commentPane.comments.containsKey(e)){var i=this.commentPane.getCommentStart(e).commentMark;i&&((0,a.s1)(i,[],["e-de-cmt-mark-selected"]),this.commentPane.removeSelectionMark("e-de-cmt-selection"),this.commentPane.removeSelectionMark("e-de-cmt-mark-selected"));var n=this.commentPane.comments.get(e);n.hideDrawer();for(var r=0;r<e.replyComments.length;r++)(n=this.commentPane.comments.get(e.replyComments[r]))&&(n.hideDrawer(),n.hideMenuItems())}this.previousSelectedCommentInt=e},enumerable:!0,configurable:!0}),s.prototype.selectReviewTab=function(e){this.reviewTab.select("Changes"===e?1:0)},s.prototype.showHidePane=function(e,t){this.parentPaneElement&&(this.updateTabHeaderWidth(),e?(this.parentPaneElement.style.display="block","Changes"===t?(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:!0}),this.reviewTab.select(1)):(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible,isUserClosed:!1}),this.reviewTab.select(0)),this.owner.trackChangesPane.updateTrackChanges(e),this.commentPane.updateCommentStatus()):this.parentPaneElement.style.display="none"),e&&(this.enableDisableItems(),this.commentPane.updateHeight()),this.owner&&this.owner.resize()},s.prototype.reviewPaneHelper=function(e){var t=this;if((0,a.le)(e.isUserClosed)){if(this.isUserClosed)return}else{if(e.isUserClosed===this.isUserClosed)return;this.isUserClosed=e.isUserClosed,this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)}(!(0,a.le)(e.comment)||!(0,a.le)(e.changes))&&(e.comment||e.changes?"none"===this.parentPaneElement.style.display&&(this.parentPaneElement.style.display="block",this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)):(this.parentPaneElement.style.display="none",this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)))},s.prototype.updateTabHeaderWidth=function(){var e=this.reviewTab.getRootElement().getElementsByClassName("e-tab-wrap");e[0].style.padding="0 8px",e[1].style.padding="0 8px"},s.prototype.initReviewPane=function(e){var t=this.owner.documentHelper.optionsPaneContainer;t.style.display="inline-flex",this.initPaneHeader(e),t.appendChild(this.addReviewTab(e)),this.initCommentPane(),this.owner.on("reviewPane",this.reviewPaneHelper,this)},s.prototype.addReviewTab=function(e){var t=(0,a.az)("div",{innerHTML:e.getConstant("Comments")}),i=(0,a.az)("div",{innerHTML:e.getConstant("Changes")});return this.parentPaneElement=(0,a.az)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-review-pane"}),this.element=(0,a.az)("div",{className:"e-de-property-tab"}),this.reviewTab=new tt.OK({items:[{header:{text:t},content:this.reviewPane},{header:{text:i}}],selected:this.onTabSelection,animation:{previous:{effect:"None"},next:{effect:"None"}}}),this.reviewTab.appendTo(this.element),this.owner.enableRtl&&(this.reviewTab.enableRtl=!0),this.reviewTab.enablePersistence=!0,this.parentPaneElement.appendChild(this.element),this.parentPaneElement},s.prototype.initPaneHeader=function(e){return this.headerContainer=(0,a.az)("div"),this.reviewPane=(0,a.az)("div",{className:"e-de-cmt-pane"}),this.owner.enableRtl&&(0,a.s1)(this.reviewPane,["e-rtl"],[]),this.headerContainer.appendChild(this.initToolbar(e)),this.reviewPane.appendChild(this.headerContainer),this.reviewPane.style.display="block",this.reviewPane},s.prototype.closePane=function(){if(this.commentPane&&this.commentPane.isEditMode)if(!(0,a.le)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""===this.commentPane.currentEditingComment.replyViewTextBox.value)this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelReply(),this.owner.showComments=!1;else if(this.isNewComment||!(0,a.le)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""!==this.commentPane.currentEditingComment.replyViewTextBox.value||!(0,a.le)(this.commentPane.currentEditingComment)&&!this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment.textArea.value!==this.commentPane.currentEditingComment.comment.text){var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.confirmDialog=se.hZ.confirm({title:e.getConstant("Un-posted comments"),content:e.getConstant("Discard Comment"),okButton:{text:"Discard",click:this.discardButtonClick.bind(this)},cancelButton:{text:"Cancel",click:this.closeDialogUtils.bind(this)},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"Center",Y:"Center"}})}else this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelEditing(),this.owner.showComments=!1;else this.owner.showComments=!1,this.owner.documentHelper.currentSelectedComment=void 0,this.owner.documentHelper.currentSelectedRevision=void 0,this.owner.notify("reviewPane",{changes:!1,comment:!1,isUserClosed:!0})},s.prototype.discardButtonClick=function(){if(this.commentPane.currentEditingComment){var e=this.isNewComment;this.commentPane.currentEditingComment&&this.commentPane.isInsertingReply?this.commentPane.currentEditingComment.cancelReply():(this.commentPane.currentEditingComment.cancelEditing(),e&&this.discardComment(this.commentPane.currentEditingComment.comment)),this.owner.documentHelper.currentSelectedComment=void 0,this.closeDialogUtils(),this.owner.showComments=!1}},s.prototype.closeDialogUtils=function(){this.confirmDialog.close(),this.confirmDialog=void 0},s.prototype.initToolbar=function(e){return this.toolbarElement=(0,a.az)("div"),this.toolbar=new tt.o8({items:[{prefixIcon:"e-de-new-cmt e-de-cmt-tbr",tooltipText:e.getConstant("New Comment"),text:e.getConstant("New Comment"),click:this.insertComment.bind(this)},{prefixIcon:"e-de-nav-left-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Previous Comment"),click:this.navigatePreviousComment.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Next Comment"),click:this.navigateNextComment.bind(this)}],enableRtl:this.owner.enableRtl}),this.toolbar.appendTo(this.toolbarElement),this.toolbarElement},s.prototype.insertComment=function(){this.owner&&this.owner.editorModule&&(this.owner.editor.isUserInsert=!0,this.owner.editorModule.insertComment(""),this.owner.editor.isUserInsert=!1)},s.prototype.addComment=function(e,t,i){this.isNewComment=t,this.selectReviewTab("Comments"),this.owner.documentHelper.currentSelectedComment=e,this.commentPane.insertComment(e),t||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()),i&&this.selectComment(e)},s.prototype.deleteComment=function(e){this.commentPane&&this.commentPane.deleteComment(e)},s.prototype.selectComment=function(e){this.commentPane.isEditMode||(e.isReply&&(e=e.ownerComment),this.owner&&this.owner.viewer&&this.owner.documentHelper.currentSelectedComment!==e&&(this.owner.documentHelper.currentSelectedComment=e),this.commentPane.selectComment(e))},s.prototype.resolveComment=function(e){this.commentPane.resolveComment(e)},s.prototype.reopenComment=function(e){this.commentPane.reopenComment(e)},s.prototype.addReply=function(e,t,i){this.isNewComment=t,this.commentPane.insertReply(e),t||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()),i&&this.selectComment(e.ownerComment)},s.prototype.navigatePreviousComment=function(){this.owner&&this.owner.editorModule&&this.owner.selection.navigatePreviousComment()},s.prototype.navigateNextComment=function(){this.owner&&this.owner.editorModule&&this.owner.selection.navigateNextComment()},s.prototype.enableDisableItems=function(){this.enableDisableToolbarItem();for(var e=this.commentPane.comments.keys,t=0;t<e.length;t++){var i=this.commentPane.comments.get(e[t]);this.owner.isReadOnly?((0,a.le)(i.replyViewTextBox)||(i.replyViewTextBox.style.display="none"),i.menuBar.style.display="none",i.resolveView&&(i.resolveView.style.display="none")):((0,a.le)(i.replyViewTextBox)||(i.replyViewTextBox.style.display="block"),i.menuBar.style.display="block",i.resolveView&&(i.resolveView.style.display=""))}},s.prototype.enableDisableToolbarItem=function(){if(this.toolbar){var e=!0;this.commentPane.isEditMode&&(e=!this.commentPane.isEditMode),this.owner.isReadOnly&&(e=!this.owner.isReadOnly);var t=this.toolbar.element.querySelectorAll(".e-de-cmt-tbr");this.toolbar.enableItems(t[0].parentElement.parentElement,e),e&&this.owner&&this.owner.viewer&&(e=0!==this.owner.documentHelper.comments.length),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2].parentElement.parentElement,e)}},s.prototype.initCommentPane=function(){this.commentPane=new $o(this.owner,this),this.commentPane.initCommentPane()},s.prototype.layoutComments=function(){for(var e=0;e<this.owner.documentHelper.comments.length;e++){var t=this.owner.documentHelper.comments[e];if(this.isUnreferredComment(t))this.owner.documentHelper.comments.splice(e,1),e--;else{for(var i=0;i<t.replyComments.length;i++)this.isUnreferredComment(t.replyComments[i])&&(t.replyComments.splice(i,1),i--);this.commentPane.addComment(t)}}},s.prototype.isUnreferredComment=function(e){return!(!(0,a.le)(e.commentStart)&&!(0,a.le)(e.commentEnd))},s.prototype.clear=function(){this.previousSelectedCommentInt=void 0,this.isUserClosed=!1,this.commentPane.clear()},s.prototype.discardComment=function(e){e&&(this.owner.editorHistory?(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop(),this.owner.editor.deleteCommentInternal(e)):this.owner.editor&&this.owner.editor.deleteCommentInternal(e))},s.prototype.destroy=function(){this.commentPane&&this.commentPane.destroy(),this.commentPane=void 0,this.toolbar&&this.toolbar.destroy(),this.toolbar=void 0,this.toolbarElement&&this.toolbarElement.parentElement&&this.toolbarElement.parentElement.removeChild(this.toolbarElement),this.toolbarElement=void 0,this.headerContainer&&this.headerContainer.parentElement&&this.headerContainer.parentElement.removeChild(this.headerContainer),this.headerContainer=void 0,this.previousSelectedCommentInt=void 0,this.reviewPane&&this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane),this.owner.isDestroyed||this.owner.off("reviewPane",this.reviewPaneHelper),(0,a.le)(this.reviewTab)||this.reviewTab.destroy(),this.reviewTab=void 0,(0,a.le)(this.confirmDialog)||this.confirmDialog.destroy(),this.confirmDialog=void 0,(0,a.le)(this.previousSelectedCommentInt)||this.previousSelectedCommentInt.destroy(),this.previousSelectedCommentInt=void 0,this.reviewPane.innerHTML="",this.reviewPane=void 0,this.owner=void 0},s}(),$o=function(){function s(e,t){this.isEditModeInternal=!1,this.isInsertingReply=!1,this.owner=e,this.parentPane=t,this.parent=t.reviewPane,this.comments=new U}return Object.defineProperty(s.prototype,"isEditMode",{get:function(){return this.isEditModeInternal},set:function(e){this.isEditModeInternal=e;for(var t=this.comments.keys,i=0;i<t.length;i++){var n=this.comments.get(t[i]);e?n.menuBar.style.display="none":n.comment.isReply||(n.menuBar.style.display="block")}this.parentPane&&this.parentPane.enableDisableToolbarItem(),this.owner&&this.owner.trigger(this.isEditModeInternal?"commentBegin":"commentEnd")},enumerable:!0,configurable:!0}),s.prototype.initCommentPane=function(){this.commentPane=(0,a.az)("div",{className:"e-de-cmt-container"});var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.noCommentIndicator=(0,a.az)("div",{className:"e-de-cmt-no-cmt",innerHTML:e.getConstant("No comments in this document")}),this.commentPane.appendChild(this.noCommentIndicator),this.parent.appendChild(this.commentPane)},s.prototype.addComment=function(e){var t=new jt(this.owner,this,e),i=t.layoutComment(!1);this.comments.add(e,t),this.commentPane.appendChild(i);for(var n=0;n<e.replyComments.length;n++){var r=new jt(this.owner,this,e.replyComments[n]);this.comments.add(e.replyComments[n],r),i.insertBefore(r.layoutComment(!0),t.replyViewContainer)}this.updateCommentStatus(),t.hideDrawer()},s.prototype.updateHeight=function(){var e=this.parentPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.commentPane.style.height=this.parentPane.parentPaneElement.clientHeight-this.parentPane.headerContainer.clientHeight-e+"px"},s.prototype.insertReply=function(e){var t=e.ownerComment,i=this.comments.get(t),n=new jt(this.owner,this,e);this.comments.add(e,n);var r=n.layoutComment(!0),o=t.replyComments.indexOf(e);i.parentElement.insertBefore(r,o===t.replyComments.length-1?i.replyViewContainer:this.comments.get(t.replyComments[o+1]).parentElement),n.editComment()},s.prototype.insertComment=function(e){var t=new jt(this.owner,this,e),i=t.layoutComment(!1);if(this.comments.add(e,t),this.owner.documentHelper.comments.indexOf(e)===this.owner.documentHelper.comments.length-1)this.commentPane.appendChild(i);else{var n=this.owner.documentHelper.comments.indexOf(e),r=this.comments.get(this.owner.documentHelper.comments[n+1]).parentElement;this.commentPane.insertBefore(i,r),i.focus()}this.updateCommentStatus(),t.editComment()},s.prototype.removeSelectionMark=function(e){if(this.parent)for(var t=this.parent.getElementsByClassName(e),i=0;i<t.length;i++)(0,a.s1)(t[i],[],[e])},s.prototype.selectComment=function(e){if(this.removeSelectionMark("e-de-cmt-selection"),e.isReply&&(e=e.ownerComment),e){this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible});var t=this.comments.get(e),i=t.parentElement;i&&((0,a.s1)(i,["e-de-cmt-selection"],[]),i.focus());var n=this.getCommentStart(e);n.commentMark||n.renderCommentMark(),(0,a.s1)(n.commentMark,["e-de-cmt-mark-selected"],[]),t.showDrawer()}},s.prototype.getCommentStart=function(e){var t=new a.E7("documenteditor",this.owner.defaultLocale);t.setLocale(this.owner.locale);var i=void 0;return e&&e.commentStart&&(i=e.commentStart),void 0!==i.commentMark&&(i.commentMark.title=t.getConstant("Click to see this comment")),this.getFirstCommentInLine(i)},s.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof ae&&0===i.commentType)return i}return e},s.prototype.deleteComment=function(e){var t=this.comments.get(e);if(!(0,a.le)(t)){!(0,a.le)(this.currentEditingComment)&&t.comment.commentId==this.currentEditingComment.comment.commentId&&(this.isEditMode=!1,this.currentEditingComment=void 0),t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.removeChild(t.parentElement);for(var i=0;i<e.replyComments.length;i++){var n=e.replyComments[i];this.comments.containsKey(n)&&this.comments.remove(n)}this.comments.remove(e),t.destroy()}this.updateCommentStatus()},s.prototype.resolveComment=function(e){var t=this.comments.get(e);t&&t.resolveComment()},s.prototype.reopenComment=function(e){var t=this.comments.get(e);t&&t.reopenComment()},s.prototype.updateCommentStatus=function(){0===this.owner.documentHelper.comments.length?(this.noCommentIndicator.parentElement||this.commentPane.appendChild(this.noCommentIndicator),this.noCommentIndicator.style.display="block",this.parentPane.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:!1,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0)):(this.parentPane.isCommentTabVisible=!0,this.noCommentIndicator.style.display="none",this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0,!1)),this.parentPane&&this.parentPane.enableDisableToolbarItem()},s.prototype.clear=function(){this.isEditMode=!1,this.currentEditingComment=void 0,this.isInsertingReply=!1,this.removeChildElements(),this.commentPane.innerHTML="",this.updateCommentStatus()},s.prototype.removeChildElements=function(){for(var e=this.comments.keys,t=0;t<e.length;t++)this.comments.get(e[t]).destroy();this.comments.clear()},s.prototype.destroy=function(){this.removeChildElements(),this.noCommentIndicator&&this.noCommentIndicator&&this.noCommentIndicator.parentElement.removeChild(this.noCommentIndicator),this.noCommentIndicator=void 0,this.commentPane&&this.commentPane.parentElement&&this.commentPane.parentElement.removeChild(this.commentPane),this.commentPane.innerHTML="",this.parentPane=void 0,this.owner=void 0},s}(),jt=function(){function s(e,t,i){this.isReply=!1,this.isDrawerExpand=!1,this.owner=e,this.comment=i,this.commentPane=t}return s.prototype.layoutComment=function(e){this.isReply=e;var t="e-de-cmt-sub-container";e&&(t+=" e-de-cmt-reply");var i=new a.E7("documenteditor",this.owner.defaultLocale);return i.setLocale(this.owner.locale),this.parentElement=(0,a.az)("div",{className:t}),this.initCommentHeader(i),this.initCommentView(i),this.initDateView(),this.comment.isReply?this.menuBar.style.display="none":(this.parentElement.tabIndex=0,this.initReplyView(i),this.initResolveOption(i),this.initDrawer(),this.comment.isResolved&&this.resolveComment()),this.commentView.addEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.addEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)),this.parentElement},s.prototype.initCommentHeader=function(e){var t=(0,a.az)("div",{className:"e-de-cmt-view"}),i=(0,a.az)("div",{className:"e-de-cmt-author"}),n=(0,a.az)("div",{className:"e-de-cmt-author-name"});n.textContent=this.comment.author,(0,a.le)(this.comment.author)||(i.style.display="flex",this.owner.documentHelper.getAvatar(i,n,this.comment,void 0)),this.menuBar=(0,a.az)("button",{className:"e-de-cp-option",attrs:{type:"button"}});var r=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],o=new Ue.uw({items:this.isReply?r.splice(0,2):r,select:this.userOptionSelectEvent.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide",enableRtl:this.owner.enableRtl});this.menuBar.title=e.getConstant("More Options")+"...",o.appendTo(this.menuBar),i.appendChild(this.menuBar),this.dropDownButton=o,t.appendChild(i),this.commentView=t,this.parentElement.appendChild(t),t.addEventListener("click",this.selectComment.bind(this))},s.prototype.selectComment=function(){if(this.commentPane)if(this.commentPane.isEditMode){if(this.commentPane.isEditMode&&this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment&&""===this.commentPane.currentEditingComment.replyViewTextBox.value){var e=this.comment;if(e&&e.isReply&&(e=this.comment.ownerComment),e&&this.owner.documentHelper.currentSelectedComment===e)return;this.commentPane.currentEditingComment.cancelReply(),this.owner.selection.selectComment(this.comment)}}else this.owner.selection.selectComment(this.comment)},s.prototype.initCommentView=function(e){this.commentText=(0,a.az)("div",{className:"e-de-cmt-readonly"}),this.commentText.innerText=this.comment.text,this.commentView.appendChild(this.commentText),this.initEditView(e)},s.prototype.initEditView=function(e){this.textAreaContainer=(0,a.az)("div",{styles:"display:none"}),this.textArea=(0,a.az)("textarea",{className:"e-de-cmt-textarea e-input"}),this.textArea.placeholder=e.getConstant("Type your comment here"),this.textArea.rows=1,this.textArea.value=this.comment.text.trim(),this.textArea.addEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.addEventListener("keyup",this.enableDisablePostButton.bind(this));var t=(0,a.az)("div",{className:"e-de-cmt-action-button"}),i=(0,a.az)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.postButton=new M.zx({cssClass:"e-btn e-flat e-primary e-de-overlay",iconCss:"e-de-cmt-post",disabled:!0},i),i.addEventListener("click",this.postComment.bind(this)),i.title=e.getConstant("Post");var n=(0,a.az)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});this.cancelButton=new M.zx({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},n),n.title=e.getConstant("Cancel"),n.addEventListener("click",this.cancelEditing.bind(this)),t.appendChild(i),t.appendChild(n),this.textAreaContainer.appendChild(this.textArea),this.textAreaContainer.appendChild(t),this.commentView.appendChild(this.textAreaContainer)},s.prototype.initDateView=function(){this.commentDate=(0,a.az)("div",{className:"e-de-cmt-date"}),this.commentDate.innerText=w.getModifiedDate(this.comment.date),this.commentView.appendChild(this.commentDate)},s.prototype.initDrawer=function(){this.drawerElement=(0,a.az)("div",{styles:"display:none;",className:"e-de-cmt-drawer-cnt"});var e=(0,a.az)("div",{className:"e-de-cmt-drawer"}),t=(0,a.az)("span");e.appendChild(t),this.drawerElement.appendChild(e),this.drawerSpanElement=t,this.drawerAction=e,this.drawerAction.addEventListener("click",this.showOrHideDrawer.bind(this)),this.parentElement.appendChild(this.drawerElement)},s.prototype.initReplyView=function(e){this.replyViewContainer=(0,a.az)("div",{className:"e-de-cmt-rply-view"}),this.commentPane.parentPane.isNewComment&&(this.replyViewContainer.style.display="none"),this.replyViewTextBox=(0,a.az)("textarea",{className:"e-de-cmt-textarea e-input"}),this.replyViewTextBox.placeholder=e.getConstant("Reply"),this.replyViewTextBox.rows=1,this.replyViewTextBox.value="",this.replyViewTextBox.readOnly=!0,this.replyViewTextBox.addEventListener("click",this.enableReplyView.bind(this)),this.replyViewTextBox.addEventListener("keydown",this.updateReplyTextAreaHeight.bind(this)),this.replyViewTextBox.addEventListener("keyup",this.enableDisableReplyPostButton.bind(this));var t=(0,a.az)("div",{styles:"display:none",className:"e-de-cmt-action-button"}),i=(0,a.az)("button",{className:"e-de-cmt-post-btn e-de-overlay e-btn e-flat",attrs:{type:"button"}});this.replyPostButton=new M.zx({cssClass:"e-btn e-flat e-primary",iconCss:"e-de-cmt-post",disabled:!0},i),i.addEventListener("click",this.postReply.bind(this)),i.title=e.getConstant("Post");var n=(0,a.az)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});this.replyCancelButton=new M.zx({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},n),n.addEventListener("click",this.cancelReply.bind(this)),n.title=e.getConstant("Cancel"),t.appendChild(i),t.appendChild(n),this.replyFooter=t,this.replyViewContainer.appendChild(this.replyViewTextBox),this.replyViewContainer.appendChild(t),this.parentElement.appendChild(this.replyViewContainer)},s.prototype.initResolveOption=function(e){var t=(0,a.az)("div",{className:"e-de-cmt-resolve-btn"}),i=(0,a.az)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.reopenButton=new M.zx({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-reopen"},i),i.title=e.getConstant("Reopen"),i.addEventListener("click",this.reopenButtonClick.bind(this));var n=(0,a.az)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});n.title=e.getConstant("Delete"),this.deleteButton=new M.zx({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-delete"},n),n.addEventListener("click",this.deleteComment.bind(this)),t.appendChild(i),t.appendChild(n),this.resolveView=t,this.parentElement.appendChild(t)},s.prototype.reopenButtonClick=function(){this.owner.editor.reopenComment(this.comment)},s.prototype.deleteComment=function(){var e={author:this.comment.author,cancel:!1};this.owner.trigger(kn,e);var t={author:this.comment.author,cancel:e.cancel,type:"Delete"};this.owner.trigger(yt,t),!t.cancel&&this.owner.editorModule.deleteCommentInternal(this.comment)},s.prototype.updateReplyTextAreaHeight=function(){var e=this;setTimeout(function(){e.replyViewTextBox.style.height="auto",e.replyViewTextBox.style.height=e.replyViewTextBox.scrollHeight+"px"})},s.prototype.enableDisableReplyPostButton=function(){this.replyPostButton.disabled=""===this.replyViewTextBox.value,this.replyPostButton.disabled?(0,a.s1)(this.replyPostButton.element,["e-de-overlay"],[]):this.replyPostButton.element.classList.contains("e-de-overlay")&&(0,a.s1)(this.replyPostButton.element,[],["e-de-overlay"])},s.prototype.enableReplyView=function(){var e=this,t={author:this.comment.author,cancel:!1,type:"Reply"};this.owner.trigger(yt,t),(!t.cancel||"Reply"!==t.type)&&(this.commentPane.isEditMode||(this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!0,this.owner.documentHelper.currentSelectedComment!==this.comment&&this.owner.selection.selectComment(this.comment),this.commentPane.isEditMode=!0,this.replyViewTextBox.readOnly=!1,this.replyFooter.style.display="block",setTimeout(function(){e.replyViewTextBox.focus()})))},s.prototype.postReply=function(){var e=this.replyViewTextBox.value;this.cancelReply(),this.updateReplyTextAreaHeight(),this.owner.editorModule.replyComment(this.comment,e),this.owner.fireContentChange()},s.prototype.cancelReply=function(){this.commentPane.currentEditingComment=void 0,this.commentPane.isInsertingReply=!0,this.commentPane.isEditMode=!1,this.replyPostButton.disabled=!0,this.replyViewTextBox.value="",this.replyViewTextBox.readOnly=!0,this.replyFooter.style.display="none"},s.prototype.updateTextAreaHeight=function(){var e=this;setTimeout(function(){(0,a.le)(e.textArea)||(e.textArea.style.height="auto",e.textArea.style.height=e.textArea.scrollHeight+"px")})},s.prototype.showMenuItems=function(){this.comment.isReply&&!this.owner.isReadOnly&&!this.commentPane.isEditMode&&!(0,a.le)(this.comment)&&!this.comment.isResolved&&(this.menuBar.style.display="block");var e=this.commentPane.getCommentStart(this.comment);!(0,a.le)(e)&&!(0,a.le)(e.commentMark)&&e.commentMark.classList.add("e-de-cmt-mark-hover")},s.prototype.hideMenuItemOnMouseLeave=function(){if(this.comment.isReply&&this.owner.documentHelper.currentSelectedComment!==this.comment.ownerComment&&this.hideMenuItems(),this.commentPane){var e=this.commentPane.getCommentStart(this.comment);!(0,a.le)(e)&&!(0,a.le)(e.commentMark)&&e.commentMark.classList.remove("e-de-cmt-mark-hover")}},s.prototype.hideMenuItems=function(){this.menuBar.style.display="none"},s.prototype.enableDisablePostButton=function(){this.postButton.disabled=""===this.textArea.value,this.postButton.disabled?(0,a.s1)(this.postButton.element,["e-de-overlay"],[]):this.postButton.element.classList.contains("e-de-overlay")&&(0,a.s1)(this.postButton.element,[],["e-de-overlay"])},s.prototype.editComment=function(){var e=this,t={author:this.comment.author,cancel:!1,type:"Edit"};this.owner.trigger(yt,t),(!t.cancel||"Edit"!==t.type)&&(this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!1,this.commentPane.isEditMode=!0,this.commentText.style.display="none",this.textAreaContainer.style.display="block",this.commentDate.style.display="none",this.menuBar.style.display="none",this.updateTextAreaHeight(),setTimeout(function(){e.textArea&&e.textArea.focus()}))},s.prototype.resolveComment=function(){(0,a.s1)(this.parentElement,["e-de-cmt-resolved"],[]);var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Reopen")},{text:e.getConstant("Delete")}]},s.prototype.reopenComment=function(){(0,a.s1)(this.parentElement,[],["e-de-cmt-resolved"]);var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],this.showDrawer()},s.prototype.postComment=function(){var e={author:this.comment.author,cancel:!1,type:"Post"};if(this.owner.trigger(yt,e),!e.cancel||"Post"!==e.type){var t=this.textArea.value;this.commentText.innerText=t,this.comment.text=t,this.showCommentView(),this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),(0,a.le)(this.replyViewContainer)||(this.replyViewContainer.style.display=""),this.owner.fireContentChange()}},s.prototype.showCommentView=function(){this.commentPane.isEditMode=!1,this.textAreaContainer.style.display="none",this.commentText.style.display="block",this.commentDate.style.display="block",this.menuBar.style.display="block"},s.prototype.cancelEditing=function(){this.showCommentView(),this.textArea.value=this.comment.text.trim(),this.commentPane.parentPane.isNewComment&&(this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),this.commentPane.parentPane.discardComment(this.comment))},s.prototype.showOrHideDrawer=function(){this.isDrawerExpand?this.hideDrawer():this.showDrawer()},s.prototype.hideDrawer=function(){if(this.parentElement){var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale);var t=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(t.length>1){for(var i=1;i<t.length;i++)t[i].style.display="none";this.drawerElement.style.display="block",(0,a.s1)(this.drawerSpanElement,[],["e-de-nav-up"]),this.drawerSpanElement.innerText="+"+(t.length-1)+" "+e.getConstant("more")+"..."}this.isDrawerExpand=!1}},s.prototype.showDrawer=function(){if(this.parentElement){var e=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(e.length>1){for(var t=0;t<e.length;t++)e[t].style.display="block";this.drawerElement.style.display="block",this.drawerSpanElement.innerText="",(0,a.s1)(this.drawerSpanElement,["e-de-nav-up"],[])}this.isDrawerExpand=!0}},s.prototype.userOptionSelectEvent=function(e){var t=e.item.text,i=new a.E7("documenteditor",this.owner.defaultLocale);switch(i.setLocale(this.owner.locale),t){case i.getConstant("Edit"):this.editComment();break;case i.getConstant("Reply"):this.enableReplyView();break;case i.getConstant("Delete"):this.deleteComment();break;case i.getConstant("Resolve"):this.owner.editor.resolveComment(this.comment);break;case i.getConstant("Reopen"):this.owner.editor.reopenComment(this.comment)}},s.prototype.unwireEvent=function(){this.drawerAction&&this.drawerAction.removeEventListener("click",this.showOrHideDrawer.bind(this)),this.textArea&&(this.textArea.removeEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.removeEventListener("keyup",this.enableDisablePostButton.bind(this))),this.postButton&&this.postButton.removeEventListener("click",this.postComment.bind(this)),this.cancelButton&&this.cancelButton.removeEventListener("click",this.cancelEditing.bind(this)),this.commentView&&(this.commentView.removeEventListener("click",this.selectComment.bind(this)),this.commentView.removeEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.removeEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)))},s.prototype.destroy=function(){this.unwireEvent(),this.comment&&(this.comment=void 0),this.dropDownButton&&this.dropDownButton.destroy(),this.dropDownButton=void 0,this.postButton&&this.postButton.destroy(),this.postButton=void 0,this.cancelButton&&this.cancelButton.destroy(),this.cancelButton=void 0,this.replyPostButton&&(this.replyPostButton.destroy(),this.replyPostButton=void 0),this.replyCancelButton&&(this.replyCancelButton.destroy(),this.replyCancelButton=void 0),this.reopenButton&&(this.reopenButton.destroy(),this.reopenButton=void 0),this.deleteButton&&(this.deleteButton.destroy(),this.deleteButton=void 0),this.replyViewContainer=void 0,this.replyViewTextBox=void 0,this.replyFooter=void 0,this.parentElement&&this.parentElement.parentElement&&this.parentElement.parentElement.removeChild(this.parentElement),this.resolveView=void 0,this.commentPane=void 0,this.parentElement.innerHTML="",this.cancelButton=void 0,this.owner=void 0,this.menuBar=void 0,this.commentView=void 0,this.drawerAction=void 0,this.commentText=void 0,this.commentDate=void 0,this.textAreaContainer=void 0,this.textArea=void 0,this.drawerElement=void 0,this.drawerSpanElement=void 0,this.parentElement=null},s}(),cr=function(){function s(e){var t=this;this.displayText="",this.navigationUrl=void 0,this.screenTipText="",this.bookmarkDropdown=void 0,this.bookmarkCheckbox=void 0,this.bookmarks=[],this.onKeyUpOnUrlBox=function(i){if(13!==i.keyCode){var n=t.urlTextBox.value;"www."===n.substring(0,4).toLowerCase()&&(t.urlTextBox.value="http://"+n),""===t.displayText&&(t.displayTextBox.value=n),t.enableOrDisableInsertButton()}else""!==t.displayTextBox.value&&""!==t.urlTextBox.value&&t.onInsertHyperlink()},this.onKeyUpOnDisplayBox=function(){t.displayText=t.displayTextBox.value,t.enableOrDisableInsertButton()},this.onScreenTipTextBox=function(){t.screenTipText=t.screenTipTextBox.value},this.onInsertButtonClick=function(){t.onInsertHyperlink()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.clearValue(),t.documentHelper.updateFocus()},this.loadHyperlinkDialog=function(){t.documentHelper.updateFocus(),t.bookmarks=[];for(var i=0;i<t.documentHelper.bookmarks.keys.length;i++){var n=t.documentHelper.bookmarks.keys[i];0!==n.indexOf("_")&&t.bookmarks.push(n)}var r=t.documentHelper.selection.getHyperlinkField();if((0,a.le)(r))t.displayText=t.documentHelper.selection.getText(!0),""!==t.displayText&&(-1!==t.displayText.indexOf(String.fromCharCode(65532))||-1!==t.displayText.indexOf("\r")&&-1!==t.displayText.lastIndexOf("\r")&&-1!==t.displayText.slice(0,-1).indexOf("\r")?(t.displayTextBox.value="<<Selection in document>>",t.displayTextBox.disabled=!0):t.displayTextBox.value=t.displayText);else{if(!(0,a.le)(r.fieldSeparator)){var l=t.documentHelper.selection.getHyperlinkDisplayText(r.fieldSeparator.line.paragraph,r.fieldSeparator,r.fieldEnd,!1,void 0);t.displayText=l.displayText,t.displayTextBox.disabled=l.isNestedField}t.displayTextBox.value=t.displayText,t.screenTipTextBox.value=t.documentHelper.selection.getLinkText(r,!1);var h=t.documentHelper.selection.getLinkText(r,!0);t.urlTextBox.value=t.navigationUrl=h,t.documentHelper.dialog.header=t.localObj.getConstant("Edit Hyperlink")}t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block",t.bookmarkCheckbox.checked=!1,t.bookmarkDropdown.dataSource=t.documentHelper.bookmarks.keys,t.insertButton=document.getElementsByClassName("e-hyper-insert")[0],t.enableOrDisableInsertButton(),t.urlTextBox.focus(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")},this.closeHyperlinkDialog=function(){t.clearValue(),t.documentHelper.updateFocus()},this.onUseBookmarkChange=function(i){i.checked?(t.bookmarkDiv.style.display="block",t.bookmarkDropdown.dataSource=t.bookmarks,t.addressText.style.display="none",t.urlTextBox.style.display="none"):(t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block"),t.enableOrDisableInsertButton()},this.onBookmarkchange=function(){""!==t.bookmarkDropdown.value&&(t.insertButton.disabled=!1)},this.documentHelper=e}return s.prototype.getModuleName=function(){return"HyperlinkDialog"},s.prototype.initHyperlinkDialog=function(e,t){this.target=(0,a.az)("div",{className:"e-de-hyperlink"});var i=(0,a.az)("div"),n=(0,a.az)("div",{className:"e-de-dlg-container"});this.displayTextBox=(0,a.az)("input",{className:"e-input"}),this.displayTextBox.addEventListener("keyup",this.onKeyUpOnDisplayBox),n.appendChild(this.displayTextBox),i.appendChild(n),this.addressText=(0,a.az)("div",{className:"e-de-dlg-container"}),this.urlTextBox=(0,a.az)("input",{className:"e-input",attrs:{autofocus:"true"}}),this.urlTextBox.addEventListener("input",this.onKeyUpOnUrlBox),this.urlTextBox.addEventListener("keyup",this.onKeyUpOnUrlBox),this.addressText.appendChild(this.urlTextBox),i.appendChild(this.addressText);var r=(0,a.az)("div",{className:"e-de-dlg-container"});this.screenTipTextBox=(0,a.az)("input",{className:"e-input"}),this.screenTipTextBox.addEventListener("keyup",this.onScreenTipTextBox),r.appendChild(this.screenTipTextBox),i.appendChild(r),this.bookmarkDiv=(0,a.az)("div",{styles:"display:none;"});var o=(0,a.az)("div",{className:"e-de-dlg-container"}),l=(0,a.az)("input");o.appendChild(l),this.bookmarkDropdown=new Te.NB({dataSource:[],change:this.onBookmarkchange,noRecordsTemplate:e.getConstant("No bookmarks found"),placeholder:e.getConstant("Bookmark"),floatLabelType:"Always"}),this.bookmarkDropdown.appendTo(l),this.bookmarkDiv.appendChild(o),i.appendChild(this.bookmarkDiv);var h=(0,a.az)("div"),d=(0,a.az)("input",{attrs:{type:"checkbox"}});h.appendChild(d),this.bookmarkCheckbox=new M.Jg({label:e.getConstant("Use bookmarks"),enableRtl:t,change:this.onUseBookmarkChange}),this.bookmarkCheckbox.appendTo(d),i.appendChild(h),this.target.appendChild(i),new J.zC({placeholder:e.getConstant("Text to display"),floatLabelType:"Always"},this.displayTextBox),new J.zC({placeholder:e.getConstant("Address"),floatLabelType:"Always"},this.urlTextBox),new J.zC({placeholder:e.getConstant("ScreenTip text"),floatLabelType:"Always"},this.screenTipTextBox)},s.prototype.show=function(){this.localObj=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),this.target||this.initHyperlinkDialog(this.localObj,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=this.localObj.getConstant("Insert Hyperlink"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.onInsertButtonClick,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-hyper-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.beforeOpen=this.loadHyperlinkDialog,this.documentHelper.dialog.close=this.closeHyperlinkDialog,this.documentHelper.dialog.show()},s.prototype.hide=function(){this.closeHyperlinkDialog()},s.prototype.enableOrDisableInsertButton=function(){(0,a.le)(this.insertButton)||(this.insertButton.disabled=this.bookmarkCheckbox.checked?""===this.bookmarkDropdown.value||null==this.bookmarkDropdown.value:""===this.urlTextBox.value||""===this.displayTextBox.value)},s.prototype.onInsertHyperlink=function(){var e=this.displayTextBox.value.trim(),t=this.urlTextBox.value.trim();t=t.replace(/\s/g,"");var i=this.screenTipTextBox.value.trim(),n=!1;if(!(0,a.le)(this.bookmarkDropdown.value)&&""!==this.bookmarkDropdown.value&&!0===this.bookmarkCheckbox.checked&&(t=this.bookmarkDropdown.value,n=!0),""!==t){if(""!==i&&(t=t+'" \\o "'+i),e=""===e&&""!==t?t:this.displayTextBox.value,(0,a.le)(this.navigationUrl)){var r=(this.documentHelper.selection.text!==e||-1===this.documentHelper.selection.text.indexOf("\r"))&&!this.displayTextBox.disabled;this.documentHelper.owner.editorModule.insertHyperlinkInternal(t,e,r,n)}else this.documentHelper.owner.editorModule.editHyperlink(this.documentHelper.selection,t,e,n);this.documentHelper.hideDialog(),this.navigationUrl=void 0}else this.documentHelper.hideDialog()},s.prototype.clearValue=function(){this.displayTextBox.value="",this.urlTextBox.value="",this.screenTipText="",this.screenTipTextBox.value="",this.displayText="",this.displayTextBox.disabled=!1,this.bookmarks=[]},s.prototype.destroy=function(){this.displayTextBox&&(this.displayTextBox.innerHTML="",this.displayTextBox=void 0),this.urlTextBox&&(this.urlTextBox.parentElement.removeChild(this.urlTextBox),this.urlTextBox=void 0),this.screenTipTextBox&&(this.screenTipTextBox.parentElement.removeChild(this.screenTipTextBox),this.screenTipTextBox=void 0),this.documentHelper=void 0,(0,a.le)(this.target)||(this.target.parentElement&&this.target.parentElement.removeChild(this.target),this.target.innerHTML="",this.target=void 0)},s}(),ur=function(){function s(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus()},this.onInsertTableClick=function(){if(t.columnValueTexBox.value<1||t.columnValueTexBox.value>63)se.hZ.alert(t.localeValue.getConstant("Number of columns must be between 1 and 63."));else if(t.rowValueTextBox.value<1||t.rowValueTextBox.value>t.documentHelper.owner.documentEditorSettings.maximumRows)se.hZ.alert("en-US"==t.documentHelper.owner.locale?"Number of rows must be between 1 and "+t.documentHelper.owner.documentEditorSettings.maximumRows+".":t.localeValue.getConstant("Number of rows must be between 1 and 32767."));else if(t.rowValueTextBox.value<=t.documentHelper.owner.documentEditorSettings.maximumRows&&t.columnValueTexBox.value<=63){var i=t.rowValueTextBox.value,n=t.columnValueTexBox.value;(0,a.le)(i)&&(0,a.le)(n)||t.documentHelper.owner.editor.insertTable(i,n),t.documentHelper.hideDialog()}},this.documentHelper=e}return s.prototype.getModuleName=function(){return"TableDialog"},s.prototype.initTableDialog=function(e){this.target=(0,a.az)("div",{className:"e-de-insert-table"});var t=(0,a.az)("div"),i=(0,a.az)("div",{className:"e-de-container-row"});this.columnsCountBox=(0,a.az)("input",{attrs:{type:"text"}}),i.appendChild(this.columnsCountBox);var n=(0,a.az)("div");this.rowsCountBox=(0,a.az)("input",{attrs:{type:"text"}}),n.appendChild(this.rowsCountBox),t.appendChild(i),t.appendChild(n),this.target.appendChild(t),this.rowValueTextBox=new J.No({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of rows"),floatLabelType:"Always"}),this.rowValueTextBox.appendTo(this.rowsCountBox),this.columnValueTexBox=new J.No({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always"}),this.columnValueTexBox.appendTo(this.columnsCountBox)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initTableDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Insert Table"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onInsertTableClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.rowValueTextBox.value=2,this.columnValueTexBox.value=2,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.columnValueTexBox.focusIn(),this.documentHelper.dialog.show()},s.prototype.destroy=function(){if(this.columnsCountBox&&(this.columnsCountBox.parentElement&&this.columnsCountBox.parentElement.removeChild(this.columnsCountBox),this.columnsCountBox=void 0),this.rowsCountBox&&(this.rowsCountBox.parentElement&&this.rowsCountBox.parentElement.removeChild(this.rowsCountBox),this.rowsCountBox=void 0),this.columnValueTexBox&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.rowValueTextBox&&(this.rowValueTextBox.destroy(),this.rowValueTextBox=void 0),this.columnsCountBox=void 0,this.rowsCountBox=void 0,this.documentHelper=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},s}(),pr=function(){function s(e){var t=this;this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.addBookmark=function(){t.documentHelper.owner.editorModule.insertBookmark(t.textBoxInput.value),t.documentHelper.hideDialog()},this.selectHandler=function(i){t.focusTextBox(i.text)},this.gotoBookmark=function(){t.documentHelper.selection.selectBookmark(t.textBoxInput.value)},this.deleteBookmark=function(){t.documentHelper.owner.editorModule.deleteBookmark(t.textBoxInput.value),t.show()},this.documentHelper=e}return s.prototype.getModuleName=function(){return"BookmarkDialog"},s.prototype.initBookmarkDialog=function(e,t,i){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_insert_bookmark",className:"e-de-bookmark"});var r=e.getConstant("Bookmark name")+":",o=(0,a.az)("div",{innerHTML:r,className:"e-bookmark-dlgfields"});this.target.appendChild(o);var l=(0,a.az)("div",{className:"e-bookmark-common"});this.target.appendChild(l);var h=(0,a.az)("div",{className:"e-bookmark-list"});l.appendChild(h),i&&h.classList.add("e-de-rtl");var d=(0,a.az)("div",{className:"e-bookmark-textboxdiv"});h.appendChild(d),this.textBoxInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),d.appendChild(this.textBoxInput);var c=(0,a.az)("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview"});h.appendChild(c),this.listviewInstance=new pt.Bv({dataSource:t,cssClass:"e-bookmark-listview"});var u=void 0===t||0===t.length;this.listviewInstance.appendTo(c),this.listviewInstance.addEventListener("select",this.selectHandler);var p=(0,a.az)("div",{className:"e-bookmark-button"});l.appendChild(p);var f=(0,a.az)("div",{className:"e-bookmark-addbutton"});p.appendChild(f);var g=(0,a.az)("button",{innerHTML:e.getConstant("Add"),id:"add",attrs:{type:"button"}});f.appendChild(g),this.addButton=new M.zx({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(g),this.textBoxInput.addEventListener("input",this.onKeyUpOnTextBox),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnTextBox),g.addEventListener("click",this.addBookmark);var m=(0,a.az)("div",{className:"e-bookmark-deletebutton"});p.appendChild(m);var v=(0,a.az)("button",{innerHTML:e.getConstant("Delete"),id:"delete",attrs:{type:"button"}});m.appendChild(v),this.deleteButton=new M.zx({cssClass:"e-button-custom"}),this.deleteButton.disabled=u,this.deleteButton.appendTo(v),v.addEventListener("click",this.deleteBookmark);var y=(0,a.az)("div",{className:"e-bookmark-gotobutton"});p.appendChild(y);var b=(0,a.az)("button",{innerHTML:e.getConstant("Go To"),id:"goto",attrs:{type:"button"}});y.appendChild(b),this.gotoButton=new M.zx({cssClass:"e-button-custom"}),this.gotoButton.disabled=u,this.gotoButton.appendTo(b),b.addEventListener("click",this.gotoBookmark)},s.prototype.show=function(){var e=this.documentHelper.getBookmarks(),t=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),this.initBookmarkDialog(t,e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=t.getConstant("Bookmark"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.removeObjects.bind(this),buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),void 0===e||0===e.length||this.listviewInstance.selectItem(e[0]),this.documentHelper.dialog.show()},s.prototype.enableOrDisableButton=function(){(0,a.le)(this.addButton)||(this.addButton.disabled=""===this.textBoxInput.value)},s.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=document.getElementById("bookmark_text_box");t.setSelectionRange(0,e.length),t.focus(),this.enableOrDisableButton()},s.prototype.removeObjects=function(){this.documentHelper.hideDialog()},s.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0},s}(),fr=function(){function s(e){var t=this;this.loadTableofContentDialog=function(){t.documentHelper.updateFocus(),t.pageNumber.checked=!0,t.rightAlign.disabled=!1,t.rightAlign.checked=!0,t.tabLeader.enabled=!0,t.hyperlink.checked=!0,t.style.checked=!0,t.outline.checked=!0,t.outline.disabled=!1,t.showLevel.enabled=!0},this.closeTableOfContentDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog3.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.selectHandler=function(i){t.textBoxInput.value=i.text;var n=t.textBoxInput;n.setSelectionRange(0,i.text.length),n.focus()},this.showStyleDialog=function(){(0,a.le)(t.documentHelper.owner.styleDialogModule)||t.documentHelper.owner.styleDialogModule.show(t.textBoxInput.value)},this.reset=function(){t.showLevel.enabled=!0,t.showLevel.value=3,t.outline.disabled=!1,t.outline.checked=!0,t.changeByValue(["1","2","3",null,null,null,null,null,null]),t.normal.value=null},this.changeStyle=function(i){var n=i.srcElement.value;n!==t.getElementValue(i.srcElement)&&""!==n?t.showLevel.enabled=!1:(t.showLevel.enabled=!0,t.checkLevel())},this.changeHeadingStyle=function(i){t.showLevel.enabled=""===i.srcElement.value,t.normal===i.srcElement&&(t.outline.checked=!1,t.outline.disabled=!0)},this.changePageNumberValue=function(i){i.checked?(t.rightAlign.checked=!0,t.rightAlign.disabled=!1,t.tabLeader.enabled=!0):(t.rightAlign.disabled=!0,t.tabLeader.enabled=!1)},this.changeRightAlignValue=function(i){t.tabLeader.enabled=!!i.checked},this.changeStyleValue=function(i){i.checked?(t.heading1.disabled=!1,t.heading2.disabled=!1,t.heading3.disabled=!1,t.heading4.disabled=!1,t.heading5.disabled=!1,t.heading6.disabled=!1,t.heading7.disabled=!1,t.heading8.disabled=!1,t.heading9.disabled=!1,t.normal.disabled=!1):(t.heading1.disabled=!0,t.heading2.disabled=!0,t.heading3.disabled=!0,t.heading4.disabled=!0,t.heading5.disabled=!0,t.heading6.disabled=!0,t.heading7.disabled=!0,t.heading8.disabled=!0,t.heading9.disabled=!0,t.normal.disabled=!0)},this.applyTableOfContentProperties=function(){var i={startLevel:1,endLevel:t.showLevel.value,includeHyperlink:t.hyperlink.checked,includePageNumber:t.pageNumber.checked,rightAlign:t.rightAlign.checked,tabLeader:t.tabLeader.value,includeOutlineLevels:t.outline.checked};t.applyLevelSetting(i),t.documentHelper.owner.editorModule.insertTableOfContents(i),t.documentHelper.dialog3.hide(),t.documentHelper.updateFocus()},this.unWireEventsAndBindings=function(){t.pageNumber.checked=!1,t.rightAlign.checked=!1,t.tabLeader.value="",t.hyperlink.checked=!1,t.style.checked=!1,t.outline.checked=!1,t.normal.value=""},this.documentHelper=e}return s.prototype.getModuleName=function(){return"TableOfContentsDialog"},s.prototype.initTableOfContentDialog=function(e,t){var i=this.documentHelper.owner.containerId;this.target=(0,a.az)("div",{id:i+"_toc_dialog",className:"e-de-toc-dlg-container"});var r=(0,a.az)("div",{id:"general_div",className:"e-de-toc-dlg-sub-container"});this.target.appendChild(r);var o=(0,a.az)("div",{id:i+"_genLabel",className:"e-de-toc-dlg-main-heading",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("General")});r.appendChild(o);var l=(0,a.az)("div",{className:"e-de-container-row"}),h=(0,a.az)("div",{className:"e-de-subcontainer-left"});l.appendChild(h);var d=(0,a.az)("div",{className:"e-de-subcontainer-right"});l.appendChild(d),r.appendChild(l);var c=(0,a.az)("div",{className:"e-de-dlg-row"}),u=(0,a.az)("div",{className:"e-de-subcontainer-left"});c.appendChild(u);var p=(0,a.az)("div",{className:"e-de-subcontainer-right"});c.appendChild(p);var f=(0,a.az)("div",{className:"e-de-toc-dlg-sub-container"}),g=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_pageNumber"});f.appendChild(g);var m=(0,a.az)("div",{className:"e-de-toc-dlg-sub-container"}),v=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_rightAlign"});m.appendChild(v),this.pageNumber=new M.Jg({label:e.getConstant("Show page numbers"),enableRtl:t,checked:!0,change:this.changePageNumberValue}),this.rightAlign=new M.Jg({label:e.getConstant("Right align page numbers"),enableRtl:t,checked:!0,change:this.changeRightAlignValue}),this.pageNumber.appendTo(g),this.rightAlign.appendTo(v);var y=(0,a.az)("div",{className:"e-de-container-row"}),b=(0,a.az)("div",{className:"e-de-subcontainer-left"}),C=(0,a.az)("div"),F=(0,a.az)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Tab leader")+":"});C.appendChild(F);var T=(0,a.az)("div",{id:"tabLeader_div"}),x=(0,a.az)("select",{id:i+"_tabLeader",innerHTML:'<option value="None">('+e.getConstant("None").toLocaleLowerCase()+')</option><option value="Dot" selected>....................</option><option value="Hyphen">-------------------</option><option value="Underscore">____________</option>'});T.appendChild(x),b.appendChild(C),b.appendChild(T),h.appendChild(f),h.appendChild(m),y.appendChild(b),this.tabLeader=new Te.NB({enableRtl:t}),this.tabLeader.appendTo(x);var P=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_hyperlink"});d.appendChild(P),this.hyperlink=new M.Jg({label:e.getConstant("Use hyperlinks instead of page numbers"),cssClass:"e-de-toc-label",enableRtl:t,checked:!0}),this.hyperlink.appendTo(P);var E=(0,a.az)("div",{className:"e-de-subcontainer-right"}),L=(0,a.az)("div",{className:"e-de-toc-dlg-show-level-div"}),W=(0,a.az)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Show levels")+":"});L.appendChild(W);var R=(0,a.az)("div",{className:"e-de-toc-dlg-showlevel-div"}),N=(0,a.az)("input",{id:i+"_showLevel",attrs:{type:"text"}});R.appendChild(N),E.appendChild(L),E.appendChild(R),y.appendChild(E),r.appendChild(y),this.showLevel=new J.No({format:"#",value:3,min:1,max:9,change:this.changeShowLevelValue.bind(this)}),this.showLevel.appendTo(N),t&&(this.hyperlink.cssClass="e-de-toc-label-rtl",L.classList.add("e-de-rtl"),R.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"));var B=(0,a.az)("div",{className:"e-de-toc-dlg-main-heading e-de-toc-dlg-build-table",innerHTML:e.getConstant("Build table of contents from")+":"});r.appendChild(c);var q=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_style"});u.appendChild(B),u.appendChild(q),this.style=new M.Jg({label:e.getConstant("Styles"),enableRtl:t,checked:!0,change:this.changeStyleValue}),this.style.appendTo(q);var A=(0,a.az)("TABLE",{styles:"margin-top:3px;"}),X=(0,a.az)("tr"),le=(0,a.az)("td",{styles:"width:120px;padding-left:10px;"}),K=(0,a.az)("label",{innerHTML:e.getConstant("Available styles"),className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_availableLabel"});le.appendChild(K);var he=(0,a.az)("td"),ge=(0,a.az)("label",{innerHTML:e.getConstant("TOC level")+":",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_tocLabel"});he.appendChild(ge),X.appendChild(le),X.appendChild(he),A.appendChild(X);var te=(0,a.az)("div",{id:"table_div",className:"e-de-toc-table-div"}),G=(0,a.az)("TABLE"),Ae=(0,a.az)("tr"),pe=(0,a.az)("td"),me=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 1",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading1Label"});pe.appendChild(me);var ze=(0,a.az)("td");this.heading1=(0,a.az)("input",{id:"_heading1",className:"e-input e-de-toc-dlg-toc-level"}),this.heading1.value="1",this.heading1.addEventListener("keyup",this.changeStyle),ze.appendChild(this.heading1),Ae.appendChild(pe),Ae.appendChild(ze);var Be=(0,a.az)("tr"),Me=(0,a.az)("td"),lt=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 2",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading2Label"});Me.appendChild(lt);var dt=(0,a.az)("td");this.heading2=(0,a.az)("input",{id:"_heading2",className:"e-input e-de-toc-dlg-toc-level"}),this.heading2.value="2",this.heading2.addEventListener("keyup",this.changeStyle),dt.appendChild(this.heading2),Be.appendChild(Me),Be.appendChild(dt);var ct=(0,a.az)("tr"),ut=(0,a.az)("td"),mt=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 3",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading3Label"});ut.appendChild(mt);var ti=(0,a.az)("td");this.heading3=(0,a.az)("input",{id:"_heading3",className:"e-input e-de-toc-dlg-toc-level"}),this.heading3.value="3",this.heading3.addEventListener("keyup",this.changeStyle),ti.appendChild(this.heading3),ct.appendChild(ut),ct.appendChild(ti);var Pt=(0,a.az)("tr"),Dt=(0,a.az)("td"),ii=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 4",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading4Label"});Dt.appendChild(ii);var At=(0,a.az)("td");this.heading4=(0,a.az)("input",{id:"_heading4",className:"e-input e-de-toc-dlg-toc-level"}),this.heading4.addEventListener("keyup",this.changeStyle),At.appendChild(this.heading4),Pt.appendChild(Dt),Pt.appendChild(At);var Ht=(0,a.az)("tr"),Bt=(0,a.az)("td"),hn=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 5",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading5Label"});Bt.appendChild(hn);var Kr=(0,a.az)("td");this.heading5=(0,a.az)("input",{id:"_heading5",className:"e-input e-de-toc-dlg-toc-level"}),this.heading5.addEventListener("keyup",this.changeStyle),Kr.appendChild(this.heading5),Ht.appendChild(Bt),Ht.appendChild(Kr);var dn=(0,a.az)("tr"),Xr=(0,a.az)("td"),$s=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 6",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading6Label"});Xr.appendChild($s);var Zr=(0,a.az)("td");this.heading6=(0,a.az)("input",{id:"_heading6",className:"e-input e-de-toc-dlg-toc-level"}),this.heading6.addEventListener("keyup",this.changeStyle),Zr.appendChild(this.heading6),dn.appendChild(Xr),dn.appendChild(Zr);var cn=(0,a.az)("tr"),Yr=(0,a.az)("td"),ea=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 7",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading7Label"});Yr.appendChild(ea);var Jr=(0,a.az)("td");this.heading7=(0,a.az)("input",{id:"_heading7",className:"e-input e-de-toc-dlg-toc-level"}),this.heading7.addEventListener("keyup",this.changeStyle),Jr.appendChild(this.heading7),cn.appendChild(Yr),cn.appendChild(Jr);var un=(0,a.az)("tr"),Qr=(0,a.az)("td"),ta=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 8",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading8Label"});Qr.appendChild(ta);var $r=(0,a.az)("td");this.heading8=(0,a.az)("input",{id:"_heading8",className:"e-input e-de-toc-dlg-toc-level"}),this.heading8.addEventListener("keyup",this.changeStyle),$r.appendChild(this.heading8),un.appendChild(Qr),un.appendChild($r);var pn=(0,a.az)("tr"),eo=(0,a.az)("td"),ia=(0,a.az)("label",{innerHTML:e.getConstant("Heading")+" 9",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading9Label"});eo.appendChild(ia);var to=(0,a.az)("td");this.heading9=(0,a.az)("input",{id:"_heading9",className:"e-input e-de-toc-dlg-toc-level"}),this.heading9.addEventListener("keyup",this.changeStyle),to.appendChild(this.heading9),pn.appendChild(eo),pn.appendChild(to);var fn=(0,a.az)("tr"),io=(0,a.az)("td"),na=(0,a.az)("label",{innerHTML:e.getConstant("Normal"),className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_normalLabel"});io.appendChild(na);var no=(0,a.az)("td");this.normal=(0,a.az)("input",{id:"_normal",className:"e-input e-de-toc-dlg-toc-level"}),this.normal.addEventListener("keyup",this.changeHeadingStyle),no.appendChild(this.normal),fn.appendChild(io),fn.appendChild(no),t&&(this.normal.classList.add("e-de-rtl"),this.heading1.classList.add("e-de-rtl"),this.heading2.classList.add("e-de-rtl"),this.heading3.classList.add("e-de-rtl"),this.heading4.classList.add("e-de-rtl"),this.heading5.classList.add("e-de-rtl"),this.heading6.classList.add("e-de-rtl"),this.heading7.classList.add("e-de-rtl"),this.heading8.classList.add("e-de-rtl"),this.heading9.classList.add("e-de-rtl")),G.appendChild(Ae),G.appendChild(Be),G.appendChild(ct),G.appendChild(Pt),G.appendChild(Ht),G.appendChild(dn),G.appendChild(cn),G.appendChild(un),G.appendChild(pn),G.appendChild(fn),te.appendChild(G);var gn=(0,a.az)("div",{className:"e-de-toc-styles-table-div"});gn.appendChild(A),gn.appendChild(te),u.appendChild(gn);var mn=(0,a.az)("div",{id:"fields_div",styles:"display: flex;"});u.appendChild(mn);var ro=(0,a.az)("div",{id:"out_div"}),oo=(0,a.az)("div",{id:"outline_div",className:"e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels"}),so=(0,a.az)("input",{attrs:{type:"checkbox"},id:"_outline"});oo.appendChild(so),ro.appendChild(oo),mn.appendChild(ro),this.outline=new M.Jg({label:e.getConstant("Outline levels"),enableRtl:t,checked:!0,cssClass:"e-de-outline-rtl"}),this.outline.appendTo(so);var vn=(0,a.az)("div",{className:"e-de-toc-reset-button"});mn.appendChild(vn);var yn=(0,a.az)("button",{innerHTML:e.getConstant("Reset"),id:"reset",attrs:{type:"button"}});vn.appendChild(yn),new M.zx({cssClass:"e-btn e-flat"}).appendTo(yn),yn.addEventListener("click",this.reset);var ao=(0,a.az)("div",{id:i+"_tocStylesLabel",className:"e-de-toc-dlg-main-heading",innerHTML:e.getConstant("Styles")+":"});p.appendChild(ao);var bn=(0,a.az)("div");p.appendChild(bn),this.textBoxInput=(0,a.az)("input",{className:"e-input"}),this.textBoxInput.setAttribute("type","text"),bn.appendChild(this.textBoxInput);var wn=(0,a.az)("div",{className:"e-de-toc-list-view"}),sa=this.styleLocaleValue(["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"],e);this.listViewInstance=new pt.Bv({dataSource:sa,cssClass:"e-toc-list-view"}),this.listViewInstance.appendTo(wn),this.listViewInstance.addEventListener("select",this.selectHandler),p.appendChild(wn);var Cn=(0,a.az)("div",{className:"e-de-toc-modify-button"});p.appendChild(Cn);var Fn=(0,a.az)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});Cn.appendChild(Fn),new M.zx({cssClass:"e-btn e-flat"}).appendTo(Fn),Fn.addEventListener("click",this.showStyleDialog),t&&(vn.classList.add("e-de-rtl"),ao.classList.add("e-de-rtl"),bn.classList.add("e-de-rtl"),wn.classList.add("e-de-rtl"),Cn.classList.add("e-de-rtl"))},s.prototype.styleLocaleValue=function(e,t){for(var i=[],n=0;n<e.length;n++)i.push(t.getConstant(e[n]));return i},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOfContentDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog3.header=e.getConstant("Table of Contents"),this.documentHelper.dialog3.position={X:"center",Y:"center"},this.documentHelper.dialog3.width="auto",this.documentHelper.dialog3.height="auto",this.documentHelper.dialog3.content=this.target,this.documentHelper.dialog3.beforeOpen=this.loadTableofContentDialog,this.documentHelper.dialog3.close=this.closeTableOfContentDialog,this.documentHelper.dialog3.buttons=[{click:this.applyTableOfContentProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-toc-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-toc-cancel"}}],this.documentHelper.dialog3.dataBind(),this.documentHelper.dialog3.show()},s.prototype.changeShowLevelValue=function(e){switch(e.value){case 1:this.changeByValue(["1",null,null,null,null,null,null,null,null]);break;case 2:this.changeByValue(["1","2",null,null,null,null,null,null,null]);break;case 3:this.changeByValue(["1","2","3",null,null,null,null,null,null]);break;case 4:this.changeByValue(["1","2","3","4",null,null,null,null,null]);break;case 5:this.changeByValue(["1","2","3","4","5",null,null,null,null]);break;case 6:this.changeByValue(["1","2","3","4","5","6",null,null,null]);break;case 7:this.changeByValue(["1","2","3","4","5","6","7",null,null]);break;case 8:this.changeByValue(["1","2","3","4","5","6","7","8",null]);break;case 9:this.changeByValue(["1","2","3","4","5","6","7","8","9"])}},s.prototype.changeByValue=function(e){this.heading1.value=e[0],this.heading2.value=e[1],this.heading3.value=e[2],this.heading4.value=e[3],this.heading5.value=e[4],this.heading6.value=e[5],this.heading7.value=e[6],this.heading8.value=e[7],this.heading9.value=e[8]},s.prototype.checkLevel=function(){""!==this.heading1.value&&(this.showLevel.value=1),""!==this.heading2.value&&(this.showLevel.value=2),""!==this.heading3.value&&(this.showLevel.value=3),""!==this.heading4.value&&(this.showLevel.value=4),""!==this.heading5.value&&(this.showLevel.value=5),""!==this.heading6.value&&(this.showLevel.value=6),""!==this.heading7.value&&(this.showLevel.value=7),""!==this.heading8.value&&(this.showLevel.value=8),""!==this.heading9.value&&(this.showLevel.value=9)},s.prototype.getElementValue=function(e){switch(e){case this.heading1:return"1";case this.heading2:return"2";case this.heading3:return"3";case this.heading4:return"4";case this.heading5:return"5";case this.heading6:return"6";case this.heading7:return"7";case this.heading8:return"8";case this.heading9:return"9";default:return"1"}},s.prototype.getHeadingLevel=function(e){switch(e){case 1:return parseInt(this.heading1.value);case 2:return parseInt(this.heading2.value);case 3:return parseInt(this.heading3.value);case 4:return parseInt(this.heading4.value);case 5:return parseInt(this.heading5.value);case 6:return parseInt(this.heading6.value);case 7:return parseInt(this.heading7.value);case 8:return parseInt(this.heading8.value);case 9:return parseInt(this.heading9.value);default:return 0}},s.prototype.applyLevelSetting=function(e){e.levelSettings={};for(var i=0,n=0,r=!1,o=1;o<=e.endLevel;o++){var l=this.getHeadingLevel(o);if(o===l)0===i&&(i=o,r=!1),r||(n=o);else if(r=!0,0!==l){var h="Heading "+o.toString();e.levelSettings[h]=l}}e.startLevel=i,e.endLevel=n,""!==this.normal.value&&(e.levelSettings.Normal=+this.normal.value)},s.prototype.destroy=function(){if(this.pageNumber&&(this.pageNumber.destroy(),this.pageNumber=void 0),this.rightAlign&&(this.rightAlign.destroy(),this.rightAlign=void 0),this.tabLeader&&(this.tabLeader.destroy(),this.tabLeader=void 0),this.showLevel&&(this.showLevel.destroy(),this.showLevel=void 0),this.hyperlink&&(this.hyperlink.destroy(),this.hyperlink=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.outline&&(this.outline.destroy(),this.outline=void 0),this.listViewInstance&&(this.listViewInstance.destroy(),this.listViewInstance=void 0),this.heading1=void 0,this.heading2=void 0,this.heading3=void 0,this.heading4=void 0,this.heading5=void 0,this.heading6=void 0,this.heading7=void 0,this.heading8=void 0,this.heading9=void 0,this.normal=void 0,this.textBoxInput=void 0,this.documentHelper=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},s}(),gr=function(){function s(e){var t=this;this.isPortrait=!0,this.loadPageSetupDialog=function(){t.documentHelper.updateFocus();var i=t.documentHelper.selection.sectionFormat;t.topMarginBox.value=i.topMargin,t.leftMarginBox.value=i.leftMargin,t.bottomMarginBox.value=i.bottomMargin,t.rightMarginBox.value=i.rightMargin,t.widthBox.value=i.pageWidth,t.heightBox.value=i.pageHeight,t.checkBox1.checked=i.differentOddAndEvenPages,t.checkBox2.checked=i.differentFirstPage,t.headerBox.value=i.headerDistance,t.footerBox.value=i.footerDistance,t.widthBox.value>t.heightBox.value?t.landscape.checked=!0:t.portrait.checked=!0,t.setPageSize(t.portrait.checked,parseFloat(i.pageWidth.toFixed(1)),parseFloat(i.pageHeight.toFixed(1)))},this.closePageSetupDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.keyUpInsertPageSettings=function(i){13===i.keyCode&&t.applyPageSetupProperties()},this.applyPageSetupProperties=function(){var i=new je;i.bottomMargin=t.bottomMarginBox.value,i.topMargin=t.topMarginBox.value,i.leftMargin=t.leftMarginBox.value,i.rightMargin=t.rightMarginBox.value,i.pageWidth=t.widthBox.value,i.pageHeight=t.heightBox.value,i.differentOddAndEvenPages=t.checkBox1.checked,i.differentFirstPage=t.checkBox2.checked,i.headerDistance=t.headerBox.value,i.footerDistance=t.footerBox.value,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,i),t.documentHelper.hideDialog()},this.changeByPaperSize=function(i){var n=i.value;t.documentHelper.selection.sectionFormat.pageWidth>t.documentHelper.selection.sectionFormat.pageHeight||t.landscape.checked?(t.isPortrait=!1,t.portrait.checked=!1):t.isPortrait=!0,"letter"===n?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=792):(t.widthBox.value=792,t.heightBox.value=612):"tabloid"===n?t.isPortrait?(t.widthBox.value=792,t.heightBox.value=1224):(t.widthBox.value=1224,t.heightBox.value=792):"legal"===n?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=1008):(t.widthBox.value=1008,t.heightBox.value=612):"statement"===n?t.isPortrait?(t.widthBox.value=392,t.heightBox.value=612):(t.widthBox.value=612,t.heightBox.value=392):"executive"===n?t.isPortrait?(t.widthBox.value=522,t.heightBox.value=756):(t.widthBox.value=756,t.heightBox.value=522):"a3"===n?t.isPortrait?(t.widthBox.value=841.9,t.heightBox.value=1190.55):(t.widthBox.value=1190.55,t.heightBox.value=841.9):"a4"===n?t.isPortrait?(t.widthBox.value=595.3,t.heightBox.value=841.9):(t.widthBox.value=841.9,t.heightBox.value=595.3):"a5"===n?t.isPortrait?(t.widthBox.value=419.55,t.heightBox.value=595.3):(t.widthBox.value=595.3,t.heightBox.value=419.55):"b4"===n?t.isPortrait?(t.widthBox.value=728.5,t.heightBox.value=1031.8):(t.widthBox.value=1031.8,t.heightBox.value=728.5):"b5"===n?t.isPortrait?(t.widthBox.value=515.9,t.heightBox.value=728.5):(t.widthBox.value=728.5,t.heightBox.value=515.9):"customsize"===n&&(t.widthBox.value=t.documentHelper.selection.sectionFormat.pageWidth,t.heightBox.value=t.documentHelper.selection.sectionFormat.pageHeight)},this.onPortrait=function(){t.landscape.checked=!1;var i=t.widthBox.value,n=t.heightBox.value;i>n&&(t.widthBox.value=n,t.heightBox.value=i)},this.onLandscape=function(){t.portrait.checked=!1;var i=t.widthBox.value,n=t.heightBox.value;i<n&&(t.widthBox.value=n,t.heightBox.value=i)},this.unWireEventsAndBindings=function(){t.paperSize.value=void 0,t.topMarginBox.value=void 0,t.bottomMarginBox.value=void 0,t.leftMarginBox.value=void 0,t.rightMarginBox.value=void 0,t.headerBox.value=void 0,t.footerBox.value=void 0,t.widthBox.value=void 0,t.heightBox.value=void 0,t.checkBox1.checked=!1,t.checkBox2.checked=!1,t.portrait.checked=!1,t.landscape.checked=!1},this.documentHelper=e}return s.prototype.getModuleName=function(){return"PageSetupDialog"},s.prototype.initPageSetupDialog=function(e,t){this.target=(0,a.az)("div");var i=(0,a.az)("div");this.target.appendChild(i),this.marginTab=(0,a.az)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.paperTab=(0,a.az)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.layoutTab=(0,a.az)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"});var n=(0,a.az)("div",{className:"e-de-page-setup-ppty-tab"}),r=(0,a.az)("div",{className:"e-tab-header"}),o=(0,a.az)("div",{innerHTML:e.getConstant("Margin")}),l=(0,a.az)("div",{innerHTML:e.getConstant("Paper")}),h=(0,a.az)("div",{innerHTML:e.getConstant("Layout")});r.appendChild(o),r.appendChild(l),r.appendChild(h);var d=(0,a.az)("div"),c=(0,a.az)("div"),u=(0,a.az)("div");d.appendChild(this.marginTab),c.appendChild(this.paperTab),u.appendChild(this.layoutTab),i.appendChild(n),this.initMarginProperties(this.marginTab,e,t),this.initPaperSizeProperties(this.paperTab,e,t),this.initLayoutProperties(this.layoutTab,e,t),new tt.OK({items:[{header:{text:o},content:d},{header:{text:l},content:c},{header:{text:h},content:u}],enableRtl:t},n).isStringTemplate=!0,this.target.addEventListener("keyup",this.keyUpInsertPageSettings)},s.prototype.initMarginProperties=function(e,t,i){var n=(0,a.az)("div"),r=(0,a.az)("div",{className:"e-de-container-row"});n.appendChild(r);var o=(0,a.az)("div",{className:"e-de-container-row"});n.appendChild(o),i&&(r.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"));var l=(0,a.az)("input",{attrs:{type:"text"}}),h=(0,a.az)("input",{attrs:{type:"text"}}),d=(0,a.az)("div",{className:"e-de-subcontainer-left"});d.appendChild(l),r.appendChild(d);var c=(0,a.az)("div",{className:"e-de-subcontainer-right"});c.appendChild(h),r.appendChild(c);var u=(0,a.az)("input",{attrs:{type:"text"},id:this.target.id+"_left"}),p=(0,a.az)("input",{attrs:{type:"text"}}),f=(0,a.az)("div",{className:"e-de-subcontainer-left"});f.appendChild(u),o.appendChild(f);var g=(0,a.az)("div",{className:"e-de-subcontainer-right"});g.appendChild(p),o.appendChild(g),e.appendChild(n),this.topMarginBox=new J.No({value:71,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Top")}),this.topMarginBox.appendTo(l),this.leftMarginBox=new J.No({value:73,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Left")}),this.leftMarginBox.appendTo(u),this.bottomMarginBox=new J.No({value:72,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Bottom")}),this.bottomMarginBox.appendTo(h),this.rightMarginBox=new J.No({value:74,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Right")}),this.rightMarginBox.appendTo(p);var m=(0,a.az)("div"),v=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("Orientation")}),y=(0,a.az)("div",{styles:"display: flex;"}),C=(0,a.az)("div",{id:"_portraitDiv",styles:i?"padding-left: 30px;":"padding-right: 30px;"}),F=(0,a.az)("input",{attrs:{type:"radiobutton"}}),T=(0,a.az)("div",{id:"_landscapeDiv"}),x=(0,a.az)("input",{attrs:{type:"radiobutton"}});C.appendChild(F),T.appendChild(x),y.appendChild(C),y.appendChild(T),m.appendChild(v),m.appendChild(y),this.portrait=new M.EU({label:t.getConstant("Portrait"),checked:!0,enableRtl:i,change:this.onPortrait}),this.landscape=new M.EU({label:t.getConstant("Landscape"),enableRtl:i,change:this.onLandscape}),this.portrait.appendTo(F),this.landscape.appendTo(x),e.appendChild(m)},s.prototype.initPaperSizeProperties=function(e,t,i){var n=(0,a.az)("div",{className:"e-de-container-row"}),r=(0,a.az)("div",{className:"e-de-subcontainer-left"});n.appendChild(r);var o=(0,a.az)("div",{className:"e-de-subcontainer-right"});n.appendChild(o),i&&(r.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"));var l=(0,a.az)("input",{attrs:{type:"text"}});r.appendChild(l);var h=(0,a.az)("input",{attrs:{type:"text"}});o.appendChild(h),e.appendChild(n),this.widthBox=new J.No({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Width")}),this.widthBox.appendTo(l),this.heightBox=new J.No({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Height")}),this.heightBox.appendTo(h);var d=(0,a.az)("div"),c=(0,a.az)("select",{styles:"width:170px;padding-bottom: 20px;",innerHTML:'<option value="letter">'+t.getConstant("Letter")+'</option><option value="tabloid">'+t.getConstant("Tabloid")+'</option><option value="legal">'+t.getConstant("Legal")+'</option><option value="statement">'+t.getConstant("Statement")+'</option><option value="executive">'+t.getConstant("Executive")+'</option><option value="a3">'+t.getConstant("A3")+'</option><option value="a4">'+t.getConstant("A4")+'</option><option value="a5">'+t.getConstant("A5")+'</option><option value="b4">'+t.getConstant("B4")+'</option><option value="b5">'+t.getConstant("B5")+'</option><option value="customsize">'+t.getConstant("Custom Size")+"</option>"});d.appendChild(c),this.paperSize=new Te.NB({change:this.changeByPaperSize,width:"170px",enableRtl:i}),this.paperSize.appendTo(c),e.appendChild(d)},s.prototype.initLayoutProperties=function(e,t,i){var n=(0,a.az)("div",{className:"e-de-dlg-container"}),r=(0,a.az)("div",{styles:"height: 27px;"}),o=(0,a.az)("input",{attrs:{type:"checkbox"}});r.appendChild(o);var l=(0,a.az)("div",{styles:"height: 27px;"}),h=(0,a.az)("input",{attrs:{type:"checkbox"}});l.appendChild(h),n.appendChild(r),n.appendChild(l),this.checkBox1=new M.Jg({label:t.getConstant("Different odd and even"),enableRtl:i}),this.checkBox2=new M.Jg({label:t.getConstant("Different first page"),enableRtl:i}),this.checkBox1.appendTo(o),this.checkBox2.appendTo(h),e.appendChild(n);var d=(0,a.az)("div"),c=(0,a.az)("label",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("From edge")});d.appendChild(c),e.appendChild(d);var u=(0,a.az)("div",{className:"e-de-dlg-row"}),p=(0,a.az)("div",{className:"e-de-subcontainer-left"});u.appendChild(p);var f=(0,a.az)("div",{className:"e-de-subcontainer-right"});u.appendChild(f),i&&(f.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"));var g=(0,a.az)("input",{attrs:{type:"text"}});p.appendChild(g);var m=(0,a.az)("input",{attrs:{type:"text"}});f.appendChild(m),e.appendChild(u),this.headerBox=new J.No({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Header")}),this.headerBox.appendTo(g),this.footerBox=new J.No({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Footer")}),this.footerBox.appendTo(m)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initPageSetupDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Page Setup"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadPageSetupDialog,this.documentHelper.dialog.close=this.closePageSetupDialog,this.documentHelper.dialog.buttons=[{click:this.applyPageSetupProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-layout-ppty-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-layout-ppty-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show();var t=this.documentHelper.dialog.element;t&&this.documentHelper.updateDialogTabHeight(t,this.target)},s.prototype.setPageSize=function(e,t,i){this.paperSize.value=e&&612===t&&792===i||!e&&792===t&&612===i?"letter":e&&792===t&&1224===i||!e&&1224===t&&792===i?"tabloid":e&&612===t&&1008===i||!e&&1008===t&&612===i?"legal":e&&392===t&&612===i||!e&&392===t&&612===i?"statement":e&&522===t&&756===i||!e&&756===t&&522===i?"executive":e&&841.9===t&&1190.5===i||!e&&1190.5===t&&841.9===i?"a3":e&&595.3===t&&841.9===i||!e&&841.9===t&&595.3===i?"a4":e&&419.6===t&&595.3===i||!e&&595.3===t&&419.6===i?"a5":e&&728.5===t&&1031.8===i||!e&&1031.8===t&&728.5===i?"b4":e&&515.9===t&&728.5===i||!e&&728.5===t&&515.9===i?"b5":"customsize"},s.prototype.destroy=function(){if(this.topMarginBox&&(this.topMarginBox.destroy(),this.topMarginBox=void 0),this.leftMarginBox&&(this.leftMarginBox.destroy(),this.leftMarginBox=void 0),this.bottomMarginBox&&(this.bottomMarginBox.destroy(),this.bottomMarginBox=void 0),this.rightMarginBox&&(this.rightMarginBox.destroy(),this.rightMarginBox=void 0),this.headerBox&&(this.headerBox.destroy(),this.headerBox=void 0),this.footerBox&&(this.footerBox.destroy(),this.footerBox=void 0),this.widthBox&&(this.widthBox.destroy(),this.widthBox=void 0),this.heightBox&&(this.heightBox.destroy(),this.heightBox=void 0),this.paperSize&&(this.paperSize.destroy(),this.paperSize=void 0),this.checkBox1&&(this.checkBox1.destroy(),this.checkBox1=void 0),this.checkBox2&&(this.checkBox2.destroy(),this.checkBox2=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.documentHelper=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},s}(),mr=function(){function s(e){var t=this;this.leftIndent=void 0,this.rightIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.spaceBeforeAuto=!1,this.spaceAfterAuto=!1,this.textAlignment=void 0,this.firstLineIndent=void 0,this.lineSpacingIn=void 0,this.lineSpacingType=void 0,this.paragraphFormat=void 0,this.bidi=void 0,this.contextualSpacing=void 0,this.isStyleDialog=!1,this.directionDiv=void 0,this.keepWithNextValue=void 0,this.keepLineTogetherValue=void 0,this.widowControlValue=void 0,this.tabObj=void 0,this.keyUpParagraphSettings=function(i){13===i.keyCode&&t.applyParagraphFormat()},this.changeBeforeSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);n.setLocale(t.documentHelper.owner.locale),-1===i.value?(t.beforeSpacingIn.element.value=n.getConstant("Auto"),t.beforeSpacingIn.step=1,t.spaceBeforeAuto=!0,t.beforeSpacing=5):(t.beforeSpacing=i.value,t.beforeSpacingIn.step=6,t.spaceBeforeAuto=!1)},this.focusBeforeSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);n.setLocale(t.documentHelper.owner.locale),-1===i.value&&(t.beforeSpacingIn.element.value=n.getConstant("Auto"))},this.blurBeforeSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);if(n.setLocale(t.documentHelper.owner.locale),-1===i.value){var r=t.beforeSpacingIn;setTimeout(function(){r.element.value=n.getConstant("Auto")},0)}},this.clickBeforeSpacing=function(){var i=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),"-1.0"===t.beforeSpacingIn.element.value&&(t.beforeSpacingIn.element.value=i.getConstant("Auto"))},this.changeAfterSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);n.setLocale(t.documentHelper.owner.locale),-1===i.value?(t.afterSpacingIn.element.value=n.getConstant("Auto"),t.afterSpacingIn.step=1,t.spaceAfterAuto=!0,t.afterSpacing=5):(t.afterSpacing=i.value,t.afterSpacingIn.step=6,t.spaceAfterAuto=!1)},this.focusAfterSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);n.setLocale(t.documentHelper.owner.locale),-1===i.value&&(t.afterSpacingIn.element.value=n.getConstant("Auto"))},this.blurAfterSpacing=function(i){var n=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);if(n.setLocale(t.documentHelper.owner.locale),-1===i.value){var r=t.afterSpacingIn;setTimeout(function(){r.element.value=n.getConstant("Auto")},0)}},this.clickAfterSpacing=function(){var i=new a.E7("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),"-1.0"===t.afterSpacingIn.element.value&&(t.afterSpacingIn.element.value=i.getConstant("Auto"))},this.changeLeftIndent=function(i){t.leftIndent=i.value},this.changeRightIndent=function(i){t.rightIndent=i.value},this.changeLineSpacingValue=function(i){t.lineSpacingIn=i.value},this.changeFirstLineIndent=function(i){t.firstLineIndent=i.value,2===t.special.index&&(t.firstLineIndent=-t.firstLineIndent,t.leftIndent=t.leftIndentIn.value+i.value)},this.changeByTextAlignment=function(i){t.textAlignment=i.value},this.changeBidirectional=function(i){"ltr"===i.value?(t.rtlButton.checked=!t.ltrButton.checked,t.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.bidi=!0),t.changeAlignmentByBidi()},this.changeContextualSpacing=function(i){t.contextualSpacing=i.checked},this.changeKeepWithNext=function(i){t.keepWithNextValue=i.checked},this.changeKeepLinesTogether=function(i){t.keepLineTogetherValue=i.checked},this.changeWidowControl=function(i){t.widowControlValue=i.checked},this.changeByValue=function(){var i=t.documentHelper.selection.paragraphFormat;switch(t.special.index){case 0:0!==i.firstLineIndent&&(t.byIn.value=0,t.leftIndent=t.leftIndentIn.value);break;case 1:0===i.firstLineIndent||(0,a.le)(i.firstLineIndent)?t.byIn.value=.1:i.firstLineIndent<0&&(t.byIn.value=-i.firstLineIndent,Math.abs(i.firstLineIndent)<=t.leftIndent&&(t.leftIndent=i.firstLineIndent+t.leftIndent));break;case 2:0===i.firstLineIndent||(0,a.le)(i.firstLineIndent)?i.firstLineIndent=-.1:i.firstLineIndent>0&&(t.byIn.value=i.firstLineIndent,t.leftIndent=(0,a.le)(t.leftIndent)?i.firstLineIndent:t.leftIndent+i.firstLineIndent)}},this.changeBySpacing=function(){if(!(0,a.le)(t.lineSpacing))switch(t.lineSpacing.index){case 0:t.lineSpacingType="AtLeast",t.atIn.value=12;break;case 1:t.lineSpacingType="Exactly",t.atIn.value=12;break;case 2:t.lineSpacingType="Multiple",t.atIn.value=1}},this.loadParagraphDialog=function(){var i;t.isStyleDialog?t.directionDiv.classList.add("e-de-disabledbutton"):t.directionDiv.classList.remove("e-de-disabledbutton");var n=t.getAlignmentValue((i=t.paragraphFormat?t.paragraphFormat:t.documentHelper.selection.paragraphFormat).textAlignment);t.alignment.index=n,t.beforeSpacingIn.value=i.spaceBeforeAuto?-1:-1===i.beforeSpacing?void 0:i.beforeSpacing,t.afterSpacingIn.value=i.spaceAfterAuto?-1:-1===i.afterSpacing?void 0:i.afterSpacing,t.leftIndentIn.value=i.leftIndent,t.rightIndentIn.value=i.rightIndent,t.byIn.value=Math.abs(i.firstLineIndent),t.keepWithNextValue=void 0,t.keepLineTogetherValue=void 0,t.widowControlValue=void 0,i.firstLineIndent>0?t.special.index=1:i.firstLineIndent<0&&(t.special.index=2,t.leftIndentIn.value=i.leftIndent-t.byIn.value),t.lineSpacing.index="AtLeast"===i.lineSpacingType?0:"Exactly"===i.lineSpacingType?1:2,t.atIn.value=i.lineSpacing,"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),i.bidi?(t.rtlButton.checked=!0,t.ltrButton.checked=!1):(t.ltrButton.checked=!0,t.rtlButton.checked=!1),(0,a.le)(i.keepWithNext)?t.keepWithNext.indeterminate=!0:t.keepWithNext.checked=i.keepWithNext,(0,a.le)(i.keepLinesTogether)?t.keepLinesTogether.indeterminate=!0:t.keepLinesTogether.checked=i.keepLinesTogether,(0,a.le)(i.widowControl)?t.widowControlIn.indeterminate=!0:t.widowControlIn.checked=i.widowControl,t.contextSpacing.checked=i.contextualSpacing},this.applyParagraphFormat=function(){var i,n;if(t.paragraphFormat?(i=t.paragraphFormat,n=!1):((i=new ue).borders=void 0,n=!0),(0,a.le)(t.beforeSpacing)||(i.beforeSpacing=t.beforeSpacing),(0,a.le)(t.afterSpacing)||(i.afterSpacing=t.afterSpacing),(0,a.le)(t.spaceBeforeAuto)||(i.spaceBeforeAuto=t.spaceBeforeAuto),(0,a.le)(t.spaceAfterAuto)||(i.spaceAfterAuto=t.spaceAfterAuto),(0,a.le)(t.lineSpacingType)||(i.lineSpacingType=t.lineSpacingType),(0,a.le)(t.leftIndent)||(i.leftIndent=t.leftIndent),(0,a.le)(t.rightIndent)||(i.rightIndent=t.rightIndent),(0,a.le)(t.lineSpacingIn)||(i.lineSpacing=t.lineSpacingIn),(0,a.le)(t.firstLineIndent)||(i.firstLineIndent=Math.abs(t.firstLineIndent),2===t.special.index&&(i.firstLineIndent=-i.firstLineIndent)),(0,a.le)(t.bidi)||(i.bidi=t.bidi),!(0,a.le)(t.textAlignment)){var r=t.textAlignment;i.bidi&&("Right"===r?r="Left":"Left"===r&&(r="Right")),i.textAlignment=r}(0,a.le)(t.contextualSpacing)||(i.contextualSpacing=t.contextualSpacing),(0,a.le)(t.keepWithNextValue)?t.documentHelper.selection.paragraphFormat.keepWithNext&&(i.keepWithNext=t.documentHelper.selection.paragraphFormat.keepWithNext):i.keepWithNext=t.keepWithNextValue,(0,a.le)(t.keepLineTogetherValue)?t.documentHelper.selection.paragraphFormat.keepLinesTogether&&(i.keepLinesTogether=t.documentHelper.selection.paragraphFormat.keepLinesTogether):i.keepLinesTogether=t.keepLineTogetherValue,(0,a.le)(t.widowControlValue)?t.documentHelper.selection.paragraphFormat.widowControl&&(i.widowControl=t.documentHelper.selection.paragraphFormat.widowControl):i.widowControl=t.widowControlValue,n?t.onParagraphFormat(i):t.documentHelper.owner.styleDialogModule.updateParagraphFormat(),t.documentHelper.hideDialog()},this.closeParagraphDialog=function(){t.leftIndent=void 0,t.afterSpacing=void 0,t.beforeSpacing=void 0,t.firstLineIndent=void 0,t.textAlignment=void 0,t.rightIndent=void 0,t.lineSpacingIn=void 0,t.lineSpacingType=void 0,t.paragraphFormat=void 0,t.documentHelper.hideDialog()},this.documentHelper=e}return Object.defineProperty(s.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"ParagraphDialog"},s.prototype.initParagraphDialog=function(e){var t=(0,a.az)("div"),i=(0,a.az)("div"),r=this.documentHelper.owner.containerId,o=(0,a.az)("div",{className:"e-de-dlg-tab-first-child e-de-para-dlg-container"});this.target=t,t.appendChild(i);var l=(0,a.az)("div",{styles:"width:400px;"}),h=(0,a.az)("div"),d=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")});h.appendChild(d);var c=(0,a.az)("div",{className:"e-de-container-row"});h.appendChild(c);var u=(0,a.az)("div",{className:"e-de-subcontainer-left"});c.appendChild(u);var p=(0,a.az)("select",{id:r+"_Alignment",innerHTML:'<option value="Center">'+e.getConstant("Center")+'</option><option value="Left">'+e.getConstant("Left")+'</option><option value="Right">'+e.getConstant("Right")+'</option><option value="Justify">'+e.getConstant("Justify")+"</option>"});u.appendChild(p);var f=(0,a.az)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Direction")});this.directionDiv=(0,a.az)("div",{className:"e-de-container-row"});var g=(0,a.az)("div",{className:"e-de-rtl-btn-div"}),m=(0,a.az)("input",{id:r+"_rtlEle"});g.appendChild(m),this.directionDiv.appendChild(g);var v=this.documentHelper.owner.enableRtl;v&&g.classList.add("e-de-rtl");var y=(0,a.az)("div",{className:"e-de-ltr-btn-div"}),b=(0,a.az)("input",{id:r+"_ltrEle"});y.appendChild(b),this.directionDiv.appendChild(y),h.appendChild(f),h.appendChild(this.directionDiv),this.rtlButton=new M.EU({label:e.getConstant("Right-to-left"),enableRtl:v,value:"rtl",cssClass:"e-small",change:this.changeBidirectional}),this.rtlButton.appendTo(m),this.ltrButton=new M.EU({label:e.getConstant("Left-to-right"),enableRtl:v,value:"ltr",cssClass:"e-small",change:this.changeBidirectional}),this.ltrButton.appendTo(b);var C=(0,a.az)("div"),F=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Indentation")});C.appendChild(F);var T=(0,a.az)("div",{className:"e-de-container-row"});C.appendChild(T);var x=(0,a.az)("div",{className:"e-de-container-row"});C.appendChild(x);var P=(0,a.az)("div",{className:"e-de-subcontainer-left"});T.appendChild(P);var E=(0,a.az)("div",{className:"e-de-subcontainer-right"});T.appendChild(E);var L=(0,a.az)("div",{className:"e-de-subcontainer-left"});x.appendChild(L);var W=(0,a.az)("div",{className:"e-de-subcontainer-right"});x.appendChild(W);var R=(0,a.az)("div"),N=(0,a.az)("div");R.appendChild(N);var B=(0,a.az)("div",{className:"e-de-container-row"});R.appendChild(B);var q=(0,a.az)("div",{className:"e-de-container-row"});R.appendChild(q);var A=(0,a.az)("input",{attrs:{type:"checkbox"},id:r+"_contextSpacing"});B.appendChild(A);var X=(0,a.az)("input",{id:r+"_leftIndent",attrs:{type:"text"}}),le=(0,a.az)("input",{id:r+"_rightIndent",attrs:{type:"text"}});P.appendChild(X),E.appendChild(le);var K=(0,a.az)("select",{id:r+"_special",innerHTML:'<option value="None">'+e.getConstant("None")+'</option><option value="First Line">'+e.getConstant("First line")+'</option><option value="Hanging">'+e.getConstant("Hanging")+"</option> "}),he=(0,a.az)("input",{id:r+"_By",attrs:{type:"text"}});L.appendChild(K),W.appendChild(he);var ge=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Spacing")}),te=(0,a.az)("div",{className:"e-de-container-row"}),G=(0,a.az)("div",{className:"e-de-subcontainer-left"}),Ae=(0,a.az)("input",{id:r+"_beforeSpacing",attrs:{type:"text"}}),pe=(0,a.az)("div",{className:"e-de-subcontainer-right"}),me=(0,a.az)("input",{id:r+"_afterSpacing",attrs:{type:"text"}});N.appendChild(ge),N.appendChild(te),G.appendChild(Ae),te.appendChild(G),pe.appendChild(me),te.appendChild(pe);var ze=(0,a.az)("div",{className:"e-de-subcontainer-left"}),Be=(0,a.az)("select",{id:r+"_lineSpacing",innerHTML:'<option value="At least">'+e.getConstant("At least")+'</option><option value="Exactly">'+e.getConstant("Exactly")+'</option><option value="Multiple">'+e.getConstant("Multiple")+"</option>"}),Me=(0,a.az)("div",{className:"e-de-subcontainer-right"}),lt=(0,a.az)("input",{id:r+"_lineSpacingAt",attrs:{type:"text"}});ze.appendChild(Be),q.appendChild(ze),Me.appendChild(lt),q.appendChild(Me),l.appendChild(h),l.appendChild(C),l.appendChild(R),o.appendChild(l),this.leftIndentIn=new J.No({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before text"),change:this.changeLeftIndent}),this.leftIndentIn.appendTo(X),this.rightIndentIn=new J.No({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After text"),change:this.changeRightIndent}),this.rightIndentIn.appendTo(le),this.byIn=new J.No({format:"n1",value:0,min:0,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("By"),change:this.changeFirstLineIndent}),this.byIn.appendTo(he),this.beforeSpacingIn=new J.No({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before"),change:this.changeBeforeSpacing,focus:this.focusBeforeSpacing,blur:this.blurBeforeSpacing}),this.beforeSpacingIn.appendTo(Ae),G.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickBeforeSpacing),this.afterSpacingIn=new J.No({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After"),change:this.changeAfterSpacing,focus:this.focusAfterSpacing,blur:this.blurAfterSpacing}),this.afterSpacingIn.appendTo(me),pe.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickAfterSpacing),this.atIn=new J.No({format:"n1",value:0,min:1,max:1584,step:.5,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("At"),change:this.changeLineSpacingValue}),this.special=new Te.NB({change:this.changeByValue,enableRtl:v,floatLabelType:"Always",placeholder:e.getConstant("Special")}),this.special.appendTo(K),this.lineSpacing=new Te.NB({change:this.changeBySpacing,enableRtl:v,floatLabelType:"Always",placeholder:e.getConstant("Line Spacing")}),this.lineSpacing.appendTo(Be),this.alignment=new Te.NB({change:this.changeByTextAlignment,enableRtl:v,floatLabelType:"Always",placeholder:e.getConstant("Alignment")}),this.alignment.appendTo(p),this.atIn.appendTo(lt),this.contextSpacing=new M.Jg({change:this.changeContextualSpacing,label:e.getConstant("Contextual Spacing"),enableRtl:v}),this.contextSpacing.appendTo(A),o.addEventListener("keyup",this.keyUpParagraphSettings),v&&(pe.classList.add("e-de-rtl"),Me.classList.add("e-de-rtl"));var ut=(0,a.az)("div",{className:"e-de-dlg-tab-first-child"}),mt=(0,a.az)("div",{className:"e-de-para-dlg-sub-container"});this.paginationDiv=mt;var ti=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Pagination")});mt.appendChild(ti);var Pt=(0,a.az)("div",{styles:"display:block"});mt.appendChild(Pt);var Dt=(0,a.az)("div",{styles:"display:block"});mt.appendChild(Dt);var ii=(0,a.az)("div",{styles:"display:block"});mt.appendChild(ii);var At=(0,a.az)("input",{attrs:{type:"checkbox"}});Dt.appendChild(At),this.keepWithNext=new M.Jg({change:this.changeKeepWithNext,label:e.getConstant("Keep With Next"),enableRtl:v,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepWithNext.appendTo(At);var Ht=(0,a.az)("input",{attrs:{type:"checkbox"}});ii.appendChild(Ht),this.keepLinesTogether=new M.Jg({change:this.changeKeepLinesTogether,label:e.getConstant("Keep Lines Together"),enableRtl:v,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepLinesTogether.appendTo(Ht);var Bt=(0,a.az)("input",{attrs:{type:"checkbox"}});Pt.appendChild(Bt),this.widowControlIn=new M.Jg({change:this.changeWidowControl,label:e.getConstant("WidowControl"),enableRtl:v,cssClass:"e-de-para-dlg-cs-check-box"}),this.widowControlIn.appendTo(Bt),ut.appendChild(mt);var hn=[{header:{text:e.getConstant("Indents and Spacing")},content:o},{header:{text:e.getConstant("Line and Page Breaks")},content:ut}];this.tabObj=new tt.OK({items:hn,enableRtl:v,animation:{previous:{effect:"None"},next:{effect:"None"}}},i),this.tabObj.isStringTemplate=!0},s.prototype.changeAlignmentByBidi=function(){"Left"===this.textAlignment?this.textAlignment="Right":"Right"===this.textAlignment&&(this.textAlignment="Left"),(0,a.le)(this.textAlignment)?this.textAlignment=0===this.alignment.index?"Center":"Justify":this.alignment.index=this.getAlignmentValue(this.textAlignment)},s.prototype.getAlignmentValue=function(e){return"Center"===e?0:"Left"===e?1:"Right"===e?2:3},s.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection,i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.documentHelper.owner.editor.setPreviousBlockToLayout(),this.documentHelper.owner.editorModule.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.documentHelper.owner.editorModule.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.documentHelper.owner.editor.layoutItemBlock(t.start.paragraph,!1)):this.documentHelper.owner.editorModule.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.documentHelper.owner.editorModule.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)},s.prototype.show=function(e){e?(this.isStyleDialog=!0,this.paragraphFormat=e):this.isStyleDialog=!1;var t=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),this.target||this.initParagraphDialog(t),this.loadParagraphDialog(),this.documentHelper.dialog.header=t.getConstant("Paragraph"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.applyParagraphFormat,buttonModel:{content:t.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeParagraphDialog,buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show();var i=this.documentHelper.dialog.element;if(i){var n=this.documentHelper.updateDialogTabHeight(i,this.target);this.paginationDiv.style.width=n.toString()+"px"}},s.prototype.destroy=function(){if(this.afterSpacingIn&&(this.afterSpacingIn.destroy(),this.afterSpacingIn=void 0),this.beforeSpacingIn&&(this.beforeSpacingIn.destroy(),this.beforeSpacingIn=void 0),this.leftIndentIn&&(this.leftIndentIn.destroy(),this.leftIndentIn=void 0),this.rightIndentIn&&(this.rightIndentIn.destroy(),this.rightIndentIn=void 0),this.byIn&&(this.byIn.destroy(),this.byIn=void 0),this.special&&(this.special.destroy(),this.special=void 0),this.atIn&&(this.atIn.destroy(),this.atIn=void 0),this.alignment&&(this.alignment.change=void 0,this.alignment.destroy()),this.alignment=void 0,this.lineSpacing&&(this.lineSpacing.change=void 0,this.lineSpacing.destroy()),this.lineSpacing=void 0,this.special&&(this.special.change=void 0,this.special.destroy()),this.special=void 0,this.documentHelper=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},s}(),vr=function(){function s(){this.listIn=void 0,this.levelNumberIn=void 0,this.dialog=void 0,this.levelNumber=0}return Object.defineProperty(s.prototype,"levelNumber",{get:function(){return this.levelNumberIn},set:function(e){this.levelNumberIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"list",{get:function(){return this.listIn},set:function(e){(0,a.le)(e)?this.createList():this.listIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"listLevel",{get:function(){if(!(0,a.le)(this.list)&&this.levelNumber>=0&&this.levelNumber<9){if((0,a.le)(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId))){this.dialog.documentHelper.lists.push(this.list);var e=this.list.abstractList;return this.list.abstractList||((e=new et).abstractListId=this.list.abstractListId),this.dialog.documentHelper.abstractLists.push(e),(e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId)).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),e.levels[this.levelNumber]}return this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels[this.levelNumber]}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"listLevelPattern",{get:function(){return(0,a.le)(this.listLevel)?"Arabic":this.listLevel.listLevelPattern},set:function(e){(0,a.le)(this.listLevel)||(this.listLevel.listLevelPattern=e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"followCharacter",{get:function(){return(0,a.le)(this.listLevel)?"None":this.listLevel.followCharacter},set:function(e){(0,a.le)(this.listLevel)||(this.listLevel.followCharacter=e)},enumerable:!0,configurable:!0}),s.prototype.createList=function(){this.list=new ft,this.list.listId=this.dialog.documentHelper.lists.length+1;var e=new et;e.abstractListId=this.dialog.documentHelper.abstractLists.length+1,this.list.abstractListId=e.abstractListId,this.list.abstractList=e,this.dialog.documentHelper.lists.push(this.list);var t=new nt(e);t.paragraphFormat=new ue(t),t.paragraphFormat.leftIndent=48,t.paragraphFormat.firstLineIndent=-24,t.characterFormat=new ie(t),t.numberFormat="%1.",t.startAt=1,e.levels.push(t),this.dialog.documentHelper.abstractLists.push(e)},s.prototype.addListLevels=function(){if(!(0,a.le)(this.list)&&!(0,a.le)(this.list.abstractListId))for(var e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length;e<9;e++){var t=new nt(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId));t.characterFormat=new ie(t),t.paragraphFormat=new ue(t),t.paragraphFormat.leftIndent=48*(e+1),t.paragraphFormat.firstLineIndent=-24,t.numberFormat="%"+(e+1).toString()+".",t.listLevelPattern="Arabic",t.followCharacter="Tab",t.startAt=1,t.restartLevel=e,this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.push(t)}},s.prototype.destroy=function(){this.dialog&&this.listIn&&this.dialog.documentHelper.layout.clearInvalidList(this.listIn),this.listIn=void 0,this.levelNumberIn=void 0,this.listLevelPattern=void 0},s}(),yr=function(){function s(e){var t=this;this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.viewModel=void 0,this.startAt=void 0,this.textIndent=void 0,this.alignedAt=void 0,this.listLevelElement=void 0,this.followNumberWith=void 0,this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy=void 0,this.isListCharacterFormat=!1,this.onTextIndentChanged=function(i){!i.isInteracted||(t.viewModel.listLevel.paragraphFormat.leftIndent=i.value)},this.onStartValueChanged=function(i){!i.isInteracted||!(0,a.le)(t.viewModel)&&!(0,a.le)(t.viewModel.listLevel)&&(t.viewModel.listLevel.startAt=i.value)},this.onListLevelValueChanged=function(i){t.viewModel.levelNumber=parseInt(i.value.slice(i.value.length-1),10)-1,!(0,a.le)(t.listLevel)&&(t.updateDialogValues(),t.updateRestartLevelBox())},this.onNumberFormatChanged=function(i){t.viewModel.listLevel.numberFormat=i.target.value},this.onAlignedAtValueChanged=function(i){!i.isInteracted||(t.viewModel.listLevel.paragraphFormat.firstLineIndent=t.alignedAt.value-t.viewModel.listLevel.paragraphFormat.leftIndent)},this.onFollowCharacterValueChanged=function(i){i.isInteracted&&(t.viewModel.followCharacter=i.value)},this.onLevelPatternValueChanged=function(i){if(i.isInteracted){t.viewModel.listLevelPattern=i.value;var n="%"+(t.levelNumber+1).toString(),r=document.getElementById(t.documentHelper.owner.containerId+"_numberFormat");"Bullet"===t.listLevel.listLevelPattern?(t.listLevel.numberFormat=String.fromCharCode(61623),r.value=t.listLevel.numberFormat):("None"===t.listLevel.listLevelPattern&&(t.listLevel.numberFormat=""),!t.listLevel.numberFormat.match(n)&&"None"!==t.listLevel.listLevelPattern&&(t.listLevel.numberFormat=n+"."),r.value=t.listLevel.numberFormat)}},this.loadListDialog=function(){t.documentHelper.updateFocus(),!(0,a.le)(t.documentHelper.owner)&&(t.viewModel=new vr,t.viewModel.dialog=t,t.documentHelper.selection.paragraphFormat.listLevelNumber>0&&(t.viewModel.levelNumber=t.documentHelper.selection.paragraphFormat.listLevelNumber),t.viewModel.list=t.documentHelper.selection.paragraphFormat.getList(),!(0,a.le)(t.listLevel)&&(t.updateDialogValues(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")))},this.showFontDialog=function(){t.documentHelper.owner.fontDialogModule.showFontDialog(t.listLevel.characterFormat,!0)},this.onApplyList=function(){(0,a.le)(t.owner)||t.documentHelper.selection.paragraphFormat.setList(t.list,!0),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.disposeBindingForListUI(),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.closeListDialog=function(){t.disposeBindingForListUI(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.documentHelper=e,this.viewModel=new vr}return Object.defineProperty(s.prototype,"listLevel",{get:function(){if(!(0,a.le)(this.viewModel))return this.viewModel.listLevel},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"list",{get:function(){if(!(0,a.le)(this.viewModel))return this.viewModel.list},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"levelNumber",{get:function(){return this.listLevel.ownerBase instanceof It?this.listLevel.ownerBase.levelNumber:this.listLevel.ownerBase instanceof et&&!(0,a.le)(this.listLevel.ownerBase.levels)?this.listLevel.ownerBase.levels.indexOf(this.listLevel):-1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"ListDialog"},s.prototype.showListDialog=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);var t=!1;this.target||(this.initListDialog(e,this.documentHelper.owner.enableRtl),t=!0),this.isListCharacterFormat=!0,this.documentHelper.dialog2.header=e.getConstant("Define new Multilevel list"),this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target;var i,n=this.documentHelper.owner.enableRtl;i=n?"e-flat e-list-dlg-font e-de-dlg-target.e-de-rtl e-font-rtl":"e-flat e-list-dlg-font e-font",this.documentHelper.dialog2.buttons=[{click:this.showFontDialog,buttonModel:{content:e.getConstant("Font"),cssClass:i}},{click:this.onApplyList,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-list-dlg",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-list-dlg"}}],this.documentHelper.dialog2.dataBind(),t&&this.wireAndBindEvent(e,n),this.documentHelper.dialog2.beforeOpen=this.loadListDialog,this.documentHelper.dialog2.close=this.closeListDialog,this.documentHelper.dialog2.position={X:"center",Y:"top"},this.documentHelper.dialog2.show()},s.prototype.initListDialog=function(e,t){var i=this.documentHelper.owner.containerId;this.target=(0,a.az)("div",{id:i+"_insert_list",className:"e-de-list-dlg"});var r=(0,a.az)("div",{innerHTML:'<label id="'+i+'_listLevellabel" style="display:block;" class=e-de-list-ddl-header-list-level>'+e.getConstant("List level")+'</label><label id="'+i+'_modifyLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Choose level to modify")+'</label><select style="height:20px;width:43%" id="'+i+'_listLevel"><option>'+e.getConstant("Level")+" 1</option><option>"+e.getConstant("Level")+" 2</option><option>"+e.getConstant("Level")+" 3</option><option>"+e.getConstant("Level")+" 4</option><option>"+e.getConstant("Level")+" 5</option><option>"+e.getConstant("Level")+" 6</option><option>"+e.getConstant("Level")+" 7</option><option>"+e.getConstant("Level")+" 8</option><option>"+e.getConstant("Level")+" 9</option></select>"});this.target.appendChild(r);var l,d,o=(0,a.az)("div"),h=(0,a.az)("div",{innerHTML:(l=t?'<div style="float:right;display:block;width:241px;">':'<div style="float:left;display:block;">')+'<label id="'+i+'_numberFormatLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Number format")+'</label><label id="'+i+'_numberStyleLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Number style for this level")+'</label><select style="height:20px;width:100%" id="'+i+'_numberStyle"><option>'+e.getConstant("Arabic")+"</option><option>"+e.getConstant("UpRoman")+"</option><option>"+e.getConstant("LowRoman")+"</option><option>"+e.getConstant("UpLetter")+"</option><option>"+e.getConstant("LowLetter")+"</option><option>"+e.getConstant("Number")+"</option><option>"+e.getConstant("Leading zero")+"</option><option>"+e.getConstant("Bullet")+"</option><option>"+e.getConstant("Ordinal")+"</option><option>"+e.getConstant("Ordinal Text")+"</option><option>"+e.getConstant("Special")+"</option><option>"+e.getConstant("For East")+'</option></select><label id="'+i+'_startAtLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Start at")+'</label><input type="text" id="'+i+'_startAt">'});o.appendChild(h),this.numberFormatDiv=(0,a.az)("div",{className:"e-de-list-dlg-subdiv",innerHTML:'<div><div><label id="'+i+'_formatLabel" style="display:inline-block;width:86%" class=e-de-list-ddl-subheader>'+e.getConstant("Enter formatting for number")+'</label><button type="button" id="'+i+'_list_info" class="e-control e-btn e-primary e-de-list-format-info">i</button></div><input style=width:180px; type="text" id="'+i+'_numberFormat" class=e-input></div><label id="'+i+'_restartLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Restart list after")+'</label><select style="height:20px;width:100%" id="'+i+'_restartBy"><option>'+e.getConstant("No Restart")+"</option></select></div>"}),o.appendChild(this.numberFormatDiv),this.target.appendChild(o);var c=(0,a.az)("div",{innerHTML:l+'<label id="'+i+'_IndentsLabel" style='+(d=t?"display:block;position:relative; ":"display:block; ")+"class=e-de-list-ddl-header>"+e.getConstant("Position")+'</label><label id="'+i+'_textIndentLabel" style='+d+"class=e-de-list-ddl-subheader>"+e.getConstant("Text indent at")+'</label><input type="text" id="'+i+'_textIndent"><label id="'+i+'_followCharacterLabel" style='+d+"class=e-de-list-ddl-subheaderbottom>"+e.getConstant("Follow number with")+'</label><select style="height:20px;width:100%" id="'+i+'_followCharacter"><option>'+e.getConstant("Tab character")+"</option><option>"+e.getConstant("Space")+"</option><option>"+e.getConstant("Nothing")+'</option></select></div><div id="e-de-list-dlg-div" class="e-de-list-dlg-div"><label id="'+i+'_alignedAtLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Aligned at")+'</label><input type="text" id="'+i+'_alignedAt"></div>'});this.target.appendChild(c)},s.prototype.wireAndBindEvent=function(e,t){var i=this.documentHelper.owner.containerId;t&&(document.getElementById("e-de-list-dlg-div").classList.add("e-de-rtl"),this.numberFormatDiv.classList.add("e-de-rtl"));var n=document.getElementById(i+"_startAt"),r=document.getElementById(i+"_textIndent"),o=document.getElementById(i+"_alignedAt");this.startAt=new J.No({format:"#",decimals:0,min:0,max:50,width:"180px",enablePersistence:!1}),this.startAt.addEventListener("change",this.onStartValueChanged),this.startAt.appendTo(n),this.textIndent=new J.No({format:"#",decimals:0,min:0,max:1584,width:"180px",step:4,enablePersistence:!1}),this.textIndent.addEventListener("change",this.onTextIndentChanged),this.textIndent.appendTo(r),this.alignedAt=new J.No({format:"#",max:1584,step:6,width:"180px",enablePersistence:!1}),this.alignedAt.addEventListener("change",this.onAlignedAtValueChanged),this.alignedAt.appendTo(o);var l=document.getElementById(i+"_listLevel");this.listLevelElement=new Te.NB({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onListLevelValueChanged}),this.listLevelElement.appendTo(l);var h=document.getElementById(i+"_followCharacter");this.followNumberWith=new Te.NB({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onFollowCharacterValueChanged}),this.followNumberWith.appendTo(h);var d=document.getElementById(i+"_numberStyle");this.numberStyle=new Te.NB({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onLevelPatternValueChanged}),this.numberStyle.appendTo(d),this.numberFormat=document.getElementById(i+"_numberFormat"),this.numberFormat.addEventListener("change",this.onNumberFormatChanged);var c=document.getElementById(i+"_restartBy");this.restartBy=new Te.NB({popupHeight:"150px",width:"180px",enableRtl:t}),this.restartBy.appendTo(c);var u=document.getElementById(i+"_list_info");this.formatInfoToolTip=new se.u({width:200}),this.formatInfoToolTip.content=e.getConstant("Number format tooltip information"),this.formatInfoToolTip.position="RightTop",this.formatInfoToolTip.appendTo(u)},s.prototype.updateRestartLevelBox=function(){for(var e=this.documentHelper.owner.containerId,t=document.getElementById(e+"_listLevel"),i=document.getElementById(e+"_restartBy"),n=0;n<i.options.length;n)i.options.remove(n);if(0===t.selectedIndex)(r=document.createElement("option")).value="No Restart",r.innerHTML="No Restart",i.appendChild(r);else{for(n=t.selectedIndex;n>0;n--){var o=document.createElement("option");o.value="Level "+n,o.innerHTML="Level "+n,i.appendChild(o)}var r;(r=document.createElement("option")).value="No Restart",r.innerHTML="No Restart",i.appendChild(r)}i.selectedIndex=0},s.prototype.listPatternConverter=function(e){switch(e){case"Arabic":return 0;case"UpRoman":return 1;case"LowRoman":return 2;case"UpLetter":return 3;case"LowLetter":return 4;case"Number":return 5;case"LeadingZero":return 6;case"Bullet":return 7;case"Ordinal":return 8;case"OrdinalText":return 9;case"Special":return 10;case"FarEast":return 11;default:return 12}},s.prototype.followCharacterConverter=function(e){switch(e){case"Tab":return 0;case"Space":return 1;default:return 2}},s.prototype.calculateAlignedAt=function(){return this.viewModel.listLevel.paragraphFormat.firstLineIndent<0?this.viewModel.listLevel.paragraphFormat.leftIndent+this.viewModel.listLevel.paragraphFormat.firstLineIndent:this.viewModel.listLevel.paragraphFormat.firstLineIndent},s.prototype.updateDialogValues=function(){(0,a.le)(this.listLevel.characterFormat)&&(this.listLevel.characterFormat=new ie(this.viewModel.listLevel)),(0,a.le)(this.listLevel.paragraphFormat)&&(this.listLevel.paragraphFormat=new ue(this.viewModel.listLevel)),!(0,a.le)(this.viewModel)&&!(0,a.le)(this.viewModel.listLevel)&&(this.startAt.value=this.viewModel.listLevel.startAt,this.textIndent.value=this.viewModel.listLevel.paragraphFormat.leftIndent,this.alignedAt.value=this.calculateAlignedAt(),this.followNumberWith.index=this.followCharacterConverter(this.viewModel.followCharacter),this.numberFormat.value=this.viewModel.listLevel.numberFormat,this.numberFormat.style.fontFamily=this.viewModel.listLevel.characterFormat.fontFamily,this.numberStyle.index=this.listPatternConverter(this.viewModel.listLevelPattern),this.listLevelElement.index=this.viewModel.levelNumber)},s.prototype.updateCharacterFormat=function(e){this.listLevel.characterFormat.copyFormat(e)},s.prototype.disposeBindingForListUI=function(){this.followNumberWith.index=-1,this.numberFormat.value=" ",this.numberStyle.index=-1,this.listLevelElement.index=-1,this.restartBy.index=-1,this.viewModel.destroy()},s.prototype.destroy=function(){if(this.alignedAt&&this.alignedAt.destroy(),this.alignedAt=void 0,this.dialog=void 0,this.followNumberWith&&this.followNumberWith.destroy(),this.followNumberWith=void 0,this.listLevelElement&&this.listLevelElement.destroy(),this.listLevelElement=void 0,this.textIndent&&this.textIndent.destroy(),this.textIndent=void 0,this.startAt&&this.startAt.destroy(),this.startAt=void 0,this.numberStyle&&this.numberStyle.destroy(),this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy&&this.restartBy.destroy(),this.restartBy=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.documentHelper=void 0,this.viewModel=void 0},s}(),br=function(){function s(e){var t=this;this.target=void 0,this.styleType=void 0,this.styleBasedOn=void 0,this.styleParagraph=void 0,this.onlyThisDocument=void 0,this.template=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0,this.openDialog=function(i){switch(i.item.id){case"style_font":t.showFontDialog();break;case"style_paragraph":t.showParagraphDialog();break;case"style_numbering":t.showNumberingBulletDialog()}},this.setBoldProperty=function(){t.characterFormat.bold=!t.characterFormat.bold,t.fontButtonClicked()},this.setItalicProperty=function(){t.characterFormat.italic=!t.characterFormat.italic,t.fontButtonClicked()},this.setUnderlineProperty=function(){t.characterFormat.underline="None"===t.characterFormat.underline?"Single":"None",t.fontButtonClicked()},this.fontButtonClicked=function(){t.characterFormat.bold?t.bold.classList.contains("e-active")||t.bold.classList.add("e-active"):t.bold.classList.contains("e-active")&&t.bold.classList.remove("e-active"),t.characterFormat.italic?t.italic.classList.contains("e-active")||t.italic.classList.add("e-active"):t.italic.classList.contains("e-active")&&t.italic.classList.remove("e-active"),void 0!==t.characterFormat.underline&&"None"!==t.characterFormat.underline?t.underline.classList.contains("e-active")||(t.underline.classList.add("e-active"),t.characterFormat.underline="Single"):t.underline.classList.contains("e-active")&&(t.underline.classList.remove("e-active"),t.characterFormat.underline="None")},this.fontSizeUpdate=function(i){t.characterFormat.fontSize=i.value},this.fontFamilyChanged=function(i){t.characterFormat.fontFamily=i.value.toString()},this.fontColorUpdate=function(i){t.characterFormat.fontColor=i.currentValue.hex},this.setLeftAlignment=function(){t.paragraphFormat.textAlignment="Left"===t.paragraphFormat.textAlignment?"Justify":"Left",t.updateParagraphFormat()},this.setRightAlignment=function(){t.paragraphFormat.textAlignment="Right"===t.paragraphFormat.textAlignment?"Left":"Right",t.updateParagraphFormat()},this.setCenterAlignment=function(){t.paragraphFormat.textAlignment="Center"===t.paragraphFormat.textAlignment?"Left":"Center",t.updateParagraphFormat()},this.setJustifyAlignment=function(){t.paragraphFormat.textAlignment="Justify"===t.paragraphFormat.textAlignment?"Left":"Justify",t.updateParagraphFormat()},this.increaseBeforeAfterSpacing=function(){t.paragraphFormat.beforeSpacing+=6,t.paragraphFormat.afterSpacing+=6},this.decreaseBeforeAfterSpacing=function(){t.paragraphFormat.beforeSpacing>=6?t.paragraphFormat.beforeSpacing-=6:t.paragraphFormat.beforeSpacing=0,t.paragraphFormat.afterSpacing>=6?t.paragraphFormat.afterSpacing-=6:t.paragraphFormat.afterSpacing=0},this.updateNextStyle=function(i){var n=i.srcElement.value;if(t.getTypeValue()===t.localObj.getConstant("Paragraph")&&!(0,a.le)(n)&&""!==n&&!t.isUserNextParaUpdated){var r=t.documentHelper.styles.getStyleNames(t.getTypeValue());t.isEdit&&(r=r.filter(function(o){return o!==t.editStyleName})),r.push(n),t.styleParagraph.dataSource=r,t.styleParagraph.index=null,t.styleParagraph.index=r.indexOf(n),t.styleParagraph.dataBind()}},this.updateOkButton=function(){t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),t.enableOrDisableOkButton()},this.styleTypeChange=function(i){if(i.isInteracted){var n=void 0;"Character"===i.value&&(t.style=new gt,n="Character"),("Paragraph"===i.value||"Linked Style"===i.value)&&(t.style=new Xe,n="Paragraph"),t.toggleDisable(),t.updateStyleNames(n)}},this.styleBasedOnChange=function(){},this.styleParagraphChange=function(i){i.isInteracted&&(t.isUserNextParaUpdated=!0)},this.showFontDialog=function(){(0,a.le)(t.documentHelper.owner.fontDialogModule)||t.documentHelper.owner.showFontDialog(t.characterFormat),t.updateCharacterFormat()},this.showParagraphDialog=function(){(0,a.le)(t.documentHelper.owner.paragraphDialogModule)||t.documentHelper.owner.showParagraphDialog(t.paragraphFormat)},this.showNumberingBulletDialog=function(){t.numberingBulletDialog=new _i(t.documentHelper),t.style instanceof Xe&&!(0,a.le)(t.style.paragraphFormat)&&t.numberingBulletDialog.showNumberBulletDialog(t.style.paragraphFormat.listFormat,t.abstractList)},this.onOkButtonClick=function(){var i=t.styleNameElement.value;if(!(i.length>0))throw new Error("Enter valid Style name");var n=t.documentHelper.styles.findByName(i);if((0,a.le)(n)){var o="Paragraph"===t.getTypeValue()?new Xe:new gt;o.copyStyle(t.style);var l=t.documentHelper.styles.findByName(t.styleBasedOn.value);("Paragraph"===t.styleType.value||"Linked Style"===t.styleType.value)&&(o.next=i===t.styleParagraph.value?o:t.documentHelper.styles.findByName(t.styleParagraph.value),t.updateList()),o.link="Linked Style"===t.styleType.value?t.createLinkStyle(i):void 0,o.type=t.getTypeValue(),o.name=i,o.basedOn=l,t.documentHelper.styles.push(o),t.documentHelper.owner.editorModule.applyStyle(i,!0)}else t.style.type=t.getTypeValue(),t.style.basedOn=t.documentHelper.styles.findByName(t.styleBasedOn.value),("Paragraph"===t.styleType.value||"Linked Style"===t.styleType.value)&&(t.style.next=t.documentHelper.styles.findByName(t.styleParagraph.value),t.style.characterFormat.mergeFormat(n.characterFormat),t.style.paragraphFormat.mergeFormat(n.paragraphFormat,!0),t.updateList(),t.style.link="Linked Style"===t.styleType.value?t.createLinkStyle(i,t.isEdit):void 0),t.style.name=n.name,n=t.style,t.documentHelper.owner.isShiftingEnabled=!0,t.documentHelper.owner.editorModule.layoutWholeDocument(),t.documentHelper.owner.isShiftingEnabled=!1;t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.documentHelper.updateFocus()},this.loadStyleDialog=function(){var i;t.documentHelper.updateFocus(),t.isUserNextParaUpdated=!1,t.styleNameElement=t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),t.styleNameElement.value=null,t.isEdit||(t.styleType.index=0),t.isEdit&&(t.styleNameElement.value=t.editStyleName,i=t.editStyleName),t.okButton=t.documentHelper.dialog2.element.getElementsByClassName("e-flat e-style-okay").item(0),t.enableOrDisableOkButton(),t.updateStyleNames(t.getTypeValue(),i),t.updateCharacterFormat(t.style.characterFormat),t.updateParagraphFormat(t.style.paragraphFormat)},this.onCancelButtonClick=function(){!t.isEdit&&t.style&&t.style.destroy(),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.closeStyleDialog=function(){t.documentHelper.updateFocus()},this.documentHelper=e}return s.prototype.getModuleName=function(){return"StyleDialog"},s.prototype.initStyleDialog=function(e,t){this.localObj=e,this.target=(0,a.az)("div",{className:"e-de-style-dialog"});var i=(0,a.az)("div"),n=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Properties")});i.appendChild(n);var r=(0,a.az)("div",{className:"e-de-container-row"});i.appendChild(r);var o=(0,a.az)("div",{className:"e-de-subcontainer-left"});r.appendChild(o);var l=(0,a.az)("input",{className:"e-input e-de-style-dlg-name-input"});l.addEventListener("keyup",this.updateOkButton),l.addEventListener("input",this.updateOkButton),l.addEventListener("blur",this.updateNextStyle),o.appendChild(l),new J.zC({placeholder:e.getConstant("Name")+":",floatLabelType:"Always"},l);var h=(0,a.az)("div",{className:"e-de-subcontainer-right"});r.appendChild(h);var d=(0,a.az)("div"),c=(0,a.az)("select");c.innerHTML='<option value="Paragraph">'+e.getConstant("Paragraph")+'</option><option value="Character">'+e.getConstant("Character")+'</option><option value="Linked Style">'+e.getConstant("Linked Style")+"</option>",d.appendChild(c),this.styleType=new Te.NB({change:this.styleTypeChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style type")+":",floatLabelType:"Always"}),this.styleType.appendTo(c),h.appendChild(d);var u=(0,a.az)("div",{className:"e-de-container-row"});i.appendChild(u);var p=(0,a.az)("div",{className:"e-de-subcontainer-left"});u.appendChild(p);var f=(0,a.az)("div",{className:"e-de-style-style-based-on-div"}),g=(0,a.az)("input");f.appendChild(g),this.styleBasedOn=new Te.NB({dataSource:[],select:this.styleBasedOnChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style based on")+":",floatLabelType:"Always"}),this.styleBasedOn.appendTo(g),p.appendChild(f);var m=(0,a.az)("div",{className:"e-de-subcontainer-right"});u.appendChild(m),t&&(o.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"),m.classList.add("e-de-rtl"));var v=(0,a.az)("div"),y=(0,a.az)("input");v.appendChild(y),this.styleParagraph=new Te.NB({dataSource:[],select:this.styleParagraphChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style for following paragraph")+":",floatLabelType:"Always"}),this.styleParagraph.appendTo(y),m.appendChild(v);var b=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Formatting")});i.appendChild(b);var C=(0,a.az)("div",{className:"e-de-style-options-div"});i.appendChild(C);var F=(0,a.az)("div",{styles:"display:flex;margin-bottom: 14px;"});C.appendChild(F),this.createFontOptions(F,t);var T=(0,a.az)("div",{styles:"display:flex",className:"e-style-paragraph"});C.appendChild(T),this.createParagraphOptions(T),this.createFormatDropdown(i,e,t),this.target.appendChild(i)},s.prototype.createFormatDropdown=function(e,t,i){var n=this,r=(0,a.az)("button",{id:"style_format_dropdown",innerHTML:t.getConstant("Format"),attrs:{type:"button"}});r.style.height="31px",e.appendChild(r);var o=[{text:t.getConstant("Font")+"...",id:"style_font"},{text:t.getConstant("Paragraph")+"...",id:"style_paragraph"},{text:t.getConstant("Numbering")+"...",id:"style_numbering"}];this.styleDropdwn=new Ue.uw({items:o,cssClass:"e-de-style-format-dropdwn",enableRtl:i,beforeItemRender:function(l){n.styleType.value===t.getConstant("Character")?(l.item.text===t.getConstant("Paragraph")&&l.element.classList.add("e-disabled"),"Numbering"===l.item.text&&l.element.classList.add("e-disabled")):(l.item.text===t.getConstant("Paragraph")&&l.element.classList.remove("e-disabled"),"Numbering"===l.item.text&&l.element.classList.remove("e-disabled"))}}),this.styleDropdwn.appendTo(r),this.styleDropdwn.addEventListener("select",this.openDialog)},s.prototype.createFontOptions=function(e,t){var i=this,n=(0,a.az)("input",{id:this.target.id+"_fontName"});e.appendChild(n),this.fontFamily=new Te.Ct({dataSource:void 0,query:(new ri.AE).select(["FontName"]),fields:{text:"FontName",value:"value"},allowCustom:!0,width:"123px",popupWidth:"123px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontFamilyChanged,showClearButton:!1,itemTemplate:'<span style="font-family: ${FontName};">${FontName}</span>'}),this.fontFamily.appendTo(n),this.fontFamily.isStringTemplate=!0;for(var h=this.documentHelper.owner.documentEditorSettings.fontFamilies,d=0;d<h.length;d++){var c=h[d];this.fontFamily.addItem({FontName:c,value:c},d)}this.fontFamily.focus=function(){i.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"));var p=(0,a.az)("input");e.appendChild(p),this.fontSize=new Te.Ct({dataSource:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],width:"73px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontSizeUpdate}),this.fontSize.showClearButton=!1,this.fontSize.appendTo(p);var g=(0,a.az)("div",{className:"e-de-style-font-group-button"});e.appendChild(g),this.bold=this.createButtonElement(g,"e-de-bold","e-de-style-bold-button-size",this.documentHelper.owner.containerId+"_style_bold"),this.bold.addEventListener("click",this.setBoldProperty),this.italic=this.createButtonElement(g,"e-de-italic","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_italic"),this.italic.addEventListener("click",this.setItalicProperty),this.underline=this.createButtonElement(g,"e-de-underline","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_underline"),this.underline.addEventListener("click",this.setUnderlineProperty);var m=(0,a.az)("input",{attrs:{type:"color"},className:"e-de-style-icon-button-size"});e.appendChild(m),this.fontColor=new J.zH({cssClass:"e-de-style-font-color-picker",enableRtl:t,change:this.fontColorUpdate,locale:this.documentHelper.owner.locale}),this.fontColor.appendTo(m)},s.prototype.createParagraphOptions=function(e){var t=this,i=(0,a.az)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(i),this.leftAlign=this.createButtonElement(i,"e-de-align-left","e-de-style-icon-button-size"),this.leftAlign.addEventListener("click",this.setLeftAlignment),this.centerAlign=this.createButtonElement(i,"e-de-align-center","e-de-style-icon-button-size"),this.centerAlign.addEventListener("click",this.setCenterAlignment),this.rightAlign=this.createButtonElement(i,"e-de-align-right","e-de-style-icon-button-size"),this.rightAlign.addEventListener("click",this.setRightAlignment),this.justify=this.createButtonElement(i,"e-de-justify","e-de-style-icon-button-last-size"),this.justify.addEventListener("click",this.setJustifyAlignment);var n=(0,a.az)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(n),this.singleLineSpacing=this.createButtonElement(n,"e-de-single-spacing","e-de-style-icon-button-first-size"),this.singleLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=1,t.updateParagraphFormat()}),this.onePointFiveLineSpacing=this.createButtonElement(n,"e-de-one-point-five-spacing","e-de-style-icon-button-size"),this.onePointFiveLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=1.5,t.updateParagraphFormat()}),this.doubleLineSpacing=this.createButtonElement(n,"e-de-double-spacing","e-de-style-icon-button-last-size"),this.doubleLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=2,t.updateParagraphFormat()});var r=(0,a.az)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(r);var o=this.createButtonElement(r,"e-de-before-spacing","e-de-style-icon-button-first-size"),l=this.createButtonElement(r,"e-de-after-spacing","e-de-style-icon-button-last-size");o.addEventListener("click",this.increaseBeforeAfterSpacing),l.addEventListener("click",this.decreaseBeforeAfterSpacing);var h=(0,a.az)("div",{className:"e-de-style-paragraph-indent-group-button"});e.appendChild(h),this.createButtonElement(h,"e-de-indent","e-de-style-icon-button-first-size").addEventListener("click",function(){t.paragraphFormat.leftIndent>=36?t.paragraphFormat.leftIndent-=36:t.paragraphFormat.leftIndent=0}),this.createButtonElement(h,"e-de-outdent","e-de-style-icon-button-size").addEventListener("click",function(){t.paragraphFormat.leftIndent+=36})},s.prototype.createButtonElement=function(e,t,i,n){var r=(0,a.az)("button",{attrs:{type:"button"}});return(0,a.le)(n)||(r.id=n),e.appendChild(r),new M.zx({iconCss:t,cssClass:i}).appendTo(r),r},s.prototype.toggleDisable=function(){this.styleType.value===this.localObj.getConstant("Character")?(this.styleParagraph.enabled=!1,this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex;pointer-events:none;opacity:0.5")):(this.styleParagraph.enabled=!0,this.target.getElementsByClassName("e-style-paragraph").item(0).removeAttribute("style"),this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex")),this.styleBasedOn.enabled=!0},s.prototype.show=function(e,t){var i=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);this.isEdit=!(0,a.le)(e)&&e.length>0,this.editStyleName=e,this.abstractList=new et;var n=this.documentHelper.styles.findByName(e);this.style=this.isEdit?n||this.getStyle(e):new Xe,i.setLocale(this.documentHelper.owner.locale),this.target||this.initStyleDialog(i,this.documentHelper.owner.enableRtl),this.isEdit||(this.styleType.value="Paragraph"),(0,a.le)(t)&&(t=i.getConstant("Create New Style")),this.documentHelper.dialog2.header=t,this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.buttons=[{click:this.onOkButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-style-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-style-cancel"}}],this.toggleDisable(),this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.beforeOpen=this.loadStyleDialog,this.documentHelper.dialog2.close=this.closeStyleDialog,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.show()},s.prototype.updateList=function(){var e=this.style.paragraphFormat.listFormat.listId;e>-1&&(0===this.documentHelper.lists.filter(function(t){return t.listId===e}).length||(this.documentHelper.lists=this.documentHelper.lists.filter(function(t){return t.listId!==e})),this.documentHelper.lists.push(this.style.paragraphFormat.listFormat.list)),-1!==this.abstractList.abstractListId&&this.documentHelper.abstractLists.push(this.abstractList)},s.prototype.createLinkStyle=function(e,t){var i;return(i=t?this.documentHelper.styles.findByName(e+" Char","Character"):new gt).type="Character",i.name=e+" Char",i.characterFormat=this.style.characterFormat.cloneFormat(),i.basedOn=this.style.basedOn,t||this.documentHelper.styles.push(i),this.documentHelper.styles.findByName(i.name,"Character")},s.prototype.updateCharacterFormat=function(e){(0,a.le)(e)||(this.characterFormat=e),this.fontFamily.value=this.characterFormat.fontFamily,this.fontSize.value=this.characterFormat.fontSize;var t=this.characterFormat.fontColor;this.fontColor.value="empty"===t||"#00000000"===t?"#000000":t,this.fontButtonClicked()},s.prototype.updateParagraphFormat=function(e){(0,a.le)(e)||(this.paragraphFormat=e),"Left"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")||this.leftAlign.classList.add("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Right"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")||this.rightAlign.classList.add("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Center"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")||this.centerAlign.classList.add("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Justify"===this.paragraphFormat.textAlignment&&(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")||this.justify.classList.add("e-active")),1===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.add("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")):1.5===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.add("e-active"),this.doubleLineSpacing.classList.remove("e-active")):2===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.add("e-active")):(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active"))},s.prototype.enableOrDisableOkButton=function(){(0,a.le)(this.okButton)||(this.okButton.disabled=""===this.styleNameElement.value)},s.prototype.getTypeValue=function(){return"Linked Style"===this.styleType.value||"Paragraph"===this.styleType.value?"Paragraph":"Character"},s.prototype.updateStyleNames=function(e,t){var i=this.documentHelper.styles.getStyleNames(e);if(this.styleParagraph.dataSource=i,this.styleParagraph.index=null,t){this.styleBasedOn.dataSource=i.filter(function(d){return d!==t}),this.styleBasedOn.index=null;var n=this.getStyle(t);if(n.basedOn instanceof String||(0,a.le)(n.basedOn)?this.styleBasedOn.enabled=!1:this.styleBasedOn.index=i.indexOf(n.basedOn.name)>-1?i.indexOf(n.basedOn.name):0,this.styleType.index="Paragraph"===n.type?(0,a.le)(n.link)?0:2:1,!(0,a.le)(n.next)){var r=n.next.name,o=0;i.indexOf(r)>-1&&(o=i.indexOf(r)),this.styleParagraph.index=o,this.isUserNextParaUpdated=r!==t}}else{this.styleBasedOn.dataSource=i,this.styleBasedOn.index=null;var l=0;this.documentHelper.owner.selectionModule&&(l=i.indexOf("Character"===e?this.documentHelper.owner.selection.characterFormat.styleName:this.documentHelper.owner.selection.paragraphFormat.styleName)),this.styleBasedOn.index=l,this.styleParagraph.index=0}this.styleType.enabled=!this.isEdit,this.styleBasedOn.dataBind(),this.styleParagraph.dataBind()},s.prototype.getStyle=function(e){return(0,a.le)(this.documentHelper.styles.findByName(e))&&this.documentHelper.owner.editor.createStyle(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles.findByName(e)},s.prototype.destroy=function(){if(this.documentHelper=void 0,!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.fontColor&&(this.fontColor.destroy(),this.fontColor=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.styleType&&(this.styleType.destroy(),this.styleType=void 0),this.styleBasedOn&&(this.styleBasedOn.destroy(),this.styleBasedOn=void 0),this.styleParagraph&&(this.styleParagraph.destroy(),this.styleParagraph=void 0),this.onlyThisDocument&&this.onlyThisDocument.destroy(),this.onlyThisDocument=void 0,this.template&&(this.template.destroy(),this.template=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.numberingBulletDialog&&(this.numberingBulletDialog.destroy(),this.numberingBulletDialog=void 0),this.styleDropdwn&&(this.styleDropdwn.destroy(),this.styleDropdwn=void 0)},s}(),_i=function(){function s(e){var t=this;this.isBullet=!1,this.numberListClick=function(i){t.isBullet=!1,t.setActiveElement(i),i.currentTarget.classList.contains("e-de-list-numbered-none")?(t.numberFormat=void 0,t.listLevelPattern=void 0):i.currentTarget.classList.contains("e-de-list-numbered-number-dot")?(t.numberFormat="%1.",t.listLevelPattern="Arabic"):i.currentTarget.classList.contains("e-de-list-numbered-number-brace")?(t.numberFormat="%1)",t.listLevelPattern="Arabic"):i.currentTarget.classList.contains("e-de-list-numbered-up-roman")?(t.numberFormat="%1.",t.listLevelPattern="UpRoman"):i.currentTarget.classList.contains("e-de-list-numbered-up-letter")?(t.numberFormat="%1.",t.listLevelPattern="UpLetter"):i.currentTarget.classList.contains("e-de-list-numbered-low-letter-brace")?(t.numberFormat="%1)",t.listLevelPattern="LowLetter"):i.currentTarget.classList.contains("e-de-numbered-low-letter-dot")?(t.numberFormat="%1.",t.listLevelPattern="LowLetter"):i.currentTarget.classList.contains("e-de-list-numbered-low-roman")&&(t.numberFormat="%1.",t.listLevelPattern="LowRoman")},this.bulletListClick=function(i){t.isBullet=!0,t.setActiveElement(i),i.currentTarget.classList.contains("e-bullet-none")?(t.symbol=void 0,t.fontFamily=void 0):i.currentTarget.classList.contains("e-bullet-dot")?(t.symbol=String.fromCharCode(61623),t.fontFamily="Symbol"):i.currentTarget.classList.contains("e-bullet-circle")?(t.symbol=String.fromCharCode(61551)+String.fromCharCode(32),t.fontFamily="Symbol"):i.currentTarget.classList.contains("e-bullet-square")?(t.symbol=String.fromCharCode(61607),t.fontFamily="Wingdings"):i.currentTarget.classList.contains("e-bullet-flower")?(t.symbol=String.fromCharCode(61558),t.fontFamily="Wingdings"):i.currentTarget.classList.contains("e-bullet-arrow")?(t.symbol=String.fromCharCode(61656),t.fontFamily="Wingdings"):i.currentTarget.classList.contains("e-bullet-tick")&&(t.symbol=String.fromCharCode(61692),t.fontFamily="Wingdings")},this.loadNumberingBulletDialog=function(){t.documentHelper.updateFocus()},this.closeNumberingBulletDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.isBullet=!1,t.listLevelPattern=void 0,t.numberFormat=void 0,t.symbol=void 0,t.fontFamily=void 0,t.documentHelper.dialog.hide(),t.unWireEventsAndBindings()},this.onOkButtonClick=function(){t.documentHelper.owner.documentHelper.lists.length>0?(t.listFormat.list.listId=t.documentHelper.owner.documentHelper.lists[t.documentHelper.owner.documentHelper.lists.length-1].listId+1,t.listFormat.listId=t.listFormat.list.listId):(t.listFormat.list.listId=0,t.listFormat.listId=0),t.abstractList.abstractListId=t.documentHelper.owner.documentHelper.abstractLists.length>0?t.documentHelper.owner.documentHelper.abstractLists[t.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1:0,t.listFormat.list.abstractListId=t.abstractList.abstractListId;var i=new nt(t.abstractList);i.listLevelPattern=(0,a.le)(t.listLevelPattern)?"Bullet":t.listLevelPattern,i.numberFormat=t.isBullet?t.symbol:t.numberFormat,"Bullet"!==i.listLevelPattern&&(i.startAt=1),i.characterFormat.fontFamily=(0,a.le)(t.fontFamily)?"Verdana":t.fontFamily,i.paragraphFormat.leftIndent=36,i.paragraphFormat.firstLineIndent=-18,t.abstractList.levels.push(i),t.listFormat.listLevelNumber=0,t.listFormat.list.abstractList=t.abstractList,t.documentHelper.hideDialog()},this.documentHelper=e}return s.prototype.getModuleName=function(){return"BulletsAndNumberingDialog"},s.prototype.initNumberingBulletDialog=function(e){var t=this.documentHelper.owner.containerId;this.target=(0,a.az)("div",{id:t+"_insertNumberBulletDialog",className:"e-de-number-bullet-dlg"});var i=(0,a.az)("div",{id:t+"_tabNumberBulletDialog",className:"e-de-tab-number-bullet-dlg"});this.target.appendChild(i),this.createNumberList(t,e),this.createBulletList(t,e),this.tabObj=new tt.OK({items:[{header:{text:(0,a.az)("div",{innerHTML:e.getConstant("Numbering")})},content:this.numberListDiv},{header:{text:(0,a.az)("div",{innerHTML:e.getConstant("Bullets")})},content:this.bulletListDiv}],heightAdjustMode:"None",width:"auto",selecting:this.onTabSelect.bind(this)}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(i)},s.prototype.onTabSelect=function(e){1===e.selectingIndex&&(this.bulletListDiv.style.display="block")},s.prototype.createNumberList=function(e,t){this.numberListDiv=(0,a.az)("div",{className:"e-de-style-numbered-list",id:e+"_Number"});var i=this.numberListDiv,n=(0,a.az)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});i.appendChild(n);var r=this.createNumberNoneListTag(n,t),o=this.createNumberListTag(n,"1.","2.","3.","e-de-list-numbered-number-dot"),l=this.createNumberListTag(n,"1)","2)","3)","e-de-list-numbered-number-brace"),h=this.createNumberListTag(n,"I.","II.","III.","e-de-list-numbered-up-roman"),d=this.createNumberListTag(n,"A.","B.","C.","e-de-list-numbered-up-letter"),c=this.createNumberListTag(n,"a.","b.","c.","e-de-numbered-low-letter-dot"),u=this.createNumberListTag(n,"a)","b)","c)","e-de-list-numbered-low-letter-brace"),p=this.createNumberListTag(n,"i.","ii.","iii.","e-de-list-numbered-low-roman");r.addEventListener("click",this.numberListClick),o.addEventListener("click",this.numberListClick),l.addEventListener("click",this.numberListClick),h.addEventListener("click",this.numberListClick),d.addEventListener("click",this.numberListClick),u.addEventListener("click",this.numberListClick),c.addEventListener("click",this.numberListClick),p.addEventListener("click",this.numberListClick),this.target.appendChild(i)},s.prototype.createNumberListTag=function(e,t,i,n,r){var o=(0,a.az)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size "+r});e.appendChild(o);var l="<div>"+t+'<span class="e-de-ui-list-line"></span></div><div>'+i+'<span class="e-de-ui-list-line">',h=(0,a.az)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:l+="</span></div><div>"+n+'<span class="e-de-ui-list-line"> </span></div >'});return o.style.cssFloat="left",o.appendChild(h),o},s.prototype.createNumberNoneListTag=function(e,t){var i=(0,a.az)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none"});e.appendChild(i);var n='<div class="e-de-ui-bullets e-de-bullet-icons">'+t.getConstant("None")+"</div>",r=(0,a.az)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:n});return i.style.cssFloat="left",i.appendChild(r),i},s.prototype.createBulletListTag=function(e,t,i,n){var r=(0,a.az)("li",{styles:"display:block;",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size "+i});e.appendChild(r);var o="e-bullet-none"===i,l=(0,a.az)("div",{className:"e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size",styles:o?"font-size:9px;text-align: center;top: 13px;left:-2px;line-height:normal;position: relative":""}),h=(0,a.az)("div",{className:o?"":t,innerHTML:o?n.getConstant("None"):""});return l.appendChild(h),r.appendChild(l),r},s.prototype.createBulletList=function(e,t){this.bulletListDiv=(0,a.az)("div",{className:"e-de-ui-bullet-list-header-presetmenu",id:e+"_Bullet"});var i=this.bulletListDiv;i.style.display="none";var n=(0,a.az)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});i.appendChild(n);var r=this.createBulletListTag(n,"e-de-icon-bullet-list-none e-de-bullet-icons","e-bullet-none",t),o=this.createBulletListTag(n,"e-de-icon-bullet-list-dot e-de-bullet-icons","e-bullet-dot"),l=this.createBulletListTag(n,"e-de-icon-bullet-list-circle e-de-bullet-icons","e-bullet-circle"),h=this.createBulletListTag(n,"e-de-icon-bullet-list-square e-de-bullet-icons","e-bullet-square"),d=this.createBulletListTag(n,"e-de-icon-bullet-list-flower e-de-bullet-icons","e-bullet-flower"),c=this.createBulletListTag(n,"e-de-icon-bullet-list-arrow e-de-bullet-icons","e-bullet-arrow"),u=this.createBulletListTag(n,"e-de-icon-bullet-list-tick e-de-bullet-icons","e-bullet-tick");r.addEventListener("click",this.bulletListClick),o.addEventListener("click",this.bulletListClick),l.addEventListener("click",this.bulletListClick),h.addEventListener("click",this.bulletListClick),d.addEventListener("click",this.bulletListClick),c.addEventListener("click",this.bulletListClick),u.addEventListener("click",this.bulletListClick),this.target.appendChild(i)},s.prototype.showNumberBulletDialog=function(e,t){this.listFormat=(0,a.le)(e)?new bt:e,(0,a.le)(this.listFormat.list)&&(this.listFormat.list=new ft),this.abstractList=(0,a.le)(t)?new et:t;var i=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.target||this.initNumberingBulletDialog(i),this.documentHelper.dialog.header=i.getConstant("Numbering and Bullets"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadNumberingBulletDialog,this.documentHelper.dialog.close=this.closeNumberingBulletDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.buttons=[{click:this.onOkButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-numbering-bullet-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-numbering-bullet-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.tabObj.refresh()},s.prototype.setActiveElement=function(e){for(var t=e.currentTarget.parentElement,i=0;i<t.childElementCount;i++)t.childNodes[i].classList.contains("e-de-list-active")&&t.childNodes[i].classList.remove("e-de-list-active");e.currentTarget.classList.add("e-de-list-active")},s.prototype.unWireEventsAndBindings=function(){},s.prototype.destroy=function(){if(this.documentHelper=void 0,this.listFormat&&(this.listFormat.destroy(),this.listFormat=void 0),this.tabObj&&(this.tabObj.destroy(),this.tabObj=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.target&&this.target.parentElement){this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.bulletListDiv=void 0,this.numberListDiv=void 0},s}(),wr=function(){function s(e){var t=this;this.fontStyleInternal=void 0,this.fontNameList=void 0,this.fontStyleText=void 0,this.fontSizeText=void 0,this.colorPicker=void 0,this.underlineDrop=void 0,this.strikethroughBox=void 0,this.doublestrikethrough=void 0,this.superscript=void 0,this.subscript=void 0,this.allcaps=void 0,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.allCaps=void 0,this.isListDialog=!1,this.characterFormat=void 0,this.loadFontDialog=function(){var i;if(t.documentHelper.updateFocus(),t.fontNameList.value=(i=t.characterFormat?t.characterFormat:t.documentHelper.owner.selection.characterFormat).fontFamily,t.fontNameList.dataBind(),i.bold||i.italic?i.bold&&!i.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=1):!i.bold&&i.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=2):i.bold&&i.italic&&(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=3):(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=0),(0,a.le)(i.fontSize)||(t.fontSizeText.value=i.fontSize),(0,a.le)(i.fontColor))t.colorPicker.value="#000000";else{var n=i.fontColor;("empty"===n||"#00000000"===n)&&(n="#000000"),t.colorPicker.value=n}"None"===i.underline?t.underlineDrop.index=0:"Single"===i.underline&&(t.underlineDrop.index=1),"SingleStrike"===i.strikethrough?t.strikethroughBox.checked=!0:"DoubleStrike"===i.strikethrough?t.doublestrikethrough.checked=!0:(t.strikethroughBox.checked=!1,t.doublestrikethrough.checked=!1),"Superscript"===i.baselineAlignment?t.superscript.checked=!0:"Subscript"===i.baselineAlignment?t.subscript.checked=!0:(t.superscript.checked=!1,t.subscript.checked=!1),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),i.allCaps?t.allcaps.checked=!0:(t.allcaps.checked=!1,t.allCaps=!1)},this.closeFontDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onInsertFontFormat=function(){var i;i=t.characterFormat?t.characterFormat:new ie(void 0),(0,a.le)(t.bold)||(i.bold=t.bold),(0,a.le)(t.italic)||(i.italic=t.italic),!(0,a.le)(t.fontSize)&&t.fontSize>0&&(i.fontSize=t.fontSize),(0,a.le)(t.fontColor)||(i.fontColor=t.fontColor),(0,a.le)(t.baselineAlignment)||(i.baselineAlignment=t.baselineAlignment),(0,a.le)(t.strikethrough)||(i.strikethrough=t.strikethrough),(0,a.le)(t.underline)||(i.underline=t.underline),(0,a.le)(t.fontFamily)||(i.fontFamily=t.fontFamily),(0,a.le)(t.allCaps)||(i.allCaps=t.allCaps),t.characterFormat?t.isListDialog?t.documentHelper.owner.listDialogModule.updateCharacterFormat(i):t.documentHelper.owner.styleDialogModule.updateCharacterFormat():t.onCharacterFormat(t.documentHelper.selection,i),t.documentHelper.hideDialog()},this.fontSizeUpdate=function(i){t.fontSize=i.value},this.fontStyleUpdate=function(i){t.fontStyle=i.value},this.fontFamilyUpdate=function(i){t.fontFamily=i.value},this.underlineUpdate=function(i){t.underline=i.value},this.fontColorUpdate=function(i){(0,a.le)(i.currentValue)||(t.fontColor=i.currentValue.hex)},this.singleStrikeUpdate=function(i){t.enableCheckBoxProperty(i),t.strikethrough=i.checked?"SingleStrike":"None"},this.doubleStrikeUpdate=function(i){t.enableCheckBoxProperty(i),t.strikethrough=i.checked?"DoubleStrike":"None"},this.superscriptUpdate=function(i){t.enableCheckBoxProperty(i),t.baselineAlignment=i.checked?"Superscript":"Normal"},this.subscriptUpdate=function(i){t.enableCheckBoxProperty(i),t.baselineAlignment=i.checked?"Subscript":"Normal"},this.allcapsUpdate=function(i){t.enableCheckBoxProperty(i),t.allCaps=!!i.checked},this.documentHelper=e}return Object.defineProperty(s.prototype,"fontStyle",{get:function(){return this.fontStyleInternal},set:function(e){switch(this.fontStyleInternal=e,this.fontStyle){case"Bold":this.bold=!0,this.italic=!1;break;case"Italic":this.bold=!1,this.italic=!0;break;case"BoldItalic":this.bold=!0,this.italic=!0;break;case"Regular":this.bold=!1,this.italic=!1}},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"FontDialog"},s.prototype.createInputElement=function(e,t,i){return(0,a.az)("input",{attrs:{type:e},id:t,className:i})},s.prototype.initFontDialog=function(e,t){var i,n,r,o,l,h,d;this.target=(0,a.az)("div",{className:"e-de-font-dlg"});var u=this.getFontDiv(e,t);this.target.appendChild(u);var p=this.getFontSizeDiv(e,t);this.target.appendChild(p);var f=(0,a.az)("div",{className:"e-de-container-row"});this.fontColorDiv=(0,a.az)("div",{className:"e-de-font-dlg-display"});var g=(0,a.az)("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Font color")});t&&g.classList.add("e-de-rtl"),this.fontColorDiv.appendChild(g);var m=this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color");this.fontColorDiv.appendChild(m),f.appendChild(this.fontColorDiv),this.target.appendChild(f);var v=(0,a.az)("div");d=(0,a.az)("div"),i=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Effects")}),d.appendChild(i),v.appendChild(d),this.target.appendChild(v);var y=(0,a.az)("div",{className:"e-de-container-row"}),b=(0,a.az)("div",{className:"e-de-subcontainer-left"});n=this.createInputElement("checkbox",this.target.id+"_strikeThrough",""),b.appendChild(n);var C=(0,a.az)("div",{className:"e-de-font-checkbox"});o=this.createInputElement("checkbox",this.target.id+"_subScript",""),C.appendChild(o),b.appendChild(C),C=(0,a.az)("div",{className:"e-de-font-checkbox"}),h=this.createInputElement("checkbox",this.target.id+"_allCaps",""),C.appendChild(h),b.appendChild(C),y.appendChild(b);var F=(0,a.az)("div",{className:"e-de-subcontainer-right"});r=this.createInputElement("checkbox",this.target.id+"_superScript",""),F.appendChild(r),C=(0,a.az)("div",{className:"e-de-font-checkbox"}),l=this.createInputElement("checkbox",this.target.id+"_doubleStrikeThrough",""),C.appendChild(l),F.appendChild(C),y.appendChild(F),this.target.appendChild(y),this.colorPicker=new J.zH({change:this.fontColorUpdate,value:"#000000",enableRtl:t,locale:this.documentHelper.owner.locale}),this.colorPicker.appendTo(m),this.strikethroughBox=new M.Jg({change:this.singleStrikeUpdate,cssClass:"e-de-font-content-label",label:e.getConstant("Strikethrough"),enableRtl:t}),this.strikethroughBox.appendTo(n),this.doublestrikethrough=new M.Jg({change:this.doubleStrikeUpdate,label:e.getConstant("Double strikethrough"),enableRtl:t}),this.doublestrikethrough.appendTo(l),this.subscript=new M.Jg({label:e.getConstant("Subscript"),cssClass:"e-de-font-content-label-width",change:this.subscriptUpdate,enableRtl:t}),this.subscript.appendTo(o),this.superscript=new M.Jg({label:e.getConstant("Superscript"),cssClass:"e-de-font-content-label",change:this.superscriptUpdate,enableRtl:t}),this.superscript.appendTo(r),this.allcaps=new M.Jg({label:e.getConstant("All caps"),cssClass:"e-de-font-content-label-caps",change:this.allcapsUpdate,enableRtl:t}),this.allcaps.appendTo(h),t&&(b.classList.add("e-de-rtl"),F.classList.add("e-de-rtl"),d.classList.remove("e-de-font-content-checkbox-label"))},s.prototype.getFontSizeDiv=function(e,t){var i,n;n=(0,a.az)("div",{className:"e-de-container-row"});var o=(0,a.az)("div",{className:"e-de-subcontainer-left"}),l=e.getConstant("Size");(i=(0,a.az)("select",{id:this.target.id+"_fontSize"})).innerHTML="<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option><option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>",o.appendChild(i),n.appendChild(o);var h=(0,a.az)("div",{className:"e-de-subcontainer-right"});t&&h.classList.add("e-de-rtl");var c,d=e.getConstant("Underline style");return(c=(0,a.az)("select",{id:this.target.id+"_underLine"})).innerHTML='<option value="None">'+e.getConstant("None")+'</option><option value="Single">________</option>',h.appendChild(c),n.appendChild(h),this.fontSizeText=new Te.Ct({change:this.fontSizeUpdate,allowCustom:!0,showClearButton:!1,enableRtl:t,floatLabelType:"Always",placeholder:l}),this.fontSizeText.appendTo(i),this.underlineDrop=new Te.NB({change:this.underlineUpdate,enableRtl:t,floatLabelType:"Always",placeholder:d}),this.underlineDrop.appendTo(c),n},s.prototype.getFontDiv=function(e,t){for(var n=(0,a.az)("div",{className:"e-de-container-row"}),r=(0,a.az)("div",{className:"e-de-subcontainer-left"}),o=e.getConstant("Font"),l=(0,a.az)("select",{id:this.target.id+"_fontName"}),h=this.documentHelper.owner.documentEditorSettings.fontFamilies,d=0;d<h.length;d++)l.innerHTML+="<option>"+h[d]+"</option>";var c,u;r.appendChild(l),n.appendChild(r),c=(0,a.az)("div",{className:"e-de-subcontainer-right"}),t&&c.classList.add("e-de-rtl");var p=e.getConstant("Font style");return(u=(0,a.az)("select",{id:this.target.id+"_fontStyle"})).innerHTML='<option value="Regular">'+e.getConstant("Regular")+'</option><option value="Bold">'+e.getConstant("Bold")+'</option><option value="Italic">'+e.getConstant("Italic")+'</option><option value="BoldItalic">'+e.getConstant("Bold")+e.getConstant("Italic")+"</option>",c.appendChild(u),n.appendChild(c),this.fontNameList=new Te.Ct({change:this.fontFamilyUpdate,enableRtl:t,floatLabelType:"Always",placeholder:o}),this.fontNameList.showClearButton=!1,this.fontNameList.appendTo(l),this.fontStyleText=new Te.NB({change:this.fontStyleUpdate,enableRtl:t,floatLabelType:"Always",placeholder:p}),this.fontStyleText.appendTo(u),n},s.prototype.showFontDialog=function(e,t){e&&(this.characterFormat=e),this.isListDialog=t;var i=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.target||this.initFontDialog(i,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=i.getConstant("Font"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.close=this.closeFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFontFormat,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-font-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-font-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},s.prototype.onCharacterFormat=function(e,t){if(this.documentHelper.owner.editorModule.initHistory("CharacterFormat"),e.isEmpty)return e.start.offset===e.getParagraphLength(e.start.paragraph)&&(this.documentHelper.owner.editorModule.applyCharFormatValueInternal(e,e.start.paragraph.characterFormat,void 0,t),this.documentHelper.owner.editorModule.reLayout(e)),void this.documentHelper.updateFocus();this.documentHelper.owner.editorModule.setOffsetValue(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionCharacterFormatting("CharacterFormat",t,!1)},s.prototype.enableCheckBoxProperty=function(e){this.strikethroughBox.checked&&this.doublestrikethrough.checked&&(this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,e.event.currentTarget.id===this.target.id+"_doubleStrikeThrough"?this.doublestrikethrough.checked=!0:this.strikethroughBox.checked=!0),this.superscript.checked&&this.subscript.checked&&(this.subscript.checked=!1,this.superscript.checked=!1,e.event.currentTarget.id===this.target.id+"_subScript"?this.subscript.checked=!0:this.superscript.checked=!0)},s.prototype.unWireEventsAndBindings=function(){this.fontNameList.value="",this.fontSizeText.value="",this.fontStyleText.value="",this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,this.superscript.checked=!1,this.subscript.checked=!1,this.allcaps.checked=!1,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0},s.prototype.destroy=function(){if(this.documentHelper=void 0,this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.fontNameList&&this.fontNameList.destroy(),this.fontNameList=void 0,this.fontStyleText&&this.fontStyleText.destroy(),this.fontStyleText=void 0,this.fontSizeText&&this.fontSizeText.destroy(),this.fontSizeText=void 0,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.underlineDrop&&this.underlineDrop.destroy(),this.underlineDrop=void 0,this.strikethroughBox&&this.strikethroughBox.destroy(),this.strikethroughBox=void 0,this.doublestrikethrough&&this.doublestrikethrough.destroy(),this.doublestrikethrough=void 0,this.superscript&&this.superscript.destroy(),this.superscript=void 0,this.subscript&&this.subscript.destroy(),this.subscript=void 0,this.allcaps&&this.allcaps.destroy(),this.allcaps=void 0},s}(),Cr=function(){function s(e){var t=this;this.hasTableWidth=!1,this.hasCellWidth=!1,this.bidi=!1,this.isTableBordersAndShadingUpdated=!1,this.isCellBordersAndShadingUpdated=!1,this.tabObj=void 0,this.localValue=void 0,this.isCellOptionsUpdated=!1,this.isTableOptionsUpdated=!1,this.onBeforeOpen=function(){t.documentHelper.updateFocus(),t.loadTableProperties()},this.onCloseTablePropertyDialog=function(){t.unWireEvent.bind(t),t.documentHelper.updateFocus()},this.applyTableProperties=function(){var i=t.documentHelper.selection;if(!t.preferCheckBox.checked&&!t.preferCheckBox.indeterminate&&((0,a.le)(i.tableFormat.preferredWidth)||0!==i.tableFormat.preferredWidth)&&(t.tableFormat.preferredWidth=0,t.tableFormat.preferredWidthType="Point"),t.tableFormat.hasValue("tableAlignment")&&"Left"!==t.tableFormat.tableAlignment&&((0,a.le)(i.tableFormat.leftIndent)||0!==i.tableFormat.leftIndent)&&(t.tableFormat.leftIndent=0),!t.rowHeightCheckBox.checked&&!t.rowHeightCheckBox.indeterminate&&((0,a.le)(i.rowFormat.height)||0!==i.rowFormat.height)&&(t.rowFormat.heightType="AtLeast",t.rowFormat.height=0),t.preferredCellWidthCheckBox.checked||t.preferredCellWidthCheckBox.indeterminate){for(var n=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable,r=n.getOwnerWidth(!0),o=n.getTableClientWidth(r),l=0;l<n.childWidgets.length;l++)for(var h=n.childWidgets[l],d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d];"Percent"===t.cellFormat.preferredWidthType&&"Point"===c.cellFormat.preferredWidthType?(c.cellFormat.preferredWidthType="Percent",c.cellFormat.preferredWidth=c.cellFormat.preferredWidth/o*100):"Point"===t.cellFormat.preferredWidthType&&"Percent"===c.cellFormat.preferredWidthType&&(c.cellFormat.preferredWidthType="Point",c.cellFormat.preferredWidth=c.cellFormat.cellWidth)}if("Percent"===t.cellFormat.preferredWidthType&&!t.tableFormat.hasValue("preferredWidth")&&!t.tableFormat.hasValue("preferredWidthType")&&0===t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth){var u=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(!0),p=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(u);t.tableFormat.preferredWidthType="Percent",t.tableFormat.preferredWidth=p/w.convertPixelToPoint(t.documentHelper.owner.viewer.clientArea.width)*100}}else((0,a.le)(i.cellFormat.preferredWidth)||0!==i.cellFormat.preferredWidth)&&(t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=0);t.rowHeightValue&&(!t.rowFormat.hasValue("heightType")&&i.rowFormat.heightType!==t.rowFormat.heightType&&(t.rowFormat.heightType=i.rowFormat.heightType),t.rowFormat.height=t.rowHeightValue),t.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),t.documentHelper.owner.editorModule.onTableFormat(t.tableFormat),t.documentHelper.owner.editorModule.onRowFormat(t.rowFormat),t.documentHelper.owner.editorModule.onCellFormat(t.cellFormat),t.documentHelper.owner.editorHistory.updateComplexHistory(),t.closeTablePropertiesDialog(),t.documentHelper.updateFocus()},this.applyTableSubProperties=function(){t.isCellOptionsUpdated&&t.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(t.documentHelper.owner.cellOptionsDialogModule.cellFormat),t.isTableOptionsUpdated&&t.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(t.documentHelper.owner.tableOptionsDialogModule.tableFormat),t.isCellOptionsUpdated=!1,t.isTableOptionsUpdated=!1},this.unWireEvent=function(){t.preferCheckBox.change=void 0,t.tableWidthBox.change=void 0,t.tableWidthType.change=void 0,t.leftIndentBox.change=void 0,t.rowHeightCheckBox.change=void 0,t.rowHeightBox.change=void 0,t.rowHeightType.change=void 0,t.repeatHeader.change=void 0,t.allowRowBreak.change=void 0,t.preferredCellWidthCheckBox.change=void 0,t.cellWidthBox.change=void 0,t.cellWidthType.change=void 0,t.cellFormat.destroy(),t.rowFormat.destroy(),t.tableFormat.destroy(),t.rowHeightValue=void 0,t.documentHelper.dialog2.open=t.documentHelper.selection.hideCaret.bind(t.documentHelper.owner.viewer)},this.closeTablePropertiesDialog=function(){t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.changeBidirectional=function(i){"ltr"===i.value?(t.rtlButton.checked=!t.ltrButton.checked,t.tableFormat.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.tableFormat.bidi=!0),t.tableFormat.bidi&&"Left"===t.tableFormat.tableAlignment?t.tableFormat.tableAlignment="Right":!t.tableFormat.bidi&&"Right"===t.tableFormat.tableAlignment&&(t.tableFormat.tableAlignment="Left"),t.activeTableAlignment(t.tableFormat,!0)},this.changeTableCheckBox=function(){var i=t.preferCheckBox.checked||t.preferCheckBox.indeterminate;t.tableWidthBox.enabled=i,t.tableWidthType.enabled=i,t.tableFormat.preferredWidthType=i?"Points"===t.tableWidthType.value?"Point":t.tableWidthType.value:t.documentHelper.selection.tableFormat.preferredWidthType},this.changeTableAlignment=function(i){t.updateClassForAlignmentProperties(t.tableTab);var n=i.target;(0,a.s1)(n,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]);var r=t.tableFormat.bidi||t.rtlButton.checked;t.leftIndentBox.enabled=!!(n.classList.contains("e-de-table-left-alignment")&&!r||n.classList.contains("e-de-table-right-alignment")&&r),t.tableFormat.tableAlignment=t.getTableAlignment()},this.changeTableRowCheckBox=function(){t.rowHeightType.enabled=t.rowHeightCheckBox.checked,t.rowHeightBox.enabled=t.rowHeightCheckBox.checked,t.rowFormat.heightType=t.rowHeightType.enabled?t.rowHeightType.value:t.documentHelper.selection.rowFormat.heightType},this.changeTableCellCheckBox=function(){t.cellWidthType.enabled=t.preferredCellWidthCheckBox.checked,t.cellWidthBox.enabled=t.preferredCellWidthCheckBox.checked},this.changeCellAlignment=function(i){t.updateClassForCellAlignment(t.cellTab),(0,a.s1)(i.target,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]),t.cellFormat.verticalAlignment=t.getCellAlignment()},this.showTableOptionsDialog=function(){t.documentHelper.owner.tableOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showBordersShadingsPropertiesDialog=function(){t.documentHelper.owner.bordersAndShadingDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showCellOptionsDialog=function(){t.documentHelper.owner.cellOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.documentHelper=e}return Object.defineProperty(s.prototype,"cellFormat",{get:function(){return(0,a.le)(this.cellFormatIn)?this.cellFormatIn=new it:this.cellFormatIn},set:function(e){this.cellFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tableFormat",{get:function(){return(0,a.le)(this.tableFormatIn)?(this.tableFormatIn=new Oe,this.tableFormatIn):this.tableFormatIn},set:function(e){this.tableFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"paraFormat",{get:function(){return(0,a.le)(this.tableFormatIn)?(this.paraFormatIn=new ue,this.paraFormatIn):this.paraFormatIn},set:function(e){this.paraFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rowFormat",{get:function(){return(0,a.le)(this.rowFormatInternal)?(this.rowFormatInternal=new De,this.rowFormatInternal):this.rowFormatInternal},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"TablePropertiesDialog"},s.prototype.initTablePropertyDialog=function(e,t){this.localValue=e,this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_TablePropertiesDialog",className:"e-de-table-properties-dlg"});var n=(0,a.az)("div",{id:this.target.id+"_TabContainer"});this.target.appendChild(n),this.tableTab=(0,a.az)("div",{id:this.target.id+"_TablePropertiesContentDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.rowTab=(0,a.az)("div",{id:this.target.id+"_RowPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.cellTab=(0,a.az)("div",{id:this.target.id+"_CellPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"});var r=(0,a.az)("div",{className:"e-de-table-dialog-separator-line"}),o=(0,a.az)("div",{id:this.target.id+"_TablePropertiesDialogTab",className:"e-de-table-ppty-tab"}),l=(0,a.az)("div",{className:"e-tab-header"}),h=(0,a.az)("div",{id:this.target.id+"_tableHeader",innerHTML:e.getConstant("Table")}),d=(0,a.az)("div",{id:this.target.id+"_rowHeader",innerHTML:e.getConstant("Row")}),c=(0,a.az)("div",{id:this.target.id+"_cellHeader",innerHTML:e.getConstant("Cell")});l.appendChild(h),l.appendChild(d),l.appendChild(c);var u=(0,a.az)("div",{id:this.target.id+"_tableContent"}),p=(0,a.az)("div",{id:this.target.id+"_rowContent"}),f=(0,a.az)("div",{id:this.target.id+"_cellContent"}),g=[{header:{text:h},content:u},{header:{text:d},content:p},{header:{text:c},content:f}];u.appendChild(this.tableTab),p.appendChild(this.rowTab),f.appendChild(this.cellTab),n.appendChild(o),this.initTableProperties(this.tableTab,e,this.documentHelper.owner.enableRtl),this.initTableRowProperties(this.rowTab,e,this.documentHelper.owner.enableRtl),this.initTableCellProperties(this.cellTab,e,this.documentHelper.owner.enableRtl),this.tabObj=new tt.OK({items:g,enableRtl:t},o),this.tabObj.isStringTemplate=!0,this.target.appendChild(r);for(var m=this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment"),v=0;v<m.length;v++)m[v].addEventListener("click",this.changeTableAlignment);var y=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment");for(v=0;v<y.length;v++)y[v].addEventListener("click",this.changeCellAlignment)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTablePropertyDialog(e,this.documentHelper.owner.enableRtl),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog2.header=e.getConstant("Table Properties"),this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.animationSettings={effect:"None",duration:400,delay:0},this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.beforeOpen=this.onBeforeOpen,this.documentHelper.dialog2.close=this.onCloseTablePropertyDialog,this.documentHelper.dialog2.open=this.wireEvent.bind(this),this.documentHelper.dialog2.buttons=[{click:this.applyTableProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ppty-okay",isPrimary:!0}},{click:this.closeTablePropertiesDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-ppty-cancel"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show();var t=this.documentHelper.dialog2.element;t&&this.documentHelper.updateDialogTabHeight(t,this.target)},s.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},s.prototype.loadTableProperties=function(){this.setTableProperties(),this.setTableRowProperties(),this.setTableCellProperties(),this.bordersAndShadingButton.disabled=!this.documentHelper.owner.bordersAndShadingDialogModule,this.tableOptionButton.disabled=!1,this.cellOptionButton.disabled=!1},s.prototype.wireEvent=function(){this.documentHelper.selection.hideCaret(),this.preferCheckBox.change=this.changeTableCheckBox.bind(this),this.tableWidthBox.change=this.onTableWidthChange.bind(this),this.tableWidthType.change=this.onTableWidthTypeChange.bind(this),this.leftIndentBox.change=this.onLeftIndentChange.bind(this),this.rowHeightCheckBox.change=this.changeTableRowCheckBox.bind(this),this.rowHeightBox.change=this.onRowHeightChange.bind(this),this.rowHeightType.change=this.onRowHeightTypeChange.bind(this),this.allowRowBreak.change=this.onAllowBreakAcrossPage.bind(this),this.repeatHeader.change=this.onRepeatHeader.bind(this),this.preferredCellWidthCheckBox.change=this.changeTableCellCheckBox.bind(this),this.cellWidthBox.change=this.onCellWidthChange.bind(this),this.cellWidthType.change=this.onCellWidthTypeChange.bind(this)},s.prototype.initTableProperties=function(e,t,i){var n=(0,a.az)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.az)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.az)("div",{className:"e-de-table-ppty-options-break"}),l=(0,a.az)("input",{attrs:{type:"checkbox"}}),h=(0,a.az)("div",{className:"e-de-container-row"}),d=(0,a.az)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredWidth=(0,a.az)("input");var c=(0,a.az)("div",{className:"e-de-subcontainer-right"}),u=(0,a.az)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"}),p=(0,a.az)("div",{className:"e-de-dlg-row"}),f=(0,a.az)("div",{className:"e-de-subcontainer-left"}),g=(0,a.az)("div",{innerHTML:t.getConstant("Alignment"),className:"e-de-table-dlg-alignment-heading"}),m=(0,a.az)("div",{className:"e-de-container-row"}),v=e.id+"e-de-table-alignment e-de-table-dialog-alignment-icon",y=(0,a.az)("div"),b=(0,a.az)("div",{className:"e-de-table-dia-align-div"});this.left=(0,a.az)("div",{className:"e-icons e-de-table-properties-alignment e-de-table-left-alignment "+v,id:e.id+"_left_alignment"}),b.appendChild(this.left);var C=(0,a.az)("div",{className:"e-de-table-dia-align-div"});this.center=(0,a.az)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-center-alignment "+v,id:e.id+"_center_alignment"}),C.appendChild(this.center),this.right=(0,a.az)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-right-alignment "+v,id:e.id+"_right_alignment"});var F=(0,a.az)("div",{className:"e-de-table-dia-align-div"});F.appendChild(this.right);var T=(0,a.az)("label",{innerHTML:t.getConstant("Left"),className:"e-de-table-dia-align-label"}),x=(0,a.az)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),P=(0,a.az)("label",{innerHTML:t.getConstant("Right"),className:"e-de-table-dia-align-label"}),E=(0,a.az)("div",{className:"e-de-subcontainer-right"});this.leftIndent=(0,a.az)("input");var L=(0,a.az)("div",{innerHTML:t.getConstant("Table direction"),className:"e-de-para-dlg-heading"}),W=(0,a.az)("div",{className:"e-de-dlg-row"}),R=(0,a.az)("div",{className:"e-de-tbl-rtl-btn-div"}),N=(0,a.az)("input");R.appendChild(N),W.appendChild(R);var B=(0,a.az)("div",{className:"e-de-tbl-ltr-btn-div"}),q=(0,a.az)("input");B.appendChild(q),W.appendChild(B),this.rtlButton=new M.EU({label:t.getConstant("Right-to-left"),value:"rtl",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.rtlButton.appendTo(N),this.ltrButton=new M.EU({label:t.getConstant("Left-to-right"),value:"ltr",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.ltrButton.appendTo(q);var A=(0,a.az)("div",{className:"e-de-tbl-dlg-border-btn"});this.bordersAndShadingButton=(0,a.az)("button",{innerHTML:t.getConstant("Borders and Shading")+"...",className:"e-control e-btn e-de-ok-button",attrs:{type:"button"}}),this.tableOptionButton=(0,a.az)("button",{className:"e-control e-btn",innerHTML:t.getConstant("Options")+"...",attrs:{type:"button"}}),this.tableOptionButton.addEventListener("click",this.showTableOptionsDialog),this.bordersAndShadingButton.addEventListener("click",this.showBordersShadingsPropertiesDialog),A.appendChild(this.bordersAndShadingButton),A.appendChild(this.tableOptionButton),E.appendChild(this.leftIndent),m.appendChild(y),f.appendChild(g),y.appendChild(b),f.appendChild(m),m.appendChild(C),m.appendChild(F),b.appendChild(T),C.appendChild(x),F.appendChild(P),p.appendChild(f),n.appendChild(r),e.appendChild(n),o.appendChild(l),n.appendChild(o),d.appendChild(this.preferredWidth),n.appendChild(h),c.appendChild(u),p.appendChild(E),h.appendChild(d),h.appendChild(c),e.appendChild(p),e.appendChild(L),e.appendChild(W),e.appendChild(A),this.tableWidthBox=new J.No({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.tableWidthBox.appendTo(this.preferredWidth),this.leftIndentBox=new J.No({value:0,decimals:2,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:t.getConstant("Indent from left")}),this.leftIndentBox.appendTo(this.leftIndent),this.preferCheckBox=new M.Jg({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferCheckBox.appendTo(l),this.tableWidthType=new Te.NB({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in")}),this.tableWidthType.appendTo(u),i&&(R.classList.add("e-de-rtl"),E.classList.add("e-de-rtl"),A.classList.add("e-de-rtl"),b.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),F.classList.add("e-de-rtl"))},s.prototype.onTableWidthChange=function(){this.tableFormat.preferredWidth=this.tableWidthBox.value},s.prototype.onTableWidthTypeChange=function(){var t=w.convertPixelToPoint(this.documentHelper.owner.viewer.clientArea.width);"Percent"===this.tableWidthType.text&&"Percent"!==this.documentHelper.selection.tableFormat.preferredWidthType?this.formatNumericTextBox(this.tableWidthBox,"Percent",this.tableWidthBox.value/t*100):"Points"===this.tableWidthType.text&&"Point"!==this.documentHelper.selection.tableFormat.preferredWidthType?this.formatNumericTextBox(this.tableWidthBox,"Point",t/100*this.tableWidthBox.value):this.formatNumericTextBox(this.tableWidthBox,"Points"===this.tableWidthType.text?"Point":this.tableWidthType.text,"#'%'"===this.tableWidthBox.format?"Points"===this.tableWidthType.text?t/100*this.tableWidthBox.value:this.tableWidthBox.value:"Percent"===this.tableWidthType.text?this.tableWidthBox.value/t*100:this.tableWidthBox.value),this.tableFormat.preferredWidthType="Points"===this.tableWidthType.text?"Point":this.tableWidthType.text},s.prototype.onLeftIndentChange=function(){this.tableFormat.leftIndent=this.leftIndentBox.value},s.prototype.setTableProperties=function(){var e=this.documentHelper.selection.tableFormat,t=e.preferredWidth>0,i=e.preferredWidth;(0,a.le)(e.preferredWidth)?(this.preferCheckBox.indeterminate=!0,i=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.documentHelper.owner.viewer).tableFormat.preferredWidth):this.preferCheckBox.checked=t,this.tableWidthBox.enabled=t,this.tableWidthType.enabled=t,this.formatNumericTextBox(this.tableWidthBox,e.preferredWidthType,i),this.tableWidthType.index="Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?0:1,this.activeTableAlignment(e,!1),e.bidi?(this.rtlButton.checked=!0,this.ltrButton.checked=!1):(this.ltrButton.checked=!0,this.rtlButton.checked=!1)},s.prototype.activeTableAlignment=function(e,t){var i=t?this.tableFormat.tableAlignment:void 0;(0,a.le)(i)&&(e.bidi?"Left"===e.tableAlignment?i="Right":"Right"===e.tableAlignment&&(i="Left"):i=e.tableAlignment),e.bidi?(this.leftIndentBox.enabled="Right"===i,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from right")):(this.leftIndentBox.enabled="Left"===i,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from left")),this.leftIndentBox.value=e.leftIndent,(0,a.s1)(this.left,[],["e-de-table-alignment-active"]),(0,a.s1)(this.right,[],["e-de-table-alignment-active"]),(0,a.s1)(this.center,[],["e-de-table-alignment-active"]),"Left"===i?(0,a.s1)(this.left,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Center"===i?(0,a.s1)(this.center,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Right"===i&&(0,a.s1)(this.right,["e-de-table-alignment-active"],["e-de-table-properties-alignment"])},s.prototype.getTableAlignment=function(){for(var t=this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment"),i=0;i<t.length;i++)if(t[i].classList.contains("e-de-table-alignment-active"))return 0===i?this.ltrButton.checked?"Left":"Right":1===i?"Center":this.ltrButton.checked?"Right":"Left"},s.prototype.updateClassForAlignmentProperties=function(e){for(var i=e.getElementsByClassName(e.id+"e-de-table-alignment"),n=0;n<i.length;n++){var r=i[n];r.classList.contains("e-de-table-alignment-active")&&(0,a.s1)(r,["e-de-table-properties-alignment"],["e-de-table-alignment-active"])}},s.prototype.initTableRowProperties=function(e,t,i){var n=(0,a.az)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.az)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.az)("div",{className:"e-de-table-ppty-options-break"}),l=(0,a.az)("input",{attrs:{type:"checkbox"}}),h=(0,a.az)("div",{className:"e-de-container-row"}),d=(0,a.az)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.rowHeight=(0,a.az)("input",{attrs:{type:"text"}});var c=(0,a.az)("div",{className:"e-de-subcontainer-right"}),u=(0,a.az)("select",{innerHTML:'<option value="AtLeast">'+t.getConstant("At least")+'</option><option value="Exactly">'+t.getConstant("Exactly")+"</option>"});n.appendChild(r),e.appendChild(n),o.appendChild(l),n.appendChild(o),h.appendChild(d),n.appendChild(h),d.appendChild(this.rowHeight),c.appendChild(u),h.appendChild(c);var p=(0,a.az)("div",{innerHTML:t.getConstant("Options")+"...",className:"e-de-para-dlg-heading"}),f=(0,a.az)("div",{className:"e-de-table-ppty-options-break"}),g=(0,a.az)("div",{className:"e-de-table-ppty-options-header-row"}),m=(0,a.az)("input",{attrs:{type:"checkbox"}}),v=(0,a.az)("input",{attrs:{type:"checkbox"}});f.appendChild(m),g.appendChild(v),e.appendChild(p),e.appendChild(f),e.appendChild(g),this.rowHeightBox=new J.No({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.rowHeightBox.appendTo(this.rowHeight),this.rowHeightCheckBox=new M.Jg({label:t.getConstant("Specify height"),enableRtl:i}),this.rowHeightCheckBox.appendTo(l),this.rowHeightType=new Te.NB({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Row height is")}),this.rowHeightType.appendTo(u),this.allowRowBreak=new M.Jg({label:t.getConstant("Allow row to break across pages"),enableRtl:i}),this.allowRowBreak.appendTo(m),this.repeatHeader=new M.Jg({label:t.getConstant("Repeat as header row at the top of each page"),enableRtl:i}),this.repeatHeader.appendTo(v)},s.prototype.setTableRowProperties=function(){var e=this.documentHelper.selection.rowFormat,t=e.height>0||"Exactly"===e.heightType;t?this.rowHeightCheckBox.checked=!0:void 0===e.heightType?(this.rowHeightCheckBox.indeterminate=!0,t=!0):this.rowHeightCheckBox.checked=!1,this.rowHeightBox.enabled=t,this.rowHeightType.enabled=t;var i=!this.enableRepeatHeader();(0,a.le)(this.documentHelper.selection.rowFormat.isHeader)?(this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):this.documentHelper.selection.rowFormat.isHeader?(this.repeatHeader.checked=!i,this.repeatHeader.indeterminate=i,this.repeatHeader.disabled=i):(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!1,this.repeatHeader.disabled=i),(0,a.le)(e.allowBreakAcrossPages)?this.allowRowBreak.indeterminate=!0:this.allowRowBreak.checked=e.allowBreakAcrossPages,this.rowHeightBox.value=e.height,this.rowHeightType.index="Auto"===e.heightType||"AtLeast"===e.heightType?0:1},s.prototype.onRowHeightChange=function(){this.rowHeightValue=this.rowHeightBox.value},s.prototype.onRowHeightTypeChange=function(){this.rowFormat.heightType=this.rowHeightType.text},s.prototype.onAllowBreakAcrossPage=function(){this.rowFormat.allowBreakAcrossPages=this.allowRowBreak.checked},s.prototype.onRepeatHeader=function(){this.rowFormat.isHeader=this.repeatHeader.checked},s.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var n=t.paragraph.associatedCell;return 0===n.ownerRow.index&&i.paragraph.associatedCell.ownerTable.equals(n.ownerTable)},s.prototype.initTableCellProperties=function(e,t,i){var n=(0,a.az)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.az)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.az)("div",{className:"e-de-table-ppty-options-break"}),l=(0,a.az)("input",{attrs:{type:"checkbox"}}),h=(0,a.az)("div",{className:"e-de-container-row"}),d=(0,a.az)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredCellWidth=(0,a.az)("input",{attrs:{type:"text"}});var c=(0,a.az)("div",{className:"e-de-subcontainer-right"}),u=(0,a.az)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"});n.appendChild(r),e.appendChild(n),o.appendChild(l),n.appendChild(o),d.appendChild(this.preferredCellWidth),n.appendChild(h),h.appendChild(d),h.appendChild(c),c.appendChild(u);var p=(0,a.az)("div",{innerHTML:t.getConstant("Vertical alignment"),className:"e-de-para-dlg-heading"}),f=e.id+"e-de-table-cell-alignment e-de-tablecell-dialog-alignment-icon",g=(0,a.az)("div",{className:"e-de-container-row"}),m=(0,a.az)("div"),v=(0,a.az)("div",{className:"e-de-tablecell-dia-align-div"});this.cellTopAlign=(0,a.az)("div",{id:e.id+"_cell_top-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment "+f}),v.appendChild(this.cellTopAlign);var y=(0,a.az)("div",{className:"e-de-tablecell-dia-align-div"});this.cellCenterAlign=(0,a.az)("div",{id:e.id+"_cell_center-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment "+f}),y.appendChild(this.cellCenterAlign);var b=(0,a.az)("div",{className:"e-de-tablecell-dia-align-div"});this.cellBottomAlign=(0,a.az)("div",{id:e.id+"_cell_bottom-alignment",className:"e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  "+f}),b.appendChild(this.cellBottomAlign);var C=(0,a.az)("label",{innerHTML:t.getConstant("Top"),className:"e-de-table-dia-align-label"}),F=(0,a.az)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),T=(0,a.az)("label",{innerHTML:t.getConstant("Bottom"),className:"e-de-table-dia-align-label"});this.cellOptionButton=(0,a.az)("button",{innerHTML:t.getConstant("Options")+"...",className:"e-control e-btn",attrs:{type:"button"}}),this.cellOptionButton.style.cssFloat=i?"left":"right",g.appendChild(m),m.appendChild(v),g.appendChild(y),g.appendChild(b),v.appendChild(C),y.appendChild(F),b.appendChild(T),e.appendChild(p),e.appendChild(g),e.appendChild(this.cellOptionButton),this.cellOptionButton.addEventListener("click",this.showCellOptionsDialog),this.cellWidthBox=new J.No({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.cellWidthBox.appendTo(this.preferredCellWidth),this.preferredCellWidthCheckBox=new M.Jg({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferredCellWidthCheckBox.appendTo(l),this.cellWidthType=new Te.NB({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in")}),this.cellWidthType.appendTo(u)},s.prototype.setTableCellProperties=function(){var e=this.documentHelper.selection.cellFormat;this.hasCellWidth=e.preferredWidth>0;var t=e.preferredWidth;(0,a.le)(e.preferredWidth)?(this.preferredCellWidthCheckBox.indeterminate=!0,t=this.documentHelper.selection.start.paragraph.associatedCell.cellFormat.preferredWidth):this.preferredCellWidthCheckBox.checked=this.hasCellWidth,this.cellWidthBox.enabled=this.hasCellWidth,this.cellWidthType.enabled=this.hasCellWidth,this.cellWidthType.index="Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?0:1,this.formatNumericTextBox(this.cellWidthBox,e.preferredWidthType,t),(0,a.s1)(this.cellTopAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),(0,a.s1)(this.cellCenterAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),(0,a.s1)(this.cellBottomAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),"Top"===e.verticalAlignment?(0,a.s1)(this.cellTopAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Center"===e.verticalAlignment?(0,a.s1)(this.cellCenterAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Bottom"===e.verticalAlignment&&(0,a.s1)(this.cellBottomAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"])},s.prototype.updateClassForCellAlignment=function(e){for(var t=e.getElementsByClassName(e.id+"e-de-table-cell-alignment"),i=0;i<t.length;i++){var n=t[i];n.classList.contains("e-de-table-alignment-active")&&(0,a.s1)(n,["e-de-tablecell-alignment"],["e-de-table-alignment-active"])}},s.prototype.formatNumericTextBox=function(e,t,i){e.format="Auto"===t||"Point"===t?"n2":"#'%'",e.step=1,e.decimals=2,e.value=i},s.prototype.getCellAlignment=function(){for(var t=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment"),i=0;i<t.length;i++)if(t[i].classList.contains("e-de-table-alignment-active"))return 0===i?"Top":1===i?"Center":"Bottom";return this.documentHelper.selection.cellFormat.verticalAlignment},s.prototype.onCellWidthChange=function(){this.cellFormat.preferredWidth=this.cellWidthBox.value},s.prototype.onCellWidthTypeChange=function(){var t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),n=t.getTableClientWidth(i);"Percent"===this.cellWidthType.text&&"Percent"!==this.documentHelper.selection.cellFormat.preferredWidthType?this.formatNumericTextBox(this.cellWidthBox,"Percent",this.cellWidthBox.value/n*100):"Points"===this.cellWidthType.text&&"Point"!==this.documentHelper.selection.cellFormat.preferredWidthType?this.formatNumericTextBox(this.cellWidthBox,"Point",n/100*this.cellWidthBox.value):this.formatNumericTextBox(this.cellWidthBox,"Points"===this.cellWidthType.text?"Point":this.cellWidthType.text,"#'%'"===this.cellWidthBox.format?"Points"===this.cellWidthType.text?n/100*this.cellWidthBox.value:this.cellWidthBox.value:"Percent"===this.cellWidthType.text?this.cellWidthBox.value/n*100:this.cellWidthBox.value),this.cellFormat.preferredWidthType="Points"===this.cellWidthType.text?"Point":this.cellWidthType.text},s.prototype.destroy=function(){if(!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.cellAlignment=void 0,this.tableAlignment=void 0,this.documentHelper=void 0,this.preferCheckBox=void 0,this.tableWidthType=void 0,this.preferredWidth=void 0,this.rowHeightType=void 0,this.rowHeightCheckBox=void 0,this.rowHeight=void 0,this.cellWidthType=void 0,this.preferredCellWidthCheckBox=void 0,this.preferredCellWidth=void 0,this.tableTab=void 0,this.rowTab=void 0,this.cellTab=void 0,this.left=void 0,this.center=void 0,this.right=void 0,this.leftIndent=void 0,this.allowRowBreak=void 0,this.repeatHeader=void 0,this.cellTopAlign=void 0,this.cellCenterAlign=void 0,this.cellBottomAlign=void 0,this.tableFormatIn&&this.tableFormatIn.destroy(),this.cellFormatIn&&this.cellFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn=void 0},s}(),Fr=function(){function s(e){var t=this;this.cellFormat=new it,this.tableFormat=new Oe,this.isShadingChanged=!1,this.applyBordersShadingsProperties=function(){var i=t.documentHelper.owner.tablePropertiesDialogModule,n=t.documentHelper.selection.start.paragraph.associatedCell,r=void 0;(t.checkClassName(t.previewDivTopTop)||t.checkClassName(t.previewDivTopBottom)||t.checkClassName(t.previewDivTopCenter)||t.checkClassName(t.previewDivBottomcenter)||t.checkClassName(t.previewDivBottomLeft)||t.checkClassName(t.previewDivBottomRight)||t.checkClassName(t.previewDivDiagonalRight)||t.checkClassName(t.previewDivLeftDiagonal))&&(r=new _e,t.checkClassName(t.previewDivTopTop)&&(r.top=t.getBorder("top")),t.checkClassName(t.previewDivTopBottom)&&(r.bottom=t.getBorder("bottom")),t.checkClassName(t.previewDivBottomLeft)&&(r.left=t.getBorder("left")),t.checkClassName(t.previewDivBottomRight)&&(r.right=t.getBorder("right")),t.checkClassName(t.previewDivTopCenter)&&(r.horizontal=t.getBorder("horizontal")),t.checkClassName(t.previewDivBottomcenter)&&(r.vertical=t.getBorder("vertical")),t.checkClassName(t.previewDivLeftDiagonal)&&(r.diagonalDown=t.getBorder("diagonalDown")),t.checkClassName(t.previewDivDiagonalRight)&&(r.diagonalUp=t.getBorder("diagonalUp")));var o=new ot,l=t.documentHelper.owner.editorModule;if(o.backgroundColor=t.shadingColorPicker.value,"Cell"===t.ulelementShading.value)i&&(i.isCellBordersAndShadingUpdated=!0),t.cellFormat.borders=new _e,(0,a.le)(r)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&l.applyBordersInternal(t.cellFormat.borders,new _e):l.applyBordersInternal(t.cellFormat.borders,r),(0,a.le)(n.cellFormat.shading)||(o.foregroundColor=n.cellFormat.shading.foregroundColor,o.textureStyle=n.cellFormat.shading.textureStyle),t.cellFormat.shading=new ot,l.applyShading(t.cellFormat.shading,o);else if("Table"===t.ulelementShading.value){i&&(i.isTableBordersAndShadingUpdated=!0);var h=t.documentHelper.owner.selection.tableFormat.table.tableFormat;t.tableFormat.copyFormat(h),t.tableFormat.borders=new _e,(0,a.le)(r)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&l.applyBordersInternal(t.tableFormat.borders,new _e):l.applyBordersInternal(t.tableFormat.borders,r),(0,a.le)(h.shading)||(o.foregroundColor=h.shading.foregroundColor,o.textureStyle=h.shading.textureStyle),t.tableFormat.shading=new ot,t.isShadingChanged=h.shading.backgroundColor!==o.backgroundColor,l.applyShading(t.tableFormat.shading,o)}else if("Paragraph"===t.ulelementShading.value){var d=t.noneDiv.classList.contains("e-de-table-border-inside-setting-click");(0,a.le)(t.paragraphFormat)?l.onApplyParagraphFormat("borders",d?new _e:r,!1,!1):l.applyBordersInternal(t.paragraphFormat.borders,d?new _e:r)}t.applyFormat(),t.closeDialog()},this.closeDialog=function(){t.documentHelper.dialog.hide(),t.closeBordersShadingsDialog()},this.closeBordersShadingsDialog=function(){t.paragraphFormat=void 0,t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.handleSettingCheckBoxAction=function(i){var n=i.target.id,r=t.target.id;n===r+"_None_Div"||n===r+"_None_Div_Container"||n===r+"_None_Div_Transparent"?(t.updateClassForSettingDivElements(),t.noneDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("none")):n===r+"_Box_Div"||n===r+"_Box_Div_Container"||n===r+"_Box_Div_Transparent"?(t.updateClassForSettingDivElements(),t.boxDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("box")):n===r+"_All_Div"||n===r+"_All_Div_Container"||n===r+"_All_Div_Transparent"?(t.updateClassForSettingDivElements(),t.allDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("all")):(t.updateClassForSettingDivElements(),t.customDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("customDiv"))},this.handlePreviewCheckBoxAction=function(i){var r=i.target.id,o=t.target.id,l="e-de-table-border-inside-preview-click";t.customDiv.click(),r===o+"_Preview_Div_TopTop_Container"||r===o+"_Preview_Div_TopTop"||r===o+"_previewDivTopTopTransParent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivTopTop),t.showHidePreviewDivElements(o,l,"_Preview_Div","_Preview_Div_TopTop","TopTop")):r===o+"_Preview_Div_TopCenter_Container"||r===o+"_Preview_Div_TopCenter"||r===o+"_previewDivTopCenterTransParent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivTopCenter),t.showHidePreviewDivElements(o,l,"_Preview_Div_Horizontal","_Preview_Div_TopCenter","TopCenter")):r===o+"_Preview_Div_TopBottom_Container"||r===o+"_Preview_Div_TopBottom"||r===o+"_previewDivTopBottomTransParent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivTopBottom),t.showHidePreviewDivElements(o,l,"_Preview_Div","_Preview_Div_TopBottom","TopBottom")):r===o+"_Preview_Div_LeftDiagonal_Container"||r===o+"_Preview_Div_LeftDiagonal"||r===o+"_previewDivLeftDiagonalTransParent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivLeftDiagonal),t.showHidePreviewDivElements(o,l,"_Preview_Div_Left_Diagonal","_Preview_Div_LeftDiagonal","LeftDiagonal")):r===o+"_Preview_Div_BottomLeft_Container"||r===o+"_Preview_Div_BottomLeft"||r===o+"_previewDivBottomLeftTransparent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivBottomLeft),t.showHidePreviewDivElements(o,l,"_Preview_Div","_Preview_Div_BottomLeft","BottomLeft")):r===o+"_Preview_Div_BottomCenter_Container"||r===o+"_Preview_Div_BottomCenter"||r===o+"_previewDivBottomcenterTransparent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivBottomcenter),t.showHidePreviewDivElements(o,l,"_Preview_Div_Vertical","_Preview_Div_BottomCenter","BottomCenter")):r===o+"_Preview_Div_BottomRight_Container"||r===o+"_Preview_Div_BottomRight"||r===o+"_previewDivBottomRightTransparent"?(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivBottomRight),t.showHidePreviewDivElements(o,l,"_Preview_Div","_Preview_Div_BottomRight","BottomRight")):(r===o+"_Preview_Div_RightDiagonal_Container"||r===o+"_Preview_Div_RightDiagonal"||r===o+"_previewDivDiagonalRightTransparent")&&(t.handlePreviewCheckBoxShowHide(o,l,t.previewDivDiagonalRight),t.showHidePreviewDivElements(o,l,"_Preview_Div_Right_Diagonal","_Preview_Div_RightDiagonal","RightDiagonal"))},this.applyTableCellPreviewBoxes=function(){(0,a.le)(t.ulelementShading)||("Cell"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewDivLeftDiagonal.style.display="",t.previewDivDiagonalRight.style.display="",t.previewDivBottomRightContainer.style.left="80px",(0,a.s1)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),(0,a.s1)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),(0,a.s1)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),(0,a.s1)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):"Table"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivLeftDiagonal.style.display="none",t.previewDivDiagonalRight.style.display="none",t.previewDivBottomcenterContainer.style.visibility="visible",t.previewDivTopCenterContainer.style.visibility="visible",t.previewVerticalDiv.style.display="",t.previewHorizontalDiv.style.display="",t.previewDivBottomRightContainer.style.left="110px",(0,a.s1)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),(0,a.s1)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),(0,a.s1)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),(0,a.s1)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):(t.shadingColorPicker.disabled=!0,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewLeftDiagonalDiv.style.display="none",t.previewRightDiagonalDiv.style.display="none",(0,a.s1)(t.noneDivTransparent,["e-de-para-border-none-setting"],["e-de-table-border-none-setting"]),(0,a.s1)(t.boxDivTransparent,["e-de-para-border-box-setting"],["e-de-table-border-box-setting"]),(0,a.s1)(t.allDivTransparent,["e-de-para-border-shadow-setting"],["e-de-table-border-all-setting"]),(0,a.s1)(t.customDivTransparent,["e-de-para-border-custom-setting"],["e-de-table-border-custom-setting"])))},this.applyPreviewTableBackgroundColor=function(i){(0,a.le)(i.currentValue)||(t.previewDiv.style.backgroundColor=i.currentValue.hex)},this.applyPreviewTableBorderColor=function(i){if(!(0,a.le)(i.currentValue)){var n=i.currentValue.hex;t.previewDiv.style.borderColor=n,t.previewRightDiagonalDiv.style.backgroundColor=n,t.previewLeftDiagonalDiv.style.backgroundColor=n,t.previewVerticalDiv.style.backgroundColor=n,t.previewHorizontalDiv.style.backgroundColor=n}},this.documentHelper=e}return s.prototype.getModuleName=function(){return"BordersAndShadingDialog"},s.prototype.initBordersAndShadingsDialog=function(e,t){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_table_border_shadings",className:"e-de-table-border-shading-dlg"});var i=(0,a.az)("div",{innerHTML:e.getConstant("Borders"),className:"e-de-table-border-heading"}),n=(0,a.az)("div",{className:"e-de-dlg-row"}),r=(0,a.az)("div",{}),o=(0,a.az)("div",{}),l=(0,a.az)("div",{className:"e-de-table-border-preview-container"}),h=(0,a.az)("div",{className:"e-de-dlg-row"}),d=(0,a.az)("div",{}),c=(0,a.az)("div",{className:"e-de-container-row"}),u=(0,a.az)("div",{className:"e-de-subcontainer-left"}),p=(0,a.az)("select",{});p.innerHTML='<option value="None">'+e.getConstant("None")+'</option><option value="Single">'+e.getConstant("Single")+'</option><option value="Dot">'+e.getConstant("Dot")+'</option><option value="DashSmallGap">'+e.getConstant("DashSmallGap")+'</option><option value="DashLargeGap">'+e.getConstant("DashLargeGap")+'</option><option value="DashDot">'+e.getConstant("DashDot")+'</option><option value="DashDotDot">'+e.getConstant("DashDotDot")+'</option><option value="Double">'+e.getConstant("Double")+'</option><option value="Triple">'+e.getConstant("Triple")+'</option><option value="ThinThickSmallGap">'+e.getConstant("ThinThickSmallGap")+'</option><option value="ThickThinSmallGap">'+e.getConstant("ThickThinSmallGap")+'</option><option value="ThinThickThinSmallGap">'+e.getConstant("ThinThickThinSmallGap")+'</option><option value="ThinThickMediumGap">'+e.getConstant("ThinThickMediumGap")+'</option><option value="ThickThinMediumGap">'+e.getConstant("ThickThinMediumGap")+'</option><option value="ThinThickThinMediumGap">'+e.getConstant("ThinThickThinMediumGap")+'</option><option value="ThinThickLargeGap">'+e.getConstant("ThinThickLargeGap")+'</option><option value="ThickThinLargeGap">'+e.getConstant("ThickThinLargeGap")+'</option><option value="ThinThickThinLargeGap">'+e.getConstant("ThinThickThinLargeGap")+'</option><option value="SingleWavy">'+e.getConstant("SingleWavy")+'</option><option value="DoubleWavy">'+e.getConstant("DoubleWavy")+'</option><option value="DashDotStroked">'+e.getConstant("DashDotStroked")+'</option><option value="Emboss3D">'+e.getConstant("Emboss3D")+'</option><option value="Engrave3D">'+e.getConstant("Engrave3D")+'</option><option value="Outset">'+e.getConstant("Outset")+'</option><option value="Inset">'+e.getConstant("Inset")+'</option><option value="Thick">'+e.getConstant("Thick")+"</option>";var f=(0,a.az)("div",{className:"e-de-container-row"}),g=(0,a.az)("div",{className:"e-de-subcontainer-left"}),m=(0,a.az)("input",{}),v=(0,a.az)("div",{className:"e-de-subcontainer-right"}),y=(0,a.az)("div",{innerHTML:e.getConstant("Color"),className:"e-de-table-border-clr-heading"}),b=(0,a.az)("input",{attrs:{type:"color"},className:"e-dlg-clr-pkr-top"}),C=(0,a.az)("div",{innerHTML:e.getConstant("Setting"),className:"e-de-table-setting-heading"}),F=(0,a.az)("div",{className:"e-de-dlg-row"}),T=(0,a.az)("div",{id:this.target.id+"_None_Div_Container"});this.noneDiv=(0,a.az)("div",{id:this.target.id+"_None_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var x=(0,a.az)("label",{innerHTML:e.getConstant("None"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_None_Div_Label"}),P=(0,a.az)("div",{id:this.target.id+"_Box_Div_Container"});this.boxDiv=(0,a.az)("div",{id:this.target.id+"_Box_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var E=(0,a.az)("label",{innerHTML:e.getConstant("Box"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Box_Div_Label"}),L=(0,a.az)("div",{id:this.target.id+"_All_Div_Container"});this.allDiv=(0,a.az)("div",{id:this.target.id+"_All_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var W=(0,a.az)("label",{innerHTML:e.getConstant("All"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_All_Div_Label"}),R=(0,a.az)("div",{id:this.target.id+"_Custom_Div_Container"});this.customDiv=(0,a.az)("div",{id:this.target.id+"_Custom_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var N=(0,a.az)("label",{innerHTML:e.getConstant("Custom"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Custom_Div_Label"});this.noneDivTransparent=(0,a.az)("div",{id:this.target.id+"_None_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-none-setting"}),this.boxDivTransparent=(0,a.az)("div",{id:this.target.id+"_Box_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-box-setting"}),this.allDivTransparent=(0,a.az)("div",{id:this.target.id+"_All_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-all-setting"}),this.customDivTransparent=(0,a.az)("div",{id:this.target.id+"_Custom_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-custom-setting"}),t&&(this.noneDivTransparent.classList.add("e-de-rtl"),this.boxDivTransparent.classList.add("e-de-rtl"),this.allDivTransparent.classList.add("e-de-rtl"),this.customDivTransparent.classList.add("e-de-rtl"));var B=(0,a.az)("div",{innerHTML:e.getConstant("Preview"),className:"e-de-table-setting-heading"});this.previewDiv=(0,a.az)("div",{id:this.target.id+"_Preview_Div",className:"e-de-border-dlg-preview-div",styles:"position: relative"}),this.previewRightDiagonalDiv=(0,a.az)("div",{styles:"position: absolute;width:1px;height:111px;left: 38px;top: -17px;transform: rotate(135deg); background-color: black",id:this.target.id+"_Preview_Div_Right_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewLeftDiagonalDiv=(0,a.az)("div",{styles:"position: absolute;width: 1px;height: 111px;left: 38px;top: -17px;transform:rotate(45deg); background-color: black",id:this.target.id+"_Preview_Div_Left_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewVerticalDiv=(0,a.az)("div",{styles:"width: 1px;height: 80px;position: absolute;left: 39px;top: -1px; background-color: black",id:this.target.id+"_Preview_Div_Vertical",className:"e-de-border-dlg-preview-inside-divs"}),this.previewHorizontalDiv=(0,a.az)("div",{styles:"width: 80px;height: 1px;position: absolute;left: -1px;top: 41px; background-color: black",id:this.target.id+"_Preview_Div_Horizontal",className:"e-de-border-dlg-preview-inside-divs"});var q=(0,a.az)("div");this.previewDivTopTopContainer=(0,a.az)("div",{styles:"margin-top: 0",className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopTop_Container"}),this.previewDivTopTop=(0,a.az)("div",{id:this.target.id+"_Preview_Div_TopTop",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopCenterContainer=(0,a.az)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopCenter_Container"}),this.previewDivTopCenter=(0,a.az)("div",{id:this.target.id+"_Preview_Div_TopCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopBottomContainer=(0,a.az)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopBottom_Container"}),this.previewDivTopBottom=(0,a.az)("div",{id:this.target.id+"_Preview_Div_TopBottom",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivLeftDiagonalContainer=(0,a.az)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_LeftDiagonal_Container"}),this.previewDivLeftDiagonal=(0,a.az)("div",{id:this.target.id+"_Preview_Div_LeftDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"});var A=(0,a.az)("div",{className:"e-de-dlg-row"});this.previewDivBottomLeftContainer=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomLeft_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomLeft=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomLeft",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomcenterContainer=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomCenter_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomcenter=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomRightContainer=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomRight_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomRight=(0,a.az)("div",{id:this.target.id+"_Preview_Div_BottomRight",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivDiagonalRightContainer=(0,a.az)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_RightDiagonal_Container"}),this.previewDivDiagonalRight=(0,a.az)("div",{id:this.target.id+"_Preview_Div_RightDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopTopTransParent=(0,a.az)("div",{id:this.target.id+"_previewDivTopTopTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-toptop-alignment"}),this.previewDivTopCenterTransParent=(0,a.az)("div",{id:this.target.id+"_previewDivTopCenterTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment"}),this.previewDivTopBottomTransParent=(0,a.az)("div",{id:this.target.id+"_previewDivTopBottomTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment"}),this.previewDivLeftDiagonalTransParent=(0,a.az)("div",{id:this.target.id+"_previewDivLeftDiagonalTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment"}),this.previewDivBottomLeftTransparent=(0,a.az)("div",{id:this.target.id+"_previewDivBottomLeftTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment"}),this.previewDivBottomcenterTransparent=(0,a.az)("div",{id:this.target.id+"_previewDivBottomcenterTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment"}),this.previewDivBottomRightTransparent=(0,a.az)("div",{id:this.target.id+"_previewDivBottomRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment"}),this.previewDivDiagonalRightTransparent=(0,a.az)("div",{id:this.target.id+"_previewDivDiagonalRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment"}),this.shadingContiner=(0,a.az)("div",{});var X=(0,a.az)("div",{innerHTML:e.getConstant("Shading"),className:"e-de-table-border-heading"}),le=(0,a.az)("div",{className:"e-de-dlg-row"}),K=(0,a.az)("div",{className:"e-de-table-border-clr-left-container"}),he=(0,a.az)("div",{innerHTML:e.getConstant("Fill"),className:"e-de-table-border-clr-heading"}),ge=(0,a.az)("input",{attrs:{type:"color"},id:this.target.id+"_shading_color"}),te=(0,a.az)("div",{className:"e-de-subcontainer-right"}),G=(0,a.az)("input",{id:this.target.id+"_shading"}),Ae=[{Value:"Cell",Name:e.getConstant("Cell ")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}];te.appendChild(G),this.noneDiv.appendChild(this.noneDivTransparent),this.boxDiv.appendChild(this.boxDivTransparent),this.allDiv.appendChild(this.allDivTransparent),this.customDiv.appendChild(this.customDivTransparent),T.appendChild(this.noneDiv),T.appendChild(x),P.appendChild(this.boxDiv),P.appendChild(E),L.appendChild(this.allDiv),L.appendChild(W),R.appendChild(this.customDiv),R.appendChild(N),r.appendChild(C),r.appendChild(F),F.appendChild(T),F.appendChild(P),F.appendChild(L),F.appendChild(R),this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent),this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent),this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent),this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent),this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent),this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent),this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent),this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent),this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter),this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft),this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight),this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight),this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal),this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom),this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter),this.previewDivTopTopContainer.appendChild(this.previewDivTopTop),l.appendChild(B),l.appendChild(h),h.appendChild(q),h.appendChild(d),d.appendChild(this.previewDiv),d.appendChild(A),this.previewDiv.appendChild(this.previewLeftDiagonalDiv),this.previewDiv.appendChild(this.previewRightDiagonalDiv),this.previewDiv.appendChild(this.previewHorizontalDiv),this.previewDiv.appendChild(this.previewVerticalDiv),A.appendChild(this.previewDivBottomLeftContainer),A.appendChild(this.previewDivBottomcenterContainer),A.appendChild(this.previewDivBottomRightContainer),A.appendChild(this.previewDivDiagonalRightContainer),q.appendChild(this.previewDivTopTopContainer),q.appendChild(this.previewDivTopCenterContainer),q.appendChild(this.previewDivTopBottomContainer),q.appendChild(this.previewDivLeftDiagonalContainer),le.appendChild(K),K.appendChild(he),K.appendChild(ge),le.appendChild(te),this.shadingContiner.appendChild(X),this.shadingContiner.appendChild(le),o.appendChild(c),c.appendChild(u),u.appendChild(p),o.appendChild(f),f.appendChild(g),g.appendChild(m),f.appendChild(v),v.appendChild(y),v.appendChild(b),n.appendChild(r),n.appendChild(l),this.target.appendChild(i),this.target.appendChild(n),this.target.appendChild(o),this.target.appendChild(this.shadingContiner),T.addEventListener("click",this.handleSettingCheckBoxAction),P.addEventListener("click",this.handleSettingCheckBoxAction),L.addEventListener("click",this.handleSettingCheckBoxAction),R.addEventListener("click",this.handleSettingCheckBoxAction),this.previewDivBottomcenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomLeftContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopTopContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopBottomContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopCenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivDiagonalRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivLeftDiagonalContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.borderWidth=new J.No({value:0,min:0,max:6,decimals:2,floatLabelType:"Always",placeholder:e.getConstant("Width"),enablePersistence:!1}),this.borderWidth.appendTo(m),this.borderStyle=new Te.NB({popupHeight:"150px",index:1,floatLabelType:"Always",placeholder:e.getConstant("Style"),enableRtl:t}),this.borderStyle.appendTo(p),this.ulelementShading=new Te.NB({dataSource:Ae,fields:{text:"Name",value:"Value"},change:this.applyTableCellPreviewBoxes,index:1,floatLabelType:"Always",placeholder:e.getConstant("Apply To"),enableRtl:t}),this.ulelementShading.appendTo(G),this.borderColorPicker=new J.zH({value:"#000000",change:this.applyPreviewTableBorderColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker"}),this.borderColorPicker.appendTo(b),this.shadingColorPicker=new J.zH({value:"#FFFFFF",change:this.applyPreviewTableBackgroundColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker"}),this.shadingColorPicker.appendTo(ge),t&&he.classList.add("e-de-rtl")},s.prototype.applyFormat=function(){var e=this.documentHelper.owner.editorModule;"Paragraph"!==this.ulelementShading.value&&(e.initComplexHistory("BordersAndShading"),e.isBordersAndShadingDialog=!0,"Cell"===this.ulelementShading.value?e.onCellFormat(this.cellFormat):"Table"===this.ulelementShading.value&&e.onTableFormat(this.tableFormat,this.isShadingChanged),(0,a.le)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()),e.isBordersAndShadingDialog=!1},s.prototype.getBorder=function(e){var t=new ve;return t.color=this.borderColorPicker.value,t.lineStyle=this.borderStyle.text,t.lineWidth=this.borderWidth.value,t.space="left"===e||"right"===e?4:1,t},s.prototype.checkClassName=function(e){return e.classList.contains("e-de-table-border-inside-preview-click")},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initBordersAndShadingsDialog(e,this.documentHelper.owner.enableRtl),this.loadBordersShadingsPropertiesDialog(e),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Borders and Shading"),this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.closeBordersShadingsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyBordersShadingsProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},s.prototype.updateClassForSettingDivElements=function(){for(var e=this.target.getElementsByClassName("e-de-table-border-inside-setting"),t=0;t<e.length;t++)if(-1!==e[t].className.indexOf("e-de-table-border-inside-setting-click")){var i=e[t].className;i=i.replace("e-de-table-border-inside-setting-click",""),e[t].className=i}},s.prototype.setSettingPreviewDivElement=function(e){switch(e){case"none":this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("none");break;case"box":this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("box");break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all")):(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all"))}},s.prototype.isShowHidePreviewTableElements=function(e){switch(e){case"none":this.previewDiv.style.border="none",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"box":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="block",this.previewVerticalDiv.style.display="block"):(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none")}},s.prototype.handlePreviewCheckBoxShowHide=function(e,t,i){i.classList.contains(t)?i.classList.remove(t):i.classList.add(t)},s.prototype.showHidePreviewDivElements=function(e,t,i,n,r){var o=document.getElementById(e+i),l=document.getElementById(e+n);"TopTop"===r?this.setPropertyPreviewDivElement(o,l,t,"border-top"):"TopCenter"===r?this.setPropertyPreviewDivElement(o,l,t,"display"):"TopBottom"===r?this.setPropertyPreviewDivElement(o,l,t,"border-bottom"):"LeftDiagonal"===r?this.setPropertyPreviewDivElement(o,l,t,"display"):"BottomLeft"===r?this.setPropertyPreviewDivElement(o,l,t,"border-left"):"BottomCenter"===r?this.setPropertyPreviewDivElement(o,l,t,"display"):"BottomRight"===r?this.setPropertyPreviewDivElement(o,l,t,"border-right"):"RightDiagonal"===r&&this.setPropertyPreviewDivElement(o,l,t,"display")},s.prototype.setPropertyPreviewDivElement=function(e,t,i,n){e.style[n]=t.classList.contains(i)&&"border"===n.split("-")[0]?"1px solid rgba(0, 0, 0, .54)":t.classList.contains(i)&&"display"===n?"block":"none"},s.prototype.loadBordersShadingsPropertiesDialog=function(e){var t,i,n,r;if((0,a.le)(this.documentHelper.selection.tableFormat.table)){this.shadingContiner.style.display="none",this.ulelementShading.dataSource=[{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var l=this.documentHelper.selection.start.paragraph.paragraphFormat;this.ulelementShading.value="Paragraph",this.cloneBorders(l.borders);var h=this.getSelectionBorderFormat();h.hasValues()?(t=this.getLineStyle(h.lineStyle),i=h.color,r=h.lineWidth):(t=1,i="#000000",r=.5),this.shadingColorPicker.disabled=!0}else{this.shadingContiner.style.display="block",this.ulelementShading.dataSource=[{Value:"Cell",Name:e.getConstant("Cell")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var o=this.documentHelper.selection.tableFormat.table.tableFormat;!(0,a.le)(o)&&!(0,a.le)(o.borders)&&(this.cloneBorders(o.borders),(0,a.le)(o.borders)||(0,a.le)(o.borders.top)?(t=1,i="#000000",r=0,n="#000000"):(t=this.getLineStyle(o.borders.top.lineStyle),i=o.borders.top.color,r=o.borders.top.getLineWidth(),n=o.shading.backgroundColor),this.ulelementShading.value="Table",this.shadingColorPicker.value=n,this.shadingColorPicker.disabled=!1)}this.borderColorPicker.value=i,this.previewDivLeftDiagonal.style.display="none",this.previewDivDiagonalRight.style.display="none",this.borderWidth.value=r,this.borderStyle.index=t},s.prototype.getSelectionBorderFormat=function(){var e=new ve,t=this.documentHelper.selection.paragraphFormat.borders;return"None"!==t.top.lineStyle?this.copyToBorder(e,t.top):"None"!==t.left.lineStyle?this.copyToBorder(e,t.left):"None"!==t.bottom.lineStyle?this.copyToBorder(e,t.bottom):"None"!==t.right.lineStyle?this.copyToBorder(e,t.right):e},s.prototype.copyToBorder=function(e,t){return(0,a.le)(t.lineStyle)||(e.lineStyle=t.lineStyle),(0,a.le)(t.color)||(e.color=t.color),(0,a.le)(t.lineWidth)||(e.lineWidth=t.lineWidth),e},s.prototype.cloneBorders=function(e){var t=!1,i=!1,n=!1,r=!1,o=!1,l=!1,h=!1,d=!1,c=!1;null!==e&&(e.top&&(e.top.hasNoneStyle||"None"!==e.top.lineStyle)&&(t=!0),e.bottom&&(e.bottom.hasNoneStyle||"None"!==e.bottom.lineStyle)&&(i=!0),e.left&&(e.left.hasNoneStyle||"None"!==e.left.lineStyle)&&(n=!0),e.right&&(e.right.hasNoneStyle||"None"!==e.right.lineStyle)&&(r=!0),e.horizontal&&(e.horizontal.hasNoneStyle||"None"!==e.horizontal.lineStyle)&&(o=!0),e.vertical&&(e.vertical.hasNoneStyle||"None"!==e.vertical.lineStyle)&&(l=!0),e.diagonalDown&&(e.diagonalDown.hasNoneStyle||"None"!==e.diagonalDown.lineStyle)&&(h=!0),e.diagonalUp&&(e.diagonalUp.hasNoneStyle||"None"!==e.diagonalUp.lineStyle)&&(c=!0),t&&i&&n&&r?t&&i&&n&&r&&o&&l&&!c&&!h?t&&i&&n&&r&&o&&l&&!c&&!h&&(e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("all"),this.allDiv.classList.add("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"))):n&&i&&t&&r&&!o&&!l?e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("box"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.add("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):d=!0:d=!0,this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),t||i||n||r||o||l?d&&(this.customDiv.classList.add("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?t?this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"):t?(this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="1px solid rgba(0,0,0,.54)"):(this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?i?this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"):i?(this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="1px solid rgba(0,0,0,.54)"):(this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?n?this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"):n?(this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?r?this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"):r?(this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="0px"),l?this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),o?this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")):"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")))},s.prototype.getLineStyle=function(e){switch(e){case"Single":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25}return 0},s.prototype.destroy=function(){if(!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.cellFormat&&(this.cellFormat.destroy(),this.cellFormat=void 0),this.tableFormat&&(this.tableFormat.destroy(),this.tableFormat=void 0),this.dialog=void 0,this.target=void 0,(0,a.le)(this.borderStyle)||this.borderStyle.destroy(),this.borderStyle=void 0,(0,a.le)(this.borderColorPicker)||this.borderColorPicker.destroy(),this.borderColorPicker=void 0,(0,a.le)(this.shadingColorPicker)||this.shadingColorPicker.destroy(),this.shadingColorPicker=void 0,(0,a.le)(this.ulelementShading)||this.ulelementShading.destroy(),this.ulelementShading=void 0,this.noneDivTransparent=void 0,this.boxDivTransparent=void 0,this.allDivTransparent=void 0,this.customDivTransparent=void 0,this.previewDiv=void 0,this.previewRightDiagonalDiv=void 0,this.previewLeftDiagonalDiv=void 0,this.previewVerticalDiv=void 0,this.previewHorizontalDiv=void 0,this.previewDivTopTopContainer=void 0,this.previewDivTopTop=void 0,this.previewDivTopCenterContainer=void 0,this.previewDivTopCenter=void 0,this.previewDivTopBottomContainer=void 0,this.previewDivTopBottom=void 0,this.previewDivLeftDiagonalContainer=void 0,this.previewDivLeftDiagonal=void 0,this.previewDivBottomLeftContainer=void 0,this.previewDivBottomLeft=void 0,this.previewDivBottomcenterContainer=void 0,this.previewDivBottomcenter=void 0,this.previewDivBottomRightContainer=void 0,this.previewDivBottomRight=void 0,this.previewDivDiagonalRightContainer=void 0,this.previewDivDiagonalRight=void 0,this.previewDivTopTopTransParent=void 0,this.previewDivTopCenterTransParent=void 0,this.previewDivTopBottomTransParent=void 0,this.previewDivLeftDiagonalTransParent=void 0,this.previewDivBottomLeftTransparent=void 0,this.previewDivBottomcenterTransparent=void 0,this.previewDivBottomRightTransparent=void 0,this.previewDivDiagonalRightTransparent=void 0,this.shadingContiner=void 0,this.noneDiv=void 0,this.customDiv=void 0,this.allDiv=void 0,this.boxDiv=void 0,this.documentHelper=void 0},s}(),xr=function(){function s(e){var t=this;this.applyTableCellProperties=function(){var i=t.documentHelper.selection.tableFormat;!(0,a.le)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value||t.cellSpaceTextBox.value)&&(i.bottomMargin!==t.bottomMarginBox.value||i.leftMargin!==t.leftMarginBox.value||i.rightMargin!==t.rightMarginBox.value||i.topMargin!==t.topMarginBox.value||i.cellSpacing!==t.cellSpaceTextBox.value)&&(t.documentHelper.owner.tablePropertiesDialogModule.isTableOptionsUpdated=!0,t.applyTableOptions(t.tableFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeAllowSpaceCheckBox=function(){t.cellSpaceTextBox.enabled=!!t.allowSpaceCheckBox.checked},this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.documentHelper=e}return Object.defineProperty(s.prototype,"tableFormat",{get:function(){return(0,a.le)(this.tableFormatIn)?this.tableFormatIn=new Oe:this.tableFormatIn},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"TableOptionsDialog"},s.prototype.initTableOptionsDialog=function(e,t){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_insertCellMarginsDialog",className:"e-de-table-options-dlg"});var i=(0,a.az)("div"),n=(0,a.az)("Label",{id:this.target.id+"_innerDivLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default cell margins")});i.appendChild(n),qi.getCellMarginDialogElements(this,i,e,!1);var r=(0,a.az)("div"),o=(0,a.az)("Label",{className:"e-de-para-dlg-heading",id:this.target.id+"_cellSpaceLabel"});o.innerHTML=e.getConstant("Default cell spacing"),r.appendChild(o);var l=(0,a.az)("TABLE",{styles:"height: 30px;"}),h=(0,a.az)("tr"),d=(0,a.az)("td"),c=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_cellcheck"}),p=(0,a.az)("td",{styles:t?"padding-right:25px;":"padding-left:25px;"});this.cellspacingTextBox=(0,a.az)("input",{attrs:{type:"text"},id:this.target.id+"_cellspacing"}),d.appendChild(c),p.appendChild(this.cellspacingTextBox),h.appendChild(d),h.appendChild(p),l.appendChild(h),r.appendChild(l);var f=document.createElement("div");this.target.appendChild(r),this.target.appendChild(f),this.cellSpaceTextBox=new J.No({value:0,min:0,max:264.5,width:174,decimals:2,enablePersistence:!1}),this.cellSpaceTextBox.appendTo(this.cellspacingTextBox),this.allowSpaceCheckBox=new M.Jg({label:e.getConstant("Allow spacing between cells"),change:this.changeAllowSpaceCheckBox,enableRtl:t,cssClass:"e-de-tbl-margin-sub-header"}),this.allowSpaceCheckBox.appendTo(c)},s.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.tableFormat;this.cellSpaceTextBox.value=e.cellSpacing,this.bottomMarginBox.value=e.bottomMargin,this.topMarginBox.value=e.topMargin,this.rightMarginBox.value=e.rightMargin,this.leftMarginBox.value=e.leftMargin,e.cellSpacing>0?(this.allowSpaceCheckBox.checked=!0,this.cellSpaceTextBox.enabled=!0):(this.allowSpaceCheckBox.checked=!1,this.cellSpaceTextBox.enabled=!1)},s.prototype.applySubTableOptions=function(e){this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.applyTableOptionsHistory(e),(0,a.le)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()},s.prototype.applyTableOptionsHelper=function(e){this.applySubTableOptionsHelper(e)},s.prototype.applyTableOptionsHistory=function(e){this.documentHelper.owner.editorModule.initHistory("TableOptions"),this.applySubTableOptionsHelper(e)},s.prototype.applySubTableOptionsHelper=function(e){var t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable,i=(t=t.combineWidget(this.documentHelper.owner.viewer)).tableFormat;(0,a.le)(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(i),i.cellSpacing=e.cellSpacing,i.leftMargin=e.leftMargin,i.topMargin=e.topMargin,i.rightMargin=e.rightMargin,i.bottomMargin=e.bottomMargin,this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(t)},s.prototype.applyTableOptions=function(e){e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value,this.allowSpaceCheckBox.checked&&(e.cellSpacing=this.cellSpaceTextBox.value)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOptionsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Table Options"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},s.prototype.destroy=function(){if(!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.cellspacingTextBox=void 0,this.allowSpaceCheckBox=void 0},s}(),qi=function(){function s(e){var t=this;this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeSameAsTable=function(){t.sameAsTableCheckBox.checked?(t.leftMarginBox.enabled=!1,t.rightMarginBox.enabled=!1,t.bottomMarginBox.enabled=!1,t.topMarginBox.enabled=!1):(t.leftMarginBox.enabled=!0,t.rightMarginBox.enabled=!0,t.bottomMarginBox.enabled=!0,t.topMarginBox.enabled=!0)},this.applyTableCellProperties=function(){var i=t.documentHelper.selection.cellFormat;!(0,a.le)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value)&&(i.bottomMargin!==t.bottomMarginBox.value||i.leftMargin!==t.leftMarginBox.value||i.rightMargin!==t.rightMarginBox.value||i.topMargin!==t.topMarginBox.value)&&(t.documentHelper.owner.tablePropertiesDialogModule.isCellOptionsUpdated=!0,t.applyTableOptions(t.cellFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.documentHelper=e}return Object.defineProperty(s.prototype,"cellFormat",{get:function(){return(0,a.le)(this.cellFormatIn)?this.cellFormatIn=new it:this.cellFormatIn},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"CellOptionsDialog"},s.prototype.initCellMarginsDialog=function(e,t){this.owner=this.documentHelper.owner.viewer,this.target=(0,a.az)("div",{className:"e-de-table-cell-margin-dlg"});var i=(0,a.az)("div"),n=(0,a.az)("Label",{className:"e-de-para-dlg-heading"});n.innerHTML=e.getConstant("Cell margins"),i.appendChild(n);var r=(0,a.az)("TABLE",{styles:"padding-bottom: 8px;padding-top: 8px;",className:"e-de-cell-margin-top"}),o=(0,a.az)("tr"),l=(0,a.az)("td",{className:"e-de-tbl-btn-separator"}),h=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.target.id+"_sameAsCheckBox"});l.appendChild(h),o.appendChild(l),r.appendChild(o),i.appendChild(r),s.getCellMarginDialogElements(this,i,e,!0);var d=document.createElement("div");this.target.appendChild(d),this.sameAsTableCheckBox=new M.Jg({label:e.getConstant("Same as the whole table"),change:this.changeSameAsTable,enableRtl:t}),this.sameAsTableCheckBox.appendTo(h),this.sameAsTableCheckBox.addEventListener("change",this.changeSameAsTable)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initCellMarginsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Cell Options"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},s.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.cellFormat;this.sameAsTable=(0,a.le)(e.leftMargin||e.topMargin||e.rightMargin||e.bottomMargin),this.sameAsTable?this.loadCellProperties(this.documentHelper.selection.tableFormat,!1,!0):this.loadCellProperties(e,!0,!1)},s.prototype.loadCellProperties=function(e,t,i){this.leftMarginBox.value=e.leftMargin,this.rightMarginBox.value=e.rightMargin,this.topMarginBox.value=e.topMargin,this.bottomMarginBox.value=e.bottomMargin,this.leftMarginBox.enabled=t,this.rightMarginBox.enabled=t,this.topMarginBox.enabled=t,this.bottomMarginBox.enabled=t,this.sameAsTableCheckBox.checked=i},s.prototype.applySubCellOptions=function(e){this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner),this.applyCellMarginValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),(0,a.le)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()},s.prototype.applyCellMarginValue=function(e,t,i,n){if(this.applyCellMarginsInternal(e,n),i.paragraph.associatedCell.ownerRow!==e){var r=e.nextWidget;(0,a.le)(r)||this.applyCellMarginValue(r,t,i,n)}},s.prototype.applyCellMarginsInternal=function(e,t){(0,a.le)(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||(t=this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(e.childWidgets[0].cellFormat,t,e.ownerTable)),(0,a.le)(t)||this.applyCellMarginsForCells(e,t)},s.prototype.applyCellMarginsForCells=function(e,t){this.iterateCells(e.childWidgets,t)},s.prototype.iterateCells=function(e,t){for(var i=0;i<e.length;i++)this.applySubCellMargins(e[i].cellFormat,t);this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(e[0].ownerTable)},s.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},s.prototype.applyTableOptions=function(e){this.sameAsTableCheckBox.checked||(e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value)},s.prototype.destroy=function(){if(!(0,a.le)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.sameAsTableCheckBox=void 0},s.getCellMarginDialogElements=function(e,t,i,n){if(!(0,a.le)(e)){var r=(0,a.az)("div"),o=(0,a.az)("div",{className:"e-de-container-row"}),l=(0,a.az)("div",{className:"e-de-subcontainer-left"}),h=(0,a.az)("input",{attrs:{type:"text"},styles:"width:100%"});l.appendChild(h);var d=(0,a.az)("div",{className:"e-de-subcontainer-right"}),c=(0,a.az)("input",{attrs:{type:"text"},styles:"width:100%"});d.appendChild(c),o.appendChild(l),o.appendChild(d);var u=(0,a.az)("div",{className:n?"e-de-dlg-row":"e-de-container-row"}),p=(0,a.az)("div",{className:"e-de-subcontainer-left"}),f=(0,a.az)("input",{attrs:{type:"text"},styles:"width:100%"});p.appendChild(f);var g=(0,a.az)("div",{className:"e-de-subcontainer-right"}),m=(0,a.az)("input",{attrs:{type:"text"},styles:"width:100%"});g.appendChild(m),u.appendChild(p),u.appendChild(g),r.appendChild(o),r.appendChild(u),t.appendChild(r),e.target.appendChild(t),e.topMarginBox=new J.No({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Top"),floatLabelType:"Always"}),e.topMarginBox.appendTo(h),e.leftMarginBox=new J.No({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Left"),floatLabelType:"Always"}),e.leftMarginBox.appendTo(c),e.bottomMarginBox=new J.No({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Bottom"),floatLabelType:"Always"}),e.bottomMarginBox.appendTo(f),e.rightMarginBox=new J.No({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Right"),floatLabelType:"Always"}),e.rightMarginBox.appendTo(m)}},s}(),Tr=function(){function s(e){var t=this;this.modifyStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show(t.styleName,t.localValue.getConstant("Modify Style"))},this.selectHandler=function(i){t.styleName=i.text},this.addNewStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show()},this.documentHelper=e}return s.prototype.getModuleName=function(){return"StylesDialog"},s.prototype.initStylesDialog=function(e,t,i){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_insert_styles",className:"e-de-styles"});var r=e.getConstant("Styles"),o=(0,a.az)("div",{innerHTML:r,className:"e-de-para-dlg-heading"});this.target.appendChild(o);var l=(0,a.az)("div",{className:"e-styles-common"});this.target.appendChild(l);var h=(0,a.az)("div",{className:"e-styles-list"});l.appendChild(h),i&&h.classList.add("e-de-rtl");var d=(0,a.az)("div",{className:"e-styles-listViewDiv",id:"styles_listview"});h.appendChild(d),this.listviewInstance=new pt.Bv({dataSource:t,cssClass:"e-styles-listview"}),this.listviewInstance.appendTo(d),this.listviewInstance.addEventListener("select",this.selectHandler);var c=(0,a.az)("div",{className:"e-styles-button"});l.appendChild(c);var u=(0,a.az)("div",{className:"e-styles-addbutton"});c.appendChild(u);var p=(0,a.az)("button",{innerHTML:e.getConstant("New")+"...",id:"new",attrs:{type:"button"}});u.appendChild(p),new M.zx({cssClass:"e-button-custom"}).appendTo(p),p.addEventListener("click",this.addNewStyles);var g=(0,a.az)("div",{className:"e-styles-addbutton"});c.appendChild(g);var m=(0,a.az)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});g.appendChild(m),new M.zx({cssClass:"e-button-custom"}).appendTo(m),m.addEventListener("click",this.modifyStyles)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);var t=this.updateStyleNames();this.localValue=e,this.initStylesDialog(e,t,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.header=e.getConstant("Styles"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.hideObjects.bind(this),buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},s.prototype.updateStyleNames=function(){var e=this.documentHelper.owner.documentHelper.styles.getStyleNames("Paragraph"),i=this.defaultStyleName(["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"]);return e.concat(i).filter(function(r,o,l){return l.indexOf(r)===o})},s.prototype.defaultStyleName=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t},s.prototype.hideObjects=function(){this.documentHelper.dialog.hide(),this.documentHelper.updateFocus()},s.prototype.destroy=function(){this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0,this.styleName=void 0,this.localValue=void 0,this.target=void 0},s}(),Sr=function(){function s(e){var t=this;this.selectHandler=function(i){t.selectedText=i.text},this.onCancelButtonClick=function(){t.documentHelper.clearSelectionHighlight(),t.documentHelper.hideDialog()},this.onIgnoreClicked=function(){(0,a.le)(t.elementBox)||((0,se.yh)(t.documentHelper.dialog.element),t.parent.spellChecker.manageReplace("Ignore Once",t.elementBox),t.removeErrors(),t.parent.spellChecker.checkForNextError(),(0,se.v3)(t.documentHelper.dialog.element))},this.onIgnoreAllClicked=function(){(0,a.le)(t.elementBox)||((0,se.yh)(t.documentHelper.dialog.element),t.parent.spellChecker.handleIgnoreAllItems({element:t.elementBox,text:t.elementBox.text}),t.parent.spellChecker.checkForNextError(),(0,se.v3)(t.documentHelper.dialog.element))},this.addToDictClicked=function(){(0,a.le)(t.elementBox)||((0,se.yh)(t.documentHelper.dialog.element),t.parent.spellChecker.handleAddToDictionary({element:t.elementBox,text:t.elementBox.text}),t.parent.spellChecker.errorWordCollection.containsKey(t.errorText)&&t.parent.spellChecker.errorWordCollection.remove(t.errorText),t.parent.spellChecker.checkForNextError(),t.documentHelper.hideDialog())},this.changeButtonClicked=function(){(0,a.le)(t.selectedText)||(t.isSpellChecking=!0,(0,se.yh)(t.documentHelper.dialog.element),t.parent.spellChecker.manageReplace(t.selectedText,t.elementBox),t.removeErrors(),t.parent.spellChecker.checkForNextError(),t.documentHelper.dialog.content="",(0,se.v3)(t.documentHelper.dialog.element))},this.changeAllButtonClicked=function(){if(!(0,a.le)(t.selectedText)){t.isSpellChecking=!0,(0,se.yh)(t.documentHelper.dialog.element);for(var i=t.parent.spellChecker.errorWordCollection.get(t.errorText),n=0;n<i.length;n++)if(i[n]instanceof wt&&!i[n].ischangeDetected)t.parent.spellChecker.manageReplace(t.selectedText,i[n]);else if(i[n]instanceof S){var r=t.parent.spellChecker.getMatchedResultsFromElement(i[n]),o=r.textResults,l=i[n].ischangeDetected?i[n].start.offset:i[n].line.getOffset(i[n],0);t.parent.searchModule.textSearch.updateMatchedTextLocation(r.matches,o,r.elementInfo,0,i[n],!1,null,l);for(var h=0;h<o.length;h++){var d=t.parent.spellChecker.createErrorElementWithInfo(o.innerList[h],i[n]);t.parent.spellChecker.manageReplace(t.selectedText,d)}}t.parent.spellChecker.errorWordCollection.containsKey(t.errorText)&&t.parent.spellChecker.errorWordCollection.remove(t.errorText),t.parent.spellChecker.checkForNextError(),t.documentHelper.dialog.content="",(0,se.v3)(t.documentHelper.dialog.element)}},this.documentHelper=e,(0,se.rj)({target:this.documentHelper.dialog.element,cssClass:"e-spin-overlay"})}return Object.defineProperty(s.prototype,"parent",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"SpellCheckDialog"},s.prototype.removeErrors=function(){if(!(0,a.le)(this.errorText)&&this.parent.spellChecker.errorWordCollection.containsKey(this.errorText)){var e=this.parent.spellChecker.errorWordCollection.get(this.errorText);e.splice(0,1),0===e.length&&this.parent.spellChecker.errorWordCollection.remove(this.errorText)}0===this.parent.spellChecker.errorWordCollection.length&&this.documentHelper.hideDialog()},s.prototype.show=function(e,t){this.target=void 0,this.localValue=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale),this.localValue.setLocale(this.documentHelper.owner.locale),this.target||this.updateSuggestionDialog(e,t)},s.prototype.updateSuggestionDialog=function(e,t){var n,i=this;this.elementBox=t,this.isSpellChecking?this.parent.spellChecker.callSpellChecker(this.parent.spellChecker.languageID,e,!1,!0).then(function(r){var o=JSON.parse(r);n=o.Suggestions,i.isSpellChecking=!1,i.handleRetrievedSuggestion(e,n)}):(e=this.parent.spellChecker.manageSpecialCharacters(e,void 0,!0),n=this.parent.spellChecker.errorSuggestions.containsKey(e)?this.parent.spellChecker.errorSuggestions.get(e):[],this.handleRetrievedSuggestion(e,n))},s.prototype.handleRetrievedSuggestion=function(e,t){e=this.parent.spellChecker.manageSpecialCharacters(e,void 0,!0),this.initSpellCheckDialog(this.localValue,e,t),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=this.localValue.getConstant("Spelling Editor"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onCancelButtonClick,buttonModel:{content:this.localValue.getConstant("Cancel"),cssClass:"e-control e-flat",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),(0,se.v3)(this.documentHelper.dialog.element)},s.prototype.initSpellCheckDialog=function(e,t,i,n){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_add_SpellCheck",className:"e-de-insert-spellchecker"}),this.errorText=t;var o=(0,a.az)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Spelling")});this.target.appendChild(o);var l=(0,a.az)("div",{className:"e-de-spellcheck-error-container"}),h=(0,a.az)("div",{className:"e-de-dlg-spellcheck-listview"});l.appendChild(h),this.spellingListView=new pt.Bv({dataSource:[t],cssClass:"e-dlg-spellcheck-listitem"}),this.spellingListView.appendTo(h);var d=(0,a.az)("div",{className:"e-de-spellcheck-btncontainer"});l.appendChild(d);var c=(0,a.az)("button",{innerHTML:e.getConstant("Ignore")});d.appendChild(c),new M.zx({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(c),c.addEventListener("click",this.onIgnoreClicked);var p=(0,a.az)("button",{innerHTML:e.getConstant("Ignore All")});d.appendChild(p),new M.zx({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(p),p.addEventListener("click",this.onIgnoreAllClicked);var g=(0,a.az)("button",{innerHTML:e.getConstant("Add to Dictionary")});d.appendChild(g),new M.zx({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(g),g.addEventListener("click",this.addToDictClicked),this.target.appendChild(l);var v=(0,a.az)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Suggestions")});this.target.appendChild(v);var y=(0,a.az)("div",{className:"e-de-spellcheck-suggestion-container"});this.target.appendChild(y);var b=(0,a.az)("div",{className:"e-de-dlg-spellcheck-listview"});y.appendChild(b),this.suggestionListView=new pt.Bv({dataSource:i,cssClass:"e-dlg-spellcheck-listitem"}),this.suggestionListView.appendTo(b),this.suggestionListView.addEventListener("select",this.selectHandler);var C=(0,a.az)("div",{className:"e-de-spellcheck-btncontainer"});y.appendChild(C);var F=(0,a.az)("button",{innerHTML:e.getConstant("Change")});C.appendChild(F);var T=new M.zx({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"});T.appendTo(F),F.addEventListener("click",this.changeButtonClicked);var x=(0,a.az)("button",{innerHTML:e.getConstant("Change All")});C.appendChild(x);var P=new M.zx({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"});P.appendTo(x),x.addEventListener("click",this.changeAllButtonClicked),((0,a.le)(i)||0===i.length)&&(T.disabled=!0,P.disabled=!0)},s.prototype.destroy=function(){this.target&&(this.target.remove(),this.target=void 0),this.elementBox&&(this.elementBox.destroy(),this.elementBox=void 0),this.documentHelper=void 0,this.spellingListView&&(this.spellingListView.destroy(),this.spellingListView=void 0),this.suggestionListView&&(this.suggestionListView.destroy(),this.suggestionListView=void 0)},s}(),es=function(){function s(e){var t=this;this.changeBidirectional=function(i){"exact"===i.value?(t.autoButton.checked=!t.exactButton.checked,t.exactlyNumber.enabled=!0):(t.exactButton.checked=!t.autoButton.checked,t.exactlyNumber.enabled=!1)},this.changeBidirect=function(i){"check"===i.value?t.notCheckedButton.checked=!t.checkedButton.checked:t.checkedButton.checked=!t.notCheckedButton.checked},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertCheckBoxField=function(){t.closeCheckBoxField();var i=new qe;i.defaultValue=t.checkedButton.checked,i.name=t.bookmarkInputText.value,i.helpText=t.tooltipInputText.value,i.checked=i.defaultValue,i.enabled=t.checBoxEnableElement.checked,t.exactButton.checked?(i.sizeType="Exactly",i.size=t.exactlyNumber.value):(i.sizeType="Auto",i.size=11),t.owner.editor.editFormField("CheckBox",i)},this.closeCheckBoxField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(s.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"CheckBoxFormFieldDialog"},s.prototype.initCheckBoxDialog=function(e,t){this.target=(0,a.az)("div");var i=(0,a.az)("div"),n=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Check box size")}),r=(0,a.az)("div",{className:"e-de-container-row"}),o=(0,a.az)("div",{className:"e-de-ff-radio-scnd-div"}),l=(0,a.az)("div",{className:"e-de-ff-radio-scnd-div"}),h=(0,a.az)("input",{className:"e-de-rtl-btn-div"}),d=(0,a.az)("input",{className:"e-de-rtl-btn-div"});this.autoButton=new M.EU({label:e.getConstant("Auto"),cssClass:"e-small",change:this.changeBidirectional,checked:!0,enableRtl:t}),this.exactButton=new M.EU({label:e.getConstant("Exactly"),value:"exact",cssClass:"e-small",change:this.changeBidirectional,enableRtl:t}),this.exactNumberDiv=(0,a.az)("div",{className:"e-de-ff-chck-exact"});var c=(0,a.az)("input",{attrs:{type:"text"}});this.exactlyNumber=new J.No({format:"n",value:10,min:1,max:1584,enablePersistence:!1,enabled:!1,cssClass:"e-de-check-exactnumbr-width",enableRtl:t});var u=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default value")}),p=(0,a.az)("div",{className:"e-de-container-row"}),f=(0,a.az)("div",{className:"e-de-ff-radio-div"}),g=(0,a.az)("div",{className:"e-de-ff-radio-div"}),m=(0,a.az)("input",{className:"e-de-rtl-btn-div"}),v=(0,a.az)("input",{className:"e-de-rtl-btn-div"});this.notCheckedButton=new M.EU({label:e.getConstant("Not checked"),enableRtl:t,cssClass:"e-small",change:this.changeBidirect}),this.checkedButton=new M.EU({label:e.getConstant("Checked"),value:"check",enableRtl:t,cssClass:"e-small",change:this.changeBidirect,checked:!0});var y=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),b=(0,a.az)("div",{className:"e-de-container-row"}),C=(0,a.az)("div",{className:"e-de-subcontainer-left"}),F=(0,a.az)("div",{className:"e-de-subcontainer-right"});this.tooltipInputText=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkInputText=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"});var T=(0,a.az)("div"),x=(0,a.az)("input",{attrs:{type:"checkbox"}});this.checBoxEnableElement=new M.Jg({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Check box enabled"),enableRtl:t}),t&&(o.classList.add("e-de-rtl"),l.classList.add("e-de-rtl"),this.exactNumberDiv.classList.add("e-de-rtl"),f.classList.add("e-de-rtl"),g.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),F.classList.add("e-de-rtl")),this.target.appendChild(i),i.appendChild(u),i.appendChild(p),p.appendChild(f),f.appendChild(m),this.notCheckedButton.appendTo(m),p.appendChild(g),g.appendChild(v),this.checkedButton.appendTo(v),i.appendChild(n),i.appendChild(r),r.appendChild(o),o.appendChild(h),this.autoButton.appendTo(h),r.appendChild(l),l.appendChild(d),this.exactButton.appendTo(d),l.appendChild(this.exactNumberDiv),this.exactNumberDiv.appendChild(c),this.exactlyNumber.appendTo(c),i.appendChild(y),i.appendChild(b),b.appendChild(C),b.appendChild(F),C.appendChild(this.tooltipInputText),F.appendChild(this.bookmarkInputText),i.appendChild(T),T.appendChild(x),this.checBoxEnableElement.appendTo(x),new J.zC({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInputText),new J.zC({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInputText)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),(0,a.le)(this.target)&&this.initCheckBoxDialog(e,this.documentHelper.owner.enableRtl),this.loadCheckBoxDialog(),this.documentHelper.dialog.header=e.getConstant("Check Box Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="400px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertCheckBoxField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},s.prototype.loadCheckBoxDialog=function(){var e=this.owner.selection.getCurrentFormField();if(e instanceof H){this.fieldBegin=e;var t=this.fieldBegin.formFieldData;t.defaultValue?(this.checkedButton.checked=!0,this.notCheckedButton.checked=!1):(this.checkedButton.checked=!1,this.notCheckedButton.checked=!0),"Auto"!==t.sizeType?(this.exactButton.checked=!0,this.autoButton.checked=!1,this.exactlyNumber.enabled=!0):(this.autoButton.checked=!0,this.exactButton.checked=!1,this.exactlyNumber.enabled=!1),t.size&&(this.exactlyNumber.value=t.size),this.checBoxEnableElement.checked=!!t.enabled,this.bookmarkInputText.value=t.name&&""!==t.name?t.name:"",this.tooltipInputText.value=t.helpText&&""!==t.helpText?t.helpText:""}},s.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.autoButton&&(this.autoButton.destroy(),this.autoButton=void 0),this.exactButton&&(this.exactButton.destroy(),this.exactButton=void 0),this.notCheckedButton&&(this.notCheckedButton.destroy(),this.notCheckedButton=void 0),this.checkedButton&&(this.checkedButton.destroy(),this.checkedButton=void 0),this.bookmarkInputText=void 0,this.tooltipInputText=void 0,this.checBoxEnableElement&&(this.checBoxEnableElement.destroy(),this.checBoxEnableElement=void 0),this.exactlyNumber&&(this.exactlyNumber.destroy(),this.exactlyNumber=void 0),this.exactNumberDiv=void 0},s}(),ts=function(){function s(e){var t=this;this.updateTextFormtas=function(){var i=t.updateFormats(t.defaultTextInput.value);t.defaultTextInput.value=(0,a.le)(i)?"":i},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertTextField=function(){var i=!0;if("Date"===t.typeDropDown.value&&(i=t.isValidDateFormat()),i)if(t.updateTextFormtas(),t.defaultTextInput.value.length>t.maxLengthNumber.value&&!(0,a.le)(t.maxLengthNumber.value)&&0!==t.maxLengthNumber.value)se.hZ.alert({content:"The maximum length value must be equal or greater than the length of the default text.",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}});else{var n;n="Date"===t.typeDropDown.value?"Date":"Number"===t.typeDropDown.value?"Number":"Text";var r=t.textFormatDropDown.value,o=new Re;o.type=n,o.defaultValue=t.defaultTextInput.value,o.maxLength=t.maxLengthNumber.value,o.format=(0,a.le)(r)?"":r,o.name=t.bookmarkTextInput.value,o.helpText=t.tooltipTextInput.value,o.enabled=t.fillInEnable.checked,t.owner.editor.editFormField("Text",o),t.closeTextField()}else se.hZ.alert({content:"A valid date or time is required",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}})},this.closeTextField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(s.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"TextFormFieldDialog"},s.prototype.initTextDialog=function(e,t){var i=this;this.target=(0,a.az)("div");var n=(0,a.az)("div"),r=(0,a.az)("div",{className:"e-de-container-row"}),o=(0,a.az)("div",{className:"e-de-subcontainer-left"});this.defaultTextDiv=(0,a.az)("div",{className:"e-de-subcontainer-right"});var l=[{Value:"Regular text",Name:e.getConstant("Regular text")},{Value:"Number",Name:e.getConstant("Number")},{Value:"Date",Name:e.getConstant("Date")}],h=(0,a.az)("input");this.typeDropDown=new Te.NB({dataSource:l,popupHeight:"150px",value:"Regular text",change:this.changeTypeDropDown.bind(this),floatLabelType:"Always",placeholder:e.getConstant("Type"),fields:{text:"Name",value:"Value"}}),this.defaultTextInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"});var d=(0,a.az)("div",{className:"e-de-container-row"}),c=(0,a.az)("div",{className:"e-de-subcontainer-left"}),u=(0,a.az)("input");this.maxLengthNumber=new J.No({format:"n",value:0,min:0,max:32767,width:"100%",enablePersistence:!1,placeholder:e.getConstant("Maximum length"),floatLabelType:"Always",change:function(T){T.value||(this.element.value=e.getConstant("Unlimited"))},focus:function(T){T.value||(this.element.value=e.getConstant("Unlimited"))},blur:function(T){if(!T.value){var x=this;setTimeout(function(){x.element.value=e.getConstant("Unlimited")},0)}}});var p=(0,a.az)("div",{className:"e-de-subcontainer-right"}),f=(0,a.az)("input"),g=[{Value:"Uppercase",Name:e.getConstant("Uppercase")},{Value:"Lowercase",Name:e.getConstant("Lowercase")},{Value:"FirstCapital",Name:e.getConstant("FirstCapital")},{Value:"Titlecase",Name:e.getConstant("TitleCase")}];this.textFormatDropDown=new Te.Ct({dataSource:g,popupHeight:"150px",allowCustom:!0,showClearButton:!1,change:this.updateTextFormtas.bind(this),placeholder:e.getConstant("Text format"),floatLabelType:"Always",fields:{text:"Name",value:"Value"}}),this.textFormatDropDown.focus=function(){i.textFormatDropDown.element.select()};var m=(0,a.az)("div",{className:"e-de-ff-dlg-heading",innerHTML:e.getConstant("Field settings")}),v=(0,a.az)("div",{className:"e-de-container-row"}),y=(0,a.az)("div",{className:"e-de-subcontainer-left"}),b=(0,a.az)("div",{className:"e-de-subcontainer-right"});this.tooltipTextInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkTextInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"});var C=(0,a.az)("div"),F=(0,a.az)("input",{attrs:{type:"checkbox"}});this.fillInEnable=new M.Jg({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Fillin enabled"),enableRtl:t}),t&&(o.classList.add("e-de-rtl"),c.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"),b.classList.add("e-de-rtl")),this.target.appendChild(n),n.appendChild(r),r.appendChild(o),o.appendChild(h),this.typeDropDown.appendTo(h),r.appendChild(this.defaultTextDiv),this.defaultTextDiv.appendChild(this.defaultTextInput),n.appendChild(d),d.appendChild(c),c.appendChild(u),this.maxLengthNumber.appendTo(u),d.appendChild(p),p.appendChild(f),this.textFormatDropDown.appendTo(f),n.appendChild(m),n.appendChild(v),v.appendChild(y),y.appendChild(this.tooltipTextInput),v.appendChild(b),b.appendChild(this.bookmarkTextInput),n.appendChild(C),C.appendChild(F),this.fillInEnable.appendTo(F),this.defaultTextLabel=new J.zC({placeholder:e.getConstant("Default text"),floatLabelType:"Always"},this.defaultTextInput),new J.zC({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipTextInput),new J.zC({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkTextInput)},s.prototype.show=function(){this.localObj=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),(0,a.le)(this.target)&&this.initTextDialog(this.localObj,this.documentHelper.owner.enableRtl),this.loadTextDialog(this.localObj),this.documentHelper.dialog.header=this.localObj.getConstant("Text Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertTextField,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},s.prototype.changeTypeDropDown=function(e){e.isInteracted&&(this.defaultTextInput.value="",this.textFormatDropDown.value=""),"Regular text"===e.value?(this.textFormatDropDown.fields={text:"Name",value:"Value"},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default text"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Text format"),this.textFormatDropDown.dataSource=[{Value:"Uppercase",Name:this.localObj.getConstant("Uppercase")},{Value:"Lowercase",Name:this.localObj.getConstant("Lowercase")},{Value:"FirstCapital",Name:this.localObj.getConstant("FirstCapital")},{Value:"Titlecase",Name:this.localObj.getConstant("Titlecase")}]):"Number"===e.value?(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default number"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Number format"),this.textFormatDropDown.dataSource=["0","0.00","#,##0","#,##0.00","$#,##0.00;($#,##0.00)","0%"]):"Date"===e.value&&(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default date"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Date format"),this.textFormatDropDown.dataSource=["M/d/yyyy","dddd, MMMM d, yyyy","MMMM d, yyyy","M/d/yy","yyyy-MM-dd","d-MMM-yy","M.d.yyyy","MMM. d, yy","d MMMM yyyy","MMMM yy","MMM-yy","M/d/yyyy h:mm am/pm","M/d/yyyy h:mm:ss am/pm","h:mm am/pm","h:mm:ss am/pm","HH:mm","HH:mm:ss"]),this.defaultTextLabel.dataBind(),this.textFormatDropDown.dataBind()},s.prototype.loadTextDialog=function(e){var t=this.owner.selection.getCurrentFormField();if(t instanceof H){this.fieldBegin=t;var i=t.formFieldData;i.maxLength>0?this.maxLengthNumber.value=i.maxLength:(this.maxLengthNumber.value=0,this.maxLengthNumber.element.value=e?e.getConstant("Unlimited"):"Unlimited"),this.typeDropDown.value="Date"===i.type?"Date":"Number"===i.type?"Number":"Regular text",this.textFormatDropDown.value=i.format?i.format:"",this.defaultTextInput.value=(0,a.le)(i.defaultValue)?"":i.defaultValue,this.fillInEnable.checked=i.enabled,this.tooltipTextInput.value=(0,a.le)(i.helpText)?"":i.helpText,this.bookmarkTextInput.value=(0,a.le)(i.name)?"":i.name}},s.prototype.updateFormats=function(e){var t=(0,a.le)(this.textFormatDropDown.value)?"":this.textFormatDropDown.value.toString();if("Regular text"===this.typeDropDown.value)return w.formatText(t,e);if("Number"===this.typeDropDown.value){var i=w.formatNumber(t,e);return"NaN"!==i.toString()?i:""}return"Date"===this.typeDropDown.value?w.formatDate(t,e):""},s.prototype.isValidDateFormat=function(){var e=this.defaultTextInput.value;if(""!==e){var t=new Date(e);if(isNaN(t.getDate()))return!1}return!0},s.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.maxLengthNumber&&(this.maxLengthNumber.destroy(),this.maxLengthNumber=void 0),this.fillInEnable&&(this.fillInEnable.destroy(),this.fillInEnable=void 0),this.typeDropDown&&(this.typeDropDown.destroy(),this.typeDropDown=void 0),this.textFormatDropDown&&(this.textFormatDropDown.destroy(),this.textFormatDropDown=void 0),this.owner=void 0,this.defaultTextInput=void 0,this.tooltipTextInput=void 0,this.bookmarkTextInput=void 0,this.defaultTextLabel=void 0,this.defaultTextDiv=void 0,this.textFormatLabel=void 0},s}(),is=function(){function s(e){var t=this;this.addItemtoList=function(){t.dropDownItems.push(t.drpDownItemsInput.value),t.currentSelectedItem=t.drpDownItemsInput.value,t.drpDownItemsInput.value="",t.enableOrDisableButton(),t.updateList()},this.removeItemFromList=function(){for(var i=0;i<t.dropDownItems.length;i++)t.dropDownItems[i]===t.currentSelectedItem&&t.dropDownItems.splice(i,1);t.updateList()},this.selectHandler=function(i){t.currentSelectedItem=i.text},this.moveUpItem=function(){var i=t.getSelectedIndex();t.moveUp(i,i-1),t.updateList()},this.moveDownItem=function(){var i=t.getSelectedIndex();t.moveDown(i,i+1),t.updateList()},this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertDropDownField=function(){var i=new Ge;i.dropdownItems=t.dropDownItems,i.selectedIndex=0,i.name=t.bookmarkInput.value,i.helpText=t.tooltipInput.value,i.enabled=t.dropDownEnable.checked,t.owner.editor.editFormField("DropDown",i),t.closeDropDownField()},this.closeDropDownField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(s.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"DropDownFormFieldDialog"},s.prototype.initTextDialog=function(e,t){this.target=(0,a.az)("div");var i=(0,a.az)("div"),n=(0,a.az)("div",{className:"e-de-drp-dwn-frst-div"});this.drpDownItemsInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input",id:"fielditems_text_box"}),this.drpDownItemsInput.addEventListener("keyup",this.onKeyUpOnTextBox);var r=(0,a.az)("div",{className:"e-de-ff-drpdwn-dlg-scndiv"}),o=(0,a.az)("div",{className:"e-de-ff-dlg-drpdwn-heading",innerHTML:e.getConstant("Items in dropdown list")}),l=(0,a.az)("div",{className:"e-bookmark-listViewDiv e-de-ff-drpdwn-listview",attrs:{style:"height:100%"}});this.listviewInstance=new pt.Bv({cssClass:"e-bookmark-listview",select:this.selectHandler});var h=(0,a.az)("div"),d=(0,a.az)("div",{className:"e-bookmark-addbutton"}),c=(0,a.az)("button",{innerHTML:e.getConstant("ADD"),attrs:{type:"button",style:"height:36px;width:100%"}});this.addButton=new M.zx({cssClass:"e-button-custom"}),this.addButton.disabled=!0,c.addEventListener("click",this.addItemtoList.bind(this));var u=(0,a.az)("div",{className:"e-bookmark-addbutton"});u.style.display="none";var p=(0,a.az)("button",{innerHTML:"EDIT",attrs:{type:"button",style:"height:36px;width:100%"}});this.editButton=new M.zx({cssClass:"e-button-custom"});var f=(0,a.az)("div",{className:"e-bookmark-addbutton"}),g=(0,a.az)("button",{innerHTML:e.getConstant("REMOVE"),attrs:{type:"button",style:"height:36px;width:100%"}});this.removeButton=new M.zx({cssClass:"e-button-custom"}),g.addEventListener("click",this.removeItemFromList.bind(this));var m=(0,a.az)("div",{attrs:{style:"display:inline-flex"}}),v=(0,a.az)("div",{className:"e-bookmark-addbutton"}),y=(0,a.az)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvup"});this.moveUpButton=new M.zx({cssClass:"e-button-custom",iconCss:"e-de-arrow-up"}),y.addEventListener("click",this.moveUpItem.bind(this));var b=(0,a.az)("div",{className:"e-bookmark-addbutton"}),C=(0,a.az)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvdn"});this.moveDownButton=new M.zx({cssClass:"e-button-custom",iconCss:"e-de-arrow-down"}),C.addEventListener("click",this.moveDownItem.bind(this));var F=(0,a.az)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),T=(0,a.az)("div",{className:"e-de-container-row"}),x=(0,a.az)("div",{className:"e-de-subcontainer-left"}),P=(0,a.az)("div",{className:"e-de-subcontainer-right"});this.tooltipInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkInput=(0,a.az)("input",{className:"e-input e-bookmark-textbox-input"});var E=(0,a.az)("div"),L=(0,a.az)("input",{attrs:{type:"checkbox"}});this.dropDownEnable=new M.Jg({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Dropdown enabled"),enableRtl:t}),t&&(l.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"),x.classList.add("e-de-rtl"),P.classList.add("e-de-rtl")),this.target.appendChild(i),i.appendChild(n),n.appendChild(this.drpDownItemsInput),i.appendChild(o),i.appendChild(r),r.appendChild(l),this.listviewInstance.appendTo(l),r.appendChild(h),h.appendChild(d),d.appendChild(c),this.addButton.appendTo(c),h.appendChild(u),u.appendChild(p),this.editButton.appendTo(p),h.appendChild(f),f.appendChild(g),this.removeButton.appendTo(g),h.appendChild(m),m.appendChild(v),v.appendChild(y),this.moveUpButton.appendTo(y),m.appendChild(b),b.appendChild(C),this.moveDownButton.appendTo(C),i.appendChild(F),i.appendChild(T),T.appendChild(x),x.appendChild(this.tooltipInput),T.appendChild(P),P.appendChild(this.bookmarkInput),i.appendChild(E),E.appendChild(L),this.dropDownEnable.appendTo(L),new J.zC({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInput),new J.zC({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInput),new J.zC({placeholder:e.getConstant("Dropdown items"),floatLabelType:"Always"},this.drpDownItemsInput)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),(0,a.le)(this.target)&&this.initTextDialog(e,this.documentHelper.owner.enableRtl),this.loadDropDownDialog(),this.documentHelper.dialog.header=e.getConstant("Drop Down Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertDropDownField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},s.prototype.loadDropDownDialog=function(){var e=this.owner.selection.getCurrentFormField();e instanceof H&&(this.fieldBegin=e,this.dropDownInstance=e.formFieldData,this.dropDownInstance.dropdownItems.length>0&&(this.currentSelectedItem=this.dropDownInstance.dropdownItems[this.dropDownInstance.selectedIndex]),this.dropDownInstance.enabled?this.dropDownEnable.checked=!0:this.dropDownEnable.disabled=!1,this.tooltipInput.value=""!==this.dropDownInstance.helpText?this.dropDownInstance.helpText:"",this.bookmarkInput.value=""!==this.dropDownInstance.name?this.dropDownInstance.name:"",this.dropDownItems=this.dropDownInstance.dropdownItems.slice(),this.updateList())},s.prototype.updateList=function(){this.listviewInstance.dataSource=this.dropDownItems.slice(),this.listviewInstance.dataBind(),this.currentSelectedItem&&this.listviewInstance.selectItem(this.currentSelectedItem)},s.prototype.getSelectedIndex=function(){for(var e=0;e<this.dropDownItems.length;e++)if(this.dropDownItems[e]===this.currentSelectedItem)return e;return 0},s.prototype.moveUp=function(e,t){var i=[];if(0===e){for(var n=0;n<this.dropDownItems.length;n++)i[n]=n<this.dropDownItems.length-1?this.dropDownItems[n+1]:this.dropDownItems[0];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},s.prototype.moveDown=function(e,t){var i=[];if(e===this.dropDownItems.length-1){for(var n=0;n<this.dropDownItems.length;n++)i[n]=0!==n?this.dropDownItems[n-1]:this.dropDownItems[this.dropDownItems.length-1];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},s.prototype.enableOrDisableButton=function(){(0,a.le)(this.addButton)||(this.addButton.disabled=""===this.drpDownItemsInput.value)},s.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.drpDownItemsInput=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.editButton&&(this.editButton.destroy(),this.editButton=void 0),this.removeButton&&(this.removeButton.destroy(),this.removeButton=void 0),this.moveUpButton&&(this.moveUpButton.destroy(),this.moveUpButton=void 0),this.moveDownButton&&(this.moveDownButton.destroy(),this.moveDownButton=void 0),this.tooltipInput=void 0,this.bookmarkInput=void 0,this.dropDownEnable&&(this.dropDownEnable.destroy(),this.dropDownEnable=void 0),this.dropDownInstance=void 0},s}(),Z=function(){function s(e){this.location=new ce(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(s.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCurrentParaBidi",{get:function(){return!(0,a.le)(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.clone=function(){var e=new s(this.owner);return e.currentWidget=this.currentWidget,e.offset=this.offset,e.location=this.location,e},s.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},s.prototype.setPositionForSelection=function(e,t,i,n){var r=!1;(0,a.le)(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof H&&i>t.length&&(r=this.selection.isLastRenderedInline(t,t.length))),this.location=n,this.offset=r?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},s.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof ce&&this.location.copy(i)},s.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},s.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},s.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},s.prototype.getPage=function(e){var i=e.index.indexOf(";"),n="0";return i>=0&&(n=e.index.substring(0,i),e.index=e.index.substring(i).replace(";","")),i=parseInt(n,10),this.documentHelper.pages[i]},s.prototype.getParagraphWidget=function(e){if(!(0,a.le)(e.index)){var t=this.getPage(e);return this.getLineWidget(void 0,e,t)}},s.prototype.getLineWidget=function(e,t,i){if(!(0,a.le)(t.index)){var n=t.index.indexOf(";"),r="0";if(n>=0&&(r=t.index.substring(0,n),t.index=t.index.substring(n).replace(";","")),"H"===r||"F"===r)e="H"===r?i.headerWidget:i.footerWidget;else if("FN"===r||"EN"===r){var o=t.index.indexOf(";"),l=t.index.substring(0,o);t.index=t.index.substring(o).replace(";",""),e="FN"===r?i.footnoteWidget.bodyWidgets[l]:i.endnoteWidget.bodyWidgets[l]}else(0,a.le)(i)||(e=i.bodyWidgets[0]);if(n=parseInt(r,10),e instanceof Ye&&(n=t.index.indexOf(";"),r="0",r=t.index.substring(0,n),t.index=t.index.substring(n).replace(";",""),n=parseInt(r,10)),e instanceof Q&&n>=e.childWidgets.length&&(t.index="0;0",n=e.childWidgets.length-1),n>=0&&n<e.childWidgets.length){var h=e.childWidgets[n];if(h instanceof oe)return t.index.indexOf(";")>0&&(t.index="0"),h;if(h instanceof Ze)return t.index.indexOf(";")>0?this.getLineWidget(h,t):h instanceof k?this.getLineWidget(this.selection.getFirstParagraphInFirstCell(h),t):h instanceof Q&&-1===t.index.indexOf(";")?this.selection.getFirstParagraphInFirstCell(h.ownerTable).childWidgets[0]:void 0}else if(e.nextRenderedWidget instanceof Ze)return t.index="0",e.nextRenderedWidget instanceof k?this.selection.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},s.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},s.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},s.prototype.isInSameParagraphIndex=function(e){if((0,a.le)(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},s.prototype.isInSameParagraph=function(e){if((0,a.le)(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},s.prototype.isExistBefore=function(e){if((0,a.le)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return t===i?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(e.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistBefore(t,i)},s.prototype.isExistAfter=function(e){if((0,a.le)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return!(0,a.le)(t)&&!(0,a.le)(i)&&(t.containerWidget instanceof j&&i.containerWidget instanceof j&&t.containerWidget===i.containerWidget?t.isInsideTable&&i.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)>i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistAfter(t,i))},s.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},s.prototype.getHierarchicalIndex=function(e,t){return e?e.getHierarchicalIndex(t):t},s.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},s.prototype.setPositionForLineWidget=function(e,t){var i=this.selection.getLineLength(e),n=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&((0,a.le)(e.paragraph.bodyWidget.footNoteReference)?i+=1:i+=e.paragraph.bodyWidget.footNoteReference.text.length),t>i){var r=void 0;if(n>=e.paragraph.childWidgets.length-1){var o=this.selection.getNextRenderedBlock(e.paragraph);o&&o.index===e.paragraph.index&&(r=o.firstChild)}else r=e.paragraph.childWidgets[n+1];this.setPositionForLineWidget(r,t-i)}else if(t<0){var l=e.paragraph.childWidgets[n-1],h=this.selection.getLineLength(l)+t;this.setPositionForLineWidget(l,h)}else this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},s.prototype.moveNextPosition=function(e){(0,a.le)(e)&&(e=!0);var t=this.selection.getNextStartInline(this.currentWidget,this.offset);if(t instanceof H&&0===t.fieldType&&!(0,a.le)(t.fieldEnd)){if(e)return this.moveNextPositionInternal(t),void this.moveNextPosition();var i=t.fieldEnd.line,r=i.getOffset(t.fieldEnd,1),o=this.getHierarchicalIndex(i,r.toString());if(s.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),o))return void this.selection.end.moveToInline(t.fieldEnd,1);this.moveToInline(t.fieldEnd,1)}var l=this.selection.getNextValidOffset(this.currentWidget,this.offset),h=this.paragraph.childWidgets.indexOf(this.currentWidget),d=0;if(l>this.offset){this.offset=l;var c=this.currentWidget.getInline(this.offset,d);if(d=c.index,!(0,a.le)(t=c.element)&&d===t.length&&(t.nextNode instanceof H||t.nextNode instanceof O)){var u=this.selection.getNextValidElement(t.nextNode);(u instanceof H&&1===u.fieldType||u instanceof O&&1===u.bookmarkType)&&(this.currentWidget=(t=u).line,this.offset=this.currentWidget.getOffset(t,this.documentHelper.isFormFillProtectedMode?0:1))}}else if(h+1<this.paragraph.childWidgets.length){var p=this.paragraph.childWidgets[h+1];p&&(this.currentWidget=p,this.offset=this.selection.getStartLineOffset(this.currentWidget));var f=this.currentWidget.getInline(this.offset,d);d=f.index,(t=f.element)instanceof H&&0===t.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(d,!1);this.updatePhysicalPosition(!0)},s.prototype.moveToPreviousParagraphInTable=function(e){var t,i=this.currentWidget.paragraph;t=i.isInsideTable?e.getPreviousSelectionCell(i.associatedCell):e.getPreviousParagraphBlock(i),!(0,a.le)(t)&&(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},s.prototype.updateOffsetToNextParagraph=function(e,t){var i,n=!1,r=void 0,o=this.paragraph.childWidgets.indexOf(this.currentWidget);if(t)if(o+1<this.paragraph.childWidgets.length){var l=this.paragraph.childWidgets[o+1];l&&(this.currentWidget=l,this.offset=1)}else r=this.selection.getNextSelectionBlock(this.paragraph),!(0,a.le)(r)&&r.containerWidget instanceof V&&(n=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,r.associatedCell).ownerTable.contains(r.associatedCell));else r=this.selection.getNextParagraphBlock(this.paragraph);!(0,a.le)(r)&&r.childWidgets.length>0&&(n?(this.currentWidget=r.childWidgets[r.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=r.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));var d=this.currentWidget.getInline(this.offset,e);e=d.index,(i=d.element)instanceof H&&0===i.fieldType&&this.offset++},s.prototype.updateOffsetToPrevPosition=function(e,t){var n,r=this.paragraph.childWidgets.indexOf(this.currentWidget),o=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>o)this.offset=o;else if(r>0){var l=this.paragraph.childWidgets[r-1];if(l){this.currentWidget=l;var h=this.currentWidget.getEndOffset();this.offset=h>0?h-1:h}}else{var d=void 0,c=!1;t?(d=this.selection.getPreviousSelectionBlock(this.paragraph),!(0,a.le)(d)&&d.containerWidget instanceof V&&(c=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,d.associatedCell).ownerTable.contains(d.associatedCell))):d=this.selection.getPreviousParagraphBlock(this.paragraph),(0,a.le)(d)||(c?(this.currentWidget=d.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=d.childWidgets[d.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))}if((n=this.currentWidget.getInline(this.offset,0).element)instanceof H&&0===n.fieldType&&this.offset++,n instanceof H){var p=this.selection.getPreviousValidElement(n);(0,a.le)(p)||(this.currentWidget=(n=p).line,this.offset=this.currentWidget.getOffset(n,n.length),n instanceof H&&0===n.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},s.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;(0,a.le)(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},s.prototype.movePreviousPosition=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;e=t.index,this.paragraph.childWidgets.indexOf(this.currentWidget),(i instanceof H&&1===i.fieldType&&!(0,a.le)(i.fieldBegin)||i instanceof O&&1===i.bookmarkType)&&this.movePreviousPositionInternal(i),this.updateOffsetToPrevPosition(e,!1)},s.prototype.moveNextPositionInternal=function(e){var t;(0,a.le)(e.fieldSeparator)?t=e.fieldEnd:(this.currentWidget=(t=e.fieldSeparator).line,this.currentWidget===e.fieldEnd.line&&!this.selection.hasValidInline(this.paragraph,t,e.fieldEnd)&&(t=e.fieldEnd)),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},s.prototype.moveBackward=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;if(e=t.index,!this.owner.selection.isEmpty&&!(0,a.le)(i)){var n=this.selection.getNextRenderedElementBox(i,e);if(n instanceof H&&0===n.fieldType){var r=this.owner.selection.start.getHierarchicalIndexInternal(),o=n.fieldEnd.line.getOffset(n.fieldEnd,1),l=this.getHierarchicalIndex(n.fieldEnd.line,o.toString());if(!s.isForwardSelection(l,r))return void this.owner.selection.start.setPositionParagraph(n.fieldEnd.line,o)}}if(i instanceof H&&1===i.fieldType&&!(0,a.le)(i.fieldBegin)){if(r=this.owner.selection.start.getHierarchicalIndexInternal(),o=i.line.getOffset(i,1),l=this.getHierarchicalIndex(i.line,o.toString()),!s.isForwardSelection(r,l)){var h=i.fieldBegin.line.getOffset(i.fieldBegin,0);return this.currentWidget=i.fieldBegin.line,this.offset=h,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(i)}this.updateOffsetToPrevPosition(e,!0)},s.prototype.moveForward=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;if(e=t.index,!(0,a.le)(i)){if(!this.owner.selection.isEmpty&&e===i.length&&i instanceof H&&1===i.fieldType){var n=this.owner.selection.start.getHierarchicalIndexInternal(),r=i.fieldBegin.line.getOffset(i.fieldBegin,0),o=this.getHierarchicalIndex(i.fieldBegin.line,r.toString());if(!s.isForwardSelection(n,o))return void this.owner.selection.start.setPositionParagraph(i.fieldBegin.line,r)}i=this.selection.getNextRenderedElementBox(i,e)}if(i instanceof H&&!(0,a.le)(i.fieldEnd)){var h=0,d=this.owner.selection.start.paragraph.getInline(this.owner.selection.start.offset,h);if(this.selection.getNextRenderedElementBox(d.element,h=d.index)!==i)return this.currentWidget=(i=i.fieldEnd).line,this.offset=this.currentWidget.getOffset(i,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(i)}else i instanceof H&&(0===i.fieldType||1===i.fieldType)&&(this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,1));e=0;var p=this.selection.getNextValidOffset(this.currentWidget,this.offset),f=this.selection.getLineLength(this.currentWidget),g=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<p){this.offset=p;var m=this.currentWidget.getInline(this.offset,e);if(e=m.index,!(0,a.le)(i=m.element)&&e===i.length&&i.nextNode instanceof H){var v=this.selection.getNextValidElement(i.nextNode);v instanceof H&&1===v.fieldType&&(this.offset=this.currentWidget.getOffset(i=v,1))}}else this.offset===p&&i instanceof H&&1===i.fieldType&&i.previousNode instanceof ee?this.offset=p:this.offset===p&&this.offset<f+1&&g?this.offset=f+1:this.updateOffsetToNextParagraph(e,!0);this.updatePhysicalPosition(!0)},s.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},s.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),n=t.split(";"),r=i.length;r>n.length&&(r=n.length-1);for(var o=0;o<r;o++){var l=parseFloat(i[o]),h=parseFloat(n[o]);if(l!==h)return l<h}return!1},s.prototype.movePreviousPositionInternal=function(e){var t;t=e instanceof H&&(0,a.le)(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,t instanceof H||t instanceof O&&1===t.bookmarkType?0:t.length)},s.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),i=this.currentWidget.paragraph,n=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===n.getStartOffset(i)&&this.currentWidget===i.childWidgets[0]){var r=n.getPreviousParagraphBlock(i);if((0,a.le)(r))return;this.currentWidget=r.childWidgets[r.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===n.getStartLineOffset(this.currentWidget)){var o=i.childWidgets.indexOf(this.currentWidget);o-1>=0&&(this.currentWidget=i.childWidgets[o-1],this.offset=this.currentWidget.getEndOffset())}var d=0,c=this.currentWidget.getInline(this.offset,d),u=c.element;this.getPreviousWordOffset(u,n,d=c.index,e,u instanceof H&&1===u.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},s.prototype.getNextWordOffset=function(e,t,i,n,r,o,l){e instanceof S?this.getNextWordOffsetSpan(e,t,i,n,r,o,l):e instanceof ee?this.getNextWordOffsetImage(e,t,i,n,r,o,l):e instanceof H&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,n,r,o,l):e instanceof H&&2===e.fieldType||e instanceof O?this.getNextWordOffsetFieldSeparator(e,t,i,n,r,o,l):e instanceof H&&1===e.fieldType?this.getNextWordOffsetFieldEnd(e,t,i,n,r,o,l):e instanceof ae&&this.getNextWordOffsetComment(e,t,i,n,r,o,l)},s.prototype.getNextWordOffsetFieldBegin=function(e,t,i,n,r,o,l){var h=e.line.getOffset(e,0);if((0,a.le)(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,i,n,r,o,l);else if(0===i)this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,i,n,r,o,l);else if(!(0,a.le)(e.fieldEnd)){var c=e.fieldSeparator;if(c.line.paragraph===e.fieldEnd.line.paragraph&&!this.selection.hasValidInline(c.line.paragraph,c,e.fieldEnd)&&(c=e.fieldEnd),this.getNextWordOffset(c,0,i,!(o.paragraph===e.line.paragraph&&o.offset===h),r,o,l),r&&!(0,a.le)(e.fieldSeparator)&&o.paragraph===e.line.paragraph&&o.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void o.setPositionParagraph(e.line,h);r||o.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},s.prototype.getNextWordOffsetImage=function(e,t,i,n,r,o,l){if(n)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(r=!1);if(0===t){var h=e.line.getOffset(e,0);r=!0,o.offset===h?(0,a.le)(e.nextNode)?o.setPositionParagraph(e.line,h+e.length):this.getNextWordOffset(e.nextNode,0,i,n,r,o,l):o.setPositionParagraph(e.line,h)}else(0,a.le)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)},s.prototype.getNextWordOffsetSpan=function(e,t,i,n,r,o,l){if("\t"===e.text||"\v"===e.text){if(n)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(r=!1);if(0===t){r=!0;var h=e.line.getOffset(e,0);o.setPositionParagraph(e.line,o.offset===h?h+e.length:h)}else(0,a.le)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)}else{var d=0;if(0===t&&r&&-1===w.wordSplitCharacters.indexOf(e.text[0])){if(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),n)return}else if(t<e.length){var c=t>0&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(-1===(d=w.indexOfAny(c,w.wordSplitCharacters))&&e.nextNode instanceof ae&&(0,a.le)(e.nextNode.nextNode)&&(d=e.length),-1!==d){if(n)return void(r=!1);var u=e.line.getOffset(e,d+t),p=[" ","\u3000"];if((l||-1===p.indexOf(c[d]))&&!r&&e.line.paragraph===o.paragraph&&u!==o.offset)return r=!0,void o.setPositionParagraph(e.line,u);var f=!1;for(-1!==p.indexOf(c[d])&&-1===p.indexOf(c[d+1])&&(f=!0,d++);d<c.length&&!f&&-1!==w.wordSplitCharacters.indexOf(c[d]);)if(d++,-1!==p.indexOf(c[d])&&-1===p.indexOf(c[d+1])&&-1!==w.wordSplitCharacters.indexOf(c[d+1])){d++;break}r=!0,d<c.length||(0,a.le)(e.nextNode)?o.setPositionParagraph(e.line,e.line.getOffset(e,d+t)):this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)}else(0,a.le)(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)}else(0,a.le)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)}},s.prototype.getNextWordOffsetFieldSeparator=function(e,t,i,n,r,o,l){(0,a.le)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)},s.prototype.getNextWordOffsetComment=function(e,t,i,n,r,o,l){(0,a.le)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,l)},s.prototype.getNextWordOffsetFieldEnd=function(e,t,i,n,r,o,l){var h=e.line.getOffset(e,0),d=h+e.length;o.offset===h&&(o.setPositionParagraph(e.line,d),(0,a.le)(e.nextNode))||((0,a.le)(e.nextNode)?o.setPositionParagraph(e.line,h):(this.getNextWordOffset(e.nextNode,0,i,!1,r,o,l),o.offset===d&&o.setPositionParagraph(e.line,h)),r=!0)},s.prototype.getPreviousWordOffset=function(e,t,i,n,r,o,l,h){e instanceof S?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,l,h):e instanceof ee?this.getPreviousWordOffsetImage(e,t,i,n,r,o,l,h):e instanceof H&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,n,r,o,l,h):e instanceof H&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,n,r,o,l,h):e instanceof H&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,n,r,o,l,h):e instanceof O?this.getPreviousWordOffsetBookMark(e,t,i,n,r,o,l,h):e instanceof _&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,n,r,o,l,h):e instanceof ae&&this.getPreviousWordOffsetComment(e,t,i,n,r,o,l,h)},s.prototype.getPreviousWordOffsetBookMark=function(e,t,i,n,r,o,l,h){if(e.previousNode){if(e.previousNode instanceof S){var d=e.previousNode;w.lastIndexOfAny(d.text,w.wordSplitCharacters)!==d.text.length-1?this.getPreviousWordOffset(d,t,i,n,r,o,l,h):h.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else h.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},s.prototype.getPreviousWordOffsetFieldEnd=function(e,t,i,n,r,o,l,h){var d=e.line.getOffset(e,0),c=d+e.length;if((0,a.le)(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,n,r,o,l,h);else if(0!==n||(0,a.le)(e.previousNode)){if(!(0,a.le)(e.fieldBegin)&&0!==n){if(((0,a.le)(u=e.previousNode)||u.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(u.line.paragraph,u,e.fieldBegin))&&(u=e.fieldBegin),this.getPreviousWordOffset(u,t,u.length,n,!(h.paragraph===e.line.paragraph&&h.offset===c),o,l,h),l&&h.paragraph===e.line.paragraph&&h.offset===d)return void h.setPositionParagraph(e.line,c);l||h.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var u;this.getPreviousWordOffset(u=e.previousNode,t,u.length,n,u instanceof H&&1===u.fieldType,o,l,h)}},s.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,n,r,o,l,h){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,n,r,o,l,h)},s.prototype.getPreviousWordOffsetComment=function(e,t,i,n,r,o,l,h){if(e.previousNode){var d=e.previousNode;e.previousNode instanceof S&&w.lastIndexOfAny(d.text,w.wordSplitCharacters)!==d.text.length-1?this.getPreviousWordOffset(d,t,i,n,r,o,l,h):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,l,h)}else h.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},s.prototype.getPreviousWordOffsetFieldBegin=function(e,t,i,n,r,o,l,h){var d=e.line.getOffset(e,0);h.offset===d+e.length&&h.setPositionParagraph(e.line,d),(0,a.le)(e.previousNode)?h.setPositionParagraph(e.line,e.fieldSeparator?e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length):t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,!1,o,l,h),h.offset===d&&0!==n&&!(0,a.le)(e.fieldSeparator)&&h.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)))},s.prototype.getPreviousWordOffsetImage=function(e,t,i,n,r,o,l,h){if(r)return h.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(l=!1);if(i===e.length){var d=e.line.getOffset(e,e.length);h.setPositionParagraph(e.line,d===h.offset?d-e.length:d)}else(0,a.le)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,l,h)},s.prototype.getPreviousWordOffsetSpan=function(e,t,i,n,r,o,l,h){if("\t"===e.text||"\v"===e.text){if(r)return void(l=!1);if(i===e.length){l=!0;var d=e.line.getOffset(e,e.length);h.setPositionParagraph(e.line,d===h.offset?d-e.length:d)}else(0,a.le)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,l,h)}else{var c=0;if(!o){for(;i>0&&" "===e.text[i-1];)i--;h.setPositionParagraph(e.line,e.line.getOffset(e,i))}if(i>0){if(o=!0,0===i&&l&&-1===w.wordSplitCharacters.indexOf(e.text[0]))return h.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(l=!0);var u=e.text.length>i?e.text.slice(0,i):e.text;if(-1===(c=w.lastIndexOfAny(u,w.wordSplitCharacters))&&e.previousElement instanceof ae&&(0,a.le)(e.previousNode.previousNode)&&(c=e.length),-1!==c){if(r)return void(l=!1);for(;c>0&&l&&" "!==u[c]&&-1!==w.wordSplitCharacters.indexOf(u[c-1]);)c--;if((" "===u[c]||"\u3000"===u[c]||!l)&&c++,l=!0,c>0){var p=e.line.getOffset(e,c);e.line.paragraph===h.paragraph&&p===h.offset?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,l,h):h.setPositionParagraph(e.line,p)}else if(e.previousNode instanceof S){var f=e.previousNode.text;if(-1!==w.wordSplitCharacters.indexOf(e.text[0])&&-1===w.wordSplitCharacters.indexOf(f[f.length-1]))return p=e.line.getOffset(e,c),void h.setPositionParagraph(e.line,p);this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,l,h)}else h.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,i,n,r,o,l,h)}else this.setPreviousWordOffset(e,t,i,n,r,o,l,h)}},s.prototype.setPreviousWordOffset=function(e,t,i,n,r,o,l,h){e.previousNode instanceof fe&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,l,h):h.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},s.prototype.validateForwardFieldSelection=function(e,t){var i=new s(this.owner);i.setPositionForCurrentIndex(e),i.isUpdateLocation=!1;var n=!1;for((this.selection.start.paragraph!==this.selection.end.paragraph||this.selection.start.offset===this.selection.getStartOffset(this.selection.start.paragraph))&&this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);e!==t&&s.isForwardSelection(e,t)&&(n||(i.moveNextPosition(!1),e!==i.getHierarchicalIndexInternal()));){var o=0,l=i.currentWidget.getInline(i.offset,o),h=l.element;if(o=l.index,!(0,a.le)(h)){var d=this.selection.start.getHierarchicalIndexInternal();if(o===h.length&&h instanceof H&&1===h.fieldType){if(h.line.getOffset(h,0)===this.offset)return;var c=h.fieldBegin.line,u=c.getOffset(h.fieldBegin,0),p=this.getHierarchicalIndex(c,u.toString());s.isForwardSelection(d,p)||this.selection.start.setPositionParagraph(c,u)}var f=this.selection.getNextRenderedElementBox(h,o);!(0,a.le)(f)&&f instanceof fe&&(h=f)}if(n=h instanceof H&&0===h.fieldType&&!(0,a.le)(h.fieldEnd)){if(h.line.getOffset(h,0)===this.offset)return;var g=h.fieldEnd,v=g.line.getOffset(g,1),y=this.getHierarchicalIndex(g.line,v.toString());if(!s.isForwardSelection(y,t))return void this.moveToInline(h.fieldEnd,1);i.moveToInline(h.fieldEnd,1)}e=i.getHierarchicalIndexInternal()}},s.prototype.validateBackwardFieldSelection=function(e,t){var i=new s(this.owner);i.setPositionForCurrentIndex(e),i.isUpdateLocation=!1;var n=!1;(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||((0,a.le)(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine())&&(n=!0),n&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1);for(var r=this.selection.start.getHierarchicalIndexInternal();e!==t&&s.isForwardSelection(t,e);){var o=0,l=i.currentWidget.getInline(i.offset,o),h=l.element;if(o=l.index,!(0,a.le)(h)){var d=this.selection.getNextRenderedElementBox(h,o);if(d instanceof H&&0===d.fieldType){var c=d.fieldEnd.line,u=c.getOffset(d.fieldEnd,1),p=this.getHierarchicalIndex(c,u.toString());s.isForwardSelection(p,r)||(this.selection.start.setPositionParagraph(c,u),r=p)}}if(h instanceof H&&1===h.fieldType&&!(0,a.le)(h.fieldBegin)){var f=h.fieldBegin.line,m=f.getOffset(h.fieldBegin,0),v=this.getHierarchicalIndex(f,m.toString());if(!s.isForwardSelection(t,v))return void this.moveToInline(h.fieldBegin,0);i.moveToInline(h.fieldBegin,0)}else i.movePreviousPosition();e=i.getHierarchicalIndexInternal()}},s.prototype.paragraphStartInternal=function(e,t){var i=e.getStartLineOffset(this.currentWidget);if(this.offset===i&&t){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!(0,a.le)(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var r=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=r.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i;this.calculateOffset()},s.prototype.calculateOffset=function(){var e=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},s.prototype.moveToParagraphStartInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;var n=e.getStartOffset(i);this.offset===n&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):(0,a.le)(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=e.getStartLineOffset(this.currentWidget));var o=this.owner.selection.start.getHierarchicalIndexInternal(),l=this.getHierarchicalIndexInternal();o!==l&&this.validateBackwardFieldSelection(o,l),this.updatePhysicalPosition(!1)},s.prototype.moveToParagraphEndInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];var n=this.currentWidget.getEndOffset()+1;if(this.offset===n&&t){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!(0,a.le)(e.getNextParagraphBlock(this.currentWidget.paragraph))){var o=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=o.childWidgets[o.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=n;this.calculateOffset()},s.prototype.moveUp=function(e,t){var i=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var n=void 0,r=this.currentWidget.paragraph;if(i.isInsideTable&&i!==r&&i.associatedCell!==r.associatedCell&&!(0,a.le)(r.associatedCell)&&i.associatedCell.ownerRow===r.associatedCell.ownerRow){var o=r.associatedCell.ownerRow;if(o.previousRenderedWidget instanceof Q){var l=e.getFirstCellInRegion(o.previousRenderedWidget,r.associatedCell,t,!0),h=e.getLastParagraph(l);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}else{var d=o.ownerTable.previousRenderedWidget;do{d instanceof k&&(d=e.getLastBlockInLastCell(d))}while(d instanceof k);d instanceof I&&this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}n=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(l=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),h=e.getLastParagraph(l),this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)):i.isInsideTable&&!(0,a.le)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(l=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),h=e.getLastParagraph(l),this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)),n=e.getLineWidgetParagraph(this.offset,this.currentWidget);var c=e.getTop(n);this.currentWidget.isEndsWithPageBreak&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(n,new ce(t,c),this,!1)},s.prototype.moveDown=function(e,t){var i=this.currentWidget.paragraph,n=this.currentWidget;this.moveToLineEndInternal(e,!0);var r=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>r&&(this.offset=r),this.moveNextPosition();var o=void 0;if(i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!(0,a.le)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var l=this.currentWidget.paragraph.associatedCell.ownerRow;if(i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&i.associatedCell.cellFormat.rowSpan>1&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length&&(l=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),l.nextRenderedWidget instanceof Q){var h=this.selection.getLastCellInRegion(l.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(h).childWidgets[0],!0)}else{var d=this.selection.getNextRenderedBlock(l.ownerTable);do{d instanceof k&&(d=this.selection.getFirstBlockInFirstCell(d))}while(d instanceof k);d instanceof I&&this.setPosition(d.childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(h=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1),this.setPosition(this.selection.getFirstParagraph(h).childWidgets[0],!0)):i.isInsideTable&&!(0,a.le)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget&&i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(h=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),this.setPosition(e.getFirstParagraph(h).childWidgets[0],!1)),o=e.getLineWidgetParagraph(this.offset,this.currentWidget);var c=this.selection.getTop(o);o!==n&&this.selection.updateTextPositionWidget(o,new ce(t,c),this,!1)},s.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetInternal(this.currentWidget,this.offset,t),n=e.getFirstElementInternal(i);this.documentHelper.moveCaretPosition=1;var r=e.getStartOffset(this.currentWidget.paragraph);if((0,a.le)(n)&&this.offset>r){var o=0;o=(l=this.currentWidget.getInline(this.offset,o)).index,(h=l.element)instanceof S&&"\v"!==h.text&&(this.offset=r)}else if(!(0,a.le)(n)){var l,h,d=0;if(this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,d),d=(l=this.currentWidget.getInline(this.offset,d=0)).index,(h=l.element)instanceof H){var c=e.getPreviousValidElement(h);(0,a.le)(c)||(this.currentWidget=(h=c).line,this.offset=this.currentWidget.getOffset(h,h.length),h instanceof H&&this.offset--)}}this.updatePhysicalPosition(!0)},s.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},s.prototype.moveToWordEndInternal=function(e,t){var i=0,n=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof _&&(i=1),this.currentWidget.children[1]instanceof _&&(i=2)),this.offset+i===n||this.offset===n+1)if(this.offset===n&&0!==e)this.setPositionParagraph(this.currentWidget,n+1);else{var r=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if((0,a.le)(r))return;this.currentWidget=r.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e&&(this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t))}else{var l=0,d=this.currentWidget.getInline(this.offset,l);this.getNextWordOffset(d.element,l=d.index,e,!1,!1,this,t)}if(0!==e){var u=this.owner.selection.start.getHierarchicalIndexInternal(),p=this.getHierarchicalIndexInternal();u!==p&&this.validateForwardFieldSelection(u,p)}this.updatePhysicalPosition(!0)},s.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,t=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);(0,a.le)(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},s.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==t||(0,a.le)(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var i=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=i.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},s.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),n=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var r=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=e.getLeft(r);if(e.getWidth(r,!0)+o>=t&&n!==r){var h=e.getTop(r),d=new ce(t,h);e.updateTextPositionWidget(r,d,this,!0)}var c=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,c)},s.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetParagraph(this.offset,this.currentWidget),n=e.getFirstElementInternal(i),r=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,(0,a.le)(n)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!(0,a.le)(n)){var o=void 0;if(r&&this.containsRtlText(i)){var l=i.getEndOffset();o=i.getInline(l,0).element}else(o=i.children[i.children.length-1])instanceof _&&i.children.length>2&&(o=i.children[i.children.length-3]);var h=0;if(h+=o instanceof S?o.length:1,this.currentWidget=o.line,h===o.length&&(0,a.le)(o.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var d=e.getLineLength(this.currentWidget);this.offset=t?d+1:d}else{for(var c=o;!(0,a.le)(c)&&c.length===h&&c.nextNode instanceof H;){var u=e.getNextValidElement(c.nextNode);if(c!==u&&(c=u,h=0),c instanceof H&&0===c.fieldType&&!(0,a.le)(c.fieldEnd)){var p=c;(0,a.le)(p.fieldSeparator)?c=p.fieldEnd:(this.currentWidget=(c=p.fieldSeparator).line,this.currentWidget===p.fieldEnd.line&&!e.hasValidInline(this.currentWidget.paragraph,c,p.fieldEnd)&&(c=p.fieldEnd)),this.currentWidget=c.line}c instanceof H&&(h=1)}h===c.length&&(0,a.le)(c.nextNode)&&h++,!t&&c instanceof fe&&"\v"===c.text&&h--,this.offset=this.currentWidget.getOffset(c,h)}this.updatePhysicalPosition(t)}},s.prototype.moveToNextLine=function(e){var t=this.selection,i=new s(this.owner);i.setPositionInternal(this);var n=this.getHierarchicalIndexInternal();t.getLineWidgetParagraph(this.offset,this.currentWidget),this.moveToLineEndInternal(t,!0);var o=!i.isAtSamePosition(this);i.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable?this.moveDownInTable(t):(this.moveNextPosition(),0===this.offset||this.moveForward());var h=t.getLineWidgetParagraph(this.offset,this.currentWidget),d=t.getLeft(h),c=t.getFirstElementInternal(h),u=(0,a.le)(c)?t.getWidth(h,!0):t.getLeftInternal(h,c,1)-d;if(d<e&&u/2<e-d){var p=t.getTop(h),f=new ce(e,p);t.updateTextPositionWidget(h,f,this,!0),t.getWidth(h,!0)<e-d&&this.moveToLineEndInternal(t,!0)}else o&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(i):o||this.moveToLineEndInternal(t,!0);var m=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(n,m)},s.prototype.moveUpInTable=function(e){var t=!1,i=this.owner.selection.end,n=!this.owner.selection.isEmpty;if(t=i.paragraph.isInsideTable){var r=this.currentWidget.paragraph.associatedCell,o=i.paragraph.associatedCell,l=e.getContainerCellOf(o,r);if(t=l.ownerTable.contains(r)){o=e.getSelectedCell(o,l),r=e.getSelectedCell(r,l);var h=e.containsCell(l,this.currentWidget.paragraph.associatedCell),d=e.isCellSelected(l,this,i);if(d||(d=this.currentWidget.paragraph===e.getFirstParagraph(l)&&this.isAtParagraphStart),(h&&d||!h)&&!(0,a.le)(r.ownerRow.previousRenderedWidget)){var u=e.getFirstCellInRegion(r.ownerRow.previousRenderedWidget,l,this.owner.selection.upDownSelectionLength,!0),p=e.getLastParagraph(u);return void this.setPosition(p.childWidgets[0],!0)}(h&&d&&(0,a.le)(r.ownerRow.previousRenderedWidget)||!h)&&(n?(p=e.getFirstParagraph(r=r.ownerRow.childWidgets[0]),this.setPosition(p.childWidgets[0],!0)):(p=e.getLastParagraph(r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1]),this.setPosition(p.childWidgets[0],!1)))}}t||(u=e.getContainerCell(this.currentWidget.paragraph.associatedCell),n?(p=e.getFirstParagraph(u=u.ownerRow.childWidgets[0]),this.setPosition(p.childWidgets[0],!0)):(p=e.getLastParagraph(u=u.ownerRow.childWidgets[u.ownerRow.childWidgets.length-1]),this.setPosition(p.childWidgets[0],!1))),this.moveBackward()},s.prototype.moveDownInTable=function(e){var t=!1,i=this.owner.selection.isEmpty||this.owner.selection.isForward;if(t=this.owner.selection.start.paragraph.isInsideTable){var n=this.owner.selection.start.paragraph.associatedCell,r=this.currentWidget.paragraph.associatedCell,o=e.getContainerCellOf(n,r);if(t=o.ownerTable.contains(r)){n=e.getSelectedCell(n,o),r=e.getSelectedCell(r,o);var l=e.containsCell(o,this.currentWidget.paragraph.associatedCell),h=e.isCellSelected(o,this.owner.selection.start,this);if((l&&h||!l)&&!(0,a.le)(r.ownerRow.nextRenderedWidget)){var c=e.getLastCellInRegion(r.ownerRow.nextRenderedWidget,o,this.owner.selection.upDownSelectionLength,!1),u=e.getLastParagraph(c);return void this.setPosition(u.childWidgets[u.childWidgets.length-1],!1)}(l&&h&&(0,a.le)(r.ownerRow.nextRenderedWidget)||!l)&&(i?(u=e.getLastParagraph(r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1]),this.setPosition(u.childWidgets[u.childWidgets.length-1],!1)):(u=e.getFirstParagraph(r=r.ownerRow.childWidgets[0]),this.setPosition(u.childWidgets[u.childWidgets.length-1],!0)))}}t||(c=e.getContainerCell(this.currentWidget.paragraph.associatedCell),i?(u=e.getLastParagraph(c=c.ownerRow.childWidgets[c.ownerRow.childWidgets.length-1]),this.setPosition(u.childWidgets[u.childWidgets.length-1],!1)):c.ownerRow.nextRenderedWidget&&(u=e.getFirstParagraph(c=c.ownerRow.nextRenderedWidget.childWidgets[0]),this.setPosition(u.childWidgets[u.childWidgets.length-1],!0))),this.moveForward()},s.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,(0,a.le)(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0},s}(),Je=function(){function s(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}return Object.defineProperty(s.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0},s}(),ji=function(){function s(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";var i=t.getFieldCode(e),n=i.toLowerCase();"hyperlink"===n.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===n.indexOf("ref ")&&n.match("\\h")?(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0):0===n.indexOf("pageref")&&this.parseFieldValues(i.substring(7).trim(),!1)}return Object.defineProperty(s.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),s.prototype.parseFieldValues=function(e,t){var i=e.split("\\o ");2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" ");var n=!1;if(t)for(var r=0;r<i.length;r++){var o=i[r];o.length<1||("\\t"===o||"\\l"===o?n=!0:"\\n"===o?this.opensNewWindow=!0:(o=this.parseFieldValue(o,'"'===o[0]?'"':void 0,t),n?(this.localRef=o,n=!1):this.linkInternal=o))}else this.localRef=i[0];this.setLinkType()},s.prototype.parseFieldValue=function(e,t,i){e=e.substring(i?1:0);var n=t?e.indexOf(t):-1;return n<0&&(n=e.length),e.substring(0,n).trim()},s.prototype.setLinkType=function(){(0,a.le)(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),this.typeInternal="http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?"WebPage":"mailto:"===this.linkInternal.substring(0,7)?"Email":"File")},s.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0},s}(),Gi=function(){function s(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height}return s.prototype.destroy=function(){this.width=void 0,this.height=void 0},s}(),Lt=function(){function s(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(s.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},s}(),ns=function(){function s(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(s.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.ownerFormat=void 0,this.modifiedFormat.destroy(),this.modifiedFormat=void 0},s}(),Pr=function(){function s(e,t){this.startingPoint=e,this.rowFormat=t,this.rowHeightType=t.heightType}return s.prototype.revertChanges=function(e,t){var i=this.rowFormat.heightType;t.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=i},s}(),Ki=function(){function s(e,t){this.tableHolder=new Kn,this.tableFormat=new rs,this.rows=[],this.owner=t,this.copyProperties(e)}return s.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t],n=new os;n.gridBefore=i.rowFormat.gridBefore,n.gridBeforeWidth=i.rowFormat.gridBeforeWidth,n.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,n.gridAfter=i.rowFormat.gridAfter,n.gridAfterWidth=i.rowFormat.gridAfterWidth,n.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r],l=new ss;l.columnIndex=o.columnIndex,l.columnSpan=o.cellFormat.columnSpan,l.preferredWidth=o.cellFormat.preferredWidth,l.preferredWidthType=o.cellFormat.preferredWidthType,n.cells.push(l)}this.rows.push(n)}this.tableHierarchicalIndex=this.owner.selection.getHierarchicalIndex(e,"0")},s.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},s}(),rs=function(){return function(){}}(),os=function(){return function(){this.cells=[]}}(),ss=function(){return function(){}}(),Gt=function(){function s(e){this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[]}return Object.defineProperty(s.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),s.prototype.updateSelection=function(){var e=this.owner.selection.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.selection.getParagraphInfo(this.owner.selection.end),this.selectionEnd=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString())},s.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},s.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},s.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},s.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,i=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.recordChanges(this)):(t=w.formatText(i.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.undoStack.push(this))},s.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof qe?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},s.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;if(this.editorHistory.isUndoing){this.documentHelper.bookmarks.add(t.name,t),t.line.children.splice(e.startIndex,0,t);var i=t.previousNode;i instanceof H&&!(0,a.le)(i.formFieldData)&&(i.formFieldData.name=t.name),t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.recordChanges(this)}else this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.undoStack.push(this)},s.prototype.revertComment=function(){var e=this.insertPosition,t=this.removedNodes[0],i=!1;if("ResolveComment"===this.action)return this.editorHistory.currentBaseHistoryInfo=this,void this.owner.editor.resolveOrReopenComment(t,!t.isResolved);if("InsertCommentWidget"===this.action?i=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(i=this.editorHistory.isUndoing),i)t&&(t.isReply?this.owner.editor.addReplyComment(t,this.insertPosition):this.owner.editor.addCommentWidget(t,!1,!0,!0));else{var n=this.owner.editor.getCommentElementBox(e);this.owner.editor.deleteCommentWidget(n)}},s.prototype.revertEditRangeRegion=function(){var e=this.removedNodes[0],t=e.editStart;this.editorHistory.isUndoing?(this.owner.editor.updateRangeCollection(t,""===t.user?t.group:t.user),t.line.children.splice(e.startIndex,0,t),t.editRangeEnd.line.children.splice(e.endIndex,0,t.editRangeEnd),this.editorHistory.recordChanges(this)):(this.owner.editorModule.removeUserRestrictionsInternal(t),this.editorHistory.undoStack.push(this)),this.owner.editor.fireContentChange()},s.prototype.revert=function(){if("FormTextFormat"!==this.action)if("UpdateFormField"!==this.action)if("DeleteBookmark"!==this.action)if("RemoveEditRange"!==this.action)if("InsertCommentWidget"!==this.action&&"DeleteCommentWidget"!==this.action&&"ResolveComment"!==this.action){if("ListFormat"===this.action&&""!==this.owner.editor.listNumberFormat){var e=this.documentHelper.lists[0].abstractList.levels[this.owner.editor.listLevelNumber],t=e.listLevelPattern,i=e.numberFormat;e.listLevelPattern=this.owner.editor.listLevelPattern,e.numberFormat=this.owner.editor.listNumberFormat,this.owner.editor.listLevelPattern=t,this.owner.editor.listNumberFormat=i}this.owner.isShiftingEnabled=!0;var n=void 0,r=void 0,o=this.selectionStart,l=this.selectionEnd,h=Z.isForwardSelection(o,l);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)n=this.owner.selection.getTextPosBasedOnLogicalIndex(o),r=this.owner.selection.getTextPosBasedOnLogicalIndex(l),this.revertModifiedProperties(n,r);else{var d=this.owner.selection,c=this.removedNodes;this.removedNodesIn=[],(0,a.le)(this.endPosition)&&(this.endPosition=this.insertPosition);var u=Z.isForwardSelection(this.insertPosition,this.endPosition),p=d.getTextPosBasedOnLogicalIndex(u?this.insertPosition:this.endPosition),f=d.getTextPosBasedOnLogicalIndex(u?this.endPosition:this.insertPosition);if(this.lastElementRevision&&this.editorHistory.isUndoing&&(0,a.le)(this.endRevisionLogicalIndex)&&this.updateEndRevisionInfo(),"ClearRevisions"===this.action&&(this.undoRevisionForElements(p,f,c[c.length-1]),c=[]),"Uppercase"===this.action){d.selectPosition(p,f),this.editorHistory.currentBaseHistoryInfo=this;var g=this.owner.editorModule;return g.changeSelectedTextCase(d,p,f,this.action.toString(),c),void g.reLayout(d)}if(p.isAtSamePosition(f)?d.selectContent(p,!0):d.selectPosition(p,f),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){var m=this.owner.selection.getHyperlinkField();if(!(0,a.le)(m)){var v=m.line.getOffset(m,0);p.setPositionParagraph(m.line,v),this.owner.selection.start.setPositionInternal(p),v=m.fieldEnd.line.getOffset(m.fieldEnd,1),f.setPositionParagraph(m.fieldEnd.line,v)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var y=!1;if(this.endRevisionLogicalIndex&&c.length>0){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&p.isAtSamePosition(f)){var b=d.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex);d.selectPosition(p,b)}this.editorHistory.isUndoing&&this.owner.editor.deleteSelectedContents(d,!0)}if(!p.isAtSamePosition(f)){var C=c.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action;!(y="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action)&&"MergeCells"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"Borders"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&(d.end.setPositionInternal(f),!this.owner.selection.isEmpty&&!C&&(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(d):this.owner.editorModule.deleteSelectedContents(d,!0),!(0,a.le)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1)))}var F=this.editorHistory.isRedoing&&!y;y=!this.lastElementRevision&&y,this.revertModifiedNodes(c,F,h?o:l,o===l),y&&this.removeContent(p,f)}var T=!1,x=!1;!(0,a.le)(this.editorHistory.currentHistoryInfo)&&("Reject All"===this.editorHistory.currentHistoryInfo.action||"Accept All"===this.editorHistory.currentHistoryInfo.action||"Paste"===this.editorHistory.currentHistoryInfo.action)&&(x=!0),(!this.owner.trackChangesPane.isTrackingPageBreak&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||x)&&(0,a.le)(this.editorHistory.currentHistoryInfo)||x)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(n=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),r=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(n=this.owner.selection.getTextPosBasedOnLogicalIndex(o),r=this.owner.selection.getTextPosBasedOnLogicalIndex(l)),this.owner.selection.selectRange(n,r),T=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1,this.insertPosition=o,this.endPosition=l,!(0,a.le)(this.editorHistory.currentHistoryInfo)&&("Accept All"===this.editorHistory.currentHistoryInfo.action||"Reject All"===this.editorHistory.currentHistoryInfo.action||"RemoveComment"===this.editorHistory.currentHistoryInfo.action)&&this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty),T&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.highlightListText()}else this.revertComment();else this.revertEditRangeRegion();else this.revertBookmark();else this.revertFormField();else this.revertFormTextFormat()},s.prototype.highlightListText=function(){if(!(0,a.le)(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart);this.documentHelper.selection.highlightListText(e.currentWidget)}},s.prototype.removeContent=function(e,t){if(!(0,a.le)(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof j&&!(0,a.le)(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof j||!(0,a.le)(e.paragraph.containerWidget)&&!(0,a.le)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof V&&t.paragraph.containerWidget instanceof V&&!(0,a.le)(e.paragraph.bodyWidget)||!(0,a.le)(e.paragraph.containerWidget)&&!(0,a.le)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof be&&t.paragraph.containerWidget instanceof be){this.owner.selection.selectRange(e,t);var i=!1;("BackSpace"===this.action||"Uppercase"===this.action||"RemoveRowTrack"===this.action)&&(i=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selection,i)}},s.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),t=this.owner.selection.getParagraphInfo(e);this.endRevisionLogicalIndex=this.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},s.prototype.retrieveEndPosition=function(e){var t=new Z(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},s.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var i,t=e.nextNode;!(0,a.le)(t)&&t.isMarkedForRevision;)i=t,t=t.nextNode;return(0,a.le)(i)?e:i},s.prototype.revertModifiedProperties=function(e,t){("CellFormat"===this.action||"CellOptions"===this.action||"TableOptions"===this.action)&&(this.owner.isShiftingEnabled=!1),this.owner.selection.selectRange(e,t),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},s.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action){case"BackSpace":e.singleBackspace(this.owner.selection,!0);break;case"Delete":e.singleDelete(this.owner.selection,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selection,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selection.handleAcceptReject(!0)}},s.prototype.revertModifiedNodes=function(e,t,i,n){if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action&&"PasteColumn"!==this.action&&"PasteOverwrite"!==this.action&&"PasteNested"!==this.action||(this.redoAction(),"SectionBreak"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action){var o=this.owner.editorModule.getBlock({index:this.selectionStart}).node,l=e[e.length-1];(o instanceof k||o.previousRenderedWidget instanceof k||o.isInsideTable)&&l instanceof k?(o instanceof I&&!o.isInsideTable?o=o.previousRenderedWidget:o instanceof I&&o.isInsideTable&&(o=o.associatedCell.ownerTable),o=o.combineWidget(this.viewer),this.owner.editorModule.insertTableInternal(o,l,!1),"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action?this.removedNodes.push(o):e.splice(e.indexOf(l),1)):l instanceof k&&this.owner.editorModule.insertBlock(l)}else{var h=i;if(o=this.owner.editorModule.getBlock({index:h}).node,e.length>0&&("BackSpace"===this.action&&n||!(o instanceof k)&&!(o instanceof Ce))){if(l=e[0],("TrackingPageBreak"===this.action||"SectionBreak"===this.action&&l instanceof j||!(0,a.le)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(l=e[1]),l instanceof I&&this.owner.selection.start.offset>0&&(this.owner.editorModule.insertNewParagraphWidget(l,!0),l.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(l.characterFormat,void 0),e.splice(e.indexOf(l),1),(0,a.le)(o))){var d=this.documentHelper.selection.getNextParagraphBlock(l.getSplitWidgets().pop());this.owner.selection.getNextRenderedBlock(l);var c=this.owner.selection.start.paragraph;d&&c&&c.bodyWidget instanceof j&&!c.isInsideTable&&!this.owner.selection.isinEndnote&&!this.owner.selection.isinFootnote&&!c.bodyWidget.equals(d.bodyWidget)&&(d=void 0),(0,a.le)(d)&&this.owner.selection.selectParagraphInternal(l,!0)}if(l instanceof k&&this.owner.selection.start.offset>0){var u=e[e.length-1];u instanceof I&&(this.owner.editorModule.insertNewParagraphWidget(u,!0),e.splice(e.indexOf(u),1),(0,a.le)(o))&&(d=this.documentHelper.selection.getNextParagraphBlock(u.getSplitWidgets().pop()),(0,a.le)(d)&&this.owner.selection.selectParagraphInternal(u,!0))}}if(e.length>0){var p=e[e.length-1];if(o instanceof k&&(o=o.combineWidget(this.viewer),p instanceof k)){this.owner.editorModule.insertTableInternal(o,p,!0),e.splice(e.indexOf(p),1),this.insertPosition=i;var f=p.getSplitWidgets().pop();o=f.nextRenderedWidget instanceof k?f.nextRenderedWidget:this.owner.editorModule.getBlock({index:h=i}).node}if(p instanceof I&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)){var g=this.owner.editorModule;g.insertNewParagraphWidget(p,!1),p.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(p.characterFormat,void 0),e.splice(e.indexOf(p),1),"Paste"!==this.action&&g.removeBlock(this.owner.selection.start.paragraph);var m=this.documentHelper.selection.getNextParagraphBlock(p.getSplitWidgets().pop());(0,a.le)(m)||this.owner.selection.selectParagraphInternal(m,!0)}else if(e[0]instanceof k&&1!==e.length){var v=e[1];v instanceof I&&v.isEmpty()&&e.splice(e.indexOf(v),1)}}e.length>0&&(o instanceof k&&(o=o.combineWidget(this.viewer)),this.insertRemovedNodes(e,o))}},s.prototype.insertRemovedNodes=function(e,t){for(var i=e.length-1;i>-1;i--){var r=e[i];if(r instanceof fe)this.owner.editorModule.insertInlineInSelection(this.owner.selection,r);else if(r instanceof Ve)r instanceof Q?t instanceof k&&(t.childWidgets.splice(0,0,r),this.owner.editorModule.updateNextBlocksIndex(r,!0),(0===i||!(e[i-1]instanceof Q))&&this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof k?this.owner.editorModule.insertBlockTable(this.owner.selection,r,t):this.owner.editorModule.insertBlock(r);else if(r instanceof ie){var l=this.owner.editorModule.getBlock({index:this.selectionStart}).node;l instanceof I&&(r.removedIds.length>0?(l.characterFormat.removedIds=r.removedIds.slice(),this.owner.editor.constructRevisionFromID(l.characterFormat,!0)):l.characterFormat.revisions.length>0&&(l.characterFormat=r.cloneFormat()))}else if(r instanceof j)!(0,a.le)(r.removedHeaderFooters)&&0!==r.removedHeaderFooters.length&&(this.owner.documentHelper.headersFooters.splice(r.sectionIndex,0,r.removedHeaderFooters[0]),r.removedHeaderFooters=void 0),this.owner.editorModule.insertSection(this.owner.selection,!1,!0);else if("string"==typeof r&&"AcceptTOC"===this.action){var h=this.owner.editorModule.getBlock({index:this.selectionStart}).node,d=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,c=this.owner.documentHelper.revisionsInternal.get(r);if(this.editorHistory.isUndoing){for(;h instanceof I&&h!==d;)this.owner.editor.insertRevisionForBlock(h,c.revisionType,!0,c),h=this.documentHelper.selection.getNextParagraphBlock(h.getSplitWidgets().pop());this.owner.editor.insertRevisionForBlock(d,c.revisionType,!0,c)}else for(;c.range.length>0;){var u=c.range[0],p=u.revisions.indexOf(c);if(p>=0){u.revisions.splice(p,1);var f=c.range.indexOf(u);c.range.splice(f,1)}0===c.range.length&&this.owner.revisions.remove(c)}this.owner.editor.addRemovedNodes(c.revisionID)}}e=[]},s.prototype.undoRevisionForElements=function(e,t,i){var n=e.paragraph,r=t.paragraph,o=this.documentHelper.revisionsInternal.get(i),l=this.owner.selection.getParagraphInfo(e).offset,h=this.owner.selection.getParagraphInfo(t).offset,d=e.paragraph===t.paragraph;if(this.editorHistory.isUndoing){for(;n!==r;)this.owner.editor.applyRevisionForCurrentPara(n,l,n.getLength(),i,!0),(n=this.documentHelper.selection.getNextParagraphBlock(n.getSplitWidgets().pop()))!==r&&(l=0);n===r&&(d||(l=0),this.owner.editor.applyRevisionForCurrentPara(n,l,h,i,!1))}else for(;o.range.length>0;){var c=o.range[0],u=c.revisions.indexOf(o);if(u>=0){c.revisions.splice(u,1);var p=o.range.indexOf(c);o.range.splice(p,1)}0===o.range.length&&this.owner.revisions.remove(o)}this.removedNodes.push(i)},s.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action)this.modifiedProperties[0]instanceof Pr&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner);else if(this.modifiedProperties[0]instanceof Ki){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var e=this.modifiedProperties[0],i=this.owner.editorModule.getBlock({index:e.tableHierarchicalIndex}).node;if(i instanceof k){var n=this.owner.editorModule.tableResize;if(this.owner.editor.setOffsetValue(this.owner.selection),i=i.combineWidget(this.owner.viewer),n.currentResizingTable=i,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=new Ki(i,this.owner);this.modifiedProperties.splice(0,0,r),this.owner.isLayoutEnabled=!1,n.applyProperties(n.currentResizingTable,e),n.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,n.updateGridValue(n.currentResizingTable,!1),e.destroy(),e=void 0}}}},s.prototype.revertTableDialogProperties=function(e){this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e?this.owner.editorModule.updateCellMargins(this.owner.selection,this.modifiedProperties[0]):"TableOptions"===e&&this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]),this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},s.prototype.addModifiedPropertiesForSection=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.modifiedProperties,r=this.currentPropertyIndex<n.length?n[this.currentPropertyIndex]:n[n.length-1];(0,a.le)(t)?(i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(i=r.getPropertyValue(t),r.copyFormat(e)),this.currentPropertyIndex++}else if((0,a.le)(t))this.modifiedProperties.push(e.cloneFormat());else{var o=new je;o.copyFormat(e),this.modifiedProperties.push(o)}return i},s.prototype.addModifiedProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],r=!1;if(e.ownerBase instanceof fe){var o=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<o){r=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,o-e.ownerBase.length);var l=new ie(void 0);l.copyFormat(n),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,l)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=n,r||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if((0,a.le)(t))this.modifiedProperties.push(e.cloneFormat());else{var h=new ie(void 0);h.copyFormat(e),this.modifiedProperties.push(h)}this.modifiedNodeLength.push(e.ownerBase instanceof fe?e.ownerBase.length:0)}return i},s.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=n,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,i;if((0,a.le)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new ue(void 0)).copyFormat(n),n.listFormat=new bt(n),n.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,i;if("styleName"===t)return(0,a.le)(n.baseStyle)?void((0,a.le)(e.baseStyle)||(n.baseStyle=new Xe,n.baseStyle.copyStyle(e.baseStyle))):((i=new Xe).copyStyle(n.baseStyle),this.currentPropertyIndex++,(0,a.le)(e.baseStyle)||(n.baseStyle=new Xe,n.baseStyle.copyStyle(e.baseStyle)),i);i="borders"===t?n.borders.cloneFormat():this.action.indexOf("Border")>=0?n.borders.getBorder(t.replace("Border","")):n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else if((0,a.le)(t))this.modifiedProperties.push(e.cloneFormat());else{var r=new ue(void 0);r.copyFormat(e),this.modifiedProperties.push(r)}return i},s.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t;var n=new ue;return n.copyFormat(e),this.modifiedProperties.push(n),t},s.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(e.listId),t)},s.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new Lt(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new Lt(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},s.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof ie){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof ue){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof ue)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editor.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if(this.modifiedProperties[0]instanceof je)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof Gi)this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(this.modifiedProperties[0]instanceof Lt){for(var t=new U,i=0;i<this.modifiedProperties.length;i++)t.add(i,this.modifiedProperties[i]);this.editorHistory.updateListChanges(t),t.destroy(),t=void 0}else this.modifiedProperties[0]instanceof Oe?this.owner.editorModule.updateTableFormat(this.owner.selection,e,void 0):this.modifiedProperties[0]instanceof it?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,e,void 0)):this.modifiedProperties[0]instanceof De&&this.owner.editorModule.updateRowFormat(this.owner.selection,e,void 0)}this.currentPropertyIndex=0,("ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)&&this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},s.prototype.addModifiedCellOptions=function(e,t,i){var n;return n=(0,a.le)(e.bottomMargin)&&(0,a.le)(e.topMargin)&&(0,a.le)(e.rightMargin)&&(0,a.le)(e.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,t):(this.modifiedProperties.push(n),t)},s.prototype.copyCellOptions=function(e){var t=new it;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},s.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);this.editorHistory.isUndoing||this.editorHistory.isRedoing?(this.modifiedProperties.splice(this.currentPropertyIndex<this.modifiedProperties.length?this.currentPropertyIndex:this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++):this.modifiedProperties.push(t)},s.prototype.copyTableOptions=function(e){var t=new Oe;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},s.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":case"TableLeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1)}},s.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},s.prototype.addModifiedTableProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if((0,a.le)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var r=new Oe;r.copyFormat(e),this.modifiedProperties.push(r)}return i},s.prototype.addModifiedRowProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if((0,a.le)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i=n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var r=new De;r.copyFormat(e),this.modifiedProperties.push(r)}return i},s.prototype.addModifiedCellProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if((0,a.le)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var r=new it;r.copyFormat(e),this.modifiedProperties.push(r)}return i},s.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,(0,a.le)(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!(0,a.le)(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];(t instanceof ie||t instanceof ue||t instanceof je||t instanceof Lt)&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!(0,a.le)(this.removedNodes)){for(e=0;e<this.removedNodes.length;e++){var i=this.removedNodes[e];i instanceof I?i.destroyInternal(this.viewer):i instanceof fe&&!(i instanceof ae)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),e--}this.removedNodesIn=void 0}this.ownerIn=void 0},s}(),as=function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),Kt=function(s){function e(t,i){var n=s.call(this,t)||this;return n.isChildHistoryInfo=!1,n.editRangeStart=void 0,n.documentHelper=t.documentHelper,n.isChildHistoryInfo=i,n}return as(e,s),Object.defineProperty(e.prototype,"hasAction",{get:function(){return!(0,a.le)(this.modifiedActions)},enumerable:!0,configurable:!0}),e.prototype.addModifiedAction=function(t){this.editorHistory.isUndoing||this.editorHistory.isRedoing||((0,a.le)(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(t))},e.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!(0,a.le)(this.modifiedActions))if(this.editorHistory.isUndoing)for(var t=this.modifiedActions.length;t>0;)this.modifiedActions[t-1].revert(),t-=1;else for(t=0;t<this.modifiedActions.length;)this.modifiedActions[t].revert(),t+=1;if("RestrictEditing"===this.action){var n=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group;if(this.editorHistory.isUndoing){var r=this.owner.documentHelper.editRanges.get(n).indexOf(this.editRangeStart);-1!==r&&this.owner.documentHelper.editRanges.get(n).splice(r,1)}else this.owner.editor.updateRangeCollection(this.editRangeStart,n);this.owner.selection.updateEditRangeCollection()}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},e.prototype.destroy=function(){if(!(0,a.le)(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}s.prototype.destroy.call(this)},e}(Gt),Hr=function(){function s(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new U,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(s.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof Kt?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"undoLimit",{get:function(){return(0,a.le)(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"redoLimit",{get:function(){return(0,a.le)(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"EditorHistory"},s.prototype.canUndo=function(){return!(0,a.le)(this.undoStack)&&this.undoStack.length>0},s.prototype.canRedo=function(){return!(0,a.le)(this.redoStack)&&this.redoStack.length>0},s.prototype.initializeHistory=function(e){(0,a.le)(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new Gt(this.owner),this.currentBaseHistoryInfo.action=e,this.currentBaseHistoryInfo.updateSelection()},s.prototype.initComplexHistory=function(e,t){this.currentHistoryInfo=new Kt(e.owner,!(0,a.le)(this.currentHistoryInfo)),this.currentHistoryInfo.action=t,this.currentHistoryInfo.updateSelection()},s.prototype.initResizingHistory=function(e,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),(0,a.le)(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.modifiedProperties.push(new Pr(e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var i=new Ki(t.currentResizingTable,this.owner);i.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(i),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)}},s.prototype.updateResizingHistory=function(e,t){if(1===t.resizeNode){if(!(0,a.le)(this.currentBaseHistoryInfo)){var i=this.currentBaseHistoryInfo.modifiedProperties[0];i.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=w.convertPixelToPoint(e.y-i.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}}else if(!(0,a.le)(this.currentBaseHistoryInfo)){var n=this.currentBaseHistoryInfo.modifiedProperties[0];n.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(n.displacement=w.convertPixelToPoint(e.x-n.startingPoint.x),n.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}},s.prototype.recordChanges=function(e){this.owner.enableHistoryMode&&(this.isUndoing?((0,a.le)(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0&&this.redoStackIn.splice(0,this.undoLimit>20?10:1),this.redoStack.length<this.redoLimit&&this.redoStack.push(e)):(this.isRedoing||this.clearRedoStack(),(0,a.le)(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0&&this.undoStackIn.splice(0,this.undoLimit>20?10:1),this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)))},s.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!(0,a.le)(this.currentBaseHistoryInfo)&&(!(0,a.le)(this.currentBaseHistoryInfo)&&(0,a.le)(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),(0,a.le)(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},s.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(e=this.owner.editorModule.insertRemoveBookMarkElements()),this.documentHelper.owner.enableHistoryMode&&!(0,a.le)(this.currentHistoryInfo)?(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},s.prototype.updateComplexHistory=function(){var e=this.documentHelper.selection;if(this.currentHistoryInfo.hasAction){if(("AutoFormatHyperlink"===this.currentHistoryInfo.action||"SkipCommentInline"===this.currentHistoryInfo.action||"DeleteCommentInline"===this.currentHistoryInfo.action||"RemoveComment"===this.currentHistoryInfo.action)&&(e.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))),"InsertHyperlink"===this.currentHistoryInfo.action){var t=new Z(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var i=new Z(e.owner);this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(i.paragraph,0,0)}"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):e.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())}this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,"ApplyStyle"===this.currentHistoryInfo.action?this.owner.editor.getOffsetValue(e):(e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0)),e.upDownSelectionLength=e.end.location.x,this.documentHelper.isScrollHandler=!0,this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.fireContentChange()},s.prototype.updateComplexHistoryInternal=function(){(0,a.le)(this.currentHistoryInfo)||((0,a.le)(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1?this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo):this.recordChanges(this.currentHistoryInfo),this.currentHistoryInfo=void 0)},s.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new Gt(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var i=new U,n=0;n<e.levels.length;n++){var r=this.documentHelper.getAbstractListById(t.abstractListId).levels[n];this.currentBaseHistoryInfo.addModifiedPropertiesForList(r);var o=new Lt(r,e.levels[n]);(0,a.le)(r)||this.documentHelper.owner.editorModule.copyListLevel(r,e.levels[n]),i.add(n,o)}return i},s.prototype.applyListChanges=function(e,t){(0,a.le)(this.modifiedParaFormats)&&(this.modifiedParaFormats=new U);for(var i=[],n=0;n<this.documentHelper.listParagraphs.length;n++){var o=this.documentHelper.listParagraphs[n].paragraphFormat,l=this.documentHelper.getListById(o.listFormat.listId),h=this.documentHelper.layout.getListLevel(l,o.listFormat.listLevelNumber);if(t.containsKey(o.listFormat.listLevelNumber)&&t.get(o.listFormat.listLevelNumber).ownerListLevel===h){var d=new ue(null);d.leftIndent=o.leftIndent,d.firstLineIndent=o.firstLineIndent;var c=new ns(o,d);i.push(c),this.owner.editorModule.copyFromListLevelParagraphFormat(o,h.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,i)},s.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var n=e.get(e.keys[t]);(0,a.le)(this.currentBaseHistoryInfo)||(n=this.currentBaseHistoryInfo.addModifiedPropertiesForList(n.ownerListLevel)),this.owner.editorModule.copyListLevel(n.ownerListLevel,n.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var r=this.documentHelper.selection;r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!1),this.updateHistory()},s.prototype.undo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},s.prototype.redo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},s.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},s.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},s.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},s.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},s}(),ls=function(){function s(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new ce(0,0)}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"TableResizer"},s.prototype.updateResizingHistory=function(e){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},s.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistory.initResizingHistory(e,this)},s.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},s.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},s.prototype.getCellReSizerPosition=function(e){var n=this.getTableWidget(e),r=this.getTableCellWidget(e),o=(0,a.le)(n)?0:n.tableFormat.cellSpacing;if(n&&o>0){if(this.currentResizingTable=n,this.documentHelper.isInsideRect(n.x-w.convertPointToPixel(n.leftBorderWidth)-.25,n.y,w.convertPointToPixel(n.leftBorderWidth)+.5,n.height,e))return 0;for(var l=n.x,h=0;h<n.tableHolder.columns.length;h++){var d=w.convertPointToPixel(n.tableHolder.columns[h].preferredWidth);if(this.documentHelper.isInsideRect(l-1,n.y,n.leftBorderWidth+2,n.height,e))return h>0?h:0;if(h>0&&this.documentHelper.isInsideRect(l+d-1,n.y,2,n.height,e))return h+1;l+=d}}else if(!(0,a.le)(r)){if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex;if((0,a.le)(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,e)}return-1},s.prototype.getCellReSizerPositionInternal=function(e,t){var n=this.getTableWidgetFromWidget(t,e),r=void 0;if(!(0,a.le)(n)&&n.tableFormat.cellSpacing>0){if(this.currentResizingTable=n,this.documentHelper.isInsideRect(n.x-n.leftBorderWidth-.25,n.y,n.leftBorderWidth+.5,n.height,t))return 0;for(var o=n.x,l=0;l<n.tableHolder.columns.length;l++){var h=w.convertPointToPixel(n.tableHolder.columns[l].preferredWidth);if(this.documentHelper.isInsideRect(o-1,n.y,n.leftBorderWidth+2,n.height,t))return l>0?l:0;if(l>0&&this.documentHelper.isInsideRect(o+h-1,n.y,2,n.height,t))return l+1;o+=h}}else if((0,a.le)(n)||(r=n.getTableCellWidget(t)),!(0,a.le)(r)){if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height,t))return r.columnIndex;if((0,a.le)(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height,t))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,t)}return-1},s.prototype.getRowReSizerPosition=function(e,t){var i=void 0,n=void 0;(0,a.le)(e)?(i=this.getTableWidget(t),n=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,e);var r=(0,a.le)(i)?0:i.tableFormat.cellSpacing;if(i&&r>0){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-r,this.getActualWidth(i.lastChild),(0,a.le)(i.nextSplitWidget)?i.bottomBorderWidth+r:0,t))return i.lastChild.rowIndex;for(var o=0;o<i.childWidgets.length;o++)if(i.childWidgets.indexOf(l=i.childWidgets[o])>-1&&this.owner.documentHelper.isInsideRect(l.x,l.y+l.height+r/2,this.getActualWidth(l),r/2,t))return l.rowIndex}else if(i&&n&&(n=this.getTableCellWidget(t)),n){var l,h;if(this.owner.documentHelper.isInsideRect((l=n.containerWidget).x,l.y+l.height-(h=l.rowIndex===l.ownerTable.childWidgets.length-1?l.bottomBorderWidth+2:l.nextRenderedWidget.topBorderWidth+2),l.width,2*h,t))return this.currentResizingTable=l.ownerTable,l.rowIndex;if(n.childWidgets.length>0)return this.getRowReSizerPosition(n,t)}return-1},s.prototype.handleResizing=function(e){0===this.resizeNode?this.resizeTableCellColumn(e.x-this.startingPoint.x):this.resizeTableRow(e.y-this.startingPoint.y)},s.prototype.resizeTableRow=function(e){var t=this.currentResizingTable;if(!(0,a.le)(t)&&0!==e&&-1!==this.resizerPosition){var i=this.owner.selection;t.isInsideTable&&(this.owner.isLayoutEnabled=!1);var n=void 0;if(this.resizerPosition>-1&&((n=t.childWidgets[this.resizerPosition])&&this.updateRowHeight(n,e),i.selectPosition(i.start,i.end)),t.isInsideTable){var r=this.owner.documentHelper.layout.getParentTable(t);this.owner.isLayoutEnabled=!0,t=r}this.startingPoint.y+=w.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(t),this.owner.editorModule.reLayout(this.owner.selection),n&&this.getRowReSizerPosition(void 0,this.startingPoint),this.currentResizingTable&&(void 0===this.currentResizingTable.childWidgets||void 0===this.currentResizingTable.childWidgets[this.resizerPosition])&&(this.resizerPosition=-1)}},s.prototype.getTableWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!(0,a.le)(i))for(var n=0;n<i.bodyWidgets.length&&(t=this.getTableWidgetFromWidget(e,i.bodyWidgets[n]),(0,a.le)(t));n++)if("Pages"===this.documentHelper.owner.layoutType){if(t=this.getTableWidgetFromWidget(e,i.headerWidget),!(0,a.le)(t))break;if(t=this.getTableWidgetFromWidget(e,i.footerWidget),!(0,a.le)(t))break}return t},s.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[i]instanceof k){var n=t.childWidgets[i],r=0;if(n.wrapTextAround&&(r=n.getTableCellWidth()),!n.wrapTextAround&&n.y<=e.y&&n.y+n.height>=e.y||n.wrapTextAround&&n.x<=e.x&&n.x+r>=e.x&&n.y<=e.y&&n.y+n.height>=e.y)return n}},s.prototype.getTableCellWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!(0,a.le)(i))for(var n=0;n<i.bodyWidgets.length&&(t=i.bodyWidgets[n].getTableCellWidget(e),(0,a.le)(t));n++)if("Pages"===this.documentHelper.owner.layoutType){if(t=i.headerWidget.getTableCellWidget(e),!(0,a.le)(t))break;if(t=i.footerWidget.getTableCellWidget(e),!(0,a.le)(t))break}return t},s.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var n=i.ownerBase,r=this.owner.documentHelper.layout.getRowHeight(n,[n]);r+t>=2.7&&i.height!==r+t&&(i.height=r+t)}else i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},s.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!((0,a.le)(t)||0===e||(0,a.le)(t.childWidgets)||this.resizerPosition<0)){var i=!0,n=this.owner.selection;this.owner.editor.setOffsetValue(n),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t);var r=t.getOwnerWidth(!0),o=t.leftIndent,l=t.tableFormat.tableAlignment;if(n.isEmpty||(i=this.resizeColumnWithSelection(n,t,e)),!i)return void this.updateGridValue(t,!0);if(0===this.resizerPosition){var d=t.tableHolder.columns[this.resizerPosition],c=d.preferredWidth;if(e>0){var u=e;do{if((p=w.round(d.preferredWidth-e,1))>=d.minWidth){d.preferredWidth=p,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}u=e,e+=p-d.minWidth}while(e!==u)}else{u=e;do{var p;if((p=w.round(d.preferredWidth-e,1))<=2112){d.preferredWidth=p,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}u=e,e-=p-2112}while(e!==u)}var f=e;"Left"!==l&&t.tableHolder.getTotalWidth(0)>r&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType):d.preferredWidth=c,f=0),"Center"===l&&(t.tableHolder.getTotalWidth(0)<r||"Auto"!==t.tableFormat.preferredWidthType)&&(f/=2),t.tableFormat.leftIndent="Left"===l?o:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,f)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,r);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,n.selectPosition(n.start,n.end)}},s.prototype.resizeColumnWithSelection=function(e,t,i){var n=this.getTableCellWidget(this.startingPoint);if(n&&(e.selectedWidgets.containsKey(n)||n.previousWidget&&e.selectedWidgets.containsKey(n.previousWidget))){var r=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,r);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),l=0;l<o.length;l++)-1!==r.indexOf(h=o[l])&&this.increaseOrDecreaseWidth(h,i,!0);this.updateRowsGridAfterWidth(t),t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var d=this.resizerPosition,c=(o=this.getColumnCells(t,d,!0),this.getColumnCells(t,d,!1)),u=this.isColumnSelected(t,d);if(o.length>0&&!u)for(l=0;l<o.length;l++)-1===r.indexOf(o[l])&&(o.splice(l,1),l--);if(c.length>0&&!u)for(l=0;l<c.length;l++)-1===r.indexOf(c[l])&&(c.splice(l,1),l--);if(0===o.length&&c.length>0)for(l=0;l<c.length;l++)(h=c[l]).previousWidget&&o.push(h.previousWidget);else if(0===c.length&&o.length>0)for(l=0;l<o.length;l++){var h;(h=o[l]).nextWidget&&c.push(h.nextWidget)}this.changeWidthOfCells(t,o,c,i),t.tableFormat.allowAutoFit&&t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},s.prototype.resizeColumnAtStart=function(e,t,i){var n=e.leftIndent,o=i[0].ownerRow,l=o.rowFormat;if(l.beforeWidth>0){var h=l.beforeWidth+t;if(h>0)this.updateGridBefore(o,t);else if(h<(d=this.getLeastGridBefore(e,o))&&0!==h){e.tableFormat.leftIndent=(n=e.leftIndent+h)>=-1440?n<=1440?n:1440:-1440;for(var c=0;c<e.childWidgets.length;c++)o!==(u=e.childWidgets[c])&&this.updateGridBefore(u,-h)}}else if(t<0)e.tableFormat.leftIndent=(n=e.leftIndent+t)>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{var d=this.getLeastGridBefore(e,o);if(0===e.tableFormat.leftIndent)for(c=0;c<e.childWidgets.length;c++)-1!==i.indexOf((u=e.childWidgets[c]).childWidgets[0])&&(this.updateGridBefore(u,t),this.increaseOrDecreaseWidth(u.childWidgets[0],t,!1));else if(d-t>0)e.tableFormat.leftIndent=(n=e.leftIndent+t)>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else for(e.tableFormat.leftIndent=(n=e.leftIndent+d)>=-1440?n<=1440?n:1440:-1440,c=0;c<e.childWidgets.length;c++){var u;-1!==i.indexOf((u=e.childWidgets[c]).childWidgets[0])?(this.increaseOrDecreaseWidth(u.childWidgets[0],t,!1),this.updateGridBefore(u,t-d)):this.updateGridBefore(u,-d)}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},s.prototype.updateWidthForCells=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];-1!==t.indexOf(r.childWidgets[0])?this.increaseOrDecreaseWidth(r.childWidgets[0],i,!1):this.updateGridBefore(r,-i)}},s.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var n=e.tableFormat.tableAlignment,o=e.tableFormat.preferredWidth,h=e.tableHolder.columns[this.resizerPosition-1],d=0;t!==d;){var c=w.round(h.preferredWidth+t,1);c>=h.minWidth?(h.preferredWidth=c,d=t):(d=t,t-=c-h.minWidth)}this.updateCellPreferredWidths(e),(o||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));var u=t;"Right"===n?u=0:"Center"===n&&(u/=2),this.updateGridValue(e,!0,u)},s.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,n=e.tableHolder.columns[i-1],r=e.tableHolder.columns[i];if(t>0)for(var o=!0;o;)(l=w.round(r.preferredWidth-t,1))>=r.minWidth?(r.preferredWidth=l,n.preferredWidth=n.preferredWidth+t,o=!1):t+=l-r.minWidth;else for(o=!0;o;){var l;(l=w.round(n.preferredWidth+t,1))>=n.minWidth?(n.preferredWidth=l,r.preferredWidth=r.preferredWidth-t,o=!1):t-=l-n.minWidth}this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},s.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var n=this.documentHelper.layout.getParentTable(e);this.documentHelper.layout.reLayoutTable(n)}else this.documentHelper.layout.reLayoutTable(e);this.owner.editor.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.reLayout(this.owner.selection),i&&(this.startingPoint.x+=w.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},s.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];i?h.columnIndex+h.cellFormat.columnSpan===t&&n.push(h):h.columnIndex===t&&n.push(h)}return n},s.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},s.prototype.getLeastGridBefore=function(e,t){for(var i=0,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o!==t&&(0===n&&(i=o.rowFormat.beforeWidth,n++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},s.prototype.increaseOrDecreaseWidth=function(e,t,i){var n=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(n=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var r=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(r=e.convertPointToPercent(r)),e.cellFormat.preferredWidth=i?n+t>r?n+t:r:n-t>r?n-t:r},s.prototype.changeWidthOfCells=function(e,t,i,n){if(t.length>0){for(var r=!1,o=0;o<t.length;o++)this.increaseOrDecreaseWidth(l=t[o],n,!0),l.cellIndex===l.ownerRow.childWidgets.length-1&&(r=!0);r&&this.updateRowsGridAfterWidth(e)}if(i.length>0){var h=0;for(o=0;o<i.length;o++){var l;if(0===(l=i[o]).cellIndex){var d=l.ownerRow.rowFormat.beforeWidth+n;d>=0?this.updateGridBefore(l.ownerRow,n):(h!==d&&(h=d),l.ownerRow.rowFormat.gridBeforeWidth=0,l.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(l,n,!1)}if(0!==h){var c=e.leftIndent+h;e.tableFormat.leftIndent=c>=-1440?c<=1440?c:1440:-1440;for(var u=0;u<e.childWidgets.length;u++){var p=e.childWidgets[u];-1===i.indexOf(p.childWidgets[0])&&this.updateGridBefore(p,h>0?h:-h)}}}},s.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=this.getRowWidth(n,!0);if(t>=r&&n.rowFormat.afterWidth!==t-r){var o=t-r;n.rowFormat.gridAfterWidth=o,n.rowFormat.afterWidth=o}}},s.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var n=0;n<e.childWidgets.length;n++)i+=e.childWidgets[n].cellFormat.cellWidth;return i},s.prototype.getMaxRowWidth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n],o=0;t&&(o+=r.rowFormat.beforeWidth);for(var l=0;l<r.childWidgets.length;l++)o+=r.childWidgets[l].cellFormat.cellWidth;i<o&&(i=o)}return i},s.prototype.isColumnSelected=function(e,t){for(var n=this.owner.selection.getSelectedCells(),r=this.getColumnCells(e,t,!0),o=this.getColumnCells(e,t,!1),l=!1,h=0;h<r.length;h++)l=-1!==n.indexOf(r[h]);if(!l)for(h=0;h<o.length;h++)l=-1!==n.indexOf(o[h]);return l},s.prototype.applyProperties=function(e,t){if(!(0,a.le)(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=t.rows[i];n.rowFormat.gridBefore=r.gridBefore,n.rowFormat.gridBeforeWidth=r.gridBeforeWidth,n.rowFormat.gridBeforeWidthType=r.gridBeforeWidthType,n.rowFormat.gridAfter=r.gridAfter,n.rowFormat.gridAfterWidth=r.gridAfterWidth,n.rowFormat.gridAfterWidthType=r.gridAfterWidthType;for(var o=0;o<n.childWidgets.length;o++){var l=n.childWidgets[o],h=r.cells[o];l.columnIndex=h.columnIndex,l.cellFormat.columnSpan=h.columnSpan,l.cellFormat.preferredWidth=h.preferredWidth,l.cellFormat.preferredWidthType=h.preferredWidthType}}var d=e.getOwnerWidth(!0),c=e.getTableClientWidth(d);e.setWidthToCells(c,"Auto"===e.tableFormat.preferredWidthType)}},s.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].cellFormat.cellWidth;return t},s.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t],n=i.rowFormat;n.gridBefore>0&&(n.gridBeforeWidth=n.beforeWidth,n.gridBeforeWidthType="Point");for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}n.gridAfter>0&&(n.gridAfterWidth=n.afterWidth,n.gridAfterWidthType="Point")}},s.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(n.rowFormat.gridBefore>0){var r=e.tableHolder.getCellWidth(0,n.rowFormat.gridBefore,t);this.updateGridBeforeWidth(r,n)}for(var o=0;o<n.childWidgets.length;o++){var l=n.childWidgets[o];l.updateWidth(e.tableHolder.getCellWidth(l.columnIndex,l.cellFormat.columnSpan,t))}n.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(n.childWidgets.length,n.rowFormat.gridAfter,t),n)}},s.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.beforeWidth,n);i.gridBeforeWidth=r}},s.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.afterWidth,n);i.gridAfterWidth=r}},s.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},s}(),Ir=function(){function s(e){var t=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isInsertText=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.isUserInsert=!1,this.tableResize=void 0,this.tocStyles={},this.triggerPageSpellCheck=!0,this.chartType=!1,this.removedBookmarkElements=[],this.tocBookmarkId=0,this.copiedData=void 0,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.combineLastBlock=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.onTextInputInternal=function(){if(a.AR.isDevice){var i=t.documentHelper,n=new RegExp(String.fromCharCode(160),"g"),r=new RegExp(String.fromCharCode(10),"g");i.prefix=i.prefix.replace(n," ").replace(r," ");var l=(o=i.editableDiv.textContent.replace(n," ").replace(r," ")).substring(2);if(i.isCompositionStart&&i.isCompositionUpdated)return i.isCompositionUpdated=!1,void(!i.owner.isReadOnlyMode&&i.owner.isDocumentLoaded&&t.canEditContentControl&&i.prefix.substring(2)!==l&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(i.selection.start.currentWidget,t.selection.start.offset-(i.prefix.length-2)),t.handleTextInput(l),i.prefix="@"+String.fromCharCode(160)+l):(t.handleTextInput(l),i.prefix="@"+String.fromCharCode(160)+l)));if(i.isCompositionStart&&i.isCompositionEnd&&""===i.suffix)return i.prefix.substring(2)!==l?t.selection.isEmpty&&i.isCompositionStart?(i.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(i.selection.start.currentWidget,t.selection.start.offset-i.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),(""===i.suffix||""===l)&&t.handleTextInput(l)):t.selection.isEmpty||(i.isCompositionStart=!1,t.handleTextInput(l)):""===l?(i.isCompositionStart=!1,t.handleBackKey()):i.prefix.substring(2)===l&&""===i.suffix&&(i.isCompositionStart=!1,t.handleTextInput(" ")),void(i.isCompositionEnd=!1);if(i.isCompositionEnd||i.isCompositionStart&&!i.isCompositionUpdated){if(l.length<i.prefix.length&&l===i.prefix.substring(2,i.prefix.length-1)||i.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==i.suffix&&i.editableDiv.innerText[i.editableDiv.innerText.length-1]!==String.fromCharCode(160))return i.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(i.selection.start.currentWidget,t.selection.start.offset-(i.prefix.length-2)),t.selection.end.setPositionForLineWidget(i.selection.end.currentWidget,t.selection.end.offset+i.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(l)}"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!i.owner.isReadOnlyMode&&!1===i.isControlPressed&&t.canEditContentControl&&("@"===o||"@"!==o[0]||""===o||o.length<i.prefix.length&&l===i.prefix.substring(2,i.prefix.length-1)?(t.handleBackKey(),i.editableDiv.innerText.length<2&&t.predictText()):0===o.indexOf(i.prefix)&&o.length>i.prefix.length?t.handleTextInput(o.substring(i.prefix.length)):-1===o.indexOf(i.prefix)&&o[o.length-1]!==String.fromCharCode(160)&&" "!==o[o.length-1]?(l.charAt(0).toLowerCase()+l.slice(1)===i.prefix.substring(2)&&t.selection.start.setPositionParagraph(i.selection.start.currentWidget,t.selection.start.offset-(i.prefix.length-2)),t.handleTextInput(l)):2!==o.length&&t.handleTextInput(" "))}else{var o;(o=t.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(o):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""}},this.onPaste=function(i){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(i),i.preventDefault()},this.documentHelper=e,this.tableResize=new ls(this.documentHelper.owner),this.base64=new Nn}return Object.defineProperty(s.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"canEditContentControl",{get:function(){return!(this.owner.isReadOnlyMode||this.selection.checkContentControlLocked())},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){if(!(0,a.le)(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"Editor"},s.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);(0,a.le)(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},s.prototype.insertField=function(e,t){this.isInsertField=!0;var i=e;if("NUMPAGES"===(i=w.trimStart(i)).substring(0,8))this.insertPageCount(t);else if("PAGE"===i.substring(0,4))this.insertPageNumber(t);else{if((0,a.le)(t)&&"MERGEFIELD"===i.substring(0,10)){var n=(i=i.substring(10).trim()).indexOf("\\*");t="\xab"+i.substring(0,n).trim()+"\xbb"}var r=new I,o=new ie,l=this.copyInsertFormat(o,!1),h=new oe(r),d=new H(0);d.characterFormat.mergeFormat(l),h.children.push(d);var c=new S;c.characterFormat.mergeFormat(l),c.text=e,h.children.push(c);var u=new H(2);u.characterFormat.mergeFormat(l),u.fieldBegin=d,d.fieldSeparator=u,h.children.push(u);var p=new S;p.text=t,p.characterFormat.mergeFormat(l),h.children.push(p);var f=new H(1);f.characterFormat.mergeFormat(l),f.fieldSeparator=u,f.fieldBegin=d,d.fieldEnd=f,u.fieldEnd=f,h.children.push(f),d.line=h,r.childWidgets.push(h),this.documentHelper.fields.push(d);var g=new j;g.sectionFormat=new je(g),g.childWidgets.push(r),this.pasteContentsInternal([g],!1)}this.isInsertField=!1},s.prototype.isLinkedStyle=function(e){var t=this.documentHelper.styles.findByName(e);return!(0,a.le)(t.link)},s.prototype.applyStyle=function(e,t){t=!(0,a.le)(t)&&t;var i=void 0,n=void 0;if(this.owner.notify(zt,{}),t){this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),i=this.startOffset,n=this.endOffset;var r=this.selection.isEmpty;this.clearFormattingInternal(!this.isLinkedStyle(e)),r&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start)}var o=this.documentHelper.styles.findByName(e);if(void 0!==o)if(o instanceof gt&&"Character"===o.type)if(this.selection.isEmpty){var l=this.selection.start.offset,h=this.selection.start.clone(),d=this.selection.end.clone();this.selection.selectCurrentWord(),l===this.selection.start.offset||l===this.selection.end.offset-1?(this.selection.start=h,this.selection.end=d,this.selection.characterFormat.copyFormat(o.characterFormat)):this.onApplyCharacterFormat("styleName",o,!1,!0)}else this.onApplyCharacterFormat("styleName",o,!1,!0);else this.onApplyParagraphFormat("styleName",o,!1,!0);else this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e);this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=i,this.endOffset=n,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},s.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},s.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},s.prototype.enforceProtection=function(e,t,i){var n,r;"boolean"==typeof t?(n=i?"ReadOnly":this.documentHelper.protectionType,r=t):(r=!0,n=t),this.documentHelper.restrictFormatting=r,this.documentHelper.protectionType=n,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType)},s.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)(0,a.le)(e.ownerComment)?t=e.replyComments.indexOf(e)+";"+t:(t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment);return"C;"+this.documentHelper.comments.indexOf(e)+";"+t},s.prototype.alertBox=function(){var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),se.hZ.alert(e.getConstant("Multiple Comment"))},s.prototype.insertComment=function(e){if(!((0,a.le)(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter)&&this.viewer.owner.enableComment){if(this.viewer.owner.commentReviewPane.commentPane.isEditMode)return this.alertBox();(0,a.le)(e)&&(e=""),this.insertCommentInternal(e)}},s.prototype.insertCommentInternal=function(e){if(this.selection.isEmpty){if(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd){var t=this.selection.start.offset;this.selection.start.offset=t-1!=-1?t-1:t}this.selection.selectCurrentWord(),this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1)}var i=this.selection.getParagraphInfo(this.selection.start),r=(this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),this.selection.getParagraphInfo(this.selection.end));this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.initComplexHistory("InsertComment");var l=this.selection.start,h=this.selection.end,d=new Z(this.owner);this.selection.isForward||(l=this.selection.end,h=this.selection.start),d.setPositionInternal(h);var c=new ae(0),u=new ae(1),p=l.currentWidget===h.currentWidget;if(h.setPositionInternal(l),this.initInsertInline(c),(0,a.le)(d.paragraph)){var f=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),g=this.selection.getTextPosBasedOnLogicalIndex(f);d.setPositionInternal(g)}p&&d.setPositionParagraph(d.currentWidget,d.offset+c.length),l.setPositionInternal(d),h.setPositionInternal(d),this.initInsertInline(u);var m=new qt(w.getUtcDate());this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(m)),m.author=this.owner.currentUser?this.owner.currentUser:"Guest user",m.initial=this.constructCommentInitial(m.author),m.text=e,m.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),c.comment=m,c.commentId=m.commentId,u.comment=m,u.commentId=m.commentId,m.commentStart=c,m.commentEnd=u,this.addCommentWidget(m,!0,!0,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(m),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.isUserInsert||this.owner.commentReviewPane.commentPane.comments.get(m).postComment()},s.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){var e;for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},s.prototype.deleteComment=function(){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(0,a.le)(this.owner)||(0,a.le)(this.owner.viewer)||(0,a.le)(this.owner.documentHelper.currentSelectedComment)||this.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment)},s.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){if(e.replyComments.length>0)for(var t=e.replyComments.length-1;t>=0;t--)this.deleteCommentInternal(e.replyComments[t]);this.deleteCommentWidgetInternal(e);var i=e.commentStart,n=e.commentEnd;-1!==n.indexInOwner&&this.removeInline(n),-1!==i.indexInOwner&&this.removeInline(i),i.removeCommentMark()}this.editorHistory&&this.editorHistory.updateComplexHistory()},s.prototype.deleteCommentWidgetInternal=function(e){this.owner.editorHistory&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()},s.prototype.deleteCommentWidget=function(e){var t=this.documentHelper.comments.indexOf(e);-1!==t?this.documentHelper.comments.splice(t,1):e.isReply&&e.ownerComment&&(t=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(t,1)),this.owner.commentReviewPane&&(this.owner.commentReviewPane.deleteComment(e),this.documentHelper.currentSelectedComment===e&&(this.documentHelper.currentSelectedComment=void 0))},s.prototype.resolveComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Resolve"};this.owner.trigger(yt,t),(!t.cancel||"Resolve"!==t.type)&&(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!0))}},s.prototype.reopenComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Reopen"};this.owner.trigger(yt,t),(!t.cancel||"Reopen"!==t.type)&&(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!1))}},s.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t;this.owner.commentReviewPane&&(t?this.owner.commentReviewPane.resolveComment(e):this.owner.commentReviewPane.reopenComment(e)),this.reLayout(this.selection,!1,!1)},s.prototype.replyComment=function(e,t){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var i=e;if(e){this.initComplexHistory("InsertComment");var n=i.commentStart,r=i.commentEnd,o=n.line.getOffset(n,1),l=new Z(this.documentHelper.owner);l.setPositionParagraph(n.line,o);var h=r.line.getOffset(r,1),d=new Z(this.documentHelper.owner);d.setPositionParagraph(r.line,h),this.selection.start.setPositionInternal(l),this.selection.end.setPositionInternal(d),l=this.selection.start,d=this.selection.end;var c=new Z(this.owner);c.setPositionInternal(d);var u=new ae(0),p=new ae(1),f=l.currentWidget===d.currentWidget;d.setPositionInternal(l),this.initInsertInline(u),f&&c.setPositionParagraph(c.currentWidget,c.offset+u.length),l.setPositionInternal(c),d.setPositionInternal(c),this.initInsertInline(p);var g=new qt(w.getUtcDate());g.author=this.owner.currentUser?this.owner.currentUser:"Guest user",g.text=t||"",g.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),g.isReply=!0,i.replyComments.push(g),g.ownerComment=i,this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(g)),u.comment=g,u.commentId=g.commentId,p.comment=g,p.commentId=g.commentId,g.commentStart=u,g.commentEnd=p,this.owner.commentReviewPane&&this.owner.commentReviewPane.addReply(g,!1,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(g),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection)}}},s.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},s.prototype.addCommentWidget=function(e,t,i,n){if(-1===this.documentHelper.comments.indexOf(e)){var r=!1;if(this.documentHelper.comments.length>0)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,l=0;l<this.documentHelper.comments.length;l++){var h=this.selection.getElementPosition(this.documentHelper.comments[l].commentStart).startPosition;if(o.isExistBefore(h)){r=!0,this.documentHelper.comments.splice(l,0,e);break}}r||this.documentHelper.comments.push(e),this.owner.commentReviewPane&&(this.owner.showComments=i,this.owner.commentReviewPane.selectedTab=0,this.owner.commentReviewPane.addComment(e,t,n),n&&this.owner.selection.selectComment(e))}},s.prototype.addReplyComment=function(e,t){var i=t.split(";"),n=this.documentHelper.comments[parseInt(i[1],10)];""!==i[2]&&(n.replyComments.splice(parseInt(i[2],10),0,e),e.ownerComment=n),this.owner.commentReviewPane&&(this.owner.showComments=!0,this.owner.commentReviewPane.addReply(e,!1,!0),this.owner.selection.selectComment(e))},s.prototype.addProtection=function(e,t){if(""===e)this.protectDocument(t);else{this.currentProtectionType=t;var i=new xt,r={passwordBase64:this.base64.encodeString(e),saltBase64:"",spinCount:1e5};i.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,i.contentType="application/json;charset=UTF-8",i.onSuccess=this.enforceProtectionInternal.bind(this),i.onFailure=this.protectionFailureHandler.bind(this),i.onError=this.protectionFailureHandler.bind(this),i.customHeaders=this.owner.headers;var l={serverActionType:"RestrictEditing",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1};this.owner.trigger(Tt,l),l.cancel?this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide():i.send(r,l)}},s.prototype.protectionFailureHandler=function(e){var t=new a.E7("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),"onError"===e.name?se.hZ.alert(t.getConstant("Error in establishing connection with web server")):(this.owner.fireServiceFailure(e),console.error(e.statusText))},s.prototype.enforceProtectionInternal=function(e){var t=JSON.parse(e.data);this.documentHelper.saltValue=t[0],this.documentHelper.hashValue=t[1],this.protectDocument(this.currentProtectionType)},s.prototype.toggleTrackChangesProtection=function(e){this.viewer.owner.enableTrackChanges=e,this.owner.trigger(li,{isTrackChangesEnabled:e})},s.prototype.protectDocument=function(e){this.protect(e);var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&(this.documentHelper.restrictEditingPane.showStopProtectionPane(!0),this.documentHelper.restrictEditingPane.loadPaneValue(),this.documentHelper.dialog.hide()),this.owner.notify(ci,{}),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1)},s.prototype.stopProtection=function(e){if(this.documentHelper.isDocumentProtected){if(!(0,a.le)(this.documentHelper.saltValue)&&""===this.documentHelper.saltValue&&!(0,a.le)(this.documentHelper.hashValue)&&""===this.documentHelper.hashValue&&!(0,a.le)(e)&&""===e)return void this.unProtectDocument();var t=new xt,n={passwordBase64:this.base64.encodeString(e),saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this);var r={serverActionType:"RestrictEditing",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1};this.owner.trigger(Tt,r),r.cancel?this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide():t.send(n,r),this.toggleTrackChangesProtection(!1)}},s.prototype.onUnProtectionSuccess=function(e){var t=JSON.parse(e.data);this.validateHashValue(t[1])},s.prototype.validateHashValue=function(e){var t=new a.E7("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);var i=this.base64.decodeString(e),r=this.base64.decodeString(this.documentHelper.hashValue),o=!0;if(i.length===r.length){for(var l=0;l<i.length;l++)if(i[l]!==r[l]){o=!1;break}}else o=!1;o?this.unProtectDocument():se.hZ.alert(t.getConstant("The password is incorrect"))},s.prototype.unProtectDocument=function(){var e=this.documentHelper.protectionType;this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion();var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&this.documentHelper.restrictEditingPane.showStopProtectionPane(!1),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),(0,a.le)(this.editorHistory)||this.owner.editorHistory.clearHistory(),this.owner.notify(ci,{}),this.documentHelper.dialog.hide()},s.prototype.fireContentChange=function(){this.selection.isHighlightEditRegion&&(this.owner.enableLockAndEdit?this.owner.collaborativeEditingModule.updateLockRegion():this.selection.onHighlight()),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),this.documentHelper.owner.isLayoutEnabled&&!this.documentHelper.owner.editor.isUserInsert&&!this.documentHelper.owner.isShiftingEnabled&&this.documentHelper.owner.fireContentChange(),(0,a.le)(this.selection.editPosition)||(this.triggerPageSpellCheck=!1)},s.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},s.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},s.prototype.getPrefixAndSuffix=function(){var t=this.owner.documentHelper;if(""===this.selection.text){var i=0,n=this.selection.start.currentWidget.getInline(this.selection.start.offset,i),r=n.element;if(i=n.index,void 0!==r){var o=this.selection.getElementBoxInternal(r,i),l=o.element;i=o.index;var h=0;if(!(0,a.le)(l)){var d=!1;for(l instanceof S&&i>0&&l.line.isFirstLine()&&(t.prefix=""),r instanceof S||(r=this.selection.getPreviousTextElement(r));(h=t.prefix.lastIndexOf(" "))<0&&r instanceof S;)if(r.previousNode instanceof S&&-1===t.prefix.indexOf(" ")){if(d?t.prefix=r.text+t.prefix:(t.prefix=r.text.substring(0,i),d=!0),(r=r.previousNode)instanceof _)break;r instanceof S||(r=this.selection.getPreviousTextElement(r))}else if(!(r.previousNode instanceof S)){d?t.prefix=r.text+t.prefix:(t.prefix=r.text.substring(0,i),d=!0);break}t.prefix.length>1&&" "===t.prefix[t.prefix.length-1]&&"."===t.prefix[t.prefix.length-2]?(h=-1,t.prefix=""):h=t.prefix.lastIndexOf(" "),t.prefix=h<0?t.prefix:t.prefix.substring(h),0===t.prefix.indexOf(" ")&&t.prefix.length>=1&&(t.prefix=t.prefix.substring(1));var c=0,u=this.selection.end.currentWidget.getInline(this.selection.end.offset,c),p=u.element;if(c=(o=this.selection.getElementBoxInternal(p,c=u.index)).index,l=o.element){var f=!1;for(l instanceof S&&c<l.length&&(t.suffix="");(h=t.suffix.indexOf(" "))<0&&p instanceof S;)if(p.nextNode instanceof S&&-1===t.suffix.indexOf(" "))f?t.suffix=t.suffix+p.text:(t.suffix=l.text.substring(c),f=!0),p=p.nextNode;else if(!(p.nextNode instanceof S)){f?t.suffix=t.suffix+p.text:(t.suffix=l.text.substring(c),f=!0);break}h=t.suffix.indexOf(" "),t.suffix=h<0?t.suffix:t.suffix.substring(0,h)}}}}else t.prefix=""},s.prototype.onKeyDownInternal=function(e,t,i,n){var r=e.which||e.keyCode;if(!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(r){case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.trigger(li,{isTrackChangesEnabled:!this.owner.enableTrackChanges})}else if(!i&&t&&n)switch(r){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(r){case 8:e.preventDefault(),this.handleBackKey();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!0,!1);break;case 13:e.preventDefault(),this.documentHelper.triggerSpellCheck=!0,this.handleEnterKey(),this.documentHelper.triggerSpellCheck=!1;break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var d=this.selection.getDocumentEnd();d.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(d)?this.owner.updateFields():this.selection.updateRefField()}else switch(r){case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!0);break;case 13:this.handleShiftEnter(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,r){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var o=0,l=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;l>12?o=12:l>0&&l<=12?o=0:0===l&&(o=12),this.onApplyParagraphFormat("beforeSpacing",o,!0,!1);break;case 49:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleBold();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.fontDialogModule&&this.owner.fontDialogModule.showFontDialog();break;case 69:(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),!this.owner.isReadOnly&&this.owner.optionsPaneModule&&(this.owner.optionsPaneModule.isReplace=!0,this.owner.optionsPaneModule.showHideOptionsPane(!0));break;case 73:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleItalic();break;case 74:(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.hyperlinkDialogModule&&!this.owner.isReadOnlyMode&&this.owner.hyperlinkDialogModule.show();break;case 76:(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.owner.selection.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.owner.selection.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.toggleBaselineAlignment("Subscript")}},s.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},s.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},s.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},s.prototype.handleEnterKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(a.AR.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},s.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(e=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if(((0,a.le)(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof k)&&0===e.offset)return;this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()}},s.prototype.handleCtrlDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.selection.isEmpty?(this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete()):(this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey(),w.endsWith(this.selection.text)&&this.selection.handleShiftLeftKey(),this.owner.editorModule.delete()))},s.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),(0,a.s1)(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e),this.animationTimer=setTimeout(function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&(0,a.s1)(t.selection.caret,["e-de-cursor-animation"],[])},600)),this.selection.checkForCursorVisibility()},s.prototype.copyInsertFormat=function(e,t){var i=new ie,n=this.selection.characterFormat;return t&&i.copyFormat(e),!(0,a.le)(n.bidi)&&e.bidi!==n.bidi&&(i.bidi=n.bidi),!(0,a.le)(n.bold)&&e.bold!==n.bold&&(i.bold=n.bold),!(0,a.le)(n.italic)&&e.italic!==n.italic&&(i.italic=n.italic),n.fontSize>0&&e.fontSize!==n.fontSize&&(i.fontSize=n.fontSize),!(0,a.le)(n.fontFamily)&&e.fontFamily!==n.fontFamily&&(i.fontFamily=n.fontFamily),!(0,a.le)(n.highlightColor)&&e.highlightColor!==n.highlightColor&&(i.highlightColor=n.highlightColor),!(0,a.le)(n.baselineAlignment)&&e.baselineAlignment!==n.baselineAlignment&&(i.baselineAlignment=n.baselineAlignment),!(0,a.le)(n.fontColor)&&e.fontColor!==n.fontColor&&(i.fontColor=n.fontColor),!(0,a.le)(n.underline)&&e.underline!==n.underline&&(i.underline=n.underline),!(0,a.le)(n.strikethrough)&&e.strikethrough!==n.strikethrough&&(i.strikethrough=n.strikethrough),i},s.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,i="";!(t instanceof $||(t instanceof S&&(i+=t.text),(0,a.le)(t)));)if((0,a.le)(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return i},s.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var e=this.getContentControl();e&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))}},s.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)){var n=this.documentHelper.customXmlData.get(e),o=(new DOMParser).parseFromString(n,"text/xml"),l=t.substring(t.lastIndexOf("/")+1);l=(l=(l=l.split("[")[0]).substring(l.lastIndexOf(":")+1)).substring(l.lastIndexOf("@")+1);var h=o.getElementsByTagName(l);if(h.length>0)h[0].childNodes[0].nodeValue=i;else{if(!(o.documentElement.attributes.length>0&&null!==o.documentElement.attributes.getNamedItem(l)))return;o.documentElement.attributes.getNamedItem(l).value=i}var c=(new XMLSerializer).serializeToString(o);this.documentHelper.customXmlData.set(e,c)}},s.prototype.insertText=function(e){(0,a.le)(e)||""===e||this.insertTextInternal(e,!1)},s.prototype.insertTextInternal=function(e,t,i,n){if(e.indexOf("\r")>=0||e.indexOf("\n")>=0)"\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1);else{if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){var r=this.selection.getCurrentFormField(),o=this.getFieldResultText(r),l=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");o.length>0&&""===o.replace(l,"")&&(o="",this.selection.selectFieldInternal(r));var h=r.formFieldData.maxLength;if(0!==h&&o.length>=h)return}t&&(this.documentHelper.layout.allowLayout=!!(0,a.le)(n)||n);var c,d=this.documentHelper.selection,u=!0;i=this.owner.enableTrackChanges&&(0,a.le)(i)?"Insertion":i;var p=this.checkAndRemoveComments();this.isListTextSelected(),((0,a.le)(i)||"Insertion"===i)&&this.initHistory("Insert");var f=this.selection.getParagraphInfo(d.start),g=f.paragraph.paragraphFormat;d.editPosition=d.getHierarchicalIndex(f.paragraph,f.offset.toString());var m=d.start.paragraph.paragraphFormat.bidi;if(!d.isEmpty&&!d.isImageSelected||this.documentHelper.isListTextSelected&&"List"===d.contextType){d.isSkipLayouting=!0,d.skipFormatRetrieval=!0;var v=void 0;this.owner.enableTrackChanges&&(v=this.selection.start.isExistBefore(this.selection.end)?this.selection.end.clone():this.selection.start.clone(),this.skipReplace=!0),u=this.removeSelectedContents(d),this.skipReplace=!1,!(0,a.le)(v)&&this.owner.search&&this.owner.search.isRepalceTracking?(this.owner.search.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(v)):(0,a.le)(v)||(this.selection.start.setPositionInternal(v),this.selection.end.setPositionInternal(v)),d.skipFormatRetrieval=!1,d.isSkipLayouting=!1}else d.isEmpty&&!this.documentHelper.isListTextSelected&&!t&&(this.documentHelper.isTextInput=!0);(f=this.selection.getParagraphInfo(d.start)).paragraph.paragraphFormat.copyFormat(g);var y=this.documentHelper.textHelper.containsSpecialCharAlone(e);if(u){if(d.owner.isShiftingEnabled=!0,this.updateInsertPosition(),(c=d.start).paragraph.isEmpty()){var b=new S,C=this.copyInsertFormat(c.paragraph.characterFormat,!0);b.characterFormat.copyFormat(C),b.text=e;var F=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi;if(b.characterFormat.bidi=F,b.isRightToLeft=F,b.line=c.paragraph.childWidgets[0],b.margin=new $e(0,0,0,0),b.line.children.push(b),this.owner.enableTrackChanges)if(b.paragraph.characterFormat.revisions.length>0){var T=this.getMatchedRevisionsToCombine(b.paragraph.characterFormat.revisions,i);T.length>0&&this.mapMatchedRevisions(T,b.paragraph.characterFormat,b,!0)}else this.checkToCombineRevisionWithPrevPara(b,i)||this.insertRevision(b,i);("Center"===c.paragraph.paragraphFormat.textAlignment||"Right"===c.paragraph.paragraphFormat.textAlignment)&&-1===c.paragraph.paragraphFormat.listFormat.listId&&(c.paragraph.x=this.owner.viewer.clientActiveArea.x),this.documentHelper.layout.reLayoutParagraph(c.paragraph,0,0)}else{var x=0,P=c.currentWidget.getInline(c.offset,x,m,!t);x=P.index,(r=P.element).ischangeDetected=!0,r instanceof S&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellChecker.removeErrorsFromCollection({element:r,text:r.text}),t||(r.ignoreOnceItems=[])),r.canTrigger&&r.text.length<=1&&(r.canTrigger=!1),C=this.copyInsertFormat(r.characterFormat,!0),F=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,this.documentHelper.textHelper.getRtlLanguage(e);var L=0,W=!1,R=!1;if(r instanceof S&&(L=this.documentHelper.textHelper.getRtlLanguage(r.text).id,W=this.documentHelper.textHelper.getRtlLanguage(r.text).isRtl,R=this.documentHelper.textHelper.containsSpecialCharAlone(e)),(!F&&r.characterFormat.bidi&&(0!==L||R&&W)||" "===e&&this.selection.characterFormat.bidi)&&(F=!0),(F||!this.documentHelper.owner.isSpellCheck)&&(C.bidi=F),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==r.text)&&C.isSameFormat(r.characterFormat)&&this.canInsertRevision(r,i)||""===e.trim()&&!F&&r.characterFormat.bidi||W&&C.isSameFormat(r.characterFormat)&&y)this.insertTextInline(r,d,e,x);else{var N=new S;N.text=e,N.line=r.line,N.isRightToLeft=W,N.characterFormat.copyFormat(C),r instanceof Ee&&(N.characterFormat.baselineAlignment="Normal");var X,B=!1,q=r.indexInOwner,A=N.revisions.length;if(x===r.length)X=q+1,this.owner.enableTrackChanges&&!(r instanceof O)&&!(B=this.checkToMapRevisionWithInlineText(r,x,N,F,i))&&N.revisions.length===A&&(B=null!=r.nextNode&&1==r.nextNode.revisions.length?this.checkToMapRevisionWithNextNode(r.nextNode,N,F,i):1==r.paragraph.characterFormat.revisions.length&&"Deletion"==r.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(r.nextNode,N,F,i,r.paragraph):this.checkToMapRevisionWithNextNode(r.nextNode,N,F,i)),B||(r.line.children.splice(X,0,N),this.checkToCombineRevisionsinBlocks(N,A===N.revisions.length,!0,i));else if(0===x)this.owner.enableTrackChanges&&!(B=this.checkToMapRevisionWithInlineText(r,x,N,F,i))&&0===N.revisions.length&&this.checkToMapRevisionWithPreviousNode(r.previousNode,N,F,i),B||(r.line.children.splice(q,0,N),this.checkToCombineRevisionsinBlocks(N,A===N.revisions.length,!0,i));else{if(r instanceof S){var le=new S;le.line=r.line,le.characterFormat.copyFormat(r.characterFormat),le.text=r.text.substring(x),!this.owner.enableTrackChanges&&!this.selection.isInField&&this.updateRevisionForSpittedTextElement(r,le),r.text=r.text.slice(0,x),this.owner.enableTrackChanges?(B=this.checkToMapRevisionWithInlineText(r,x,N,F,i))||N.revisions.length>A?this.copyElementRevision(r,le,!0):N.revisions.length===A&&(this.updateRevisionForSpittedTextElement(r,le),this.insertRevision(N,i)):this.selection.isInField&&(this.copyElementRevision(r,le,!1),this.updateElementInFieldRevision(r,N,r.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellChecker.updateSplittedElementError(r,le),r.line.children.splice(q+1,0,le)}B||r.line.children.splice(q+1,0,N)}this.documentHelper.layout.reLayoutParagraph(c.paragraph,r.line.indexInOwner,0)}}this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(f.paragraph,f.offset+e.length,!0),this.updateEndPosition(),!(0,a.le)(this.editorHistory)&&!(0,a.le)(this.editorHistory.currentHistoryInfo)&&"ListSelect"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.isListTextSelected&&(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),((0,a.le)(i)||"Insertion"===i)&&this.reLayout(d),this.documentHelper.isTextInput=!1}if(this.updateXmlMappedContentControl(),!t&&u&&(" "===e||"\t"===e||"\v"===e)){var K=!1;if("\v"!==e&&(K=this.checkAndConvertList(d,"\t"===e)),!K){if(!(0,a.le)(d.getHyperlinkField()))return;this.checkAndConvertToHyperlink(d,!1)}}this.updateHistoryForComments(p)}},s.prototype.updateElementInFieldRevision=function(e,t,i,n){for(var r=0;r<i.length;r++){var o=i[r],l=o.range.indexOf(e);o.range.splice(n?l+1:l,0,t)}},s.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType)for(var i=e.previousElement;!(0,a.le)(i)&&i instanceof S;)t=i.text+t,i=(0,a.le)(i.previousNode)?void 0:i.previousNode.previousValidNodeForTracking;return t},s.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,n){t&&this.owner.enableTrackChanges&&!(e instanceof O||e instanceof ae||e instanceof xe||e instanceof He)&&((i?this.combineRevisionWithNextPara(e,n):this.combineRevisionWithPrevPara(e,n))||this.insertRevision(e,n))},s.prototype.checkToMapRevisionWithNextNode=function(e,t,i,n,r){if(!(0,a.le)(r)&&1==r.characterFormat.revisions.length){var o=r.characterFormat;return!(0,a.le)(o)&&this.checkToMapRevisionWithInlineText(void 0,0,t,i,n,o)}if((0,a.le)(e))return!1;var l=e.nextValidNodeForTracking;return!(0,a.le)(l)&&this.checkToMapRevisionWithInlineText(l,0,t,i,n)},s.prototype.checkToMapRevisionWithPreviousNode=function(e,t,i,n){if((0,a.le)(e))return!1;var r=e.previousValidNodeForTracking;return!(0,a.le)(r)&&this.checkToMapRevisionWithInlineText(r,r.length,t,i,n)},s.prototype.checkToMapRevisionWithInlineText=function(e,t,i,n,r,o){if((0,a.le)(o)){if(!(0,a.le)(e))if("Deletion"===r&&this.updateLastElementRevision(i),e.length===t&&null!=e.previousValidNodeForTracking){if(t=(e=e.previousValidNodeForTracking).length,e.revisions.length>0)return this.applyMatchedRevisionInorder(e,i,t,!1,n,r)}else if(0===t&&!(0,a.le)(e=e.nextValidNodeForTracking)&&e.revisions.length>0)return this.applyMatchedRevisionInorder(e,i,t,!0,n,r)}else if("Deletion"===r&&this.updateLastElementRevision(i),!(0,a.le)(o)&&o.revisions.length>0)return this.applyMatchedRevisionInorder(void 0,i,t,!0,n,r,o);return!1},s.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++){var o=t.revisions[i];-1===n.range.indexOf(t)&&o.revisionType===n.revisionType&&o.author===n.author&&(t.revisions.splice(r,1),n.range.push(t),t.revisions.splice(r,0,n))}},s.prototype.applyMatchedRevisionInorder=function(e,t,i,n,r,o,l){var h;return!(0,a.le)(l)&&(0,a.le)(e)?((h=this.getMatchedRevisionsToCombine(l.revisions,o)).length>0&&this.mapMatchedRevisions(h,l,t,n),!1):((h=this.getMatchedRevisionsToCombine(e.revisions,o)).length>0&&this.mapMatchedRevisions(h,e,t,n),!1)},s.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(o+(i?2:1),0,t)}},s.prototype.mapMatchedRevisions=function(e,t,i,n){for(var r=0;r<e.length;r++){var o=e[r];if(!this.isRevisionAlreadyIn(i,o)||i instanceof ie){i.revisions.splice(0,0,o);var l=o.range.indexOf(t);o.range.splice(n?l:l+1,0,i)}}},s.prototype.isRevisionAlreadyIn=function(e,t){if(e.revisions.length>0)for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionID===t.revisionID)return!0;return!1},s.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],n=0;n<e.length;n++)this.isRevisionMatched(e[n],t)&&i.push(e[n]);return i},s.prototype.decideInlineForTrackChanges=function(e,t){var i=!1;if(this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)){var n=e.nextValidNodeForTracking;!(0,a.le)(n)&&this.canInsertRevision(n,t)&&(e=n,i=!0)}return{element:e,isMatched:i}},s.prototype.insertIMEText=function(e,t){if(this.documentHelper.lastComposedText!==e||!t){var i=this.selection.getParagraphInfo(this.selection.start),n=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e),this.documentHelper.lastComposedText=e;var r=this.selection.start;this.setPositionForCurrentIndex(r,n);var o=new Z(this.owner);o.setPositionForLineWidget(r.currentWidget,r.offset+e.length),this.selection.selectPosition(t?r:o,o)}},s.prototype.insertSectionBreak=function(){var e=this.documentHelper.selection;(0,a.le)(e)||this.owner.isReadOnlyMode||e.start.paragraph.isInHeaderFooter||(this.initHistory("SectionBreak"),e.isEmpty||e.selectContent(e.isForward?e.start:e.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),this.insertSection(e,!0),this.updateEndPosition(),this.reLayout(e,!0),this.layoutWholeDocument(!0))},s.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!(0,a.le)(e)){for(;e instanceof O||e instanceof ae;)e=e.nextElement;if(!(0,a.le)(e)){var i=e.paragraph.previousRenderedWidget;if(!(i instanceof k)){if(!(0,a.le)(i)&&!i.isEmpty()&&i.characterFormat.revisions.length>0){var n=i.lastChild;if((0,a.le)(n)||0===n.children.length)return;for(var r=n.children[n.children.length-1];r instanceof O||r instanceof ae;)r=r.previousElement;if(r.revisions.length>0&&this.compareElementRevision(i.characterFormat,e)){var o=e.revisions[e.revisions.length-1];this.compareElementRevision(r,e)&&o!==(l=r.revisions[r.revisions.length-1])&&this.clearAndUpdateRevisons(o.range,l,l.range.indexOf(r)+1)}}i=null;var h=e.paragraph.lastChild,c=(e=h.children[h.children.length-1]).paragraph.nextRenderedWidget;if(!(c instanceof k)){if(!(0,a.le)(c)&&!c.isEmpty()&&e.paragraph.characterFormat.revisions.length>0){for(var p=c.firstChild.children[0];p instanceof O||p instanceof ae;)p=p.previousElement;if((0,a.le)(p))return;if(p.revisions.length>0){var l,f=p.revisions[p.revisions.length-1];this.compareElementRevision(e.paragraph.characterFormat,p)&&this.compareElementRevision(e,p)&&f!==(l=e.revisions[e.revisions.length-1])&&this.clearAndUpdateRevisons(f.range,l,l.range.indexOf(e)+1)}}0===e.revisions.length&&this.insertRevision(e,t)}}}}},s.prototype.checkToCombineRevisionWithNextPara=function(e,t){var i=e.paragraph.nextRenderedWidget;if(i instanceof k)return!1;if(!(0,a.le)(i)&&!i.isEmpty()){for(var r=i.firstChild.children[0];r instanceof O||r instanceof ae;)r=r.previousElement;if((0,a.le)(r))return!1;if(r.revisions.length>0){var o=this.getMatchedRevisionsToCombine(r.revisions,t);if(o.length>0)return this.mapMatchedRevisions(o,r,e,!0),!0}}return!1},s.prototype.checkToCombineRevisionWithPrevPara=function(e,t){var i=e.paragraph.previousRenderedWidget;if(i instanceof k)return!1;if(!(0,a.le)(i)&&i.characterFormat.revisions.length>0){if(!this.isRevisionMatched(i.characterFormat,t))return!1;var n=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,t);if(n.length>0)return this.mapMatchedRevisions(n,i.characterFormat,e,!1),!0}return!1},s.prototype.combineRevisionWithNextPara=function(e,t){return!(!e.line.isLastLine()||!(0,a.le)(e.nextNode))&&this.checkToCombineRevisionWithNextPara(e,t)},s.prototype.combineRevisionWithPrevPara=function(e,t){return!(!e.line.isFirstLine()||!(0,a.le)(e.previousNode))&&this.checkToCombineRevisionWithPrevPara(e,t)},s.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(t.element.revisions.length>0)for(var n=0;n<i.revisions.length;n++)if(i.revisions[n].revisionType===e.revisionType)for(var r=i.revisions[n],o=r.range.indexOf(i),l=o;o<r.range.length;o++)r.range[l].revisions.splice(n,1),r.range.splice(l,1)},s.prototype.clearElementRevision=function(e){if(!(0,a.le)(e))for(var t=0;t<e.range.length;t++)if(e.range[t]instanceof fe){var i=e.range[t];i.revisions.splice(i.revisions.length-1,1),e.range.splice(t,1)}},s.prototype.insertRevision=function(e,t,i,n,r){i=(0,a.le)(i)?this.owner.currentUser?this.owner.currentUser:"Guest user":i;var o=(0,a.le)(n)?w.getUtcDate():n;if(e instanceof fe&&!(0,a.le)(e.line)&&e.line.paragraph.associatedCell||e instanceof ie&&e.ownerBase instanceof I&&e.ownerBase.associatedCell){var l=void 0;if(e instanceof fe?l=e.line.paragraph.associatedCell:e instanceof ie&&(l=e.ownerBase.associatedCell),l.ownerRow.rowFormat.revisions.length>0){var d=this.getMatchedRevisionsToCombine(l.ownerRow.rowFormat.revisions,t);if(d.length>0){for(var c=0;c<d.length;c++)e.revisions.splice(0,0,d[c]),d[c].range.push(e);return}}}var u=new Ke(this.owner,i,o);u.revisionType=t,u.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),!(0,a.le)(r)&&r.length>0?this.clearAndUpdateRevisons(r,u,r.indexOf(e)):(e.revisions.push(u),u.range.push(e)),this.updateRevisionCollection(u)},s.prototype.clearAndUpdateRevisons=function(e,t,i){for(var n=0;n<e.length;n++)if(e[n]instanceof fe){var r=e[n];r.revisions.splice(r.revisions.length-1,1),r.revisions.push(t),t.range.splice(i+n,0,r)}},s.prototype.splitRevisionByElement=function(e,t){if(e.revisions.length>0){var i=t.range,n=i.indexOf(e);return t.range=i.splice(0,n+1),i}},s.prototype.updateRevisionForSpittedTextElement=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);this.insertRevision(t,n.revisionType,n.author,n.date,r)}},s.prototype.isRevisionMatched=function(e,t){var i=this.owner.currentUser?this.owner.currentUser:"Guest user";if(e instanceof Ke){if(((0,a.le)(t)||t===e.revisionType)&&e.author===i)return!0}else if(e.revisions.length>0)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n];if(((0,a.le)(t)||t===r.revisionType)&&r.author===i)return!0}return!1},s.prototype.compareElementRevision=function(e,t){if(0===e.revisions.length||0===t.revisions.length)return!1;for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++)if(n.author===t.revisions[i].author&&n.revisionType===t.revisions[i].revisionType)return!0;return!1},s.prototype.canInsertRevision=function(e,t){var i=(0,a.le)(t)?"Insertion":t;return"Deletion"!==i&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,i):!(e.revisions.length>0))},s.prototype.insertRevisionAtEnd=function(e,t,i){return!(t instanceof O||t instanceof ae||t instanceof xe||t instanceof He||(e=e.previousValidNodeForTracking,(0,a.le)(e)))&&this.insertRevisionAtPosition(e,t,!0,i)},s.prototype.insertRevisionAtPosition=function(e,t,i,n){var r=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,n);return i?!o&&t.revisions.length===r&&(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,n)):!o&&t.revisions.length===r&&(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,n)),o},s.prototype.insertRevisionAtBegining=function(e,t,i){return!(t instanceof O||t instanceof ae||t instanceof xe||t instanceof He||(e=e.nextValidNodeForTracking,(0,a.le)(e)))&&this.insertRevisionAtPosition(e,t,!1,i)},s.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;i>=0;i--){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);this.insertRevision(t,n.revisionType,n.author,n.date,r)}},s.prototype.combineElementRevision=function(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++){var r=e[i],o=t[i];if(r.author===o.author&&r.revisionType===o.revisionType){for(var l=o.range.length,h=0;h<l;h++){var d=o.range[0];d.revisions.splice(d.revisions.indexOf(o),1),o.range.splice(0,1),r.range.push(d),d.revisions.push(r)}0===o.range.length&&this.owner.revisions.remove(o)}}},s.prototype.combineRevisions=function(e,t,i){if(this.owner.enableTrackChanges){var o=this.selection.getLineInfo(e,t.offset).line.getInline(t.offset,0).element;if(o.revisions.length>0&&this.isRevisionMatched(o,"Insertion")){var l=o.nextElement;if(!(0,a.le)(l)&&l.revisions.length>0){var h=o.revisions[o.revisions.length-1];this.clearAndUpdateRevisons(l.revisions[l.revisions.length-1].range,h,h.range.indexOf(o)+1)}}}},s.prototype.insertRevisionForBlock=function(e,t,i,n,r){if(0!==e.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"===t){var o=this.selection.editPosition,l=this.selection.start.clone(),h=this.selection.end.clone();this.documentHelper.layout.clearListElementBox(e);for(var d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[d];this.removeContent(c,0,this.documentHelper.selection.getLineLength(c))}this.selection.editPosition=o,this.selection.start.setPositionInternal(l),this.selection.end.setPositionInternal(h),this.removeEmptyLine(e),r||this.documentHelper.layout.reLayoutParagraph(e,0,0)}else{var u=!1;for((0,a.le)(n)&&((n=new Ke(this.owner,this.owner.currentUser?this.owner.currentUser:"Guest user",w.getUtcDate())).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),n.revisionType=t),d=0;d<e.childWidgets.length;d++){var f=e.childWidgets[d].children;if(0===f.length){var g=e.containerWidget.childWidgets.indexOf(e),m=void 0;if(g>0&&(m=e.containerWidget.childWidgets[g-1]),!(0,a.le)(m)&&m instanceof I&&m.characterFormat.revisions.length>0&&this.isRevisionMatched(m.characterFormat,t)){var v=this.getMatchedRevisionsToCombine(m.characterFormat.revisions,t);v.length>0&&(this.mapMatchedRevisions(v,m.characterFormat,e.characterFormat,!1),u=!0,n=void 0)}}for(var y=0;y<f.length;y++)if(0!==y||i)f[y].revisions.push(n),n.range.push(f[y]);else{var b=f[d].revisions.length;this.checkToCombineRevisionsinBlocks(f[d],!0,!1,"Insertion"),f[d].revisions.length>b?n=f[d].revisions[f[d].revisions.length-1]:(f[y].revisions.push(n),n.range.push(f[y]))}}!i&&!u&&(e.characterFormat.revisions.push(n),n.range.push(e.characterFormat)),(0,a.le)(n)||this.updateRevisionCollection(n)}},s.prototype.updateRevisionCollection=function(e){var t=!1,i=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),this.owner.revisions.changes.length>0)for(var n=this.owner.selection.start,r=0;r<this.owner.revisions.changes.length;r++){var o=this.owner.revisions.changes[r].range[0];if(o instanceof fe&&!(0,a.le)(o.line)&&o.line.paragraph.bodyWidget)i=this.selection.getElementPosition(this.owner.revisions.changes[r].range[0]).startPosition;else if(o instanceof De){var h=o.ownerBase.childWidgets[0];if(this.selection.getFirstParagraph(h).bodyWidget){var c=this.documentHelper.selection;this.updateEditPosition(h,c),i=this.selection.getTextPosBasedOnLogicalIndex(c.editPosition)}}else if(o instanceof ie){var u=o.ownerBase;if(u.lastChild&&u.lastChild.paragraph.bodyWidget){var p=u.getLength(),f=new Z(this.owner);f.setPositionParagraph(u.lastChild,p),i=f}}if(!(0,a.le)(i)&&!(0,a.le)(n)&&n.isExistBefore(i)){t=!0,this.owner.revisions.changes.splice(r,0,e);break}}t||this.owner.revisions.changes.push(e),this.documentHelper.updateAuthorIdentity()}},s.prototype.insertSection=function(e,t,i){var r,o,n=this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();if(e.start.paragraph.isInsideTable){var l=this.documentHelper.layout.getParentTable(e.start.paragraph);l=l.combineWidget(this.owner.viewer);var h=!1;0===e.start.paragraph.associatedCell.rowIndex&&(h=!0);var d=new I,c=l.previousRenderedWidget;h?r=l:(r=this.splitTable(l,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(r.index,r.containerWidget,r,!1),r=r.getSplitWidgets().pop());var u=0;!(0,a.le)(c)&&c.bodyWidget.equals(r.bodyWidget)||!h?(u=r.indexInOwner+1,d.index=r.index+1):(u=0,d.index=0),r.containerWidget.childWidgets.splice(u,0,d),d.containerWidget=r.containerWidget,this.updateNextBlocksIndex(d,!0),this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1),r=d}else{var p=this.selection.getParagraphInfo(e.start),f=this.selection.getHierarchicalIndex(p.paragraph,p.offset.toString());i||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,f),r=e.start.paragraph.getSplitWidgets().pop(),i&&void 0!==r.previousRenderedWidget&&(r=r.previousRenderedWidget)}return o=this.splitBodyWidget(r.bodyWidget,n,r).firstChild,i&&this.layoutWholeDocument(!0),o instanceof k&&o.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.containerWidget,o,!1),o instanceof k&&(o=e.getFirstParagraphInFirstCell(o)),t&&e.selectParagraphInternal(o,!0),o},s.prototype.splitBodyWidget=function(e,t,i){var n=this.documentHelper.layout.moveBlocksToNextPage(i,!0);return this.updateSectionIndex(t,n,!0),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(n.sectionIndex,!0),this.updateBlockIndex(0,n.firstChild),this.owner.viewer.updateClientArea(n.sectionFormat,n.page),n},s.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},s.prototype.updateBlockIndex=function(e,t){var i,n=t.bodyWidget.sectionIndex;do{i=t.getSplitWidgets();for(var r=0;r<i.length;r++)i[r].index=e;e++,t=i.pop().nextRenderedWidget}while(!(0,a.le)(t)&&t.bodyWidget.sectionIndex===n)},s.prototype.updateSectionIndex=function(e,t,i){var n=t.sectionIndex,r=t;do{r.index===n&&e&&(r.sectionFormat=e),i?r.index++:r.index--,r=r.nextRenderedWidget}while(r)},s.prototype.checkAndConvertList=function(e,t){var i=e.paragraphFormat.getList();if(!(0,a.le)(i)||e.start.paragraph.containerWidget instanceof Y)return!1;var n=!1,r=!1,o=0,l=e.start.currentWidget.getInline(e.start.offset-1,o),h=l.element;if(!(h instanceof S))return!1;for(var d=h,c=d.text.substring(0,o=l.index),u=0,p=0;!(0,a.le)(d.previousNode);){if(!(d.previousNode instanceof S)||"\t"!==d.previousNode.text&&0!==d.previousNode.text.trim().length)return!1;"\t"===d.previousNode.text?u+=36:p=2.5*d.previousNode.text.length,d=d.previousNode}d=h;var f=0,g=c.lastIndexOf("\t");for(f=g>=0?g+1:c.lastIndexOf(" ")+1;d.previousNode instanceof S&&0===f;){var m=(d=d.previousNode).text;f=(g=m.lastIndexOf("\t"))>=0?g+1:m.lastIndexOf(" ")+1,c=(c=d.text+c).substring(f)}var v=(c=w.trimStart(c)).substring(1,2),y=void 0,b=this.getListLevelPattern(c.substring(0,1));if("None"!==b&&this.checkNumberFormat(v,"Bullet"===b,c)?n=!0:this.checkLeadingZero(c)?(r=!0,n=!0):(y=this.checkNextLevelAutoList(c),(0,a.le)(y)||(n=!0)),n){this.initComplexHistory("AutoList");var C=h.paragraph;e.start.setPositionParagraph(C.childWidgets[0],C.childWidgets[0].getOffset(h,o+1)),e.end.setPositionParagraph(C.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var F=t?"Tab":"Space";v=r?"%1"+c.substring(c.length-1,c.length):"%1"+v;var T=c.substring(c.length-3,c.length-1);b=r?this.getListLevelPattern(T):b;var x=new nt(void 0);x.listLevelPattern=b,"Bullet"===b?"*"===c?(x.numberFormat=String.fromCharCode(61623),x.characterFormat.fontFamily="Symbol"):"-"===c&&(x.numberFormat="-"):x.numberFormat=v,x.followCharacter=F;var P=e.paragraphFormat.leftIndent;x.paragraphFormat.leftIndent=0!==u||0!==p?P+18+u+p:o>2?P+2.5*(o-2)+18:P>0?P+18:36,x.paragraphFormat.firstLineIndent=-18,x.startAt=!r&&"0"===c.substring(0,1)||"00"===T?0:1,(0,a.le)(y)?this.autoConvertList(e,x):e.paragraphFormat.setList(y),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return n},s.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,i=void 0,n=!1,o=t.getPreviousParagraphBlock(t.start.paragraph),l=!1;!(0,a.le)(o)&&o instanceof I;){if(o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId){l=!0;break}o=t.getPreviousParagraphBlock(o)}if(l){var h=this.documentHelper.layout.getListNumber(o.paragraphFormat.listFormat,!0),d=h.substring(0,h.length-1),c=e.substring(0,e.length-1),u=void 0;if(h.substring(h.length-1)!==e.substring(e.length-1))n=!1;else if(c.match(/^[0-9]+$/)&&d.match(/^[0-9]+$/))u=parseInt(c,10),(parseInt(d,10)===u||parseInt(d,10)+1===u||parseInt(d,10)+2===u)&&(n=!0);else if(c.match(/^[a-zA-Z]+$/)&&d.match(/^[a-zA-Z]+$/))if(d.charCodeAt(0)===e.charCodeAt(0)||d.charCodeAt(0)+1===e.charCodeAt(0)||d.charCodeAt(0)+2===e.charCodeAt(0))n=!0;else if(c.match(/^[MDCLXVImdclxvi]+$/)&&d.match(/^[MDCLXVImdclxvi]+$/)){var p=this.getNumber(d.toUpperCase()),f=this.getNumber(c.toUpperCase());(p===f||p+1===f||p+2===f)&&(n=!0)}n&&(i=this.documentHelper.getListById(o.paragraphFormat.listFormat.listId))}return i},s.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),n=0,r=0;r<i.length;r++){var o=t[i[r]];o<t[i[r+1]]?n-=o:n+=o}return n},s.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},s.prototype.autoConvertList=function(e,t){var n=new ft;n.listId=this.documentHelper.lists.length>0?this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:0;var r=new et,o=this.documentHelper;r.abstractListId=o.abstractLists.length>0?o.abstractLists[o.abstractLists.length-1].abstractListId+1:0,n.abstractListId=r.abstractListId,n.abstractList=r,o.abstractLists.push(r),r.levels.push(t),t.ownerBase=r,e.paragraphFormat.setList(n),e.paragraphFormat.listLevelNumber=0},s.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var n=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(n,i.length-1)},s.prototype.checkLeadingZero=function(e){for(var t,i=!1,n=0;n<=e.length-1;n++){if("0"!==e.charAt(n)){t=n;break}i=!0}var r;return r="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(r,!1,e)},s.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof j||e.containerWidget instanceof Ce?t=e.containerWidget.page:e.containerWidget instanceof V&&(t=e.containerWidget.bodyWidget.page),t},s.prototype.insertTextInline=function(e,t,i,n,r){if(e instanceof S){e.text=w.insert(e.text,n,i);var o=e.line.paragraph,l=o.childWidgets.indexOf(e.line),h=e.line.children.indexOf(e);((0,a.le)(r)||!r)&&this.documentHelper.layout.reLayoutParagraph(o,l,h,e.line.paragraph.bidi)}else e instanceof ee?this.insertImageText(e,t,i,n):e instanceof H?0===e.fieldType?this.insertFieldBeginText(e,t,i,n):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,n):this.insertFieldEndText(e,t,i,n):(e instanceof O||e instanceof xe||e instanceof He)&&this.insertBookMarkText(e,i)},s.prototype.insertFieldBeginText=function(e,t,i,n){var r=new S;r.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),l=e.line.children.indexOf(e);r.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(l,0,r),r.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,o,l)},s.prototype.insertBookMarkText=function(e,t){var i=new S;i.text=t;var n=e.line.paragraph.childWidgets.indexOf(e.line),r=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(e instanceof He||e instanceof O?r:r+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,n,r)},s.prototype.insertFieldSeparatorText=function(e,t,i,n){var r=t.getPreviousTextInline(e),o=t.getNextTextInline(e),l=new S;l.text=i;var h=e.line.children.indexOf(e);n===e.length&&h++,(0,a.le)(r)&&(0,a.le)(o)?l.characterFormat.copyFormat(e.line.paragraph.characterFormat):(0,a.le)(r)?l.characterFormat.copyFormat(o.characterFormat):l.characterFormat.copyFormat(r.characterFormat),e.line.children.splice(h,0,l),l.line=e.line;var d=e.line.paragraph.childWidgets.indexOf(e.line);this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,d,h)},s.prototype.insertFieldEndText=function(e,t,i,n){var r=new S;r.text=i;var o=e.line.children.indexOf(e);r.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==n?e.line.children.splice(o,0,r):e.line.children.splice(o+1,0,r),r.line=e.line;var l=e.line.paragraph.childWidgets.indexOf(e.line);if(this.owner.enableTrackChanges){var h=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,d="Insertion",c=this.checkToMapRevisionWithInlineText(e,n,r,h,d);!c&&0===r.revisions.length&&(c=this.checkToMapRevisionWithNextNode(e.nextNode,r,h,d))}this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,l,o)},s.prototype.insertImageText=function(e,t,i,n){var r=t.getPreviousTextInline(e),o=t.getNextTextInline(e),l=e.line,h=new S,d=l.paragraph,c=d.childWidgets.indexOf(l);h.text=i;var u=l.children.indexOf(e);n===e.length&&u++,(0,a.le)(r)&&(0,a.le)(o)?h.characterFormat.copyFormat(d.characterFormat):(0,a.le)(r)?h.characterFormat.copyFormat(o.characterFormat):h.characterFormat.copyFormat(r.characterFormat),l.children.splice(u,0,h),h.line=l,this.documentHelper.layout.reLayoutParagraph(d,c,u)},s.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},s.prototype.checkAndConvertToHyperlink=function(e,t,i){var n,r;if(t)n=(r=i.lastChild.children[i.lastChild.children.length-1]).text;else{var o=0,l=e.start.currentWidget.getInline(e.start.offset-1,o),h=l.element;if(!(h instanceof S))return;n=(r=h).text.substring(0,o=l.index)}var d=0,c=n.lastIndexOf("\t");for(d=c>=0?c+1:n.lastIndexOf(" ")+1;r.previousElement instanceof S&&0===d;){var u=(r=r.previousNode).text;d=(c=u.lastIndexOf("\t"))>=0?c+1:u.lastIndexOf(" ")+1,n=r.text+n}var p=(n=n.substring(d)).toLowerCase(),f=!1;if("file:///"===p.substring(0,8)||"http://"===p.substring(0,7)&&p.length>7||"https://"===p.substring(0,8)&&p.length>8||"www."===p.substring(0,4)&&p.length>4||"\\"===p.substring(0,3)&&p.length>3||"mailto:"===p.substring(0,7)&&p.length>7)f=!0,"www."===p.substring(0,4)&&p.length>4&&(n="http://"+n);else{var g=n.indexOf("@"),m=n.indexOf(".");g>0&&g<m&&m<n.length-1&&(f=!0,n="mailto:"+n)}if(f){var v=new Z(this.documentHelper.owner);v.setPositionParagraph(r.line,r.line.getOffset(r,d));var y=new Z(this.documentHelper.owner);if(t)y.setPositionParagraph(r.line,r.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var b=e.end.currentWidget.previousLine;y.setPositionParagraph(b,b.getEndOffset())}else y.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,n,v,y)}},s.prototype.autoFormatHyperlink=function(e,t,i,n){this.initComplexHistory("AutoFormatHyperlink");var r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(n);var l=this.getCharacterFormat(e),h=new ie;h.copyFormat(l);var d=this.createHyperlinkElement(t,i,n,h);e.start.setPositionParagraph(d.line,d.line.getOffset(d,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),r=this.selection.getParagraphInfo(e.end);var c=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=c,this.editorHistory.updateComplexHistory(),this.reLayout(e)):this.updateComplexWithoutHistory(0,o,c)},s.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},s.prototype.createHyperlinkElement=function(e,t,i,n){var r=this.selection;this.documentHelper.layout.allowLayout=!1,this.appylingHyperlinkFormat(r);var o=new H(1);o.characterFormat.copyFormat(n),o.line=r.end.currentWidget,r.start.setPositionInternal(r.end),this.initInsertInline(o),r.start.setPositionInternal(t),r.end.setPositionInternal(r.start);var l=this.insertHyperlinkfield(r,n,e),h=r.start.paragraph.childWidgets.indexOf(l.line),d=l.line.children.indexOf(l);return o.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(r.start.paragraph,h,d),o},s.prototype.insertHyperlinkfield=function(e,t,i,n){var r=new H(0);r.characterFormat.copyFormat(t),r.line=e.start.currentWidget,this.initInsertInline(r);var o=new S;o.characterFormat.copyFormat(t),o.text=n?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o);var l=new H(2);return l.characterFormat.copyFormat(t),l.line=e.start.currentWidget,this.initInsertInline(l),r},s.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);r>=0&&n.range.splice(r,1),0===n.range.length&&t&&(this.owner.revisions.remove(n),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(n.revisionID)&&(this.documentHelper.revisionsInternal.remove(n.revisionID),this.owner.trackChangesPane.updateTrackChanges()))}},s.prototype.unlinkWholeRangeInRevision=function(e,t){var i=t;e.revisions.splice(e.revisions.indexOf(e),1);for(var n=i.range.length,r=0;r<n;r++)i.range.splice(0,1);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges()))},s.prototype.unLinkFieldCharacter=function(e){if(e instanceof H&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof H&&2===e.fieldType)(0,a.le)(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof H&&1===e.fieldType&&e.fieldBegin){(0,a.le)(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph);var t=this.documentHelper.fields.indexOf(e.fieldBegin);-1!==t&&this.documentHelper.fields.splice(t,1);var i=this.documentHelper.formFields.indexOf(e.fieldBegin);-1!==i&&this.documentHelper.formFields.splice(i,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0}},s.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset,0).element.characterFormat},s.prototype.insertHyperlink=function(e,t,i){e=e.replace(/\s/g,""),(0,a.le)(t)&&(t=e),(0,a.le)(i)||(e=e+'" \\o "'+i),this.insertHyperlinkInternal(e,t,this.owner.selection.text!==t,!1)},s.prototype.insertHyperlinkInternal=function(e,t,i,n){var r=this.documentHelper.selection;if(r.start.paragraph.associatedCell===r.end.paragraph.associatedCell)if(i)this.insertHyperlinkInternalInternal(r,e,t,n);else{this.documentHelper.layout.allowLayout=!1;var o=r.start,l=r.end;r.isForward||(o=r.end,l=r.start);var h=new Z(this.documentHelper.owner);h.setPositionInternal(o);var d=this.getCharacterFormat(r),c=new ie(void 0);c.copyFormat(d),this.initComplexHistory("InsertHyperlink");var u=this.selection.getParagraphInfo(o),p=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString())),this.appylingHyperlinkFormat(r),o.setPositionInternal(l);var f=new H(1);f.characterFormat.copyFormat(c),f.line=r.end.currentWidget,o.setPositionInternal(l),this.initInsertInline(f),o.setPositionInternal(h),l.setPositionInternal(o);var g=this.insertHyperlinkfield(r,c,e,n);f.linkFieldCharacter(this.documentHelper);var m=r.start.paragraph.childWidgets.indexOf(g.line),v=g.line.children.indexOf(g);this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(r.start.paragraph,m,v);var y=f.line;r.selects(y,y.getOffset(f,f.length),!0),u=this.selection.getParagraphInfo(l);var b=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,p,b)}},s.prototype.insertHyperlinkInternalInternal=function(e,t,i,n){if(!(0,a.le)(e.start)&&!this.editHyperlink(e,t,i)){var r=this.checkAndRemoveComments();this.initHistory("InsertHyperlink");var o=!0;if(!e.isEmpty){var l=this.owner.enableTrackChanges;this.owner.enableTrackChanges=!1,o=this.removeSelectedContents(e),this.owner.enableTrackChanges=l}if(o){var h=this.getCharacterFormat(e),d=new ie;d.copyFormat(h),this.insertHyperlinkByFormat(e,t,i,d,n)}this.updateHistoryForComments(r)}},s.prototype.insertHyperlinkByFormat=function(e,t,i,n,r){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var o=[],l=new H(0);o.push(l);var h=new S;h.text=r?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.push(h);var d=new H(2);o.push(d),!(0,a.le)(i)&&""!==i&&((h=new S).characterFormat.underline="Single",h.characterFormat.fontColor="#0563c1",h.text=i,o.push(h));var c=new H(1);o.push(c),this.insertElement(o),c.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(l)&&this.documentHelper.fields.push(l),e.selects(c.line,c.line.getOffset(c,c.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},s.prototype.initInsertInline=function(e,t){this.initHistory("InsertInline"),this.insertInlineInSelection(this.documentHelper.selection,e),this.editorHistory&&this.editorHistory.updateHistory()},s.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},s.prototype.editHyperlink=function(e,t,i,n){var r=e.getHyperlinkField();if((0,a.le)(r))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=(0,a.le)(this.editorHistory)||this.editorHistory&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo);var o="",l=!1,h=this.getCharacterFormat(e),d=new ie;d.copyFormat(h);var c=void 0;if(!(0,a.le)(r.fieldSeparator)){c=r.fieldSeparator;var u=e.getHyperlinkDisplayText(r.fieldSeparator.line.paragraph,r.fieldSeparator,r.fieldEnd,l,d);o=u.displayText,l=u.isNestedField,d=u.format}var p=r.line.getOffset(r,0);if(e.start.setPositionParagraph(r.line,p),p=r.fieldEnd.line.getOffset(r.fieldEnd,1),e.end.setPositionParagraph(r.fieldEnd.line,p),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!1),!l&&o!==i||(0,a.le)(c))this.insertHyperlinkByFormat(e,t,i,d,n),this.skipFieldDeleteTracking=!1;else{this.updateInsertPosition();var f=new H(0);f.characterFormat.copyFormat(r.characterFormat),f.line=e.start.currentWidget,this.insertInlineInternal(f);var g=new S;g.characterFormat.copyFormat(r.characterFormat),g.text=n?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',g.line=e.start.currentWidget,this.insertInlineInternal(g),this.insertClonedFieldResult(e,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes,c),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1;var y=f.line.paragraph,b=f.line.paragraph.childWidgets.indexOf(f.line),C=f.line.children.indexOf(f);this.documentHelper.layout.reLayoutParagraph(y,b,C),p=f.fieldEnd.line.getOffset(f.fieldEnd,1),e.selects(f.fieldEnd.line,p,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},s.prototype.insertClonedFieldResult=function(e,t,i){for(var n=!1,r=t.length-1;r>-1;r--){var o=t[r];if(!n){if(i!==o){if(o instanceof I&&o===i.line.paragraph){n=!0;var l=void 0;r===t.length-1?(l=e.start.paragraph,this.getClonedFieldResultWithSel(i.line.paragraph,e,i)):(l=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(l,!0)),e.selectParagraphInternal(e.getNextParagraphBlock(l),!0)}continue}n=!0}o instanceof fe?this.insertInlineInternal(o.clone()):o instanceof Ve&&this.insertBlock(o.clone())}},s.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var n=e.childWidgets.indexOf(i.line),r=e.childWidgets[n].children.indexOf(i),o=n;o<e.childWidgets.length;o++){var l=e.childWidgets[o];o!==n&&(r=0);for(var h=r;h<l.children.length;h++)this.insertInlineInternal(l.children[h].clone())}},s.prototype.getClonedFieldResult=function(e,t){var i=new I;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var n=e.childWidgets.indexOf(t.line),r=e.childWidgets[n].children.indexOf(t),o=n;o<e.childWidgets.length;o++){var l=e.childWidgets[o];o!==n&&(r=0);for(var h=r;h<l.children.length;h++)i.childWidgets[0].children.push(l.children[h])}return i},s.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,t=e.getHyperlinkField();if(!(0,a.le)(t)){var i=t.fieldEnd,n=t.fieldSeparator,r=new Z(e.owner);r.setPositionParagraph(t.line,t.line.getOffset(t,0));var o=this.selection.getParagraphInfo(r),l=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),h=new Z(e.owner);h.setPositionParagraph(n.line,n.line.getOffset(n,n.length)),o=this.selection.getParagraphInfo(h);var d=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(i.line,i.line.getOffset(i,0)),o=this.selection.getParagraphInfo(e.start);var c=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());e.end.setPositionInternal(e.start),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(d)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(c)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(l)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},s.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),(0,a.le)(t)&&(t=window);var i,n="",r="",o=t.clipboardData?t.clipboardData:e.clipboardData;if("msie"!==a.AR.info.name&&(r=o.getData("Text/Rtf"),n=o.getData("Text/Html")),this.copiedTextContent=i=o.getData("Text"),this.previousCharFormat=new ie,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new ue,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(n="",r=""),""!==r)this.pasteAjax(r,".rtf");else if(""!==n){this.isHtmlPaste=!0;var l=(new DOMParser).parseFromString(n,"text/html"),h=(new XMLSerializer).serializeToString(l);h=(h=(h=h.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',""),this.pasteAjax(h,".html")}else if(null!==i&&""!==i)this.selection.currentPasteAction="TextOnly",this.pasteContents(i),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==a.AR.info.name&&void 0!==o.items&&0!==o.items.length)for(var d=0;d<o.items.length;d++){var c=o.items[d];("image/png"===c.type||"image/svg+xml"===c.type&&"string"!==c.kind)&&this.pasteImage(c.getAsFile())}else"msie"===a.AR.info.name&&void 0!==o.files&&0!==o.files.length&&"image/png"===o.files[0].type&&this.pasteImage(o.files[0])}},s.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},s.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",function(){i.insertImage(e,this.width,this.height)}),t.src=e},s.prototype.pasteAjax=function(e,t){var n={content:e,type:t};this.pasteRequestHandler=new xt,this.owner.documentHelper.viewerContainer.focus(),(0,se.yh)(this.owner.element),this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=this.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this);var r={serverActionType:"SystemClipboard",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1,clipboardData:n};this.owner.trigger(Tt,r),r.cancel?(0,se.v3)(this.owner.element):this.pasteRequestHandler.send(n,r)},s.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents((0,a.le)(e.data)?this.copiedTextContent:e.data),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),(0,se.v3)(this.owner.element),setTimeout(function(){(0,a.le)(t.viewer)||t.viewer.updateScrollBars()},0)},s.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),(0,se.v3)(this.owner.element),this.documentHelper.updateFocus()},s.prototype.paste=function(e,t){var i=this;if((0,a.le)(e)&&(e=this.owner.enableLocalPaste?this.copiedData:void 0),(0,a.le)(t)||(this.currentPasteOptions=t),e){var n=JSON.parse(e);this.pasteContents(n),this.applyPasteOptions(this.currentPasteOptions),this.chartType&&(setTimeout(function(){(0,a.le)(i.viewer)||i.viewer.updateScrollBars()},30),this.chartType=!1)}},s.prototype.getUniqueListOrAbstractListId=function(e){if(e&&this.documentHelper.lists.length){var t=this.documentHelper.lists.slice().sort(function(n,r){return n.listId-r.listId});return t[t.length-1].listId+1}if(this.documentHelper.abstractLists.length){var i=this.documentHelper.abstractLists.slice().sort(function(n,r){return n.abstractListId-r.abstractListId});return i[i.length-1].abstractListId+1}return 0},s.prototype.checkSameLevelFormat=function(e,t,i){return t.levels[e].listLevelPattern===i.abstractList.levels[e].listLevelPattern&&t.levels[e].numberFormat===i.abstractList.levels[e].numberFormat&&("Bullet"===t.levels[e].listLevelPattern||t.levels[e].startAt===i.abstractList.levels[e].startAt)},s.prototype.listLevelPatternInCollection=function(e,t){var i=this;return this.documentHelper.lists.filter(function(n){return n.abstractList.levels[e].listLevelPattern===t.listLevelPattern&&n.abstractList.levels[e].numberFormat===t.numberFormat&&("Bullet"===t.listLevelPattern||n.abstractList.levels[e].startAt===t.startAt)&&i.isEqualParagraphFormat(n.abstractList.levels[e].paragraphFormat,t.paragraphFormat)})[0]},s.prototype.isEqualParagraphFormat=function(e,t){return!((0,a.le)(t.leftIndent)&&0!==e.leftIndent||!(0,a.le)(t.leftIndent)&&Math.round(e.leftIndent)!==Math.round(t.leftIndent)||(0,a.le)(t.rightIndent)&&0!==e.rightIndent||!(0,a.le)(t.rightIndent)&&Math.round(e.rightIndent)!==Math.round(t.rightIndent)||(0,a.le)(t.firstLineIndent)&&0!==e.firstLineIndent||!(0,a.le)(t.firstLineIndent)&&Math.round(e.firstLineIndent)!==Math.round(t.firstLineIndent)||(0,a.le)(t.beforeSpacing)&&0!==e.beforeSpacing||!(0,a.le)(t.beforeSpacing)&&Math.round(e.beforeSpacing)!==Math.round(t.beforeSpacing)||(0,a.le)(t.afterSpacing)&&0!==e.afterSpacing||!(0,a.le)(t.afterSpacing)&&Math.round(e.afterSpacing)!==Math.round(t.afterSpacing)||(0,a.le)(t.textAlignment)&&"Left"!==e.textAlignment||!(0,a.le)(t.textAlignment)&&e.textAlignment!==t.textAlignment||(0,a.le)(t.bidi)&&!1!==e.bidi||!(0,a.le)(t.bidi)&&e.bidi!==t.bidi||(0,a.le)(t.contextualSpacing)&&!1!==e.contextualSpacing||!(0,a.le)(t.contextualSpacing)&&e.contextualSpacing!==t.contextualSpacing||(0,a.le)(t.keepWithNext)&&!1!==e.keepWithNext||!(0,a.le)(t.keepWithNext)&&e.keepWithNext!==t.keepWithNext||(0,a.le)(t.keepLinesTogether)&&!1!==e.keepLinesTogether||!(0,a.le)(t.keepLinesTogether)&&e.keepLinesTogether!==t.keepLinesTogether||(0,a.le)(t.widowControl)&&!1!==e.widowControl||!(0,a.le)(t.widowControl)&&e.widowControl!==t.widowControl||(0,a.le)(t.outlineLevel)&&"BodyText"!==e.outlineLevel||!(0,a.le)(t.outlineLevel)&&e.outlineLevel!==t.outlineLevel||(0,a.le)(t.lineSpacing)&&1!==e.lineSpacing||!(0,a.le)(t.lineSpacing)&&Math.round(e.lineSpacing)!==Math.round(t.lineSpacing)||(0,a.le)(t.lineSpacingType)&&"Multiple"!==e.lineSpacingType||!(0,a.le)(t.lineSpacingType)&&e.lineSpacingType!==t.lineSpacingType)},s.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n.paragraphFormat&&n.paragraphFormat.listFormat&&Object.keys(n.paragraphFormat.listFormat).length>0)t.push(n);else if(n.rows)for(var r=0;r<n.rows.length;r++)for(var o=n.rows[r],l=0;l<o.cells.length;l++)t=t.concat(this.getBlocksToUpdate(o.cells[l].blocks))}return t},s.prototype.updateListIdForBlocks=function(e,t,i,n,r){for(var o=!1,l=0;l<e.length;l++){var h=e[l];if(h.paragraphFormat&&h.paragraphFormat.listFormat&&Object.keys(h.paragraphFormat.listFormat).length>0){var d=h.paragraphFormat.listFormat,c=this.listLevelPatternInCollection(d.listLevelNumber,t.levels[d.listLevelNumber]);d.listId===n&&((0,a.le)(c)&&(!i||i&&!this.checkSameLevelFormat(d.listLevelNumber,t,i))?(o=!0,d.listId=r):!(0,a.le)(c)&&this.checkSameLevelFormat(d.listLevelNumber,t,c)&&(d.isUpdated||(d.listId=c.listId,d.isUpdated=!0),o=!1))}else if(h.rows)for(var u=0;u<h.rows.length;u++)for(var p=h.rows[u],f=0;f<p.cells.length;f++){var m=this.updateListIdForBlocks(p.cells[f].blocks,t,i,n,r);o||(o=m)}}return o},s.prototype.updatePasteContent=function(e,t){var i=this.getUniqueListOrAbstractListId(!0);if(e.lists.filter(function(g){return g.listId===i}).length>0){var n=e.lists.slice().sort(function(g,m){return g.listId-m.listId});i=n[n.length-1].listId+1}var r=this.getUniqueListOrAbstractListId(!1);if(e.abstractLists.filter(function(g){return g.abstractListId===r}).length>0){var o=e.abstractLists.slice().sort(function(g,m){return g.abstractListId-m.abstractListId});r=o[o.length-1].abstractListId+1}for(var d,l=function(g){var m=e.lists[g],v=e.abstractLists.filter(function(C){return C.abstractListId===m.abstractListId})[0],y=h.documentHelper.lists.filter(function(C){return C.listId===m.listId});(0,a.le)(v)||(h.updateListIdForBlocks(e.sections[t].blocks,v,y[0],m.listId,i)?(v.abstractListId=r,m.listId=i,m.abstractListId=r,i++,r++):(e.lists.splice(g,1),e.abstractLists.splice(e.abstractLists.indexOf(v),1),g--)),d=g},h=this,c=0;c<e.lists.length;c++)l(c),c=d;for(var u=this.getBlocksToUpdate(e.sections[t].blocks),p=0;p<u.length;p++)delete u[p].paragraphFormat.listFormat.isUpdated},s.prototype.getBlocks=function(e,t,i,n,r){var o=[];if("string"==typeof e){var l=this.selection.start.paragraph;this.selection.isForward||(l=this.selection.end.paragraph);var h=[],d=e;d=d.replace(/\r\n/g,"\r"),this.isInsertText&&(d=-1!==navigator.userAgent.indexOf("Firefox")?d.replace(/\r/g,"\n"):d.replace(/\n/g,"\r")),h=-1!==navigator.userAgent.indexOf("Firefox")?d.split("\n"):d.split("\r");var c=[];(u=new j).sectionFormat=new je(u),u.childWidgets=c;for(var p=0;p<h.length;p++)if(p!==h.length-1||0!==h[p].length){var f=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),g=this.selection.getPreviousValidElement(f.element);g!==f.element&&(g=this.selection.getNextValidElement(f.element));var m=void 0;l.isEmpty()?m=l.characterFormat:(0,a.le)(g)?this.copyInsertFormat(l.characterFormat,!1):m=g.characterFormat;var v=this.documentHelper.selection.copySelectionParagraphFormat();(0,a.le)(this.previousParaFormat)||(v=this.previousParaFormat);var y=new I;y.paragraphFormat.copyFormat(v);var b=new oe(y);if(h[p].length>0)for(var C=h[p].split(/(\s+)/),F=0;F<C.length;F++){var T=new S;T.characterFormat.copyFormat(m),T.text=C[F],b.children.push(T),T.line=b}y.childWidgets.push(b),y.containerWidget=u,c.push(y)}o.push(u)}else{this.viewer.owner.parser.addCustomStyles(e),e.comments&&e.comments.length>0&&(this.documentHelper.owner.parser.commentsCollection=new U,this.documentHelper.owner.parser.commentStarts=new U,this.documentHelper.owner.parser.commentEnds=new U,this.documentHelper.owner.parser.parseComments(e,n||this.documentHelper.comments));var u=void 0;for(this.selection.currentPasteAction="DefaultPaste",p=0;p<e.sections.length;p++){var x=this.documentHelper.owner.parser;if(x.isPaste=t,x.isHtmlPaste=this.isHtmlPaste,!this.isPasteListUpdated&&!(0,a.le)(e.lists)&&(this.documentHelper.lists.length>0&&this.updatePasteContent(e,p),this.isPasteListUpdated=!0,(0,a.le)(e.abstractLists)||x.parseAbstractList(e,this.documentHelper.abstractLists),(0,a.le)(e.lists)||x.parseList(e,this.documentHelper.lists)),!(0,a.le)(e.revisions))if(t){var P=this.viewer.owner.revisionsInternal.changes;(0,a.le)(x.revisionCollection)||(x.revisionCollection=void 0),x.revisionCollection=new U;var E=x.revisionCollection;if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!x.isCutPerformed)&&e.revisions.length>=1)for(var L=0;L<e.revisions.length;L++){var W=!0;if(E.containsKey(e.revisions[L].revisionId)){if(P.length>0)for(var R=0;R<P.length;R++)P[R].revisionID===e.revisions[L].revisionId&&(W=!1);if(W){var N=E.get(e.revisions[L].revisionId);P.push(N)}}else x.parseRevisions(e,P)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else x.revisionCollection=this.documentHelper.revisionsInternal,x.parseRevisions(e,r);(u=new j).sectionFormat=new je(u),t?o.push(u):i.unshift(u),x.parseBody(e.sections[p].blocks,u.childWidgets),e.lastParagraphMarkCopied&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length&&x.parseSectionFormat(e.sections[p].sectionFormat,u.sectionFormat),x.isPaste=!1,x.isHtmlPaste=!1}if(e.lastParagraphMarkCopied){var B=new I;u.childWidgets.push(B)}}return"MergeWithExistingFormatting"===this.currentPasteOptions&&this.applyMergeFormat(o),o},s.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),n=this.selection.getPreviousValidElement(i.element),r=n?n.characterFormat:this.copyInsertFormat(t.characterFormat,!1),o=this.documentHelper.selection.copySelectionParagraphFormat(),l=0;l<e.length;l++)for(var h=e[l].childWidgets,d=0;d<h.length;d++){var c=h[d];if(c instanceof I)c.paragraphFormat.copyFormat(o),this.applyFormatInternal(c,r);else for(var u=0;u<c.childWidgets.length;u++)for(var p=c.childWidgets[u],f=0;f<p.childWidgets.length;f++)for(var g=p.childWidgets[f],m=0;m<g.childWidgets.length;m++)this.applyFormatInternal(g.childWidgets[m],r)}},s.prototype.applyFormatInternal=function(e,t){if(e instanceof I)for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var l=n.children[r].characterFormat.cloneFormat();l.bold&&(n.children[r].characterFormat.bold=l.bold),l.italic&&(n.children[r].characterFormat.italic=l.italic),"None"!==l.underline&&(n.children[r].characterFormat.underline=l.underline)}else for(i=0;i<e.childWidgets.length;i++){var h=e.childWidgets[i];for(r=0;r<h.childWidgets.length;r++)for(var d=h.childWidgets[r],c=0;c<d.childWidgets.length;c++)this.applyFormatInternal(d.childWidgets[c],t)}},s.prototype.applyPasteOptions=function(e,t){if(!(0,a.le)(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var n=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat,r=this.copiedContent,o=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=r,this.copiedTextContent=o,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,n);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},s.prototype.applyTablePasteOptions=function(e){if(!(0,a.le)(this.copiedContent)&&""!==this.copiedTextContent){this.isPaste=!0;var t=""!==this.copiedContent?this.copiedContent:this.copiedTextContent;this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop());var i=this.getBlocks(t,!0),n=this.selection.start.paragraph.paragraphFormat;switch(e){case"NestTable":this.pasteAsNestedTable(i,n);break;case"InsertAsRows":this.pasteAsNewRow(i[0].childWidgets[0]);break;case"InsertAsColumns":this.pasteAsNewColumn(i[0].childWidgets[0]);break;case"OverwriteCells":this.pasteOverwriteCell(i[0].childWidgets[0])}this.isPaste=!1}},s.prototype.pasteContents=function(e,t){if("string"!=typeof e&&(this.copiedContent=e),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var i=this.selection.getCurrentFormField(),n=this.getFieldResultText(),r=i.formFieldData.maxLength,o=this.documentHelper.selection.text.length;r>0&&(0===o?e=e.substring(0,r-n.length):o>0&&(e=e.substring(0,o)))}this.pasteContentsInternal(this.getBlocks(e,!0),!0,t),e.comments&&e.comments.length>0&&this.documentHelper.layout.layoutComments(this.documentHelper.comments),this.isInsertField=!1},s.prototype.pasteContentsInternal=function(e,t,i){this.isPaste=t;var c,n=this.documentHelper.selection;if(n.start.paragraph.isInsideTable&&n.end.paragraph.isInsideTable){var r=!1;if(1===e.length){var o=e[0].childWidgets;o.length<3&&(1===o.length&&o[0]instanceof k||2===o.length&&o[0]instanceof k&&o[1].isEmpty())&&(r=!0)}if(r){var l=n.start.paragraph.associatedCell,h=n.end.paragraph.associatedCell,d=e[0].childWidgets[0];if(l.ownerTable.equals(h.ownerTable))return 0===n.start.paragraph.associatedCell.rowIndex&&0===n.end.paragraph.associatedCell.rowIndex&&l.equals(h)&&!this.selection.isCellSelected(l,n.start,n.end)?(this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(d)):(this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(d)),void(this.isPaste=!1)}}c=this.checkAndRemoveComments(),this.defaultPaste(e,i),this.updateHistoryForComments(c)},s.prototype.defaultPaste=function(e,t){var i=this.documentHelper.selection,n=!0,r=!1;if(this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected){var o=i.start.paragraph;o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}this.initHistory("Paste"),(!i.isEmpty||this.documentHelper.isListTextSelected)&&(n=this.removeSelectedContentInternal(i,i.start,i.end)),n?r=this.pasteContent(e,t):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(i,i.isEmpty),r&&this.layoutWholeDocument(!0),this.isPaste=!1},s.prototype.pasteAsNewColumn=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteColumn");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(i),this.selection.owner.isLayoutEnabled=!1;var r=e.clone(),l=r.childWidgets.length,d=t.columnIndex,c=void 0,u=void 0,p=r.childWidgets[0].childWidgets.length,f=[];l>i.childWidgets.length?(this.addRows(l-i.childWidgets.length,i),this.tableUpdate(i)):i.childWidgets.length>l&&(this.addRows(i.childWidgets.length-l,r,i),this.tableUpdate(i));for(var g=0;g<p;g++)for(var m=0;m<i.childWidgets.length;m++){var v=i.childWidgets[m],b=r.childWidgets[m].childWidgets[g],C=v.childWidgets[t.columnIndex];(u=this.createColumn(this.selection.getLastParagraph(t))).index=m,u.rowIndex=v.index,u.containerWidget=v;var F=v.previousWidget,T=this.rowspannedCollection(v,f);if(null!=C)u.cellFormat.copyFormat(C.cellFormat),u.cellFormat.rowSpan=1;else if(T.length>0)for(var x=0;x<T.length;x++)F.rowIndex+(T[x].cellFormat.rowSpan-1)>=v.rowIndex&&(u.cellFormat.copyFormat(T[x].cellFormat),u.cellFormat.rowSpan=1);b.containerWidget=u.containerWidget,u.childWidgets=b.childWidgets,(0,a.le)(c)&&(c=this.selection.getFirstParagraph(u)),0===d?v.childWidgets.splice(g,0,u):this.insertSpannedCells(v,f,u,d)}this.tableReLayout(i,c,u)}},s.prototype.pasteAsNestedTable=function(e,t){var i=e[0].childWidgets[0];if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteNested");var n=this.getOwnerCell(this.selection.isForward),r=n.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(r);var o=void 0,l=i.clone(),h=this.selection.end.paragraph.containerWidget,d=void 0;if(n!=h){for(var c=n.ownerRow;c!=h.ownerRow.nextRow;){for(var u=n.columnIndex;u<=h.columnIndex;u++){d=c.childWidgets[u];var p=l.clone(),f=new I;d.childWidgets=[],d.childWidgets[0]=p,d.childWidgets[1]=f,f.containerWidget=d,p.containerWidget=d,p.index=0,f.index=1,c.childWidgets[u]=d,(0,a.le)(o)&&(o=this.selection.getFirstParagraph(d))}c=c.nextRow}this.tableReLayout(r,o,d)}else this.defaultPaste(e,t)}},s.prototype.pasteOverwriteCell=function(e){if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteOverwrite");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(i);var n=e.clone(),r=n.childWidgets.length,o=this.getOwnerCell(!this.selection.isForward),h=t.rowIndex,d=void 0,c=this.selection.start.paragraph.associatedCell.ownerRow,u=n.childWidgets[0],p=void 0,g=t.ownerRow;if(t!=o){for(var m=0,v=void 0,y=void 0,b=void 0,C=void 0;g!=o.ownerRow.nextRow;){for(var F=(u=n.childWidgets[m]||n.childWidgets[m=0]).childWidgets.length,T=0,x=t.columnIndex;x<=o.columnIndex;x++){v>1&&y===x&&(x++,v--,y=null),b>1&&T>=F-(b-1)&&(x+=(b=1)-1,T=0),C=(p=(u=n.childWidgets[m]).childWidgets[T]||u.childWidgets[T=0]).clone();for(var P=g.childWidgets[x],E=0;E<C.childWidgets.length;E++)(L=C.childWidgets[E]).containerWidget=P,C.childWidgets[E]=L;P.childWidgets=C.childWidgets,p.cellFormat.rowSpan>1&&(v=p.cellFormat.rowSpan,y=x),p.cellFormat.columnSpan>1&&(b=p.cellFormat.columnSpan),g.childWidgets[x]=P,(0,a.le)(d)&&(d=this.selection.getFirstParagraph(C)),T++}g=g.nextRow,m++}this.tableReLayout(i,d,C)}else{v=void 0,y=void 0,P=void 0,r>i.childWidgets.length-h&&this.addRows(r-i.childWidgets.length+h,i);for(var R=0;R<r;R++){x=t.columnIndex;for(var N=(u=n.childWidgets[R]).childWidgets.length,B=0;B<N;B++){C=(p=u.childWidgets[B]).clone(),v>1&&y===x&&(x++,v--,y=null),(P=c.childWidgets[x])||((P=C).containerWidget=c,P.index=x);for(var q=0;q<C.childWidgets.length;q++){var L;(L=C.childWidgets[q]).containerWidget=P,C.childWidgets[q]=L}P.childWidgets=C.childWidgets,p.cellFormat.rowSpan>1&&(v=p.cellFormat.rowSpan,y=x),c.childWidgets.splice(x++,1,P),(0,a.le)(d)&&(d=this.selection.getFirstParagraph(P))}c=c.nextRow}this.tableReLayout(i,d,P)}}},s.prototype.pasteAsNewRow=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){this.checkIsNotRedoing()&&this.initHistory("PasteRow"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],i=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],n=t.ownerTable.combineWidget(this.owner.viewer),r=i.ownerRow;this.editorHistory&&this.cloneTableToHistoryInfo(n),this.getRowCountToInsert(),this.getColumnCountToInsert();var h=[],d=r.rowIndex;d++;for(var c=e.childWidgets.length,u=0;u<c;u++){var p=e.childWidgets[u].clone();this.owner.enableTrackChanges&&this.insertRevision(p.rowFormat,"Insertion"),h.push(p)}n.insertTableRowsInternal(h,d,!1);var g=void 0;if(n.childWidgets[d]instanceof Q)g=this.selection.getFirstParagraph(n.childWidgets[d].firstChild);else{for(var m=void 0;!(m instanceof k);)m=n.nextRenderedWidget;g=this.selection.getFirstParagraphInFirstCell(m)}this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(g,!0),this.reLayout(this.selection,!0)}},s.prototype.tableUpdate=function(e){e.isGridUpdated=!1,e.calculateGrid(),e.buildTableColumns(),e.isGridUpdated=!0},s.prototype.rowspannedCollection=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n.cellFormat.rowSpan>1&&t.push(n)}return t},s.prototype.insertSpannedCells=function(e,t,i,n){for(var r=!1,o=0;o<e.childWidgets.length;o++){var l=e.childWidgets[o];if(l.cellFormat.rowSpan>1&&t.push(l),(l.columnIndex+l.cellFormat.columnSpan===n||n>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>n&&n<l.columnIndex+l.cellFormat.columnSpan)&&(e.childWidgets.splice(l.cellIndex+1,0,i),r=!0),r)break}if(!r&&t.length>0)for(var h=0;h<t.length;h++){var d=t[h];if(d.ownerRow!==e&&e.rowIndex<=d.ownerRow.rowIndex+d.cellFormat.rowSpan-1&&(d.columnIndex+d.cellFormat.columnSpan===n?(d.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(d.cellIndex,0,i),r=!0):n>d.columnIndex&&d.columnIndex+d.cellFormat.columnSpan>n&&n<d.columnIndex+d.cellFormat.columnSpan&&(e.childWidgets.splice(d.columnIndex,0,i),r=!0)),r)break}},s.prototype.addRows=function(e,t,i){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var d=t.childWidgets[t.childWidgets.length-1],c=d.childWidgets.length;if((this.selection.isForward?this.selection.start:this.selection.end).paragraph.isInsideTable){var u=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],p=d.childWidgets[c-1];this.rowInsertion(e,"Below",u,p,p.ownerRow,t,!1)}}},s.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="";if(this.updateInsertPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)i=this.editorHistory.currentBaseHistoryInfo.insertPosition;else{var n=this.selection.start;this.selection.isForward||(n=this.selection.end);var r=this.selection.getParagraphInfo(n);i=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0;var o=this.pasteCopiedData(e,t),l="";this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?l=this.editorHistory.currentBaseHistoryInfo.endPosition:(r=this.selection.getParagraphInfo(this.selection.start),l=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()));var h=new Z(this.documentHelper.owner);this.setPositionForCurrentIndex(h,i);var d=new Z(this.documentHelper.owner);return this.setPositionForCurrentIndex(d,l),this.pasteTextPosition={startPosition:h,endPosition:d},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),o},s.prototype.pasteCopiedData=function(e,t){var i=!1;if(this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter){if(this.previousSectionFormat=new je,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof ye){var n=this.selection.start.paragraph.bodyWidget.page;this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,n,n.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget.sectionFormat,n)}i=!0}for(var r=0;r<e.length;r++)for(var o=e[r].childWidgets,l=0;l<o.length;l++){var h=o[l];if(h instanceof I&&0===h.childWidgets.length&&(h.childWidgets[0]=new oe(h)),h instanceof I&&!(0,a.le)(t)){h.paragraphFormat.copyFormat(t);var d=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1);h.characterFormat.mergeFormat(d)}if(l===o.length-1&&h instanceof I){var c=h;if(c.childWidgets.length>0&&c.childWidgets[0].children.length>0){var u=this.selection.start;if(("Center"===u.paragraph.paragraphFormat.textAlignment||"Right"===u.paragraph.paragraphFormat.textAlignment)&&-1===u.paragraph.paragraphFormat.listFormat.listId&&(u.paragraph.x=this.owner.viewer.clientActiveArea.x),"KeepTextOnly"===this.currentPasteOptions){var p=new ue(this.selection.start.paragraph);this.selection.start.paragraph.paragraphFormat=p}this.insertElement(c.childWidgets[0].children,c.paragraphFormat)}}else if(h instanceof Ve){var f=this.selection.start.paragraph;if(h instanceof k){var m=h;if(this.generateTableRevision(m),f.isInsideTable){var v=f.getContainerWidth();m.fitCellsToClientArea(v)}if(f.isEmpty()&&f.previousWidget instanceof k&&!this.isPaste)return this.insertTableRows(m,f.previousWidget),i}this.insertBlockInternal(h)}}return i},s.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!(0,a.le)(e))for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.insertRevision(i.rowFormat,"Insertion");for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var l=r.childWidgets[o];(0,a.le)(l)||this.insertRevisionForBlock(l,"Insertion")}}},s.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var i=t.bodyWidget;if(i){var n=i.page;if(n&&((0,a.le)(n.previousPage)||n.previousPage.sectionIndex!==n.sectionIndex)&&(0,a.le)(n.nextPage)&&t.isEmpty()&&1===i.childWidgets.length){var r=!0,l=this.documentHelper.headersFooters[e.start.paragraph.bodyWidget.sectionIndex];if(l){for(var h in l){var d=l[h];if((0,a.le)(d))r=!1;else{var c=d.childWidgets[0];(c instanceof k||c instanceof I&&!c.isEmpty())&&(r=!1)}if(!r)break}return r}}}}return!1},s.prototype.insertTableInternal=function(e,t,i){var n=e.getIndex();if(i)for(var r=0,o=0;r<e.childWidgets.length;r++,o++){var l=e.childWidgets[r];t.childWidgets.splice(o,0,l),l.containerWidget=t,e.childWidgets.splice(r,1),r--}var h=e.containerWidget;this.constructRevisionsForTable(e,!1),this.removeBlock(e,!0),h.childWidgets.splice(n,0,t),t.index=e.index,e.containerWidget=void 0,t.containerWidget=h,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,h,t,!1)},s.prototype.canConstructRevision=function(e){return e.revisions.length>0&&0===e.revisions[0].range.length||e.removedIds.length>0},s.prototype.constructRevisionsForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t){this.canConstructRevision(n.rowFormat)&&this.constructRevisionFromID(n.rowFormat,!0);for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],l=0;l<o.childWidgets.length;l++)o.childWidgets[l]instanceof I&&this.constructRevisionsForBlock(o.childWidgets[l],t)}else this.removeDeletedCellRevision(n)}},s.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++)t&&n.children[r]instanceof fe&&this.canConstructRevision(n.children[r])&&this.constructRevisionFromID(n.children[r],!0);this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},s.prototype.applyRevisionForCurrentPara=function(e,t,i,n,r){var l=e.getInline(t+1,0).element,h=!1;t===e.getLength()&&(h=!0);var d=e.getInline(i,0).element;if(i>e.getLength()&&(r=!0),(0,a.le)(l)||(0,a.le)(d))(0,a.le)(l)||h?(0,a.le)(d)||(d.removedIds.push(n),this.constructRevisionFromID(d,!0)):(l.removedIds.push(n),this.constructRevisionFromID(l,!0));else if(h||l!==d){for(;!(0,a.le)(l)&&l!==d;)h||(l.removedIds.push(n),this.constructRevisionFromID(l,!0)),(0,a.le)(l.nextNode)||(l=l.nextNode instanceof O?l.nextNode:l.nextNode.nextValidNodeForTracking),h=!1;!(0,a.le)(l)&&!h&&(l.removedIds.push(n),this.constructRevisionFromID(l,!0))}else l.removedIds.push(n),this.constructRevisionFromID(l,!0);r&&(e.characterFormat.removedIds.push(n),this.constructRevisionFromID(e.characterFormat,!0))},s.prototype.insertBlockTable=function(e,t,i){var n=e.start.offset;if(e.start.paragraph.childWidgets.indexOf(e.start.currentWidget),t instanceof I&&n>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,n,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,n.toString()),!0)),n>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0),i.containerWidget.childWidgets.splice(i.indexInOwner,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var l=void 0;t instanceof I&&(l=t),t instanceof k&&(l=e.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(l,"0"),!0)}},s.prototype.handleCut=function(e){var t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start),t.paragraph===i.paragraph&&t.offset+1===i.offset&&t.paragraph.getInline(i.offset,0);var l=this.checkAndRemoveComments(),h=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var d=new Z(e.owner);this.setPositionForCurrentIndex(d,e.editPosition),e.selectContent(d,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.updateHistoryForComments(l)},s.prototype.insertInlineInternal=function(e,t){var i=this.selection,n=e.length,r=this.selection.getParagraphInfo(i.start);if(t=(0,a.le)(t)?"Insertion":t,i.start.paragraph.isEmpty()){var o=i.start.paragraph;("Center"===o.paragraphFormat.textAlignment||"Right"===o.paragraphFormat.textAlignment)&&-1===o.paragraphFormat.listFormat.listId&&(o.x=this.owner.viewer.clientActiveArea.x);var l=!(0,a.le)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);o.childWidgets[0].children.push(e),e.line=o.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!l&&this.insertRevision(e,t),(e.removedIds.length>0||l)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof Ee&&("Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType&&this.updateEndnoteCollection(e)),this.documentHelper.layout.reLayoutParagraph(o,0,0,void 0,void 0)}else{var h=0,d=i.start.currentWidget.getInline(i.start.offset,h);this.insertElementInternal(d.element,e,h=d.index,t,!0)}this.setPositionParagraph(r.paragraph,r.offset+n,!0)},s.prototype.insertElement=function(e,t){var i=this.selection,n=0,r=void 0,o=-1,l=void 0,h=0,d=void 0,c=this.selection.getParagraphInfo(i.start),u=this.owner.enableTrackChanges,p=void 0,f=void 0,g=0;if(i.start.paragraph.isEmpty())l=(r=i.start.paragraph).childWidgets[0],o=0;else{var m=i.start.currentWidget.getInline(i.start.offset,g);g=m.index,o=(r=(p=m.element).line.paragraph).childWidgets.indexOf(p.line),h=p.indexInOwner,l=p.line,g===p.length?(h++,d=!1):0===g?((0,a.le)(p.previousNode)&&(h=0),d=!0):(h++,(f=new S).characterFormat.copyFormat(p.characterFormat),f.text=p.text.substring(g),p.text=p.text.slice(0,g),p.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(p,f),l.children.splice(h,0,f),f.line=p.line)}for(var v=0;v<e.length;v++){n+=e[v].length,e[v]instanceof S&&e[v].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0);var y=e[v].revisions.length;e[v].ischangeDetected=!0,l.children.splice(h,0,e[v]),e[v].line=l,e[v].linkFieldCharacter(this.documentHelper);var b=this.updateRevisionForElement(p,e[v],g,0===v,f,d);u&&!b&&e[v].revisions.length===y&&this.checkToCombineRevisionsinBlocks(e[v],y===e[v].revisions.length,v>0&&v===e.length-1,"Insertion"),p=e[v],h++}t&&((0,a.le)(r.paragraphFormat.listFormat.list)||!(0,a.le)(r.paragraphFormat.listFormat)&&-1===r.paragraphFormat.listFormat.listId)&&r.paragraphFormat.copyFormat(t),this.documentHelper.layout.reLayoutParagraph(r,o,0,this.isInsertField?void 0:r.paragraphFormat.bidi),this.setPositionParagraph(c.paragraph,c.offset+n,!0)},s.prototype.updateRevisionForElement=function(e,t,i,n,r,o){if(!this.owner.enableTrackChanges||(0,a.le)(e)&&(0,a.le)(r))return!1;var l=!!(0,a.le)(o),h=t.revisions.length;return n?l?(this.checkToMapRevisionWithInlineText(e,i,t,!1,"Insertion")||t.revisions.length>h?this.copyElementRevision(e,r,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,r),this.insertRevision(t,"Insertion")),!1):o?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion")},s.prototype.insertElementInternal=function(e,t,i,n,r){var o=e.line,l=o.paragraph,h=o.indexInOwner,d=e.indexInOwner,c=l.paragraphFormat.bidi&&e.isRightToLeft,u=!1;n=(0,a.le)(n)?"Insertion":n;var p=this.skipTracking(),f=this.owner.enableTrackChanges,g=!1,m=t.revisions.length;if(this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&t instanceof S&&(u=e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),u)e.text=e.text.substring(0,i)+t.text+e.text.substring(i);else if(i===e.length)d=this.incrementCommentIndex(c,e,d),t.removedIds.length>0||p?this.constructRevisionFromID(t,!0,e):f&&!p&&!this.skipFieldDeleteTracking&&(g=this.insertRevisionAtEnd(e,t,n)),o.children.splice(d,0,t);else if(0===i)t.removedIds.length>0?this.constructRevisionFromID(t,!1):f&&!p&&!this.skipFieldDeleteTracking&&(g=this.insertRevisionAtBegining(e,t,n)),(0,a.le)(e.previousNode)?(e.line.children.splice(0,0,t),d=0):e.line.children.splice(d,0,t);else{d=this.incrementCommentIndex(c,e,d);var v=new S;v.characterFormat.copyFormat(e.characterFormat),v.text=e.text.substring(i),e.revisions.length>0&&!f&&!p&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,v),e.text=e.text.substr(0,i),o.children.splice(d,0,v),v.line=e.line,g=!0,this.isTrackingFormField=e.previousElement instanceof H,t.removedIds.length>0&&!this.isTrackingFormField?(this.constructRevisionFromID(t,!1),this.copyElementRevision(e,v,!0)):this.owner.enableTrackChanges&&(t instanceof O||t instanceof ae||t instanceof xe||t instanceof He?this.copyElementRevision(e,v,!1):this.checkToMapRevisionWithInlineText(e,i,t,c,n)||t.revisions.length>m?this.copyElementRevision(e,v,!0):t.revisions.length===m&&(this.splitRevisionForSpittedElement(e,v),this.insertRevision(t,n))),o.children.splice(d,0,t),d-=1}t.line=e.line,!(0,a.le)(t.line.paragraph.containerWidget)&&!(0,a.le)(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof Y&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof $&&0===t.type&&this.documentHelper.contentControlCollection.push(t),(t instanceof ee&&"Inline"!==t.textWrappingStyle||t instanceof de)&&(-1===l.floatingElements.indexOf(t)&&l.floatingElements.push(t),-1===l.bodyWidget.floatingElements.indexOf(t)&&"Inline"!==t.textWrappingStyle&&l.bodyWidget.floatingElements.push(t)),f&&!g&&!p&&!this.skipFieldDeleteTracking&&this.checkToCombineRevisionsinBlocks(t,m===t.revisions.length,i===e.length,n),t instanceof Ee&&(p&&(t.isLayout=!1),"Footnote"===t.footnoteType&&this.updateFootnoteCollection(t),"Endnote"===t.footnoteType&&this.updateEndnoteCollection(t)),r&&this.documentHelper.layout.reLayoutParagraph(l,h,d,void 0,void 0)},s.prototype.incrementCommentIndex=function(e,t,i){return(!this.owner.editorHistory||!(this.owner.editorHistory&&this.owner.editorHistory.currentHistoryInfo)||this.owner.editorHistory&&this.owner.editorHistory.currentHistoryInfo&&("SkipCommentInline"!==this.owner.editorHistory.currentHistoryInfo.action||"SkipCommentInline"===this.owner.editorHistory.currentHistoryInfo.action&&(this.owner.editorHistory.currentHistoryInfo.modifiedActions[0]===this.editorHistory.currentBaseHistoryInfo||this.owner.editorHistory.currentHistoryInfo.modifiedActions[0]!==this.editorHistory.currentBaseHistoryInfo&&!(t instanceof ae))))&&i++,i},s.prototype.constructRevisionFromID=function(e,t,i){if(e.removedIds.length>0){for(var n=0;n<e.removedIds.length;n++){var r=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[n])){if(r=this.documentHelper.revisionsInternal.get(e.removedIds[n]),e.revisions.push(r),(t=!!t||this.skipTracking())&&this.editorHistory.isRedoing&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistory.currentBaseHistoryInfo.action&&(t=!1),(0,a.le)(i))r.range.splice(t?r.range.length:0,0,e);else{var o=r.range.indexOf(i);r.range.splice(o>=0?o+(t?1:0):0,0,e)}this.updateRevisionCollection(r)}}e.removedIds=[]}else for(n=0;n<e.revisions.length;n++){var l=e.revisions[n];this.documentHelper.revisionsInternal.containsKey(l.revisionID)&&((l=this.documentHelper.revisionsInternal.get(l.revisionID)).range.splice(t?l.range.length:0,0,e),this.updateRevisionCollection(l))}},s.prototype.insertBlock=function(e){var t=!0,i=this.selection;if(i.isEmpty||(t=this.removeSelectedContents(i)),t||i.selectContent(i.start,!1),this.insertBlockInternal(e),this.checkInsertPosition(i)){var n;n=e instanceof I?e:this.selection.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(n,"0"),!0)}this.fireContentChange()},s.prototype.insertBlockInternal=function(e){var t=this.selection,i=this.selection.start.paragraph;if(!t.start.isAtParagraphStart){if(e instanceof I){!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&this.insertRevisionForBlock(e,"Insertion");var n=t.start.clone();return!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&this.insertRevisionForBlock(e,"Insertion"),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,n,this.selection.end))}this.updateInsertPosition(),i=i.combineWidget(this.owner.viewer),this.splitParagraph(i,i.firstChild,0,t.start.currentWidget,t.start.offset,!1),t.selectParagraphInternal(this.selection.start.paragraph,!0)}var r=t.start.paragraph.containerWidget,o=t.start.paragraph.index,l=r.childWidgets.indexOf(t.start.paragraph);(0,a.le)(r)||(r.childWidgets.splice(l,0,e),e.containerWidget=r,e.index=o,e.height=0,e instanceof k&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof I?this.insertRevisionForBlock(e,"Insertion"):e instanceof I?this.constructRevisionsForBlock(e,!0):e instanceof k&&this.constructRevisionsForTable(e,!0),this.documentHelper.layout.layoutBodyWidgetCollection(o,r,e,!1))},s.prototype.insertImage=function(e,t,i){this.insertImageInternal(e,!1,t,i)},s.prototype.insertImageInternal=function(e,t,i,n){var r=this;this.owner.isReadOnlyMode||!this.canEditContentControl||((0,a.le)(i)&&(i=100),(0,a.le)(n)&&(n=100),this.insertPicture(e,i,n,t),setTimeout(function(){(0,a.le)(r.viewer)||r.viewer.updateScrollBars()},30))},s.prototype.insertTable=function(e,t){var i=this.selection.start;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){e=e||1,t=t||1;var n=new a.E7("documenteditor",this.owner.defaultLocale);if(n.setLocale(this.documentHelper.owner.locale),t<1||t>63)return void se.hZ.alert(n.getConstant("Number of columns must be between 1 and 63."));if(e<1||e>this.documentHelper.owner.documentEditorSettings.maximumRows)return void se.hZ.alert("en-US"==this.documentHelper.owner.locale?"Number of rows must be between 1 and "+this.documentHelper.owner.documentEditorSettings.maximumRows+".":n.getConstant("Number of rows must be between 1 and 32767."));var r=this.createTable(e,t),o=i.paragraph.getContainerWidth()-r.tableFormat.leftIndent;r.splitWidthToTableCells(o);var l,h=i.paragraph.previousWidget;if(i.currentWidget.isFirstLine()&&0===i.offset&&h instanceof k)return this.insertTableRows(r,h),void r.destroy();l=this.checkAndRemoveComments(),this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(r),!(0,a.le)(r.containerWidget)&&!(0,a.le)(r.containerWidget.containerWidget)&&r.containerWidget.containerWidget instanceof Y&&(r.containerWidget.containerWidget.height+=r.height,this.isTableInsert=!0);var d=this.selection.getFirstParagraphInFirstCell(r).childWidgets[0];i.setPosition(d,!0),this.selection.end.setPositionInternal(i);var c=this.selection.getLastParagraphInLastCell(r.getSplitWidgets().pop()),u=c.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(c,u.toString())),this.reLayout(this.selection),this.isTableInsert=!1,this.updateHistoryForComments(l)}},s.prototype.insertRow=function(e,t){var i=e?"Above":"Below";if(!this.owner.isReadOnlyMode&&this.canEditContentControl){if((this.selection.isForward?this.selection.start:this.selection.end).paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===i?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0;var l=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],h=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],d=l.ownerTable.combineWidget(this.owner.viewer),c="Below"===i?h.ownerRow:l.ownerRow;this.editorHistory&&this.cloneTableToHistoryInfo(d),this.rowInsertion(t,i,l,h,c,d,!0)}this.reLayout(this.selection,!0)}},s.prototype.rowInsertion=function(e,t,i,n,r,o,l){var h=e||this.getRowCountToInsert(),d=[],c=r.rowIndex;if("Below"===t){c++;var u=(0,a.le)(n.previousWidget)||n.columnIndex===n.previousWidget.columnIndex+1;n.cellIndex!==n.columnIndex&&u&&r.rowIndex+i.cellFormat.rowSpan-1===n.ownerRow.rowIndex||n.cellFormat.rowSpan>1&&!(0,a.le)(r.nextWidget)&&r.nextWidget instanceof Q&&(n.cellFormat.rowSpan+=h,r=r.nextWidget),r.bottomBorderWidth=0}for(var f=0;f<h;f++){var g=this.updateRowspan(r,"Below"===t?n:i,t),m=this.createRowAndColumn(g.count,f,c,o);m.rowFormat.copyFormat(r.rowFormat),this.owner.enableTrackChanges&&this.insertRevision(m.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(m,g.cellFormats),d.push(m)}o.insertTableRowsInternal(d,c,l);var y=void 0;if(o.childWidgets[c]instanceof Q)y=this.selection.getFirstParagraph(o.childWidgets[c].firstChild);else{for(var b=void 0;!(b instanceof k);)b=o.nextRenderedWidget;y=this.selection.getFirstParagraphInFirstCell(b)}l&&this.documentHelper.layout.reLayoutTable(o),this.selection.selectParagraphInternal(y,!0)},s.prototype.autoFitTable=function(e){if(!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl){var t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=this.selection.getTable(t,i);n=n.getSplitWidgets()[0];var r=this.documentHelper.layout.getParentTable(n);(0,a.le)(r)||(this.setOffsetValue(this.selection),r=r.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(r),r.updateProperties(!0,n,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(n),this.reLayout(this.selection,!0))}},s.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},s.prototype.updateRowspan=function(e,t,i){for(var n=e.getPreviousRowSpannedCells(!0),r=0,o=[],l=0;l<e.childWidgets.length;l++){for(var h=e.childWidgets[l],d=!1,c=(0,a.le)(h.previousWidget)||h.columnIndex!==h.previousWidget.columnIndex+1,u=0;u<n.length;u++)if(c){var p=n[u],f=p.ownerRow.rowIndex+p.cellFormat.rowSpan-1;if(h.columnIndex<p.columnIndex&&h.cellIndex!==h.columnIndex&&(d=!0,r++,o.push(h.cellFormat)),1===t.cellFormat.rowSpan)if(f>h.ownerRow.rowIndex){if("Above"===i&&p.ownerRow===t.ownerRow)continue;p.cellFormat.rowSpan+=1,n.splice(u,1),u--}else h.cellIndex!==h.columnIndex&&c&&f===h.ownerRow.rowIndex&&("Above"===i?(p.cellFormat.rowSpan+=1,n.splice(u,1),u--):(r++,o.push(p.cellFormat),n.splice(u,1),u--));else if(p!==t){if("Above"===i&&(p.ownerRow===t.ownerRow||p.columnIndex===t.columnIndex))continue;p.columnIndex!==t.columnIndex&&p.ownerRow.rowIndex!==h.ownerRow.rowIndex&&(f>t.ownerRow.rowIndex||"Above"===i&&f===t.ownerRow.rowIndex)&&(p.cellFormat.rowSpan+=1,n.splice(u,1),u--)}}-1===n.indexOf(h)&&h.cellFormat.rowSpan>1&&(d=!0),d||(r++,o.push(h.cellFormat))}return{count:r,cellFormats:o}},s.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget;var i=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1];t.insertTableRowsInternal(e.childWidgets,t.childWidgets.length,!0);var n=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(n,"0"),!0),t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.selection.start.setPosition(n.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(n.firstChild,!0),this.reLayout(this.selection)},s.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var i=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===i?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),o=n.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(o),this.selection.owner.isLayoutEnabled=!1;var l=n.columnIndex;"Right"===i&&(l=r.columnIndex+r.cellFormat.columnSpan);for(var h=void 0,d=void 0,c=t||this.getColumnCountToInsert(),u=[],p=0;p<c;p++)for(var f=0;f<o.childWidgets.length;f++){var g=o.childWidgets[f];(d=this.createColumn(this.selection.getLastParagraph(n))).index=f,d.rowIndex=g.rowIndex,d.containerWidget=g,d.cellFormat.copyFormat(n.cellFormat),d.cellFormat.rowSpan=1,(0,a.le)(h)&&(h=this.selection.getFirstParagraph(d)),0===l?g.childWidgets.splice(l,0,d):this.insertSpannedCells(g,u,d,l),this.copyCellFormats(g,l)}this.tableReLayout(o,h,d)}}},s.prototype.copyCellFormats=function(e,t){var i=e.childWidgets[t];if(!(0,a.le)(i)){var n=i.childWidgets[0];t==e.childWidgets.length-1?--t:++t;var o=e.childWidgets[t].childWidgets[0],l=void 0,h=void 0;o.childWidgets.length>0&&(l=o.childWidgets[0]).children.length>0&&(h=l.children[0]),n.paragraphFormat.copyFormat(o.paragraphFormat),(0,a.le)(h)?n.characterFormat.copyFormat(o.characterFormat):n.characterFormat.copyFormat(h.characterFormat)}},s.prototype.tableReLayout=function(e,t,i){e.updateRowIndex(0);var n=this.documentHelper.layout.getParentTable(e);n?n.fitChildToClientArea():e.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(i).firstChild,!1),(this.checkIsNotRedoing()||(0,a.le)(this.editorHistory))&&this.reLayout(this.selection)},s.prototype.createTable=function(e,t){var n=new k;n.tableFormat=new Oe(n),n.tableFormat.preferredWidthType="Auto",n.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,n.tableFormat.initializeTableBorders();for(var r=0;r<e;){var o=this.createRowAndColumn(t,r);o.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(o.rowFormat,"Insertion"),o.containerWidget=n,n.childWidgets.push(o),r++}return n},s.prototype.createRowAndColumn=function(e,t,i,n){var r=n,o=this.selection.start.paragraph,l=new Q;l.rowFormat=new De(l),l.index=t;for(var h=0;h<e;h++){!(0,a.le)(i)&&!(0,a.le)(r)&&(i&&i>0&&r.childWidgets[i-1]&&r.childWidgets[i-1].childWidgets[h]?o=r.childWidgets[i-1].childWidgets[h].childWidgets[0]:0==i&&(o=r.childWidgets[i].childWidgets[h].childWidgets[0]));var d=this.createColumn(o,!0);d.index=h,d.rowIndex=t,d.containerWidget=l,l.childWidgets.push(d)}return l},s.prototype.createColumn=function(e,t){var i=new V,n=new I;if(t){n.paragraphFormat.copyFormat(e.paragraphFormat),n.paragraphFormat.leftIndent=0,n.paragraphFormat.firstLineIndent=0;var r=e.childWidgets[0].children[0];(0,a.le)(r)?n.characterFormat.copyFormat(e.characterFormat):n.characterFormat.copyFormat(r.characterFormat)}return n.containerWidget=i,i.childWidgets.push(n),i.cellFormat=new it(i),i},s.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return 1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var n=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),r=0;r<n.length;r++)t.paragraph.associatedCell.ownerRow===n[r].ownerRow&&e++}return 0===e?1:e},s.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;return this.selection.isForward||(t=this.selection.end,i=this.selection.start),(0,a.le)(t)||(0,a.le)(i)||(0,a.le)(this.selection.getTable(t,i))?0===e?1:e:e=t.paragraph.associatedCell===i.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},s.prototype.getOwnerCell=function(e){for(var t=void 0,n=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,r=(t=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell).ownerTable;!(0,a.le)(r)&&r.containerWidget instanceof V&&r!==n.ownerTable;)r=(t=r.containerWidget).ownerTable;return t},s.prototype.getOwnerRow=function(e){for(var t,n=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,r=(t=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow).ownerTable;!(0,a.le)(r)&&r.containerWidget instanceof V&&r!==n.ownerTable;)r=(t=r.containerWidget.ownerRow).ownerTable;return t},s.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,n=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:n;t.containerWidget instanceof V&&t!==(e?n:i);)t=t.containerWidget.ownerTable;return t},s.prototype.mergeSelectedCellsInTable=function(){if(this.canMergeCells())if(this.owner.enableTrackChanges){var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=se.hZ.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.confirmCellMerge.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}})}else this.confirmCellMerge()},s.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),r=this.selection.getContainerCellOf(i,n);if(r.ownerTable.contains(n)&&!this.selection.containsCell(r,n)){var o=i.ownerTable.combineWidget(this.owner.viewer);i=this.selection.getSelectedCell(i,r),n=this.selection.getSelectedCell(n,r);var l=this.mergeSelectedCells(o,i,n),h=this.selection.getFirstParagraph(l);e.setPosition(h.firstChild,!0);var d=this.selection.getLastParagraph(l);t.setPosition(d.lastChild,!1),this.selection.fireSelectionChanged(!1)}(this.checkIsNotRedoing()||(0,a.le)(this.editorHistory))&&this.reLayout(this.selection,!1),(0,a.le)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)},s.prototype.mergeSelectedCells=function(e,t,i){this.cloneTableToHistoryInfo(e),this.selection.owner.isLayoutEnabled=!1;var r=this.selection.getCellLeft(t.ownerRow,t),o=r+t.cellFormat.cellWidth,l=this.selection.getCellLeft(i.ownerRow,i),d=this.updateSelectedCellsInTable(r,o,l,l+i.cellFormat.cellWidth);r=d.start,o=d.end;for(var f,c=e.childWidgets.indexOf(i.ownerRow),u=e.childWidgets.indexOf(t.ownerRow),p=void 0,g=u;g<=c;g++){for(var m=e.childWidgets[g],v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v],b=this.selection.getCellLeft(m,y);if(w.round(r,2)<=w.round(b,2)&&w.round(b,2)<w.round(o,2)){var C=y.lastChild;if(C instanceof I&&C.isEmpty()&&y.childWidgets.pop(),(0,a.le)(p))p=y,f=C;else{g===u&&(p.cellFormat.preferredWidth+=y.cellFormat.preferredWidth,p.cellFormat.columnSpan+=y.cellFormat.columnSpan,this.mergeBorders(p,y));for(var F=0;F<y.childWidgets.length;F++)(x=y.childWidgets[F].clone()).containerWidget=p,p.childWidgets.push(x);m.childWidgets.splice(v,1),y.destroy(),v--}}}if((0===p.childWidgets.length||1===p.childWidgets.length&&p.childWidgets[0]instanceof k)&&f){var x=f.clone();p.childWidgets.push(x),x.containerWidget=p}if(0===m.childWidgets.length){var P=e.childWidgets.indexOf(m);m.updateRowBySpannedCells(),e.childWidgets.splice(P,1),m.destroy(),c--,g--}}return!(0,a.le)(p)&&u<c&&(p.cellFormat.rowSpan=c-u+1),this.updateBlockIndexAfterMerge(p),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,p},s.prototype.mergeBorders=function(e,t){var i=void 0,n=null;if((0,a.le)(e.cellFormat.borders)||(i=e.cellFormat.borders),(0,a.le)(t.cellFormat.borders)||(n=t.cellFormat.borders),!(0,a.le)(i)||!(0,a.le)(n))if((0,a.le)(i))(i=new _e(e.cellFormat)).copyFormat(n);else{if((0,a.le)(n))return;e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=e.getBorderBasedOnPriority(i.top,n.bottom),i.bottom=e.getBorderBasedOnPriority(i.bottom,n.bottom))}},s.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},s.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),r=this.selection.getContainerCellOf(i,n);if(r.ownerTable.contains(n)&&!this.selection.containsCell(r,n)){i=this.selection.getSelectedCell(i,r),n=this.selection.getSelectedCell(n,r);var o=1;if(i.ownerRow===n.ownerRow){for(var l=i.ownerRow.childWidgets.indexOf(i),h=l;h<=i.ownerRow.childWidgets.indexOf(n);h++){var d=i.ownerRow.childWidgets[h],c=d.previousWidget;if(h!==l&&(d.cellFormat.rowSpan!==o||!(0,a.le)(c)&&d.columnIndex!==c.cellFormat.columnSpan+c.columnIndex))return!1;o=d.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(i.ownerTable,i,n)}return!1},s.prototype.canMergeSelectedCellsInTable=function(e,t,i){var n=e.childWidgets.indexOf(i.ownerRow),r=e.childWidgets.indexOf(t.ownerRow),o=this.selection.getCellLeft(t.ownerRow,t),l=o+t.cellFormat.cellWidth,h=this.selection.getCellLeft(i.ownerRow,i),c=this.updateSelectedCellsInTable(o,l,h,h+i.cellFormat.cellWidth);o=c.start,l=c.end;for(var u=0,p=0,f=!1,g=!1,m=[],v=r;v<=n;v++){for(var y=e.childWidgets[v],b=0,C=0,F=!1,T=0;T<y.childWidgets.length;T++){var x=y.childWidgets[T],P=this.selection.getCellLeft(y,x);if(this.checkCellWithInSelection(o,l,P)){f=!1,g=!1,x.cellFormat.rowSpan>1&&m.push(x),F||(b=P,C=P,F=!0);var E=x.previousWidget;0!==C&&w.round(C,0)!==w.round(P,0)&&(C=P),C+=w.convertPointToPixel(x.cellFormat.cellWidth);var L=this.checkPrevOrNextCellIsWithinSel(o,l,x,!0),W=this.checkPrevOrNextCellIsWithinSel(o,l,x,!1),R=0===m.length||1===m.length&&m[0]===x,N=this.checkCurrentCell(m,x,L,W);if(v===n&&!(0,a.le)(E)&&x.cellFormat.rowSpan>E.cellFormat.rowSpan&&!N)return!1;if(v!==r)for(var B=0;B<m.length;B++){var q=m[B].ownerRow.rowIndex+m[B].cellFormat.rowSpan-1;if(q>=y.rowIndex){if(m[B].columnIndex>x.columnIndex?g=!0:f=!0,v===n&&m[B]!==x&&q>x.ownerRow.rowIndex+x.cellFormat.rowSpan-1)return!1;q===y.rowIndex&&!this.checkPrevOrNextCellIsWithinSel(o,l,x,!1)&&m.splice(m.indexOf(m[B]),1)}}if(L&&!(0,a.le)(E)&&R&&x.columnIndex!==E.columnIndex+1&&this.checkCellWidth(x))return!1}}if(v===r)u=b,p=C;else{if(C>0&&b>0&&(!f&&Math.round(u)!==Math.round(b)||!g&&Math.round(p)!==Math.round(C)))return!1;if(v===n)return!0}}return!1},s.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),r=this.documentHelper.selection.getCellLeft(e.ownerRow,t)+w.convertPointToPixel(t.cellFormat.cellWidth);return w.round(r,2)!==w.round(i,2)},s.prototype.checkCellWithInSelection=function(e,t,i){return w.round(e,2)<=w.round(i,2)&&w.round(i,2)<w.round(t,2)},s.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,i,n){var r=n?i.previousWidget:i.nextWidget,o=0;return!(0,a.le)(r)&&(o=this.documentHelper.selection.getCellLeft(r.ownerRow,r),this.checkCellWithInSelection(e,t,o))},s.prototype.checkCurrentCell=function(e,t,i,n){var r=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var l=e[o].ownerRow,h=l.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!n&&!i||e[o]!==t&&l.rowIndex<r.rowIndex&&h===r.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},s.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},s.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){var i=void 0,n=e;do{n=i=this.selection.getNextParagraphBlock(n)}while(i&&i.equals(e));(0,a.le)(i)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},s.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,n=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(n=0);var r=this.selection.start.paragraph;if(r=r.combineWidget(this.owner.viewer),t){var o=this.selection.getLineLength(r.lastChild);this.moveInlines(r,e,e.firstChild?e.firstChild.children.length:0,n,i,o,r.lastChild)}else n>0&&this.moveInlines(r,e,0,0,r.firstChild,n,i);var h=r.getSplitWidgets(),d=(r=t?h[h.length-1]:h[0]).containerWidget.childWidgets.indexOf(r);t&&d++;var c=r.containerWidget;e.index=r.index,e.containerWidget=c,c.childWidgets.splice(d,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?r:e,!0),e.height=0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,c,e,!1)},s.prototype.moveInlines=function(e,t,i,n,r,o,l){if(0===t.childWidgets.length){var h=new oe(t);t.childWidgets.push(h)}var d=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var c=0;c<e.childWidgets.length;c++){var u=e.childWidgets[c];if(r===u&&l===u){i=this.moveContent(u,n,o,i,t);break}if(l===u){i=this.moveContent(u,0,o,i,t);break}r===u?(d=!0,i=this.moveContent(u,n,this.documentHelper.selection.getLineLength(u),i,t)):d&&(i=this.moveContent(u,0,this.documentHelper.selection.getLineLength(u),i,t))}this.removeEmptyLine(e),e.isInsideTable||this.documentHelper.layout.reLayoutParagraph(e,0,0)},s.prototype.moveContent=function(e,t,i,n,r){for(var o=0,l=0;l<e.children.length;l++){var h=e.children[l];if(t>=o+h.length||h instanceof _)h instanceof _||(o+=h.length);else{var d=0;t>o&&(d=t-o);var c=i-o;if(c>h.length&&(c=h.length),d>0&&(o+=d),0===d&&c===h.length){if(h instanceof de){var u=e.paragraph.floatingElements.indexOf(h);-1!==u&&e.paragraph.floatingElements.splice(u,1)}r.firstChild.children.splice(n,0,h),h.line=r.firstChild,n++,e.children.splice(l,1),l--}else if(h instanceof S){var p=new S;p.characterFormat.copyFormat(h.characterFormat),p.text=h.text.substr(d,c-d),h.ischangeDetected=!0,p.ischangeDetected=!0,r.firstChild.children.splice(n,0,p),p.line=r.firstChild,n++,this.updateRevisionForMovedContent(h,p),h.text=h.text.slice(0,d)+h.text.slice(c),h.ischangeDetected=!0}if(i<=o+c-d)break;o+=c-d}}return n},s.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(r,0,t)}},s.prototype.updateComplexWithoutHistory=function(e,t,i){var n=this.documentHelper.selection;if(0===e){var r=new Z(n.owner);this.setPositionForCurrentIndex(r,t),this.documentHelper.layout.reLayoutParagraph(r.paragraph,0,0),this.setPositionForCurrentIndex(n.start,i),this.setPositionForCurrentIndex(n.end,i)}if(1===e){r=new Z(n.owner),this.setPositionForCurrentIndex(r,t);var o=new Z(n.owner);this.setPositionForCurrentIndex(o,i),this.documentHelper.layout.reLayoutParagraph(r.paragraph,0,0),o.paragraph!==r.paragraph&&this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0)}n.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),n.owner.isShiftingEnabled=!1,n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},s.prototype.reLayout=function(e,t,i){if(!(0,a.le)(this.previousBlockToLayout)){var n=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.bodyWidget,n,!1,!1),this.previousBlockToLayout=void 0}if(!this.documentHelper.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory())return this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&(this.startParagraph=void 0,this.endParagraph=void 0),void(this.isHandledComplex=!1);(0,a.le)(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),(0,a.le)(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled&&(e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,this.documentHelper.layout.shiftLayoutedItems(!0),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),(0,a.le)(e.start.paragraph)||!(0,a.le)(e.start.paragraph.bodyWidget.containerWidget)&&e.start.paragraph.bodyWidget.containerWidget instanceof Y&&("Footnote"===e.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(e.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof Kt&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),!i&&(this.fireContentChange(),this.owner.enableLockAndEdit&&this.owner.viewer.updateScrollBars(),this.owner.documentHelper.layout.isRelayout=!1)},s.prototype.updateHeaderFooterWidget=function(e){(0,a.le)(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat)},s.prototype.updateHeaderFooterWidgetToPage=function(e){for(var i="EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType,n=0;n<this.documentHelper.pages.length;n++){var r=this.documentHelper.pages[n];if(n+1===1&&r.bodyWidgets[0].sectionFormat.differentFirstPage&&-1!==e.headerFooterType.indexOf("FirstPage"))return void this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"));0===r.index&&r.bodyWidgets[0].sectionFormat.differentFirstPage&&-1===e.headerFooterType.indexOf("FirstPage")||(r.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?(i&&(n+1)%2==0||!i&&(n+1)%2!=0&&(n>0||!r.bodyWidgets[0].sectionFormat.differentFirstPage))&&this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")))}},s.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(i?t!=e.headerWidgetIn:t!=e.footerWidgetIn){var r=t.clone();this.documentHelper.layout.clearBlockWidget(r.childWidgets,!0,!0,!0),r.page=e,r.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(r.sectionFormat,i),r=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,r);var o=void 0;i?(o=e.headerWidgetIn,e.headerWidget=r):(o=e.footerWidgetIn,e.footerWidget=r),this.removeFieldInWidget(o),this.removeFieldInWidget(o,void 0,!0),o.destroy()}},s.prototype.removeFieldInWidget=function(e,t,i){(0,a.le)(t)&&(t=!1);for(var n=0;n<e.childWidgets.length;n++)this.removeFieldInBlock(e.childWidgets[n],t,i)},s.prototype.removeFieldInBlock=function(e,t,i){if(e instanceof k){if(e.wrapTextAround&&!(0,a.le)(e.bodyWidget)){var n=e.bodyWidget.floatingElements.indexOf(e);-1!==n&&e.bodyWidget.floatingElements.splice(n,1)}this.removeFieldTable(e,t,i)}else if(e instanceof Q)for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInWidget(e.childWidgets[r],t,i);else this.removeField(e,t,i)},s.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.removeFieldInWidget(r.childWidgets[o],t,i)},s.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];if(!(0,a.le)(e)){var i=this.documentHelper.pages.indexOf(e.page);t=this.documentHelper.pages[i].bodyWidgets[0]}(0,a.le)(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget),(0,a.le)(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},s.prototype.shiftPageContent=function(e,t){var i;if(-1!==e.indexOf("First"))i=0;else if(t.differentOddAndEvenPages){var n=-1!==e.indexOf("Even");i=t.differentFirstPage?n?1:2:n?1:0}else 1==(i=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(i=0);var r=this.documentHelper.pages[i].bodyWidgets[0];do{if(-1!==e.indexOf("Header")){var o=r.page.headerWidget,l=!o.isEmpty||o.isEmpty&&this.owner.enableHeaderAndFooter,h=r.firstChild,d=w.convertPointToPixel(t.topMargin),c=w.convertPointToPixel(t.headerDistance);if(l&&(d=Math.max(c+r.page.headerWidget.height,d)),h.y!==d){this.owner.viewer.updateClientArea(r.sectionFormat,r.page);var u=(h=h.combineWidget(this.owner.viewer)).previousRenderedWidget;u&&h.containerWidget.equals(u.containerWidget)&&!(u.containerWidget.lastChild instanceof I&&u.containerWidget.lastChild.isEndsWithPageBreak)&&(this.owner.viewer.cutFromTop(u.y+u.height),this.documentHelper.layout.updateContainerWidget(h,u.containerWidget,u.indexInOwner+1,!1)),this.documentHelper.blockToShift=h}}else this.checkAndShiftFromBottom(r.page,r.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));r;){var p=r.getSplitWidgets();if(r=p[p.length-1].nextRenderedWidget){if(0===i)break;if(r.page.index+1===0&&1===i||r.page.index+1!==0&&2===i)break;var f=r.page.nextPage;if(!(0,a.le)(f)&&f.bodyWidgets[0].equals(r)){r=f.bodyWidgets[0];break}}}}while(r)},s.prototype.checkAndShiftFromBottom=function(e,t){var n,i=e.bodyWidgets[0];if(i.childWidgets.length>1){for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];if(o.y+o.height>t.y){n=o;break}if(!(t instanceof Y)&&i.childWidgets.length-1===r&&o.y+o.height<t.y){n=o;break}}(0,a.le)(n)||(this.owner.viewer.updateClientArea(i.sectionFormat,e,!0),this.owner.viewer.cutFromTop(n.y),this.documentHelper.blockToShift=n)}},s.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!(0,a.le)(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},s.prototype.getContentControl=function(){for(var e=0;e<this.documentHelper.contentControlCollection.length;e++){var t=this.documentHelper.contentControlCollection[e],i=this.selection.getPosition(t),n=i.startPosition,r=i.endPosition,o=this.selection.start,l=this.selection.end;if(this.selection.isForward||(o=this.selection.end,l=this.selection.start),(o.isExistAfter(n)||o.isAtSamePosition(n))&&(l.isExistBefore(r)||l.isAtSamePosition(r)))return t}},s.prototype.checkPlainTextContentControl=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(t=this.selection.start,e=this.selection.end);var i=0,n=0,r=e.currentWidget.getInline(e.offset,i),o=t.currentWidget.getInline(t.offset,n);i=r.index,n=o.index;var d,c,l=r.element,h=o.element;if(l&&l.contentControlProperties&&"Text"===l.contentControlProperties.type||h&&h.contentControlProperties&&"Text"===h.contentControlProperties.type){if((l=this.getContentControl()).contentControlProperties&&!(0,a.le)(l)){var u=l.line.getOffset(l,1);(d=new Z(this.owner)).setPositionParagraph(l.line,u)}else d=e;if(h.contentControlProperties&&l.reference){var p=(h=l.reference).line.getOffset(h,h.length);(c=new Z(this.owner)).setPositionParagraph(h.line,p)}else c=t;this.selection.selectRange(d,c)}else e.paragraph.contentControlProperties&&"Text"===e.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},s.prototype.onApplyCharacterFormat=function(e,t,i,n){var r=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!r||this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var o=this.documentHelper.selection;if((!o.owner.isReadOnlyMode||r)&&o.owner.isDocumentLoaded){i=!(0,a.le)(i)&&i,n=!(0,a.le)(n)&&n;var l=e[0].toUpperCase()+e.slice(1),h=o.start.paragraph;if(this.checkPlainTextContentControl(),o.isEmpty&&"List"!==o.contextType&&!n)return o.skipFormatRetrieval=!0,o.end.isAtParagraphEnd?(this.initHistory(l),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(h.characterFormat,e,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):o.fireSelectionChanged(!0),void(o.skipFormatRetrieval=!1);if("highlightColor"===e&&o.start.isInSameParagraph(o.end)){var c=o.start,u=o.end;if(this.selection.isForward||(u=o.start,c=o.end),u.offset===o.getLineLength(u.currentWidget)+1&&u.offset-1===c.offset)return}this.setOffsetValue(o),this.initHistory(l),"List"===o.contextType?this.applyCharacterFormatForListText(o,e,t,i):this.updateSelectionCharacterFormatting(e,t,i),this.documentHelper.layout.isBidiReLayout=!1}}},s.prototype.applyCharacterFormatForListText=function(e,t,i,n){var r=e.getListLevel(e.start.paragraph);if(!(0,a.le)(r)){var o=r.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,o,"bold",!o.bold);break;case"italic":this.applyListCharacterFormatByValue(e,o,"italic",!o.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,o,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(e,o,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(e,o,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(e,o,"highlightColor",i);break;case"baselineAlignment":o.baselineAlignment===i&&(i="Normal"),this.applyListCharacterFormatByValue(e,o,"baselineAlignment",i);break;case"strikethrough":o.strikethrough===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"strikethrough",i);break;case"underline":o.underline===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(e,o,void 0,i)}}},s.prototype.applyListCharacterFormatByValue=function(e,t,i,n){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,n,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},s.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},s.prototype.updateListTextSelRange=function(e,t,i,n){this.documentHelper.owner.isShiftingEnabled=!0;var r=e.start,o=e.end;e.isForward||(r=e.end,o=e.start),this.initHistoryPosition(e,r);var l=e.getListLevel(e.start.paragraph);this.applyCharFormatValue(l.characterFormat,t,i,n),this.startSelectionReLayouting(r.paragraph,e,r,o)},s.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&!(0,a.le)(t)&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},s.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},s.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;((0,a.le)(e)||"NoColor"===e)&&(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},s.prototype.toggleSubscript=function(){this.owner.isReadOnlyMode||this.restrictFormatting||(this.selection.characterFormat.baselineAlignment="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript")},s.prototype.toggleSuperscript=function(){this.owner.isReadOnlyMode||this.restrictFormatting||(this.selection.characterFormat.baselineAlignment="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript")},s.prototype.increaseIndent=function(){(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},s.prototype.decreaseIndent=function(){(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},s.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},s.prototype.applyBullet=function(e,t){(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.applyBulletOrNumbering(e,"Bullet",t)},s.prototype.applyNumbering=function(e,t){(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.applyBulletOrNumbering(e,t,"Verdana")},s.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},s.prototype.clearFormattingInternal=function(e){var t=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(t.isEmpty||!(0,a.le)(e)&&e)&&(t.start.moveToParagraphStartInternal(t,!1),t.end.moveToParagraphEndInternal(t,!1)),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(t),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(t),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},s.prototype.clearFormatting=function(){this.clearFormattingInternal()},s.prototype.updateProperty=function(e,t){var i=this.selection;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&i.owner.isDocumentLoaded){var n=i.start;i.isForward||(n=i.end);var o=0,l=n.currentWidget.getInline(n.offset,o),h=l.element;o=l.index;var d=n.paragraph;if(!(0,a.le)(h)&&h.length===o&&!this.selection.isEmpty&&(h=h.nextNode),1===e){var c="None";(0,a.le)(h)?(0,a.le)(d)||(c=d.characterFormat.underline):c=h.characterFormat.underline,this.selection.characterFormat.underline=t===c?"None":t}else{var u="Normal";(0,a.le)(h)?(0,a.le)(d)||(u=d.characterFormat.baselineAlignment):u=h.characterFormat.baselineAlignment,u===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t}}},s.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++)e+=this.documentHelper.preDefinedStyles.get(i[t])+",";return e.slice(0,-1)+"]}"},s.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),n=0,r=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"].filter(function(l){return-1===e.indexOf(l)});n<r.length;n++)this.createStyle(this.documentHelper.preDefinedStyles.get(r[n]))},s.prototype.createStyle=function(e){this.createStyleIn(e)},s.prototype.createStyleIn=function(e){var t=JSON.parse(e);return void 0!==this.documentHelper.styles.findByName(t.name)&&(t.name=this.getUniqueStyleName(t.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),t,this.documentHelper.styles),this.owner.notify(zt,{}),this.documentHelper.styles.findByName(t.name)},s.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),i=this.documentHelper.styles.findByName(t);!(0,a.le)(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},s.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!(0,a.le)(t)&&t.length>0?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},s.prototype.updateSelectionCharacterFormatting=function(e,t,i){switch((0,a.le)(e)&&(e="CharacterFormat"),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},s.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},s.prototype.updateCharacterFormatWithUpdate=function(e,t,i,n,r){r=!(0,a.le)(r)&&r,this.documentHelper.owner.isShiftingEnabled=!0;var o=e.start,l=e.end;if(!e.isEmpty&&!e.isForward&&(o=e.end,l=e.start),e.isEmpty&&r){var h=o.offset,d=o.clone(),c=l.clone();this.selection.selectCurrentWord(),(h===this.selection.start.offset||h===this.selection.end.offset-1)&&(this.selection.start=d,this.selection.end=c)}this.applyCharFormatSelectedContent(o.paragraph,e,o,l,t,i,n)},s.prototype.applyCharFormatSelectedContent=function(e,t,i,n,r,o,l){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n))this.applyCharFormat(e,t,i,n,r,o,l);else{var h;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),this.applyCharFormatCell(h=i.paragraph.associatedCell,t,i,n,r,o,l);var d=h.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1)}},s.prototype.applyCharFormatForSelectedPara=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var l=e.childWidgets[o],h=0;h<l.children.length;h++)this.applyCharFormatValue(l.children[h].characterFormat,i,n,r);this.applyCharFormatValue(e.characterFormat,i,n,r)},s.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},s.prototype.getNextParagraphForCharacterFormatting=function(e,t,i,n,r,o){var l=e.getSplitWidgets();e=this.documentHelper.selection.getNextRenderedBlock(e=l[l.length-1]),(0,a.le)(e)||(e instanceof I?this.applyCharFormat(e,this.documentHelper.selection,t,i,n,r,o):this.applyCharFormatForTable(0,e,this.documentHelper.selection,t,i,n,r,o))},s.prototype.applyCharFormat=function(e,t,i,n,r,o,l){e=e.combineWidget(this.owner.viewer);var h=0,d=t.getParagraphLength(e),c=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,u=n.offset,p=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;if((0,a.le)(t)||e===i.paragraph&&(h=i.offset),e.equals(n.paragraph))t.isParagraphLastLine(f=e.childWidgets[e.childWidgets.length-1])&&n.currentWidget===f&&(u===t.getLineLength(f)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,r,o,l);else{var f=e.childWidgets[e.childWidgets.length-1];"highlightColor"===r&&t.isParagraphLastLine(f)&&i.currentWidget===f&&i.offset===t.getLineLength(f)||this.applyCharFormatValue(e.characterFormat,r,o,l),u=d}for(var g=c;g<=p;g++){var m=e.childWidgets[g];g!==c&&(h=t.getStartLineOffset(m)),u=m===n.currentWidget?n.offset:t.getLineLength(m);for(var v=0,y=void 0,b=-1,C=!0,F=0;F<m.children.length;C?F++:F--){var T=m.children[F];if(!(T instanceof _)){if(y===T&&(y=void 0,F=b,b=-1,C=!0),h>=v+T.length){v+=T.length;continue}var x=0;h>v&&(x=h-v);var P=u-v,E=T.length;if(P>E&&(P=E),F+=this.applyCharFormatInline(T,t,x,P,r,o,l),u<=v+E)break;v+=E}}}var W=n.paragraph;this.documentHelper.layout.reLayoutParagraph(e,c,0),!e.equals(W)&&this.getNextParagraphForCharacterFormatting(e,i,n,r,o,l)},s.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},s.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},s.prototype.changeCase=function(e){if(!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory("Uppercase"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,n=t.end;t.isForward||(i=t.end,n=t.start),this.changeSelectedTextCase(t,i,n,e),this.reLayout(t)}},s.prototype.changeSelectedTextCase=function(e,t,i,n,r){var o=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0);var l=this.editorHistory.isUndoing;l&&!(0,a.le)(r)&&r.length>0&&(this.removedTextNodes=r);var h=i.selection.endOffset;this.changeTextCase(t.paragraph,e,t,i,n,l),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i.selection.endOffset!==h&&(i=e.getTextPosBasedOnLogicalIndex(h)),this.checkEndPosition(e)&&this.updateHistoryPosition(i,!1),e.selectPosition(t,i))},s.prototype.changeTextCase=function(e,t,i,n,r,o){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n))this.changeCaseParagraph(e,t,i,n,r,o);else{var l;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),this.changeCaseParaFormatInCell(l=i.paragraph.associatedCell,i,n,r,o);var h=l.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.containerWidget,h,!1)}},s.prototype.changeCaseParagraph=function(e,t,i,n,r,o){e=e.combineWidget(this.owner.viewer);var l=0,h=t.getParagraphLength(e),d=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,c=n.offset,u=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;(0,a.le)(t)||e===i.paragraph&&(l=i.offset),e.equals(n.paragraph)||(c=h);for(var p=d;p<=u;p++){var f=e.childWidgets[p];p!==d&&(l=t.getStartLineOffset(f)),c=f===n.currentWidget?n.offset:t.getLineLength(f);for(var g=0,m=void 0,v=-1,y=!0,b=0;b<f.children.length;y?b++:b--){var C=f.children[b];if(!(C instanceof _)){if(m===C&&(m=void 0,b=v,v=-1,y=!0),l>=g+C.length){g+=C.length;continue}var F=0;l>g&&(F=l-g);var T=c-g,x=C.length;if(T>x&&(T=x),b+=this.changeCaseInline(C,t,F,T,r,o),c<=g+x)break;g+=x}}}var E=n.paragraph;this.documentHelper.layout.reLayoutParagraph(e,d,0),!e.equals(E)&&this.changeCaseNextBlock(e,i,n,r,o)},s.prototype.changeCaseInline=function(e,t,i,n,r,o){if(e instanceof S){if(0!==i||n!==e.length)return this.changeCaseInlineInternal(e,t,i,n,r,o);this.changeCaseInlineInternal(e,t,i,n,r,o)}return 0},s.prototype.addRemovedTextNodes=function(e,t){if(e instanceof S&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)){var i=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];(0,a.le)(i)&&((i=new S).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i)),i.text+=t}},s.prototype.changeCaseInlineInternal=function(e,t,i,n,r,o){var u,l=0,h=e.line.children.indexOf(e);if(e.paragraph.childWidgets.indexOf(e.line),i>0){var p=e.text.substr(i,n-i);this.addRemovedTextNodes(e,p),(u=new S).characterFormat.copyFormat(e.characterFormat),u.line=e.line,u.text=this.getChangeCaseText(p,r,o),u.isRightToLeft=e.isRightToLeft,h++,e.line.children.splice(h,0,u),l++}n<e.length&&((u=new S).characterFormat.copyFormat(e.characterFormat),u.text=e.text.substring(n),u.line=e.line,u.isRightToLeft=e.isRightToLeft,h++,e.line.children.splice(h,0,u),l++);var f=e;if(0===i){var g=f.text.substr(0,n);this.addRemovedTextNodes(e,g),f.text=this.getChangeCaseText(g,r,o)}else{var m=f.text.substr(0,i);f.text=m}return l},s.prototype.changeCaseNextBlock=function(e,t,i,n,r){e=this.getNextBlockForChangeCase(e,t,i,n,r),(0,a.le)(e)||(e instanceof I?this.changeCaseParagraph(e,this.documentHelper.selection,t,i,n,r):this.changeCaseForTable(0,e,this.documentHelper.selection,t,i,n,r))},s.prototype.getNextBlockForChangeCase=function(e,t,i,n,r){var o=e.getSplitWidgets();return this.documentHelper.selection.getNextRenderedBlock(e=o[o.length-1])},s.prototype.getChangeCaseText=function(e,t,i){if(i){if(!(0,a.le)(this.removedTextNodes)&&this.removedTextNodes.length>0){var n=this.removedTextNodes[0],r=n.text.substr(0,e.length);n.text=n.text.substr(r.length,n.length-r.length),e=r,""===n.text&&this.removedTextNodes.splice(0,1)}}else"Uppercase"===t&&(e=e.toUpperCase());return e},s.prototype.changeCaseForTable=function(e,t,i,n,r,o,l){t=t.combineWidget(this.owner.viewer);for(var h=e;h<t.childWidgets.length;h++){for(var d=t.childWidgets[h],c=0;c<d.childWidgets.length;c++)this.changeCaseForSelectedCell(d.childWidgets[c],i,o,l);if(r.paragraph.isInsideTable&&i.containsRow(d,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,n,r,o,l)},s.prototype.changeCaseForSelectedCell=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof I?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseForSelTable(o,t,i,n)}},s.prototype.changeCaseForSelectedPara=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.children.length;l++){var h=o.children[l];!(0,a.le)(h)&&h instanceof S&&(this.addRemovedTextNodes(h,h.text),h.text=this.getChangeCaseText(h.text,i,n))}},s.prototype.changeCaseForSelTable=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++)this.changeCaseForSelectedCell(o.childWidgets[l],t,i,n)},s.prototype.changeCaseParaFormatInCell=function(e,t,i,n,r){var o=this.documentHelper.selection;if(i.paragraph.isInsideTable){var l=o.getContainerCellOf(e,i.paragraph.associatedCell);if(l.ownerTable.contains(i.paragraph.associatedCell)){var h=o.getSelectedCell(e,l),d=o.getSelectedCell(i.paragraph.associatedCell,l);o.containsCell(l,i.paragraph.associatedCell)?o.isCellSelected(l,t,i)?this.changeCaseParaForCellInternal(l,o,n,r):h===l?this.changeCaseParagraph(t.paragraph,o,t,i,n,r):this.changeCaseParaForRow(h.ownerRow,o,t,i,n,r):this.changeCaseParaForTableCell(l.ownerTable,l,d,n,r)}else this.changeCaseParaForRow(l.ownerRow,o,t,i,n,r)}else{var c=o.getContainerCell(e);this.changeCaseParaForRow(c.ownerRow,o,t,i,n,r)}},s.prototype.changeCaseParaForTableCell=function(e,t,i,n,r){var o=this.documentHelper.selection,l=o.getCellLeft(t.ownerRow,t),h=l+t.cellFormat.cellWidth,d=o.getCellLeft(i.ownerRow,i),u=this.updateSelectedCellsInTable(l,h,d,d+i.cellFormat.cellWidth);l=u.start,h=u.end;for(var p=e.childWidgets.indexOf(i.ownerRow),f=e.childWidgets.indexOf(t.ownerRow);f<=p;f++)for(var g=e.childWidgets[f],m=0;m<g.childWidgets.length;m++){var v=o.getCellLeft(g,g.childWidgets[m]);Math.round(l)<=Math.round(v)&&Math.round(v)<Math.round(h)&&this.changeCaseParaForCellInternal(g.childWidgets[m],o,n,r)}},s.prototype.changeCaseParaForCellInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof I?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseParaFormatTableInternal(o,t,i,n)}},s.prototype.changeCaseParaFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++)this.changeCaseParaForCellInternal(o.childWidgets[l],t,i,n)},s.prototype.changeCaseParaForRow=function(e,t,i,n,r,o){for(var l=e.rowIndex;l<e.ownerTable.childWidgets.length;l++){for(var h=e.ownerTable.childWidgets[l],d=0;d<h.childWidgets.length;d++)this.changeCaseParaForCellInternal(h.childWidgets[d],t,r,o);if(n.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(h,n.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,n,r,o)},s.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=e}},s.prototype.getCurrentSelectionValue=function(e){var t=!1;if("bold"===e||"italic"===e){var i=this.getSelectedCharacterFormat();"bold"===e&&(t=!i.bold),"italic"===e&&(t=!i.italic)}return t},s.prototype.getSelectedCharacterFormat=function(){var e=0,t=this.selection.start;this.selection.isForward||(t=this.selection.end);var i=t.currentWidget,n=i.getInline(t.offset,e),r=n.element;e=n.index;var o=i.paragraph.characterFormat;if(!(0,a.le)(r))if(this.selection.isEmpty&&"List"===this.selection.contextType){var l=this.selection.getListLevel(this.selection.start.paragraph);l.characterFormat.uniqueCharacterFormat&&(o=l.characterFormat)}else o=this.selection.isEmpty||e!==r.length?r.characterFormat:(0,a.le)(r.nextNode)?i.paragraph.characterFormat:r.nextNode.characterFormat;return o},s.prototype.toggleUnderline=function(e){(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||this.updateProperty(1,e)},s.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t;t=(0,a.le)(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t}},s.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(var n=0;n<i.length;n++)if(e.fontSize<i[n])return i[n]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(n=0;n<i.length;n++)if(e.fontSize<=i[n])return i[n-1]}return e.fontSize},s.prototype.applyCharFormatInline=function(e,t,i,n,r,o,l){return 0===i&&n===e.length?(this.applyCharFormatValue(e.characterFormat,r,o,l),0):e instanceof S?this.formatInline(e,t,i,n,r,o,l):0},s.prototype.formatInline=function(e,t,i,n,r,o,l){var p,h=0,d=e,c=e.line.children.indexOf(d),f=0;return i>0&&(f+=1,(p=new S).characterFormat.copyFormat(e.characterFormat),p.line=e.line,p.text=e.text.substr(i,n-i),p.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(p.characterFormat,r,o,l),c++,d.line.children.splice(c,0,p),h++,this.updateRevisionForFormattedContent(e,p,f)),n<d.length&&(f+=1,(p=new S).characterFormat.copyFormat(e.characterFormat),p.text=d.text.substring(n),p.line=e.line,p.isRightToLeft=e.isRightToLeft,c++,d.line.children.splice(c,0,p),h++,this.updateRevisionForFormattedContent(e,p,f)),0===i?(e.text=e.text.substr(0,n),this.applyCharFormatValue(e.characterFormat,r,o,l)):e.text=e.text.substr(0,i),h},s.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e)+i;t.revisions.splice(0,0,r),r.range.splice(o,0,t)}},s.prototype.applyCharFormatCell=function(e,t,i,n,r,o,l){if(n.paragraph.isInsideTable){var h=t.getContainerCellOf(e,n.paragraph.associatedCell);if(h.ownerTable.contains(n.paragraph.associatedCell)){var d=t.getSelectedCell(e,h),c=t.getSelectedCell(n.paragraph.associatedCell,h);t.containsCell(h,n.paragraph.associatedCell)?t.isCellSelected(h,i,n)?(o=this.getCharacterFormatValueOfCell(e,t,o,r),this.applyCharFormatForSelectedCell(h,t,r,o,l)):d===h?this.applyCharFormat(i.paragraph,t,i,n,r,o,l):this.applyCharFormatRow(d.ownerRow,t,i,n,r,o,l):this.applyCharFormatForTableCell(h.ownerTable,t,h,c,r,o,l)}else this.applyCharFormatRow(h.ownerRow,t,i,n,r,o,l)}else{var u=t.getContainerCell(e);this.applyCharFormatRow(u.ownerRow,t,i,n,r,o,l)}},s.prototype.applyCharFormatForSelectedCell=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++){var l=e.childWidgets[o];l instanceof I?this.applyCharFormatForSelectedPara(l,t,i,n,r):this.applyCharFormatForSelTable(l,t,i,n,r)}},s.prototype.applyCharFormatRow=function(e,t,i,n,r,o,l){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,r),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,n,r,o,l)},s.prototype.applyCharFormatForTable=function(e,t,i,n,r,o,l,h){t=t.combineWidget(this.owner.viewer);for(var d=e;d<t.childWidgets.length;d++){for(var c=t.childWidgets[d],u=0;u<c.childWidgets.length;u++)this.applyCharFormatForSelectedCell(c.childWidgets[u],i,o,l,h);if(r.paragraph.isInsideTable&&i.containsRow(c,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,n,r,o,l,h)},s.prototype.applyCharFormatForSelTable=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var l=e.childWidgets[o],h=0;h<l.childWidgets.length;h++)this.applyCharFormatForSelectedCell(l.childWidgets[h],t,i,n,r)},s.prototype.applyCharFormatForTableCell=function(e,t,i,n,r,o,l){var h=t.getCellLeft(i.ownerRow,i),d=h+i.cellFormat.cellWidth,c=t.getCellLeft(n.ownerRow,n),p=this.updateSelectedCellsInTable(h,d,c,c+n.cellFormat.cellWidth);h=p.start,d=p.end;for(var f=e.childWidgets.indexOf(n.ownerRow),g=!1,m=e.childWidgets.indexOf(i.ownerRow);m<=f;m++)for(var v=e.childWidgets[m],y=0;y<v.childWidgets.length;y++){var b=t.getCellLeft(v,v.childWidgets[y]);w.round(h,2)<=w.round(b,2)&&w.round(b,2)<w.round(d,2)&&(g||(o=this.getCharacterFormatValueOfCell(v.childWidgets[y],t,o,r),g=!0),this.applyCharFormatForSelectedCell(v.childWidgets[y],t,r,o,l))}},s.prototype.updateSelectedCellsInTable=function(e,t,i,n){var r=this.documentHelper.selection;return e>i&&(e=i),t<n&&(t=n),e>r.upDownSelectionLength&&(e=r.upDownSelectionLength),t<r.upDownSelectionLength&&(t=r.upDownSelectionLength),{start:e,end:t}},s.prototype.getCharacterFormatValueOfCell=function(e,t,i,n){if("boolean"==typeof i||void 0===i&&("bold"===n||"italic"===n)){var r=t.getFirstParagraph(e),o=r.characterFormat;r.childWidgets.length>0&&r.childWidgets[0].children.length>0&&(o=r.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(n)}return i},s.prototype.applyCharFormatValueInternal=function(e,t,i,n){this.applyCharFormatValue(t,i,n,!1)},s.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},s.prototype.applyCharFormatValue=function(e,t,i,n){if(n&&"fontSize"===t&&(i=this.updateFontSize(e,i)),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,i)),i instanceof ie)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(i,e):e.copyFormat(i);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof fe){var r=e.ownerBase,o=r.previousNode;if((0,a.le)(o)){var l=r.paragraph.previousWidget;if(!(0,a.le)(l)&&!l.isEmpty()){var h=l.lastChild;o=h.children[h.children.length-1]}}for(;!((0,a.le)(o)||o instanceof S);)o=o.previousNode;if(!(0,a.le)(o)&&o.revisions.length>0){var d=o.revisions[o.revisions.length-1];this.isRevisionAlreadyIn(r,d)||(r.revisions.push(d),d.range.push(r))}else this.insertRevision(r,"Insertion")}(0,a.le)(i)?e.clearFormat():"bold"===t?e.bold=i:"italic"===t?e.italic=i:"fontColor"===t?e.fontColor=i:"fontFamily"===t?e.fontFamily=i:"fontSize"===t?e.fontSize=i:"highlightColor"===t?e.highlightColor=i:"baselineAlignment"===t?e.baselineAlignment=i:"strikethrough"===t?e.strikethrough=i:"underline"===t?e.underline=i:"styleName"===t?e.baseCharStyle=i:"allCaps"===t&&(e.allCaps=i)}},s.prototype.onImageFormat=function(e,t,i){var n=new Gi(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(n)),this.setOffsetValue(this.selection),e.width=t,e.height=i,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},s.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||((0,a.le)(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):this.onApplyParagraphFormat("textAlignment","Left"===e?"Justify":"Left",!1,!0))},s.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start;this.documentHelper.selection.isForward||(e=this.documentHelper.selection.end);var t=e.paragraph;if(t.paragraphFormat.keepWithNext){var i=t.bodyWidget;if(!(0,a.le)(i)&&i instanceof j&&i.page){var n=i.page.previousPage;n&&(this.previousBlockToLayout=n.bodyWidgets[0].lastChild)}}},s.prototype.applyParagraphBorders=function(e,t,i){var n=new ve;switch(e){case"color":n.color=i;break;case"lineWidth":n.lineWidth=i;break;case"lineStyle":n.lineStyle=i;break;case"shadow":n.shadow=i;break;case"space":n.space=i}this.onApplyParagraphFormat(t,n,!1,!1)},s.prototype.onApplyParagraphFormat=function(e,t,i,n){var r=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!this.restrictFormatting||r){this.setPreviousBlockToLayout();var o="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1);this.documentHelper.owner.isShiftingEnabled=!0;var l=this.documentHelper.selection,h=l.start.paragraph,d=!1;if(l.isForward||(h=l.end.paragraph),"leftIndent"==e&&(d=this.isFirstParaForList(l,h)),t<=0&&"leftIndent"==e){var c=w.convertPointToPixel(t);if(h.x+c<this.viewer.clientArea.x)return}if(this.initHistory(o),(!this.owner.isReadOnlyMode||r)&&this.owner.isDocumentLoaded){if("leftIndent"===e&&!(0,a.le)(l.paragraphFormat.listId)&&-1!==l.paragraphFormat.listId&&i)return void(d?this.updateListLevelIndent(t,h):this.updateListLevel(t>0));if(t instanceof gt&&"styleName"==e&&l.isEmpty||!l.isEmpty)"ParagraphBidi"!==o&&this.setOffsetValue(l),this.updateSelectionParagraphFormatting(e,t,i);else{this.setOffsetValue(l),l.paragraphFormat.bidi&&("listFormat"===e||-1!==l.paragraphFormat.listId)||(this.documentHelper.layout.isBidiReLayout=!0),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(l.start.paragraph,t));var f=l.start.paragraph;f=f.combineWidget(this.owner.viewer),this.applyParaFormatProperty(f,e,t,i),this.layoutItemBlock(f,!1)}this.reLayout(l)}}},s.prototype.updateListLevelIndent=function(e,t){var i=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),n=this.documentHelper.getAbstractListById(i.abstractListId);if(this.initHistory("List"),e<0&&n.levels[0].paragraphFormat.leftIndent+e<=0&&(e=18-n.levels[0].paragraphFormat.leftIndent),0!=e){for(var o=0;o<n.levels.length;o++)this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(n.levels[o]),n.levels[o].paragraphFormat.leftIndent+=e;this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},s.prototype.isFirstParaForList=function(e,t){var i=!1;if(!(0,a.le)(e.paragraphFormat.listId)&&-1!==e.paragraphFormat.listId&&0===t.paragraphFormat.listFormat.listLevelNumber){var n=this.updateWholeListItems(t,!0,e.paragraphFormat.listId);(0,a.le)(n)&&(i=!0)}return i},s.prototype.updateListLevel=function(e){var l,t=this.documentHelper,n=this.documentHelper.selection.start.paragraph.paragraphFormat,r=t.getListById(n.listFormat.listId),h=(t.layout.getListLevel(r,n.listFormat.listLevelNumber),t.layout.getListLevel(r,l=e?n.listFormat.listLevelNumber+1:n.listFormat.listLevelNumber-1));(0,a.le)(h)||(this.onApplyListInternal(r,l),t.selection.start.updatePhysicalPosition(!0),t.selection.end.updatePhysicalPosition(!0),t.selection.updateCaretPosition())},s.prototype.onApplyListInternal=function(e,t){var i=new bt;!(0,a.le)(e)&&t>=0&&t<9&&(i.listId=e.listId,i.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",i,!1,!1)},s.prototype.updateSelectionParagraphFormatting=function(e,t,i){var n=this.documentHelper.selection;"leftIndent"===e&&i&&(t=!(0,a.le)(n.start)&&n.start.isExistBefore(n.end)?this.getIndentIncrementValue(n.start.paragraph,t):this.getIndentIncrementValue(n.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,i)},s.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var n=-this.getIndentIncrementValueInternal(-i,-t);return n%t==0?n:n+t}return this.getIndentIncrementValueInternal(i,t)},s.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var n=100*Math.round(e)%(100*Math.round(i))/100,o=(Math.round(e)-n)/Math.round(i)*i;return t>0&&(o+=i),o-e==0?t:o-e},s.prototype.updateParagraphFormatInternal=function(e,t,i){switch((0,a.le)(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"bidi":var n=-1!==this.selection.paragraphFormat.listId;n||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),n||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1)}},s.prototype.updateParagraphFormat=function(e,t,i){var n=this.documentHelper.selection,r=n.start,o=n.end;n.isForward||(r=n.end,o=n.start),this.applyParaFormatSelectedContent(r,o,e,t,i)},s.prototype.applyParaFormatSelectedContent=function(e,t,i,n,r){var o=this.documentHelper.selection;if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!o.isCellSelected(e.paragraph.associatedCell,e,t)){if(!(0,a.le)(n)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(e.paragraph,e,t,i,n,r))return;this.applyParaFormat(e.paragraph,e,t,i,n,r)}else{var l;e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(o)&&this.updateHistoryPosition(e,!0),this.applyParaFormatInCell(l=e.paragraph.associatedCell,e,t,i,n,r);var h=l.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.containerWidget,h,!1)}},s.prototype.applyParaFormatProperty=function(e,t,i,n){var r=e.paragraphFormat;if(n&&"leftIndent"===t&&(i=r.leftIndent+i),"listFormat"===t&&i instanceof bt){var o=i;o.hasValue("listLevelNumber")||(o.listLevelNumber=r.listFormat.listLevelNumber)}if(this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(r,t,i)),i instanceof ue&&((0,a.le)(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(i,r):r.copyFormat(i):"listFormat"===t&&(r.listFormat=i.listFormat,r.listFormat.ownerBase=r)),(0,a.le)(i))return r.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(r.ownerBase,0,0);if("afterSpacing"===t)r.afterSpacing=i;else if("beforeSpacing"===t)r.beforeSpacing=i;else if("leftIndent"===t)r.leftIndent=i;else if("lineSpacingType"===t)r.lineSpacingType=i;else if("lineSpacing"===t)r.lineSpacing=i;else if("rightIndent"===t)r.rightIndent=i;else if("firstLineIndent"===t)r.firstLineIndent=i;else if("textAlignment"===t){var l=i;r.bidi&&!(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&("Left"===l?l="Right":"Right"===l&&(l="Left")),r.textAlignment=l}else if("topBorder"===t)this.applyBorder(r.borders.top,i);else if("bottomBorder"===t)this.applyBorder(r.borders.bottom,i);else if("leftBorder"===t)this.applyBorder(r.borders.left,i);else if("rightBorder"===t)this.applyBorder(r.borders.right,i);else if("horizontalBorder"===t)this.applyBorder(r.borders.horizontal,i);else if("verticalBorder"===t)this.applyBorder(r.borders.vertical,i);else if("borders"===t)r.borders.copyFormat(i);else if("styleName"===t)"string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),r.applyStyle(i);else{if("listFormat"===t)return i instanceof ue&&(i=i.listFormat),r.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(r.ownerBase),r.listFormat.listId>=0&&r.clearIndent(),void this.layoutItemBlock(r.ownerBase,!1);"bidi"===t?r.bidi=i:"keepWithNext"===t?r.keepWithNext=i:"keepLinesTogether"===t?r.keepLinesTogether=i:"widowControl"===t?r.widowControl=i:"contextualSpacing"===t?r.contextualSpacing=i:"spaceAfterAuto"===t?r.spaceAfterAuto=i:"spaceBeforeAuto"===t&&(r.spaceBeforeAuto=i)}},s.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.listFormat.ownerBase=t,t.baseStyle=e.baseStyle},s.prototype.copyFromListLevelParagraphFormat=function(e,t){(0,a.le)(t.leftIndent)||(e.leftIndent=t.leftIndent),(0,a.le)(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},s.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},s.prototype.applyContinueNumberingInternal=function(e){var t=e.start.paragraph,i=this.getContinueNumberingInfo(t),n=this.getParagraphFormat(t,i.listLevelNumber,i.listPattern);this.changeListId(i.currentList,t,n,i.listLevelNumber,i.listPattern),this.reLayout(e,!1),this.documentHelper.updateFocus()},s.prototype.getContinueNumberingInfo=function(e){var t=void 0,i=0,n="None";!(0,a.le)(e.paragraphFormat)&&!(0,a.le)(e.paragraphFormat.listFormat)&&(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber);var r=this.documentHelper;if(0!==i&&!(0,a.le)(t)&&!(0,a.le)(r.getAbstractListById(t.abstractListId))&&!(0,a.le)(r.getAbstractListById(t.abstractListId).levels[i])){var o=this.documentHelper.layout.getListLevel(t,i);(0,a.le)(o)||(n=o.listLevelPattern)}return{currentList:t,listLevelNumber:i,listPattern:n}},s.prototype.revertContinueNumbering=function(e,t){var i=e.start.paragraph,n=this.getContinueNumberingInfo(i);this.changeListId(n.currentList,i,t,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},s.prototype.changeListId=function(e,t,i,n,r){if(!(0,a.le)(t)){if(t instanceof I&&e.listId===t.paragraphFormat.listFormat.listId&&n===t.paragraphFormat.listFormat.listLevelNumber){if(this.editorHistory){var o=this.editorHistory.currentBaseHistoryInfo;(0,a.le)(o)||(i=o.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i))}t.paragraphFormat.copyFormat(i),this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(e,t.nextRenderedWidget,i,n,r)}},s.prototype.getParagraphFormat=function(e,t,i){if(!(0,a.le)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof I){if((0,a.le)(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId)return this.getParagraphFormat(e.previousRenderedWidget,t,i);var n=this.selection.getListLevel(e.previousRenderedWidget);return 0===t||i===n.listLevelPattern||this.checkNumberArabic(i,n.listLevelPattern)?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,i)}},s.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},s.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},s.prototype.restartListAt=function(e){var t=e.paragraphFormat.getList(),i=t.clone();i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1,this.documentHelper.lists.push(i);var n=t.abstractList.clone();n.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=n.abstractListId,i.abstractList=n,this.documentHelper.abstractLists.push(n),this.restartListAtInternal(e,i.listId)},s.prototype.restartListAtInternal=function(e,t){var i=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(i.currentList,e.start.paragraph,t),this.reLayout(e,!1),this.documentHelper.updateFocus()},s.prototype.changeRestartNumbering=function(e,t,i){if(!(0,a.le)(t)){if(t instanceof I&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var n=this.editorHistory.currentBaseHistoryInfo;(0,a.le)(n)||(i=n.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i))}t.paragraphFormat.listFormat.listId=i,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(e,t.nextRenderedWidget,i)}},s.prototype.applyParaFormat=function(e,t,i,n,r,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,n,r,o),this.layoutItemBlock(e,!1),this.getOffsetValue(this.selection),!e.equals(i.paragraph)&&this.getNextParagraphForFormatting(e,t,i,n,r,o)},s.prototype.applyCharacterStyle=function(e,t,i,n,r,o){var l=e.getSplitWidgets(),h=i.owner.selection,d=i.currentWidget;return!(0===t.offset&&(h.isParagraphLastLine(d)&&i.currentWidget===d&&i.offset===h.getLineLength(d)+1||i.isAtParagraphEnd)||i.paragraph!==e&&-1===l.indexOf(i.paragraph))&&("Paragraph"===r.type&&r.link instanceof gt||"Character"===r.type)&&(this.updateSelectionCharacterFormatting(n,"Character"===r.type?r:r.link,o),!0)},s.prototype.applyParaFormatInCell=function(e,t,i,n,r,o){var l=this.documentHelper.selection;if(i.paragraph.isInsideTable){var h=l.getContainerCellOf(e,i.paragraph.associatedCell);if(h.ownerTable.contains(i.paragraph.associatedCell)){var d=l.getSelectedCell(e,h),c=l.getSelectedCell(i.paragraph.associatedCell,h);l.containsCell(h,i.paragraph.associatedCell)?l.isCellSelected(h,t,i)?(r=this.getParaFormatValueInCell(h,n,r),this.applyParaFormatCellInternal(h,n,r,o)):d===h?this.applyParaFormat(t.paragraph,t,i,n,r,o):this.applyParagraphFormatRow(d.ownerRow,t,i,n,r,o):this.applyParaFormatTableCell(h.ownerTable,h,c,n,r,o)}else this.applyParagraphFormatRow(h.ownerRow,t,i,n,r,o)}else{var u=l.getContainerCell(e);this.applyParagraphFormatRow(u.ownerRow,t,i,n,r,o)}},s.prototype.applyParaFormatCellInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof I?this.applyParaFormatProperty(o,t,i,n):this.applyParagraphFormatTableInternal(o,t,i,n)}},s.prototype.getParaFormatValueInCell=function(e,t,i){return"boolean"==typeof i&&(i=!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t)),i},s.prototype.applyParagraphFormatRow=function(e,t,i,n,r,o){r=this.getParaFormatValueInCell(e.childWidgets[0],n,r);for(var l=e.rowIndex;l<e.ownerTable.childWidgets.length;l++){for(var h=e.ownerTable.childWidgets[l],d=0;d<h.childWidgets.length;d++)this.applyParaFormatCellInternal(h.childWidgets[d],n,r,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(h,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,n,r,o)},s.prototype.applyParaFormatTableCell=function(e,t,i,n,r,o){var l=this.documentHelper.selection,h=l.getCellLeft(t.ownerRow,t),d=h+t.cellFormat.cellWidth,c=l.getCellLeft(i.ownerRow,i),p=this.updateSelectedCellsInTable(h,d,c,c+i.cellFormat.cellWidth);h=p.start,d=p.end;for(var f=e.childWidgets.indexOf(i.ownerRow),g=!1,m=e.childWidgets.indexOf(t.ownerRow);m<=f;m++)for(var v=e.childWidgets[m],y=0;y<v.childWidgets.length;y++){var b=l.getCellLeft(v,v.childWidgets[y]);Math.round(h)<=Math.round(b)&&Math.round(b)<Math.round(d)&&(g||(r=this.getParaFormatValueInCell(v.childWidgets[y],n,r),g=!0),this.applyParaFormatCellInternal(v.childWidgets[y],n,r,o))}},s.prototype.applyParaFormatTable=function(e,t,i,n,r,o){e=e.combineWidget(this.owner.viewer);for(var l=this.documentHelper.selection,h=0;h<e.childWidgets.length;h++){for(var d=e.childWidgets[h],c=0;c<d.childWidgets.length;c++)this.applyParaFormatCellInternal(d.childWidgets[c],n,r,o);if(i.paragraph.isInsideTable&&l.containsRow(d,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,n,r,o)},s.prototype.getNextParagraphForFormatting=function(e,t,i,n,r,o){var l=e.getSplitWidgets();e=this.documentHelper.selection.getNextRenderedBlock(e=l[l.length-1]),(0,a.le)(e)||(e instanceof I?this.applyParaFormat(e,t,i,n,r,o):this.applyParaFormatTable(e,t,i,n,r,o))},s.prototype.applyParagraphFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++)this.applyParaFormatCellInternal(o.childWidgets[l],t,i,n)},s.prototype.onApplySectionFormat=function(e,t){if(!this.restrictFormatting){if((0,a.le)(e))this.initHistory("SectionFormat");else{var i=e[0].toUpperCase()+e.slice(1);this.initHistory(i)}this.updateSectionFormat(e,t)}},s.prototype.updateSectionFormat=function(e,t){var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var o,l,n=i.start,r=i.end;i.isForward||(n=i.end,r=i.start),this.documentHelper.clearContent();for(var h=n.paragraph.bodyWidget.sectionIndex,d=r.paragraph.bodyWidget.sectionIndex,c=!1,u=0;u<this.documentHelper.pages.length;u++)this.documentHelper.pages[u].bodyWidgets[0].index===h?o=u:c=!0;for(u=o;u<this.documentHelper.pages.length;u++){var p=this.documentHelper.pages[u].bodyWidgets[0];if(l=u,p.index!==h){if(p.index>=h&&p.index<=d)continue;l=u-1;break}}c&&"differentOddAndEvenPages"==e&&n.paragraph.isInHeaderFooter&&(o=0,l=this.documentHelper.pages.length-1);var f=!0,g=0;for(u=o;u<=l;u++)g!==this.documentHelper.pages[u].bodyWidgets[0].index&&!f&&(f=!0),this.applyPropertyValueForSection(this.documentHelper.pages[u].bodyWidgets[0].sectionFormat,e,t,f),g=this.documentHelper.pages[u].bodyWidgets[0].index,f=!1;this.layoutWholeDocument(),this.fireContentChange()},s.prototype.onApplyTableFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection,r=n.start.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer),n.isEmpty?(this.initHistory(i),this.applyTablePropertyValue(n,e,t,r)):this.updateSelectionTableFormat(this.selection,i,t),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r),this.reLayout(n,!1)}},s.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";default:return"DefaultCellSpacing"}},s.prototype.onApplyTableRowFormat=function(e,t){if(!this.restrictFormatting){var i=this.getRowAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection;n.isEmpty?(this.initHistory(i),this.applyRowPropertyValue(n,e,t,n.start.paragraph.associatedCell.ownerRow)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1)}},s.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},s.prototype.onApplyTableCellFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableCellAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection,r=n.start.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer),n.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(n,e,t,n.start.paragraph.associatedCell.cellFormat),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1)}},s.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},s.prototype.applyPropertyValueForSection=function(e,t,i,n){if(n&&this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,i)),!(0,a.le)(i)){if(i instanceof je)return void((0,a.le)(t)&&e.copyFormat(i,this.editorHistory));"pageHeight"===t?e.pageHeight=i:"pageWidth"===t?e.pageWidth=i:"leftMargin"===t?e.leftMargin=i:"rightMargin"===t?e.rightMargin=i:"topMargin"===t?e.topMargin=i:"bottomMargin"===t?e.bottomMargin=i:"differentFirstPage"===t?e.differentFirstPage=i:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=i:"headerDistance"===t?e.headerDistance=i:"footerDistance"===t?e.footerDistance=i:"pageStartingNumber"===t?e.pageStartingNumber=i:"restartPageNumbering"===t?e.restartPageNumbering=i:"endnoteNumberFormat"===t?e.endnoteNumberFormat=i:"footNoteNumberFormat"===t?e.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?e.initialFootNoteNumber=i:"initialEndNoteNumber"===t&&(e.initialEndNoteNumber=i)}},s.prototype.layoutWholeDocument=function(e){this.documentHelper.layout.isLayoutWhole=!0;var t=this.documentHelper.selection.start,i=this.documentHelper.selection.end;t.isExistAfter(i)&&(t=this.documentHelper.selection.end,i=this.documentHelper.selection.start),(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(t,i),t=i);var n=this.selection.getParagraphInfo(t),r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),l=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];var h=this.combineSection();this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(h,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(t,o),this.setPositionForCurrentIndex(i,l),this.documentHelper.selection.selectPosition(t,i),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1},s.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];do{t=this.combineSectionChild(t,e)}while(t);return e},s.prototype.combineSectionChild=function(e,t){var i=e,n=new j;n.sectionFormat=e.sectionFormat,n.index=i.index;do{i=e,e.lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];o instanceof k?this.documentHelper.layout.clearTableWidget(o,!0,!0,!0):(o.x=0,o.y=0,o.width=0,o.height=0),n.childWidgets.push(o),i.childWidgets.splice(r,1),r--,o.containerWidget=n}i.page.destroy()}while(e&&i.equals(e));return t.push(n),e},s.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i)}},s.prototype.updateTableFormat=function(e,t,i){var n=e.start;e.isForward||(n=e.end),this.initHistoryPosition(e,n),this.applyTablePropertyValue(e,t,i,n.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(n.paragraph.associatedCell.ownerTable)},s.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var n=e.start;e.isForward||(n=e.end),this.initHistoryPosition(e,n),this.updateFormatForCell(e,t,i)},s.prototype.updateRowFormat=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start),this.initHistoryPosition(e,n),this.applyRowFormat(n.paragraph.associatedCell.ownerRow,n,r,t,i)},s.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&((0,a.le)(t)?(0,a.le)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):(0,a.le)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},s.prototype.startSelectionReLayouting=function(e,t,i,n){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var r=i.paragraph.associatedCell.ownerTable;r.isInsideTable;)r=r.associatedCell.ownerTable;this.reLayoutSelectionOfTable(r,t,i,n)}else this.reLayoutSelection(e,t,i,n)},s.prototype.reLayoutSelectionOfTable=function(e,t,i,n){var r=!1;if(this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!(0,a.le)(n.paragraph.associatedCell)&&e.contains(n.paragraph.associatedCell))return!0;var o=t.getNextRenderedBlock(e);return(0,a.le)(o)||(r=this.reLayoutSelectionOfBlock(o,t,i,n)),r},s.prototype.reLayoutSelection=function(e,t,i,n){if(i.paragraph===e){t.getParagraphLength(e);var l=0,h=0,d=e.getInline(i.offset,l),c=d.element;l=d.index,(0,a.le)(c)||(l===c.length&&!(0,a.le)(c.nextNode)&&(c=c.nextNode),h=c.line.children.indexOf(c));var u=0;i.currentWidget.paragraph===e&&(u=e.childWidgets.indexOf(i.currentWidget),h=i.currentWidget.children.indexOf(c)),this.documentHelper.layout.reLayoutParagraph(e,u,c instanceof S&&!c.line&&h>0?h-1:h)}else this.documentHelper.layout.reLayoutParagraph(e,0,0);if(n.paragraph===e)return!0;var p=t.getNextRenderedBlock(e);return!(0,a.le)(p)&&this.reLayoutSelectionOfBlock(p,t,i,n)},s.prototype.reLayoutSelectionOfBlock=function(e,t,i,n){if(e instanceof I)return this.reLayoutSelection(e,t,i,n)},s.prototype.layoutItemBlock=function(e,t){if(e.containerWidget instanceof Ye)!(0,a.le)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(e=e.combineWidget(this.viewer),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1));else if(e.containerWidget instanceof V){var n=e.containerWidget;n=this.documentHelper.selection.getContainerCell(n),!(0,a.le)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)}},s.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},s.prototype.removeSelectedContentInternal=function(e,t,i){var n=t,r=i;if(t.isExistBefore(i)||(n=i,r=t),n.paragraph===r.paragraph&&n.paragraph.childWidgets.indexOf(n.currentWidget)===n.paragraph.childWidgets.length-1&&n.offset===e.getParagraphLength(n.paragraph)&&n.offset+1===r.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(n,!0),!0;var o=this.selection.getParagraphInfo(n);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());var l=n.clone(),h=l.paragraph.containerWidget,d=l.currentWidget.isFirstLine(),c=this.checkMultipleSectionSelected(l,r),u=this.removeSelectedContent(r.paragraph,e,n,r),p=new Z(e.owner);if(c&&"DefaultPaste"==this.selection.currentPasteAction&&d&&l.offset<1){var f=l.paragraph,g=new I,m=new oe(g);m.paragraph=g,g.containerWidget=h,g.childWidgets.push(m),h.childWidgets.push(g),g.index=f.index,g.x=l.location.x,g.y=l.location.y}return this.setPositionForCurrentIndex(p,e.editPosition),e.selectContent(p,!0),u},s.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},s.prototype.getBodyWidgetIndex=function(e){var t=e.hierarchicalPosition,i=t.indexOf(";"),n=t.substring(0,i);return i=(t=t.substring(i).replace(";","")).indexOf(";"),n=t.substring(0,i),parseInt(n,10)},s.prototype.removeSelectedContent=function(e,t,i,n){return!(n.paragraph.isInsideTable&&n.paragraph!==t.getLastParagraphInLastCell(n.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==n.paragraph.associatedCell.ownerTable.index)||(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,n,2),0))},s.prototype.deleteSelectedContent=function(e,t,i,n,r){var o=0,l=i.currentWidget.getInline(i.offset,o);o=l.index,l=n.currentWidget.getInline(n.offset,o=0),o=l.index,n.paragraph===e?!n.paragraph.isInsideTable||i.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(n.paragraph.associatedCell,i,n)?(this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock&&(this.delSection&&(this.deleteSection(t,this.delSection,e.bodyWidget instanceof j?e.bodyWidget:void 0,r),this.delSection=void 0),this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0)):(n.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(n.paragraph.associatedCell,t,i,n,r)):this.deleteSelectedContent(n.paragraph,t,i,n,r)},s.prototype.mergeCells=function(){this.owner.isReadOnlyMode||!this.canEditContentControl||!this.owner.isDocumentLoaded||!(0,a.le)(this.documentHelper)&&!this.selection.isEmpty&&this.mergeSelectedCellsInTable()},s.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer);this.selection.selectTable();var i=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(i=this.checkAndRemoveComments(),this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var n=!0;if(!this.skipTracking()){for(var r=0,o=0;o<t.childWidgets.length;o++){var l=t.childWidgets[o];1===l.rowFormat.revisions.length&&"Insertion"===l.rowFormat.revisions[0].revisionType&&l.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(l.rowFormat,!0),this.isRemoveRevision=!1,0===l.rowFormat.revisions[0].range.length&&l.rowFormat.revisions.splice(0,1),r++)}r===t.childWidgets.length&&(n=!1)}var h=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone()),this.owner.enableTrackChanges&&n)for(o=0;o<t.childWidgets.length;o++)0===o&&(h=this.selection.getFirstParagraph(t.childWidgets[0])),this.trackRowDeletion(t.childWidgets[o]);else this.removeBlock(t);this.selection.selectParagraphInternal(h,!0),(this.checkIsNotRedoing()||(0,a.le)(this.editorHistory))&&(this.reLayout(this.selection),this.updateHistoryForComments(i))}}},s.prototype.deleteColumn=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl)if(this.owner.enableTrackChanges){var e=new a.E7("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=se.hZ.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.onDeleteColumnConfirmed.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}})}else this.onDeleteColumnConfirmed()},s.prototype.onDeleteColumnConfirmed=function(){if((this.selection.isForward?this.selection.start:this.selection.end).paragraph.isInsideTable){this.selection.selectColumn();var i=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(i=this.checkAndRemoveComments(),this.initHistory("DeleteColumn"));var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),o=n.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(o);var l=void 0;r.nextWidget?l=this.selection.getFirstParagraph(r.nextWidget):n.previousWidget&&(l=this.selection.getFirstParagraph(n.previousWidget)),(0,a.le)(l)&&(l=this.getParagraphForSelection(o));for(var c=o.getColumnCellsForSelection(n,r),u=0;u<o.childWidgets.length;u++){var p=o.childWidgets[u];if(1===p.childWidgets.length)c.indexOf(p.childWidgets[0])>=0&&(o.childWidgets.splice(o.childWidgets.indexOf(p),1),p.destroy(),u--);else{for(var f=0;f<p.childWidgets.length;f++){var g=p.childWidgets[f];c.indexOf(g)>=0&&(p.childWidgets.splice(f,1),g.destroy(),f--)}0===p.childWidgets.length&&(o.childWidgets.splice(o.childWidgets.indexOf(p),1),p.destroy(),u--)}}0===o.childWidgets.length?(l=this.getParagraphForSelection(o),this.removeBlock(o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),o.destroy()):(o.isGridUpdated=!1,o.buildTableColumns(),o.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(o)),this.selection.selectParagraphInternal(l,!0),((0,a.le)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(i)),(0,a.le)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)}},s.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.getParagraphInfo(e),n=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());if(e.paragraph.isInsideTable){var r=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward);this.selection.selectRow();var l=[];this.checkIsNotRedoing()&&(l=this.checkAndRemoveComments(),this.initHistory("DeleteRow")),this.selection.owner.isShiftingEnabled=!0;var h=r.ownerTable.combineWidget(this.owner.viewer),d=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(h);var c=void 0;if(d.nextWidget&&(c=this.selection.getFirstParagraph(d.nextWidget.childWidgets[0])),(0,a.le)(c)&&(c=this.getParagraphForSelection(h)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(d,!0,!1):this.removeRow(d);else{var p=this.selection.getContainerCellOf(r,o);if(p.ownerTable.contains(o))if(r=this.selection.getSelectedCell(r,p),o=this.selection.getSelectedCell(o,p),this.selection.containsCell(p,o))this.removeRow(d=r.ownerRow);else{d=r.ownerRow;var f=o.ownerRow;c=void 0,f.nextWidget&&(c=this.selection.getFirstParagraph(f.nextWidget.childWidgets[0])),(0,a.le)(c)&&(c=this.getParagraphForSelection(h));for(var g=0;g<h.childWidgets.length;g++){var m=h.childWidgets[g];m.rowIndex>=d.rowIndex&&m.rowIndex<=f.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(m,!0,!1):(h.childWidgets.splice(g,1),m.destroy(),g--))}0===h.childWidgets.length?(this.removeBlock(h),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),h.destroy()):this.updateTable(h)}}if(!this.owner.enableTrackChanges||(0,a.le)(h.childWidgets))this.selection.selectParagraphInternal(c,!0);else{var v=this.selection.getTextPosBasedOnLogicalIndex(n);this.selection.selectContent(v,!0)}((0,a.le)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(l))}}},s.prototype.trackRowDeletion=function(e,t,i){var n=e.rowFormat;if(!(0,a.le)(n)){if(n.revisions.length>0){var o=this.retrieveRevisionInOder(n);if("Insertion"===o.revisionType){if(this.isRevisionMatched(n,void 0))return(0,a.le)(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===o.revisionType&&this.unlinkWholeRangeInRevision(n,o)}((0,a.le)(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(n,"Deletion");for(var l=0;l<e.childWidgets.length;l++)for(var h=e.childWidgets[l],d=0;d<h.childWidgets.length;d++)if(h.childWidgets[d]instanceof k)this.trackInnerTable(h.childWidgets[l],t,i);else{var c=h.childWidgets[d];this.skipTableElements=!0,this.insertRevisionForBlock(c,"Deletion",void 0,void 0,!0),this.skipTableElements=!1}}return!1},s.prototype.trackInnerTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.trackRowDeletion(e.childWidgets[n],t,i)},s.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},s.prototype.removeRow=function(e){var t=e.ownerTable;e.rowFormat.revisions.length>0&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},s.prototype.updateTable=function(e){(e=e.combineWidget(this.viewer)).updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},s.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,n=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof I?i:this.selection.getFirstParagraphInFirstCell(i):n&&(t=n instanceof I?n:this.selection.getLastParagraphInLastCell(n)),t},s.prototype.deletePara=function(e,t,i,n){e=e.combineWidget(this.owner.viewer);var r=this.documentHelper.selection,o=r.getStartOffset(e),l=r.getStartOffset(i.paragraph),h=o,d=0,c=!1,u=this.selection.getLineLength(e.lastChild),p=e,f=e.bodyWidget instanceof j?e.bodyWidget:void 0,g=void 0,m=void 0,v=this.combineLastBlock;e===t.paragraph?(h=t.offset,g=t.currentWidget,i.paragraph.isInsideTable&&(c=this.isEndInAdjacentTable(e,i.paragraph)),c||(c=this.combineLastBlock),this.combineLastBlock=!1):g=e.firstChild,e!==t.paragraph&&r.isSkipLayouting&&(r.isSkipLayouting=!1),e===i.paragraph?(m=i.currentWidget,d=i.offset):(m=e.lastChild,d=this.documentHelper.selection.getLineLength(e.lastChild));var y=(0,a.le)(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer);(h>o&&t.currentWidget===e.lastChild&&h===u&&(e===i.paragraph&&i.offset===h+1||e.nextRenderedWidget===i.paragraph&&i.offset===l)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&y&&y.isPageBreak()&&(0===h&&!t.currentWidget.isFirstLine||h>0)||t.paragraph!==i.paragraph&&2===n&&t.paragraph===e&&t.paragraph.nextWidget===i.paragraph)&&(c=!0);var b=i.clone();b.offset=b.offset-1;var C=t.paragraph===e&&t.isAtParagraphStart&&b.isAtParagraphEnd&&this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action;C&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace");var F=t.paragraph===e;if(i.paragraph===e&&i.currentWidget!==e.lastChild||i.currentWidget===e.lastChild&&i.offset<=r.getLineLength(e.lastChild)||C)(i.currentWidget.isFirstLine()&&i.offset>o||!i.currentWidget.isFirstLine()||C)&&this.removeInlines(e,g,h,m,d,n),(0,a.le)(y)||F||C?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=y,this.delSection=(T=y.bodyWidget instanceof j?y.bodyWidget:void 0)&&!f.equals(T)&&f.index!==T.index?T:void 0);else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&h>o)){if(this.delBlockContinue=!1,this.delBlock=void 0,4===n)return;return void(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action?(this.addRemovedNodes(e.characterFormat.cloneFormat()),e.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[]):this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action?c?(p=this.splitParagraph(e,e.firstChild,0,g,h,!0),this.deleteParagraphMark(p,r,n,!0),this.addRemovedNodes(e)):this.removeInlines(e,g,h,m,d,n):(p=this.splitParagraph(e,e.firstChild,0,g,h,!0),this.insertParagraphPaste(e,p,t,i,c,n,v),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e)))}i.paragraph===e&&i.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>r.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&i.offset>=r.getLineLength(i.paragraph.lastChild)&&i.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var x=void 0,P=e.previousWidget,E=P instanceof I?P:void 0,L=e.nextRenderedWidget;if(n<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){var W=-1;if(this.editorHistory.currentBaseHistoryInfo&&(W=this.editorHistory.currentBaseHistoryInfo.removedNodes.length),this.insertRevisionForBlock(e,"Deletion"),!e.isEmpty()||i.paragraph.previousRenderedWidget instanceof k?this.combineRevisionWithBlocks(e.firstChild.children[0]):(x=this.checkAndInsertBlock(e,t,i,n,E),this.removeBlock(e),-1===W?this.addRemovedNodes(e):this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(W,0,e),this.removeRevisionForBlock(e,void 0,!1,!0)),e===i.paragraph&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&!this.isInsertingTOC){var R=this.selection.getParagraphInfo(i);this.selection.editPosition=this.selection.getHierarchicalIndex(R.paragraph,R.offset.toString())}if(t.paragraph!==e&&!(0,a.le)(y))return this.delBlockContinue=!0,void(this.delBlock=y)}else{var T;x=this.checkAndInsertBlock(e,t,i,n,E),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e),(0,a.le)(y)||F||C||(this.delBlock=y,(T=y.bodyWidget instanceof j?y.bodyWidget:void 0)&&!f.equals(T)&&f.index!==T.index&&this.deleteSection(r,T,e.bodyWidget instanceof j?e.bodyWidget:void 0,n)),this.removeBlock(e)}if(this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),(0,a.le)(x)){if(e===t.paragraph&&((0,a.le)(L)||!(0,a.le)(L)&&f.index!==L.bodyWidget.index)&&!(0,a.le)(E)){var B=this.selection.getParagraphLength(E);r.editPosition=this.selection.getHierarchicalIndex(E,B.toString()),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(r.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=r.editPosition)}}else r.editPosition=this.selection.getHierarchicalIndex(x,"0"),B=r.getParagraphLength(x)+1,this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(x,B.toString()))}t.paragraph===e||(0,a.le)(y)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=y)}this.insertParagraphPaste(e,p,t,i,c,n,v)},s.prototype.deleteSection=function(e,t,i,n){n<4&&this.combineSectionInternal(e,t,i),n>2&&t.sectionFormat.copyFormat(i.sectionFormat)},s.prototype.combineSectionInternal=function(e,t,i){var n=t.getSplitWidgets()[0],r=[];this.combineSectionChild(n,r),this.updateBlockIndex((n=r[0]).lastChild.index+1,i.firstChild);for(var l=0,h=i,d=0;d<n.childWidgets.length;d++){var c=n.childWidgets.splice(d,1)[0];h.childWidgets.splice(l,0,c),c.containerWidget=h,this.documentHelper.layout.layoutBodyWidgetCollection(c.index,c.bodyWidget,c,!1),h=(c=c.getSplitWidgets().pop()).containerWidget,l=c.indexInOwner+1,d--}if(this.documentHelper.headersFooters[n.sectionIndex]){n.removedHeaderFooters=[];var u=this.documentHelper.headersFooters.splice(n.sectionIndex,1)[0],p=Object.keys(u);for(d=0;d<p.length;d++){var f=u[p[d]];this.removeFieldInWidget(f),this.removeFieldInWidget(f,!1,!0),f.page=void 0}n.removedHeaderFooters.push(u)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(n)},s.prototype.checkAndInsertBlock=function(e,t,i,n,r){if(e instanceof I&&e===t.paragraph||e instanceof k){var o=void 0;if((0,a.le)(e.nextWidget)&&((0,a.le)(r)||r.nextRenderedWidget instanceof k)){if(o=new I,1===n&&e instanceof I&&!(0,a.le)(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name&&(o.characterFormat.copyFormat(e.characterFormat),o.paragraphFormat.copyFormat(e.paragraphFormat)),o.index=e.index+1,o.containerWidget=e.containerWidget,e instanceof I){o.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType;var l=this.documentHelper.styles.findByName("Normal");(0,a.le)(l)||(o.paragraphFormat.baseStyle=new Xe,o.paragraphFormat.baseStyle.copyStyle(l))}this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),e.containerWidget instanceof Ze&&e.containerWidget.childWidgets.push(o)}return o}},s.prototype.splitParagraph=function(e,t,i,n,r,o){var l=new I;l.paragraphFormat=new ue(l),l.characterFormat=new ie(l),l.paragraphFormat.copyFormat(e.paragraphFormat),l.characterFormat.copyFormat(e.characterFormat);var h=new oe(l);l.childWidgets.push(h);var d=e.index,c=e.indexInOwner;if(this.moveInlines(e,l,0,i,t,r,n),e.containerWidget.childWidgets[c])for(var u=e.containerWidget.childWidgets[c],p=0;p<u.childWidgets.length;p++)for(var f=u.childWidgets[p],g=0;g<f.children.length;g++){var m=f.children[g];m instanceof Ee&&this.removeFootnote(m)}return e.containerWidget.childWidgets.splice(c,0,l),l.index=d,l.containerWidget=e.containerWidget,this.updateNextBlocksIndex(l,!0),o&&this.removeBlock(e),this.documentHelper.layout.layoutBodyWidgetCollection(d,l.containerWidget,l,!1),l},s.prototype.removeCommentsInBlock=function(e){if(e instanceof k)for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.removeCommentsInBlock(r.childWidgets[o]);else this.removeCommentInPara(e)},s.prototype.removeCommentInPara=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)this.removeCommentsInline(i.children[n])},s.prototype.removeCommentsInline=function(e){e instanceof ae&&(1===e.commentType||e.removeCommentMark())},s.prototype.removeBlock=function(e,t,i){var n,o;if(i||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0),this.removeCommentsInBlock(e)),e.isInsideTable)o=e.associatedCell,n=e.associatedCell.childWidgets.indexOf(e),this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(n,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,o,e,!1);else{o=e.containerWidget;for(var l=0;l<e.childWidgets.length;l++){var h=void 0;if(this.isPasteRevertAction()||(h=this.skipTracking()),e.childWidgets[l]instanceof Q&&!h&&this.removeDeletedCellRevision(e.childWidgets[l]),e.childWidgets[l]instanceof oe)for(var c=e.childWidgets[l],u=0;u<c.children.length;u++){var p=c.children[u];p instanceof Ee&&!this.selection.isEmpty&&this.removeFootnote(p)}}n=o.childWidgets.indexOf(e),this.updateNextBlocksIndex(e,!1),o.childWidgets.splice(n,1),e.containerWidget=void 0,o.height-=e.height,!(0,a.le)(o.containerWidget)&&o.containerWidget instanceof Y&&(o.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,o,e,!1,t)}},s.prototype.removePrevParaMarkRevision=function(e,t){if(t=!(0,a.le)(t)&&t,this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length){var n=-1,r=void 0,o=e;!t&&!(0,a.le)(o.previousRenderedWidget)&&(o=o.previousRenderedWidget),o.characterFormat.revisions.length>0&&(n=(r=o.characterFormat.revisions[o.characterFormat.revisions.length-1]).range.indexOf(o.characterFormat)),n>=0&&!(0,a.le)(r)&&r.range[n]instanceof ie&&(r.range.splice(n,1),o.characterFormat&&o.characterFormat.revisions.indexOf(r)>-1&&o.characterFormat.revisions.splice(o.characterFormat.revisions.indexOf(r),1),0==r.range.length&&this.owner.revisionsInternal.remove(r))}},s.prototype.isPasteRevertAction=function(){return!((0,a.le)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},s.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof k&&e.childWidgets.length>0){var t=e.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},s.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,n=0;n<i.bodyWidgets.length;n++)e===i.bodyWidgets[n].footNoteReference&&(i.height-=i.bodyWidgets[n].childWidgets[0].height,i.bodyWidgets.splice(n,1),n--);0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1)},s.prototype.removeEndnote=function(e,t){if(e.paragraph.bodyWidget.page.endnoteWidget){for(var i=e.paragraph.bodyWidget.page.endnoteWidget,n=0;n<i.bodyWidgets.length;n++)e===i.bodyWidgets[n].footNoteReference&&(i.height-=i.bodyWidgets[n].childWidgets[0].height,i.bodyWidgets.splice(n,1),n--);0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1)},s.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);i>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},s.prototype.removeField=function(e,t,i){var n=this.documentHelper.fields;if(t?n=this.documentHelper.bookmarks.keys:i&&(n=this.documentHelper.contentControlCollection),e.floatingElements.length>0)for(var r=0;r<e.floatingElements.length;r++)this.removeAutoShape(e.floatingElements[r]);for(var l=0;l<n.length;l++)(h=t?this.documentHelper.bookmarks.get(n[l]):n[l]).line.paragraph===e&&(t?this.documentHelper.bookmarks.remove(n[l]):i?this.documentHelper.contentControlCollection.splice(l,1):(this.documentHelper.fields.splice(l,1),-1!==this.documentHelper.formFields.indexOf(h)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(h),1)),l--);if(this.documentHelper.footnoteCollection.length>0)for(l=0;l<this.documentHelper.footnoteCollection.length;l++)if((h=this.documentHelper.footnoteCollection[l]).line.paragraph===e){if(h.paragraph.bodyWidget.page.footnoteWidget){for(var d=h.paragraph.bodyWidget.page.footnoteWidget,c=0;c<d.bodyWidgets.length;c++)h===d.bodyWidgets[c].footNoteReference&&(d.height-=d.bodyWidgets[c].height,d.bodyWidgets.splice(c,1),c--);0===d.bodyWidgets.length&&(h.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(l,1),l--}if(this.documentHelper.endnoteCollection.length>0)for(l=0;l<this.documentHelper.endnoteCollection.length;l++){var h;if((h=this.documentHelper.endnoteCollection[l]).line.paragraph===e){if(h.paragraph.bodyWidget.page.endnoteWidget){var u=h.paragraph.bodyWidget.page.endnoteWidget;for(c=0;c<u.bodyWidgets.length;c++)h===u.bodyWidgets[c].footNoteReference&&(u.height-=u.bodyWidgets[c].height,u.bodyWidgets.splice(c,1),c--);0===u.bodyWidgets.length&&(h.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(l,1),l--}}},s.prototype.addRemovedNodes=function(e,t){e instanceof ae&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof $&&0===e.type&&this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1),e instanceof H&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1)),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},s.prototype.deleteBlock=function(e,t,i,n,r){e instanceof I?(this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock&&(this.delSection&&(this.deleteSection(t,this.delSection,e.bodyWidget instanceof j?e.bodyWidget:void 0,r),this.delSection=void 0),-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0)):this.deleteTableBlock(e,t,i,n,r)},s.prototype.deleteTableCell=function(e,t,i,n,r){var o=!(i.paragraph.isInsideTable&&e.ownerTable.contains(i.paragraph.associatedCell)),l=e.ownerTable.previousRenderedWidget;if(i.paragraph.isInsideTable){var h=t.getContainerCellOf(e,i.paragraph.associatedCell);if(h.ownerTable.contains(i.paragraph.associatedCell)){var d=t.getSelectedCell(e,h);if(t.getSelectedCell(i.paragraph.associatedCell,h),t.containsCell(h,i.paragraph.associatedCell))if(t.isCellSelected(h,i,n))if(this.updateEditPosition(h,t),1===r)this.deleteCellsInTable(e.ownerRow.ownerTable,t,i,n,r);else{var u=this.deleteCell(h,t,r,!0);!u&&2!==r&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:u&&this.documentHelper.layout.reLayoutTable(h.ownerRow.ownerTable)}else if(d===h){if(this.deletePara(n.paragraph,i,n,r),this.delBlockContinue&&this.delBlock){if(this.delSection){var p=n.paragraph;this.deleteSection(t,this.delSection,p.bodyWidget instanceof j?p.bodyWidget:void 0,r),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteContainer(d,t,i,n,r);else 2===r?this.deleteCell(e,t,2,!1):this.deleteCellsInTable(h.ownerTable,t,i,n,r)}else this.deleteContainer(h,t,i,n,r)}else{var g=t.getContainerCell(e);this.deleteContainer(g,t,i,n,r)}o&&((0,a.le)(l)||this.deleteBlock(l,t,i,n,r))},s.prototype.deleteCellsInTable=function(e,t,i,n,r,o){var h="Delete",d=!1,c=i.paragraph.associatedCell,u=n.paragraph.associatedCell;if((0,a.le)(o)||(u=o),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)){if(h=this.editorHistory.currentBaseHistoryInfo.action,d="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||(0,a.le)(c.ownerRow.previousWidget)&&(0,a.le)(u.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e),"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=d?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}var p=c.columnIndex,f=u.columnIndex+u.cellFormat.columnSpan-1,g=c.rowIndex,m=u.rowIndex,v=this.isWholeRowSelected(c.ownerRow,p,f);if(this.owner.enableTrackChanges&&!this.skipTracking())if(v)this.onConfirmedTableCellsDeletion(e,t,g,m,p,f,d,r,v,h);else{var y=new a.E7("documenteditor",this.owner.defaultLocale),b=y.getConstant("UnTrack"),C=y.getConstant("Merge Track");y.setLocale(this.owner.locale),this.alertDialog=se.hZ.alert({title:b,content:C,showCloseIcon:!0,okButton:{text:"Ok",click:this.onConfirmedTableCellsDeletion.bind(this,e,t,g,m,p,f,d,r,v,h)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}})}else this.onConfirmedTableCellsDeletion(e,t,g,m,p,f,d,r,v,h)},s.prototype.removeDeletedCellRevision=function(e){e.rowFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++){var r=i.childWidgets[n];if(!(0,a.le)(r)&&r instanceof I){for(var o=0;o<r.childWidgets.length;o++){var l=r.childWidgets[o];if(!(0,a.le)(l.children))for(var h=0;h<l.children.length;h++){var d=l.children[h];d.revisions.length>0&&this.unlinkRangeFromRevision(d,!0)}}this.unlinkRangeFromRevision(r.characterFormat,!0)}}},s.prototype.onConfirmedTableCellsDeletion=function(e,t,i,n,r,o,l,h,d,c){for(var u=0;u<e.childWidgets.length;u++){var p=e.childWidgets[u],f=!1;if(p.index>=i&&p.index<=n&&(this.owner.enableTrackChanges&&!this.skipTracking()&&d?(f=this.trackRowDeletion(p,!1))&&this.onConfirmedCellDeletion(p,t,i,n,r,o,l,h):this.onConfirmedCellDeletion(p,t,i,n,r,o,l,h)),!f&&0===p.childWidgets.length){for(var g=e.childWidgets[u],m=g.previousRenderedWidget;!(0,a.le)(m);){for(var v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];g.rowIndex<y.ownerRow.rowIndex+y.cellFormat.rowSpan&&y.cellFormat.rowSpan--}m=m.previousRenderedWidget}this.updateNextBlocksIndex(g,!1),e.childWidgets.splice(u,1),u--,n--}}if(t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,c),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)),!(0,a.le)(this.alertDialog)){var b=t.getTextPosBasedOnLogicalIndex(t.editPosition);t.selectContent(b,!0),this.reLayout(t),this.alertDialog.close(),this.alertDialog=void 0}},s.prototype.onConfirmedCellDeletion=function(e,t,i,n,r,o,l,h){var d=!1;this.removeDeletedCellRevision(e);for(var u=0;u<e.childWidgets.length;u++){var p=e.childWidgets[u];if(p.columnIndex>=r&&p.columnIndex<=o)if(d||(this.updateEditPosition(p,t),d=!0),l){var f=e.childWidgets[u];this.updateNextBlocksIndex(f,!1);for(var g=0;g<f.childWidgets.length;g++)for(var m=f.childWidgets[g],v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];if(y instanceof oe)for(var b=y,C=0;C<b.children.length;C++){var F=b.children[C];F instanceof Ee&&this.removeFootnote(F)}}e.childWidgets.splice(u,1),u--}else h<4&&this.deleteCell(p,t,h,!1)}},s.prototype.removeRevisionForRow=function(e){e.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},s.prototype.removeRevisionsInRow=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++)this.unlinkWholeRangeInRevision(e.rowFormat,e.rowFormat.revisions[t])},s.prototype.removeRevisionForCell=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof I)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],l=0;l<o.children.length;l++){var h=o.children[l];!(0,a.le)(h)&&h.revisions.length>0&&(this.unlinkRangeFromRevision(h,t),this.addRemovedRevisionInfo(h,void 0))}else e.childWidgets[i]instanceof k&&this.removeRevisionForInnerTable(e.childWidgets[i])},s.prototype.removeRevisionForInnerTable=function(e){if(e.childWidgets.length>0)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];(0,a.le)(i)||this.removeRevisionForRow(i)}},s.prototype.removeRevisionForBlock=function(e,t,i,n){if(e.characterFormat.revisions.length>0&&!i&&(n&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),(0,a.le)(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!(0,a.le)(e))for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.children.length;l++){var h=o.children[l];!(0,a.le)(h)&&h.revisions.length>0&&(n&&this.addRemovedRevisionInfo(h,void 0,!1),(0,a.le)(t)?this.unlinkRangeFromRevision(h,!0):this.unlinkRangeByRevision(h,t),h.revisions=[])}},s.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];if(n.author===t.author&&n.revisionType===t.revisionType){e.revisions.splice(e.revisions.indexOf(t),1);var r=t.range.indexOf(e);t.range.splice(r,1)}}},s.prototype.isWholeRowSelected=function(e,t,i){return 0===t&&e.childWidgets.length-1===t+i},s.prototype.deleteCell=function(e,t,i,n){var r=e.childWidgets[0];if(1===e.childWidgets.length&&r instanceof I&&r.isEmpty())return!1;for(var o=e.childWidgets.length-1,l=e.childWidgets.length-1;l>-1;l--)if(r=e.childWidgets[l],i<4){if(r instanceof I&&l===o){var h=r;if(this.checkClearCells(t))h.isEmpty()||this.removeInlines(h,h.firstChild,0,h.lastChild,h.lastChild.getEndOffset(),i);else for(var d=h.childWidgets.length-1;d>=0;d--){for(var c=h.childWidgets[d],u=c.children.length-1;u>=0;u--){var p=c.children[u];p instanceof Ee?this.removeFootnote(p):p instanceof O&&0===p.bookmarkType&&this.documentHelper.bookmarks.containsKey(p.name)&&this.documentHelper.bookmarks.remove(p.name),this.unLinkFieldCharacter(p),c.children.splice(u,1)}h.childWidgets.length>1&&h.childWidgets.splice(d,1)}continue}this.removeBlock(r),this.checkClearCells(t)&&(this.addRemovedNodes(r),1===e.childWidgets.length&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0)))}return!0},s.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++){var r=this.documentHelper.bookmarks.get(i.keys[n]);r.paragraph===e&&t.push(r)}return t},s.prototype.deleteContainer=function(e,t,i,n,r){var o=e.ownerTable;if(t.containsRow(o.lastChild,n.paragraph.associatedCell))this.deleteContent(o,t,r);else if(this.toCheckForTrack(o))for(var l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];if(this.trackRowDeletion(h),n.paragraph.isInsideTable&&t.containsRow(h,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}else for(l=0;l<o.childWidgets.length;l++){var d=o.childWidgets[l];if(r<4&&(this.updateNextBlocksIndex(d,!1),o.childWidgets.splice(l,1),this.addRemovedNodes(d),l--),n.paragraph.isInsideTable&&t.containsRow(d,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}},s.prototype.deleteTableBlock=function(e,t,i,n,r){if(e=e.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)){var o=e.previousRenderedWidget,l=this.checkAndInsertBlock(e,i,n,r,o instanceof I?o:void 0);if(t.containsRow(e.firstChild,i.paragraph.associatedCell))this.deleteContent(e,t,r);else if(this.owner.enableTrackChanges)(0,a.le)(n.paragraph.associatedCell)&&!n.paragraph.isInsideTable&&this.deleteCellsInTable(e,t,i,n,r,n.paragraph.previousRenderedWidget.lastChild.lastChild);else{var c=this.splitTable(e,i.paragraph.associatedCell.ownerRow);this.deleteContent(e,t,r),this.documentHelper.layout.layoutBodyWidgetCollection(c.index,c.containerWidget,c,!1)}(0,a.le)(l)||(t.editPosition=this.selection.getHierarchicalIndex(l,"0"),this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var u=e.previousRenderedWidget;if(this.owner.enableTrackChanges)for(var f=0;f<e.childWidgets.length;f++)this.trackRowDeletion(e.childWidgets[f]);else this.deleteContent(e,t,r);(0,a.le)(u)||this.deleteBlock(u,t,i,n,r)}},s.prototype.splitTable=function(e,t){var i=new k;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r===t)break;i.childWidgets.push(r),r.containerWidget=i,e.childWidgets.splice(n,1),n--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},s.prototype.updateEditPosition=function(e,t){var i=t.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},s.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},s.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},s.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},s.prototype.isEndInAdjacentTable=function(e,t){var i=this.selection.getHierarchicalIndex(e,""),n=this.selection.getHierarchicalIndex(t,""),r=i.split(";"),o=n.split(";");return r.length<o.length},s.prototype.cloneTableToHistoryInfo=function(e){if(this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)){var t=e.clone();return this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t),this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),t}},s.prototype.insertParagraphPaste=function(e,t,i,n,r,o,l){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var h=this.selection.getNextParagraphBlock(t);if(h&&i.offset>0&&h===n.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var d=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(h),this.documentHelper.layout.clearListElementBox(t);for(var c=0;c<t.childWidgets.length;c++){var u=t.childWidgets[c];h.childWidgets.splice(d,0,u),t.childWidgets.splice(c,1),c--,d++,u.paragraph=h}this.documentHelper.layout.reLayoutParagraph(h,0,0),r=!1;var p=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(h,p)}}r&&this.deleteParagraphMark(t,this.selection,o,!1,l)},s.prototype.removeInlines=function(e,t,i,n,r,o){var l=!1;this.documentHelper.layout.clearListElementBox(e),e.childWidgets.indexOf(t);for(var d=this.selection.start.clone(),c=this.selection.end.clone(),u=this.selection.editPosition,p=e.childWidgets.length-1;p>=0;p--){var f=e.childWidgets[p];if(t===f&&n===f){this.removeContent(f,i,r,o),l=!0;break}if(n===f)l=!0,this.removeContent(f,0,r,o);else{if(t===f){this.removeContent(f,i,this.documentHelper.selection.getLineLength(f),o);break}l&&this.removeContent(f,0,this.documentHelper.selection.getLineLength(f),o)}}this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(d),this.selection.end.setPositionInternal(c),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=u),l&&(this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0))},s.prototype.skipTracking=function(){return!((0,a.le)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!((0,a.le)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},s.prototype.canHandleDeletion=function(){return!((0,a.le)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},s.prototype.deleteCommentInSelection=function(e){var t=this.editorHistory.currentBaseHistoryInfo;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&!this.editorHistory.currentHistoryInfo&&!(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.initComplexHistory("DeleteCommentInline"),this.deleteCommentInternal(e),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentHistoryInfo.addModifiedAction(t),this.selection.editPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=this.selection.editPosition,this.editorHistory.currentBaseHistoryInfo=t)},s.prototype.removeContent=function(e,t,i,n){for(var r=this.selection.getLineLength(e),o=void 0,l=0,h=void 0,d=e.children.length-1;d>=0;d--){var c=e.children[d];if((0,a.le)(n)||2!==n)for(var u=0;u<e.children.length;u++){var p=e.children[u];if(p instanceof S){var f=p.text;f.length+l>t&&!(l>t)&&(0,a.le)(o=f[t-l-1])&&t-l==0&&(o=h),f.length+l>i&&(" "===f[i-l]&&0===t||" "===o&&" "===f[i-l])&&(i+=1),h=f[f.length-1]}l+=p.length}if(i<=r-c.length)r-=c.length;else{var g=c.length;r>i&&r-g<i&&(g=i-(r-c.length));var m=0;if(r-c.length<t&&(m=t-(r-c.length)),r>i&&(r-=c.length-g),0===m&&g===c.length){if((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||c instanceof O&&this.removedBookmarkElements.push(c),c instanceof O&&this.documentHelper.bookmarks.containsKey(c.name)&&this.documentHelper.bookmarks.remove(c.name)),(c instanceof ee&&"Inline"!==c.textWrappingStyle||c instanceof de)&&this.removeAutoShape(c),this.skipFieldDeleteTracking&&c.revisions.length>0){var v=c;v instanceof H&&((1===v.fieldType||2===v.fieldType)&&(v=v.fieldBegin),this.clearFieldElementRevisions(v,c.revisions))}this.canHandleDeletion()||this.owner.enableTrackChanges&&!this.skipTracking()&&!this.skipFieldDeleteTracking&&!this.isInsertingTOC?(this.skipTableElements||this.addRemovedNodes(c.clone()),this.handleDeleteTracking(c,t,i,d)):(c instanceof Ee&&(c.isLayout=!1),this.unLinkFieldCharacter(c),this.unlinkRangeFromRevision(c,!0),this.addRemovedRevisionInfo(c,void 0),this.addRemovedNodes(c),e.children.splice(d,1))}else if(c instanceof S){var y=this.handleDeleteTracking(c,m,g);(0,a.le)(y)||this.skipTableElements||(c.revisions.length>0&&this.addRemovedRevisionInfo(c,y),this.addRemovedNodes(y))}if(c instanceof Ee&&("Footnote"===c.footnoteType?this.removeFootnote(c):this.removeEndnote(c)),t>=r-(g-m))break;r-=g-m,this.documentHelper.layout.clearListElementBox(e.paragraph)}}},s.prototype.deleteCommentWidgetInline=function(e){},s.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,n=0;n<i.length;n++)for(var r=i[n],o=0;o<r.range.length;o++)if(r.range[o]===e)for(var l=o;l<r.range.length;l){if(r.range[o]instanceof H&&1===r.range[o].fieldType&&r.range[o].fieldBegin===e){r.removeRangeRevisionForItem(r.range[o]),0===r.range.length&&this.owner.revisions.remove(r);break}r.removeRangeRevisionForItem(r.range[o])}},s.prototype.addRemovedRevisionInfo=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n].revisionID;(0,a.le)(t)?e.removedIds.push(r):t.removedIds.push(r)}(0,a.le)(t)&&((0,a.le)(i)||i)&&(e.revisions=[])},s.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++)0===e.childWidgets[t].children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)},s.prototype.cloneListLevel=function(e){var t=new nt(void 0);return this.copyListLevel(t,e),t},s.prototype.copyListLevel=function(e,t){(0,a.le)(t.paragraphFormat)||(e.paragraphFormat=new ue(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),(0,a.le)(t.characterFormat)||(e.characterFormat=new ie(e),e.characterFormat.copyFormat(t.characterFormat)),(0,a.le)(t.followCharacter)||(e.followCharacter=t.followCharacter),(0,a.le)(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),(0,a.le)(t.numberFormat)||(e.numberFormat=t.numberFormat),(0,a.le)(t.restartLevel)||(e.restartLevel=t.restartLevel),(0,a.le)(t.startAt)||(e.startAt=t.startAt)},s.prototype.cloneLevelOverride=function(e){var t=new It;return(0,a.le)(e.startAt)||(t.startAt=e.startAt),(0,a.le)(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),(0,a.le)(e.levelNumber)||(t.levelNumber=e.levelNumber),t},s.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},s.prototype.updateListParagraphsInBlock=function(e){if(e instanceof I)!(0,a.le)(e.paragraphFormat)&&!(0,a.le)(e.paragraphFormat.listFormat)&&!(0,a.le)(e.paragraphFormat.listFormat.listId)&&(e.paragraphFormat.listFormat.listId>=0&&e.paragraphFormat.clearIndent(),(0,a.le)(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof k)for(var t=0;t<e.childWidgets.length;t++)for(var i=0;i<e.childWidgets[t].childWidgets.length;i++)for(var n=e.childWidgets[t].childWidgets[i],r=0;r<n.childWidgets.length;r++)this.updateListParagraphsInBlock(n.childWidgets[r])},s.prototype.onApplyList=function(e){var t=this.documentHelper.selection;this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat");var i=new bt;(0,a.le)(e)||(i.listId=e.listId),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",i,!1),this.reLayout(t)},s.prototype.applyBulletOrNumbering=function(e,t,i){var n=this.documentHelper.selection,r=n.paragraphFormat.getList(),o=!1,l=n.start;n.isForward||(l=n.end);var h=l.paragraph;if((0,a.le)(r)){for(;!(0,a.le)(h.previousWidget)&&h.previousWidget instanceof I&&h.previousWidget.isEmpty()&&-1===h.previousWidget.paragraphFormat.listFormat.listId;)h=h.previousWidget;if(h.previousWidget&&h.previousWidget instanceof I&&-1!==h.previousWidget.paragraphFormat.listFormat.listId&&(r=this.documentHelper.getListById((h=h.previousWidget).paragraphFormat.listFormat.listId),o=!0),!o){for(;!(0,a.le)(h.nextWidget)&&h.nextWidget instanceof I&&h.nextWidget.isEmpty()&&-1===h.nextWidget.paragraphFormat.listFormat.listId;)h=h.nextWidget;h.nextWidget&&h.nextWidget instanceof I&&-1!==h.nextWidget.paragraphFormat.listFormat.listId&&(r=this.documentHelper.getListById((h=h.nextWidget).paragraphFormat.listFormat.listId),o=!0)}}var g,d=void 0,c=-1,u=void 0,p=!1;if(-1!==h.paragraphFormat.listFormat.listId&&!(0,a.le)(h.paragraphFormat.listFormat.listLevel)&&(this.listNumberFormat=h.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=h.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=h.paragraphFormat.listFormat.listLevelNumber),!(0,a.le)(r)){c=h.paragraphFormat.listFormat.listLevelNumber;var f=this.documentHelper.getListById(h.paragraphFormat.listFormat.listId);if(d=this.documentHelper.layout.getListLevel(f,c),c>0&&(u=this.documentHelper.layout.getListLevel(f,0),p=!(0,a.le)(u)&&c>0&&n.start.isInSameParagraph(n.end)),(g=f.abstractList)||(g=this.documentHelper.getAbstractListById(r.abstractListId)),0===g.levels.length&&(d=this.documentHelper.layout.getListLevel(f,h.paragraphFormat.listFormat.listLevelNumber)),o){if("Bullet"!==t&&d.listLevelPattern===t&&(d.numberFormat===e||-1!==d.numberFormat.indexOf(e)))return n.paragraphFormat.listId=r.listId,n.paragraphFormat.listLevelNumber=c,void n.paragraphFormat.setList(r);d=g.levels[0]}}if((0,a.le)(r)||!(0,a.le)(r)&&0===c&&(d.listLevelPattern!==t||d.numberFormat!==e||d.characterFormat.fontFamily!==i&&"Bullet"===d.listLevelPattern))o=!1,(r=new ft).listId=this.documentHelper.lists.length>0?this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:0,(g=new et).abstractListId=this.documentHelper.abstractLists.length>0?this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:0,r.abstractListId=g.abstractListId,r.abstractList=g,this.documentHelper.abstractLists.push(g),"bullet"===e||"multiLevel"===e||"numbering"===e?this.addListLevels(g,e,n):((m=new nt(g)).listLevelPattern=t,m.numberFormat=e,"Bullet"!==t?m.startAt=1:m.characterFormat.fontFamily=i,m.paragraphFormat.leftIndent=36,m.paragraphFormat.firstLineIndent=-18,g.levels.push(m),n.paragraphFormat.listLevelNumber=0),n.paragraphFormat.setList(r);else if(p&&!(0,a.le)(r)){f=this.documentHelper.getListById(h.paragraphFormat.listFormat.listId);var m=this.documentHelper.layout.getListLevel(f,c);if("Bullet"===t)m.numberFormat=e,m.characterFormat.fontFamily=i;else{m.listLevelPattern=t,m.characterFormat.fontFamily=i;var v=m.numberFormat.substring(m.numberFormat.length-1);m.numberFormat.length!==e.length&&c>0?m.numberFormat=e:e.substring(e.length-1)!==m.numberFormat.substring(m.numberFormat.length-1)&&(m.numberFormat=m.numberFormat.replace(v,e.substring(e.length-1)))}n.paragraphFormat.setList(f)}else!(0,a.le)(r)&&o?n.paragraphFormat.setList(r):n.paragraphFormat.setList(void 0)},s.prototype.addListLevels=function(e,t,i){for(var n=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],r=e.levels.length;r<9;r++){var o=new nt(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=n[r<5?r%5:r%5+1],o.characterFormat.fontFamily=r<3||5===r?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var l=0;l<r+1;l++)o.numberFormat+="%"+(l+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(r+1).toString()+")",o.listLevelPattern=r%3==0?"Number":r%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=r}o.paragraphFormat.leftIndent=0===r?36:36*r,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=r}},s.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.onEnter(!0),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.selection.checkForCursorVisibility()}},s.prototype.onEnter=function(e){var i,t=this.documentHelper.selection;if(((0,a.le)(t.start.paragraph.paragraphFormat.baseStyle)||"Normal"===t.start.paragraph.paragraphFormat.baseStyle.name)&&((i=new Rr(void 0)).cloneFormat(this.selection.characterFormat),t.start.paragraph.lastChild.children[t.start.paragraph.lastChild.children.length-1]instanceof Ee&&(i.baselineAlignment="Normal")),!this.isXmlMapped){if(t.isEmpty){var r=t.getHyperlinkField();if(!(0,a.le)(r))return void t.fireRequestNavigate(r);if((l=t.start.paragraph).isEmpty()&&-1!==l.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.documentHelper.getListById(l.paragraphFormat.listFormat.listId),l.paragraphFormat.listFormat.listLevelNumber-1)}var h=this.checkAndRemoveComments();this.initHistory("Enter");var d=!0;if(t.isEmpty||(d=this.removeSelectedContents(t)),d){t.owner.isShiftingEnabled=!0,this.updateInsertPosition();var c=this.selection.getParagraphInfo(t.start),u=this.selection.getHierarchicalIndex(c.paragraph,c.offset.toString());if(this.splitParagraphInternal(t,t.start.paragraph,t.start.currentWidget,t.start.offset),this.setPositionForCurrentIndex(t.start,u),e){var p=t.start.paragraph,f=new I;f.characterFormat.copyFormat(p.characterFormat),f.paragraphFormat.copyFormat(p.paragraphFormat);var g=new S;g.text="\f";var m=new oe(f);if(m.children.push(g),g.line=m,f.childWidgets.push(m),this.owner.enableTrackChanges&&p.characterFormat.revisions.length>0){var v=this.retrieveRevisionInOder(p.characterFormat);v.range.push(f.characterFormat),f.characterFormat.revisions.push(v),f.characterFormat.removedIds=[]}this.insertParagraph(f,!0),t.selectParagraphInternal(f,!0)}var y=t.start.paragraph.nextWidget;(0,a.le)(y)&&(y=t.getNextRenderedBlock(t.start.paragraph)),t.selectParagraphInternal(y,!0),this.updateEndPosition(),e&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(t);var l,b=this.selection.start.paragraph.containerWidget.firstChild;if(!(0,a.le)(b)){b.isChangeDetected=!1;for(var C=b.nextRenderedWidget;this.owner.isSpellCheck&&!(0,a.le)(C);)(b=C).isChangeDetected=!1,C=b.nextRenderedWidget}!(0,a.le)(l=t.start.paragraph.previousWidget)&&!l.isEmpty()&&l.lastChild.children[l.lastChild.children.length-1]instanceof S&&this.checkAndConvertToHyperlink(t,!0,l)}!(0,a.le)(i)&&!(0,a.le)(t.start.paragraph)&&t.start.paragraph.isEmpty()&&(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(i),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1,this.updateHistoryForComments(h)}},s.prototype.splitParagraphInternal=function(e,t,i,n){var r=0,o=t.index,l=t;for(l.isChangeDetected=0===n;this.owner.isSpellCheck&&!(0,a.le)(l.nextRenderedWidget);)(l=l.nextRenderedWidget).isChangeDetected=!0;var h=new I,d=new oe(h);if(h.childWidgets.push(d),h.paragraphFormat.ownerBase=h,i===t.lastChild&&n===e.getLineLength(i)){if(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof Xe?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat)):h.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat),this.owner.enableTrackChanges){var c=t.lastChild;if(!(0,a.le)(c)&&c.children.length>0){var u=c.children[c.children.length-1].previousValidNodeForTracking;!(0,a.le)(u)&&!this.checkParaMarkMatchedWithElement(u,t.characterFormat,!1,"Insertion")&&this.insertParaRevision(t)}}r++,o++}else{if(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat),n>0||!i.isFirstLine())t=t.combineWidget(this.owner.viewer),this.moveInlines(t,h,0,0,t.firstChild,n,i),this.owner.enableTrackChanges&&this.insertParaRevision(h,t.firstChild);else{var p=t.previousRenderedWidget,f=!1;if(!(0,a.le)(p)&&p instanceof I&&(f=p.characterFormat.revisions.length>0),this.owner.enableTrackChanges)if(f)this.checkToMatchEmptyParaMark(t,h)||this.insertParaRevision(t);else{var m=t.firstChild.children[0].previousValidNodeForTracking;(0,a.le)(m)||this.checkParaMarkMatchedWithElement(m,h.characterFormat,!0,"Insertion")?(0,a.le)(m)&&(r++,o++):this.insertParaRevision(h)}}t=t.getSplitWidgets()[0]}r+=t.getIndex();var v=t.containerWidget;if(v.childWidgets.splice(r,0,h),h.containerWidget=v,h.index=o,this.updateNextBlocksIndex(h,!0),!(0,a.le)(v.containerWidget)&&v.containerWidget instanceof Y||v instanceof V&&!(0,a.le)(v.bodyWidget)&&v.bodyWidget.containerWidget instanceof Y){var b=this.documentHelper.textHelper.getParagraphMarkSize(h.characterFormat).Height;v instanceof V?(v.bodyWidget.height+=b,v.bodyWidget.containerWidget.height+=b):(v.containerWidget.height+=b,v.height+=b)}this.owner.enableTrackChanges&&0===h.characterFormat.revisions.length&&0===t.characterFormat.revisions.length&&(this.checkToMatchEmptyParaMark(t)||this.insertParaRevision(t)),this.documentHelper.layout.layoutBodyWidgetCollection(o,v,h,!1)},s.prototype.insertParaRevision=function(e,t){if(this.owner.enableTrackChanges&&(0,a.le)(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),!(0,a.le)(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(e.characterFormat,"Insertion");this.applyRevisionForParaMark(e,t,"Insertion",!0)}},s.prototype.applyRevisionForParaMark=function(e,t,i,n){var r=t.children[0];if(!(0,a.le)(r)){r=r.nextValidNodeForTracking;var o=e.lastChild,l=0===o.children.length?void 0:o.children[o.children.length-1].previousValidNodeForTracking,h=!1,d=e.characterFormat.revisions.length;if((0,a.le)(l)||(h=this.checkParaMarkMatchedWithElement(l,e.characterFormat,!1,i)),!(0,a.le)(r))if(e.characterFormat.revisions.length>d){if(this.isRevisionMatched(r,i))for(var c=e.characterFormat.revisions[0],u=this.getMatchedRevisionsToCombine(r.revisions,i),p=0;p<u.length;p++)u[p]!==c&&(h=!0,this.clearAndUpdateRevisons(u[p].range,c,c.range.indexOf(e.characterFormat)+1))}else h=this.checkParaMarkMatchedWithElement(r,e.characterFormat,!0,i);!h&&(this.owner.enableTrackChanges||t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(e.characterFormat,i),n&&l.revisions.length>0&&r.revisions.length>0&&this.updateRevisionForSpittedTextElement(l,r))}},s.prototype.checkParaMarkMatchedWithElement=function(e,t,i,n){var r=this.getMatchedRevisionsToCombine(e.revisions,n);return r.length>0&&(this.mapMatchedRevisions(r,e,t,i),!0)},s.prototype.checkToMatchEmptyParaMark=function(e,t){var i=e.previousRenderedWidget;if(!(0,a.le)(i)&&i instanceof I&&i.characterFormat.revisions.length>0){var n=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Insertion");if(n.length>0)return(0,a.le)(t)?this.mapMatchedRevisions(n,i.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(n,i.characterFormat,t.characterFormat,!1),!0}return!1},s.prototype.checkToMatchEmptyParaMarkBack=function(e){var t=e.nextRenderedWidget,i=t.childWidgets[0],n=i.children[0];if(!(0,a.le)(t)&&t instanceof I&&t.characterFormat.revisions.length>0){if((r=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Deletion")).length>0)return null!=t&&null!=i&&null!=n&&1==n.revisions.length?(this.mapMatchedRevisions(r,n,e.characterFormat,!0),!0):(this.mapMatchedRevisions(r,t.characterFormat,e.characterFormat,!0),!0)}else if(null!=n&&1==n.revisions.length){var r;if((r=this.getMatchedRevisionsToCombine(n.revisions,"Deletion")).length>0)return this.mapMatchedRevisions(r,n,e.characterFormat,!0),!0}return!1},s.prototype.updateNextBlocksIndex=function(e,t){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof j&&(0,a.le)(e.containerWidget.containerWidget)||e.containerWidget instanceof j&&!(0,a.le)(e.containerWidget.containerWidget)&&!(e.containerWidget.containerWidget instanceof Y))for(var n=e.containerWidget.index,r=this.documentHelper.pages.indexOf(e.containerWidget.page);r<this.documentHelper.pages.length;r++){var o=this.documentHelper.pages[r];if(o.bodyWidgets[0].index!==n)return;for(var l=i;l<o.bodyWidgets[0].childWidgets.length;l++)this.updateIndex(o.bodyWidgets[0].childWidgets[l],t);i=0}else if(e.containerWidget instanceof V)for(var d=e.containerWidget.getSplitWidgets(),c=d.indexOf(e.containerWidget),u=c;u<d.length;u++){for(var p=d[u].childWidgets,f=i;f<p.length;f++)this.updateIndex(p[f],t);c=0,i=0}else if(e.containerWidget instanceof Q)for(var g=i;g<e.containerWidget.childWidgets.length;g++)(m=e.containerWidget.childWidgets[g]).rowIndex===e.containerWidget.index&&this.updateIndex(m,t);else if(e.containerWidget instanceof k)for(g=i;g<e.containerWidget.childWidgets.length;g++){var v=e.containerWidget.childWidgets[g];for(this.updateIndex(v,t),r=0;r<v.childWidgets.length;r++){var m;(m=v.childWidgets[r]).rowIndex=v.index,m.index=r}}else if(e.containerWidget instanceof Ce||e.containerWidget instanceof be)for(g=i;g<e.containerWidget.childWidgets.length;g++)this.updateIndex(e.containerWidget.childWidgets[g],t);else if(!(0,a.le)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof Y)for(g=i;g<e.containerWidget.childWidgets.length;g++)this.updateIndex(e.containerWidget.childWidgets[g],t)},s.prototype.updateIndex=function(e,t){t?e.index++:e.index--},s.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},s.prototype.checkAndRemoveComments=function(){var e=this.selection;if(e.isEmpty||this.owner.enableTrackChanges)return[];var t=!1,i=this.getSelectedComments();if(i.commentEndInfo.length>0||i.commentStartInfo.length>0){t||(t=!0,this.initComplexHistory("RemoveComment"));var n=this.selection.start,r=this.selection.end;this.selection.isForward||(n=this.selection.end,r=this.selection.start);for(var o=this.selection.getParagraphInfo(n),l=this.selection.getParagraphInfo(r),h=0;h<i.commentEndInfo.length;h++){var d=i.commentEndInfo[h].comment,c=d.commentStart,u=d.commentEnd,p=this.selection.getParagraphInfoInternal(c.line,c.line.getOffset(c,0)),f=this.selection.getParagraphInfoInternal(u.line,u.line.getOffset(u,0));if(l.paragraph===f.paragraph){if(d.replyComments.length>0)for(var g=0;g<d.replyComments.length;g++)(0,a.le)((m=d.replyComments[g]).commentEnd)||l.offset--;l.offset--}if(o.paragraph===p.paragraph){var v=p.offset<o.offset;if(d.replyComments.length>0)for(g=0;g<d.replyComments.length;g++){var m;(0,a.le)((m=d.replyComments[g]).commentStart)||(this.selection.getParagraphInfoInternal(m.commentStart.line,m.commentStart.line.getOffset(m.commentStart,0)).offset<o.offset&&o.offset--,l.paragraph===p.paragraph&&l.offset--)}v&&o.offset--,l.paragraph===p.paragraph&&l.offset--}this.deleteCommentInternal(d)}if(i.commentStartInfo.length>0)for(var b=0;b<i.commentStartInfo.length;b++)i.commentStartInfo[b].line.paragraph.equals(l.paragraph)&&l.offset--,this.removeInline(i.commentStartInfo[b]);var C=e.getLineInfoBasedOnParagraph(o.paragraph,o.offset);e.start.setPositionFromLine(C.line,C.offset);var F=e.getLineInfoBasedOnParagraph(l.paragraph,l.offset);e.end.setPositionFromLine(F.line,F.offset)}return i.commentStartInfo},s.prototype.updateHistoryForComments=function(e){if(this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){if(!(0,a.le)(e))for(var t=0;t<e.length;t++)this.initInsertInline(e[t],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}},s.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,e.isEmpty)this.singleBackspace(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("BackSpace");var i=this.deleteSelectedContents(e,!0);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.insertSpaceInFormField())),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)){for(var n=0;n<t.length;n++)this.initInsertInline(t[n],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}this.documentHelper.triggerSpellCheck=!1}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},s.prototype.insertRemoveBookMarkElements=function(){for(var e=!1,t=0;t<this.removedBookmarkElements.length;t++){var i=this.removedBookmarkElements[t];if(0===i.bookmarkType){this.documentHelper.bookmarks.containsKey(i.name)||this.documentHelper.bookmarks.add(i.name,i);var n=i;if(n&&n.reference&&-1!==this.removedBookmarkElements.indexOf(n.reference)){var r=this.removedBookmarkElements.indexOf(n.reference),o=this.removedBookmarkElements.indexOf(n);this.removedBookmarkElements.splice(r,1),this.removedBookmarkElements.splice(o,1),t--}else this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone()),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),e=!0)}else{var l=i;l&&l.reference&&-1!==this.removedBookmarkElements.indexOf(l.reference)?(r=this.removedBookmarkElements.indexOf(l.reference),o=this.removedBookmarkElements.indexOf(l),this.removedBookmarkElements.splice(r,1),this.removedBookmarkElements.splice(o,1),t--):(this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(l.clone()),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),e=!0))}}return this.removedBookmarkElements=[],e},s.prototype.deleteSelectedContents=function(e,t){var i=this.deleteSelectedContentInternal(e,t,e.start,e.end),n=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(n,!0),i},s.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},s.prototype.getSelectedComments=function(){for(var e=this.documentHelper.comments,t=[],i=[],n=0;n<e.length;n++){var r=e[n],o=r.commentEnd,l=r.commentStart;if(!(0,a.le)(o)&&this.selection.isElementInSelection(o,!1))t.push(o);else if(!(0,a.le)(l)&&this.selection.isElementInSelection(l,!0)){i.push(l);for(var h=0;h<r.replyComments.length;h++)r.replyComments[h].commentStart&&i.push(r.replyComments[h].commentStart)}}return{commentStartInfo:i,commentEndInfo:t}},s.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var n=i.undoStack[i.undoStack.length-1],r=this.selection.getParagraphInfo(e.start),o=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===n.action&&n.insertPosition===this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())&&n.endPosition===this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}for(var l=!1,h=e.start.paragraph,c=e.start.offset,u=0,p=e.start.currentWidget.getInline(c,u),f=p.element,g=!1,m=c,v=!1;f instanceof ae;){var y=f;if((f=f.previousNode)&&(m=f.length),!(0!==y.commentType||!(0,a.le)(f)&&f instanceof ae)){(0,a.le)(f)?(f=y,m=0):m=f.length,v=!0;break}1===y.commentType&&(g||(this.initComplexHistory("RemoveComment"),g=!0),this.deleteCommentInternal(y.comment),v=!0)}if(v&&((0,a.le)(f)?(e.start.setPositionParagraph(b=h.childWidgets[0],0),e.end.setPositionParagraph(b,0)):(h=f.line.paragraph,c=f.line.getOffset(f,m),e.start.setPositionParagraph(f.line,c),e.end.setPositionParagraph(f.line,c))),this.selection.isInlineFormFillMode()){if(f instanceof H&&2===f.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}if(u=p.index,f instanceof S&&(f.ignoreOnceItems=[]),f instanceof S&&(f.ignoreOnceItems=[]),f instanceof H&&2===f.fieldType&&w.isLinkedFieldCharacter(f)){var T=f.fieldEnd;return(F=f.fieldBegin).nextNode instanceof O&&(T=F.nextNode.reference),e.start.setPositionParagraph(F.line,F.line.getOffset(F,0)),e.end.setPositionParagraph(T.line,T.line.getOffset(T,0)+1),void e.fireSelectionChanged(!0)}if(f instanceof Ee&&("Footnote"===f.footnoteType?this.removeFootnote(f):this.removeEndnote(f)),f&&(f instanceof $||f.previousNode instanceof $)&&(f instanceof $&&f.previousNode&&!(f.previousElement instanceof _)&&(h=(f=f.previousNode).line.paragraph,c=f.line.getOffset(f,f.length)),f&&1===f.length&&f.nextNode instanceof $&&f.previousNode instanceof $)&&(T=f.nextNode,!(x=f.previousNode).contentControlProperties.lockContentControl))return e.start.setPositionParagraph(x.line,x.line.getOffset(x,0)),e.end.setPositionParagraph(T.line,T.line.getOffset(T,0)+1),void this.removeWholeElement(e);if(f&&(f instanceof O||f.previousNode instanceof O)){if(f instanceof O&&1===f.bookmarkType){if(f.previousNode)h=(f=f.previousNode).line.paragraph,c=f.line.getOffset(f,f.length);else if(h.previousRenderedWidget instanceof I){var E=h.previousRenderedWidget.lastChild;return e.start.setPositionParagraph(f.line,f.line.getOffset(f,0)),e.end.setPositionParagraph(E,E.getEndOffset()),void this.removeWholeElement(e)}}else if(f.nextNode instanceof O&&f instanceof O&&0===f.bookmarkType&&f.reference===f.nextNode)return void this.deleteBookmark(f.name);var F;if(1===f.length&&f.nextNode instanceof O&&f.previousNode instanceof O)return T=f.nextNode,e.start.setPositionParagraph((F=f.previousNode).line,F.line.getOffset(F,0)),e.end.setPositionParagraph(T.line,T.line.getOffset(T,0)+1),void this.removeWholeElement(e)}if(f instanceof H&&1===f.fieldType&&!this.selection.isInlineFormFillMode()){var L=e.getPreviousValidElement(f);if(L instanceof H)return h=(f=L.fieldBegin).line.paragraph,c=f.line.getOffset(f,0),f.nextNode instanceof O&&e.start.setPositionParagraph((x=f.nextNode.reference).line,x.line.getOffset(x,0)),e.end.setPositionParagraph(f.line,c),void e.fireSelectionChanged(!0);L!==f&&(h=(f=L).line.paragraph,c=f.line.getOffset(f,f.length))}if(f instanceof xe||f instanceof He){if(f.nextNode instanceof He&&f.editRangeEnd===f.nextNode||f.previousNode instanceof xe&&f.editRangeStart===f.previousNode||f instanceof xe&&!(f.previousNode instanceof He))return;var x;if(f instanceof He&&((0,a.le)(f.previousNode)||(h=(f=f.previousNode).line.paragraph,c=f.line.getOffset(f,f.length))),1===f.length&&f.nextNode instanceof He&&f.previousNode instanceof xe)return T=f.nextNode,e.start.setPositionParagraph((x=f.previousNode).line,x.line.getOffset(x,0)),e.end.setPositionParagraph(T.line,T.line.getOffset(T,0)+1),void this.removeWholeElement(e)}if(t||this.initHistory("BackSpace"),c===e.getStartOffset(h)&&e.start.currentWidget.isFirstLine()){if(h.paragraphFormat.listFormat&&-1!==h.paragraphFormat.listFormat.listId)return void this.onApplyList(void 0);if(0!==h.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==h.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!h.paragraphFormat.bidi&&"Left"!==h.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(h.previousRenderedWidget instanceof I){e.owner.isShiftingEnabled=!0;var W=h.previousRenderedWidget;if(this.owner.enableTrackChanges&&null!=h.previousRenderedWidget&&0==h.previousRenderedWidget.characterFormat.revisions.length)if(this.checkToMatchEmptyParaMarkBack(W)){var R=this.documentHelper.selection.getLineLength(W.lastChild);this.documentHelper.layout.reLayoutParagraph(W,N=W.childWidgets.length-1,0),e.selects(W.childWidgets[N],R,!0),this.addRemovedNodes(h)}else this.insertRevision(W.characterFormat,"Deletion"),R=this.documentHelper.selection.getLineLength(W.lastChild),this.documentHelper.layout.reLayoutParagraph(W,N=W.childWidgets.length-1,0),e.selects(W.childWidgets[N],R,!0),this.addRemovedNodes(h);else if(W.isEmpty()&&!this.owner.enableTrackChanges)this.removePrevParaMarkRevision(h),this.removeBlock(W),this.addRemovedNodes(W);else if(this.owner.enableTrackChanges&&null!=W.characterFormat.revisions&&"Deletion"==W.characterFormat.revisions[0].revisionType)R=this.documentHelper.selection.getLineLength(W.lastChild),this.documentHelper.layout.reLayoutParagraph(W,N=W.childWidgets.length-1,0),e.selects(W.childWidgets[N],R,!0),this.addRemovedNodes(h);else{this.removePrevParaMarkRevision(h),this.removeBlock(h,!1,!0),R=this.documentHelper.selection.getLineLength(W.lastChild);var N=W.childWidgets.length-1,b=void 0;if(!h.isEmpty())for(var B=0;B<h.childWidgets.length;B++){W.childWidgets.push(b=h.childWidgets[B]);for(var q=0;q<b.children.length;q++)if(b.children[q]instanceof Ee&&-1===this.documentHelper.footnoteCollection.indexOf(b.children[q])){b.children[q].isLayout=!1;var X=parseInt(b.children[q].text);this.documentHelper.footnoteCollection.splice(X-1,0,b.children[q])}h.childWidgets.splice(B,1),B--,b.paragraph=W}this.documentHelper.layout.reLayoutParagraph(W,N,0),e.selects(W.childWidgets[N],R,!0),this.addRemovedNodes(h)}this.setPositionForHistory(),this.documentHelper.layout.getFootNoteWidgetsOf(h).length>0&&this.documentHelper.layout.layoutfootNote(h.bodyWidget.page.footnoteWidget),this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var ge=this.selection.getParagraphInfo(e.start),te=(b=e.start.currentWidget,c-1);te<0&&(te=this.documentHelper.selection.getLineLength(b=b.previousLine)+te),this.removeAtOffset(b,e,te),this.setPositionParagraph(ge.paragraph,ge.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():(this.reLayout(e),l&&(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-2].modifiedActions.push(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-1]),this.owner.editorHistory.undoStack.splice(this.owner.editorHistory.undoStack.length-1,1),l=!1))}g&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory())},s.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&((0,a.le)(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},s.prototype.removeAtOffset=function(e,t,i){for(var n=0,r=e.paragraph.childWidgets.indexOf(e),o=e.children.length,l=0;l<o;l++){var h=e.children[l];if(!(h instanceof _)){if(this.removeCharacter(h,i,n,e,r,l))break;n+=h.length}}},s.prototype.removeCharacter=function(e,t,i,n,r,o,l){var h=!1;if(e instanceof O&&e.line!==e.reference.line&&!(n.children[o]instanceof O))return(0,a.le)(e.line.previousLine)?(0,a.le)(e.line.paragraph.previousRenderedWidget)?(0,a.le)(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),n.children.splice(o,1),!0;if(t<i+e.length){var d=t-i;if(e.ischangeDetected=!0,this.owner.isSpellCheck&&this.owner.spellChecker.removeErrorsFromCollection({element:e,text:e.text}),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1),t===i&&1===e.length)this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,d,1,o)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),n.children.splice(o,1)),this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,l);else{var c=this.handleDeleteTracking(e,d,1);this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,l),(0,a.le)(c)||(e.revisions.length>0&&this.addRemovedRevisionInfo(e,c),this.addRemovedNodes(c))}h=!0}return h},s.prototype.removeCharacterInLine=function(e,t,i){var n=new S;if(e instanceof S){n.characterFormat.copyFormat(e.characterFormat);var r=1===i?1:i-t;n.text=e.text.substr(t,r);var o=e.text;e.text=o.substring(0,t)+o.substring(t+r,o.length),e.contentControlProperties&&(n.contentControlProperties=e.contentControlProperties.clone())}return n},s.prototype.removeRevisionsInformation=function(e,t,i,n){var r=e.previousElement;"Insertion"===this.retrieveRevisionInOder(r).revisionType&&this.isRevisionMatched(r,void 0)&&e.line.children.splice(n,1)},s.prototype.handleDeleteTracking=function(e,t,i,n,r,o){var l=this.owner.enableTrackChanges,d=void(0,a.le)(this.editorHistory);if(this.canHandleDeletion()||l&&!this.skipTracking()){if(e instanceof O||e instanceof ae||e instanceof xe||e instanceof He)return void(e instanceof O&&e.previousElement instanceof H&&e.previousElement.formFieldData?e.previousElement.revisions.length>0&&this.removeRevisionsInformation(e,t,i,n):l&&e instanceof O?(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)):e.line.children.splice(e.indexInOwner,1));var c=!1;if(this.owner.editorHistory&&(c=!(0,a.le)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),e.revisions.length>0){var u=this.retrieveRevisionInOder(e),p=this.owner.revisions.changes.indexOf(u);if("Insertion"===u.revisionType)if(this.isRevisionMatched(e,void 0))if((0,a.le)(n))d=this.removeCharacterInLine(e,t,i);else{var f=u.range.indexOf(e);u.range.splice(f,1),0===u.range.length&&this.owner.revisionsInternal.remove(u),this.unLinkFieldCharacter(e),e.line.children.splice(n,1)}else if((0,a.le)(n)){var g=this.removeCharacterInLine(e,t,i);if(0===t)this.handleDeletionForInsertRevision(e.previousElement,e,g,i,t,!0);else if(e.length!==t)for(var v=e.revisions.length-1;v>=0;v--){var y=e.revisions[v],b=y.range.indexOf(e),C=new S;C.characterFormat.copyFormat(e.characterFormat),C.line=e.line,C.text=e.text.substr(t),C.revisions.splice(0,0,y),y.range.splice(b+1,0,C),g.revisions.splice(0,0,y),g.line=e.line,y.range.splice(b+1,0,g),e.text=e.text.substr(0,t);var F=e.indexInOwner;e.line.children.splice(F+1,0,C),e.line.children.splice(F+1,0,g),this.addRemovedNodes(g.clone()),this.insertRevision(g,"Deletion"),this.updateLastElementRevision(g)}else e.length===t?this.handleDeletionForInsertRevision(e.nextElement,e,g,i,t,!1):(1===i?c||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),this.addRemovedNodes(g.clone()),this.insertInlineInternal(g,"Deletion"))}else this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else if("Deletion"===u.revisionType){if(-1!==p&&u.author!==this.owner.currentUser){var x=u.range,P=x[0].line.getOffset(x[0],0),E=x[x.length-1],L=E.line.getOffset(E,E.length);P===t&&L===i&&(e.revisions.splice(e.revisions.indexOf(u),1),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)),e.line.getOffset(e,0)===P&&this.owner.revisions.changes.splice(p,1))}if(1===i)c?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start));else if(this.isRevisionMatched(e,"Deletion"))this.updateCursorForInsertRevision(e,t,i);else{var W=u.range.indexOf(e);(L=e.line.getOffset(e,e.length))>=i&&u.range.length>W+1?(this.updateRevisionForSpittedTextElement(e,u.range[W+1]),u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion")):1===u.range.length||0===t?(this.handleDeleteBySplitting(e,t,i),-1!==W&&1!==u.range.length&&(this.updateRevisionForSpittedTextElement(u.range[W-1],u.range[W]),u.range.splice(u.range.indexOf(e),1))):(u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))}this.updateLastElementRevision(e)}}else(0,a.le)(n)?this.handleDeleteBySplitting(e,t,i):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e))}else d=this.removeCharacterInLine(e,t,i);return d},s.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},s.prototype.updateLastElementRevision=function(e){this.skipTableElements||this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&!this.skipReplace&&((0,a.le)(this.owner.search)||!this.owner.search.isRepalceTracking)&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e,e.isMarkedForRevision=!0)},s.prototype.updateEndRevisionIndex=function(){if(!(0,a.le)(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0){var e=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1];e.lastElementRevision&&(0,a.le)(e.endRevisionLogicalIndex)&&e.updateEndRevisionInfo()}},s.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},s.prototype.handleDeletionForInsertRevision=function(e,t,i,n,r,o){if(!(0,a.le)(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion"))this.addRemovedNodes(i.clone()),this.insertTextInline(e,this.selection,i.text,0);else{var l=t.revisions[t.revisions.length-1],h=l.range.indexOf(t);l.range.splice(o?h:h+1,0,i),i.revisions.splice(0,0,l);var d=!1;this.owner.editorHistory&&(d=!(0,a.le)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1!==n||d?this.updateCursorForInsertRevision(t,r,n):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion")}},s.prototype.handleDeleteBySplitting=function(e,t,i){var n=!1;if(this.owner.editorHistory&&(n=!(0,a.le)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1===i){var r=e.line.getOffset(e,0);if(r>0){var o=new Z(this.owner);o.setPositionForLineWidget(e.line,r+t),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(this.selection.start)}else n||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))}else this.updateCursorForInsertRevision(e,t,i);var l=this.removeCharacterInLine(e,t,i);this.addRemovedNodes(l.clone()),this.insertTextInternal(l.text,!1,"Deletion")},s.prototype.updateCursorForInsertRevision=function(e,t,i){var n=e.line.getOffset(e,0);n>0&&(t=n+t,i=n+i);var r=new Z(this.owner);r.setPositionFromLine(e.line,t);var o=new Z(this.owner);o.setPositionFromLine(e.line,i),r.isExistBefore(o)?(this.selection.end.setPositionInternal(r),this.selection.start.setPositionInternal(r)):(this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(o))},s.prototype.checkToCombineRevisionsInSides=function(e,t){var o,i=e.previousNode,n=e.nextNode,r=!1;return(0,a.le)(i)||(i instanceof O||(i=i.previousValidNodeForTracking),(0,a.le)(i))||(o=this.getMatchedRevisionsToCombine(i.revisions,t)).length>0&&(this.mapMatchedRevisions(o,i,e,!1),r=!0),(0,a.le)(n)||(n instanceof O||(n=n.nextValidNodeForTracking),(0,a.le)(n))||(o=this.getMatchedRevisionsToCombine(n.revisions,t)).length>0&&(r?this.combineElementRevision(e.revisions,n.revisions):this.mapMatchedRevisions(o,n,e,!0),r=!0),r},s.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(e.isEmpty)this.singleDelete(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var i=new Z(e.owner);if(this.setPositionForCurrentIndex(i,e.editPosition),e.selectContent(i,!0),this.reLayout(e),this.insertSpaceInFormField(),this.editorHistory&&!(0,a.le)(this.editorHistory.currentHistoryInfo)){for(var n=0;n<t.length;n++)this.initInsertInline(t[n],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},s.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Z(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},s.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},s.prototype.singleDelete=function(e,t){var n=e.start.paragraph,r=e.start.offset,o=0,l=e.start.currentWidget.getInline(e.start.offset,o),h=l.element;if(this.selection.isInlineFormFillMode()){if(h instanceof H&&1===h.fieldType)return;var d=this.getFieldResultText();if(h instanceof S||(h=h.nextElement),1===d.length&&h instanceof S)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(h instanceof H&&1===h.fieldType)return}if(o=l.index,n.paragraphFormat.listFormat&&-1!==n.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)this.onApplyList(void 0);else{if(!(0,a.le)(h)&&o===h.length&&!(0,a.le)(h.nextNode)){if((h=h.nextNode)instanceof H&&1===h.fieldType&&!(0,a.le)(h.fieldBegin.formFieldData)||h instanceof Ee)return;o=0}for(var c=h instanceof ae;h instanceof ae;){if(!h.nextNode){o=1;break}h=h.nextNode,o=0}if(c&&(n=h.line.paragraph,r=h.line.getOffset(h,o),e.start.setPositionParagraph(h.line,r),e.end.setPositionParagraph(h.line,r)),h instanceof Ee&&("Footnote"===h.footnoteType?this.removeFootnote(h):this.removeEndnote(h)),!(0,a.le)(h)){var u=void 0,p=e.getNextValidElement(h);if(p instanceof fe&&(u=p),!(0,a.le)(u)&&u instanceof H&&0===u.fieldType)return n=(h=u.fieldEnd).line.paragraph,r=h.line.getOffset(h,1),e.end.setPositionParagraph(h.line,r),void e.fireSelectionChanged(!0);h!==u&&(n=(h=u).line.paragraph,r=h.line.getOffset(h,0),h instanceof H&&1===h.fieldType&&r++)}if(h instanceof xe||h instanceof He){if(h.nextNode instanceof He&&h.editRangeEnd===h.nextNode||h.previousNode instanceof xe&&h.editRangeStart===h.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(h instanceof xe||h instanceof He)return}else h instanceof xe?(r=(h=h.nextNode).line.getOffset(h,0),n=h.line.paragraph):h instanceof He&&r++;if(1===h.length&&h.nextNode instanceof He&&h.previousNode instanceof xe){var f=h.previousNode,g=h.nextNode;return e.start.setPositionParagraph(f.line,f.line.getOffset(f,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void this.deleteEditElement(e)}}if(h&&(h instanceof $||h.nextNode instanceof $)){if(h instanceof $&&h.nextNode)return n=(h=h.nextNode).line.paragraph,r=h.line.getOffset(h,0),e.start.setPositionParagraph(h.line,r),void e.end.setPositionParagraph(h.line,r);if(h&&1===h.length&&h.nextNode instanceof $&&h.previousNode instanceof $&&this.removeContentControlMark(h.previousNode,h.nextNode)||h instanceof $&&h.previousNode instanceof $&&h.previousNode.reference===h&&this.removeContentControlMark(h.previousNode,h))return}if(h&&(h instanceof O&&0===h.bookmarkType||h.nextNode instanceof O)){if(h.nextNode&&h instanceof O&&(n=(h=h.nextNode).line.paragraph,r=h.line.getOffset(h,0)),1===h.length&&h.nextNode instanceof O&&h.previousNode instanceof O){var m=h.previousNode,v=h.nextNode;return e.start.setPositionParagraph(m.line,m.line.getOffset(m,0)),e.end.setPositionParagraph(v.line,v.line.getOffset(v,0)+1),void this.deleteEditElement(e)}h instanceof O&&(r=h.line.getOffset(h,1))}if(e.start.currentWidget.isLastLine()&&r===this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(n.isInsideTable&&(0,a.le)(n.nextWidget))return;var y=void 0,b=void 0,C=e.getNextParagraphBlock(n);if((0,a.le)(C)){if(r>0)return;if(n.previousWidget instanceof I&&(y=n.previousWidget),n.previousWidget instanceof Y||n.previousWidget instanceof k||(0,a.le)(y))return}if(t||this.initHistory("Delete"),n.isEndsWithPageBreak){var F=n.lastChild;this.selection.start.setPositionForSelection(F,F.children[F.children.length-1],0,this.selection.start.location)}var x=this.selection.getParagraphInfo(e.start);if(e.editPosition=this.selection.getHierarchicalIndex(x.paragraph,x.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,n.isEmpty())if(this.removePrevParaMarkRevision(n,!0),this.removeBlock(n,!1,!0),this.addRemovedNodes(n),(0,a.le)(C))if((0,a.le)(y)){var P=e.getParagraphLength(b)+1;this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(b,P.toString()))}else e.selectParagraphInternal(y,!1),this.setPositionForHistory();else e.selectParagraphInternal(C,!0);else if(this.owner.enableTrackChanges&&n.nextRenderedWidget instanceof I){var E=n.nextRenderedWidget,W=E.childWidgets.length-1;n=n.combineWidget(this.owner.viewer);var R=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0);null!=n&&0!=n.characterFormat.revisions.length&&"Insertion"==n.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(R,e,0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(R,e,0,!0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(E.childWidgets[W],0,!0))}else n=n.combineWidget(this.owner.viewer),R=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0),this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(R,e,0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0);this.reLayout(e)}else this.singleDeleteInternal(e,t,n)}},s.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var n=this.selection.getParagraphInfo(e.start),r=e.start.currentWidget,o=e.start.offset,l=e.getLineLength(e.start.currentWidget);o>=l&&(r=r.nextLine,o-=l),this.removeAtOffset(r,e,o),this.owner.enableTrackChanges&&!(0,a.le)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&l!==e.getLineLength(e.start.currentWidget)?this.setPositionParagraph(n.paragraph,n.offset,!1):this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(n.paragraph,n.offset+1,!1):this.setPositionParagraph(n.paragraph,n.offset,!1),t?this.fireContentChange():this.reLayout(e)},s.prototype.deleteParagraphMark=function(e,t,i,n,r){if(!(0,a.le)(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var o=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&(0,a.le)(e.nextWidget)||(0,a.le)(o))){var h=void 0;if(h=t.getNextRenderedBlock(e)instanceof k?t.getNextRenderedBlock(e):void 0,o.isInsideTable&&!(0,a.le)(h)&&h.contains(o.associatedCell)){if(i<4){var d=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(o),this.documentHelper.layout.clearListElementBox(e);for(var c=e.childWidgets.length-1;c>=0;c--)for(var u=e.childWidgets[c],p=u.children.length-1;p>=0;p--){var f=u.children[p];d+=f.length,o.firstChild.children.unshift(f),f.line=o.firstChild}this.documentHelper.layout.reLayoutParagraph(o,0,0),d>0&&(t.editPosition=this.selection.getHierarchicalIndex(o,d.toString()))}}else if(i<4){var m=o.getSplitWidgets();if(o=o.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(o),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,o),(0,a.le)(n)||!n||this.handleDeleteParaMark(e,m[0])){for(c=0;c<o.childWidgets.length;c++){var C=o.childWidgets[c];if(o.characterFormat.revisions.length>0)for(var F=0;F<o.characterFormat.revisions.length;F++){for(p=0;p<o.characterFormat.revisions[F].range.length;p++)o.characterFormat.revisions[F].range[p].ownerBase=e;e.characterFormat.revisions.push(o.characterFormat.revisions[F])}o.childWidgets.splice(c,1),e.childWidgets.push(C),C.paragraph=e,c--}0===o.childWidgets.length&&o.childWidgets.push(new oe(o)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(o),"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&this.addRemovedNodes(o,r)}}}}},s.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&e.characterFormat.revisions.length>0)for(var i=0;i<e.characterFormat.revisions.length;i++){var n=e.characterFormat.revisions[i],r=n.range.indexOf(e.characterFormat);return n.range.splice(r,1),0===n.range.length&&this.owner.revisions.remove(n),!0}if(this.owner.enableTrackChanges){var o=!1;if(e.characterFormat.revisions.length>0){var l=this.retrieveRevisionByType(e.characterFormat,"Deletion");if(!(0,a.le)(l)&&this.isRevisionMatched(l,"Deletion")){var h=e.characterFormat.revisions.indexOf(l);e.characterFormat.revisions.splice(h,1),l.range.splice(l.range.indexOf(e.characterFormat),1),0===l.range.length&&this.owner.revisions.remove(l),o=!0}var d=this.retrieveRevisionByType(e.characterFormat,"Insertion");return!(0,a.le)(d)&&this.isRevisionMatched(e.characterFormat,"Insertion")&&(r=d.range.indexOf(e.characterFormat),d.range.splice(r,1),0===d.range.length&&this.owner.revisions.remove(d),o=!0),!!o||(this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1)}return this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1}return!0},s.prototype.insertDeleteParaMarkRevision=function(e,t){var i=e.lastChild,n=i.children.length>0?i.children[i.children.length-1].previousValidNodeForTracking:void 0;if(!(0,a.le)(n)){var r=this.getMatchedRevisionsToCombine(n.revisions,"Deletion");r.length>0&&this.mapMatchedRevisions(r,n,e.characterFormat,!1)}},s.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},s.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){var r=e.childWidgets[t].children[i],o=r.nextNode;r=r.nextValidNodeForTracking,(o=o.nextValidNodeForTracking).revisions.length>0&&r.revisions.length>0&&this.combineElementRevisions(r,o)},s.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},s.prototype.checkEndPosition=function(e){return this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo.endPosition)},s.prototype.checkInsertPosition=function(e){return this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo.insertPosition)},s.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},s.prototype.deleteSelectedContentInternal=function(e,t,i,n){var r=i,o=n;i.isExistBefore(n)||(r=n,o=i);var l=this.selection.getParagraphInfo(r);e.editPosition=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());var h=!1;return t&&r.isInSameParagraph(o)&&(r.offset<o.offset&&r.offset===e.getParagraphLength(o.paragraph)&&(h=e.getNextRenderedBlock(r.paragraph)instanceof k),1===o.offset&&o.offset>e.getParagraphLength(o.paragraph)&&(!o.paragraph.isInsideTable||!(0,a.le)(o.paragraph.nextWidget))&&(t=!1)),h||(e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition),this.deleteSelectedContent(o.paragraph,e,r,o,t?1:0)),h},s.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},s.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},s.prototype.insertPicture=function(e,t,i,n){var r=new ee(!0);".svg"===w.formatClippedString(e).extension?(r.metaFileImageString=e,r.isMetaFile=!0,this.generateFallBackImage(e,t,i,r)):(r.imageString=e,r.element.crossOrigin="Anonymous"),r.width=t,r.height=i,r.textWrappingStyle="Inline",this.insertPictureInternal(r,n)},s.prototype.generateFallBackImage=function(e,t,i,n){var r=new Image;r.onload=function(){var o=Math.max(1,window.devicePixelRatio||1),l=document.createElement("canvas");l.width=t*o,l.height=i*o;var h=l.getContext("2d");h.scale(o,o),h.drawImage(r,0,0,t,i),n.imageString=l.toDataURL("image/png",1)},r.src=e},s.prototype.insertPictureInternal=function(e,t){var i=this.documentHelper.selection,n=this.checkAndRemoveComments();this.initHistory("InsertInline"),t&&this.fitImageToPage(i,e),this.insertInlineInSelection(i,e),this.reLayout(i),this.updateHistoryForComments(n)},s.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,n=i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin,r=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin;t.width>n&&(t.height=t.height*n/t.width,t.width=n),t.height>r&&(t.width=t.width*r/t.height,t.height=r)},s.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertInlineInternal(t),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},s.prototype.onPortrait=function(){var e=new je,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},s.prototype.onLandscape=function(){var e=new je,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},s.prototype.copyValues=function(){var e=new je;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},s.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},s.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,n=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<n?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<n?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<n?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<n?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<n?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<n?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<n?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<n?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<n?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<n?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},s.prototype.updateListItemsTillEnd=function(e,t){for(var i=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!(0,a.le)(i)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(i),i=i.getSplitWidgets().pop().nextRenderedWidget},s.prototype.updateWholeListItems=function(e,t,i){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];for(var r,n=e.bodyWidget.index,o=0;o<this.documentHelper.pages.length;o++){var l=this.documentHelper.pages[o];if(l.bodyWidgets[0].index===n&&(r=this.getNextBlockForList(l.bodyWidgets[0].firstChild),!(0,a.le)(r)))break}do{var d=null;if(t&&(d={paragraph:null,listId:i}),this.updateListItems(r,e,d)){if(!(0,a.le)(d))return d.paragraph==e?null:d.paragraph;break}r=r.getSplitWidgets().pop().nextRenderedWidget,(0,a.le)(r)||(r=this.getNextBlockForList(r))}while(r);return null},s.prototype.getNextBlockForList=function(e){if(e instanceof I&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!(0,a.le)(t)&&t.equals(e))return t}return e},s.prototype.updateListItems=function(e,t,i){return e instanceof I?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},s.prototype.updateListItemsForTable=function(e,t,i){if((0,a.le)(i)&&t instanceof k&&e.equals(t))return!0;var n=e.firstChild;do{if(this.updateListItemsForRow(n,t,i))return!0;n=n.getSplitWidgets().pop().nextRenderedWidget}while(n);return!1},s.prototype.updateListItemsForRow=function(e,t,i){if((0,a.le)(i)&&t.isInsideTable&&-1!==e.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var n=e.firstChild;do{if(this.updateListItemsForCell(n,t,i),!(0,a.le)(i)&&!(0,a.le)(i.paragraph))return!0;n=n.nextRenderedWidget}while(n);return!1},s.prototype.updateListItemsForCell=function(e,t,i){if(0!==e.childWidgets.length){var n=e.firstChild;do{if(this.updateListItems(n,t,i),!(0,a.le)(i)&&!(0,a.le)(i.paragraph))break;n=n.getSplitWidgets().pop().nextRenderedWidget}while(n)}},s.prototype.updateRenderedListItems=function(e){e instanceof I?this.updateRenderedListItemsForPara(e):this.updateRenderedListItemsForTable(e)},s.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},s.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},s.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},s.prototype.updateListItemsForPara=function(e,t,i){if(e.equals(t))return(0,a.le)(i)||(i.paragraph=e),!0;var n=void 0,r=0;if(!(0,a.le)(e.paragraphFormat)&&!(0,a.le)(e.paragraphFormat.listFormat)){if(!(0,a.le)(i)&&e.paragraphFormat.listFormat.listId===i.listId)return i.paragraph=e,!0;n=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber}if(!(0,a.le)(n)&&!(0,a.le)(this.documentHelper.getAbstractListById(n.abstractListId))&&!(0,a.le)(this.documentHelper.getAbstractListById(n.abstractListId).levels[r])){var o=this.documentHelper.layout.getListLevel(n,r);this.updateListNumber(o,e,!1)}return!1},s.prototype.updateRenderedListItemsForPara=function(e){if(!(0,a.le)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))){var t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber;if(!(0,a.le)(t)&&!(0,a.le)(this.documentHelper.getAbstractListById(t.abstractListId))&&!(0,a.le)(this.documentHelper.getAbstractListById(t.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])){var n=this.documentHelper.layout.getListLevel(t,i);this.updateListNumber(n,e,!0)}}},s.prototype.updateListNumber=function(e,t,i){if("Bullet"!==e.listLevelPattern){var n=void 0;if(t.childWidgets.length>0){var r=t.childWidgets[0];r.children.length>0&&(n=r.children[0])}var o=void 0;if(!(0,a.le)(n)&&n.nextElement instanceof _&&(o=n.width+n.nextElement.width),!(0,a.le)(n)&&n instanceof _){var l=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat);if(i){var h=n.width;n.text=l;var d=this.documentHelper.textHelper.getTextSize(n,n.characterFormat);d>h&&(n.width=d),!(0,a.le)(o)&&n.width<o&&(n.nextElement.width=o-n.width)}}}},s.prototype.getOffsetValue=function(e){if(this.startParagraph){var t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):(this.endParagraph&&(t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset),e.end.setPositionFromLine(t.line,t.offset)),e.end.updatePhysicalPosition(!0))},s.prototype.setPositionParagraph=function(e,t,i){var n=this.documentHelper.selection,r=n.getLineInfoBasedOnParagraph(e,t);n.start.setPositionFromLine(r.line,r.offset),n.end.setPositionInternal(n.start),i||n.fireSelectionChanged(!0)},s.prototype.setPositionForCurrentIndex=function(e,t){var i=this.selection.getParagraph({index:t}),n=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);e.setPositionForLineWidget(n.line,n.offset)},s.prototype.insertPageNumber=function(e){e=(0,a.le)(e)?"":" \\*"+e,this.createFields("PAGE "+e+" \\* MERGEFORMAT")},s.prototype.insertPageCount=function(e){e=(0,a.le)(e)?"":" *"+e,this.createFields("NUMPAGES "+e+" * MERGEFORMAT")},s.prototype.createFields=function(e){var t=new I,i=new oe(t),n=new H(0);i.children.push(n);var r=new st;r.fieldBegin=n,r.text="1";var o=new S;o.text=e,i.children.push(o);var l=new H(2);l.fieldBegin=n,n.fieldSeparator=l,i.children.push(l),i.children.push(r);var h=new H(1);h.fieldBegin=n,h.fieldSeparator=l,l.fieldEnd=h,n.fieldEnd=h,i.children.push(h),n.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(n);var d=new j;d.sectionFormat=new je(d),d.childWidgets.push(t),this.pasteContentsInternal([d],!1)},s.prototype.insertBookmark=function(e){if(this.documentHelper.bookmarks.containsKey(e)){var t=this.documentHelper.bookmarks.get(e);t.line.children.splice(t.line.children.indexOf(t),1),t.reference.line.children.splice(t.reference.line.children.indexOf(t.reference),1),this.documentHelper.bookmarks.remove(e)}var i=new O(0);i.name=e;var n=new O(1);n.name=e,i.reference=n,n.reference=i,this.initComplexHistory("InsertBookmark"),this.insertElements([n],[i]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,i),this.selection.start.setPositionForSelection(i.line,i,1,this.selection.start.location),this.selection.end.setPositionForSelection(n.line,n,0,this.selection.end.location),this.selection.fireSelectionChanged(!0),this.fireContentChange()},s.prototype.deleteBookmark=function(e){var i=this.documentHelper.bookmarks.get(e);i instanceof O&&(this.initHistory("DeleteBookmark"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(i),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(i)),this.fireContentChange()},s.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;t instanceof H&&0===t.fieldType&&!(0,a.le)(t.formFieldData)&&(t.formFieldData.name=""),this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),(0,a.le)(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);var i=e.line.paragraph;if(e.line.paragraph.isInHeaderFooter){var n=void 0;i.containerWidget instanceof V?n=i.containerWidget.getContainerTable().containerWidget:i.containerWidget instanceof Ce&&(n=i.containerWidget),this.updateHeaderFooterWidget(n)}},s.prototype.getSelectionInfo=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start),t.offset===this.selection.getLineLength(t.currentWidget)+1&&this.selection.isParagraphLastLine(t.currentWidget)||(t.offset+=1);var i=this.selection.getParagraphInfo(e),n=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());return i=this.selection.getParagraphInfo(t),{start:n,end:this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString())}},s.prototype.insertElements=function(e,t){var i=this.getSelectionInfo();(0,a.le)(t)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.start),t),(0,a.le)(e)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.end),e)},s.prototype.insertElementsInternal=function(e,t,i){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),this.updateInsertPosition();var n=0,r=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var o=this.selection.start.paragraph;o.childWidgets[0].children.push(t[0]),t[0].line=o.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(o,0,0),this.setPositionParagraph(r.paragraph,r.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var l=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,n),d=t[0];this.insertElementInternal(l.element,d,n=l.index,void 0,!0);for(var c=d.indexInOwner,u=d,p=1;p<t.length;p++)d.line.children.splice(c+p,0,u=t[p]);e.setPositionForSelection(u.line,u,u.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},s.prototype.getCommentElementBox=function(e){var t=e.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},s.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},s.prototype.getBlockInternal=function(e,t){if(""!==t.index&&!(0,a.le)(t)){var i=t.index.indexOf(";"),n=t.index.substring(0,i);t.index=t.index.substring(i).replace(";","");var r=e;i=parseInt(n,10);var o=this.selection.getBlockByIndex(e,i);if(!o)return{node:r,position:t};var l=o;if(!(t.index.indexOf(";")>=0))return{node:l,position:t};if(l instanceof I)return t.index.indexOf(";")>=0&&(t.index="0"),{node:l,position:t};if(l instanceof Ze){var h=this.getBlockInternal(l,t);return{node:(0,a.le)(h)?void 0:h.node,position:(0,a.le)(h)?void 0:h.position}}return{node:r,position:t}}},s.prototype.updateHistoryPosition=function(e,t){if(this.editorHistory&&!(0,a.le)(this.editorHistory.currentBaseHistoryInfo)){var i=void 0;if(e instanceof Z){var n=this.selection.getParagraphInfo(e);i=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}else i=e;t?this.editorHistory.currentBaseHistoryInfo.insertPosition=i:this.editorHistory.currentBaseHistoryInfo.endPosition=i}},s.prototype.applyBorders=function(e){this.initHistory("Borders");var i=this.selection.isForward?this.selection.end:this.selection.start,n=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer),this.editorHistory&&this.cloneTableToHistoryInfo(n);var h,l=i.paragraph.associatedCell,d=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(this.selection.isEmpty)("OutsideBorders"===e.type||"AllBorders"===e.type||"LeftBorder"===e.type)&&l.cellFormat.borders.left.copyFormat(d),("OutsideBorders"===e.type||"AllBorders"===e.type||"TopBorder"===e.type)&&l.cellFormat.borders.top.copyFormat(d),("OutsideBorders"===e.type||"AllBorders"===e.type||"RightBorder"===e.type)&&l.cellFormat.borders.right.copyFormat(d),("OutsideBorders"===e.type||"AllBorders"===e.type||"BottomBorder"===e.type)&&l.cellFormat.borders.bottom.copyFormat(d),("AllBorders"===e.type||"InsideBorders"===e.type||"InsideVerticalBorder"===e.type)&&l.cellFormat.borders.vertical.copyFormat(d),("AllBorders"===e.type||"InsideBorders"===e.type||"InsideHorizontalBorder"===e.type)&&l.cellFormat.borders.horizontal.copyFormat(d),"NoBorder"===e.type&&this.clearAllBorderValues(l.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var c=this.getTopBorderCellsOnSelection(),u=0;u<c.length;u++)c[u].cellFormat.borders.top.copyFormat(d);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(c=this.getLeftBorderCellsOnSelection(),u=0;u<c.length;u++)c[u].cellFormat.borders.left.copyFormat(d);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(c=this.getRightBorderCellsOnSelection(),u=0;u<c.length;u++)c[u].cellFormat.borders.right.copyFormat(d);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(c=this.getBottomBorderCellsOnSelection(),u=0;u<c.length;u++)c[u].cellFormat.borders.bottom.copyFormat(d)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type)for(h=this.getAdjacentCellToApplyBottomBorder(),u=0;u<h.length;u++)h[u].cellFormat.borders.top.copyFormat("NoBorder"===e.type?this.clearBorder():d);if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type)for(h=this.getAdjacentCellToApplyRightBorder(),u=0;u<h.length;u++)h[u].cellFormat.borders.left.copyFormat("NoBorder"===e.type?this.clearBorder():d);("AllBorders"===e.type||"NoBorder"===e.type)&&this.applyAllBorders(d,e.type),("InsideBorders"===e.type||"InsideVerticalBorder"===e.type||"InsideHorizontalBorder"===e.type||"NoBorder"===e.type)&&this.applyInsideBorders(d,e.type,n),this.updateGridForTableDialog(n,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},s.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),n=0;n<i.length;n++)"NoBorder"===t?(i[n].cellFormat.borders.left.copyFormat(this.clearBorder()),i[n].cellFormat.borders.right.copyFormat(this.clearBorder()),i[n].cellFormat.borders.top.copyFormat(this.clearBorder()),i[n].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[n].cellFormat.borders.left.copyFormat(e),i[n].cellFormat.borders.right.copyFormat(e),i[n].cellFormat.borders.top.copyFormat(e),i[n].cellFormat.borders.bottom.copyFormat(e))},s.prototype.applyInsideBorders=function(e,t,i){for(var n=this.selection.getSelectedCells(),r=0;r<n.length;r++){var o=n[r],l=o.ownerRow===n[n.length-1].ownerRow,h=o.columnIndex+o.cellFormat.columnSpan-1===n[n.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(!h&&"InsideHorizontalBorder"!==t&&o.cellFormat.borders.right.copyFormat(e),!l&&"InsideVerticalBorder"!==t&&o.cellFormat.borders.bottom.copyFormat(e)),!l&&"InsideVerticalBorder"!==t){var c=i.childWidgets[o.ownerRow.rowIndex+o.cellFormat.rowSpan];if(c)for(var u=this.getAdjacentBottomBorderOnEmptyCells(c,o,!0),p=0;p<u.length;p++)u[p].cellFormat.borders.top.copyFormat("NoBorder"===t?this.clearBorder():e)}if(!h&&"InsideHorizontalBorder"!==t)for(var f=this.getSelectedCellsNextWidgets(o,i),g=0;g<f.length;g++)f[g].cellFormat.borders.left.copyFormat("NoBorder"===t?this.clearBorder():e)}},s.prototype.getTopBorderCellsOnSelection=function(){for(var t=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,i=[],n=this.selection.getSelectedCells(),r=0;r<n.length;r++)n[r].ownerRow===t.ownerRow&&i.push(n[r]);return i},s.prototype.getLeftBorderCellsOnSelection=function(){for(var t=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,i=this.selection.getSelectedCells(),n=[],r=0;r<i.length;r++)i[r].columnIndex===t.columnIndex&&n.push(i[r]);return n},s.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},s.prototype.getBottomBorderCellsOnSelection=function(){for(var t=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,i=this.selection.getSelectedCells(),n=[],r=0;r<i.length;r++)i[r].ownerRow===t.ownerRow&&n.push(i[r]);return n},s.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},s.prototype.clearBorder=function(){var e=new ve;return e.lineStyle="Cleared",e},s.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=t.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer);var r=t.paragraph.associatedCell,o=i.paragraph.associatedCell,h=n.childWidgets[o.ownerRow.rowIndex+o.cellFormat.rowSpan];if(h)if(o.cellFormat.columnSpan>1)for(var d=o.columnIndex;d<o.columnIndex+o.cellFormat.columnSpan;d++)e.push(h.childWidgets[d]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(h,o),!this.selection.isEmpty)for(d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d].columnIndex;c>=r.columnIndex&&c<=o.columnIndex&&e.push(h.childWidgets[d])}return e},s.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var n=[];if(t.cellFormat.columnSpan>1)for(var r=t.columnIndex;r<t.columnIndex+t.cellFormat.columnSpan;r++)n.push(e.childWidgets[r]);else if(this.selection.isEmpty||i)for(r=0;r<e.childWidgets.length;r++)e.childWidgets[r].columnIndex===t.columnIndex&&n.push(e.childWidgets[r]);return n},s.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start;this.selection.isForward||(t=this.selection.end);var n=t.paragraph.associatedCell.ownerTable;if(n=n.combineWidget(this.owner.viewer),this.selection.isEmpty)e=this.getSelectedCellsNextWidgets(t.paragraph.associatedCell,n);else for(var h=this.getRightBorderCellsOnSelection(),d=0;d<h.length;d++)e=e.concat(this.getSelectedCellsNextWidgets(h[d],n));return e},s.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(!(0,a.le)(e.nextWidget)&&(i.push(e.nextWidget),e.cellFormat.rowSpan>1))for(var n=e.ownerRow.rowIndex+e.cellFormat.rowSpan,r=e.ownerRow.rowIndex+1;r<n;r++){var o=t.childWidgets[r];if(o)for(var l=0;l<o.childWidgets.length;l++)o.childWidgets[l].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[l])}return i},s.prototype.getBorder=function(e,t,i){var n=new ve;return n.color=e||"#000000",n.lineWidth=t||1,n.lineStyle=i||"Single",n},s.prototype.applyBordersInternal=function(e,t){!(0,a.le)(e)&&!(0,a.le)(e)&&((0,a.le)(e.top)||this.applyBorder(e.top,t.top),(0,a.le)(e.bottom)||this.applyBorder(e.bottom,t.bottom),(0,a.le)(e.left)||this.applyBorder(e.left,t.left),(0,a.le)(e.right)||this.applyBorder(e.right,t.right),(0,a.le)(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),(0,a.le)(e.vertical)||this.applyBorder(e.vertical,t.vertical),(0,a.le)(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),(0,a.le)(e.diagonalDown)||this.applyBorder(e.diagonalDown,t.diagonalDown))},s.prototype.applyShading=function(e,t){!(0,a.le)(t)&&!(0,a.le)(e)&&(!(0,a.le)(t.backgroundColor)&&e.backgroundColor!==t.backgroundColor&&(e.backgroundColor=t.backgroundColor),!(0,a.le)(t.foregroundColor)&&e.foregroundColor!==t.foregroundColor&&(e.foregroundColor=t.foregroundColor),!(0,a.le)(t.textureStyle)&&e.textureStyle!==t.textureStyle&&(e.textureStyle=t.textureStyle))},s.prototype.applyBorder=function(e,t){!(0,a.le)(e)&&!(0,a.le)(t)&&(!(0,a.le)(t.color)&&e.color!==t.color&&t.hasValue("color")&&(e.color=t.color),!(0,a.le)(t.lineStyle)&&e.lineStyle!==t.lineStyle&&t.hasValue("lineStyle")&&(e.lineStyle=t.lineStyle),!(0,a.le)(t.lineWidth)&&e.lineWidth!==t.lineWidth&&t.hasValue("lineWidth")&&(e.lineWidth=t.lineWidth),!(0,a.le)(t.shadow)&&e.shadow!==t.shadow&&t.hasValue("shadow")&&(e.shadow=t.shadow),!(0,a.le)(t.space)&&e.space!==t.space&&t.hasValue("space")&&(e.space=t.space))},s.prototype.onTableFormat=function(e,t){if(!(0,a.le)(this.selection.tableFormat)){(0,a.le)(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat");var i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);if(t)for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++)r.childWidgets[o].cellFormat.shading.copyFormat(e.shading);if(!(0,a.le)(t))for(n=0;n<i.childWidgets.length;n++)for((r=i.childWidgets[n]).rowFormat.borders.copyFormat(e.borders),o=0;o<r.childWidgets.length;o++)r.childWidgets[o].cellFormat.borders.copyFormat(e.borders);this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},s.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(this.documentHelper.selection,void 0,i,e)},s.prototype.applyTablePropertyValue=function(e,t,i,n){var r=n.tableFormat;(0,a.le)(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(r,t,i)),i instanceof Oe?(0,a.le)(t)&&this.handleTableFormat(r,i):("preferredWidth"===t?r.preferredWidth=i:"leftIndent"===t?r.leftIndent=i:"tableAlignment"===t?r.tableAlignment=i:"cellSpacing"===t?r.cellSpacing=i:"leftMargin"===t?r.leftMargin=i:"rightMargin"===t?r.rightMargin=i:"topMargin"===t?r.topMargin=i:"bottomMargin"===t?r.bottomMargin=i:"preferredWidthType"===t?r.preferredWidthType=i:"bidi"===t&&(r.bidi=i),"shading"===t?r.shading=i:"borders"===t&&(r.borders=i))},s.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&((0,a.le)(e.borders)||this.applyBordersInternal(e.borders,t.borders),(0,a.le)(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent)),this.updateGridForTableDialog(e.ownerBase,!1)},s.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},s.prototype.onRowFormat=function(e){if(!(0,a.le)(this.selection)&&!(0,a.le)(e)){this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,e),this.reLayout(this.selection,!1)}},s.prototype.applyRowFormat=function(e,t,i,n,r){if(this.applyRowPropertyValue(this.documentHelper.selection,n,r,e),i.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;(0,a.le)(o)||this.applyRowFormat(o,t,i,n,r)}},s.prototype.applyRowPropertyValue=function(e,t,i,n){var r=n.rowFormat;(0,a.le)(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(r,t,i)),i instanceof De?(0,a.le)(t)&&this.handleRowFormat(i,r):("heightType"===t?r.heightType=i:"height"===t?r.height=i:"isHeader"===t?r.isHeader=i:"allowBreakAcrossPages"===t&&(r.allowBreakAcrossPages=i),(0,a.le)(n.ownerTable)||this.layoutItemBlock(n.ownerTable,!0))},s.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},s.prototype.onCellFormat=function(e){(0,a.le)(this.selection)||(0,a.le)(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},s.prototype.onParaFormat=function(e){(0,a.le)(this.selection)||(0,a.le)(e)||(this.editorHistory.initializeHistory("ParagraphFormat"),this.updateParagraphFormat(void 0,e,!1),this.reLayout(this.selection,!1))},s.prototype.updateCellMargins=function(e,t){var i=e.start,n=e.end;e.isForward||(i=e.end,n=e.start),this.initHistoryPosition(e,i),this.documentHelper.owner.cellOptionsDialogModule.applyCellMarginValue(i.paragraph.associatedCell.ownerRow,i,n,t)},s.prototype.updateFormatForCell=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start);for(var h,o=n.paragraph.associatedCell,l=r.paragraph.associatedCell,d=o.ownerTable.combineWidget(this.owner.viewer),u=o.columnIndex;u<=l.columnIndex;u++){h=this.getSelectedCellInColumn(o.ownerTable,o.ownerRow.rowIndex,u,l.ownerRow.rowIndex);for(var p=0;p<h.length;p++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,h[p].cellFormat)}this.updateGridForTableDialog(d,!1)},s.prototype.getSelectedCellInColumn=function(e,t,i,n){for(var r=[],o=t;o<=n;o++)for(var l=e.childWidgets[o],h=0;h<l.childWidgets.length;h++)l.childWidgets[h].columnIndex===i&&r.push(l.childWidgets[h]);return r},s.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];i?h.columnIndex+h.cellFormat.columnSpan===t&&n.push(h):h.columnIndex===t&&n.push(h)}return n},s.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:w.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:w.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},s.prototype.applyCellPropertyValue=function(e,t,i,n){if((0,a.le)(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(n,t,i)),i instanceof it)return(0,a.le)(t)&&this.handleCellFormat(i,n),i;"leftMargin"===t?n.leftMargin=i:"topMargin"===t?n.topMargin=i:"rightMargin"===t?n.rightMargin=i:"bottomMargin"===t?n.bottomMargin=i:"preferredWidth"===t?(n.preferredWidth=i,n.cellWidth=i):"cellWidth"===t?n.cellWidth=i:"columnSpan"===t?n.columnSpan=i:"rowSpan"===t?n.rowSpan=i:"preferredWidthType"===t?n.preferredWidthType=i:"verticalAlignment"===t&&(n.verticalAlignment=i),"shading"===t?n.shading=i:"borders"===t&&(n.borders=i)},s.prototype.handleCellFormat=function(e,t){!(0,a.le)(e)&&!(0,a.le)(t)&&(this.isBordersAndShadingDialog?((0,a.le)(e.borders)||this.applyBordersInternal(t.borders,e.borders),(0,a.le)(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment)))},s.prototype.destroy=function(){this.tableResize&&(this.tableResize.destroy(),this.tableResize=void 0),this.documentHelper=void 0,this.nodes=[]},s.prototype.updateToc=function(e){if((0,a.le)(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)){var t=this.selection.getFieldCode(e);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))}},s.prototype.getTocSettings=function(e,t){var i={includePageNumber:!0,rightAlign:!0};if("toc \\mergeformat"===e.toLowerCase())i.startLevel=1,i.endLevel=3;else for(var n=e.split("\\"),r=0;r<n.length;r++){var o=n[r];if(0!==o.length)switch(o[0]){case"o":if((0,a.le)(o.match(/\d+/g)))i.startLevel=1,i.endLevel=9;else{var l=o.match(/\d+/g).map(Number);i.startLevel=l[0],i.endLevel=l[1]}break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,o)}}var h=t.paragraph.paragraphFormat.getUpdatedTabs();return h.length>0&&(i.tabLeader=h[h.length-1].tabLeader),i.rightAlign&&(0,a.le)(i.tabLeader)&&(i.tabLeader="Dot"),i},s.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),n=0;n<i.length;n++)e.levelSettings[i[n]]=parseInt(i[n+1],10),n++},s.prototype.insertTableOfContents=function(e){this.isInsertingTOC=!0;var t=this.checkAndRemoveComments();this.initComplexHistory("TOC"),(0,a.le)(e)&&((e={}).startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var n,i=void 0;if("TableOfContents"===this.selection.contextType&&(i=this.selection.getTocFieldInternal()),i instanceof H){this.selection.start.setPositionForSelection(i.line,i,0,this.selection.start.location);var r=2;i.fieldEnd.paragraph===i.fieldEnd.paragraph.bodyWidget.lastChild&&r--,this.selection.end.setPositionForSelection(i.fieldEnd.line,i.fieldEnd,r,this.selection.end.location),this.delete()}n=this.constructTocFieldCode(e);var o=this.selection.start.isAtParagraphStart,l=this.selection.getParagraphInfo(this.selection.start),h=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString()),d=this.buildToc(this.validateTocSettings(e),n,!0,o);if(d.length>0){var c=new I,u=new oe(c);c.childWidgets.push(u);var p=0;o||(p=1),this.appendEndField(d[p].childWidgets[0].children[0],u),d.push(c),this.appendEmptyPara(d)}else{var m=new a.E7("documenteditor",this.owner.defaultLocale);m.setLocale(this.owner.locale),se.hZ.alert({title:m.getConstant("No Headings"),content:m.getConstant("Add Headings"),showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}})}this.setPositionForCurrentIndex(this.selection.start,h),this.selection.end.setPositionInternal(this.selection.start);var v=new j;v.sectionFormat=new je(v),v.childWidgets=d,this.pasteContentsInternal([v],!1),this.isInsertingTOC=!1,this.updatePageRef(),this.editorHistory&&(this.editorHistory.updateComplexHistoryInternal(),this.updateHistoryForComments(t)),0===d.length&&(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop())},s.prototype.appendEmptyPara=function(e){var t=new I,i=new oe(t);t.childWidgets.push(i),e.push(t)},s.prototype.constructTocFieldCode=function(e){var t="TOC";!(0,a.le)(e.startLevel)&&0!==e.startLevel&&!(0,a.le)(e.endLevel)&&0!==e.endLevel&&(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var i=this.constructTSwitch(e);return i.length>6&&(t+=i),t},s.prototype.constructTSwitch=function(e){var t="";if(!(0,a.le)(e.levelSettings))for(var n=0,r=Object.keys(e.levelSettings);n<r.length;n++){var o=r[n];t=t+o+","+e.levelSettings[o].toString()+","}return' \\t "'+(t=t.slice(0,-1))+'"'},s.prototype.appendEndField=function(e,t){var i=new H(1);if(i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,e.revisions.length>0){var n=e.revisions[e.revisions.length-1];n.range.push(i),i.revisions.push(n)}t.children.push(i)},s.prototype.validateTocSettings=function(e){return((0,a.le)(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),((0,a.le)(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),(0,a.le)(e.includeHyperlink)&&(e.includeHyperlink=!1),(0,a.le)(e.includePageNumber)&&(e.includePageNumber=!1),(0,a.le)(e.rightAlign)&&(e.rightAlign=!1),(0,a.le)(e.levelSettings)&&(e.levelSettings={}),e},s.prototype.buildToc=function(e,t,i,n){var r=this.documentHelper.pages[0].bodyWidgets[0],o=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);for(var l=this.selection.start.paragraph.bodyWidget.sectionFormat,h=r.childWidgets[0];void 0!==h;){if(h instanceof I&&(this.isHeadingStyle(h)||e.includeOutlineLevels&&this.isOutlineLevelStyle(h))){var d=this.insertTocBookmark(h);this.createTOCWidgets(h,o,t,d,e,i,n,l),i=!1}h=this.selection.getNextParagraphBlock(h.getSplitWidgets().pop())}return this.tocStyles={},o},s.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Level"+t.toString();(0,a.le)(this.tocStyles[i])&&(this.tocStyles[i]=t)}},s.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Heading "+t.toString();(0,a.le)(this.tocStyles[i])&&(this.tocStyles[i]=t)}if(!(0,a.le)(e.levelSettings))for(var n=0,r=Object.keys(e.levelSettings);n<r.length;n++){var o=r[n];this.tocStyles[o]=e.levelSettings[o]}},s.prototype.isHeadingStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&!(0,a.le)(this.tocStyles[t.name])},s.prototype.isOutlineLevelStyle=function(e){return!(0,a.le)(this.tocStyles[e.paragraphFormat.outlineLevel])},s.prototype.createTocFieldElement=function(e,t,i){var n=new H(0);n.hasFieldEnd=!0,n.line=e,e.children.push(n);var r=new S;r.text=t,r.line=e,e.children.push(r);var o=new H(2);return o.fieldBegin=n,o.fieldBegin.fieldSeparator=o,o.line=e,e.children.push(o),n},s.prototype.createTOCWidgets=function(e,t,i,n,r,o,l,h){var d=void 0,c=void 0,u=void 0,p=!1;if(1!==t.length||3!==t[0].childWidgets[0].children.length||(0,a.le)(o)||o){c=new I;var f,g=e.paragraphFormat.baseStyle.name;f=r.includeOutlineLevels&&(0,a.le)(this.tocStyles[g])?e.paragraphFormat.outlineLevel:g;var m="Toc"+this.tocStyles[f],v=this.documentHelper.styles.findByName(m,"Paragraph");if((0,a.le)(v)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(m)),this.documentHelper.styles),v=this.documentHelper.styles.findByName(m,"Paragraph")),c.paragraphFormat.applyStyle(v),r.rightAlign&&r.includePageNumber){var y=new Rn;y.position=h.pageWidth-(h.leftMargin+h.rightMargin),y.tabLeader=r.tabLeader,y.deletePosition=0,y.tabJustification="Right",c.paragraphFormat.tabs.push(y)}u=new oe(c),c.childWidgets.push(u)}else u=t[0].childWidgets[0];void 0!==o&&o&&(!(0,a.le)(l)&&!l&&(this.appendEmptyPara(t),p=!0),this.createTocFieldElement(u,i));for(var b="",C=!1,F=e;F instanceof I;){for(var T=0;T<F.childWidgets.length;T++)for(var x=F.childWidgets[T],P=0;P<x.children.length;P++){var E=x.children[P];if(!E.isPageBreak)if(E instanceof H||E instanceof O||C)E instanceof H&&(0===E.fieldType?C=!0:2===E.fieldType&&(C=!1));else if(E instanceof S||E instanceof _){var L=E.text;-1!==L.indexOf("\t")&&(L=L.replace(new RegExp("\t","g")," ")),b+=L}}F=F.nextSplitWidget}if(""!==b){if(r.includeHyperlink&&void 0!==n)d=this.insertTocHyperlink(u,n,b);else{var R=new S;R.text=b,R.line=u,u.children.push(R)}if(r.includePageNumber&&void 0!==n){if(r.rightAlign){var N=new at;N.text="\t",N.line=u,u.children.push(N)}var B=this.insertTocPageNumber(n,u,r.rightAlign,e);this.appendEndField(B,u)}r.includeHyperlink&&void 0!==d&&this.appendEndField(d,u)}!(0,a.le)(c)&&(""!==b||o)&&t.push(c),this.owner.enableTrackChanges&&!(0,a.le)(c)&&(1===t.length||p?this.insertRevisionForBlock(c,"Insertion",!0):this.insertRevisionForBlock(c,"Insertion",!0,this.owner.revisionsInternal.changes[0]))},s.prototype.insertTocHyperlink=function(e,t,i){var r=this.createTocFieldElement(e,' HYPERLINK \\l "'+t+'" ',!0),o=new S;return o.text=i,o.line=e,e.children.push(o),r},s.prototype.insertTocPageNumber=function(e,t,i,n){var o=this.createTocFieldElement(t," PAGEREF"+e+" \\h ",!0),h=n.containerWidget.page.currentPageNum.toString(),d=new st;return d.fieldBegin=o,i||(h=" "+h),d.text=h,d.line=t,t.children.push(d),this.pageRefFields[e]=d,o},s.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i=t[e];if(this.documentHelper.bookmarks.containsKey(i)){var o=this.documentHelper.bookmarks.get(i).paragraph.containerWidget.page.currentPageNum.toString(),l=this.pageRefFields[i];if(o!==l.text){l.text=o;var h=l.paragraph,d=h.childWidgets.indexOf(l.line),c=l.line.children.indexOf(l);this.documentHelper.layout.reLayoutParagraph(h,d,c)}}}},s.prototype.insertTocBookmark=function(e){var t=void 0;if(e.childWidgets.length>0){var n=e.getSplitWidgets(),r=n[0],o=n.pop(),l=r.childWidgets[0],h=o.childWidgets[o.childWidgets.length-1];if(void 0!==l&&void 0!==h){var d=l.children[0];if(d instanceof _||d instanceof ae)do{d=d.nextNode}while(d instanceof _||d instanceof ae);if(!(0,a.le)(d)&&d instanceof O&&0===d.bookmarkType&&d.name.toLowerCase().match("^_toc"))return d.name;var c=h.children[h.children.length-1];void 0!==d&&void 0!==c&&(this.selection.start.setPositionForSelection(l,d,0,this.selection.start.location),this.selection.end.setPositionForSelection(h,c,c.length,this.selection.end.location),t=this.generateBookmarkName(),this.insertBookmark(t))}}return t},s.prototype.generateBookmarkName=function(){this.tocBookmarkId++;for(var e=10-this.tocBookmarkId.toString().length,t="";e-1>0;)t="0"+t,e--;return"_Toc"+t+this.tocBookmarkId},s.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var i=this.owner.selection;i.isEmpty&&i.start.paragraph.isInsideTable?(this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),i.selectTableCell(),this.initHistory("CellContentVerticalAlignment"),this.applyCellPropertyValue(i,"verticalAlignment",e,i.start.paragraph.associatedCell.cellFormat),this.reLayout(i,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()):(this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),(0,a.le)(i.getTable(i.start,i.end))||(this.updateSelectionTableFormat(i,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(i,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory())},s.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;if(t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var r=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward);if(r.rowIndex===o.rowIndex){for(var l=r.ownerRow.childWidgets.indexOf(r),h=r.ownerRow.childWidgets.indexOf(o),d=[],c=[],u=l;u<=h;u++){var p=this.addEditElement(e);u==l&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=p),p.columnFirst=u,p.columnLast=u,p.line=t.start.currentWidget;var f=p.editRangeEnd;f.line=t.end.currentWidget,d.push(p),c.push(f)}this.insertElements(c,d),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var g=d[0].line.getOffset(d[0],1);this.selection.start.setPositionParagraph(d[0].line,g),g=c[0].line.getOffset(c[0],1),this.selection.end.setPositionParagraph(c[0].line,g),this.selection.fireSelectionChanged(!0),this.fireContentChange()}else{this.insertEditRangeInsideTable(r,o,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var m=this.selection.getFirstParagraphInCell(r).childWidgets[0],v=this.selection.getLastParagraph(o).childWidgets[0];g=m.getOffset(m.children[0],1),this.selection.start.setPositionParagraph(m,g),g=v.getOffset(v.children[0],1),this.selection.end.setPositionParagraph(v,g),this.selection.fireSelectionChanged(!0),this.fireContentChange()}}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},s.prototype.insertEditRangeInsideTable=function(e,t,i){var n=e.ownerTable,r=n.childWidgets.indexOf(t.ownerRow),o=n.childWidgets.indexOf(e.ownerRow),l=this.selection.getCellLeft(e.ownerRow,e),h=l+e.cellFormat.cellWidth,d=this.selection.getCellLeft(t.ownerRow,t),u=this.updateSelectedCellsInTable(l,h,d,d+t.cellFormat.cellWidth);l=u.start,h=u.end;for(var p=[],f=o;f<=r;f++){for(var g=n.childWidgets[f],m=-1,v=-1,y=0;y<g.childWidgets.length;y++){var C=this.selection.getCellLeft(g,g.childWidgets[y]);this.checkCellWithInSelection(l,h,C)&&(-1===m&&(m=y),v=y)}for(var F=[],T=m;T<=v;T++){var x=0,E=void 0;T===m&&(E=this.selection.getFirstParagraphInCell(g.childWidgets[m]).childWidgets[0]);var L=this.addEditElement(i);if(T===m&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=L),L.columnFirst=T,L.columnLast=T,L.line=E,L.line.children.splice(x,0,L),x++,F.push(L.editRangeEnd),p.length>0&&T===v){for(var R=0;R<p.length;R++)p[R].line=L.line,L.line.children.splice(x,0,p[R]),x++;p=[]}}if(p=F,f===r&&p.length>0){var B=this.selection.getLastParagraph(g.childWidgets[v]).lastChild;for(x=B.children.length-1,R=0;R<p.length;R++)p[R].line=B,B.children.splice(x,0,p[R]),x++}}},s.prototype.addRestrictEditingForSelectedArea=function(e){var t=this.addEditElement(e),i=t.editRangeEnd;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t),this.insertElements([i],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var n=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,n),n=i.line.getOffset(i,1),this.selection.end.setPositionParagraph(i.line,n),this.selection.fireSelectionChanged(!0),this.fireContentChange()},s.prototype.addEditElement=function(e){var t=new xe;"everyone"===e.toLocaleLowerCase()?t.group=e:t.user=e;var i=new He;return i.editRangeStart=t,t.editRangeEnd=i,this.editStartRangeCollection.push(t),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],t},s.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},s.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t=this.editStartRangeCollection[e],i=""===t.user?t.group:t.user;if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i))this.documentHelper.editRanges.get(i).push(t);else{var n=[];n.push(t),this.documentHelper.editRanges.add(i,n)}}this.selection.updateEditRangeCollection()},s.prototype.updateRangeCollection=function(e,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))this.documentHelper.editRanges.get(t).push(e);else{var i=[];i.push(e),this.documentHelper.editRanges.add(t,i)}},s.prototype.removeUserRestrictions=function(e){if(this.selection.checkSelectionIsAtEditRegion()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(t),this.editorHistory.updateHistory()),(t.user===e||t.group===e)&&this.removeUserRestrictionsInternal(t,e),this.selection.updateEditRangeCollection(),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1}},s.prototype.removeUserRestrictionsInternal=function(e,t){var i=t;(0,a.le)(t)&&(i=""===e.user?e.group:e.user);var n=this.documentHelper.editRanges.get(i).indexOf(e);this.documentHelper.editRanges.get(i).splice(n,1),0===this.documentHelper.editRanges.get(i).length&&this.documentHelper.editRanges.remove(i),e.removeEditRangeMark(),e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1)},s.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],n=this.documentHelper.editRanges.keys,r=0;r<n.length;r++){i=this.documentHelper.editRanges.get(n[r]);for(var o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1)}this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},s.prototype.insertFormField=function(e){if(!(0,a.le)(this.selection.start)&&!this.owner.enableHeaderAndFooter){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection)),t&&this.insertFormFieldInternal(e)}},s.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),n=new ie(void 0);n.copyFormat(i);var r=new H(0);r.formFieldData=this.getFormFieldData(e),r.characterFormat.copyFormat(n),t.push(r);var o=new O(0);o.characterFormat.copyFormat(n),r.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),o.name=r.formFieldData.name,t.push(o);var l=new S;l.text=this.getFormFieldCode(e),t.push(l);var h=new H(2);t.push(h);var d=new S;d.text="CheckBox"===e?String.fromCharCode(9744):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),d.characterFormat.copyFormat(n),t.push(d);var c=new H(1);c.characterFormat.copyFormat(n),t.push(c);var u=new O(1);u.characterFormat.copyFormat(n),u.name=r.formFieldData.name,u.reference=o,o.reference=u,t.push(u),this.insertElement(t),c.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(r)&&this.documentHelper.fields.push(r),-1===this.documentHelper.formFields.indexOf(r)&&this.documentHelper.formFields.push(r);var f=u.line.getOffset(u,1);this.selection.selects(u.line,f,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},s.prototype.getFormFieldData=function(e){switch(e){case"Text":return new Re;case"CheckBox":return new qe;case"DropDown":return new Ge}},s.prototype.setFormField=function(e,t){var i,n;(0,a.le)(t.format)?(0,a.le)(t.sizeType)?(0,a.le)(t.dropdownItems)||(i="DropDown",n=new Ge):(i="CheckBox",n=new qe):(i="Text",n=new Re),!(0,a.le)(i)&&!(0,a.le)(n)&&(n.name=e.formFieldData.name,n.copyFieldInfo(t),this.editFormField(i,n))},s.prototype.editFormField=function(e,t){var n,r,i=this.selection.getCurrentFormField();if((0,a.le)(i)||(0,a.le)(i.formFieldData))return!1;this.initComplexHistory("FormField"),""!==t.name&&(i.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),(n=new O(0)).name=t.name,(r=new O(1)).name=t.name,n.reference=r,r.reference=n),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=(0,a.le)(this.editorHistory)||this.editorHistory&&(0,a.le)(this.editorHistory.currentBaseHistoryInfo);var o=i.characterFormat.cloneFormat(),l=new ie;l.copyFormat(o);var h=i.fieldSeparator.nextElement.characterFormat.cloneFormat(),d=i.line.getOffset(i,0);this.selection.start.setPositionParagraph(i.line,d);var c=i.fieldEnd;i.nextNode&&i.nextNode instanceof O&&(c=i.nextNode.reference),d=c.line.getOffset(c,1),this.selection.end.setPositionParagraph(c.line,d),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition();var u=[],p=new H(0);p.formFieldData=t,u.push(p),p.characterFormat.copyFormat(l),(0,a.le)(n)||u.push(n);var f=new S;f.text=this.getFormFieldCode(e),u.push(f);var g=new H(2);g.characterFormat.copyFormat(l),u.push(g),(f=new S).characterFormat.copyFormat(h),f.text=this.getDefaultText(t),"CheckBox"===e?(f.characterFormat.copyFormat(p.characterFormat),"Exactly"===t.sizeType&&(f.characterFormat.fontSize=t.size)):t instanceof Re&&""!==t.defaultValue&&(f.text="Text"===t.type?w.formatText(t.format,t.defaultValue):"Number"===t.type?w.formatNumber(t.format,t.defaultValue):w.formatDate(t.format,t.defaultValue)),u.push(f);var m=new H(1);m.characterFormat.copyFormat(l),u.push(m);var v=m;(0,a.le)(r)||(v=r,u.push(r)),this.insertElement(u),m.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(p)&&this.documentHelper.fields.push(p);var b=v.line.getOffset(v,1);return this.selection.selects(v.line,b,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},s.prototype.getDefaultText=function(e){var t="";return e instanceof qe?t=String.fromCharCode(e.defaultValue?9745:9744):e instanceof Ge?t=e.dropdownItems.length>0?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof Re&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},s.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},s.prototype.toggleCheckBoxFormField=function(e,t,i){var n=e.formFieldData;if(n instanceof qe&&n.enabled){if(this.initHistory("UpdateFormField"),this.editorHistory){var r=void 0;n instanceof qe&&(r=n.checked),this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,r),this.editorHistory.updateHistory()}n.checked=t?i:!n.checked,e.fieldSeparator.nextNode.text=String.fromCharCode(n.checked?9745:9744),this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1)}},s.prototype.updateFormField=function(e,t,i){var n=e.formFieldData;n&&this.updateFormFieldInternal(e,n,t,i)},s.prototype.updateFormFieldInternal=function(e,t,i,n){if(t instanceof Re){""===i&&(i=n?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5));var r=i;"Text"===t.type&&""!==t.format&&(r=w.formatText(t.format,i)),this.updateFormFieldResult(e,r)}else if(t instanceof Ge){var l=t.dropdownItems[i];t.selectedIndex=i,this.updateFormFieldResult(e,l)}var h=e.fieldEnd.line.getOffset(e.fieldEnd,1),d=new Z(this.owner);d.setPositionParagraph(e.fieldEnd.line,h),this.documentHelper.selection.selectRange(d,d),this.reLayout(this.selection,!1)},s.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.insertText(t)},s.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++)if(i.containsKey(e))return!1;return!0},s.prototype.getBookmarkName=function(e,t,i){for(var n,r=!1;!1===r;)r=this.checkBookmarkAvailability(n=e+i,t),i+=1;return n},s.prototype.applyFormTextFormat=function(e){if(!(0,a.le)(e)){var t=this.getFieldResultText(e),i=t;t=w.formatText(e.formFieldData.format,t),null!=e.fieldSeparator&&this.applyTextFormatInternal(e,t),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,i),this.editorHistory.updateHistory())}},s.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var e=this.getFieldResultText();(0===e.length||"\r"===e)&&(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},s.prototype.getFieldResultText=function(e){(0,a.le)(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,i=this.selection.endOffset;this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0);var n=this.selection.getText(!1);return this.selection.select(t,i),this.selection.isModifyingSelectionInternally=!1,n},s.prototype.applyTextFormatInternal=function(e,t){var i=e.fieldSeparator.nextElement,n=0;t=t.replace(/\r/g,"");do{if(!(0,a.le)(i)&&i instanceof S&&(i.text=t.slice(n,n+i.text.length),n+=i.length),(0,a.le)(i.nextElement))if((0,a.le)(i.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0);var r=i.paragraph.nextRenderedWidget;if((0,a.le)(r))break;for(r instanceof k&&(r=this.selection.getFirstParagraphBlock(r));r.isEmpty();)r=r.nextRenderedWidget;i=r.childWidgets[0].children[0]}else i=i.line.nextLine.children[0];else i=i.nextElement}while(!(i instanceof H&&1===i.fieldType&&i.fieldBegin.formFieldData instanceof Re));this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},s.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",n=0;n<t.length;n++)t[n].length>0&&""!==t[n]&&(i+=t[n][0]);return i},s.prototype.insertFootnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.isFootNoteInsert=!0,this.isFootNote=!0;var e=new Ee;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Footnote",e.text="s";var t=new I,i=new oe(t),n=new S;n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var o,r=new S;if(r.text=" ",r.line=i,i.children.push(r),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e),e.paragraph.bodyWidget.page.footnoteWidget)for(var l=0;l<e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;l++)e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[l].footNoteReference===e&&(o=e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[l].childWidgets[0]);this.selection.start.setPositionForLineWidget(o.childWidgets[0],r.line.getOffset(r,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1}},s.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.footnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.footnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.footnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.footnoteCollection.splice(n,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},s.prototype.insertEndnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.documentHelper.layout.isEndnoteContentChanged=!0;var e=new Ee;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Endnote",e.text="s";var t=new I,i=new oe(t),n=new S;n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var r=new S;r.text=" ",r.line=i,i.children.push(r),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var h,l=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0];if(l.page.endnoteWidget)for(var d=0;d<l.page.endnoteWidget.bodyWidgets.length;d++)l.page.endnoteWidget.bodyWidgets[d].footNoteReference===e&&(h=l.page.endnoteWidget.bodyWidgets[d].childWidgets[0]);this.selection.start.setPositionForLineWidget(h.childWidgets[0],n.line.getOffset(r,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.reLayout(this.selection,!1),this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},s.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.endnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.endnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.endnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.endnoteCollection.splice(n,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var o=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var h,l=!1,d=void 0,c=this.documentHelper.endnoteCollection.indexOf(e),u=1,f=void 0,g=this.documentHelper.pages[o-1].bodyWidgets[0];if(g.page.endnoteWidget)for(var m=0;m<g.page.endnoteWidget.bodyWidgets.length;m++){var v=this.documentHelper.endnoteCollection.indexOf(g.page.endnoteWidget.bodyWidgets[m].footNoteReference);if(v>c&&v-c==1){u=m,l=!0;break}}if(h=e,g.page.endnoteWidget instanceof Y&&"Endnote"===g.page.endnoteWidget.footNoteType)d=g.page.endnoteWidget;else{f=!0,(d=new Y).footNoteType="Endnote",d.page=g.page;var y=new I;y.characterFormat=new ie,y.paragraphFormat=new ue,y.index=0;var b=new oe(y);y.childWidgets.push(b),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18)}var C=h.bodyWidget;for(m=0;m<h.bodyWidget.childWidgets.length;m++){var F=h.bodyWidget.childWidgets[m];this.documentHelper.layout.isLayoutWhole?F.containerWidget=void 0:(F.containerWidget=C,C.page=g.page,C.sectionFormat=d.sectionFormat,F.containerWidget.containerWidget=d),l?d.bodyWidgets.splice(u,0,C):d.bodyWidgets.push(C)}u++,f&&(g.page.endnoteWidget=d),d.height+=0}}},s.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++)(0,a.le)(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=e[t].text)},s.prototype.separator=function(e){var t=new I,i=new oe(t),n=new S;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(3),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},s.prototype.continuationSeparator=function(e){var t=new I,i=new oe(t),n=new S;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(4),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},s.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++)e[t].text=(t+1).toString(),(0,a.le)(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=(t+1).toString())},s}(),Lr=function(){function s(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new U,this.documentHelper=t,this.imageResizerPoints=new hs,(0,a.le)(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(s.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof de},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"ImageResizer"},s.prototype.setImageResizerPositions=function(e,t,i,n){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=n+"px",this.imageResizerDivElement.style.width=this.owner.viewer instanceof Se?i-e-this.documentHelper.scrollbarWidth+"px":i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},s.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},s.prototype.positionImageResizer=function(e){var t;this.selectedImageWidget.clear(),(0,a.le)(this.documentHelper.currentPage)||(t=this.imageResizerDivElement),!(0,a.le)(t)&&!t.contains(this.imageResizerDiv)&&(this.imageResizerDiv=this.initResizeMarks(t,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var n,r,i=e.line;e instanceof ee&&"Inline"!==e.textWrappingStyle?(n=e.y,r=e.x):(n=this.documentHelper.selection.getTop(i)+e.margin.top,r=this.documentHelper.selection.getLeftInternal(i,e,0));var o=this.documentHelper.selection.getPage(i.paragraph);this.currentPage=o,(0,a.le)(t)||(this.owner.viewer instanceof Se&&(this.imageResizerDivElement.style.width=o.boundingRectangle.width-o.boundingRectangle.x-r-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",t.style.width=this.owner.viewer instanceof Se?o.boundingRectangle.width-this.documentHelper.scrollbarWidth-o.boundingRectangle.x-r+"px":o.boundingRectangle.width+"px",t.style.height=o.boundingRectangle.height+"px",t.style.left=o.boundingRectangle.x+"px",t.style.top=o.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");this.documentHelper.getPageWidth(o);parseFloat(this.imageResizerDivElement.style.width);var c=this.imageResizerDivElement,u=parseFloat(c.style.width),p=parseFloat(c.style.height),f=parseFloat(this.imageResizerDiv.style.width),g=parseFloat(this.imageResizerDiv.style.height),m=(this.resizeMarkSize-1)/2,v=f+2*m,y=g+2*m;if(v>(u-r)*this.documentHelper.zoomFactor+m&&(v=(u-r)*this.documentHelper.zoomFactor),y>(p-n)*this.documentHelper.zoomFactor+m&&(y=(p-n)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",y=this.documentHelper.render.getScaledValue(e.height),v=this.documentHelper.render.getScaledValue(e.width),e instanceof ee?(r=this.documentHelper.render.getScaledValue(r),n=this.documentHelper.render.getScaledValue(n)):(r=e.x*this.documentHelper.zoomFactor,n=e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(r,n,v,y,this),this.resizeContainerDiv.style.borderStyle=this.owner.selection.isInShape?"dashed":"solid",!this.selectedImageWidget.containsKey(i)){var b=new ds(e.height,e.width);this.selectedImageWidget.add(i,b)}},s.prototype.showImageResizer=function(){(0,a.le)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),(0,a.le)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),(0,a.le)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),(0,a.le)(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),(0,a.le)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),(0,a.le)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),(0,a.le)(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),(0,a.le)(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),(0,a.le)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),(0,a.le)(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},s.prototype.hideImageResizer=function(){(0,a.le)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),(0,a.le)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),(0,a.le)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),(0,a.le)(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),(0,a.le)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),(0,a.le)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),(0,a.le)(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),(0,a.le)(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),(0,a.le)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),(0,a.le)(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},s.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},s.prototype.setImageResizerPosition=function(e,t,i,n,r){r.resizeContainerDiv.style.width=i+"px",r.resizeContainerDiv.style.height=n+"px",r.resizeContainerDiv.style.left=e+"px",r.resizeContainerDiv.style.top=t+"px",r.topRightRect.style.left=e+i-5+"px",r.topRightRect.style.top=t-4+"px",r.topLeftRect.style.left=e-5+"px",r.topLeftRect.style.top=t-4+"px",r.topMiddleRect.style.left=parseFloat(r.topLeftRect.style.left)+i/2-4+"px",r.topMiddleRect.style.top=t-4+"px",r.bottomRightRect.style.left=r.topRightRect.style.left,r.bottomRightRect.style.top=parseFloat(r.topRightRect.style.top)+n+"px",r.bottomLeftRect.style.left=r.topLeftRect.style.left,r.bottomLeftRect.style.top=parseFloat(r.topLeftRect.style.top)+n+"px",r.bottomMiddleRect.style.left=r.topMiddleRect.style.left,r.bottomMiddleRect.style.top=parseFloat(r.topMiddleRect.style.top)+n+"px",r.rightMiddleRect.style.left=e+i-4+"px",r.rightMiddleRect.style.top=parseFloat(r.topRightRect.style.top)+n/2+"px",r.leftMiddleRect.style.left=r.topLeftRect.style.left,r.leftMiddleRect.style.top=parseFloat(r.topLeftRect.style.top)+n/2+"px",r.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",r.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",r.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topMiddleRectParent.style.left=parseFloat(r.topLeftRectParent.style.left)+i/2-4+"px",r.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.bottomRightRectParent.style.left=r.topRightRectParent.style.left,r.bottomRightRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n+"px",r.bottomLeftRectParent.style.left=r.topLeftRectParent.style.left,r.bottomLeftRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n+"px",r.bottomMiddleRectParent.style.left=r.topMiddleRectParent.style.left,r.bottomMiddleRectParent.style.top=parseFloat(r.topMiddleRectParent.style.top)+n+"px",r.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",r.rightMiddleRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n/2+"px",r.leftMiddleRectParent.style.left=r.topLeftRectParent.style.left,r.leftMiddleRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n/2+"px",this.setImageResizingPoints(r),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},s.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},s.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},s.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},s.prototype.handleImageResizing=function(e,t,i){t/=this.documentHelper.zoomFactor,i/=this.documentHelper.zoomFactor,this.leftValue=(0,a.le)(this.leftValue)?t:this.leftValue,this.topValue=(0,a.le)(this.topValue)?i:this.topValue;var n,r=this.selectedResizeElement.id.split("_"),o=r[r.length-1];switch(o){case"TopRightRectParent":t=(n=this.topRightResizing(e)).left,i=n.top;break;case"TopLeftRectParent":t=-(n=this.topLeftResizing(e)).left,i=-n.top;break;case"TopMiddleRectParent":t=0,i=this.topMiddleResizing(e);break;case"BottomRightRectParent":t=(n=this.bottomRightResizing(e)).left,i=n.top;break;case"BottomLeftRectParent":t=-(n=this.bottomLeftResizing(e)).left,i=-n.top;break;case"BottomMiddleRectParent":i=e.y-i,t=0;break;case"RightMiddleRectParent":t=e.x-t,i=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),i=0}if(0!==t||0!==i){var l=this.currentImageElementBox.line.paragraph,h=this.currentImageElementBox;if(!(0,a.le)(l)&&l.isInsideTable){var d=l.containerWidget;if(!(0,a.le)(d)){var c=d.containerWidget,u=w.convertPointToPixel(h.height);i>0&&c.y+(c.height-u)+u+i>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!(0,a.le)(this.currentImageElementBox)){var f=this.currentImageElementBox.width+t>10?this.currentImageElementBox.width+t:10,g=this.currentImageElementBox.height+i>10?this.currentImageElementBox.height+i:10;("BottomRightRectParent"===o||"TopRightRectParent"===o||"BottomLeftRectParent"===o||"TopLeftRectParent"===o)&&(f=this.currentImageElementBox.width/this.currentImageElementBox.height*(g=this.currentImageElementBox.height/this.currentImageElementBox.width*f)),this.currentImageElementBox.width=f,this.currentImageElementBox.height=g,this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},s.prototype.handleImageResizingOnMouse=function(e){if(!(0,a.le)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),n=new ce(e.offsetX,e.offsetY),r=this.viewer.findFocusedPage(n,!0);this.handleImageResizing(r,t,i)}},s.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof ye&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},s.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},s.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},s.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},s.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},s.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},s.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},s.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},s.prototype.handleImageResizingOnTouch=function(e){if(!(0,a.le)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left)+24,i=parseFloat(this.selectedResizeElement.style.top)+24,n=e.touches,r=new ce(n[0].clientX,n[0].clientY),o=this.viewer.findFocusedPage(r,!0);if((0,a.le)(this.currentImageElementBox)||(0,a.le)(this.currentImageElementBox))return;this.handleImageResizing(o,t,i)}},s.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new ce(t,i);var n=this.imageResizerPoints,r="",o=void 0,l=n.bottomMiddleRectParent,h=n.bottomRightRectParent,d=n.bottomLeftRectParent,c=n.topMiddleRectParent,u=n.topRightRectParent,p=n.topLeftRectParent,f=n.rightMiddleRectParent,g=n.leftMiddleRectParent;return!(0,a.le)(this.bottomMiddleRectParent)&&"none"!==this.bottomMiddleRectParent.style.display&&(e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(o=this.bottomMiddleRectParent,r="s-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(o=this.bottomRightRectParent,r="se-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(o=this.bottomLeftRectParent,r="sw-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(o=this.topMiddleRectParent,r="n-resize"):e.x>u.x&&e.x<=u.x+15&&e.y>u.y&&e.y<=u.y+15?(o=this.topRightRectParent,r="ne-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(o=this.topLeftRectParent,r="nw-resize"):e.x>g.x&&e.x<=g.x+15&&e.y>g.y&&e.y<=g.y+15?(o=this.leftMiddleRectParent,r="w-resize"):e.x>f.x&&e.x<=f.x+15&&e.y>f.y&&e.y<=f.y+15?(o=this.rightMiddleRectParent,r="e-resize"):!(0,a.le)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(r="move")),{selectedElement:o,resizePosition:r}},s.prototype.applyPropertiesForMouse=function(){(0,a.le)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},s.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new ce(t,i);var n=this.imageResizerPoints,r="",o=void 0,l=n.bottomMiddleRectParent,h=n.bottomRightRectParent,d=n.bottomLeftRectParent,c=n.topMiddleRectParent,u=n.topRightRectParent,p=n.topLeftRectParent,f=n.rightMiddleRectParent,g=n.leftMiddleRectParent;return!(0,a.le)(this.bottomMiddleRectParent)&&"none"!==this.bottomMiddleRectParent.style.display&&(e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(o=this.bottomMiddleRectParent,r="s-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(o=this.bottomRightRectParent,r="se-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(o=this.bottomLeftRectParent,r="sw-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(o=this.topMiddleRectParent,r="n-resize"):e.x>u.x&&e.x<=u.x+25&&e.y>u.y&&e.y<=u.y+25?(o=this.topRightRectParent,r="ne-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(o=this.topLeftRectParent,r="nw-resize"):e.x>g.x&&e.x<=g.x+25&&e.y>g.y&&e.y<=g.y+25?(o=this.leftMiddleRectParent,r="w-resize"):e.x>f.x&&e.x<=f.x+25&&e.y>f.y&&e.y<=f.y+25?(o=this.rightMiddleRectParent,r="e-resize"):!(0,a.le)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(r="move")),{selectedElement:o,resizePosition:r}},s.prototype.applyPropertiesForTouch=function(){(0,a.le)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},s.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selection),this.documentHelper.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph,0,0),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selection,!0),this.viewer.updateScrollBars()},s.prototype.initHistoryForImageResizer=function(e){!(0,a.le)(this.owner)&&(0,a.le)(this.baseHistoryInfo)&&(this.baseHistoryInfo=new Gt(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new Gi(e)))},s.prototype.updateHistoryForImageResizer=function(){if(!(0,a.le)(this.owner)&&!(0,a.le)(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():this.owner.editorHistory.recordChanges(this.baseHistoryInfo),this.baseHistoryInfo=void 0}},s.prototype.updateImageResizerPosition=function(){if(!(0,a.le)(this.currentImageElementBox)){var i,e=this.currentImageElementBox,t=e.line,n=void 0,r=void 0,o=void 0;this.currentImageElementBox instanceof ee?(i=this.documentHelper.selection.getTop(t)+e.margin.top,n=this.documentHelper.selection.getLeftInternal(t,e,0),r=i*this.documentHelper.zoomFactor,o=n*this.documentHelper.zoomFactor):(o=e.x*this.documentHelper.zoomFactor,r=e.y*this.documentHelper.zoomFactor);var l=this.documentHelper.render.getScaledValue(e.height,2),h=this.documentHelper.render.getScaledValue(e.width,1);this.setImageResizerPosition(o,r,h,l,this)}},s.prototype.destroy=function(){(0,a.le)(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),(0,a.le)(this.topLeftRect)||(this.topLeftRect.innerHTML=""),(0,a.le)(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),(0,a.le)(this.topRightRect)||(this.topRightRect.innerHTML=""),(0,a.le)(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),(0,a.le)(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),(0,a.le)(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),(0,a.le)(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),(0,a.le)(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),(0,a.le)(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),(0,a.le)(this.selectedImageWidget)||this.selectedImageWidget.destroy(),(0,a.le)(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML=""),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.imageResizerPoints=void 0,this.resizeMarkSizeIn=void 0,this.documentHelper=void 0,this.owner=void 0},s}(),hs=function(){return function(){this.resizeContainerDiv=new ce(0,0),this.topLeftRectParent=new ce(0,0),this.topMiddleRectParent=new ce(0,0),this.topRightRectParent=new ce(0,0),this.bottomLeftRectParent=new ce(0,0),this.bottomMiddleRectParent=new ce(0,0),this.bottomRightRectParent=new ce(0,0),this.leftMiddleRectParent=new ce(0,0),this.rightMiddleRectParent=new ce(0,0)}}(),ds=function(){function s(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(s.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),s}(),us=function(){function s(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}return s.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},s.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;return this.findDocument(n,e,!0,t,i),n.currentSearchResult},s.prototype.stringToRegex=function(e,t){if(e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf("(")>-1||e.indexOf(")")>-1||e.indexOf(".")>-1||e.indexOf("[")>-1||e.indexOf("]")>-1||e.indexOf("$")>-1||e.indexOf("{")>-1||e.indexOf("}")>-1||e.indexOf("*")>-1||e.indexOf("|")>-1||e.indexOf("^")>-1||e.indexOf("?")>-1){for(var i="",n=0;n<e.length;n++)i+="("===e[n]||")"===e[n]||"."===e[n]||"["===e[n]||"]"===e[n]||"$"===e[n]||"{"===e[n]||"}"===e[n]||"*"===e[n]||"|"===e[n]||"^"===e[n]||"?"===e[n]?"\\"+e[n]:e[n];e=i}return("WholeWord"===t||"CaseSensitiveWholeWord"===t)&&(e=this.wordBefore+e+this.wordAfter),new RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},s.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},s.prototype.findAll=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;if(this.findDocument(n,e,!1,t,i),n.length>0&&n.currentIndex<0&&(n.currentIndex=0),!(0,a.le)(n.currentSearchResult))return this.documentHelper.owner.trigger(hi,{source:this.documentHelper.owner}),n},s.prototype.getElementInfo=function(e,t,i){for(var n=e,r="",o=new U;;){if(e instanceof S&&!(0,a.le)(e.text)&&""!==e.text)o.add(e,r.length),r+=e===n?e.text.substring(t):e.text;else if(e instanceof H){var l=e;(0,a.le)(l.fieldEnd)||(e=(0,a.le)(l.fieldSeparator)?l.fieldEnd:l.fieldSeparator)}if(!(0,a.le)(e)&&(0,a.le)(e.nextNode))break;if(!(0,a.le)(e))if((0,a.le)(i)||i)e=e.nextNode;else{var d=e.line.children.length;if(!(e.line.children.indexOf(e)<d-1)){e=void 0;break}e=e.nextNode}}return{elementsWithOffset:o,fullText:r.toString()}},s.prototype.updateMatchedTextLocation=function(e,t,i,n,r,o,l,h){for(var d=0;d<e.length;d++){var c=e[d],u=void 0;if((0,a.le)(h)||!(c.index<h)){for(var p=t.addResult(),f=i.keys,g=0;g<f.length;g++){var m=f[g],v=i.get(m),y=m.length;if(m===r&&(y-=n),(0,a.le)(p.start)&&c.index<v+y){var b=c.index-v;m===r&&(b+=n);var C=m.line.getOffset(m,b);p.start=this.getTextPosition(m.line,C.toString()),p.start.location=this.owner.selection.getPhysicalPositionInternal(m.line,C,!0),p.start.setPositionParagraph(m.line,C)}if(c.index+c[0].length<=v+y){b=c.index+c[0].length-v,m===r&&(b+=n),C=m.line.getOffset(m,b),p.end=this.getTextPosition(m.line,C.toString()),p.end.location=this.owner.selection.getPhysicalPositionInternal(m.line,C,!0),p.end.setPositionParagraph(m.line,C),u=!0;break}}if(o){t.currentIndex=0;break}if(t.currentIndex<0&&!(0,a.le)(l)&&(l.isExistBefore(p.start)||l.isAtSamePosition(p.start))&&(t.currentIndex=t.indexOf(p)),!(0,a.le)(h)&&u)break}}},s.prototype.findDocument=function(e,t,i,n,r){if(!this.isPatternEmpty(t)){void 0===n&&(n="None");var p,o=void 0,l=void 0;if(void 0!==r&&(l=this.owner.selection.end),void 0!==r&&i&&void 0!==l&&void 0!==l.paragraph&&l.paragraph instanceof I){var h=0,d=l.currentWidget.getInline(this.owner.selection.start.offset,h);if(h=d.index,!(0,a.le)(o=d.element)){var c=void 0;for(c=this.findInline(o,t,n,h,i,e,l);0===e.length&&!(0,a.le)(c);){for(;!(0,a.le)(c)&&0===c.childWidgets.length;)c=this.owner.selection.getNextParagraph(c.containerWidget);if((0,a.le)(c))break;var u=c.childWidgets[0];if((0,a.le)(o=u.children[0]instanceof _?u.children[2]instanceof S?u.children[2]:void 0:u.children[0]))break;c=this.findInline(o,t,n,0,i,e,l)}if(e.length>0)return}}for(p=this.documentHelper.pages[0].bodyWidgets[0];!(0,a.le)(p)&&0===p.childWidgets.length;)p=p.nextWidget;if(!(0,a.le)(p)&&0!==p.childWidgets.length){this.findInlineText(p,t,n,i,e,l);for(var f=this.documentHelper.headersFooters,g=0;g<f.length;g++){var m=f[g];if(m)for(var v in m){var y=m[v];!(0,a.le)(y)&&!(0,a.le)(y.page)&&this.findInlineText(y,t,n,i,e,l)}}i&&(0,a.le)(e)}}},s.prototype.findInlineText=function(e,t,i,n,r,o){for(var l=this.owner.selection.getFirstParagraphBlock(e.childWidgets[0]);!(0,a.le)(l)&&1===l.childWidgets.length&&0===l.childWidgets[0].children.length;)l=this.owner.selection.getNextParagraphBlock(l);for(;!(0,a.le)(l)&&l.childWidgets.length>0;){var d=l.childWidgets[0].children[0];if((0,a.le)(d))break;for(this.findInline(d,t,i,0,n,r,o),l=this.owner.selection.getNextParagraphBlock(l);!(0,a.le)(l)&&1===l.childWidgets.length&&0===l.childWidgets[0].children.length;)l=this.owner.selection.getNextParagraphBlock(l)}n&&(0,a.le)(r)},s.prototype.findInline=function(e,t,i,n,r,o,l){for(var f,h=e,d=this.getElementInfo(e,n),c=d.fullText,u=[],p=d.elementsWithOffset;!(0,a.le)(f=t.exec(c));)u.push(f);if(this.updateMatchedTextLocation(u,o,p,n,h,r,l),!r)return this.owner.selection.getNextParagraphBlock(e.line.paragraph)},s.prototype.getTextPosition=function(e,t){var i=new Z(this.owner),n=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(n),i},s}(),ps=function(){function s(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(s.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),s}(),fs=function(){function s(e){this.startIn=void 0,this.endIn=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(s.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),s.prototype.destroy=function(){this.start=void 0,this.end=void 0},s}(),Er=function(){function s(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(s.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),s.prototype.addResult=function(){var e=new fs(this.owner);return(0,a.le)(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},s.prototype.clearResults=function(){if(this.currentIndex=-1,!(0,a.le)(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[e].destroy(),this.innerList.splice(e,1)},s.prototype.indexOf=function(e){return(0,a.le)(this.innerList)?-1:this.innerList.indexOf(e)},s.prototype.destroy=function(){(0,a.le)(this.innerList)||this.clearResults(),this.innerList=void 0},s}(),gs=function(){function s(e){this.searchModule=e}return Object.defineProperty(s.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),s.prototype.getTextSearchResultsOffset=function(){for(var t,e=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)t=this.getOffset(this.searchModule.textSearchResults.innerList[i]),e.push(t);return e},s.prototype.getOffset=function(e){var i=e.end,n=this.searchModule.documentHelper.owner.selection.getParagraphInfo(e.start),r=this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());return n=this.searchModule.documentHelper.owner.selection.getParagraphInfo(i),{startOffset:r,endOffset:this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}},s.prototype.getModuleName=function(){return"SearchResults"},s.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},s.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},s.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},s.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},s}(),kr=function(){function s(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new U,this.textSearch=new us(this.owner),this.textSearchResults=new Er(this.owner),this.searchResultsInternal=new gs(this)}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"Search"},s.prototype.find=function(e,t){(0,a.le)(t)&&(t="None");var i=this.textSearch.find(e,t);(0,a.le)(i)||this.navigate(i)},s.prototype.findAll=function(e,t){if(!(0,a.le)(e||""===e)){(0,a.le)(t)&&(t="None");var i=this.textSearch.findAll(e,t);!(0,a.le)(i)&&i.length>0&&(this.navigate(i.innerList[i.currentIndex]),this.highlight(i))}},s.prototype.replace=function(e,t,i){if((0,a.le)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||(0,a.le)(i))return 0;(0,a.le)(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var n=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget&&this.documentHelper.selection.end.currentWidget.getInline(this.owner.selection.start.offset,0).element.revisions.length>0&&(this.isRepalceTracking=!0),i.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var h=t.end,d=new Z(this.viewer.owner);return d.setPositionParagraph(0===h.currentWidget.children.length?h.currentWidget.paragraph.childWidgets[0]:h.currentWidget,n.offset-e.length),this.documentHelper.selection.selectRange(n,d),this.viewer.owner.trigger(hi,{source:this.viewer.owner}),1},s.prototype.replaceInternal=function(e,t){if(""!==e&&!(0,a.le)(e)){(0,a.le)(t)&&(t="None");var i=this.textSearchResults.currentSearchResult.text,n=this.viewer.owner.searchModule.textSearch.stringToRegex(i,t),r=this.owner.selection.end.getHierarchicalIndexInternal(),o=this.viewer.owner.searchModule.textSearch.findNext(n,t,r);(0,a.le)(o)||(this.navigate(o),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.replace(e,o,this.textSearchResults),r=this.owner.selection.end.getHierarchicalIndexInternal(),(o=this.textSearch.findNext(i,t,r))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.navigate(o)))}},s.prototype.replaceAll=function(e,t){if((0,a.le)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||(0,a.le)(t))return 0;this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll");var i=t.length;this.viewer.owner.isLayoutEnabled=!1;for(var n=t.innerList[0].text,r=i-1;r>=0;r--){var o=t.innerList[r];if(0===o.start.currentWidget.children.length)r=(t=this.textSearch.findAll(n)).length;else{this.navigate(o);var l=!0;r>0&&t.innerList[r-1].start.paragraph.equals(o.start.paragraph)&&(l=!1),this.owner.editorModule.insertTextInternal(e,!0,void 0,l),o.destroy()}}return this.owner.editorHistory&&!(0,a.le)(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),i},s.prototype.replaceAllInternal=function(e,t){(0,a.le)(e)||((0,a.le)(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},s.prototype.navigate=function(e){if(e){var t=e.start,i=e.end;!(0,a.le)(this.owner)&&!(0,a.le)(this.owner.selection)&&!(0,a.le)(t)&&!(0,a.le)(i)&&!(0,a.le)(t.paragraph)&&!(0,a.le)(i.paragraph)&&this.owner.selection.selectRange(t,i)}},s.prototype.highlight=function(e){this.searchHighlighters=new U;for(var t=0;t<e.innerList.length;t++)this.highlightResult(e.innerList[t]);this.viewer.renderVisiblePages()},s.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},s.prototype.highlightSearchResult=function(e,t,i){var n=0,r=0,o=null,l=null,h=this.documentHelper.selection.getStartLineWidget(e,t,o,n);n=h.index;var d=(o=h.element)?o.line:e.childWidgets[0],c=this.documentHelper.selection.getEndLineWidget(i,l,r);r=c.index;var u=(l=c.element)?l.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],p=this.documentHelper.selection.getTop(d),f=this.documentHelper.selection.getLeftInternal(d,o,n);if((0,a.le)(d)||d!==u){if(!(0,a.le)(d)){if(e!==d.paragraph&&(e=d.paragraph),v=this.documentHelper.selection.getWidth(d,!0)-(f-d.paragraph.x),e.bidi||o instanceof S&&o.isRightToLeft){g=0;var x=this.documentHelper.selection.getElementsForward(d,o,l,e.bidi);if(x)for(F=!1,b=0;b<x.length;b++)g=this.documentHelper.selection.getLeftInternal(d,C=x[b],T=C instanceof S?C.length:1),F=!1,f=this.documentHelper.selection.getLeftInternal(d,C,C===o?n:0),C instanceof S&&(F=C.isRightToLeft),v=Math.abs(g-f),this.createHighlightBorder(d,v,F?g:f,p)}else this.createHighlightBorder(d,v,f,p);var P=d.paragraph.childWidgets.indexOf(d);for(b=0;b<e.childWidgets.length;b++){if(e===d.paragraph&&(P+=1),this.highlightSearchResultParaWidget(e,P,u,l,r),e===u.paragraph)return;P=0}}}else{var g=this.documentHelper.selection.getLeftInternal(u,l,r),m=!1;l instanceof S&&(m=l.isRightToLeft);var v=0;if(v=Math.abs(g-f),!m&&o instanceof S&&(m=o.isRightToLeft),m||e.bidi){var y=this.documentHelper.selection.getElementsForward(d,o,l,e.bidi);if(y&&y.length>1)for(var b=0;b<y.length;b++){var C,F=!1,T=(C=y[b])instanceof S?C.length:1;C===o?(f=this.documentHelper.selection.getLeftInternal(d,C,n),g=this.documentHelper.selection.getLeftInternal(d,C,T)):C===l?(f=this.documentHelper.selection.getLeftInternal(d,C,0),g=this.documentHelper.selection.getLeftInternal(d,C,r)):(f=this.documentHelper.selection.getLeftInternal(d,C,0),g=this.documentHelper.selection.getLeftInternal(d,C,T)),C instanceof S&&(F=C.isRightToLeft),v=Math.abs(g-f),this.createHighlightBorder(d,v,F?g:f,p)}else this.createHighlightBorder(d,v,m?g:f,p)}else this.createHighlightBorder(d,v,f,p)}},s.prototype.createHighlightBorder=function(e,t,i,n){var r=this.addSearchHighlightBorder(e);this.viewer.owner.selection.getPage(e.paragraph),r.left=Math.ceil(i),n=Math.ceil(n),r.width=Math.floor(t),Math.floor(e.height)},s.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters;i.containsKey(e)?t=i.get(e):i.add(e,t=[]);var n=new ps(0,0);return t.push(n),n},s.prototype.highlightSearchResultParaWidget=function(e,t,i,n,r){for(var o=0,l=0,h=!1,d=t;d<e.childWidgets.length;d++){var c=e.childWidgets[d];d===t&&(o=this.documentHelper.selection.getTop(c));var u=this.documentHelper.selection.getLeft(c);if(n instanceof S&&(h=n.isRightToLeft),c===i){var p=0;if(h||e.bidi){for(var f=this.documentHelper.selection.getElementsBackward(c,n,n,e.bidi),g=0;g<f.length;g++){var m=f[g],v=!1;u=this.documentHelper.selection.getLeftInternal(c,m,0),p=this.documentHelper.selection.getLeftInternal(c,m,m===n?r:m instanceof S?m.length:1),m instanceof S&&(v=m.isRightToLeft),l=Math.abs(p-u),this.createHighlightBorder(c,l,v?p:u,o)}return}return p=this.documentHelper.selection.getLeftInternal(i,n,r),l=Math.abs(p-u),void this.createHighlightBorder(c,l,h?p:u,o)}l=this.documentHelper.selection.getWidth(c,!0)-(u-e.x),this.createHighlightBorder(c,l,u,o),o+=c.height}},s.prototype.addSearchResultItems=function(e){(0,a.le)(e)||""===e||((0,a.le)(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},s.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++)this.addFindResultViewForSearch(e.innerList[t])},s.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var i=void 0,r=0,o=e.start.currentWidget.getInline(e.start.offset,r),l=o.element;r=o.index;var h="",d=0;if(l instanceof H){var c=this.owner.selection.getRenderedInline(l,r);c.element.nextNode instanceof S?(l=c.element.nextNode,r=c.index):(l=c.element,r=c.index)}var u=this.owner.selection.getElementBoxInternal(l,r),p=u.element;if(r=u.index,null!=p){p instanceof S&&r>0&&(h=p.text.substring(0,r));var f=p.line.children.indexOf(p);for(d=h.lastIndexOf(" ");d<0&&f>0&&p.line.children[f-1]instanceof S;)h=p.line.children[f-1].text+h,f--,d=h.lastIndexOf(" ")}var g=h.lastIndexOf("\v");g>0?h=h.substring(0,g):(d=h.lastIndexOf(" "))<0||h.substring(d+1);var m=0,v=e.end.currentWidget.getInline(e.end.offset,m);if(m=v.index,i="",null!=u&&(p=(u=this.owner.selection.getElementBoxInternal(v.element,m)).element,m=u.index),null!=p)for(p instanceof S&&m<p.length&&(i=p.text.substring(m)),f=p.line.children.indexOf(p);f+1<p.line.children.length&&p.line.children[f+1]instanceof S||p.line.children[f+1]instanceof H;)p.line.children[f+1]instanceof H?f+=2:(i+=p.line.children[f+1].text,f+=1);d=i.lastIndexOf(" "),i="\v"===i?i="":i;var b="",F=e.start.paragraph.containerWidget,T=F instanceof Ce?F.headerFooterType:"";T.indexOf("Header")?b='<span class="e-de-header-footer-list">Header: </span>':T.indexOf("Footer")&&(b='<span class="e-de-header-footer-list">Footer: </span>'),this.addSearchResultItems('<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+b+h+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>")}},s.prototype.clearSearchHighlight=function(){(0,a.le)(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0),this.viewer.owner.trigger(hi,{source:this.viewer.owner})},s.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy(),this.textSearchResults=void 0,this.owner=void 0},s}(),Wr=function(){function s(e){var t=this;this.isOptionsPaneShow=!1,this.findOption="None",this.matchCase=void 0,this.wholeWord=void 0,this.searchText="Navigation",this.resultsText="Results",this.messageDivText="No matches",this.replaceButtonText="Replace",this.replaceAllButtonText="Replace All",this.focusedIndex=-1,this.focusedElement=[],this.isOptionsPane=!0,this.replacePaneText="Replace",this.findPaneText="Find",this.matchDivReplaceText="No matches",this.tabInstance=void 0,this.isReplace=!1,this.searchOptionChange=function(){t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var i=t.searchInput.value;if(""!==i){var n=t.documentHelper.owner.searchModule.textSearch.stringToRegex(i,t.findOption),o=t.documentHelper.selection.end.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(n,t.findOption,o),null!=t.results&&t.results.length>0?t.navigateSearchResult(!1):(t.viewer.renderVisiblePages(),t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="")}},this.onEnableDisableReplaceButton=function(){0!==t.searchInput.value.length?(t.replaceButton.disabled=!1,t.replaceAllButton.disabled=!1):(t.replaceButton.disabled=!0,t.replaceAllButton.disabled=!0)},this.onKeyDownOnOptionPane=function(i){if(9===i.keyCode){i.preventDefault();var n;n=i.shiftKey?0===t.focusedIndex||(0,a.le)(t.focusedIndex)?t.focusedElement.length-1:t.focusedIndex-1:t.focusedElement.length-1===t.focusedIndex||(0,a.le)(t.focusedIndex)?0:t.focusedIndex+1,(r=t.focusedElement[n]).focus(),r instanceof HTMLInputElement&&r.select(),t.focusedIndex=n,r instanceof HTMLLIElement&&t.scrollToPosition(r)}else if(13===i.keyCode){if(t.hideMatchDiv(),i.target!==t.searchInput&&i.target!==t.closeButton&&(i.preventDefault(),-1!==(o=t.focusedElement.indexOf(i.target)))){var l=t.focusedElement[o];l.click(),l.focus(),t.focusedIndex=o}}else if((40===i.keyCode||38===i.keyCode)&&"none"!==t.resultsListBlock.style.display){var o=void 0,r=void 0;40===i.keyCode?t.focusedIndex>7?t.focusedIndex+1<t.focusedElement.length&&((r=t.focusedElement[t.focusedIndex+1]).focus(),t.focusedIndex=t.focusedIndex+1):(o=t.focusedElement.length-t.resultsListBlock.children.length+t.results.currentIndex+1)<t.focusedElement.length&&((r=t.focusedElement[o]).focus(),t.focusedIndex=o):t.focusedIndex>6&&((r=t.focusedElement[o=t.focusedIndex-1]).focus(),t.focusedIndex=o)}},this.onReplaceButtonClick=function(){var n=t.searchInput.value,r=t.replaceWith.value,o=t.documentHelper.owner.searchModule.textSearchResults;if(""!==n&&!(0,a.le)(n)&&null!=t.documentHelper.owner.selection){var l=t.documentHelper.owner.selection.text;if(t.documentHelper.owner.selection.isEmpty||t.documentHelper.owner.selection.selectContent(t.documentHelper.owner.selection.isForward?t.documentHelper.owner.selection.start:t.documentHelper.owner.selection.end,!0),(0,a.le)(o)||(0,a.le)(o.currentSearchResult))t.documentHelper.owner.search.findAll(n,t.findOption),t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText);else{var h=o.currentSearchResult;if(t.documentHelper.owner.searchModule.navigate(h),h.text===l){var d=(0,a.le)(r)?"":r;t.documentHelper.owner.searchModule.replace(d,h,o);var c=t.documentHelper.owner.searchModule.textSearch.stringToRegex(n,t.findOption),p=t.documentHelper.selection.end.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(c,t.findOption,p),(0,a.le)(t.results)||(0,a.le)(t.results.currentSearchResult)?(t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText)):t.documentHelper.owner.searchModule.navigate(t.results.currentSearchResult),t.documentHelper.owner.findResultsList=[],!(0,a.le)(t.results)&&t.results.innerList.length>0?t.navigateSearchResult(!0):t.resultsListBlock.innerHTML=""}else t.documentHelper.owner.search.findAll(n,t.findOption)}}},this.onReplaceAllButtonClick=function(){t.replaceAll(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML=""},this.searchIconClickInternal=function(){var i=document.getElementById(t.documentHelper.owner.containerId+"_option_search_text_box"),n=i.value;if(""!==n){if(t.hideMatchDiv(),t.searchIcon.classList.contains("e-de-op-search-close-icon"))return t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"),i.value="",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.matchDiv.style.display="none",t.occurrenceDiv.style.display="none",t.onEnableDisableReplaceButton(),t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight(),void t.viewer.renderVisiblePages();t.searchIcon.classList.contains("e-de-op-search-icon")&&n.length>=1&&(t.searchIcon.classList.add("e-de-op-search-close-icon"),t.searchIcon.classList.remove("e-de-op-search-icon"),t.onEnableDisableReplaceButton()),t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var r=t.documentHelper.owner.searchModule.textSearch.stringToRegex(n,t.findOption),l=t.documentHelper.selection.end.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(r,t.findOption,l),null!=t.results&&t.results.length>0?(t.documentHelper.scrollToPosition(t.results.innerList[t.results.currentIndex].start,t.results.innerList[t.results.currentIndex].end,!0),t.navigateSearchResult(!1),t.getMessageDivHeight(),t.resultsListBlock.style.height=t.optionsPane.offsetHeight-t.findTab.offsetHeight+"px"):(t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="")}},this.navigateNextResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var i=t.documentHelper.owner.selection.end,n=void 0,r=0;i.isExistAfter(t.results.currentSearchResult.start)&&(r=t.results.currentIndex);for(var o=r;o<t.results.length;o++){var l=t.results.innerList[o];if(i.isExistBefore(l.start)||i.isAtSamePosition(l.start)){n=l,t.results.currentIndex=o;break}}(0,a.le)(n)&&(t.results.currentIndex=0,n=t.results.innerList[0]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(n),t.focusedIndex=t.focusedElement.indexOf(t.navigateToNextResult)}},this.navigatePreviousResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var i=void 0,n=t.documentHelper.owner.selection.start,r=t.results.currentIndex;n.isExistAfter(t.results.currentSearchResult.start)&&(r=t.results.length-1);for(var o=r;o>=0;o--){var l=t.results.innerList[o];if(n.isExistAfter(l.start)||t.documentHelper.owner.selection.end.isAtSamePosition(l.start)){i=l,t.results.currentIndex=o;break}}(0,a.le)(i)&&(t.results.currentIndex=t.results.length-1,i=t.results.innerList[t.results.currentIndex]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(i),t.focusedIndex=t.focusedElement.indexOf(t.navigateToPreviousResult)}},this.onKeyDown=function(i){var n=i.which||i.keyCode;13===n&&9!==i.keyCode&&40!==i.keyCode?(i.preventDefault(),t.findDiv.style.height="",t.onKeyDownInternal()):8===n&&0===t.searchInput.value.length?t.resultContainer.style.display="block":9!==i.keyCode&&40!==i.keyCode&&27!==i.keyCode?(t.documentHelper.owner.searchModule.clearSearchHighlight(),t.clearSearchResultItems(),t.viewer.renderVisiblePages(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.searchIcon.classList.contains("e-de-op-search-close-icon")&&(t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"))):27===n&&27===i.keyCode&&t.showHideOptionsPane(!1)},this.close=function(){t.clearFocusElement(),t.showHideOptionsPane(!1),t.resultsListBlock.innerHTML="",t.focusedIndex=1,t.isOptionsPane=!0},this.resultListBlockClick=function(i){for(var n=i.target,r=t.resultsListBlock.children,o=0,l=0;l<r.length;l++){var h=r[l];h.classList.contains("e-de-search-result-hglt")&&(h.classList.remove("e-de-search-result-hglt"),h.children[0].classList.remove("e-de-op-search-word-text"),h.classList.add("e-de-search-result-item"))}var d;for(l=0;l<r.length;l++)n===r[l]&&(o=l,(d=r[l]).classList.contains("e-de-search-result-item")&&(d.classList.remove("e-de-search-result-item"),d.classList.add("e-de-search-result-hglt"),d.children[0].classList.add("e-de-op-search-word-text"),t.focusedIndex=t.focusedElement.indexOf(d)));var c=t.results.innerList[o];t.results.currentIndex=o,t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(o+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.documentHelper.owner.searchModule.navigate(c),t.documentHelper.owner.searchModule.highlight(t.results),d&&d.focus()},this.documentHelper=e}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"OptionsPane"},s.prototype.initOptionsPane=function(e,t){this.localeValue=e,this.optionsPane=(0,a.az)("div",{className:"e-de-op",styles:"display:none;"}),this.optionsPane.addEventListener("keydown",this.onKeyDownOnOptionPane),this.findTab=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_findTabDiv",className:"e-de-op-tab"}),this.optionsPane.appendChild(this.findTab),this.searchDiv=(0,a.az)("div",{className:"e-de-op-header",innerHTML:e.getConstant(this.searchText)}),this.findTab.appendChild(this.searchDiv),this.closeButton=(0,a.az)("button",{className:"e-de-op-close-button e-de-close-icon e-de-op-icon-btn e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button"}}),this.findTab.appendChild(this.closeButton);var n=(0,a.az)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(n),this.focusedElement.push(this.closeButton);var r=(0,a.az)("div");this.findTab.appendChild(r),this.findTabButton=(0,a.az)("div",{innerHTML:e.getConstant(this.findPaneText)}),this.replaceTabButton=(0,a.az)("div",{innerHTML:e.getConstant(this.replacePaneText)}),this.tabInstance=new tt.OK({items:[{header:{text:this.findTabButton}},{header:{text:this.replaceTabButton}}],enableRtl:t,selected:this.selectedTabItem.bind(this)}),this.tabInstance.isStringTemplate=!0,this.tabInstance.appendTo(r),this.findTabContentDiv=(0,a.az)("div",{className:"e-de-search-tab-content"}),this.findTab.appendChild(this.findTabContentDiv),this.searchTextBoxContainer=(0,a.az)("div",{className:"e-input-group e-de-op-input-group"}),this.findTabContentDiv.appendChild(this.searchTextBoxContainer),this.searchInput=(0,a.az)("input",{className:"e-input e-de-search-input",id:this.documentHelper.owner.containerId+"_option_search_text_box",attrs:{placeholder:e.getConstant("Search for")}}),this.searchTextBoxContainer.appendChild(this.searchInput),this.searchIcon=(0,a.az)("span",{className:"e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon",id:this.documentHelper.owner.containerId+"_search-icon"}),this.searchIcon.tabIndex=0,this.searchTextBoxContainer.appendChild(this.searchIcon),this.focusedElement.push(this.searchIcon),this.navigateToPreviousResult=(0,a.az)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon"}),this.navigateToPreviousResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult),this.focusedElement.push(this.navigateToPreviousResult),this.navigateToNextResult=(0,a.az)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon"}),this.navigateToNextResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToNextResult),this.focusedElement.push(this.navigateToNextResult);var l=(0,a.az)("div",{className:"e-de-op-more-less"});this.matchInput=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_matchCase"}),l.appendChild(this.matchInput),this.matchCase=new M.Jg({label:e.getConstant("Match case"),enableRtl:t,checked:!1,change:this.matchChange.bind(this)}),this.matchCase.appendTo(this.matchInput),this.focusedElement.push(this.matchInput),this.matchInput.tabIndex=0,this.wholeInput=(0,a.az)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_wholeWord"+(t?"_e-de-rtl":"_e-de-ltr")}),l.appendChild(this.wholeInput),this.wholeWord=new M.Jg({label:e.getConstant("Whole words"),enableRtl:t,checked:!1,change:this.wholeWordsChange.bind(this)}),this.wholeWord.appendTo(this.wholeInput),this.focusedElement.push(this.wholeInput),this.wholeInput.tabIndex=0,this.findTab.appendChild(l),this.replaceTabContentDiv=(0,a.az)("div",{className:"e-de-op-replacetabcontentdiv",styles:"display:none;"}),this.findTab.appendChild(this.replaceTabContentDiv),this.createReplacePane(t),this.resultContainer=(0,a.az)("div",{styles:"width:85%;display:block;",className:"e-de-op-result-container"}),this.findTab.appendChild(this.resultContainer),this.messageDiv=(0,a.az)("div",{className:this.documentHelper.owner.containerId+"_messageDiv e-de-op-msg",innerHTML:this.localeValue.getConstant(this.messageDivText),id:this.documentHelper.owner.containerId+"_search_status"}),this.resultContainer.appendChild(this.messageDiv);var d=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_resultDiv"});this.optionsPane.appendChild(d),this.findDiv=(0,a.az)("div",{className:"findDiv",styles:"display:block;"}),d.appendChild(this.findDiv),this.resultsListBlock=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_list_box_container",styles:"display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;",className:"e-de-result-list-block"}),this.findDiv.appendChild(this.resultsListBlock),this.onWireEvents(),t&&(this.optionsPane.classList.add("e-de-rtl"),this.closeButton.classList.add("e-de-rtl"),this.searchDiv.classList.add("e-de-rtl"))},s.prototype.createReplacePane=function(e){var t,i;this.replaceDiv=(0,a.az)("div"),this.replaceTabContentDiv.appendChild(this.replaceDiv),this.replaceWith=(0,a.az)("input",{className:"e-de-op-replacewith e-input",attrs:{placeholder:this.localeValue.getConstant("Replace with")}}),this.replaceDiv.appendChild(this.replaceWith),e?(t="text-align:left",i="margin-left:10px"):(t="text-align:right",i="margin-right:10px");var n=(0,a.az)("div",{styles:t,className:"e-de-op-dlg-footer"});this.replaceDiv.appendChild(n),this.replaceButton=(0,a.az)("button",{className:"e-control e-btn e-flat e-replace",styles:i,innerHTML:this.localeValue.getConstant(this.replaceButtonText),attrs:{type:"button"}}),n.appendChild(this.replaceButton),this.replaceAllButton=(0,a.az)("button",{className:"e-control e-btn e-flat e-replaceall",innerHTML:this.localeValue.getConstant(this.replaceAllButtonText),attrs:{type:"button"}}),n.appendChild(this.replaceAllButton),this.matchDiv=(0,a.az)("div",{styles:"display:none;padding-top:10px;"}),this.replaceDiv.appendChild(this.matchDiv);var r=(0,a.az)("div",{className:"e-de-op-search-replacediv"});this.replaceDiv.appendChild(r),this.occurrenceDiv=(0,a.az)("div",{styles:"display:none;"}),this.replaceDiv.appendChild(this.occurrenceDiv)},s.prototype.selectedTabItem=function(e){var t=this.findTab.getElementsByClassName("e-content").item(0);if(e.previousIndex!==e.selectedIndex){var n=t.children[1],r=t.children[0].firstElementChild;r&&(r.parentElement&&r.parentElement.removeChild(r),n.appendChild(r))}(0,a.le)(t.children[0])||(0===e.selectedIndex?(this.isOptionsPane=!0,this.onFindPane()):(this.isOptionsPane=!1,this.onReplacePane()))},s.prototype.navigateSearchResult=function(e){e&&this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(this.results),this.documentHelper.owner.searchModule.addFindResultView(this.results),this.resultsListBlock.style.display="block",this.resultContainer.style.display="block";for(var t=this.documentHelper.owner.findResultsList,i="",n=0;n<t.length;n++)i+=t[n];for(this.clearFocusElement(),this.resultsListBlock.innerHTML=i,n=0;n<this.resultsListBlock.children.length;n++)this.focusedElement.push(this.resultsListBlock.children[n]);var r=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(r+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var o=this.resultsListBlock.children[r];o.classList.contains("e-de-search-result-item")&&(o.classList.remove("e-de-search-result-item"),o.classList.add("e-de-search-result-hglt"),o.children[0].classList.add("e-de-op-search-word-text"),this.scrollToPosition(o))},s.prototype.wholeWordsChange=function(){this.findOption=this.matchInput.checked&&this.wholeInput.checked?"CaseSensitiveWholeWord":this.matchInput.checked&&!this.wholeInput.checked?"CaseSensitive":!this.matchInput.checked&&this.wholeInput.checked?"WholeWord":"None",this.searchOptionChange()},s.prototype.matchChange=function(){this.findOption=this.matchInput.checked&&this.wholeInput.checked?"CaseSensitiveWholeWord":!this.matchInput.checked&&this.wholeInput.checked?"WholeWord":this.matchInput.checked&&!this.wholeInput.checked?"CaseSensitive":"None",this.searchOptionChange()},s.prototype.onWireEvents=function(){this.searchIcon.addEventListener("click",this.searchIconClickInternal),this.navigateToNextResult.addEventListener("click",this.navigateNextResultButtonClick),this.navigateToPreviousResult.addEventListener("click",this.navigatePreviousResultButtonClick),this.searchInput.addEventListener("keydown",this.onKeyDown),this.searchInput.addEventListener("keyup",this.onEnableDisableReplaceButton),this.resultsListBlock.addEventListener("click",this.resultListBlockClick),this.closeButton.addEventListener("click",this.close),this.replaceButton.addEventListener("click",this.onReplaceButtonClick),this.replaceAllButton.addEventListener("click",this.onReplaceAllButtonClick)},s.prototype.onKeyDownInternal=function(){var e=document.getElementById(this.documentHelper.owner.containerId+"_option_search_text_box");e.blur();var t=e.value;if(""!==t){t.length>=1&&this.searchIcon.classList.contains("e-de-op-search-icon")&&(this.searchIcon.classList.add("e-de-op-search-close-icon"),this.searchIcon.classList.remove("e-de-op-search-icon")),this.clearSearchResultItems(),this.documentHelper.owner.searchModule.clearSearchHighlight();var n=this.documentHelper.owner.searchModule.textSearch.stringToRegex(t,this.findOption),o=this.documentHelper.selection.end.getHierarchicalIndexInternal();this.results=this.documentHelper.owner.searchModule.textSearch.findAll(n,this.findOption,o);var l=this.results;if((0,a.le)(l)&&this.viewer.renderVisiblePages(),null!=l&&l.length>0){-1===this.focusedElement.indexOf(this.navigateToPreviousResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToPreviousResult),-1===this.focusedElement.indexOf(this.navigateToNextResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToNextResult),this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(l),this.documentHelper.owner.searchModule.addFindResultView(l),this.resultContainer.style.display="block",this.resultsListBlock.style.display="block",this.resultsListBlock.style.height=this.optionsPane.offsetHeight-this.findTab.offsetHeight+"px";var d=this.documentHelper.owner.findResultsList,c="";this.clearFocusElement(),this.resultsListBlock.innerHTML="";for(var u=0;u<d.length;u++)c+=d[u];for(this.resultsListBlock.innerHTML=c,u=0;u<this.resultsListBlock.children.length;u++)this.focusedElement.push(this.resultsListBlock.children[u]);var f=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(f+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var g=this.resultsListBlock.children[f];g.classList.contains("e-de-search-result-item")&&(g.classList.remove("e-de-search-result-item"),g.classList.add("e-de-search-result-hglt"),g.children[0].classList.add("e-de-op-search-word-text")),this.navigateToNextResult.focus(),this.focusedIndex=this.focusedElement.indexOf(this.navigateToNextResult),this.getMessageDivHeight()}else this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"),this.resultContainer.style.display="block",this.resultsListBlock.style.display="none",this.clearFocusElement(),this.resultsListBlock.innerHTML=""}},s.prototype.onFindPane=function(){this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",!(0,a.le)(this.results)&&0===this.results.length&&(this.resultsListBlock.innerHTML="",this.resultsListBlock.style.display="none",this.messageDiv.innerHTML=this.localeValue.getConstant("No matches")),this.resultsListBlock.style.height=this.optionsPane.offsetHeight-(this.findTab.offsetHeight-this.replaceTabContentDiv.offsetHeight)+"px",this.replaceTabContentDiv.style.display="none",this.findDiv.style.display="block",this.messageDiv.style.display="block",this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput),this.focusedIndex=1,this.searchInput.select(),this.getMessageDivHeight()},s.prototype.getMessageDivHeight=function(){!this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-msg")?(this.messageDiv.classList.add("e-de-op-replace-messagediv"),this.messageDiv.classList.remove("e-de-op-msg")):this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-replace-messagediv")&&(this.messageDiv.classList.add("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"))},s.prototype.onReplacePane=function(){this.findDiv.style.display="block",this.replaceDiv.style.display="block",this.replaceTabContentDiv.style.display="block",this.resultsListBlock.style.height=this.optionsPane.offsetHeight-this.findTab.offsetHeight+"px",this.isOptionsPane=!1,0!==this.searchInput.value.length?(this.replaceButton.disabled=!1,this.replaceAllButton.disabled=!1):(this.replaceButton.disabled=!0,this.replaceAllButton.disabled=!0),this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.focusedIndex=1,""===this.searchInput.value?this.searchInput.select():this.replaceWith.select(),this.getMessageDivHeight()},s.prototype.replaceAll=function(){var t=this.searchInput.value,i=this.replaceWith.value;if(""!==t&&!(0,a.le)(t)){var n=this.documentHelper.owner.searchModule.textSearch.stringToRegex(t,this.findOption),o=this.documentHelper.selection.end.getHierarchicalIndexInternal(),l=this.documentHelper.owner.searchModule.textSearch.findAll(n,this.findOption,o),h=(0,a.le)(i)?"":i,d=(0,a.le)(l)?0:l.length;this.documentHelper.owner.searchModule.replaceAll(h,l),this.matchDiv.style.display="block",this.matchDiv.innerHTML=this.localeValue.getConstant("All Done")+"!",this.occurrenceDiv.style.display="block",this.occurrenceDiv.innerHTML=this.localeValue.getConstant("We replaced all")+" "+d+" "+this.localeValue.getConstant("instances")+" "+this.localeValue.getConstant("of")+' "'+t+'" '+this.localeValue.getConstant("with")+' "'+i+'" '}},s.prototype.hideMatchDiv=function(){this.matchDiv.style.display="none",this.occurrenceDiv.style.display="none"},s.prototype.updateListItems=function(e){for(var t=this.resultsListBlock.getElementsByClassName("e-de-search-result-hglt"),i=0;i<t.length;i++){var n=t[i];(0,a.s1)(n,["e-de-search-result-item"],["e-de-search-result-hglt"]),(0,a.s1)(n.children[0],[],["e-de-op-search-word-text"])}var r=this.resultsListBlock.children[this.results.currentIndex];(0,a.s1)(r,["e-de-search-result-hglt"],["e-de-search-result-item"]),(0,a.s1)(r.children[0],["e-de-op-search-word-text"],[]),this.scrollToPosition(r),this.documentHelper.owner.searchModule.navigate(e),this.documentHelper.owner.searchModule.highlight(this.results)},s.prototype.scrollToPosition=function(e){var i,t=e.getBoundingClientRect();t.top>0?(i=t.top-e.parentElement.getBoundingClientRect().top,e.parentElement.offsetHeight-i<=e.offsetHeight?(Math.ceil(i+e.offsetHeight)===e.parentElement.scrollHeight&&(e.parentElement.scrollTop=i),e.parentElement.scrollTop=e.parentElement.scrollTop+e.parentElement.offsetHeight/100*30):i<0&&(e.parentElement.scrollTop=e.parentElement.scrollTop-e.parentElement.offsetHeight/100*30)):e.parentElement.scrollTop=0},s.prototype.clearFocusElement=function(){for(var e=0;e<this.resultsListBlock.children.length;e++){var t=this.focusedElement.indexOf(this.resultsListBlock.children[e]);-1!==t&&this.focusedElement.splice(t,1)}this.focusedIndex=1},s.prototype.showHideOptionsPane=function(e){if(!(0,a.le)(this.documentHelper.owner.selectionModule))if(e){this.localeValue=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),(0,a.le)(this.optionsPane)&&(this.initOptionsPane(this.localeValue,this.documentHelper.owner.enableRtl),this.documentHelper.optionsPaneContainer.setAttribute("style",this.documentHelper.owner.enableRtl?"display:inline-flex;direction:rtl;":"display:inline-flex;"),this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.optionsPaneModule.optionsPane,this.documentHelper.viewerContainer)),this.optionsPane.style.display="block",this.documentHelper.owner.isReadOnlyMode?this.tabInstance.hideTab(1):this.tabInstance.hideTab(1,!1),this.isReplace&&!this.documentHelper.owner.isReadOnlyMode?(this.tabInstance.select(1),this.isReplace=!1,this.isOptionsPane=!1):this.tabInstance.select(0),this.searchDiv.innerHTML=this.localeValue.getConstant(this.searchText),this.isOptionsPaneShow=!0;var n=document.getElementById(this.documentHelper.owner.getDocumentEditorElement().id+"_option_search_text_box"),r=this.documentHelper.owner.selection.text;if(!(0,a.le)(r)){var l=w.indexOfAny(r,["\v","\r"]);r=l<0?r:r.substring(0,l)}n.value=r,n.select(),this.messageDiv.innerHTML="",this.searchIcon.classList.contains("e-de-op-search-close-icon")&&(this.searchIcon.classList.add("e-de-op-search-icon"),this.searchIcon.classList.remove("e-de-op-search-close-icon")),this.documentHelper.selection.caret.style.display="none",this.focusedIndex=1,this.focusedElement=[],this.isOptionsPane?this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput):this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.documentHelper.updateViewerSize()}else{if(!(0,a.le)(this.optionsPane)){this.clearSearchResultItems(),this.documentHelper.owner.searchModule.clearSearchHighlight(),this.isOptionsPaneShow=!1;var h=document.getElementById(this.documentHelper.owner.containerId+"_list_box_container"),d=document.getElementById(this.documentHelper.owner.containerId+"_search_status");!(0,a.le)(h)&&!(0,a.le)(d)&&(h.style.display="none",this.clearFocusElement(),h.innerHTML="",d.innerHTML=this.localeValue.getConstant("No matches"))}this.documentHelper.updateViewerSize(),(0,a.le)(this.optionsPane)||"none"!==this.optionsPane.style.display&&(this.documentHelper.selection.updateCaretPosition(),this.optionsPane.style.display="none"),this.documentHelper.updateFocus(),this.documentHelper.selection.caret.style.display="block"}},s.prototype.clearSearchResultItems=function(){(0,a.le)(this.documentHelper.owner.findResultsList)||(this.documentHelper.owner.findResultsList=[])},s.prototype.destroy=function(){this.optionsPane&&(this.optionsPane.innerHTML="",this.optionsPane=void 0),this.resultsListBlock&&(this.resultsListBlock.innerHTML="",this.resultsListBlock=void 0),this.messageDiv&&(this.messageDiv.innerHTML="",this.messageDiv=void 0),this.resultContainer&&(this.resultContainer.innerHTML=""),this.resultContainer=void 0,this.searchInput&&(this.searchInput.value="",this.searchInput=void 0),this.searchDiv&&(this.searchDiv.innerHTML="",this.searchDiv=void 0),this.searchTextBoxContainer&&(this.searchTextBoxContainer.innerHTML="",this.searchTextBoxContainer=void 0),this.replaceWith&&(this.replaceWith.innerHTML="",this.replaceWith=void 0),this.findDiv&&(this.findDiv.innerHTML="",this.findDiv=void 0),this.replaceButton&&(this.replaceButton.innerHTML="",this.replaceButton=void 0),this.replaceAllButton&&(this.replaceAllButton.innerHTML="",this.replaceAllButton=void 0),this.matchInput&&(this.matchInput.innerHTML="",this.matchCase=void 0),this.wholeInput&&(this.wholeInput.innerHTML="",this.wholeWord=void 0),(0,a.le)(this.results)||this.results.destroy(),this.focusedElement&&(this.focusedElement=[]),this.focusedElement=void 0,this.destroyInternal(),this.documentHelper=void 0},s.prototype.destroyInternal=function(){this.searchText&&(this.searchText=void 0),this.resultsText&&(this.resultsText=void 0),this.messageDivText&&(this.messageDivText=void 0),this.replaceButtonText&&(this.replaceButtonText=void 0),this.replaceAllButtonText&&(this.replaceAllButtonText=void 0)},s}(),Rr=function(){function s(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}return Object.defineProperty(s.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return this.fontSize>=1?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},s.prototype.notifyPropertyChanged=function(e){if(((0,a.le)(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!(0,a.le)(this.selection)&&!(0,a.le)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);(0,a.le)(t)||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)}},s.prototype.copyFormat=function(e){this.styleName=(0,a.le)(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps},s.prototype.combineFormat=function(e){!(0,a.le)(this.bold)&&this.bold!==e.bold&&(this.bold=void 0),!(0,a.le)(this.italic)&&this.italic!==e.italic&&(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),!(0,a.le)(this.fontFamily)&&this.fontFamily!==e.fontFamily&&(this.fontFamily=void 0),!(0,a.le)(this.highlightColor)&&this.highlightColor!==e.highlightColor&&(this.highlightColor=void 0),!(0,a.le)(this.baselineAlignment)&&this.baselineAlignment!==e.baselineAlignment&&(this.baselineAlignment=void 0),!(0,a.le)(this.fontColor)&&this.fontColor!==e.fontColor&&(this.fontColor=void 0),!(0,a.le)(this.underline)&&this.underline!==e.underline&&(this.underline=void 0),!(0,a.le)(this.strikethrough)&&this.strikethrough!==e.strikethrough&&(this.strikethrough=void 0),!(0,a.le)(this.boldBidi)&&this.boldBidi!==e.boldBidi&&(this.boldBidi=void 0),!(0,a.le)(this.italicBidi)&&this.italicBidi!==e.italicBidi&&(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),!(0,a.le)(this.fontFamilyBidi)&&this.fontFamilyBidi!==e.fontFamilyBidi&&(this.fontFamilyBidi=void 0),!(0,a.le)(this.bidi)&&this.bidi!==e.bidi&&(this.bidi=void 0),!(0,a.le)(this.bdo)&&this.bdo!==e.bdo&&(this.bdo=void 0),!(0,a.le)(this.allCaps)&&this.allCaps!==e.allCaps&&(this.allCaps=void 0)},s.prototype.canRetrieveNextCharacterFormat=function(){return!((0,a.le)(this.bold)&&(0,a.le)(this.italic)&&0===this.fontSize&&(0,a.le)(this.fontFamily)&&(0,a.le)(this.highlightColor)&&(0,a.le)(this.baselineAlignment)&&(0,a.le)(this.fontColor)&&(0,a.le)(this.underline)&&(0,a.le)(this.strikethrough)&&(0,a.le)(this.boldBidi)&&(0,a.le)(this.italicBidi)&&0===this.fontSizeBidi&&(0,a.le)(this.fontFamilyBidi)&&(0,a.le)(this.bdo)&&(0,a.le)(this.allCaps))},s.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps},s.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},s.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},s.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},s}(),St=function(){function s(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}return Object.defineProperty(s.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),s.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},s.prototype.combineFormat=function(e){!(0,a.le)(this.color)&&this.color!==e.color&&(this.color=void 0),!(0,a.le)(this.lineStyle)&&this.lineStyle!==e.lineStyle&&(this.lineStyle=void 0),!(0,a.le)(this.lineWidth)&&this.lineWidth!==e.lineWidth&&(this.lineWidth=void 0),!(0,a.le)(this.shadow)&&this.shadow!==e.shadow&&(this.shadow=void 0),!(0,a.le)(this.space)&&this.space!==e.space&&(this.space=void 0)},s.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},s.prototype.notifyPropertyChanged=function(e){if(((0,a.le)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!(0,a.le)(this.selection)&&!(0,a.le)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule,i=this.getPropertyValue(e);(0,a.le)(i)||t.applyParagraphBorders(e,this.borderType,i)}},s.prototype.destroy=function(){(0,a.le)(this.colorIn)||(this.colorIn=void 0),(0,a.le)(this.lineStyleIn)||(this.lineStyleIn=void 0),(0,a.le)(this.lineWidthIn)||(this.lineWidthIn=void 0),(0,a.le)(this.spaceIn)||(this.spaceIn=void 0),(0,a.le)(this.shadowIn)||(this.shadowIn=void 0)},s}(),ms=function(){function s(e,t){this.ownerBase=void 0,this.ownerBase=t,this.selection=e,this.topIn=new St(this.selection,"topBorder",this),this.bottomIn=new St(this.selection,"bottomBorder",this),this.rightIn=new St(this.selection,"rightBorder",this),this.leftIn=new St(this.selection,"leftBorder",this),this.horizontalIn=new St(this.selection,"horizontalBorder",this),this.verticalIn=new St(this.selection,"verticalBorder",this)}return Object.defineProperty(s.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),s.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},s.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},s.prototype.destroy=function(){(0,a.le)(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),(0,a.le)(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),(0,a.le)(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),(0,a.le)(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),(0,a.le)(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),(0,a.le)(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)},s}(),vs=function(){function s(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new ms(this.selection,this)}return Object.defineProperty(s.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),s.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(s.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof ft&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof nt)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var n=0;n<9;n++)if(e.indexOf("%"+(n+1))>-1){n===this.listLevelNumberIn||t.getListLevel(n);var l=this.selection.getListTextElementBox(this.selection.start.paragraph);e=l?l.text:""}}}return e},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"contextualSpacing":return this.contextualSpacing;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;default:return}},s.prototype.notifyPropertyChanged=function(e){if(((0,a.le)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!(0,a.le)(this.selection)&&!(0,a.le)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var i=this.selection.owner.editorHistory;if((!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing()){if(this.selection.owner.editorHistory.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e){this.lineSpacingTypeIn="Multiple";var n=this.getPropertyValue("lineSpacingType");t.onApplyParagraphFormat("lineSpacingType",n,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)}else t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1);return void this.selection.owner.editorHistory.updateComplexHistory()}}var r=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||r>=-1056&&r<1056))return;"listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,r,"textAlignment"===e,!1)}},s.prototype.copyFormat=function(e){this.styleName=(0,a.le)(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),(0,a.le)(e.listFormat)||(0,a.le)(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},s.prototype.copyToFormat=function(e){(0,a.le)(e)||((0,a.le)(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),(0,a.le)(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),(0,a.le)(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),(0,a.le)(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),(0,a.le)(this.leftIndent)||(e.leftIndent=this.leftIndent),(0,a.le)(this.rightIndent)||(e.rightIndent=this.rightIndent),(0,a.le)(this.textAlignment)||(e.textAlignment=this.textAlignment),(0,a.le)(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),(0,a.le)(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),(0,a.le)(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),(0,a.le)(this.bidi)||(e.bidi=this.bidi),(0,a.le)(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),(0,a.le)(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),(0,a.le)(this.widowControl)||(e.widowControl=this.widowControl),(0,a.le)(this.contextualSpacing)||(e.contextualSpacing=this.contextualSpacing))},s.prototype.combineFormat=function(e){!(0,a.le)(this.leftIndent)&&this.leftIndent!==e.leftIndent&&(this.leftIndent=void 0),!(0,a.le)(this.rightIndent)&&this.rightIndent!==e.rightIndent&&(this.rightIndent=void 0),!(0,a.le)(this.firstLineIndent)&&this.firstLineIndent!==e.firstLineIndent&&(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),!(0,a.le)(this.spaceAfterAuto)&&this.spaceAfterAuto!==e.spaceAfterAuto&&(this.spaceAfterAuto=void 0),!(0,a.le)(this.spaceBeforeAuto)&&this.spaceBeforeAuto!==e.spaceBeforeAuto&&(this.spaceBeforeAuto=void 0),!(0,a.le)(this.lineSpacingType)&&this.lineSpacingType!==e.lineSpacingType&&(this.lineSpacingType=void 0),!(0,a.le)(this.textAlignment)&&this.textAlignment!==e.textAlignment&&(this.textAlignment=void 0),this.listLevelNumber>=0&&!(0,a.le)(this.listId)&&((0,a.le)(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),((0,a.le)(e.listFormat)||(0,a.le)(e.listFormat.listId)||!(0,a.le)(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),!(0,a.le)(this.bidi)&&this.bidi!==e.bidi&&(this.bidi=void 0),!(0,a.le)(this.keepLinesTogether)&&this.keepLinesTogether!==e.keepLinesTogether&&(this.keepLinesTogether=void 0),!(0,a.le)(this.keepWithNext)&&this.keepWithNext!==e.keepWithNext&&(this.keepWithNext=void 0),!(0,a.le)(this.widowControl)&&this.widowControl!==e.widowControl&&(this.widowControl=void 0),!(0,a.le)(this.contextualSpacing)&&this.contextualSpacing!==e.contextualSpacing&&(this.contextualSpacing=void 0),!(0,a.le)(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},s.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},s.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!(0,a.le)(e)){var t=new ft,i=new et,n=this.documentHelper.getAbstractListById(e.abstractListId),r=this.selection.owner.editorModule;if((0,a.le)(n))i.levels.push(new nt(i));else for(var o=0;o<n.levels.length;o++){var l=r.cloneListLevel(n.levels[o]);i.levels.push(l),l.ownerBase=i}if(!(0,a.le)(e.levelOverrides))for(o=0;o<e.levelOverrides.length;o++){var h=r.cloneLevelOverride(e.levelOverrides[o]);t.levelOverrides.push(h)}return t.abstractList=i,t.abstractListId=i.abstractListId,t.sourceListId=e.listId,t}},s.prototype.setList=function(e,t){if((!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded){var i=this.documentHelper.getListById(this.listId),n=void 0,r=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0;if((0,a.le)(i)||(0,a.le)(e)||(0,a.le)(r)||e.sourceListId!==i.listId)(0,a.le)(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,!(0,a.le)(r)&&-1===this.documentHelper.abstractLists.indexOf(r)&&this.documentHelper.abstractLists.push(r),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var o=this.documentHelper.owner.editorHistory;this.documentHelper.layout.getListLevel(i,1),this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),o&&(n=o.updateListChangesInHistory(r,i)),this.documentHelper.owner.editorModule.updateListParagraphs(),o&&o.applyListChanges(this.selection,n),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],t&&this.documentHelper.layout.clearInvalidList(e),this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),o&&o.currentBaseHistoryInfo&&(o.currentBaseHistoryInfo.modifiedProperties.length>0&&o.currentBaseHistoryInfo.updateSelection(),o.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()}}},s.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,(0,a.le)(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)},s}(),ys=function(){function s(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e}return Object.defineProperty(s.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),s.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber},s.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(((0,a.le)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!(0,a.le)(t)&&!(0,a.le)(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);(0,a.le)(i)||t.owner.editorModule.onApplySectionFormat(e,i)}},s.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":return this.pageHeight>0?this.pageHeight:void 0;case"pageWidth":return this.pageWidth>0?this.pageWidth:void 0;case"leftMargin":return this.leftMargin>=0?this.leftMargin:void 0;case"rightMargin":return this.rightMargin>=0?this.rightMargin:void 0;case"topMargin":return this.topMargin>=0?this.topMargin:void 0;case"bottomMargin":return this.bottomMargin>=0?this.bottomMargin:void 0;case"differentFirstPage":return(0,a.le)(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return(0,a.le)(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return(0,a.le)(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return(0,a.le)(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;default:return}},s.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),!(0,a.le)(this.differentFirstPage)&&this.differentFirstPage!==e.differentFirstPage&&(this.differentFirstPage=void 0),!(0,a.le)(this.pageStartingNumber)&&this.pageStartingNumber!==e.pageStartingNumber&&(this.pageStartingNumber=void 0),!(0,a.le)(this.restartPageNumbering)&&this.restartPageNumbering!==e.restartPageNumbering&&(this.restartPageNumbering=void 0),!(0,a.le)(this.differentOddAndEvenPages)&&this.differentOddAndEvenPages!==e.differentOddAndEvenPages&&(this.differentOddAndEvenPages=void 0),!(0,a.le)(this.bidi)&&this.bidi!==e.bidi&&(this.bidi=void 0),!(0,a.le)(this.endnoteNumberFormat)&&this.endnoteNumberFormat!==e.endnoteNumberFormat&&(this.endnoteNumberFormat=void 0),!(0,a.le)(this.restartIndexForEndnotes)&&this.restartIndexForEndnotes!==e.restartIndexForEndnotes&&(this.restartIndexForEndnotes=void 0),!(0,a.le)(this.restartIndexForFootnotes)&&this.restartIndexForFootnotes!==e.restartIndexForFootnotes&&(this.restartIndexForFootnotes=void 0),!(0,a.le)(this.footNoteNumberFormat)&&this.footNoteNumberFormat!==e.footNoteNumberFormat&&(this.footNoteNumberFormat=void 0),!(0,a.le)(this.initialFootNoteNumber)&&this.initialFootNoteNumber!==e.initialFootNoteNumber&&(this.initialFootNoteNumber=void 0),!(0,a.le)(this.initialEndNoteNumber)&&this.initialEndNoteNumber!==e.initialEndNoteNumber&&(this.initialEndNoteNumber=void 0)},s.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},s.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0},s}(),bs=function(){function s(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}return Object.defineProperty(s.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new ot;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;default:return}},s.prototype.notifyPropertyChanged=function(e){if(((0,a.le)(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!(0,a.le)(this.selection)&&!(0,a.le)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);"background"===e&&(e="shading"),(0,a.le)(t)||this.selection.owner.editorModule.onApplyTableFormat(e,t)}},s.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi},s.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},s.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0},s}(),ws=function(){function s(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(s.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),s.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(!(0,a.le)(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;if(!(0,a.le)(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);"background"===e&&(e="shading"),(0,a.le)(i)||this.selection.owner.editorModule.onApplyTableCellFormat(e,i)}}},s.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new ot;return t.backgroundColor=this.background,t;default:return}},s.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},s.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},s.prototype.combineFormat=function(e){!(0,a.le)(this.leftMargin)&&this.leftMargin!==e.leftMargin&&(this.leftMargin=void 0),!(0,a.le)(this.topMargin)&&this.topMargin!==e.topMargin&&(this.topMargin=void 0),!(0,a.le)(this.rightMargin)&&this.rightMargin!==e.rightMargin&&(this.rightMargin=void 0),!(0,a.le)(this.bottomMargin)&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=void 0),!(0,a.le)(this.background)&&this.background!==e.shading.backgroundColor&&(this.background=void 0),!(0,a.le)(this.verticalAlignment)&&this.verticalAlignment!==e.verticalAlignment&&(this.verticalAlignment=void 0),!(0,a.le)(this.preferredWidth)&&this.preferredWidth!==e.preferredWidth&&(this.preferredWidth=void 0),!(0,a.le)(this.preferredWidthType)&&this.preferredWidthType!==e.preferredWidthType&&(this.preferredWidthType=void 0)},s.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},s.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},s}(),Cs=function(){function s(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(s.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),s.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(((0,a.le)(t)||!t.isCleared&&!t.owner.isReadOnlyMode&&t.owner.isDocumentLoaded&&!t.owner.isPastingContent||t.isRetrieveFormatting)&&!(0,a.le)(t)&&!(0,a.le)(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyValue(e);(0,a.le)(i)||t.owner.editorModule.onApplyTableRowFormat(e,i)}},s.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},s.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},s.prototype.combineFormat=function(e){!(0,a.le)(this.height)&&this.height!==e.height&&(this.height=void 0),!(0,a.le)(this.heightType)&&this.heightType!==e.heightType&&(this.heightType=void 0),!(0,a.le)(this.allowBreakAcrossPages)&&this.allowBreakAcrossPages!==e.allowBreakAcrossPages&&(this.allowBreakAcrossPages=void 0),!(0,a.le)(this.isHeader)&&this.isHeader!==e.isHeader&&(this.isHeader=void 0)},s.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},s.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},s.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},s}(),Fs=function(){function s(e){this.selection=e}return Object.defineProperty(s.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),s.prototype.resize=function(e,t){this.updateImageFormat(e,t)},s.prototype.updateImageFormat=function(e,t){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t)},s.prototype.copyImageFormat=function(e){this.image=e},s.prototype.clearImageFormat=function(){this.image=void 0},s}(),xs=function(){function s(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.fieldCheck=0}return s.prototype.writeHtml=function(e){this.document=e;for(var t="",i=0;i<e.sections.length;i++)t+=this.serializeSection(e.sections[i]);return t},s.prototype.serializeSection=function(e){for(var t="",i=0;i<e.blocks.length;i++){var n=e.blocks[i];n.hasOwnProperty("inlines")?t+=this.serializeParagraph(n):n.hasOwnProperty("blocks")?t+=this.serializeSection(n):(t+=this.closeList(),t+=this.serializeTable(n))}return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},s.prototype.serializeParagraph=function(e){var t="",i=!1,n=!1;(0,a.le)(this.prevListLevel)||(n=!0);var r=[],o=void 0;return(0,a.le)(e.paragraphFormat.listFormat)||(o=this.getListLevel(e),n||(this.prevListLevel=o),this.prevListLevel!==o&&(n=!1),this.prevListLevel=o),n||(t+=this.closeList()),(0,a.le)(o)||(i=!0),i&&!n&&(t+=this.getHtmlList(o,e.paragraphFormat.listFormat.listLevelNumber)),r.push('style="'+this.serializeParagraphStyle(e,"",i)+';white-space:pre"'),i?t+=this.createAttributesTag("li",r):(this.prevListLevel=void 0,this.isOrdered=void 0,t+=this.createAttributesTag(this.getStyleName(e.paragraphFormat.styleName),r)),0===e.inlines.length?t+="&nbsp":t=this.serializeInlines(e,t),i?(t+=this.endTag("li")).indexOf("<ul")>-1?this.isOrdered=!1:t.indexOf("<ol")>-1&&(this.isOrdered=!0):t+=this.endTag(this.getStyleName(e.paragraphFormat.styleName)),t},s.prototype.closeList=function(){var e="";return(0,a.le)(this.isOrdered)||(e=this.endTag(this.isOrdered?"ol":"ul"),this.isOrdered=void 0),e},s.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,n=0;n<this.document.lists.length;n++)if(this.document.lists[n].listId===e.paragraphFormat.listFormat.listId){i=this.document.lists[n];break}if(i)for(var r=0;r<this.document.abstractLists.length;r++)if(this.document.abstractLists[r].abstractListId===i.abstractListId){t=this.document.abstractLists[r].levels[e.paragraphFormat.listFormat.listLevelNumber];break}return t},s.prototype.getHtmlList=function(e,t){var i="";if("Bullet"===e.listLevelPattern){switch(i+='<ul type="',t){case 0:default:i+="disc",e.characterFormat.fontFamily="Symbol";break;case 1:i+="circle",e.characterFormat.fontFamily="Symbol";break;case 2:i+="square",e.characterFormat.fontFamily="Wingdings"}i+='">'}else{switch(i+='<ol type="',e.listLevelPattern){case"LowLetter":i+="a";break;case"UpLetter":i+="A";break;case"LowRoman":i+="i";break;case"UpRoman":i+="I";break;default:i+="1"}i+='" start="'+e.startAt.toString()+'">'}return i},s.prototype.serializeInlines=function(e,t){for(var i=void 0,n=0;e.inlines.length>n;)if((i=e.inlines[n]).hasOwnProperty("inlines"))t+=this.serializeContentInlines(i,t),n++;else{if(i.hasOwnProperty("imageString"))t+=this.serializeImageContainer(i);else if(i.hasOwnProperty("fieldType"))if(0===i.fieldType){var r=e.inlines[n+1];if((0,a.le)(r.text)&&(r=e.inlines[n+2]),(0,a.le)(r)||(0,a.le)(r.text)||!(r.text.indexOf("TOC")>=0||r.text.indexOf("HYPERLINK")>=0))this.fieldCheck=void 0;else{this.fieldCheck=1;var o=[];o.push('style="'+this.serializeInlineStyle(i.characterFormat)+'"'),t+=this.createAttributesTag("a",o)}}else 2===i.fieldType?this.fieldCheck=(0,a.le)(this.fieldCheck)?0:2:(!(0,a.le)(this.fieldCheck)&&0!==this.fieldCheck&&(t+=this.endTag("a")),this.fieldCheck=0);else{var l=(0,a.le)(i.text)?"":i.text;if(i.hasOwnProperty("bookmarkType"))switch(i.bookmarkType){case 0:t+="<a name="+i.name+">";break;case 1:t+="</a>"}0===this.fieldCheck&&(t+=this.serializeSpan(l,i.characterFormat)),1===this.fieldCheck&&(t+=' href= "'+l.replace(/"/g,"").replace("HYPERLINK","").trim(),t+='"',t+=">"),2===this.fieldCheck&&(t+=l)}n++}return t},s.prototype.serializeContentInlines=function(e,t){return t+this.serializeInlines(e,t)},s.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return(i+="<br>").toString();if(-1!==e.indexOf("\f"))return(i+='<br style = "page-break-after:always;"/>').toString();var n=[];return this.serializeInlineStyle(t),n.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",n),i+=this.decodeHtmlNames(e.toString()),(i+=this.endTag("span")).toString()},s.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},s.prototype.serializeImageContainer=function(e){var t="",i=[];this.serializeInlineStyle(e.characterFormat);var n="";(0,a.le)(e.imageString)||(n=e.imageString);var r=w.convertPointToPixel(e.width),o=w.convertPointToPixel(e.height);return i.push('width="'+r.toString()+'"'),i.push('height="'+o.toString()+'"'),i.push('src="'+n+'"'),t+=this.createAttributesTag("img",i),(t+=this.endTag("img")).toString()},s.prototype.serializeCell=function(e){var t="",i=[],n="";if(i=[],!(0,a.le)(e.cellFormat)){if(!(0,a.le)(e.cellFormat.shading.backgroundColor)&&"empty"!==e.cellFormat.shading.backgroundColor&&i.push('bgcolor="'+w.getColor(e.cellFormat.shading.backgroundColor)+'"'),!(0,a.le)(e.cellFormat.columnSpan)&&e.cellFormat.columnSpan>1&&i.push('colspan="'+e.cellFormat.columnSpan.toString()+'"'),!(0,a.le)(e.cellFormat.rowSpan)&&e.cellFormat.rowSpan>1&&i.push('rowspan="'+e.cellFormat.rowSpan.toString()+'"'),!(0,a.le)(e.cellFormat.cellWidth)&&0!==e.cellFormat.cellWidth){var r=w.convertPointToPixel(e.cellFormat.cellWidth);i.push('width="'+r.toString()+'"')}var o=(0,a.le)(e.cellFormat.verticalAlignment)?"top":this.convertVerticalAlignment(e.cellFormat.verticalAlignment);i.push('valign="'+o+'"'),!(0,a.le)(e.cellFormat.leftMargin)&&0!==e.cellFormat.leftMargin&&(n+="padding-left:"+e.cellFormat.leftMargin.toString()+"pt;"),!(0,a.le)(e.cellFormat.rightMargin)&&0!==e.cellFormat.rightMargin&&(n+="padding-right:"+e.cellFormat.rightMargin.toString()+"pt;"),!(0,a.le)(e.cellFormat.topMargin)&&0!==e.cellFormat.topMargin&&(n+="padding-top:"+e.cellFormat.topMargin.toString()+"pt;"),!(0,a.le)(e.cellFormat.bottomMargin)&&0!==e.cellFormat.bottomMargin&&(n+="padding-bottom:"+e.cellFormat.bottomMargin.toString()+"pt;"),(0,a.le)(e.cellFormat.borders)||(n+=this.serializeCellBordersStyle(e.cellFormat.borders))}0!==n.length&&i.push('style="'+n+'"'),t+=this.createAttributesTag("td",i);for(var l=0;l<e.blocks.length;l++){var h=e.blocks[l];h.hasOwnProperty("rows")?t+=this.serializeTable(h):t+=this.serializeParagraph(h)}return t+this.endTag("td")},s.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":return"middle";case"Bottom":return"bottom";default:return"top"}},s.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e.rows.length;i++)t+=this.serializeRow(e.rows[i]);return t+this.createTableEndTag()},s.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e.cells.length;i++)t+=this.serializeCell(e.cells[i]);return t},s.prototype.serializeParagraphStyle=function(e,t,i){var n="";return e.inlines.length>0&&(n+=this.serializeCharacterFormat(e.characterFormat)),n+this.serializeParagraphFormat(e.paragraphFormat,i)},s.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},s.prototype.serializeTableBorderStyle=function(e){var t="",i={};return(0,a.le)(i=e.left)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-left-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"left")),(0,a.le)(i=e.top)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-top-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"top")),(0,a.le)(i=e.right)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-right-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"right")),(0,a.le)(i=e.bottom)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-bottom-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"bottom")),t},s.prototype.serializeCellBordersStyle=function(e){var t="",i={};return(0,a.le)(i=e.left)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-left-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"left")),(0,a.le)(i=e.top)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-top-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"top")),(0,a.le)(i=e.right)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-right-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"right")),(0,a.le)(i=e.bottom)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!(0,a.le)(i)&&i.hasNoneStyle&&(t+="border-bottom-style:none;"):(i.color=(0,a.le)(i.color)?"#000000":i.color,i.lineWidth=(0,a.le)(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"bottom")),t},s.prototype.serializeBorderStyle=function(e,t){var i="";return i+="border-"+t+"-style:"+this.convertBorderLineStyle(e.lineStyle),i+=";",e.lineWidth>0&&(i+="border-"+t+"-width:"+e.lineWidth.toString()+"pt;"),(0,a.le)(e.color)||(i+="border-"+t+"-color:"+w.getColor(e.color)+";"),i},s.prototype.convertBorderLineStyle=function(e){switch(e){case"None":return"none";case"Single":case"SingleWavy":case"DashDotStroked":default:return"solid";case"Dot":return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"DoubleWavy":return"double";case"Emboss3D":return"ridge";case"Engrave3D":return"groove";case"Outset":return"outset";case"Inset":return"inset"}},s.prototype.serializeCharacterFormat=function(e){if(!(0,a.le)(e.inlineFormat))return this.serializeCharacterFormat(e.inlineFormat);var t,i="";return i+="font-weight",i+=":",i+=e.bold?"bold":"normal",i+=";",i+="font-style",i+=":",i+=e.italic?"italic":"normal",i+=";",i+=this.serializeTextDecoration(e),("Superscript"===e.baselineAlignment||"Subscript"===e.baselineAlignment)&&(i+="vertical-align",i+=":",i+="Superscript"===e.baselineAlignment?"super":"sub",i+=";"),!(0,a.le)(e.highlightColor)&&"NoColor"!==e.highlightColor&&(i+="background-color",i+=":",i+=w.getHighlightColorCode(e.highlightColor.toString()),i+=";"),(0,a.le)(t=e.fontColor)||(i+="color",i+=":",i+=w.getColor(t),i+=";"),!(0,a.le)(e.allCaps)&&e.allCaps&&(i+="text-transform",i+=":",i+="uppercase",i+=";"),(0,a.le)(t=e.fontSize)||(i+="font-size",i+=":",i+=t.toString(),i+="pt",i+=";"),(0,a.le)(t=e.fontFamily)||(i+="font-family",i+=":",i+=t.toString(),i+=";"),i.toString()},s.prototype.serializeTextDecoration=function(e){var i="";return("SingleStrike"===e.strikethrough||"DoubleStrike"===e.strikethrough)&&(i+="line-through "),!(0,a.le)(e.underline)&&"None"!==e.underline&&(i+="underline"),i.length>1&&(i="text-decoration:"+i+";"),i},s.prototype.serializeParagraphFormat=function(e,t){if(!(0,a.le)(e.inlineFormat))return this.serializeParagraphFormat(e.inlineFormat,t);var i,n="";return(0,a.le)(i=e.textAlignment)||(n+="text-align:"+i.toLowerCase()+";"),(0,a.le)(i=e.beforeSpacing)||(n+="margin-top:"+i.toString()+"pt; "),(0,a.le)(i=e.rightIndent)||(n+="margin-right:"+i.toString()+"pt; "),(0,a.le)(i=e.afterSpacing)||(n+="margin-bottom:"+i.toString()+"pt; "),i=e.leftIndent,t&&(i=0),(0,a.le)(i)||(n+="margin-left:"+i.toString()+"pt; "),i=e.firstLineIndent,t&&(i=0),!(0,a.le)(i)&&0!==i&&(n+="text-indent:"+i.toString()+"pt;"),(0,a.le)(i=e.lineSpacing)||(n+="line-height:"+(i="Multiple"===e.lineSpacingType?Math.round(10*i)/10:i.toString()+"pt;")),n.toString()},s.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var n=0;n<t.length;n++)i+=" ",i+=t[n];return"a"!==e&&(i+=">"),i},s.prototype.createTag=function(e){var t="";return t+="<",(t+=e)+">"},s.prototype.endTag=function(e){var t="";return t+="<",t+="/",(t+=e)+">"},s.prototype.createTableStartTag=function(e){var i="",n=[];return(0,a.le)(e.tableFormat)||(!(0,a.le)(e.tableFormat.shading)&&!(0,a.le)(e.tableFormat.shading.backgroundColor)&&"empty"!==e.tableFormat.shading.backgroundColor&&n.push('bgcolor="'+w.getColor(e.tableFormat.shading.backgroundColor)+'"'),!(0,a.le)(e.tableFormat.cellSpacing)&&e.tableFormat.cellSpacing>0?n.push('cellspacing="'+(72*e.tableFormat.cellSpacing/96*2).toString()+'"'):i+="border-collapse:collapse;",n.push('cellpadding="0"'),!(0,a.le)(e.tableFormat.leftIndent)&&0!==e.tableFormat.leftIndent&&"Left"===e.tableFormat.tableAlignment&&(i+="margin-left:"+e.tableFormat.leftIndent.toString()+"pt;"),(0,a.le)(e.tableFormat)||(i+=this.serializeTableWidth(e.tableFormat)),(0,a.le)(e.tableFormat.borders)||(i+=this.serializeTableBorderStyle(e.tableFormat.borders))),0!==i.length&&n.push('style="',i.toString()+'"'),""+this.createAttributesTag("table",n)},s.prototype.serializeTableWidth=function(e){var t="";switch(e.preferredWidthType){case"Percent":t+="width: "+e.preferredWidth.toString()+"%;";break;case"Point":t+="width: "+e.preferredWidth.toString()+"pt;";break;case"Auto":t+="width: auto;"}return t},s.prototype.createTableEndTag=function(){return""+this.endTag("table")},s.prototype.createRowStartTag=function(e){var t="",i=[];if(e.rowFormat.isHeader&&(t+=this.createTag("thead")),!(0,a.le)(e.rowFormat.height)&&e.rowFormat.height>0){var n=w.convertPointToPixel(e.rowFormat.height);i.push('height="'+n+'"')}return t+this.createAttributesTag("tr",i)},s.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),e.rowFormat.isHeader&&(t+=this.endTag("thead")),t},s.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="";if(t.length>0){i=t[0];for(var n=0;n<t.length-1;n++)i+=" "+t[n+1]}return i},s}(),Nr=function(){function s(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.editRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.isFormatUpdated=!1,this.pasteOptions=function(i){var n=new a.E7("documenteditor",t.owner.defaultLocale);n.setLocale(t.owner.locale),i.item.text===n.getConstant("Keep source formatting")?t.owner.editor.applyPasteOptions("KeepSourceFormatting"):i.item.text===n.getConstant("Match destination formatting")?t.owner.editor.applyPasteOptions("MergeWithExistingFormatting"):i.item.text===n.getConstant("NestTable")?t.owner.editor.applyTablePasteOptions("NestTable"):i.item.text===n.getConstant("InsertAsRows")?t.owner.editor.applyTablePasteOptions("InsertAsRows"):i.item.text===n.getConstant("InsertAsColumns")?t.owner.editor.applyTablePasteOptions("InsertAsColumns"):i.item.text===n.getConstant("OverwriteCells")?t.owner.editor.applyTablePasteOptions("OverwriteCells"):t.owner.editor.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){(0,a.le)(t.caret)||(t.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new Z(this.owner),this.end=new Z(this.owner),this.selectedWidgets=new U,this.characterFormatIn=new Rr(this),this.paragraphFormatIn=new vs(this,this.documentHelper),this.sectionFormatIn=new ys(this),this.rowFormatIn=new Cs(this),this.cellFormatIn=new ws(this),this.tableFormatIn=new bs(this),this.imageFormatInternal=new Fs(this),this.editRangeCollection=[],this.editRegionHighlighters=new U,this.formFieldHighlighters=new U}return Object.defineProperty(s.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"htmlWriter",{get:function(){return(0,a.le)(this.htmlWriterIn)&&(this.htmlWriterIn=new xs),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"start",{get:function(){if(!(0,a.le)(this.owner)&&!(0,a.le)(this.viewer))return(0,a.le)(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||(0,a.le)(this.viewer)||this.viewer instanceof Se||(0,a.le)(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||(0,a.le)(this.viewer)||this.viewer instanceof Se||(0,a.le)(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isinFootnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof Y&&"Footnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isinEndnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof Y&&"Endnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isEmpty",{get:function(){return!!(0,a.le)(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof be)return!0;e&&(e=e.containerWidget)}while(e);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sfdt",{get:function(){if(this.owner.editorModule&&this.start.offset!==this.end.offset)return JSON.stringify(this.writeSfdt())},enumerable:!0,configurable:!0}),s.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(s.prototype,"isCleared",{get:function(){return(0,a.le)(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isInField",{get:function(){return!(0,a.le)(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),s.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!(0,a.le)(e))return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}},s.prototype.getSelBookmarks=function(e){var t=[],i=this.documentHelper.bookmarks,n=this.start,r=this.end;this.isForward||(n=this.end,r=this.start);for(var o,l,h=!1,d=this.getSelectedCells(),c=0;c<i.length;c++)if(e||!e&&0!==i.keys[c].indexOf("_")){if(o=i.get(i.keys[c]),(0,a.le)(l=o.reference))continue;var u=this.getElementPosition(o).startPosition,p=this.getElementPosition(l,!0).startPosition;if(u.paragraph.isInsideTable||p.paragraph.isInsideTable)if(d.length>0){if(d.indexOf(u.paragraph.associatedCell)>=0||d.indexOf(p.paragraph.associatedCell)>=0)h=!0;else if(h=!1,d.indexOf(u.paragraph.associatedCell)<0||d.indexOf(p.paragraph.associatedCell)<0){var f=r.paragraph.isInsideTable&&r.paragraph.associatedCell,g=p.paragraph.associatedCell;if(f&&g&&f.ownerTable.equals(g.ownerTable)&&!(f.ownerTable&&d.indexOf(this.getCellInTable(f.ownerTable,g))>=0))continue}}else h=!1;else h=!1;((n.isExistAfter(u)||n.isAtSamePosition(u))&&(r.isExistBefore(p)||r.isAtSamePosition(p))||(u.isExistAfter(n)||u.isAtSamePosition(n))&&(p.isExistBefore(r)||p.isAtSamePosition(r))||u.isExistAfter(n)&&u.isExistBefore(r)&&(r.isExistAfter(p)||r.isExistBefore(p))||p.isExistBefore(r)&&p.isExistAfter(n)&&(n.isExistBefore(u)||n.isExistAfter(u))||h)&&t.push(o.name)}return t},Object.defineProperty(s.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"Selection"},s.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new ye(this.owner),this.owner.editor.layoutWholeDocument())},s.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},s.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},s.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},s.prototype.goToPage=function(e){this.owner.scrollToPage(e),e>=1&&e<=this.owner.documentHelper.pages.length&&this.updateTextPositionForBlockContainer(this.owner.documentHelper.pages[e-1].bodyWidgets[0])},s.prototype.selectTable=function(){!this.owner.enableSelection||this.selectTableInternal()},s.prototype.selectRow=function(){!this.owner.enableSelection||this.selectTableRow()},s.prototype.selectColumn=function(){!this.owner.enableSelection||this.selectColumnInternal()},s.prototype.selectCell=function(){!this.owner.enableSelection||this.selectTableCell()},s.prototype.select=function(e,t){if("string"==typeof e){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)}else{var r=new ce(e.x,e.y),o=this.viewer.findFocusedPage(r,!0);e.extend?this.moveTextPosition(o,this.end):this.documentHelper.updateTextPositionForSelection(o,1)}},s.prototype.selectByHierarchicalIndex=function(e,t){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)},s.prototype.selectField=function(e){(this.isInField||!(0,a.le)(e))&&((0,a.le)(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},s.prototype.selectFieldInternal=function(e,t,i){if(e){var n=this.documentHelper.isFormFillProtectedMode||i,r=e.fieldEnd;n&&(e=e.fieldSeparator);var o=e.line.getOffset(e,n?1:0),l=new Z(this.owner);l.setPositionParagraph(e.line,o),e.nextNode instanceof O&&!n&&(r=e.nextElement.reference);var d=r.line.getOffset(r,n?0:1),c=new Z(this.owner);c.setPositionParagraph(r.line,d),this.documentHelper.selection.selectRange(l,c),i||this.triggerFormFillEvent(t)}},s.prototype.selectShape=function(e){if(e){var t=e.line.getOffset(e,0),i=new Z(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,1),r=new Z(this.owner);r.setPositionParagraph(e.line,n),this.documentHelper.selection.selectRange(i,r)}},s.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},s.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},s.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},s.prototype.toggleUnderline=function(e){this.owner.editor&&this.owner.editor.toggleUnderline(e)},s.prototype.toggleStrikethrough=function(e){this.owner.editor&&this.owner.editor.toggleStrikethrough(e)},s.prototype.toggleHighlightColor=function(e){this.owner.editor&&this.owner.editor.toggleHighlightColor(e)},s.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},s.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},s.prototype.toggleTextAlignment=function(e){this.owner.editor&&this.owner.editor.toggleTextAlignment(e)},s.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},s.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},s.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},s.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);if(0!==t.toLowerCase().indexOf("ref ")||t.match("\\h")){var i=new ji(e,this),n={isHandled:!1,navigationLink:i.navigationLink,linkType:i.linkType,localReference:i.localReference,source:this.owner};this.owner.trigger("requestNavigate",n),n.isHandled||this.documentHelper.selection.navigateBookmark(i.localReference,!0)}},s.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e,!0);this.copyToClipboard(t)},s.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,n=i.pageHeight-i.footerDistance,r=t.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&e.y+e.height>w.convertPointToPixel(n)||this.contextType.indexOf("Header")>=0&&e.y+e.height>r},s.prototype.highlightSelection=function(e){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end)},s.prototype.createHighlightBorder=function(e,t,i,n,r){t<0&&(t=0);var o=e.paragraph,l=[];if(o.floatingElements.length>0)for(var h=0;h<o.floatingElements.length;h++){var d=o.floatingElements[h];if(d.line===e){var c=this.start,u=this.end;this.isForward||(c=this.end,u=this.start);var p=d.line.getOffset(d,0);(c.currentWidget!==e&&u.currentWidget!==e||c.currentWidget===e&&c.offset<=p&&(u.currentWidget===e&&u.offset>=p+1||u.currentWidget!==e)||c.currentWidget!==e&&u.currentWidget===e&&u.offset>=p)&&l.push(d)}}var f=this.getPage(e.paragraph),m=this.selectedWidgets,v=void 0,y=void 0;if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(e,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(e,i,t);else{if(m.containsKey(e))m.get(e)instanceof Je?(v=m.get(e),r&&(m.remove(e),m.add(e,y=[]))):y=m.get(e);else if(r)m.add(e,y=[]);else{var b=this.getWrapPosition(e,o);if(b.length>0){var C=this.splitSelectionHighlightPosition(i,t,b);if(C.length>0)return C[0].floatingItems=l,m.add(e,C),void this.renderHighlight(f,e,C,n,l);(v=new Je(i,t)).floatingItems=l,m.add(e,v)}else(v=new Je(i,t)).floatingItems=l,m.add(e,v)}void 0===v&&((v=new Je(i,t)).floatingItems=l,m.add(e,v)),this.renderHighlight(f,e,[v],n,l),r&&y.push(v)}},s.prototype.renderHighlight=function(e,t,i,n,r){var o=this.owner.documentHelper,l=this.getPageTop(e),h=e.boundingRectangle.x,d=t.height;if(this.viewer.containerTop<=l||l<this.viewer.containerTop+o.selectionCanvas.height){var c=o.zoomFactor;this.clipSelection(e,l);for(var u=0;u<i.length;u++){var p=i[u],f=p.left,g=p.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,h+f*c-this.viewer.containerLeft,n,g*c,d):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(h+f*c-this.viewer.containerLeft,l+n*c-this.viewer.containerTop,g*c,d*c))}if(r.length>0)for(var m=0;m<r.length;m++)o.selectionContext.fillRect(h+(f=r[m].x)*c-this.viewer.containerLeft,l+r[m].y*c-this.viewer.containerTop,r[m].width*c,r[m].height*c);o.selectionContext.restore()}},s.prototype.getWrapPosition=function(e,t){var i=t.bodyWidget;if(!(0,a.le)(i)&&i.floatingElements.length>0&&e.children.length>0){for(var n=this.getLeftInternal(e,e.children[0],0),r=0,o=[],l=!1,h=0;h<e.children.length;h++){var d=e.children[h];if(!(d instanceof Pe&&"Inline"!==d.textWrappingStyle)){if(d.padding.left>0){1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x,n=t.x);var c={};c.start=n+r,c.end=0,l&&(c.end=n+r+d.padding.left),o.push(c)}r+=d.padding.left+d.width,d instanceof S&&(l=!0)}}return 1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x),o}return[]},s.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var n=[],r=0;r<i.length;r++){var o=i[r];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(n.push(new Je(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(e+=o.end,t-=o.end),r===i.length-1&&n.push(new Je(e,t)))}return n},s.prototype.addEditRegionHighlight=function(e,t,i){var n=void 0,r=this.editRegionHighlighters;r.containsKey(e)?n=r.get(e):r.add(e,n=[]);var o=new Je(t,i);return this.isCurrentUser&&(o.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),n.push(o),o},s.prototype.addFormFieldHighlight=function(e,t,i){var n=void 0,r=this.formFieldHighlighters;r.containsKey(e)?n=r.get(e):r.add(e,n=[]);var o=new Je(t,i);n.push(o)},s.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,n=e.x-e.margin.left+e.leftBorderWidth,r=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,l=e.height,h=this.getPageTop(t),d=t.boundingRectangle.x,c=this.documentHelper.isPageInVisibleBound(t,h),u=this.selectedWidgets;if(!this.isHightlightEditRegionInternal&&!this.isHighlightFormFields&&(u.containsKey(e)&&u.get(e)instanceof Je?(i=u.get(e),c&&this.documentHelper.selectionContext.clearRect(d+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,h+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,l*this.documentHelper.zoomFactor)):(i=new Je(n,r),u.containsKey(e)&&u.remove(u.get(e)),u.add(e,i))),c){this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4;var p=this.documentHelper.zoomFactor;this.clipSelection(t,h),this.documentHelper.selectionContext.fillRect(d+n*p-this.viewer.containerLeft,h+o*p-this.viewer.containerTop,r*p,l*p),this.documentHelper.selectionContext.restore()}},s.prototype.clipSelection=function(e,t){var n,r,i=this.owner.documentHelper;this.viewer instanceof Se&&this.documentHelper.zoomFactor<1?(n=e.boundingRectangle.width/this.documentHelper.zoomFactor,r=e.boundingRectangle.height/this.documentHelper.zoomFactor):(n=e.boundingRectangle.width*this.documentHelper.zoomFactor,r=e.boundingRectangle.height*this.documentHelper.zoomFactor);var o=e.boundingRectangle.x;i.selectionContext.beginPath(),i.selectionContext.save(),i.selectionContext.rect(o-this.viewer.containerLeft,t-this.viewer.containerTop,n,r),i.selectionContext.clip()},s.prototype.addSelectionHighlight=function(e,t,i,n){if(this.selectedWidgets.containsKey(t)){var r=this.documentHelper.render.getScaledValue(t.height),o=this.selectedWidgets.get(t),l=void 0;if(o instanceof Je?(l=[]).push(o):l=o,!(0,a.le)(l))for(var h=0;h<l.length;h++){var d=l[h],c=this.documentHelper.render.getScaledValue(l[h].width),u=this.documentHelper.render.getScaledValue(l[h].left,1);if((0,a.le)(n)&&(n=this.owner.selection.getPage(t.paragraph)),this.owner.selection.clipSelection(n,this.owner.selection.getPageTop(n)),this.documentHelper.isComposingIME)this.renderDashLine(e,n,t,u,i,c,r);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(u,this.documentHelper.render.getScaledValue(i,2),c,r),d.floatingItems&&d.floatingItems.length>0)for(var p=0;p<d.floatingItems.length;p++){var f=d.floatingItems[p];c=this.documentHelper.render.getScaledValue(f.width),u=this.documentHelper.render.getScaledValue(f.x,1);var g=this.documentHelper.render.getScaledValue(f.y,2);e.fillRect(u,g,c,this.documentHelper.render.getScaledValue(f.height))}e.restore()}}},s.prototype.renderDashLine=function(e,t,i,n,r,o,l){var h=this.characterFormat.fontColor,d=h?w.getColor(h):"#000000";e.globalAlpha=1;var c=this.owner.editor.copyInsertFormat(new ie,!1),u=this.documentHelper.textHelper.getHeight(c),p=this.getPageTop(t),f=u.Height-u.BaselineOffset;r=this.documentHelper.render.getUnderlineYPosition(i)+r+4-f,this.documentHelper.render.renderDashLine(e,n,p-this.viewer.containerTop+r*this.documentHelper.zoomFactor,o,d,!0)},s.prototype.addSelectionHighlightTable=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var n=this.selectedWidgets.get(t),r=void 0;if(n instanceof Je?(r=[]).push(n):r=n,!(0,a.le)(r))for(var o=0;o<r.length;o++){var l=this.documentHelper.render.getScaledValue(r[o].left,1),h=this.documentHelper.render.getScaledValue(t.y,2),d=this.documentHelper.render.getScaledValue(r[o].width),c=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",(0,a.le)(i)&&(i=this.owner.selection.getPage(t)),this.owner.selection.clipSelection(i,this.owner.selection.getPageTop(i)),e.fillRect(l,h,d,c),e.restore()}}},s.prototype.removeSelectionHighlight=function(e){var t=0,i=0,n=0,r=0,o=void 0;if(e instanceof oe){var l=e;if(o=(0,a.le)(l.paragraph)?void 0:this.getPage(l.paragraph),(0,a.le)(o))return;i=this.getTop(l),r=l.height}else if(e instanceof V){if(o=(0,a.le)(e)?void 0:this.getPage(e),(0,a.le)(o))return;i=e.y,r=e.height}if(!(0,a.le)(o)){var d=this.selectedWidgets.get(e),c=void 0;if(d instanceof Je?(c=[]).push(d):c=d,!(0,a.le)(c))for(var u=0;u<c.length;u++){n=c[u].width,t=c[u].left;var p=o.boundingRectangle,f=this.documentHelper.pages.indexOf(o),g=this.viewer.pageGap,m=(p.y-g*(f+1))*this.documentHelper.zoomFactor+g*(f+1),y=this.documentHelper.zoomFactor;(this.viewer.containerTop<=m||m<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(p.x+t*y-this.viewer.containerLeft-.5,m+i*y-this.viewer.containerTop-.5,n*y+.5,r*y+.5)}}},s.prototype.selectCurrentWord=function(e){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i)},s.prototype.selectParagraph=function(){(0,a.le)(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.selectLine=function(){(0,a.le)(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},s.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},s.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},s.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},s.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},s.prototype.moveToNextLine=function(){this.moveDown()},s.prototype.moveToPreviousLine=function(){this.moveUp()},s.prototype.moveToNextCharacter=function(){this.handleRightKey()},s.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},s.prototype.selectCurrentWordRange=function(e,t,i){if(!(0,a.le)(e)){if(e.offset>0){var n=e.clone(),r=0,o=e.currentWidget.getInline(e.offset,r),l=o.element;r=o.index,!(0,a.le)(l)&&l instanceof H&&1===l.fieldType?e.offset>2&&(!(0,a.le)(l.fieldSeparator)||(0,a.le)(l.fieldBegin))?(n.setPositionParagraph(n.currentWidget,e.offset-2),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&(0,a.le)(l.fieldSeparator)&&(n.setPositionParagraph(n.currentWidget,e.offset-3),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2)):(n.setPositionParagraph(n.currentWidget,e.offset-1),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,i)}},s.prototype.extendToParagraphStart=function(){(0,a.le)(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToParagraphEnd=function(){(0,a.le)(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.moveNextPosition=function(){if(!(0,a.le)(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e))}},s.prototype.moveToNextParagraph=function(){(0,a.le)(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.nextFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,i=this.documentHelper.footnoteCollection.indexOf(e),n=this.documentHelper.footnoteCollection[i+1];(0,a.le)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),l=0;l<this.documentHelper.pages.length;l++)for(var h=this.documentHelper.pages[l].footnoteWidget,d=1;d<h.bodyWidgets.length;d++)h.bodyWidgets[d].footNoteReference===n&&(r.setPositionParagraph(h.bodyWidgets[d].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}},s.prototype.previousFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,i=this.documentHelper.footnoteCollection.indexOf(e),n=this.documentHelper.footnoteCollection[i-1];(0,a.le)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),l=0;l<this.documentHelper.pages.length;l++)for(var h=this.documentHelper.pages[l].footnoteWidget,d=1;d<h.bodyWidgets.length;d++)h.bodyWidgets[d].footNoteReference===n&&(r.setPositionParagraph(h.bodyWidgets[d].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}},s.prototype.nextEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t+1];(0,a.le)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,l=0;l<o.childWidgets.length;l++)o.bodyWidgets[l].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[l].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}},s.prototype.previousEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t-1];(0,a.le)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,l=0;l<o.childWidgets.length;l++)o.bodyWidgets[l].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[l].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}},s.prototype.movePreviousPosition=function(){if(!(0,a.le)(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e))}},s.prototype.moveToPreviousParagraph=function(){(0,a.le)(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToPreviousLine=function(){(0,a.le)(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},s.prototype.extendToLineEnd=function(){(0,a.le)(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToLineStart=function(){(0,a.le)(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},s.prototype.moveUp=function(){this.documentHelper.isFormFillProtectedMode?this.selectPrevNextFormField(!1):(0,a.le)(this.start)||(this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x,this.start.moveUp(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},s.prototype.moveDown=function(){this.documentHelper.isFormFillProtectedMode?this.selectPrevNextFormField(!0):(0,a.le)(this.start)||(this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.start.moveDown(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},s.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},s.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},s.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];return 0===i.childWidgets.length?void 0:i.childWidgets[0]}}},s.prototype.getFirstCellInRegion=function(e,t,i,n){var r=this.getCellLeft(e,t),o=r+t.cellFormat.cellWidth,l=!0;if(r<=i&&i<o)for(var h=0;h<e.childWidgets.length;h++){var d=this.getCellLeft(e,e.childWidgets[h]);if(w.round(r,2)<=w.round(d,2)&&w.round(d,2)<w.round(o,2))return l=!1,e.childWidgets[h]}else for(var c=0;c<e.childWidgets.length;c++){var u=this.getCellLeft(e,e.childWidgets[c]);if(u<=i&&u+e.childWidgets[c].cellFormat.cellWidth>i)return l=!1,e.childWidgets[c]}if(l){if(!(0,a.le)(e.previousRenderedWidget)&&n)return this.getFirstCellInRegion(e.previousRenderedWidget,t,i,n);if(!(0,a.le)(e.nextRenderedWidget)&&!n)return this.getFirstCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[0]},s.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;return this.getFirstParagraphBlock(e.firstChild)},s.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){for(var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];0===i.childWidgets.length&&!(0,a.le)(i.previousSplitWidget);)i=i.previousSplitWidget;return i.childWidgets[i.childWidgets.length-1]}},s.prototype.moveToLineStart=function(){(0,a.le)(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},s.prototype.moveToLineEnd=function(){(0,a.le)(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},s.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},s.prototype.moveTextPosition=function(e,t,i){if(!(0,a.le)(this.start)){var n=this.documentHelper.getLineWidgetInternal(e,!0);(0,a.le)(n)||this.updateTextPositionWidget(n,e,t,!0),this.upDownSelectionLength=t.location.x;var r=this.start.getHierarchicalIndexInternal(),o=this.end.getHierarchicalIndexInternal();r!==o&&!i&&(Z.isForwardSelection(r,o)?t.validateForwardFieldSelection(r,o):t.validateBackwardFieldSelection(r,o)),this.fireSelectionChanged(!0)}},s.prototype.getDocumentStart=function(){return this.setPositionForBlock(this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0],!0)},s.prototype.getDocumentEnd=function(){var e=void 0,i=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!(0,a.le)(this.owner.documentStart)&&i.bodyWidgets[0].childWidgets.length>0){var n=void 0,o=i.bodyWidgets[0].childWidgets,h=o[o.length-1];h instanceof Ve&&(n=h),e=this.setPositionForBlock(n,!1)}return e},s.prototype.handleControlEndKey=function(){var e=void 0;(0,a.le)(this.owner.documentEnd)||(e=this.owner.documentEnd),(0,a.le)(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},s.prototype.handleControlHomeKey=function(){var e=void 0;(0,a.le)(this.owner.documentStart)||(e=this.owner.documentStart),(0,a.le)(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},s.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},s.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},s.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},s.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},s.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},s.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},s.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},s.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},s.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},s.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},s.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},s.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},s.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.checkForCursorVisibility()},s.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},s.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.checkForCursorVisibility()},s.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},s.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},s.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},s.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},s.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},s.prototype.handleControlShiftEndKey=function(){var e=void 0;(0,a.le)(this.owner.documentEnd)||(e=this.owner.documentEnd),(0,a.le)(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},s.prototype.handleControlShiftHomeKey=function(){var e=void 0;(0,a.le)(this.owner.documentStart)||(e=this.owner.documentStart),(0,a.le)(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},s.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editor.toggleCheckBoxFormField(this.getCurrentFormField())},s.prototype.handleTabKey=function(e,t){var i=this.start,n=!1;if(!(0,a.le)(i)){if(i.currentWidget.isFirstLine()&&0===i.offset&&-1==i.paragraph.paragraphFormat.listFormat.listId&&(n=!0),i.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t))!this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"!==this.documentHelper.protectionType&&(t?this.selectPreviousCell():this.selectNextCell());else if(!e&&!t||(0,a.le)(i)||i.offset!==this.getStartOffset(i.paragraph)||(0,a.le)(i.paragraph.paragraphFormat)||(0,a.le)(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode)!this.owner.isReadOnlyMode&&!this.documentHelper.isFormFillProtectedMode&&(n?t?this.owner.editorModule.decreaseIndent():this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t"));else{var r=this.documentHelper.selection,o=i.paragraph;r.isForward||(o=r.end.paragraph),this.owner.editorModule.isFirstParaForList(r,o)?this.owner.editorModule.updateListLevelIndent(t?-this.documentHelper.defaultTabWidth:this.documentHelper.defaultTabWidth,o):this.owner.editorModule.updateListLevel(!t)}"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility()}},s.prototype.handlePageUpPageDownKey=function(e,t){var i=this,n=this.end.location.x,r=this.end.location.y,o=this.end.paragraph.bodyWidget.page,l=this.getPageTop(o),h=this.documentHelper.viewerContainer.scrollTop;r=r*this.documentHelper.zoomFactor+(l-h),n=n*this.documentHelper.zoomFactor+o.boundingRectangle.x,e?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;var d=!1;h===this.documentHelper.viewerContainer.scrollTop&&(d=!0),t&&(this.documentHelper.skipScrollToPosition=!0),setTimeout(function(){if(d)if(t){var c;c=e?i.getDocumentEnd():i.getDocumentStart(),i.end.setPositionForLineWidget(c.currentWidget,c.offset),i.fireSelectionChanged(!0)}else e?i.moveToDocumentEnd():i.moveToDocumentStart();else i.select({x:n,y:r,extend:t})},0)},s.prototype.getFormFieldInFormFillMode=function(){for(var t,e=this.owner.selection.start,i=this.documentHelper.formFields.length-1;i>=0;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistBefore(e)){t=this.documentHelper.formFields[i];break}0===i&&(t=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return t},s.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t||(t=this.getCurrentFormField());var i=this.documentHelper.formFields.indexOf(t);if(e)for(var n=i;;n++){if(n===this.documentHelper.formFields.length-1?n=0:n+=1,this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n-=1}else for(n=i;;n--){if(0===n?n=this.documentHelper.formFields.length-1:n-=1,this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n+=1}}},s.prototype.navigateToNextFormField=function(){for(var t,e=this.owner.selection.end,i=0;i<this.documentHelper.formFields.length;i++)if(t=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistAfter(e)){t.formFieldData instanceof Re&&"Text"===t.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&((t=this.documentHelper.formFields[0]).formFieldData instanceof Re&&"Text"===t.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},s.prototype.selectTextElementStartOfField=function(e){var i=e.fieldSeparator.nextElement;if(i){for(;!(i instanceof S);)i=i.nextElement;var n=e.line.getOffset(i,0),r=this.getPhysicalPositionInternal(e.line,n,!1);this.selectInternal(e.line,i,0,r)}},s.prototype.triggerFormFillEvent=function(e){var n,r,t=this.previousSelectedFormField,i=this.getCurrentFormField();i!==t&&t&&t.formFieldData instanceof Re&&"Text"===t.formFieldData.type&&(""!==t.formFieldData.format&&!this.isFormatUpdated&&this.owner.editor.applyFormTextFormat(t),n={fieldName:t.formFieldData.name,value:this.owner.editorModule.getFieldResultText(t)},this.owner.trigger(vt,n)),i!==t&&i&&(i.formFieldData instanceof Re&&"Text"===i.formFieldData.type&&null==e||(i.formFieldData instanceof Re&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||i.formFieldData instanceof qe)&&e)&&(r={fieldName:i.formFieldData.name,value:this.owner.editorModule.getFieldResultText(i)},this.owner.trigger(Hn,r))},s.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;if((0,a.le)(e.previousWidget)){if(!(0,a.le)(t.previousRenderedWidget)){var n=void 0;t.previousRenderedWidget instanceof Q&&(n=t.previousRenderedWidget),this.selectTableCellInternal(n.childWidgets[n.childWidgets.length-1],!0)}}else{var r=void 0;e.previousWidget instanceof V&&(r=e.previousWidget),this.selectTableCellInternal(r,!0)}},s.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;if((0,a.le)(e.nextWidget))if((0,a.le)(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var n=void 0;t.nextRenderedWidget instanceof Q&&(n=t.nextRenderedWidget),this.selectTableCellInternal(n.childWidgets[0],!0)}else{var r=void 0;e.nextRenderedWidget instanceof V&&(r=e.nextRenderedWidget),this.selectTableCellInternal(r,!0)}},s.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),n=this.getLastParagraph(e);if(i===n&&n.isEmpty())this.selectParagraphInternal(n,!0);else{var r=n.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(r,r.getEndOffset()),this.fireSelectionChanged(!0)}},s.prototype.selectTableInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.le)(e)&&!(0,a.le)(t)&&!(0,a.le)(this.getTable(e,t))){var n=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,r=this.getFirstParagraphBlock(n),o=this.getLastParagraphBlock(n),l=o.lastChild.getEndOffset();this.start.setPosition(r.childWidgets[0],!0),this.end.setPositionParagraph(o.lastChild,l+1)}this.selectPosition(this.start,this.end)},s.prototype.selectColumnInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.le)(e)&&!(0,a.le)(t)&&!(0,a.le)(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell);if(i.ownerTable.contains(t.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,i),r=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){var l=i.ownerTable.getColumnCellsForSelection(i,i);if(l.length>0){var h=this.getFirstParagraph(l[0]),d=this.getLastParagraph(l[l.length-1]);this.start.setPosition(h.firstChild,!0),this.end.setPositionParagraph(c=d.lastChild,c.getEndOffset()+1)}}else{var c,u=i.ownerTable.getColumnCellsForSelection(n,n),p=i.ownerTable.getColumnCellsForSelection(r,r);if(u.length>0&&p.length>0)h=this.getFirstParagraph(u[0]),d=this.getLastParagraph(p[p.length-1]),this.start.setPosition(h.firstChild,!0),this.end.setPositionParagraph(c=d.lastChild,c.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},s.prototype.selectTableRow=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.le)(e)&&!(0,a.le)(t)&&!(0,a.le)(this.getTable(e,t))){var i=void 0;if((i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell)).ownerTable.contains(t.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,i),r=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){var o=n.ownerRow,l=this.getFirstParagraph(o.childWidgets[0]),h=this.getLastParagraph(o.childWidgets[o.childWidgets.length-1]);this.start.setPosition(l.firstChild,!0),this.end.setPositionParagraph(h.lastChild,h.lastChild.getEndOffset()+1)}else l=this.getFirstParagraph(n.ownerRow.childWidgets[0]),h=void 0,h=this.getLastParagraph(r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1]),this.start.setPosition(l.firstChild,!0),this.end.setPositionParagraph(h.lastChild,h.lastChild.getEndOffset()+1)}}this.selectPosition(this.start,this.end)},s.prototype.selectTableCell=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.le)(this.getTable(e,t))){if(this.isEmpty)e.paragraph.isInsideTable&&!(0,a.le)(e.paragraph.associatedCell)&&((i=this.getFirstParagraph(e.paragraph.associatedCell))===(n=this.getLastParagraph(t.paragraph.associatedCell))?(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)):(this.start.setPosition(i.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)));else{var r=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(r,e.paragraph.associatedCell)&&this.containsCell(r,t.paragraph.associatedCell)){var i=this.getFirstParagraph(r),n=this.getLastParagraph(r);!(0,a.le)(i)&&!(0,a.le)(n)&&(this.start.setPosition(i.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},s.prototype.selectAll=function(){var e,t;this.documentHelper.skipScrollToPosition=!0;var i=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter){var n=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(n.firstChild,!0),t=this.setPositionForBlock(n.lastChild,!1)}else if(this.isInShape){var r=this.getCurrentTextFrame();e=this.setPositionForBlock(r.firstChild,!0),t=this.setPositionForBlock(r.lastChild,!1)}else if(i instanceof Y&&"Footnote"===i.footNoteType){var o=void 0,l=void 0,h=this.documentHelper.pages.length;for(o=0;o<=h-1;o++)if(!(0,a.le)(this.documentHelper.pages[o].footnoteWidget)){e=this.setPositionForBlock(this.documentHelper.pages[o].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(l=h-1;l>=0;l--)if(!(0,a.le)(this.documentHelper.pages[l].footnoteWidget)){var d=this.documentHelper.pages[l].footnoteWidget.bodyWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[l].footnoteWidget.bodyWidgets[d-1].childWidgets[this.documentHelper.pages[l].footnoteWidget.bodyWidgets[d-1].childWidgets.length-1],!1);break}}else if(i instanceof Y&&"Endnote"===i.footNoteType){var u=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(u.bodyWidgets[0].firstChild,!0),t=this.setPositionForBlock(u.bodyWidgets[u.bodyWidgets.length-1].firstChild,!1)}else e=this.owner.documentStart,t=this.owner.documentEnd;(0,a.le)(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendBackward=function(){(0,a.le)(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendForward=function(){(0,a.le)(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},s.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},s.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},s.prototype.extendToWordStartInternal=function(e){(0,a.le)(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToWordEndInternal=function(e){(0,a.le)(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},s.prototype.extendToNextLine=function(){(0,a.le)(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},s.prototype.getTextPosition=function(e){var t=new Z(this.owner);return t.setPositionForCurrentIndex(e),t},s.prototype.getText=function(e){if(!((0,a.le)(this.start)||(0,a.le)(this.end)||(0,a.le)(this.start.paragraph)||(0,a.le)(this.end.paragraph))){var t=this.start,i=this.end;return t.isAtSamePosition(i)?"":this.getTextInternal(t,i,e)}},s.prototype.getTextInternal=function(e,t,i){if(e.isExistAfter(t)){var n=t;t=e,e=n}var r=e,o=t;if(!((0,a.le)(e)||(0,a.le)(t)||(0,a.le)(e.paragraph)||(0,a.le)(t.paragraph))){var l=0,h=0,c=t.offset,u=e.currentWidget.getInline(e.offset,l);l=u.index;var p=u.element;if(p instanceof H&&!(0,a.le)(p.fieldEnd)){var f=this.getRenderedInline(p,l);p=f.element,l=f.index}var g=t.currentWidget.getInline(c,h),m=g.element;h=g.index;var v="";if(p instanceof ee&&i&&0===l?v=fe.objectCharacter:p instanceof S&&(v=(0,a.le)(p.text)||""===p.text||p.text.length<l?v:p.text.substring(l)),r.paragraph===o.paragraph)p instanceof fe&&(p===m&&p instanceof S?v=v.length<h-l?v:v.substring(0,h-l):p.nextNode instanceof fe&&(v+=this.getTextInline(p.nextNode,o.paragraph,m,h,i)));else if(p instanceof fe&&p.nextNode instanceof fe)v+=this.getTextInline(p.nextNode,o.paragraph,void 0,0,i);else{var y=this.documentHelper.selection.getNextParagraphBlock(r.paragraph);for(v+="\r";!(0,a.le)(y)&&y.isEmpty();){if(v+="\r",y===o.paragraph)return v;y=this.documentHelper.selection.getNextParagraphBlock(y)}!(0,a.le)(y)&&!y.isEmpty()&&(v+=this.getTextInline(y.childWidgets[0].children[0],o.paragraph,m,h,i))}return c===o.currentWidget.getEndOffset()+1&&(v+="\r"),v}},s.prototype.getHierarchicalIndex=function(e,t){var i;if(e){if(e instanceof Ce){var n=-1!==e.headerFooterType.indexOf("Header")?"H":"F",r=e.page.index.toString();i=e.page.sectionIndex+";"+n+";"+r+";"+t}else i=e instanceof j&&!(0,a.le)(e.containerWidget)&&e.containerWidget instanceof Y?e.containerWidget.bodyWidgets.indexOf(e)+";"+t:e.index+";"+t;if(e instanceof be){var h=e.containerShape.line.getOffset(e.containerShape,1);return this.getHierarchicalIndex(e.containerShape.paragraph,i="S;"+h+";"+t)}if(e instanceof Y&&(n="Footnote"===e.footNoteType?"FN":"EN",r=e.page.index.toString(),i=e.page.sectionIndex+";"+n+";"+r+";"+t),e.containerWidget)return e instanceof V&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},s.prototype.getHierarchicalIndexByPosition=function(e){var t=this.getParagraphInfo(e);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},s.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new Z(this.owner),i=this.getParagraph({index:e}),n=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(n.line,n.offset),t},s.prototype.getLineInfoBasedOnParagraph=function(e,t){var i=this.getParagraphLength(e),n=e.nextSplitWidget;for(t>i+1&&(0,a.le)(n)&&(t=i);t>i&&n instanceof I;)t-=i,i=this.getParagraphLength(e=n),n=e.nextSplitWidget;return this.getLineInfo(e,t)},s.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},s.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(n,t))},s.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n="FN"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var r=this.documentHelper.pages[t];return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),n?r.footnoteWidget.bodyWidgets[t]:r.endnoteWidget.bodyWidgets[t]},s.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n="H"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var o,r=this.documentHelper.pages[t];return(0,a.le)(o=n?r.headerWidget:r.footerWidget)||(o.page=r),o},s.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++){var n=this.documentHelper.pages[i].bodyWidgets[0];if(n.index===e&&n.childWidgets.length>0&&n.firstChild.index<=t&&n.lastChild.index>=t)return n;if(n.index>e)break}},s.prototype.getParagraphInternal=function(e,t){if(!(0,a.le)(t.index)){var i=t.index.indexOf(";"),n="0";i>=0&&(n=t.index.substring(0,i),t.index=t.index.substring(i).replace(";","")),i=parseInt(n,10),e instanceof Q&&i>=e.childWidgets.length&&(t.index="0;0",i=e.childWidgets.length-1);var r=this.getBlockByIndex(e,i);if(r){if("S"===(n=t.index.substring(0,1))){t.index=t.index.substring(1).replace(";","");var o=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var l=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var h=r.getInline(parseInt(o),0).element;r=h.textFrame.childWidgets[l]}var d=r;if(d instanceof I)return t.index.indexOf(";")>0&&(t.index="0"),d;if(d instanceof Ze)return t.index.indexOf(";")>0?this.getParagraphInternal(d,t):d instanceof k?this.documentHelper.selection.getFirstParagraphInFirstCell(d):void 0}else if(e){var c=e.getSplitWidgets().pop().nextRenderedWidget;if(c instanceof Ze)return t.index="0",c instanceof k?this.documentHelper.selection.getFirstParagraphInFirstCell(c):c}}},s.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var n=0;n<e.childWidgets.length;n++)if(e.childWidgets[n].index===t){i=e.childWidgets[n];break}if(!(i||e instanceof Ce))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},s.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},s.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,n=this.getParagraphLength(i,e)+t,r=i.previousSplitWidget;r instanceof I;)n+=this.documentHelper.selection.getParagraphLength(i=r),r=i.previousSplitWidget;return{paragraph:i,offset:n}},s.prototype.getListTextElementBox=function(e){if(!(0,a.le)(e)){var t;if(!e.isEmpty()){var i=e.childWidgets[0];i.children.length>1&&i.children[0]instanceof _&&(t=i.children[0])}return t}},s.prototype.getListLevel=function(e){var t=void 0,i=0;if(!(0,a.le)(e.paragraphFormat)&&!(0,a.le)(e.paragraphFormat.listFormat)&&(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),!(0,a.le)(t)&&!(0,a.le)(this.documentHelper.getAbstractListById(t.abstractListId))&&!(0,a.le)(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},s.prototype.getTextInline=function(e,t,i,n,r){var o="";do{if(e===i){if(e instanceof S){var l=e;(0,a.le)(l.text)||""===l.text||(o+=l.text.length<n?l.text:l.text.substring(0,n))}else e instanceof ee&&r&&n===e.length&&(o+=fe.objectCharacter);return o}if(e instanceof S?o+=e.text:e instanceof ee&&r?o+=fe.objectCharacter:e instanceof H&&!(0,a.le)(e.fieldEnd)&&(e=(0,a.le)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),(0,a.le)(e.nextNode))break;e=e.nextNode}while(!(0,a.le)(e));if(t===e.line.paragraph)return o;for(var h=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!(0,a.le)(h)&&h.isEmpty();){if(o+="\r",h===t)return o;h=this.documentHelper.selection.getNextParagraphBlock(h)}return(0,a.le)(h)||h.isEmpty()||(o=o+"\r"+this.getTextInline(h.childWidgets[0].children[0],t,i,n,r)),o},s.prototype.getFieldCode=function(e){var t="";if(!(e.fieldEnd instanceof H))return t;var i=e.paragraph,n=e.fieldEnd.paragraph;e.fieldSeparator instanceof H&&(n=e.fieldSeparator.paragraph);var r=e.line.indexInOwner,o=e.indexInOwner;do{if(t+=this.getFieldCodeInternal(i,r,o),i===n)break;i=this.getNextParagraphBlock(i),r=0,o=0}while(i instanceof I);return t.trim()},s.prototype.getFieldCodeInternal=function(e,t,i){for(var n="",r=t;r<e.childWidgets.length;r++){for(var o=e.childWidgets[r],l=i;l<o.children.length;l++){var h=o.children[l];if(h instanceof S&&(n+=h.text),h instanceof H&&(2===h.fieldType||1===h.fieldType))return n}i=0}return n},s.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(!this.isEmpty&&!this.isForward&&(e=this.end.paragraph);e instanceof I&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],n=i.nextNode;if(i instanceof H&&0===i.fieldType&&n instanceof S&&0===n.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},s.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof j)return this.getFirstParagraphBlock(e.nextRenderedWidget.childWidgets[0])},s.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof j){var t=e.previousRenderedWidget;return this.getLastParagraphBlock(t.childWidgets[t.childWidgets.length-1])}},s.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof I?t:this.getFirstParagraphInFirstCell(t)},s.prototype.getFirstParagraphInFirstCell=function(e){if(!(0,a.le)(e.childWidgets)&&e.childWidgets.length>0)return this.getFirstParagraphBlock(e.childWidgets[0].childWidgets[0].childWidgets[0])},s.prototype.getLastParagraphInLastCell=function(e){if(!(0,a.le)(e.childWidgets)&&e.childWidgets.length>0)return this.getLastParagraphBlock(e.lastChild.lastChild.lastChild)},s.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0)return this.getLastParagraphBlock(e.firstChild.lastChild.lastChild)},s.prototype.getNextStartInline=function(e,t){var i=0,n=e.getInline(t,i),r=n.element;if(i=n.index,!(0,a.le)(r)&&i===r.length&&r.nextNode instanceof H||r instanceof de){var o=this.getNextValidElement(r.nextNode);o instanceof H&&0===o.fieldType&&(r=o)}return r},s.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof S?e.previousNode:e.previousNode instanceof H&&w.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:(0,a.le)(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},s.prototype.getNextTextInline=function(e){return e.nextNode instanceof S?e.nextNode:e.nextNode instanceof H&&w.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:(0,a.le)(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},s.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof k)return e},s.prototype.isElementInSelection=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new Z(this.owner);n.setPositionParagraph(e.line,i);var r=this.start,o=this.end;return this.isForward||(r=this.end,o=this.start),(n.isExistAfter(r)||n.isAtSamePosition(r))&&(n.isExistBefore(o)||n.isAtSamePosition(o))},s.prototype.isSelectionInsideElement=function(e){if(this.isEmpty){var t=e.line.getOffset(e,0),i=new Z(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,e.length),r=new Z(this.owner);return r.setPositionParagraph(e.line,n),(this.start.isExistAfter(i)||this.start.isAtSamePosition(i))&&(this.start.isExistBefore(r)||this.start.isAtSamePosition(r))}return!1},s.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var n=t.associatedCell;if(i===n)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===n.ownerRow)return i.cellIndex<n.cellIndex;if(i.ownerTable===n.ownerTable)return i.ownerRow.rowIndex<n.ownerRow.rowIndex;var r=this.getContainerCellOf(i,n);return r.ownerTable.contains(n)?(i=this.getSelectedCell(i,r),n=this.getSelectedCell(n,r),i===r?this.isExistBefore(e,n.ownerTable):n===r?this.isExistBefore(i.ownerTable,t):r.ownerRow===n.ownerRow?r.cellIndex<n.cellIndex:r.ownerTable===n.ownerTable?r.ownerRow.rowIndex<n.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,n.ownerTable)):this.isExistBefore(r.ownerTable,this.getContainerTable(n.ownerTable))}var o=this.getContainerTable(e);return this.isExistBefore(o,t)}if(t.isInsideTable)return o=this.getContainerTable(t),this.isExistBefore(e,o);if(e.containerWidget===t.containerWidget)return e.index<t.index;if(e.containerWidget instanceof j&&t.containerWidget instanceof j){var l=this.documentHelper.pages.indexOf(e.containerWidget.page),h=this.documentHelper.pages.indexOf(t.containerWidget.page);return l===h&&e.containerWidget.containerWidget instanceof Y&&t.containerWidget.containerWidget instanceof Y?this.documentHelper.pages[l].footnoteWidget.bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[h].footnoteWidget.bodyWidgets.indexOf(t.containerWidget):l<h}return!1},s.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var n=t.associatedCell;if(i===n)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===n.ownerRow)return i.cellIndex>n.cellIndex;if(i.ownerTable===n.ownerTable)return i.ownerRow.rowIndex>n.ownerRow.rowIndex;var r=this.getContainerCellOf(i,n);return r.ownerTable.contains(n)?(i=this.getSelectedCell(i,r),n=this.getSelectedCell(n,r),i===r?this.isExistAfter(e,n.ownerTable):n===r?this.isExistAfter(i.ownerTable,t):r.ownerRow===n.ownerRow?r.cellIndex>n.cellIndex:r.ownerTable===n.ownerTable?r.ownerRow.rowIndex>n.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,n.ownerTable)):this.isExistAfter(r.ownerTable,this.getContainerTable(n.ownerTable))}var o=this.getContainerTable(e);return this.isExistAfter(o,t)}return t.isInsideTable?(o=this.getContainerTable(t),this.isExistAfter(e,o)):e.containerWidget===t.containerWidget?e.index>t.index:(e.containerWidget instanceof j&&t.containerWidget instanceof j||e.containerWidget instanceof Y&&t.containerWidget instanceof Y)&&this.documentHelper.pages.indexOf(e.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)},s.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,n=t.line.paragraph;if(i.containerWidget===n.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<n.associatedCell.childWidgets.indexOf(n);if(!(i.containerWidget instanceof Ce))return i.containerWidget.childWidgets.indexOf(i)<n.containerWidget.childWidgets.indexOf(n)}return this.isExistBefore(i,n)},s.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line){var n=this.documentHelper.selection;return i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&n.start.offset!==n.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t)}if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var r=e.line.paragraph,o=t.line.paragraph;if(r.containerWidget===o.containerWidget){if(r.isInsideTable)return r.associatedCell.childWidgets.indexOf(r)>o.associatedCell.childWidgets.indexOf(o);if(!(r.containerWidget instanceof Ce))return r.containerWidget.childWidgets.indexOf(r)>o.containerWidget.childWidgets.indexOf(o)}return this.isExistAfter(r,o)},s.prototype.getNextRenderedBlock=function(e){return(0,a.le)(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},s.prototype.getPreviousRenderedBlock=function(e){return(0,a.le)(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},s.prototype.getNextParagraphBlock=function(e){return e.nextRenderedWidget instanceof I?e.nextRenderedWidget:e.nextRenderedWidget instanceof k?this.getFirstParagraphInFirstCell(e.nextRenderedWidget):e.containerWidget instanceof V?this.getNextParagraphCell(e.containerWidget):e.containerWidget instanceof j?this.getNextParagraph(e.containerWidget):e.containerWidget instanceof Ce&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},s.prototype.getFirstBlockInNextHeaderFooter=function(e){var i,t=e.containerWidget;if(-1!==t.headerFooterType.indexOf("Header"))i=t.page.footerWidget.firstChild;else{if(!t.page.nextPage)return;var n=t.page.nextPage,r=n.headerWidget;r.page=n,n.footerWidget&&(n.footerWidget.page=n),i=r.firstChild}return i instanceof I?i:this.getFirstBlockInFirstCell(i)},s.prototype.getLastBlockInPreviousHeaderFooter=function(e){var i,t=e.containerWidget;if(-1!==t.headerFooterType.indexOf("Footer"))i=t.page.headerWidget.lastChild;else{if(!t.page.previousPage)return;var n=t.page.previousPage,r=n.footerWidget;r.page=n,n.headerWidget&&(n.headerWidget.page=n),i=r.lastChild}return i instanceof I?i:this.getFirstBlockInFirstCell(i)},s.prototype.getPreviousParagraphBlock=function(e){return e.previousRenderedWidget instanceof I?e.previousRenderedWidget:e.previousRenderedWidget instanceof k?this.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof V?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof j?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof Ce&&this.isMoveDownOrMoveUp?this.getLastBlockInPreviousHeaderFooter(e):void 0},s.prototype.getFirstParagraphBlock=function(e){return e instanceof I?e:e instanceof k?this.getFirstParagraphInFirstCell(e):void 0},s.prototype.getLastParagraphBlock=function(e){return e instanceof I?e:e instanceof k?this.getLastParagraphInLastCell(e):void 0},s.prototype.hasValidInline=function(e,t,i){for(var r=e.childWidgets.indexOf(t.line);r<e.childWidgets.length;r++)for(var o=0;o<e.childWidgets[r].children.length;o++){var l=e.childWidgets[r].children[o];if(0!==l.length){if(l===i)return!1;if(l instanceof S||l instanceof ee||l instanceof H&&w.isLinkedFieldCharacter(l))return!0}}return!1},s.prototype.getParagraphLength=function(e,t,i){for(var n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(t instanceof oe&&t===o){i&&(n+=this.getLineLength(o,i));break}n+=this.getLineLength(o)}return n},s.prototype.getLineLength=function(e,t){for(var i=0,n=e.paragraph.bidi,r=n?e.children.length-1:0;n?r>-1:r<e.children.length;n?r--:r++){var o=e.children[r];if(!(o instanceof _)){if(t&&t.element instanceof fe&&t.element===o){i+=t.index;break}i+=o.length}}return i},s.prototype.getLineInfo=function(e,t){for(var i=void 0,n=0,r=e.childWidgets.length,o=0;o<r&&!(t<=(n=this.getLineLength(i=e.childWidgets[o]))||o===r-1);o++)t-=n;return{line:i,offset:t}},s.prototype.getElementInfo=function(e,t){for(var i=void 0,n=0;n<e.children.length;n++)if(!((i=e.children[n])instanceof _)){if(!(t>i.length)||t===i.length+1&&(0,a.le)(i.nextNode))break;t-=i.length}return{element:i,index:t}},s.prototype.getStartOffset=function(e){return e.childWidgets.length>0?this.getStartLineOffset(e.childWidgets[0]):0},s.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];if(0!==n.length){if(n instanceof S||n instanceof ee||n instanceof O||n instanceof de||n instanceof xe||n instanceof He||n instanceof ae||n instanceof H&&w.isLinkedFieldCharacter(n)||n instanceof $)return t;n instanceof _||(t+=n.length)}}return t},s.prototype.getPreviousSelectionCell=function(e){if(!(0,a.le)(e.previousRenderedWidget)){if(this.isForward){var i=e.previousRenderedWidget.childWidgets;return(t=i[i.length-1])instanceof I?t:this.getPreviousParagraphSelection(t.childWidgets[t.childWidgets.length-1])}var t;return(t=e.previousRenderedWidget.childWidgets[0])instanceof I?t:this.getFirstParagraphInLastRow(t)}return this.getPreviousSelectionRow(e.ownerRow)},s.prototype.getPreviousSelectionRow=function(e){return(0,a.le)(e.previousRenderedWidget)?this.getPreviousSelectionBlock(e.ownerTable):this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget):this.getFirstParagraphBlock(e.previousRenderedWidget.childWidgets[0].childWidgets[0])},s.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof I?e.nextRenderedWidget:e.nextRenderedWidget instanceof k?this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof V?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof j?this.getNextSelection(e.containerWidget):void 0},s.prototype.getNextSelectionCell=function(e){var t;return(0,a.le)(e.nextRenderedWidget)?this.getNextSelectionRow(e.ownerRow):this.isEmpty||this.isForward?this.getLastParagraphBlock(t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1]):(t=e.nextRenderedWidget.childWidgets[0])instanceof I?t:this.getNextParagraphSelection(t.childWidgets[0])},s.prototype.getNextSelectionRow=function(e){if(!(0,a.le)(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var i=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.getLastParagraphBlock(i.childWidgets[i.childWidgets.length-1])}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},s.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof j){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof I?t:this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},s.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}return this.getFirstParagraphBlock(t.childWidgets[0])},s.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof I?e.previousRenderedWidget:e.previousRenderedWidget instanceof k?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof V?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof j?this.getPreviousSelection(e.containerWidget):void 0},s.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof j){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return i instanceof I?i:this.isForward?this.getPreviousParagraphSelection(i.childWidgets[i.childWidgets.length-1]):this.getFirstParagraphInLastRow(i)}},s.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}return this.getLastParagraphBlock(t.childWidgets[t.childWidgets.length-1])},s.prototype.getLastCellInRegion=function(e,t,i,n){var r=this.getCellLeft(e,t),o=r+t.cellFormat.cellWidth,l=!0;if(r<=i&&i<o)for(var h=e.childWidgets.length-1;h>=0;h--){var d=this.getCellLeft(e,e.childWidgets[h]);if(w.round(r,2)<=w.round(d,2)&&w.round(d,2)<w.round(o,2))return l=!1,e.childWidgets[h]}else for(h=e.childWidgets.length-1;h>=0;h--)if((d=this.getCellLeft(e,e.childWidgets[h]))<=i&&d+e.childWidgets[h].cellFormat.cellWidth>i)return l=!1,e.childWidgets[h];if(l){if(!(0,a.le)(e.previousRenderedWidget)&&n)return this.getLastCellInRegion(e.previousRenderedWidget,t,i,n);if(!(0,a.le)(e.nextRenderedWidget)&&!n)return this.getLastCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[e.childWidgets.length-1]},s.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},s.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0)return this.getFirstParagraphBlock(e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0])},s.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,n=0,o=0;o<e.childWidgets.length;o++)for(var l=e.childWidgets[o],h=0;h<l.children.length;h++){var d=l.children[h];if(!(0===d.length||d instanceof _)){if(t<=n+d.length)return t-1===n?i:t-1;(d instanceof S||d instanceof ee||d instanceof O||d instanceof H&&w.isLinkedFieldCharacter(d))&&(i=n+d.length),n+=d.length}}return t-1===n?i:t-1},s.prototype.getNextValidOffset=function(e,t){for(var i=0,n=0;n<e.children.length;n++){var r=e.children[n];if(!(0===r.length||r instanceof _)){if(t<i+r.length&&(r instanceof S||r instanceof ee||r instanceof H&&w.isLinkedFieldCharacter(r)))return(t>i?t:i)+1;if(t===i+r.length&&r instanceof H&&1===r.fieldType&&r.previousNode instanceof ee)return t;i+=r.length}}return t},s.prototype.getParagraphMarkSize=function(e,t,i){var n=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),r=n.BaselineOffset,o=n.Height,l=r;if(e instanceof I){var d=this.documentHelper.layout.getLineSpacing(e,o),c=this.documentHelper.layout.getBeforeSpacing(e);t=l-r,i=o-l-(n.Height-r);var u=e.paragraphFormat.lineSpacingType;"Multiple"===u?d>o?i+=d-o:t+=d-o:("Exactly"===u||d>t+n.Height+i)&&(t+=d-(t+n.Height+i)),t+=c,i+=this.documentHelper.layout.getAfterSpacing(e)}return{width:n.Width,height:n.Height,topMargin:t,bottomMargin:i}},s.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var n=e.paragraph,r=n.x;n.childWidgets.length>0&&(r=this.getLeft(n.childWidgets[0]));var d=this.getParagraphMarkSize(e.paragraph,0,0);return t>0&&(r+=d.width),new ce(r,n.y+0)}var c=0,u=e.getInline(t,c,e.paragraph.bidi);return this.getPhysicalPositionInline(u.element,c=u.index,i)},s.prototype.highlightSelectedContent=function(e,t){if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&!this.isCellSelected(e.paragraph.associatedCell,e,t)){var i=void 0,n=0;if(!this.owner.isReadOnlyMode&&e.paragraph===t.paragraph)if(e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,n);n=r.index,((i=r.element)instanceof ee||i instanceof de)&&e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}else{var l=0,h=e.currentWidget.getInline(e.offset,l),d=h.element;(l=h.index)===d.length&&(d=this.getNextRenderedElementBox(d,l));var c=t.currentWidget.getInline(t.offset,l),u=c.element;if(l=c.index,d instanceof H&&u instanceof H&&!(0,a.le)(d.fieldSeparator)){var p=d.fieldSeparator.nextNode;p instanceof ee&&p.nextNode===u&&(i=p)}}if(!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(i instanceof ee||i instanceof de)){var f=this.getElementBoxInternal(i,n);n=f.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(f.element),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")}else this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);this.isInShape&&this.showResizerForShape()}else this.highlightCell(e.paragraph.associatedCell,this,e,t)},s.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},s.prototype.highlight=function(e,t,i){var d,n=0,r=0,o=void 0,l=void 0,h=void 0,c=this.getStartLineWidget(e,t,o,n);h=(0,a.le)(o=c.element)?e.childWidgets[0]:o.line,n=c.index;var u=this.getEndLineWidget(i,l,r);d=(l=u.element)?l.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],r=u.index;var p=0,f=0;if((0,a.le)(h)||(p=this.getTop(h),f=this.getLeftInternal(h,o,n)),(0,a.le)(h)||h!==d){if(!(0,a.le)(h)){if(e!==h.paragraph&&(e=h.paragraph),m=this.getWidth(h,!0)-(f-h.paragraph.x),e.bidi||o instanceof S&&o.isRightToLeft){g=0;var L=this.getElementsForward(h,o,l,e.bidi);if(L){for(F=!1,b=0;b<L.length;b++)F=!1,f=this.getLeftInternal(h,C=L[b],C===o?n:0),g=this.getLeftInternal(h,C,T=C instanceof S?C.length:1),C instanceof S&&(F=C.isRightToLeft),m=Math.abs(g-f),this.createHighlightBorder(h,m,F?g:f,p,!0);h.isLastLine()&&(P=this.documentHelper.textHelper.getParagraphMarkSize(L[L.length-1].line.paragraph.characterFormat).Width,f=e.bidi?this.getLineStartLeft(h)-P:F?h.paragraph.x+this.getWidth(h,!1):g,this.createHighlightBorder(h,P,f,p,!0))}else this.createHighlightBorder(h,m,f,p,!1)}else this.createHighlightBorder(h,m,f,p,!1);var W=h.paragraph.childWidgets.indexOf(h);if(this.highlightParagraph(e,W+1,d,l,r),-1!==e.childWidgets.indexOf(i.currentWidget))return}if(this.isHideSelection(e))return void(this.isHighlightNext=!1);this.isHighlightNext=!0,this.hightLightNextParagraph=e}else{var g=this.getLeftInternal(d,l,r),m=0,v=!1;if(l instanceof S&&(v=l.isRightToLeft),!v&&o instanceof S&&(v=o.isRightToLeft),m=Math.abs(g-f),v||e.bidi){var y=this.getElementsForward(h,o,l,e.bidi);if(y&&y.length>1)for(var b=0;b<y.length;b++){var C,F=!1,T=(C=y[b])instanceof S?C.length:1;if(C===o?(f=this.getLeftInternal(h,C,n),g=this.getLeftInternal(h,C,T)):C===l?(f=this.getLeftInternal(h,C,0),g=this.getLeftInternal(h,C,r)):(f=this.getLeftInternal(h,C,0),g=this.getLeftInternal(h,C,T)),C instanceof S&&(F=C.isRightToLeft),m=Math.abs(g-f),C===l&&C instanceof S&&r>C.length){var P=this.documentHelper.textHelper.getParagraphMarkSize(C.line.paragraph.characterFormat).Width;if(e.bidi&&!F){this.createHighlightBorder(h,m-=P,f,p,!0),f=this.getLineStartLeft(h)-P,this.createHighlightBorder(h,P,f,p,!0);continue}}this.createHighlightBorder(h,m,F?g:f,p,!0)}else if(l instanceof S&&r>l.length){P=this.documentHelper.textHelper.getParagraphMarkSize(l.line.paragraph.characterFormat).Width;!e.bidi&&v?(this.createHighlightBorder(h,m-=P,g+=P,p,!0),this.createHighlightBorder(h,P,g+=l.width,p,!0)):e.bidi&&!v?(this.createHighlightBorder(h,m-=P,f,p,!0),f=this.getLineStartLeft(h)-P,this.createHighlightBorder(h,P,f,p,!0)):this.createHighlightBorder(h,m,v?g:f,p,!1)}else this.createHighlightBorder(h,m,v?g:f,p,!1)}else this.createHighlightBorder(h,m,e.bidi?g:f,p,!1)}},s.prototype.highlightNextBlock=function(e,t,i){var n=e.nextRenderedWidget;(0,a.le)(n)||(n instanceof I?(this.isHighlightNext=!1,this.highlight(n,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(n,t,i))},s.prototype.getStartLineWidget=function(e,t,i,n){var o,r=e===t.paragraph?t.offset:this.getStartOffset(e);if(n=(o=e===t.paragraph?t.currentWidget.getInline(r,n):e.firstChild.getInline(r,n)).index,(i=o.element)instanceof H){var l=this.getRenderedInline(i,n);i=l.element,n=l.index}return r===this.getParagraphLength(t.paragraph)+1&&n++,{index:n,element:i}},s.prototype.getEndLineWidget=function(e,t,i){var n=e.currentWidget.getInline(e.offset,i);if(i=n.index,(t=n.element)instanceof H){var r=this.getRenderedInline(t,i);t=r.element,i=r.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},s.prototype.getLineWidgetInternal=function(e,t,i){var n=void 0;if(0===e.children.length&&e instanceof oe)n=e;else{var r=0,o=e.getInline(t,r),l=o.element;r=o.index,n=l instanceof fe?l.line:this.getLineWidgetInternalInline(l,r,i)}return n},s.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var n=0,r=t.getInline(e,n);i=this.getLineWidget(r.element,n=r.index)}return i},s.prototype.highlightCells=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),l=o+i.cellFormat.cellWidth;n>o&&(n=o),r<l&&(r=l),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);var h=e.getSplitWidgets(),d=h.indexOf(t.ownerRow.ownerTable),c=h.indexOf(i.ownerRow.ownerTable);if(d===c)for(var u=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow);p<=u;p++)this.highlightRow(e.childWidgets[p],n,r);else{var f=0,g=0;for(p=d;p<=c;p++){e=h[p],f=p===d?e.childWidgets.indexOf(t.ownerRow):0,g=p===c?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var m=f;m<=g;m++)this.highlightRow(e.childWidgets[m],n,r)}}},s.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),(!i.paragraph.isInsideTable||!e.contains(i.paragraph.associatedCell))&&this.highlightNextBlock(e,t,i)},s.prototype.getCellLeft=function(e,t){return 0+(t.x-t.margin.left)},s.prototype.getNextParagraphRow=function(e){return(0,a.le)(e.nextRenderedWidget)?this.getNextParagraphBlock(e.ownerTable):this.getFirstParagraphBlock(e.nextRenderedWidget.childWidgets[0].childWidgets[0])},s.prototype.getPreviousParagraphRow=function(e){if(!(0,a.le)(e.previousRenderedWidget)){var t=e.previousRenderedWidget.lastChild;return this.getLastParagraphBlock(t.lastChild?t.lastChild:t.previousSplitWidget.lastChild)}return this.getPreviousParagraphBlock(e.ownerTable)},s.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},s.prototype.highlightRow=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=this.getCellLeft(e,e.childWidgets[n]);w.round(t,2)<=w.round(r,2)&&w.round(r,2)<w.round(i,2)&&this.highlightCellWidget(e.childWidgets[n])}},s.prototype.highlightInternal=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.highlightCellWidget(e.childWidgets[n]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof Q&&this.highlightInternal(e.nextRenderedWidget,t,i)},s.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;return this.getLastParagraphBlock(e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild)},s.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},s.prototype.isCellSelected=function(e,t,i){var n=this.getLastParagraph(e);return n===i.paragraph&&i.offset===this.getParagraphLength(n)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},s.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},s.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},s.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof V&&e.push(i)}return e},s.prototype.getLevelFormatNumber=function(){var e="%";return e+((this.paragraphFormat.listLevelNumber<=0?0:this.paragraphFormat.listLevelNumber)+1)+"."},s.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof V){(e=e.nextRenderedWidget).getSplitWidgets()[0]instanceof V&&(e=e.getSplitWidgets()[0]);var t=e.firstChild;return t?this.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return this.getNextParagraphRow(e.containerWidget)},s.prototype.getPreviousParagraphCell=function(e){return!(0,a.le)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof V?this.getLastParagraphBlock((e=e.previousRenderedWidget).lastChild):this.getPreviousParagraphRow(e.ownerRow)},s.prototype.getContainerCell=function(e){for(;!(0,a.le)(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},s.prototype.highlightCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),l=this.getSelectedCell(n.paragraph.associatedCell,r);if(this.containsCell(r,n.paragraph.associatedCell))this.isCellSelected(r,i,n)?this.highlightCellWidget(r):o===r?(this.highlight(i.paragraph,i,n),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,n),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(o,i,n);else if(this.highlightCellWidget(r),r.ownerRow.equals(l.ownerRow))for(o=r;!(0,a.le)(o.nextRenderedWidget)&&(this.highlightCellWidget(o=o.nextRenderedWidget),o!==l););else this.highlightCells(r.ownerTable,r,l)}else this.highlightContainer(r,i,n)}else{var h=this.getContainerCell(e);this.highlightContainer(h,i,n)}},s.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},s.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof H;)w.isLinkedFieldCharacter(e)&&(e instanceof H&&0===e.fieldType?t=e:e instanceof H&&1===e.fieldType?(t=e,(0,a.le)(e.fieldSeparator)&&(t=e=e.fieldBegin)):t=e=e.fieldBegin),e=e.previousNode;return(0,a.le)(t)?e:t},s.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof O&&1===e.bookmarkType)return e;for(;e instanceof H;){if(0===e.fieldType&&!(0,a.le)(e.fieldEnd))return(0,a.le)(t)?e:t;1===e.fieldType&&!(0,a.le)(e.fieldBegin)&&(t=e),e=e.nextNode}return(0,a.le)(t)?e:t},s.prototype.validateTextPosition=function(e,t){var i=e.nextNode;if(e.length===t&&(i instanceof H||!(e instanceof ee)&&(i instanceof O||i instanceof ae))){var n=this.getNextValidElement(e.nextNode);(n instanceof H&&1===n.fieldType||n instanceof O&&1===n.bookmarkType||n instanceof ae&&1===n.commentType)&&(e=n,t=this.documentHelper.isFormFillProtectedMode?0:1)}else 0===t&&e.previousNode instanceof H&&(t=(e=this.getPreviousValidElement(e.previousNode))instanceof H?0:e.length,e instanceof H&&1===e.fieldType&&t++);return{element:e,index:t}},s.prototype.getPhysicalPositionInline=function(e,t,i){var n=void 0;n=this.getElementBox(e,t,i).element;var r=void 0;if((0,a.le)(n)||(0,a.le)(n.line)){if(!(e instanceof H&&1===e.fieldType))return e instanceof H||e instanceof O||e instanceof ae?this.getFieldCharacterPosition(e):new ce(0,0);n=e}var h,o=n.margin,l=0;if(n instanceof S&&"\v"===n.text&&(0,a.le)(e.nextNode)?(r=this.getNextLineWidget(n.line.paragraph,n),t=0):r=n.line,l=this.getTop(r),n instanceof ee&&"Inline"===n.textWrappingStyle){var d=n.line.paragraph.characterFormat,c=this.getPreviousTextElement(e);if((0,a.le)(c)){var u=this.getNextTextElement(e);(0,a.le)(u)||(d=u.characterFormat)}else d=c.characterFormat;var p=this.documentHelper.textHelper.getHeight(d);n.margin.top+n.height-p.BaselineOffset>0&&(l+=n.margin.top+n.height-p.BaselineOffset)}else n instanceof H||(l+=o.top>0?o.top:0);return h=(0,a.le)(n)||(0,a.le)(r)?0:this.getLeftInternal(r,n,t),new ce(h,l)},s.prototype.getFieldCharacterPosition=function(e){var t=this.getNextValidElementForField(e);return(0,a.le)(t)?this.getEndPosition(e.line.paragraph):this.getPhysicalPositionInline(t,0,!0)},s.prototype.getNextValidElementForField=function(e){if(e instanceof H&&0===e.fieldType&&w.isLinkedFieldCharacter(e)){var t=e;e=(0,a.le)(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator}var i=void 0;return(0,a.le)(e.nextNode)||(i=this.getNextValidElement(e.nextNode)),i},s.prototype.getEndPosition=function(e){var t=e.x,i=e.y,n=void 0;e.childWidgets.length>0&&(t+=this.getWidth(n=e.childWidgets[e.childWidgets.length-1],!1)),(0,a.le)(n)||(i=this.getTop(n));var l=this.getParagraphMarkSize(e,0,0);return new ce(t,i+l.topMargin)},s.prototype.getElementBox=function(e,t,i){var n=void 0;return e instanceof H||e instanceof O||e instanceof ae||(n=e),{element:n,index:t}},s.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof S?e.previousNode:(0,a.le)(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},s.prototype.getNextTextElement=function(e){return e.nextNode instanceof S?e.nextNode:(0,a.le)(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},s.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof H){if(0===(i=e).fieldType&&i===(e=this.getRenderedField(i)))return i;t=1}for(;!(0,a.le)(e)&&t===e.length&&e.nextNode instanceof H;){var n=this.getNextValidElement(e.nextNode);if(n instanceof H&&0===n.fieldType){var i;if(e=this.getRenderedField(i=n),!(0,a.le)(e)&&i===e)return i;t=1}else e=n}return e},s.prototype.getElementBoxInternal=function(e,t){return{element:e,index:t}},s.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},s.prototype.getLineWidgetInternalInline=function(e,t,i){var n=this.getElementBox(e,t,i),r=n.element;if(t=n.index,!(0,a.le)(r))return i&&r instanceof S&&"\v"===r.text&&1===t?this.getNextLineWidget(r.line.paragraph,r):r.line;var o=e,l=this.getNextValidElementForField(o);if((0,a.le)(l)){var h=void 0,d=o.line.paragraph;return d.childWidgets.length>0&&(h=d.childWidgets[d.childWidgets.length-1]),h}return this.getLineWidget(l,0)},s.prototype.getNextLineWidget=function(e,t){var i=void 0,n=e;if(n.childWidgets.length>0){var r=n.childWidgets.indexOf(t.line);r===n.childWidgets.length-1?(n=e,r=-1):r>n.childWidgets.length-1?(n=this.getNextParagraphBlock(e),r=-1):r<0&&(r=(n=e).childWidgets.indexOf(t.line)),i=n.childWidgets[r+1]}return i},s.prototype.getCaretHeight=function(e,t,i,n,r,o){var h=this.getElementBox(e,t,!1).element,d=e;if((0,a.le)(h))return d instanceof H?this.getFieldCharacterHeight(d,i,n,r,o):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:r,isItalic:o};var c=h.margin,u=h.height,p=0;if(h instanceof ee){var f=this.getPreviousTextElement(e),g=this.getNextTextElement(e);if((0,a.le)(f)&&(0,a.le)(g)){var m=0,v=0,y=e.line.paragraph,b=this.getParagraphMarkSize(y,m,v);m=b.topMargin,v=b.bottomMargin,p=b.height,o=y.characterFormat.italic,n||(p+=this.documentHelper.layout.getAfterSpacing(y))}else{if((0,a.le)(f))return this.getCaretHeight(g,0,g.characterFormat,n,r,o=g.characterFormat.italic);if((0,a.le)(g)||!(h instanceof ee))return this.getCaretHeight(f,f.length,f.characterFormat,n,r,o=f.characterFormat.italic);var C=this.documentHelper.textHelper.getHeight(h.characterFormat),F=C.Height,T=C.BaselineOffset;p=h.margin.top<0&&T>h.margin.top+h.height?h.margin.top+h.height+F-T:F,n||(p+=h.margin.bottom)}}else{var x=i.baselineAlignment,P=u;"Normal"!==x&&n&&(P/=1.5,"Subscript"===x&&(r=u-P)),p=(c.top<0?c.top:0)+P,n||(p+=c.bottom)}if(!n)return{height:p,topMargin:r,isItalic:o};var E=this.documentHelper.textHelper.getHeight(i).Height;return E>p&&(E=p),{height:E,topMargin:r,isItalic:o}},s.prototype.getFieldCharacterHeight=function(e,t,i,n,r){var o=this.getNextValidElementForField(e);if((0,a.le)(o)){var l=e.line.paragraph,h=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,d=0,c=0,u=this.getParagraphMarkSize(l,d,c),p=u.height;return d=u.topMargin,c=u.bottomMargin,i?(h>p&&(h=p),{height:h,topMargin:n,isItalic:r}):{height:p+=c,topMargin:n,isItalic:r}}return this.getCaretHeight(o,0,t,i,n,r)},s.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var i=this.getPreviousValidElement(e);i instanceof H;)(i=this.getPreviousTextElement(i))instanceof H&&(i=i.previousNode);if(!(0,a.le)(i))return{element:i,index:t=i.length};t=0;var n=this.getNextRenderedElementBox(e,0);if(n instanceof H&&0===n.fieldType)for(n=(n=n.fieldSeparator).nextNode;n instanceof H;)n instanceof H&&0===n.fieldType&&w.isLinkedFieldCharacter(n)&&(n=(0,a.le)(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator),n=n.nextNode;return{element:n,index:t}},s.prototype.getRenderedField=function(e){var t=e;if((0,a.le)(e.fieldSeparator))t=e.fieldEnd;else{var i=(t=e.fieldSeparator).line.paragraph;if(i!==e.fieldEnd.line.paragraph||this.hasValidInline(i,t,e.fieldEnd))return t;t=e.fieldEnd}return t},s.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof H;){var i=this.getNextValidElement(e.nextNode);if(t=0,i instanceof H&&0===i.fieldType&&(e=i),e instanceof H&&0===e.fieldType&&!(0,a.le)(e.fieldEnd)){var n=e;if((0,a.le)(n.fieldSeparator))e=n.fieldEnd,t=1;else{var r=(e=n.fieldSeparator).line.paragraph;if(t=1,r!==n.fieldEnd.line.paragraph||this.hasValidInline(r,e,n.fieldEnd))break;e=n.fieldEnd}}}return t===e.length&&(0,a.le)(e.nextNode)},s.prototype.getPage=function(e){var t=void 0;if(e.containerWidget instanceof be){var i=e.containerWidget.containerShape;i.line&&(t=this.getPage(i.line.paragraph))}else e.containerWidget instanceof Ye?t=e.containerWidget.page:(0,a.le)(e.containerWidget)||(t=this.getPage(e.containerWidget));return t},s.prototype.clearSelectionHighlightInSelectedWidgets=function(){for(var e=!1,t=this.selectedWidgets.keys,i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;return this.selectedWidgets.clear(),e},s.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof oe?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof V?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof Ze&&this.clearChildSelectionHighlight(e.childWidgets[t])},s.prototype.getLineWidgetBodyWidget=function(e,t){var i=e;if(i instanceof Ye)for(var n=0;n<i.floatingElements.length;n++){var r=i.floatingElements[n];if(r instanceof k){var o=r.getTableCellWidth();if(t.x<=r.x+o&&t.x>=r.x&&t.y<=r.y+r.height&&t.y>=r.y)return this.getLineWidgetTableWidget(r,t)}}if(e instanceof Y)for(var l=0;l<e.bodyWidgets.length;l++)for(var h=0;h<e.bodyWidgets[l].childWidgets.length;h++){var d=e.bodyWidgets[l].childWidgets[h];if(d instanceof Ze&&d.y<=t.y&&d.y+d.height>=t.y)return d instanceof I?this.getLineWidgetParaWidget(d,t):this.getLineWidgetTableWidget(d,t)}for(var c=0;c<e.childWidgets.length;c++){if((u=e.childWidgets[c])instanceof Y)return u[c];if(u instanceof Ze&&u.y<=t.y&&u.y+u.height>=t.y){if(u instanceof I)return this.getLineWidgetParaWidget(u,t);var p=u;if(p.wrapTextAround)continue;return this.getLineWidgetTableWidget(p,t)}}var f=void 0;if(e.childWidgets.length>0){var g=e.childWidgets[0];if(g instanceof Ze&&g.y<=t.y)f=e.childWidgets[e.childWidgets.length-1]instanceof I?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[e.childWidgets.length-1],t);else{var u=void 0;g instanceof Ze&&(u=g),(0,a.le)(u)||(f=u instanceof I?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t))}}return f},s.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,n=e.y,r=0;r<i.length;r++){var o=i[r],l=o.height;if(o.nextLine&&o.nextLine.marginTop>0&&(l+=o.nextLine.marginTop),(n+=o.marginTop)<=t.y&&n+l>=t.y)return o;n+=o.height}var h=void 0;return i.length>0&&(h=e.y<=t.y?i[i.length-1]:i[0]),h},s.prototype.highlightParagraph=function(e,t,i,n,r){var o=0,l=0,h=!1;e.paragraphFormat.bidi&&i.children.indexOf(n)>0&&(n=i.children[0]);for(var d=t;d<e.childWidgets.length;d++){var c=e.childWidgets[d];d===t?o=this.getTop(c):o+=c.marginTop,n instanceof S&&(h=n.isRightToLeft);var u=this.getLeft(c);if(c===i){var p=0;if(h||e.bidi){for(var f=this.getElementsBackward(c,n,n,e.bidi),g=0;g<f.length;g++){var m=f[g],v=!1;if(p=this.getLeftInternal(c,m,m===n?r:m instanceof S?m.length:1),u=this.getLeftInternal(c,m,0),m instanceof S&&(v=m.isRightToLeft),l=Math.abs(p-u),m===n&&m instanceof S&&r>m.length){var b=this.documentHelper.textHelper.getParagraphMarkSize(m.line.paragraph.characterFormat).Width;if(!e.bidi&&v)p+=b;else if(e.bidi&&!v){this.createHighlightBorder(c,l-=b,u,o,!0),u=this.getLineStartLeft(c)-b,this.createHighlightBorder(c,b,u,o,!0);continue}}this.createHighlightBorder(c,l,v?p:u,o,!0)}return}return p=this.getLeftInternal(i,n,r),l=Math.abs(p-u),void this.createHighlightBorder(c,l,h?p:u,o,!1)}l=this.getWidth(c,!0)-(u-e.x),e.bidi&&c.isLastLine()&&(u-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(c,l,u,o,!1),o+=c.height}},s.prototype.getLineWidgetTableWidget=function(e,t){for(var i=void 0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof Q&&r.y<=t.y){if("Exactly"===r.rowFormat.heightType&&r.y+w.convertPointToPixel(r.rowFormat.height)<t.y)continue;i=this.getLineWidgetRowWidget(r,t);var o=void 0;!(0,a.le)(i)&&i.paragraph.containerWidget instanceof V&&(o=i.paragraph.containerWidget);var l=0,h=0;(0,a.le)(o)||(l=w.convertPointToPixel((d=o.ownerRow.containerWidget).tableFormat.cellSpacing),h=o.cellFormat.rowSpan);var c=0,u=0,p=0,f=0;if(l>0){c=0===o.cellIndex?l:l/2,u=o.cellIndex===o.ownerRow.childWidgets.length-1?l:l/2;var g=void 0;o.containerWidget instanceof Q&&(g=o.containerWidget);var d=void 0;o.containerWidget.containerWidget instanceof k&&(d=o.containerWidget.containerWidget),!(0,a.le)(g)&&!(0,a.le)(d)&&(p=0===o.ownerRow.rowIndex?l:l/2,f=o.ownerRow.rowIndex+h===o.ownerTable.childWidgets.length?l:l/2)}if(!(0,a.le)(i)&&i.paragraph.x<=t.x&&i.paragraph.x+i.width>=t.x&&i.paragraph.y<=t.y&&this.getTop(i)+i.height>=t.y||!(0,a.le)(o)&&o.x-o.margin.left-c<=t.x&&o.x+o.width+o.margin.right+u>=t.x&&o.y-o.margin.top-p<=t.y&&o.y+o.height+o.margin.bottom+f>=t.y)break}}return i},s.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n,r=0,o=0;if((n=w.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))>0&&(r=0===e.childWidgets[i].columnIndex?n:n/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?n:n/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-r<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var l=void 0;return e.childWidgets.length>0&&(l=this.getLineWidgetCellWidget(e.childWidgets[0].x<=t.x?e.childWidgets[e.childWidgets.length-1]:e.childWidgets[0],t)),l},s.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},s.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)this.clearChildSelectionHighlight(e=t[i]),this.createHighlightBorderInsideTable(e)},s.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},s.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof I?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var n=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y<=t.y&&(n=e.childWidgets[e.childWidgets.length-1]instanceof I?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),n},s.prototype.updateTextPosition=function(e,t){var i=t,n=void 0,r=0,o=!1,l=this.updateTextPositionIn(e,n,r,t,!1);(0,a.le)(l)||(n=l.element,r=l.index,i=l.caretPosition,this.isImageSelected=o=l.isImageSelected),o?(this.selectInternal(e,n,r,i),0===r?this.extendForward():this.extendBackward()):this.selectInternal(e,n,r,i)},s.prototype.updateTextPositionIn=function(e,t,i,n,r){var o=!1,l=this.getTop(e),h=e.paragraph.x,d=this.getFirstElement(e,h),c=d.element,u=!1,p=!1;h=d.left;var f=e.renderedElements;if((0,a.le)(c)){var g=0,m=0,v=this.getParagraphMarkSize(e.paragraph,g,m);m=v.bottomMargin,(!(this.documentHelper.mouseDownOffset.y>=l&&this.documentHelper.mouseDownOffset.y<l+e.height)||this.documentHelper.mouseDownOffset.x<h+v.width)&&r&&n.x>h+v.width/2&&(h+=v.width,f.length>0&&(i=(t=f[f.length-1]).length),i++),n=new ce(h,(g=v.topMargin)>0?l+g:l)}else if(!(0,a.le)(c)){if(n.x>h+c.margin.left||c instanceof Pe&&"Inline"!==c.textWrappingStyle){var b=!1;e.paragraph.floatingElements.length>0&&(b=this.documentHelper.checkPointIsInLine(e,n));for(var C=f.indexOf(c);C<f.length;C++)if((c=f[C])instanceof Pe&&"Inline"!==c.textWrappingStyle){if(this.documentHelper.isInShapeBorder(c,n)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!b){h=c.x,l=c.y;break}}else{var F=!1;if((c instanceof _||c instanceof S)&&(F=c.line.paragraph.paragraphFormat.bidi),n.x<h+c.margin.left+c.width+c.padding.left||C===f.length-1||f[C+1]instanceof _&&F)break;h+=c.margin.left+c.width+c.padding.left}if(c instanceof S&&(u=c.isRightToLeft,p=c.line.paragraph.paragraphFormat.bidi),n.x>h+c.margin.left+c.width+c.padding.left)i=c instanceof S?c.length:1,u&&p&&(i=0),(c instanceof S&&("\v"!==c.text||"\f"!==c.text)||r)&&(h+=c.margin.left+c.width+c.padding.left);else if(c instanceof S){c instanceof S&&u&&(h+=c.width+c.padding.left);var T;T=u?h+c.margin.left-n.x:n.x-h-c.margin.left-c.padding.left,h+=c.margin.left+c.padding.left;var x=0,P=0;for(C=1;C<=c.length;C++){var E=0;if(C===c.length?E=c.width+c.padding.left:(E=this.documentHelper.textHelper.getWidth(c.text.substr(0,C),c.characterFormat),c.trimEndWidth=E),T<E||C===c.length){if(T-x>(E-x)/2)u?h-=E:h+=E,P=C;else if(u?h-=x:h+=x,P=C-1,1===C&&c!==f[0]&&!(f[0]instanceof Pe&&"Inline"!==f[0].textWrappingStyle)){var W=f.indexOf(c);!(f[W-1]instanceof _)&&!u&&(P=(c=f[W-1])instanceof S?c.length:1)}break}x=E}i=P}else o=c instanceof ee||c instanceof de,n.x-h-c.margin.left>c.width/2?(i=1,h+=c.margin.left+c.width+c.padding.left):c===f[0]||o||(W=f.indexOf(c),f[W-1]instanceof _||(i=(c=f[W-1])instanceof S?c.length:1));c instanceof S&&("\v"===c.text||"\f"===c.text)&&(i=0)}else u=c.isRightToLeft,p=c.line.paragraph.paragraphFormat.bidi,i=c instanceof S&&(p||u)&&n.x<h+c.margin.left+c.width+c.padding.left?this.getTextLength(c.line,c)+c.length:this.getTextLength(c.line,c),h+=c.margin.left;if(c instanceof S)l+=c.margin.top>0?c.margin.top:0;else{var R=this.documentHelper.textHelper.getHeight(c.characterFormat),N=c.height;c instanceof O&&!this.documentHelper.layout.hasValidElement(c.line.paragraph)&&(N=R.Height),l+=c.margin.top+N-R.BaselineOffset}(t=c)instanceof H&&2===t.fieldType&&!(0,a.le)(t.fieldBegin)&&(t=t.fieldBegin,i=0),t instanceof He&&(i=0);var B=this.validateTextPosition(t,i);i=B.index;var q=(0,a.le)((t=B.element).nextNode)&&i===t.length,A=(0,a.le)(t.nextNode)&&t instanceof S&&"\v"===t.text;r&&t.nextNode instanceof H&&i===t.length&&(q=this.isLastRenderedInline(t,i)),(r&&q||A)&&(E=0,q?(E=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=l&&this.documentHelper.mouseDownOffset.y<l+e.height)||this.documentHelper.mouseDownOffset.x<h+E)&&n.x>h+E/2&&(h+=E,i=t.length+1)):A&&(h+=E=c.width+c.padding.left,i=t.length)),n=new ce(h,l)}return{element:t,index:i,caretPosition:n,isImageSelected:o}},s.prototype.checkAllFloatingElements=function(e,t){var i,o,n=!1,r=!1;if(!(0,a.le)(e)){i=e.paragraph.bodyWidget,n=!1,r=!1;for(var l=0;l<i.floatingElements.length;l++)if(!(i.floatingElements[l]instanceof k)&&t.x<(o=i.floatingElements[l]).x+o.margin.left+o.width&&t.x>o.x&&t.y<o.y+o.margin.top+o.height&&t.y>o.y){n=!0,this.documentHelper.isInShapeBorder(o,t)&&(r=!0);break}}return{element:o,caretPosition:t,isShapeSelected:n,isInShapeBorder:r}},s.prototype.getTextLength=function(e,t){var i=0,n=e.renderedElements,r=n.indexOf(t);n.length>0&&n[0]instanceof _&&(r-=n[1]instanceof _?2:1);for(var o=1;o<r;o++)i+=n[o].length;return i},s.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=w.convertPointToPixel(i.firstLineIndent));for(var n=e.renderedElements,r=0;r<n.length;r++){var o=n[r];if(!(o instanceof _)||i.bidi){t+=o.margin.left;break}t+=0===r?o.margin.left+o.width:o.width}return t},s.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),n=0;n<i;n++){var r=e.paragraph.childWidgets[n];t=t+r.height+r.marginTop}return t+e.marginTop},s.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi&&(i=w.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var n=void 0,r=e.renderedElements,o=0;o<r.length&&((n=r[o])instanceof _||n instanceof ae);o++){if(e.paragraph.paragraphFormat.bidi){t+=n.margin.left,n=void 0;break}t+=n.margin.left+n.width,n=void 0}return{element:n,left:t}},s.prototype.getIndexInInline=function(e){var t=0;if(e instanceof S)for(var i=e.line.children.indexOf(e),n=0;n<i;n++){var r=e.line.children[n];r instanceof H||r instanceof _||(t+=r.length)}return t},s.prototype.isParagraphFirstLine=function(e){return!(!(0,a.le)(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},s.prototype.isParagraphLastLine=function(e){return!(!(0,a.le)(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},s.prototype.getWidth=function(e,t){var i=0,n=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!n.bidi&&(i+=w.convertPointToPixel(n.firstLineIndent));for(var r=0;r<e.children.length;r++){var o=e.children[r];o instanceof Pe&&"Inline"!==o.textWrappingStyle||(i+=o.margin.left+o.width+o.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&(0,a.le)(e.paragraph.nextSplitWidget)&&(i+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),i},s.prototype.getLeftInternal=function(e,t,i){var n=e.paragraph.x,r=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!r.bidi&&(n+=w.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent));var o=e.renderedElements,l=o.indexOf(t);(1===o.length&&o[0]instanceof _||2===o.length&&o[0]instanceof _&&o[1]instanceof _)&&(l=o.length);for(var h=!1,d=0;d<l;d++){var c=o[d];c instanceof H&&2===c.fieldType&&(h=!1),!h&&(c instanceof Pe&&"Inline"!==c.textWrappingStyle||(n+=1===d&&c instanceof _?c.width:c instanceof at&&t===c?c.margin.left:c.margin.left+c.width+c.padding.left,c instanceof H&&0===c.fieldType&&(h=!0)))}var u=!1,p=e.paragraph.bidi;(0,a.le)(t)||(u=(t.characterRange&z.RightToLeft)===z.RightToLeft,p=t.line.paragraph.paragraphFormat.bidi,n+=t.margin.left+t.padding.left,t instanceof Pe&&!(0,a.le)(t.nextElement)&&(n+=t.nextElement.margin.left+t.nextElement.padding.left),(u||1===this.documentHelper.moveCaretPosition&&!u&&p)&&(n+=t.width));var f=0;if(t instanceof S){if(0!==this.documentHelper.moveCaretPosition&&(p||u))return(u&&p&&2===this.documentHelper.moveCaretPosition||u&&!p&&1===this.documentHelper.moveCaretPosition)&&(n-=t.width),this.documentHelper.moveCaretPosition=0,n;i!==t.length||u?i>t.length?(f=this.documentHelper.textHelper.getParagraphMarkWidth(t.line.paragraph.characterFormat),u?n-=t.width+f:n+=t.width+f):(f=this.documentHelper.textHelper.getWidth(t.text.substr(0,i),t.characterFormat),t.trimEndWidth=f,u?n-=f:n+=f):n+=t.width,this.documentHelper.moveCaretPosition=0}else i>0&&((0,a.le)(t)||t instanceof _?n+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat):(t instanceof Pe&&"Inline"!==t.textWrappingStyle||(n+=t.width),2===i&&(n+=this.documentHelper.textHelper.getParagraphMarkWidth(t.line.paragraph.characterFormat))));return n},s.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=w.convertPointToPixel(i.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},s.prototype.updateTextPositionWidget=function(e,t,i,n){var h,r=t,o=void 0,l=0;h=this.updateTextPositionIn(e,o,l,r,n),i.setPositionForSelection(e,o=h.element,l=h.index,r=h.caretPosition)},s.prototype.clearSelectionHighlightLineWidget=function(e){!(0,a.le)(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},s.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,n=0;n<i&&(t=e.children[n])instanceof _;n++)t=void 0;return t},s.prototype.selectRange=function(e,t){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0)},s.prototype.selectParagraphInternal=function(e,t){var i;if(!(0,a.le)(e)&&!(0,a.le)(e.firstChild))if(i=e.firstChild,t)this.start.setPosition(i,t);else{var n=i.getEndOffset();this.start.setPositionParagraph(i,n)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},s.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof k&&(e=t?this.getFirstParagraphInFirstCell(e):this.getLastParagraphInLastCell(e)),e instanceof I)if(i=new Z(this.owner),t)i.setPosition(e.firstChild,!0);else{var n=e.lastChild;i.setPositionParagraph(n,n.getEndOffset())}return i},s.prototype.selectContent=function(e,t){if((0,a.le)(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},s.prototype.selectInternal=function(e,t,i,n){this.start.setPositionForSelection(e,t,i,n),this.end.setPositionInternal(this.start),this.upDownSelectionLength=n.x,this.fireSelectionChanged(!0)},s.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},s.prototype.selectPosition=function(e,t){if((0,a.le)(e)||(0,a.le)(t))throw new Error("TextPosition cannot be undefined");if((0,a.le)(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if((0,a.le)(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},s.prototype.fireSelectionChanged=function(e,t){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),!this.isModifyingSelectionInternally&&(this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0),this.documentHelper.restrictEditingPane.isShowRestrictPane&&!this.skipEditRangeRetrieval&&this.documentHelper.restrictEditingPane.updateUserInformation(),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.documentHelper.updateFocus(),this.documentHelper.isInlineFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.getCurrentFormField()))},s.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},s.prototype.retrieveImageFormat=function(e,t){var i;e.currentWidget===t.currentWidget&&e.offset+1===t.offset&&((i=t.currentWidget.getInline(t.offset,0).element)instanceof ee&&e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0));i instanceof ee?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},s.prototype.getPreviousContextType=function(e){var i=this.start;if(i.offset>0){var n=i.currentWidget.getInline(i.offset,0).element;return n=e?n.previousElement:i.currentWidget.getInline(i.offset-1,0).element,this.getContextElement(n)}},s.prototype.getNextContextType=function(e){var i=this.start,n=i.currentWidget.getInline(i.offset,0).element;return n=e&&n.nextElement?n.nextElement:i.currentWidget.getInline(i.offset+1,0).element,this.getContextElement(n)},s.prototype.getContextElement=function(e){return e instanceof S?"Text":e instanceof H||e instanceof st?"Field":e instanceof O?"Bookmark":e instanceof ee?"Image":e instanceof de?"Shape":e instanceof qt||e instanceof ae?"Comment":e instanceof _?"List":e instanceof xe||e instanceof He?"EditRange":void 0},s.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!((0,a.le)(this.tableFormat)||(0,a.le)(this.tableFormat.table)),i=this.start.paragraph.paragraphFormat.baseStyle;if(i instanceof Xe&&0===i.name.toLowerCase().indexOf("toc")){var n=this.getTocFieldInternal();if(!(0,a.le)(n))return void(this.contextTypeInternal="TableOfContents")}var r=this.getCurrentRevision();if(!(0,a.le)(r)&&this.owner.showRevisions?(this.owner.trackChangesPane.currentSelectedRevision=r[0],(0,a.le)(this.owner.documentHelper.currentSelectedComment)&&this.owner.commentReviewPane.selectReviewTab("Changes"),this.owner.notify("reviewPane",{comment:this.owner.showComments,changes:!0,isUserClosed:!1})):(0,a.le)(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter){var o=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=t?e?o?"HeaderTableImage":"FooterTableImage":o?"HeaderTableText":"FooterTableText":e?o?"HeaderImage":"FooterImage":o?"HeaderText":"FooterText"}else this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text"},s.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];this.selectRevision(n),t?n.accept():n.reject()}},s.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},s.prototype.getCurrentRevision=function(){var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var l,n=e.currentWidget.getInline(e.offset,0).element,r=e.paragraph,o=e.currentWidget.getInline(e.offset+1,0).element;if(n&&n===o){var h=n.line.getOffset(n,n.length);if((l=new Z(this.owner)).setPositionParagraph(n.line,h),t.offset===l.offset&&!(0,a.le)(n.nextElement))return}if(!(0,a.le)(n)&&n.revisions.length>0)return n.revisions;if(r.isInsideTable){var d=r.associatedCell;if(!(0,a.le)(d.ownerRow)&&d.ownerRow.rowFormat.revisions.length>0)return d.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&t.paragraph.characterFormat.revisions.length>0?t.paragraph.characterFormat.revisions:void 0},s.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var n=e.children[i];n.revisions.length>0&&this.addItemRevisions(n,t)}},s.prototype.handleAcceptReject=function(e){if(this.isEmpty){var i=this.start.currentWidget.getInline(this.start.offset+1,0).element,n=this.start.paragraph;if(!(0,a.le)(i)&&i.revisions.length>0&&this.addItemRevisions(i,e),n.isInsideTable){var r=n.associatedCell;if((0,a.le)(r)){if(!n.isEmpty())for(var o=0;o<r.childWidgets.length;o++)for(var l=r.childWidgets[o],h=void 0;h<l.childWidgets.length;h++)this.processLineRevisions(l.childWidgets[h],e)}else r.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(r.ownerRow.rowFormat,e)}}else{var c=this.getselectedRevisionElements();for(o=0;o<c.length;o++)this.acceptReject(c[o],e)}},s.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},s.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var n=0;n<this.selectedWidgets.length;n++){var r=this.selectedWidgets.keys[n];if(r instanceof oe)e=this.getSelectedLineRevisions(r,t,i,e);else if(r instanceof V){r.ownerRow.rowFormat.revisions.length>0&&(e=this.addRevisionsCollec(r.ownerRow.rowFormat.revisions,e));for(var o=0;o<r.childWidgets.length;o++)for(var l=r.childWidgets[o],h=0;h<l.childWidgets.length;h++)e=this.getSelectedLineRevisions(l.childWidgets[h],t,i,e)}}return e},s.prototype.getSelectedLineRevisions=function(e,t,i,n){e.paragraph.characterFormat.revisions.length>0&&(n=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,n));for(var r=0;r<e.children.length;r++){var o=e.children[r],l=o.line.getOffset(o,0),h=new Z(this.owner);h.setPositionParagraph(o.line,l),l=o.line.getOffset(o,o.length);var d=new Z(this.owner);d.setPositionParagraph(o.line,l),(d.isExistAfter(t)&&d.isExistBefore(i)||h.isExistAfter(t)&&h.isExistBefore(i)||h.isAtSamePosition(t)||t.isExistAfter(h)&&i.isExistBefore(d))&&o.revisions.length>0&&(n=this.addRevisionsCollec(o.revisions,n))}return n},s.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},s.prototype.retrieveTableFormat=function(e,t){var i=this.getTable(e,t);(0,a.le)(i)?this.tableFormat.clearFormat():(this.tableFormat.copyFormat(i.tableFormat),this.tableFormat.table=i,this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},s.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},s.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},s.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var n=!1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(o===t.paragraph.associatedCell.ownerRow&&(n=!0),n)for(var l=0;l<o.childWidgets.length;l++){var h=o.childWidgets[l];if(this.isCellSelected(h,t,i)&&this.cellFormat.combineFormat(h.cellFormat),h===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(h.cellFormat)}}},s.prototype.getRowFormat=function(e,t,i){var n=t.paragraph.associatedCell.ownerRow;if(n!==i.paragraph.associatedCell.ownerRow)for(var r=e.childWidgets.indexOf(n)+1;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},s.prototype.getTable=function(e,t){if(!(0,a.le)(e.paragraph.associatedCell)&&!(0,a.le)(t.paragraph.associatedCell)){var i=e.paragraph.associatedCell.ownerTable,n=e.paragraph.associatedCell.ownerTable;if(i===n)return i;if(i.contains(e.paragraph.associatedCell))return i;if(n.contains(e.paragraph.associatedCell))return n;if(!i.isInsideTable||!n.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===n||i.contains(n.associatedCell))return i;if(n.contains(i.associatedCell))return n}while(!(0,a.le)(i.associatedCell))}},s.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof be)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof Ye)t=!(0,a.le)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof Y?e.containerWidget.containerWidget:e.containerWidget;else for(t=e.containerWidget;!(t instanceof Ye);)t instanceof be&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},s.prototype.retrieveSectionFormat=function(e,t){var i=this.getContainerWidget(e.paragraph),n=this.getContainerWidget(t.paragraph);if(!(0,a.le)(i)){this.sectionFormat.copyFormat(i.sectionFormat);for(var r=this.documentHelper.pages.indexOf(i.page),o=this.documentHelper.pages.indexOf(n.page),l=r+1;l<=o;l++)this.sectionFormat.combineFormat(this.documentHelper.pages[l].bodyWidgets[0].sectionFormat)}},s.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},s.prototype.getParagraphFormatForSelection=function(e,t,i,n){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,n)){if(this.getParagraphFormatInternalInParagraph(e,i,n),n.paragraph===e)return;var r=this.getNextRenderedBlock(e);(0,a.le)(r)||this.getParagraphFormatInternalInBlock(r,i,n)}else this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,n)},s.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},s.prototype.getParagraphFormatInternalInBlock=function(e,t,i){if(e instanceof I){if(this.getParagraphFormatInternalInParagraph(e,t,i),i.paragraph===e)return;var n=this.getNextRenderedBlock(e);(0,a.le)(n)||this.getParagraphFormatInternalInBlock(n,t,i)}else this.getParagraphFormatInternalInTable(e,t,i)},s.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var l=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(l,t,i)},s.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},s.prototype.getParagraphFormatInBlock=function(e){e instanceof I?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},s.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)this.getParagraphFormatInCell(i.childWidgets[n])},s.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},s.prototype.getParagraphFormatInternalInCell=function(e,t,i){if(i.paragraph.isInsideTable){var n=this.getContainerCellOf(e,i.paragraph.associatedCell);if(n.ownerTable.contains(i.paragraph.associatedCell)){var r=this.getSelectedCell(e,n),o=this.getSelectedCell(i.paragraph.associatedCell,n);if(this.containsCell(n,i.paragraph.associatedCell))if(this.isCellSelected(n,t,i))this.getParagraphFormatInCell(n);else if(r===n){if(this.getParagraphFormatInternalInParagraph(t.paragraph,t,i),i.paragraph===t.paragraph)return;var l=this.getNextRenderedBlock(t.paragraph);(0,a.le)(l)||this.getParagraphFormatInternalInBlock(l,t,i)}else this.getParagraphFormatInRow(r.ownerRow,t,i);else this.getParaFormatForCell(n.ownerTable,n,o)}else this.getParagraphFormatInRow(n.ownerRow,t,i)}else{var h=this.getContainerCell(e);this.getParagraphFormatInRow(h.ownerRow,t,i)}},s.prototype.getParaFormatForCell=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),l=o+i.cellFormat.cellWidth;n>o&&(n=o),r<l&&(r=l),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);for(var h=e.childWidgets.indexOf(i.ownerRow),d=e.childWidgets.indexOf(t.ownerRow);d<=h;d++)for(var c=e.childWidgets[d],u=0;u<c.childWidgets.length;u++){var p=c.childWidgets[u],f=this.getCellLeft(c,p);w.round(n,2)<=w.round(f,2)&&w.round(f,2)<w.round(r,2)&&this.getParagraphFormatInCell(p)}},s.prototype.getParagraphFormatInRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var l=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(l,t,i)},s.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var i=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList){var n=this.getListLevel(e.paragraph);return void(n&&n.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(n.characterFormat))}for(e.offset===this.getParagraphLength(i)&&!this.isEmpty&&(i=this.getNextParagraphBlock(i));!(0,a.le)(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);var r=i===e.paragraph?e.offset:0;if(!(0,a.le)(i)&&!i.isEmpty()){var l=new Z(this.owner),h=e.currentWidget.getInline(r,0),d=this.getPhysicalPositionInternal(e.currentWidget,r,!0);l.setPositionForSelection(e.currentWidget,h.element,h.index,d),this.getCharacterFormatForSelection(i,this,l,t)}}},s.prototype.getCharacterFormatForSelection=function(e,t,i,n){i.paragraph instanceof I&&i.paragraph.isInsideTable&&(!n.paragraph.isInsideTable||i.paragraph.associatedCell!==n.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,n))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,n):this.getCharacterFormat(e,i,n)},s.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var l=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(l,t,i)},s.prototype.getCharacterFormatInTableCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),l=this.getSelectedCell(n.paragraph.associatedCell,r);this.containsCell(r,n.paragraph.associatedCell)?this.isCellSelected(r,i,n)?this.getCharacterFormatForSelectionCell(r,i,n):o===r?this.getCharacterFormat(i.paragraph,i,n):this.getCharacterFormatForTableRow(o.ownerRow,i,n):this.getCharacterFormatInternalInTable(r.ownerTable,r,l,i,n)}else this.getCharacterFormatForTableRow(r.ownerRow,i,n)}else{var h=this.getContainerCell(e);this.getCharacterFormatForTableRow(h.ownerRow,i,n)}},s.prototype.getCharacterFormatInternalInTable=function(e,t,i,n,r){var o=this.getCellLeft(t.ownerRow,t),l=o+t.cellFormat.cellWidth,h=this.getCellLeft(i.ownerRow,i),d=h+i.cellFormat.cellWidth;o>h&&(o=h),l<d&&(l=d),o>this.upDownSelectionLength&&(o=this.upDownSelectionLength),l<this.upDownSelectionLength&&(l=this.upDownSelectionLength);for(var c=e.childWidgets.indexOf(i.ownerRow),u=e.childWidgets.indexOf(t.ownerRow);u<=c;u++)for(var p=e.childWidgets[u],f=0;f<p.childWidgets.length;f++){var g=p.childWidgets[f],m=this.getCellLeft(p,g);w.round(o,2)<=w.round(m,2)&&w.round(m,2)<w.round(l,2)&&this.getCharacterFormatForSelectionCell(g,n,r)}},s.prototype.getCharacterFormat=function(e,t,i){if((e===t.paragraph||e===i.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(i.paragraph!==e||t.paragraph===e||0!==i.offset)){var n=0,r=this.getParagraphLength(e);if(e===t.paragraph&&(n=t.offset,this.setCharacterFormat(e,t,i,r)))return;var l=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,h=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):e.childWidgets.length-1,d=i.offset;e!==i.paragraph&&(d=r);for(var c=l;c<=h;c++){var u=e.childWidgets[c];c!==l&&(n=this.getStartLineOffset(u)),d=u===i.currentWidget?i.offset:this.getLineLength(u);for(var p=0,f=0;f<u.children.length;f++){var g=u.children[f];if(!(g instanceof _)){if(n>=p+g.length){p+=g.length;continue}if(g instanceof H&&0===g.fieldType&&w.isLinkedFieldCharacter(g)){var m=(0,a.le)(g.fieldEnd)?g.fieldBegin:g.fieldEnd;f--;do{this.characterFormat.combineFormat(g.characterFormat),p+=g.length,g=g.nextNode,c++,f++}while(!(0,a.le)(g)&&g!==m);continue}if((g instanceof S||g instanceof H)&&this.characterFormat.combineFormat(g.characterFormat),(0,a.le)(g)||d<=p+g.length)break;p+=g.length}}}if(i.paragraph!==e){var v=this.getNextRenderedBlock(e);(0,a.le)(v)||this.getCharacterFormatForBlock(v,t,i)}}},s.prototype.setCharacterFormat=function(e,t,i,n){var r=0,o=t.offset,l=t.currentWidget.getInline(o,r);r=l.index;var h=l.element;if((0,a.le)(h)&&(t.paragraph.childWidgets.indexOf(t.currentWidget),t.currentWidget.previousLine))return this.characterFormat.copyFormat((h=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1]).characterFormat),!0;if(o<n){if(this.isEmpty){if(h instanceof S||h instanceof H&&(0===h.fieldType||1===h.fieldType)){var c=this.getPreviousTextElement(h);0===o&&c&&(h=c),this.characterFormat.copyFormat(h.characterFormat)}else(0,a.le)(this.getPreviousTextElement(h))?(0,a.le)(this.getNextTextElement(h))?this.characterFormat.copyFormat(e.characterFormat):this.characterFormat.copyFormat(this.getNextTextElement(h).characterFormat):this.characterFormat.copyFormat(this.getPreviousTextElement(h).characterFormat);return!0}r!==h.length||(0,a.le)(h.nextNode)?h instanceof S?this.characterFormat.copyFormat(h.characterFormat):h instanceof H&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(h)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(h))}else if(n===i.offset)return h instanceof S||h instanceof H?this.characterFormat.copyFormat(h.characterFormat):(0,a.le)(h)?this.characterFormat.copyFormat(e.characterFormat):(h=this.getPreviousTextElement(h),(0,a.le)(h)||this.characterFormat.copyFormat(h.characterFormat)),!0;return!1},s.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof I?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},s.prototype.getCharacterFormatInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var l=this.getNextRenderedBlock(e);this.getCharacterFormatForBlock(l,t,i)},s.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.getCharacterFormatForBlock(e.childWidgets[n],t,i)},s.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];o instanceof ee||o instanceof H||o instanceof _||t.characterFormat.combineFormat(o.characterFormat)}},s.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);if((0,a.le)(t))return e.characterFormat;var i=void 0;return t instanceof H&&0===i.fieldType&&(i=t),(0,a.le)(i)?t.characterFormat:this.getNextValidCharacterFormatOfField(i)},s.prototype.getNextValidCharacterFormatOfField=function(e){var t=e;w.isLinkedFieldCharacter(e)&&(t=(0,a.le)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var i=void 0;return(0,a.le)(t.nextNode)||(i=this.getNextValidElement(t.nextNode)),(0,a.le)(i)?t.characterFormat:i.characterFormat},s.prototype.checkCursorIsInSelection=function(e,t){if((0,a.le)(this.start)||this.isEmpty||(0,a.le)(e))return!1;var i=!1;do{if(this.selectedWidgets.containsKey(e)){var n=void 0;e instanceof oe?(n=this.owner.selection.getTop(e),this.owner.selection.getLeft(e)):n=e.y;var o=this.selectedWidgets.get(e);if(o instanceof Je)i=o.left<=t.x&&n<=t.y&&n+e.height>=t.y&&o.left+o.width>=t.x;else for(var l=o,h=0;h<l.length&&!(l[h]instanceof Je&&(i=l[h].left<=t.x&&n<=t.y&&n+e.height>=t.y&&l[h].left+l[h].width>=t.x,i));h++);}e=e instanceof oe?e.paragraph:e.containerWidget}while(!(0,a.le)(e)&&!i);return i},s.prototype.copySelectionParagraphFormat=function(){var e=new ue;return this.paragraphFormat.copyToFormat(e),e},s.prototype.getHyperlinkDisplayText=function(e,t,i,n,r){var o=e;if(o!==i.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};for(var l="",h=o.childWidgets.indexOf(t.line),d=o.childWidgets[h].children.indexOf(t),c=h;c<o.childWidgets.length;c++){var u=o.childWidgets[c];c!==h&&(d=-1);for(var p=d+1;p<u.children.length;p++){var f=u.children[p];if(f===i)return{displayText:l,isNestedField:n,format:r};if(f instanceof S)l+=f.text,r=f.characterFormat;else{if(!(f instanceof H))return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};f instanceof H&&0===f.fieldType&&!(0,a.le)(f.fieldEnd)&&(d=(0,a.le)(f.fieldSeparator)?u.children.indexOf(f.fieldEnd):u.children.indexOf(f.fieldSeparator))}}}return{displayText:l,isNestedField:n,format:r}},s.prototype.navigateHyperLinkOnEvent=function(e,t){var i=this,n=this.documentHelper.getLineWidget(e);if(!(0,a.le)(n)){var r=this.getHyperLinkFieldInCurrentSelection(n,e);(0,a.le)(r)||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(r),setTimeout(function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)}))}},s.prototype.getLinkText=function(e,t){var i=new ji(e,this),n=i.navigationLink,r=i.screenTip;return t?(i.localReference.length>0&&("_"!==i.localReference[0]||!(0,a.le)(n)&&0!==n.length?n+=i.isCrossRef?i.localReference:"#"+i.localReference:n="Current Document"),i.destroy(),n):(i.destroy(),r)},s.prototype.setHyperlinkContentToToolTip=function(e,t,i,n){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;this.toolTipElement||(this.toolTipElement=(0,a.az)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var r=new a.E7("documenteditor",this.owner.defaultLocale);r.setLocale(this.owner.locale);var o=r.getConstant("Click to follow link");this.owner.useCtrlClickToFollowHyperlink&&(o=this.documentHelper.isIosDevice?"Command+"+o:"Ctrl+"+o);var l=this.getScreenTipText(e);if(n){var h=e.formFieldData.helpText;if((0,a.le)(h)||""===h)return;this.toolTipElement.innerHTML=h}else this.toolTipElement.innerHTML=l+"</br><b>"+o+"</b>";var d=this.getTooltipPosition(e.line,i,this.toolTipElement,!1);this.showToolTip(d.x,d.y),!(0,a.le)(this.toolTipField)&&e!==this.toolTipField&&(this.toolTipObject.position={X:d.x,Y:d.y}),this.toolTipObject.show(),this.toolTipField=e}else this.hideToolTip()},s.prototype.getScreenTipText=function(e){var t=new ji(e,this);return t.screenTip||t.localReference?t.screenTip?t.screenTip:t.localReference:t.navigationLink},s.prototype.setFootnoteContentToToolTip=function(e,t,i){if(e){if("block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display&&this.owner.contextMenuModule)return;this.toolTipElement||(this.toolTipElement=(0,a.az)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var n=new a.E7("documenteditor",this.owner.defaultLocale);n.setLocale(this.owner.locale);var r=void 0;"Endnote"===e.footnoteType?r=n.getConstant("Click to View/Edit Endnote"):"Footnote"===e.footnoteType&&(r=n.getConstant("Click to View/Edit Footnote")),this.toolTipElement.innerHTML="<b>"+r+"</b>";var o=this.getTooltipPosition(e.line,i,this.toolTipElement,!1);this.showToolTip(o.x,o.y),(0,a.le)(this.toolTipField)||(this.toolTipObject.position={X:o.x,Y:o.y}),this.toolTipObject.show()}else this.hideToolTip()},s.prototype.setLockInfoTooptip=function(e,t,i){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;var n=this.toolTipElement;this.toolTipElement||(n=(0,a.az)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(n),this.toolTipElement=n),n.style.display="block";var r=new a.E7("documenteditor",this.owner.defaultLocale);r.setLocale(this.owner.locale);var o=r.getConstant("This region is locked by");n.innerHTML=o+" <b>"+i+"</b>";var l=this.getTooltipPosition(e,t,n,!1);this.showToolTip(l.x,l.y),!(0,a.le)(this.toolTipField)&&i!==this.toolTipField&&(this.toolTipObject.position={X:l.x,Y:l.y}),this.toolTipObject.show(),this.toolTipField=i}else this.hideToolTip()},s.prototype.getTooltipPosition=function(e,t,i,n){var r=this.getTop(e)*this.documentHelper.zoomFactor,o=this.getPage(e.paragraph),l=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,h=o.boundingRectangle.x+t*this.documentHelper.zoomFactor;h+i.clientWidth+10>l&&(h-=i.clientWidth-(l-h)+15);var d=n?0:i.offsetHeight,c=this.getPageTop(o)+(r-d);return new ce(h,c=c>this.documentHelper.viewerContainer.scrollTop?c:c+e.height+d)},s.prototype.createPasteElement=function(e,t){var i,n=new a.E7("documenteditor",this.owner.defaultLocale);switch(n.setLocale(this.owner.locale),this.currentPasteAction){case"DefaultPaste":i=[{text:n.getConstant("Keep source formatting"),iconCss:"e-icons e-de-paste-source"},{text:n.getConstant("Match destination formatting"),iconCss:"e-icons e-de-paste-merge"},{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"TextOnly":i=[{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"InsertAsColumns":case"OverwriteCells":case"InsertAsRows":if(i=[{text:n.getConstant("NestTable"),iconCss:"e-icons e-de-paste-nested-table"},{text:n.getConstant("InsertAsRows"),iconCss:"e-icons e-de-paste-row"}],"InsertAsColumns"===this.currentPasteAction){var r={text:n.getConstant("InsertAsColumns"),iconCss:"e-icons e-de-paste-column"};i.unshift(r)}else"OverwriteCells"===this.currentPasteAction&&(r={text:n.getConstant("OverwriteCells"),iconCss:"e-icons e-de-paste-overwrite-cells"},i.splice(2,0,r))}if(this.pasteElement)this.pasteDropDwn.items=i;else{this.pasteElement=(0,a.az)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.pasteElement);var o=(0,a.az)("button",{id:this.owner.containerId+"_iconsplitbtn"});this.pasteElement.appendChild(o),this.pasteDropDwn=new Ue.uw({items:i,iconCss:"e-icons e-de-paste",select:this.pasteOptions}),this.pasteDropDwn.appendTo(o)}this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteDropDwn.dataBind()},s.prototype.showToolTip=function(e,t){this.toolTipObject||(this.toolTipObject=new se.GI(this.toolTipElement,{height:"auto",width:"auto",relateTo:this.documentHelper.viewerContainer.parentElement,position:{X:e,Y:t}}))},s.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipObject&&(this.toolTipElement.style.display="none",this.toolTipObject.hide(),this.toolTipObject.destroy(),this.toolTipObject=void 0)},s.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,i){var n=void 0,r=this.getTop(e),o=this.getLineStartLeft(e),l=w.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),h=w.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent);if(!(t.y<r||t.y>r+e.height||t.x<o||t.x>o+e.paragraph.width+l+h)){var d=e.paragraph.x,c=this.getFirstElement(e,d);d=c.left;var u=c.element;if((0,a.le)(u)){var p=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=o+p||t.x>=o+p){var g=this.getHyperLinkFields(e.paragraph,[],!1,i);return g}}else{var m=e.renderedElements;if(t.x>d+u.margin.left)for(var v=m.indexOf(u);v<m.length&&!(t.x<d+(u=m[v]).margin.left+u.width||v===m.length-1);v++)d+=u.margin.left+u.width;if(p=u.margin.left+u.width,(0,a.le)((n=u).nextNode)&&(p+=this.documentHelper.textHelper.getParagraphMarkWidth(n.line.paragraph.characterFormat)),t.x<=d+p)return g=this.getHyperLinkFieldInternal(n.line.paragraph,n,[],!1,i)}}},s.prototype.getFootNoteElementInCurrentSelection=function(e,t){var i=void 0,n=this.getTop(e),r=this.getLineStartLeft(e);if(!(t.y<n||t.y>n+e.height||t.x<r||t.x>r+e.paragraph.width)){var o=e.paragraph.x,l=this.getFirstElement(e,o);o=l.left;var h=l.element;if((0,a.le)(h)){var d=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=r+d||t.x>=r+d){var u=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element;return u instanceof Ee?u:void 0}}else{if(t.x>o+h.margin.left)for(var p=e.children.indexOf(h);p<e.children.length&&!(t.x<o+(h=e.children[p]).margin.left+h.width||p===e.children.length-1);p++)o+=h.margin.left+h.width;if(h instanceof Ee&&(i=h),d=h.margin.left+h.width,(0,a.le)(h.nextNode)&&(d+=this.documentHelper.textHelper.getParagraphMarkWidth(h.line.paragraph.characterFormat)),t.x<=o+d)return i}}},s.prototype.getHyperlinkField=function(e){if(!(0,a.le)(this.end)){var t=0,i=this.documentHelper.selection,r=i.end;i.isForward||(r=i.start);var o=this.end.currentWidget.getInline(r.offset,t);t=o.index;var l=o.element,h=[],d=void 0;return d=(0,a.le)(l)?this.getHyperLinkFields(this.end.paragraph,h,e):this.documentHelper.isFormFillProtectedMode&&l instanceof O&&l.previousNode instanceof H&&1===l.previousNode.fieldType?void 0:this.getHyperLinkFieldInternal(l.line.paragraph,l,h,e,!1),h=[],d}},s.prototype.getHyperLinkFields=function(e,t,i,n){for(var r=0;r<this.documentHelper.fields.length;r++)if(-1===t.indexOf(this.documentHelper.fields[r])&&!(0,a.le)(this.documentHelper.fields[r].fieldSeparator)){t.push(this.documentHelper.fields[r]);var o=this.getFieldCode(this.documentHelper.fields[r]);o=o.trim().toLowerCase();var l=this.paragraphIsInFieldResult(this.documentHelper.fields[r],e);if((i||!i&&o.match("hyperlink "))&&l)return this.documentHelper.fields[r];if(l&&n&&this.documentHelper.fields[r].formFieldData)return this.documentHelper.fields[r];if((i||!i&&o.match("ref "))&&l)return this.documentHelper.fields[r]}},s.prototype.getHyperLinkFieldInternal=function(e,t,i,n,r){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===i.indexOf(this.documentHelper.fields[o])&&!(0,a.le)(this.documentHelper.fields[o].fieldSeparator)){i.push(this.documentHelper.fields[o]);var l=this.getFieldCode(this.documentHelper.fields[o]);l=l.trim().toLowerCase();var h=this.documentHelper.fields[o],d=h.fieldEnd;n&&h.nextNode instanceof O&&(d=h.nextNode.reference);var c=this.inlineIsInFieldResult(h,d,h.fieldSeparator,t,n)||this.isImageField();if((n||!n&&l.match("hyperlink "))&&c)return this.documentHelper.fields[o];if(c&&r&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((n||!n&&l.match("ref "))&&c)return this.documentHelper.fields[o]}if(e.containerWidget instanceof j&&!(e instanceof Ce))return this.getHyperLinkFieldInternal(e.containerWidget,t,i,n,r)},s.prototype.getBlock=function(e){if(""!==e&&!(0,a.le)(e)){var t={index:e},i=this.start.getPage(t),n=t.index.indexOf(";"),r=t.index.substring(0,n);t.index=t.index.substring(n).replace(";","");var o=i.bodyWidgets[parseInt(r,10)];return this.getBlockInternal(o,t.index)}},s.prototype.getBlockInternal=function(e,t){if(""!==t&&!(0,a.le)(t)){var i=t.indexOf(";"),n=t.substring(0,i);t=t.substring(i).replace(";","");var r=e;if(!((i=parseInt(n,10))>=0&&i<e.childWidgets.length))return r;var o=e.childWidgets[i];return t.indexOf(";")>=0?o instanceof I?(t.indexOf(";")>=0&&(t="0"),o):o instanceof Ve?this.getBlockInternal(o,t):r:o}},s.prototype.inlineIsInFieldResult=function(e,t,i,n,r){return!((0,a.le)(t)||(0,a.le)(i)||!this.isExistBeforeInline(i,n))&&this.isExistAfterInline(t,n,r)},s.prototype.paragraphIsInFieldResult=function(e,t){if(!(0,a.le)(e.fieldEnd)&&!(0,a.le)(e.fieldSeparator)){var i=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},s.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,n=e.paragraph.getInline(e.offset,i),r=n.element;(i=n.index)===r.length&&(r=this.getNextRenderedElementBox(r,i));var o=(n=t.paragraph.getInline(t.offset,i)).element;if(i=n.index,r instanceof H&&0===r.fieldType&&o instanceof H&&1===o.fieldType&&r.fieldSeparator){var l=r.fieldSeparator.nextNode;if(l instanceof ee&&l.nextNode===o)return!0}return!1},s.prototype.isFormField=function(){var e=this.getCurrentFormField();return!!(e instanceof H&&e.formFieldData)},s.prototype.isReferenceField=function(e){if((0,a.le)(e)&&(e=this.getHyperlinkField(!0)),e){var t=this.getFieldCode(e);if(t=t.toLowerCase(),e instanceof H&&t.match("ref "))return!0}return!1},s.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&((0,a.le)(e)&&(e=this.getCurrentFormField()),e&&e.formFieldData instanceof Re&&"Text"===e.formFieldData.type))},s.prototype.getFormFieldType=function(e){if((0,a.le)(e)&&(e=this.getCurrentFormField()),e instanceof H){if(e.formFieldData instanceof Re)return"Text";if(e.formFieldData instanceof qe)return"CheckBox";if(e.formFieldData instanceof Ge)return"DropDown"}},s.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var i=0;i<this.documentHelper.formFields.length;i++){var n=this.documentHelper.formFields[i],r=this.start,o=this.end;if(this.isForward||(r=this.end,o=this.start),w.isLinkedFieldCharacter(n)){var l=n.fieldSeparator.line.getOffset(n.fieldSeparator,1),h=new Z(this.owner);h.setPositionParagraph(n.fieldSeparator.line,l);var d=n.fieldEnd;l=d.line.getOffset(d,0);var c=new Z(this.owner);if(c.setPositionParagraph(d.line,l),(r.isExistAfter(h)||r.isAtSamePosition(h))&&(o.isExistBefore(c)||o.isAtSamePosition(c))){t=n;break}}}else t=this.getHyperlinkField(!0);if(t instanceof H&&0===t.fieldType&&!(0,a.le)(t.formFieldData))return t},s.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof be)return e;e&&(e=e.containerWidget)}while(e);return null},s.prototype.isTableSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),(0,a.le)(e.paragraph.associatedCell)||(0,a.le)(t.paragraph.associatedCell))return!1;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),n=this.getFirstBlockInFirstCell(i[0]),r=this.getLastBlockInLastCell(i[i.length-1]);return e.paragraph.associatedCell.equals(n.associatedCell)&&t.paragraph.associatedCell.equals(r.associatedCell)&&(!n.associatedCell.equals(r.associatedCell)||0===e.offset&&t.offset===this.getLineLength(r.lastChild)+1)},s.prototype.selectListText=function(){var i=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),n=this.getTextPosition(i),r=this.getTextPosition(i);this.isSelectList=!0,this.selectRange(n,r),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},s.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e);this.createHighlightBorder(e,t,i,e.paragraph.y,!1),this.documentHelper.isListTextSelected=!0},s.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var n=null,r=0,o=t.paragraph;if(o===i.paragraph&&t.offset+1===i.offset){var l=o.getInline(i.offset,r);n=l.element,r=l.index}if(n instanceof ee||n instanceof de){var h=n.width,d=n.height;if(n.width=e.width,n.height=e.height,e.width=h,e.height=d,null!==o&&null!==o.containerWidget&&this.owner.editorModule){var c=o.childWidgets.indexOf(n.line),u=n.line.children.indexOf(n);this.documentHelper.layout.reLayoutParagraph(o,c,u),this.highlightSelection(!1)}}},s.prototype.getSelectedCellsInTable=function(e,t,i){for(var n=t.columnIndex,r=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,l=i.ownerRow.index,h=[],d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[d];if(c.index>=o&&c.index<=l)for(var u=0;u<c.childWidgets.length;u++){var p=c.childWidgets[u];p.columnIndex>=n&&p.columnIndex<=r&&h.push(p)}if(c.index>l)break}return h},s.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},s.prototype.copySelectedContent=function(e){(0,a.le)(this.owner.sfdtExportModule)||(this.copyToClipboard(this.getHtmlContent()),e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.documentHelper.updateFocus())},s.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},s.prototype.getHtmlContent=function(){var e=this.writeSfdt();return this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e)),this.htmlWriter.writeHtml(e)},s.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t=document.createElement("div");t.style.left="-10000px",t.style.top="-10000px",t.style.position="relative",t.innerHTML=e,document.body.appendChild(t),-1!==navigator.userAgent.indexOf("Firefox")&&(t.contentEditable="true");var i=document.createRange();i.selectNodeContents(t),window.getSelection().addRange(i);var n=!1;try{n=document.execCommand("copy")}catch(r){}finally{window.getSelection().removeAllRanges(),t.parentNode.removeChild(t)}return n},s.prototype.showCaret=function(){var e=(0,a.le)(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;if(!((0,a.le)(e)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)){var i,t=e.boundingRectangle.x;if(i=this.viewer instanceof ye?e.boundingRectangle.width*this.documentHelper.zoomFactor+t:e.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)if(this.isHideSelection(this.start.paragraph))this.caret.style.display="none";else if(this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())){var n=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=n<t||n>i?"none":"block"}else this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||(0,a.le)(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"));if((0,a.le)(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var r=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,o=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,l=this.getSelectionPage(this.start);l&&(this.documentHelper.touchEnd.style.display=o<t||o>i?"none":"block",this.isEmpty||(i=l.boundingRectangle.width*this.documentHelper.zoomFactor+(t=l.boundingRectangle.x)),this.documentHelper.touchStart.style.display=r<t||r>i?"none":"block")}}},s.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},s.prototype.initCaret=function(){this.caret=(0,a.az)("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.owner.documentHelper.viewerContainer.appendChild(this.caret)},s.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t&&!(0,a.le)(this.caret)){this.caret.style.left=t.boundingRectangle.x+Math.round(e.x)*this.documentHelper.zoomFactor+"px";var i=this.updateCaretSize(this.owner.selection.end),n=i.topMargin,r=this.viewer,o=(t.boundingRectangle.y-r.pageGap*(this.documentHelper.pages.indexOf(t)+1))*this.documentHelper.zoomFactor+r.pageGap*(this.documentHelper.pages.indexOf(t)+1);this.caret.style.top=o+Math.round(e.y+n)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},s.prototype.showHidePasteOptions=function(e,t){if(!a.AR.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(e,t)}else this.pasteElement&&(this.pasteElement.style.display="none",(0,a.le)(this.owner.editor)||(this.owner.editor.isHtmlPaste=!1))},s.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var n=this.owner.documentHelper,r=i.boundingRectangle.x+Math.round(t.x)*n.zoomFactor,o=this.viewer.pageGap,h=(i.boundingRectangle.y-o*(i.index+1))*n.zoomFactor+o*(i.index+1)+Math.round(t.y)*n.zoomFactor;return new ce(r,h)}return new ce(0,0)},s.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},s.prototype.updateCaretSize=function(e,t){var r,i=0,n=!1,o=0,l=0;if(this.characterFormat.italic&&(n=this.characterFormat.italic),e.paragraph.isEmpty()){var d=0,c=this.getParagraphMarkSize(e.paragraph,i,d);d=c.bottomMargin;var u=c.height;l=(i=c.topMargin)<0?i+u:u,t||(this.caret.style.height=l*this.documentHelper.zoomFactor+"px"),i=0}else{var p=e.currentWidget.getInline(e.offset,o);o=p.index;var f=p.element;(0,a.le)(f)||(l=(r=this.getCaretHeight(f,o,f.characterFormat,!0,i,n)).height,t||(this.caret.style.height=r.height*this.documentHelper.zoomFactor+"px"))}return t||(this.caret.style.transform=n?"rotate(13deg)":""),{topMargin:i,height:l}},s.prototype.updateCaretToPage=function(e,t){if(!(0,a.le)(t))if(this.documentHelper.selectionEndPage=t,this.owner.selection.isEmpty)this.documentHelper.selectionStartPage=t;else{var i=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),n=this.getPage(i.paragraph);(0,a.le)(n)||(this.documentHelper.selectionStartPage=n)}this.checkForCursorVisibility()},s.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var o=0,l=this.getParagraphMarkSize(e.paragraph,0,o);o=l.bottomMargin,i+=l.height,i+=l.topMargin,t||(i+=o)}else{var h=0,d=e.paragraph.getInline(e.offset,h),c=d.element,u=!1,p=this.getCaretHeight(c,h=d.index,c.characterFormat,!1,0,u);u=p.isItalic,i+=p.height,t&&(i-=w.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))}return i},s.prototype.checkForCursorVisibility=function(){this.showCaret()},s.prototype.onKeyDownInternal=function(e,t,i,n){var r=e.which||e.keyCode;if(!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(r){case 32:this.owner.editor.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.toggleShowHiddenMarksInternal()}else switch(r){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(r){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,r){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),(0,a.le)(this.owner.optionsPaneModule)||this.owner.optionsPaneModule.showHideOptionsPane(!0)}if(this.isFormField()&&!this.documentHelper.isDocumentProtected){var o=this.getCurrentFormField(!0);if(o&&o.formFieldData instanceof Ge){var l=39===e.keyCode?1:0,h=(o=37===e.keyCode||38===e.keyCode||40===e.keyCode?o:o.nextElement instanceof O?o.nextElement.reference:o.fieldEnd).line.getOffset(o,l),d=this.getPhysicalPositionInternal(o.line,h,!1);this.selectInternal(o.line,o,l,d)}}(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()||this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9===e.keyCode||32===e.keyCode))&&this.owner.editorModule.onKeyDownInternal(e,t,i,n),this.owner.searchModule&&!(0,a.le)(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),(27===e.keyCode||27===e.which)&&((0,a.le)(this.owner.optionsPaneModule)||this.owner.optionsPaneModule.showHideOptionsPane(!1),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},s.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},s.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof ye||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},s.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof ye){var i=this.getPageTop(t),n=0,r=t.headerWidget;r&&(n=r.y+r.height);var o=r.isEmpty&&!this.owner.enableHeaderAndFooter,l=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),h=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),d=o?l:Math.min(Math.max(n,l),h/100*40);if(this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+(d*=this.documentHelper.zoomFactor))return!0}return!1},s.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof ye){var i=t.boundingRectangle,n=this.getPageTop(t),r=n+i.height*this.documentHelper.zoomFactor,o=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),l=0;t.footerWidget&&(l=t.footerWidget.height);var h=w.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin),c=i.height;if(c=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter?(c-h)*this.documentHelper.zoomFactor:(c-Math.min(i.height/100*40,Math.max(l+o,h)))*this.documentHelper.zoomFactor,this.viewer.containerTop+e.y<=r&&this.viewer.containerTop+e.y>=n+c)return!0}return!1},s.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof ye&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},s.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++)for(var t=this.documentHelper.headersFooters[e],i=this.getBodyWidgetInternal(e,0).sectionFormat,n=0,r=Object.keys(t);n<r.length;n++){var l=t[r[n]];l.isEmpty&&this.owner.editor.shiftPageContent(l.headerFooterType,i)}},s.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof k&&(t=this.getFirstBlockInFirstCell(t))instanceof k&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraphInternal(t,!0)},s.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},s.prototype.destroy=function(){(0,a.le)(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.pasteDropDwn&&(this.pasteDropDwn.destroy(),this.pasteDropDwn=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0,this.upDownSelectionLength=void 0,this.isSkipLayouting=void 0,this.isImageSelected=void 0,(0,a.le)(this.documentHelper)||this.documentHelper.destroy(),this.contextTypeInternal=void 0,this.isRetrieveFormatting=void 0,this.characterFormatIn=void 0,this.paragraphFormatIn=void 0,this.sectionFormatIn=void 0,this.tableFormatIn=void 0,this.cellFormatIn=void 0,this.rowFormatIn=void 0,this.imageFormatInternal=void 0,this.skipFormatRetrieval=void 0,this.startInternal=void 0,this.endInternal=void 0,this.htmlWriterIn=void 0,this.toolTipElement=void 0,(0,a.le)(this.toolTipObject)||this.toolTipObject.destroy(),this.toolTipField=void 0,this.isMoveDownOrMoveUp=void 0,this.pasteElement=void 0,this.currentPasteAction=void 0,this.isViewPasteOptions=void 0,this.skipEditRangeRetrieval=void 0,this.editPosition=void 0,(0,a.le)(this.selectedWidgets)||this.selectedWidgets.destroy(),this.isHighlightEditRegionIn=void 0,this.isHighlightFormFields=void 0,this.editRangeCollection=[],this.editRangeCollection=void 0,this.isHightlightEditRegionInternal=void 0,this.isCurrentUser=void 0,this.isHighlightNext=void 0,this.hightLightNextParagraph=void 0,this.isWebLayout=void 0,(0,a.le)(this.editRegionHighlighters)||this.editRegionHighlighters.destroy(),(0,a.le)(this.formFieldHighlighters)||this.formFieldHighlighters.destroy()},s.prototype.navigateBookmark=function(e,t){var i=this.documentHelper.bookmarks;if(i.containsKey(e)){var n=i.get(e),r=n.line.getOffset(n,0),o=new Z(this.owner);if(o.setPositionParagraph(n.line,r),t)this.documentHelper.selection.selectRange(o,o);else{var l=n.reference;null==n.reference.line.paragraph.bodyWidget&&(l=n);var h=l.line.getOffset(l,1),d=new Z(this.owner);d.setPositionParagraph(l.line,h),this.documentHelper.selection.selectRange(o,d)}}},s.prototype.selectBookmark=function(e){this.navigateBookmark(e)},s.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},s.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},s.prototype.isTOC=function(){for(var t=this.getParagraphInfo(this.start).paragraph,i=0;i<t.childWidgets[0].children.length;i++){var n=t.childWidgets[0].children[i];if(n instanceof H){var r=this.owner.selection.getFieldCode(n);if(r.match("TOC ")||r.match("Toc"))return!0}}return!1},s.prototype.getElementsForward=function(e,t,i,n){if(!(0,a.le)(t)){for(var r=[],o=e.children.indexOf(t);o>=0;){for(var l=o;l<e.children.length;l++){var h=e.children[l];if(h.line!==e){o=-1;break}if(h===i){r.push(h),o=-1;break}r.push(h)}o=-1}return 0===r.length?void 0:r}},s.prototype.getElementsBackward=function(e,t,i,n){for(var r=[];n&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof S&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var o=e.children.indexOf(t);o>=0;){for(var l=o;l>-1&&l<e.children.length;n?l++:l--){var h=e.children[l];if(h.line!==e){o=-1;break}r.push(h)}o=-1}return r},s.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},s.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},s.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,n=t.indexOf(i);this.documentHelper.currentSelectedComment=i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.selectComment(i)}},s.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},s.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},s.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,n=t.indexOf(i);this.documentHelper.currentSelectedRevision=i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},s.prototype.selectComment=function(e){if(!(0,a.le)(e)){var t=this.getElementPosition(e.commentStart,!0).startPosition,i=this.getElementPosition(e.commentEnd,!1).startPosition;this.owner.commentReviewPane&&this.owner.commentReviewPane.selectComment(e),this.selectPosition(t,i)}},s.prototype.selectRevision=function(e){if(!(0,a.le)(e)&&e.range.length>0){var t=e.range[0],i=e.range[e.range.length-1];if(t instanceof De){var n=t.ownerBase,o=n.childWidgets[n.childWidgets.length-1],l=this.getFirstParagraph(n.childWidgets[0]),h=this.getLastParagraph(o);this.start.setPosition(l.firstChild,!0),this.end.setPositionParagraph(h.lastChild,h.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(t&&i){var d=new Z(this.owner),c=0;t instanceof ie?(c=(u=t.ownerBase).getLength(),d.setPositionParagraph(u.lastChild,c)):(c=t.line.getOffset(t,0),d.setPositionForLineWidget(t.line,c));var u,p=new Z(this.owner);i instanceof ie?(u=i.ownerBase).isEndsWithPageBreak?(this.owner.trackChangesPane.isTrackingPageBreak=!0,p.setPositionParagraph(u.nextRenderedWidget.childWidgets[0],0)):(c=u.getLength(),p.setPositionParagraph(u.lastChild,c+1)):(c=i.line.getOffset(i,0)+i.length,this.isTOC()&&(c+=1),p.setPositionForLineWidget(i.line,c));var f=d.clone();d.isExistBefore(p)||(d=p,p=f),this.selectPosition(d,p)}}},s.prototype.selectTableRevision=function(e){if(!(0,a.le)(e)&&e[0].range.length>0){var t=e[0].range[0];if(t instanceof De){var o=e[e.length-1].range[0].ownerBase,l=o.childWidgets[o.childWidgets.length-1],h=this.getFirstParagraph(t.ownerBase.childWidgets[0]),d=this.getLastParagraph(l);this.start.setPosition(h.firstChild,!0),this.end.setPositionParagraph(d.lastChild,d.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}}},s.prototype.updateEditRangeCollection=function(){var e,t;if(this.editRangeCollection.length>0&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){e=this.documentHelper.editRanges.get(this.owner.currentUser);for(var r=0;r<e.length;r++)this.editRangeCollection.push(e[r])}if(this.documentHelper.editRanges.containsKey("Everyone"))for(t=this.documentHelper.editRanges.get("Everyone"),r=0;r<t.length;r++)this.editRangeCollection.push(t[r])}else for(var i=0;i<this.documentHelper.editRanges.length;i++)for(e=this.documentHelper.editRanges.get(this.documentHelper.editRanges.keys[i]),r=0;r<e.length;r++)this.editRangeCollection.push(e[r])},s.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},s.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.owner.enableLockAndEdit)this.viewer.updateScrollBars();else if(this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0,(0,a.le)(this.editRegionHighlighters)&&(this.editRegionHighlighters=new U),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},s.prototype.highlightFormFields=function(){(0,a.le)(this.formFieldHighlighters)&&(this.formFieldHighlighters=new U),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!(0,a.le)(e)&&e.length>0){for(var t=0;t<e.length;t++){var i=e[t];if(w.isLinkedFieldCharacter(i)){var n=i.line.getOffset(i,0),r=new Z(this.owner);r.setPositionParagraph(i.line,n);var o=i.fieldEnd;n=o.line.getOffset(o,1);var l=new Z(this.owner);l.setPositionParagraph(o.line,n),this.isHighlightFormFields=!0,this.highlight(r.paragraph,r,l),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,r,l),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},s.prototype.unHighlightEditRegion=function(){(0,a.le)(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},s.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,n=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,n),this.isCurrentUser=!1},s.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t);this.highlightEditRegions(t,i.startPosition,i.endPosition)}},s.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var r=e.line.paragraph.associatedCell.ownerRow.childWidgets[e.columnFirst];if(r)for(var o=0;o<r.childWidgets.length;o++)r.childWidgets[o]instanceof I&&(this.highlight(r.childWidgets[o],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}},s.prototype.navigateToNextEditingRegion=function(){var e=this.getEditRangeStartElement();this.sortEditRangeCollection();var t=this.editRangeCollection.length,i=t;(0,a.le)(e)||(i=this.editRangeCollection.indexOf(e));var r=this.getPosition(i<t-1?this.editRangeCollection[i+1]:this.editRangeCollection[0]);this.selectRange(r.startPosition,r.endPosition)},s.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;e>=0;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,n=this.getPosition(this.editRangeCollection[t]).startPosition;if(i.isExistAfter(n)){var r=this.editRangeCollection[t-1];this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=r}}},s.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},s.prototype.getEditRangeStartElement=function(){for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),n=i.startPosition,r=i.endPosition;if((this.start.isExistAfter(n)||this.start.isAtSamePosition(n))&&(this.end.isExistBefore(r)||this.end.isAtSamePosition(r)))return t}},s.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},s.prototype.checkSelectionIsAtEditRegion=function(e,t){(0,a.le)(e)&&(0,a.le)(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var i=0;i<this.editRangeCollection.length;i++){var n=this.editRangeCollection[i];if(!n.line.paragraph.isInsideTable||n.line.paragraph.isInsideTable&&!n.editRangeEnd.line.paragraph.isInsideTable||-1===n.columnFirst){if(this.isSelectionInsideEditRange(n,e,t))return!0}else if(n.paragraph.isInsideTable&&n.editRangeEnd&&n.editRangeEnd.line.paragraph.isInsideTable){var r=n.paragraph.associatedCell.ownerRow,o=e.paragraph.associatedCell,l=t.paragraph.associatedCell;if(!(0,a.le)(o)&&!(0,a.le)(l)&&r.equals(o.ownerRow)&&r.equals(l.ownerRow)&&o.index>=n.columnFirst&&o.index<=n.columnLast)if(this.isEmpty&&o.index===n.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(n,e,t))return!0}else if(!this.isCellSelected(o,e,t))return!0}}return!1},s.prototype.isSelectionInsideEditRange=function(e,t,i){var n=this.getPosition(e),r=n.startPosition,o=n.endPosition;return!(!t.isExistAfter(r)&&!t.isAtSamePosition(r)||!i.isExistBefore(o)&&!i.isAtSamePosition(o))},s.prototype.getPosition=function(e){var n,t=e.line.getOffset(e,1),i=new Z(this.owner);i.setPositionParagraph(e.line,t),e instanceof xe?n=e.editRangeEnd:e instanceof $||e instanceof O?n=e.reference:e instanceof ae&&(n=e.comment.commentEnd),t=n.line.getOffset(n,1);var r=new Z(this.owner);return r.setPositionParagraph(n.line,t),{startPosition:i,endPosition:r}},s.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var i=this.documentHelper.contentControlCollection[t],n=this.getPosition(i),r=n.startPosition,o=n.endPosition,l=this.start,h=this.end;if(this.isForward||(l=this.end,h=this.start),(0,a.le)(e)){var d=(r.isExistAfter(l)||r.isAtSamePosition(l))&&(r.isExistBefore(h)||r.isAtSamePosition(h)),c=(o.isExistAfter(l)||o.isAtSamePosition(l))&&(o.isExistBefore(h)||o.isAtSamePosition(h));if(d&&c)return!!i.contentControlProperties.lockContentControl&&(this.owner.trigger(si),!0);if((d||c)&&!r.isAtSamePosition(l)&&!o.isAtSamePosition(l)&&(i.contentControlProperties.lockContentControl||i.contentControlProperties.lockContents))return!0}if((l.isExistAfter(r)||l.isAtSamePosition(r))&&(h.isExistBefore(o)||h.isAtSamePosition(o))){if(i.contentControlProperties.xmlMapping&&i.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),i.contentControlProperties.lockContents)return this.owner.trigger(si),!0;if((0,a.le)(e)&&("CheckBox"===i.contentControlProperties.type||"ComboBox"===i.contentControlProperties.type||"DropDownList"===i.contentControlProperties.type||"Date"===i.contentControlProperties.type))return this.owner.trigger(si),!0}}return!1},s.prototype.getElementPosition=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new Z(this.owner);return n.setPositionParagraph(e.line,i),{startPosition:n,endPosition:void 0}},s.prototype.updateRefField=function(e){if((0,a.le)(e)&&(e=this.getHyperlinkField(!0)),!(0,a.le)(e)){if(!this.isReferenceField(e))return;var t=this.getFieldCode(e).replace(/\s+/g," ");if(0===(t=t.trim()).toLowerCase().indexOf("ref")){var i=t.split(" ");if(i.length>1){var n=i[1];if(this.documentHelper.bookmarks.containsKey(n)){var r=this.start,o=this.end;this.isForward||(r=this.end,o=this.start);var l=this.documentHelper.bookmarks.get(n),h=l.reference,d=l.previousNode;!(0,a.le)(d)&&d instanceof H||!(h.previousNode instanceof H)||1!==h.previousNode.fieldType||(0,a.le)(h.previousNode.fieldBegin)||(0,a.le)(h.previousNode.fieldBegin.formFieldData)?d instanceof H&&0===d.fieldType&&!(0,a.le)(d.formFieldData)&&(l=d.fieldSeparator,h=d.fieldEnd):(l=h.previousNode.fieldBegin.fieldSeparator,h=h.previousNode.fieldBegin.fieldEnd);var c=l.line.getOffset(l,1);r.setPositionParagraph(l.line,c),o.setPositionParagraph(h.line,h.line.getOffset(h,0));var u=this.owner.sfdtExportModule.write(r.currentWidget,r.offset,o.currentWidget,o.offset,!1,!0),p=e.fieldSeparator,f=e.fieldEnd;r.setPositionParagraph(p.line,p.line.getOffset(p,1)),o.setPositionParagraph(f.line,f.line.getOffset(f,0)),this.owner.editor.pasteContents(u)}}}}},s.prototype.footnoteReferenceElement=function(e,t,i){var r=0;if(this.getContainerWidget(e.paragraph)instanceof Y)for(var o=this.start.paragraph.bodyWidget.footNoteReference,l=0;l<this.documentHelper.pages.length;l++){r=0;for(var h=this.documentHelper.pages[l],d=0;d<h.bodyWidgets.length;d++)for(var c=h.bodyWidgets[d],u=0;u<c.childWidgets.length;u++){var p=c.childWidgets[u];if(p instanceof k){for(var f=0;f<p.childWidgets.length;f++)for(var g=p.childWidgets[f],m=0;m<g.childWidgets.length;m++)for(var v=g.childWidgets[m],y=0;y<v.childWidgets.length;y++)for(var b=v.childWidgets[y],C=0;C<b.childWidgets.length;C++)if(r=0,!(0,a.le)((F=b.childWidgets[C]).children))for(var T=0;T<F.children.length;T++)r+=(x=F.children[T]).length,x instanceof Ee&&x===o&&(e.setPositionParagraph(F,r-1),t.setPositionParagraph(F,r),this.selectRange(e,t))}else for(var P=0;P<p.childWidgets.length;P++){var F;if(r=0,!(0,a.le)((F=p.childWidgets[P]).children))for(T=0;T<F.children.length;T++){var x;r+=(x=F.children[T]).length,x instanceof Ee&&x===o&&(e.setPositionParagraph(F,r-1),t.setPositionParagraph(F,r),this.selectRange(e,t))}}}}},s}(),Dr=function(){function s(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!1,this.documentHelper=e,this.errorWordCollection=new U,this.uniqueWordsCollection=new U,this.errorSuggestions=new U,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new Er(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return s.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(s.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"uniqueWordsCount",{get:function(){return(0,a.le)(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"languageID",{get:function(){return(0,a.le)(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.manageReplace=function(e,t){if(this.documentHelper.triggerSpellCheck=!0,!(0,a.le)(t)&&t instanceof wt){var n=t.text;if(this.documentHelper.selection.start=t.start,this.documentHelper.selection.end=t.end,"Ignore Once"!==e)return e=this.manageSpecialCharacters(n,e),this.documentHelper.owner.editor.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:n,element:t}}if(!(0,a.le)(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e){var r=this.currentContextInfo.element;this.documentHelper.selection.start=r.start,this.documentHelper.selection.end=r.end}else this.handleReplace(e);"Ignore Once"!==e&&(this.documentHelper.owner.editor.insertTextInternal(e,!0),(0,a.le)(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},s.prototype.handleReplace=function(e){var t=this.documentHelper.selection.start,i=t.offset,r=t.currentWidget.getInline(i,0,!1,!0);r.element.line.getOffset(r.element,0)+r.element.length===i&&this.retrieveExactElementInfo(r);for(var c,l=r.element.text,h=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),d=[];!(0,a.le)(c=h.exec(l));)d.push(c);if("Ignore Once"!==e){t.offset=i-r.index,!(0,a.le)(d)&&d.length>0&&(t.offset+=d[0].toString().length),t.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,t.offset,!0),(t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString())).setPositionParagraph(t.currentWidget,t.offset);var p=t.currentWidget.getOffset(r.element,t.offset+r.element.length-t.offset),f=t.currentWidget,g=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(d=[];!(0,a.le)(c=g.exec(l));)d.push(c);!(0,a.le)(d)&&d.length>0&&(p-=d[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(f,p.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,p,!0),this.documentHelper.selection.end.setPositionParagraph(f,p),this.currentContextInfo={element:r.element,text:r.element.text}}else this.handleIgnoreOnce(r)},s.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;!(0,a.le)(t)&&t instanceof S&&""!=t.text.trim()&&(e.element=t)},s.prototype.handleIgnoreOnce=function(e){var t=e.element,i="";i=!(0,a.le)(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:t.text,i=this.manageSpecialCharacters(i,void 0,!0),-1===t.ignoreOnceItems.indexOf(i)&&t.ignoreOnceItems.push(i),this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},s.prototype.handleIgnoreAllItems=function(e){var t=(0,a.le)(e)?this.retriveText():e,i=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(i)&&(this.ignoreAllItems.push(i),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},s.prototype.handleAddToDictionary=function(e){var t=this,i=(0,a.le)(e)?this.retriveText():e,n=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,n,!1,!1,!0).then(function(r){t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(i),t.ignoreAllItems.push(n),t.documentHelper.owner.editor.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1})},s.prototype.manageSpecialCharacters=function(e,t,i){if(!(0,a.le)(e)){(0,a.le)(t)&&(t=e);for(var n=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\\u201d'\\,\\<\\.\\>\\/\\?\\`\\s\\\u2019]+","g"),r=[],o=void 0;!(0,a.le)(o=n.exec(e));)r.push(o);if(r.length>0)for(var l=0;l<r.length;l++){var h=r[l];t=i?t.replace(h[0],""):h[0]+t}var d=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\\u201d'\\,\\<\\.\\>\\/\\?\\s\\`\\\u2019]+$","g");for(r=[];!(0,a.le)(o=d.exec(t));)r.push(o);if(r.length>0)for(l=0;l<r.length;l++)h=r[l],t=i?t.slice(0,h.index):t+h[0]}return t},s.prototype.removeErrorsFromCollection=function(e){if(!(0,a.le)(e.text)&&this.errorWordCollection.containsKey(e.text)){var t=this.errorWordCollection.get(e.text);t.indexOf(e.element)>=0&&t.splice(0,1),0===t.length&&this.errorWordCollection.remove(e.text)}},s.prototype.retriveText=function(){var e,t;if(!(0,a.le)(this.currentContextInfo)&&this.currentContextInfo.element)e=this.currentContextInfo.element.text,this.documentHelper.selection.start=(t=this.currentContextInfo.element).start,this.documentHelper.selection.end=t.end;else{var i=this.documentHelper.selection.start,o=i.currentWidget.getInline(i.offset,0);t=o.element,e=o.element.text}return{text:e,element:t}},s.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0===e.length||(e=e.length>3?this.constructInlineMenu(e):e),this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenu.locale.getConstant("Add to Dictionary"));var t=[];if(this.spellCheckSuggestion.length>0)for(var i=0,n=this.spellCheckSuggestion;i<n.length;i++){var r=n[i];t.push({text:r,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+(r===this.documentHelper.owner.contextMenu.locale.getConstant("Add to Dictionary")?"Add to Dictionary":r),iconCss:""})}return t},s.prototype.checktextElementHasErrors=function(e,t,i){var n=!1,r=[];if(e=e.replace(/[\s]+/g,""),!(0,a.le)(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:n,elements:r};for(var o=0;o<t.errorCollection.length;o++)this.handleErrorCollection(t.errorCollection[o])&&(n=!0,r.push(t.errorCollection[o]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(n=!0,r.push(t));return{errorFound:n,elements:r}},s.prototype.updateStatusForGlobalErrors=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var n=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(n))for(var r=this.errorWordCollection.get(n),o=0;o<r.length;o++)if(r[o]instanceof wt&&r[o]===e[i]){r[o].ischangeDetected=!0,r[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),r[o].line=t.line;break}}},s.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);return!(!(t.containsKey(i)&&e.length>1)||this.ignoreAllItems.indexOf(i)>-1&&(t.containsKey(i)&&t.remove(i),1))},s.prototype.constructInlineMenu=function(e){for(var t=e.length-1;t>0;t--)e.length>3&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},s.prototype.findCurretText=function(){var t,n,e=this.documentHelper.selection.start,i=e.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!(0,a.le)(i.element)){if(!(0,a.le)(i.element.errorCollection)&&i.element.errorCollection.length>0)for(var r=0;r<i.element.errorCollection.length;r++){var o=i.element.errorCollection[r];if(o.start.location.x<=e.location.x&&o.end.location.x>=e.location.x){n=o.text,t=o;break}}else n=i.element.text;" "===n&&(n=(i=e.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:n,element:t}},s.prototype.addErrorCollection=function(e,t,i){if(e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)){var n=this.errorWordCollection.get(e);t instanceof wt?this.compareErrorTextElement(t,n)||n.push(t):t instanceof S&&(this.compareTextElement(t,n)||n.push(t))}else!(0,a.le)(i)&&i.length>0&&this.errorSuggestions.add(e,i),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0)},s.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},s.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},s.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},s.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},s.prototype.compareErrorTextElement=function(e,t){for(var i=[],n=!1,r=0;r<t.length;r++)i.push(t[r]);var o=t.length;for(r=0;r<o;r++)if(i[r]instanceof wt)if(i[r].ischangeDetected){var l=this.manageSpecialCharacters(i[r].text,void 0,!0);n=!0,this.removeErrorsFromCollection({element:i[r],text:l})}else{var h=i[r];if(e.start.offset===h.start.offset&&e.end.offset===h.end.offset)return!0}return n&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},s.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++)if(t[i]instanceof S&&t[i]===e)return!0;return!1},s.prototype.handleWordByWordSpellCheck=function(e,t,i,n,r,o,l){e.HasSpellingError&&l?(this.addErrorCollection(t.text,t,e.Suggestions),this.documentHelper.render.renderWavyLine(t,i,n,r,"#FF0000","Single",o,t.line.paragraph.containerWidget instanceof V?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor),t.isSpellChecked=!0):(this.addCorrectWordCollection(t.text),t.isSpellChecked=!0)},s.prototype.checkElementCanBeCombined=function(e,t,i,n,r,o,l,h){var d=(0,a.le)(r)?"":r,c=!(0,a.le)(h)&&h,u=!!(0,a.le)(l)||l,p=!!(0,a.le)(o)||o,f=[],g=this.documentHelper.selection.getLineWidget(e,0),m=g.children.indexOf(e),v=e.text;f.push(e);var b=!1,C=!1;if("\v"!==e.text){if(u){for(var F=void 0,T=m-(l?0:1);T>=0;T--)if((F=g.children[T])instanceof S&&!C){if(0!==v.indexOf(" ")&&F.text.lastIndexOf(" ")!==F.text.length-1)b=!(0,a.le)(r),d=F.text+d,v=F.text,C=!1,f.push(F),c=!0;else if(!(0,a.le)(F)){F=F.nextElement;break}}else F instanceof H&&1!==F.fieldType&&(C=!0);if(this.lookThroughPreviousLine(d,v,x=c?F:e,t,i))return!0}l?d=b?d:e.text+d:d+=e.text,C=!1;var P=e.text;if(p){var x,E=!1,L=void 0;for(T=m+1;T<g.children.length;T++)if((L=g.children[T])instanceof S&&!C){if(P.lastIndexOf(" ")!==P.length-1&&0!==L.text.indexOf(" "))d+=L.text,P=L.text,C=!1,f.push(L),E=!0,c=!0;else if(!(0,a.le)(L)){L=L.previousElement;break}}else L instanceof H&&2!==L.fieldType&&(C=!0);if("\f"!==(x=E?L:e).text&&this.lookThroughNextLine(d,v,x,t,i))return!0}}return c&&n&&!this.checkCombinedElementsBeIgnored(f,d)&&this.handleCombinedElements(e,d,t,i),c},s.prototype.lookThroughPreviousLine=function(e,t,i,n,r){if(!(0,a.le)(i)&&0===i.indexInOwner&&!(0,a.le)(i.line.previousLine)){var o=i.line.previousLine,l=o.children.length-1;if(!(0,a.le)(o.children[l])&&o.children[l]instanceof S){var h=o.children[l];if(!(0,a.le)(i.text)&&0!==i.text.indexOf(" ")&&h.text.lastIndexOf(" ")!==h.text.length-1)return this.checkElementCanBeCombined(h,n,r,!0,e=e.length>0?e:t,!1,!0,!0),!0}}return!1},s.prototype.lookThroughNextLine=function(e,t,i,n,r){if(!(0,a.le)(i)&&i.indexInOwner===i.line.children.length-1&&!(0,a.le)(i.line.nextLine)){var o=i.line.nextLine;if(!(0,a.le)(o.children[0])&&o.children[0]instanceof S){var l=o.children[0];if(i.text.lastIndexOf(" ")!==i.text.length-1&&0!==l.text.indexOf(" "))return this.checkElementCanBeCombined(l,n,r,!0,e=e.length>0?e:t,!0,!1,!0),!0}}return!1},s.prototype.handleCombinedElements=function(e,t,i,n){e.istextCombined=!0;var r=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof S&&-1===e.ignoreOnceItems.indexOf(t))if(r.length>1)for(var o=0;o<r.length;o++){var l=r[o];l=this.manageSpecialCharacters(l,void 0,!0),this.documentHelper.render.handleUnorderedElements(l,e,i,o,0,o===r.length-1,n)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,n)},s.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.start.location.x===t.start.location.x&&n.start.location.y===t.start.location.y)return!0}return!1},s.prototype.handleSplitWordSpellCheck=function(e,t,i,n,r,o,l,h){if(e.HasSpellingError&&" "!==i.text&&n){var d=this.getMatchedResultsFromElement(i,t);l=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):l,this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(d.matches,d.textResults,d.elementInfo,0,i,!1,null,l),this.handleMatchedResults(d.textResults,i,r,o,e.Suggestions,h)}else this.addCorrectWordCollection(t),h&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},s.prototype.handleMatchedResults=function(e,t,i,n,r,o){if(0===e.length&&o)t.isSpellChecked=!0;else for(var l=0;l<e.length;l++){var h=this.createErrorElementWithInfo(e.innerList[l],t);!(0,a.le)(t.errorCollection)&&!this.checkArrayHasSameElement(t.errorCollection,h)&&t.errorCollection.splice(n,0,h),this.addErrorCollection(h.text,h,r),this.documentHelper.render.renderWavyLine(h,h.start.location.x,h.start.location.y-t.margin.top,i,"#FF0000","Single",t.characterFormat.baselineAlignment,t.line.paragraph.containerWidget instanceof V?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor),o&&(t.isSpellChecked=!0)}},s.prototype.callSpellChecker=function(e,t,i,n,r,o){var l=this,h=this;return new Promise(function(d,c){if(!(0,a.le)(l)){var u=new XMLHttpRequest,p=l.documentHelper.owner.serviceUrl+l.documentHelper.owner.serverActionSettings.spellCheck;u.open("POST",p=o?p+"ByPage":p,!0),u.setRequestHeader("Content-Type","application/json"),l.setCustomHeaders(u);var f={LanguageID:e,TexttoCheck:t,CheckSpelling:i,CheckSuggestion:n,AddWord:r},g={serverActionType:"SpellCheck",headers:l.documentHelper.owner.headers,timeout:0,cancel:!1,withCredentials:!1};l.documentHelper.owner.trigger(Tt,g),g.cancel||u.send(JSON.stringify(f)),u.onreadystatechange=function(){4===u.readyState&&(200===u.status||304===u.status?d(u.response):(h.documentHelper.owner.fireServiceFailure({name:"onFailure",status:u.status,statusText:u.responseText,url:p}),c(u.response)))}}})},s.prototype.setCustomHeaders=function(e){for(var t=0;t<this.documentHelper.owner.headers.length;t++)for(var i=this.documentHelper.owner.headers[t],n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];e.setRequestHeader(o,i[o])}},s.prototype.checkForNextError=function(){if(!(0,a.le)(this.viewer)){var e=this.errorWordCollection;if(e.length>0)for(var t=0;t<e.length;t++){for(var i=e.get(e.keys[t]),n=0;n<i.length;n++){if(i[n]instanceof wt&&!i[n].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],i[n]);else if(i[n]instanceof S){var r=this.getMatchedResultsFromElement(i[n]),o=r.textResults,l=i[n].ischangeDetected?i[n].start.offset:i[n].line.getOffset(i[n],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(r.matches,o,r.elementInfo,0,i[n],!1,null,l);for(var h=0;h<o.length;h++){var d=this.createErrorElementWithInfo(o.innerList[h],i[n]);this.updateErrorElementTextBox(d.text,d);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},s.prototype.createErrorElementWithInfo=function(e,t){var i=new wt;return i.text=e.text,i.start=e.start,i.end=e.end,i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=this.documentHelper.textHelper.getWidth(i.text,t.characterFormat),i},s.prototype.getMatchedResultsFromElement=function(e,t){var i=e.line,n=this.documentHelper.owner.searchModule.textSearch.stringToRegex((0,a.le)(t)?e.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var c,r=this.textSearchResults,o=this.documentHelper.owner.searchModule.textSearch.getElementInfo(i.children[0],0,!1),l=o.fullText,h=[],d=o.elementsWithOffset;!(0,a.le)(c=n.exec(l));)h.push(c);return{matches:h,elementInfo:d,textResults:r}},s.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start,this.documentHelper.selection.end=i.end,this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end),this.documentHelper.owner.spellCheckDialog.updateSuggestionDialog(e,i)},s.prototype.getWhiteSpaceCharacterInfo=function(e,t){var i,n=0,r=0;if(i=e.match(/[\s]+/),!(0,a.le)(i)&&i.length>0)for(var o=0;o<i.length;o++)n+=this.documentHelper.textHelper.getWidth(i[o],t),r+=i[o].length;return{width:n,wordLength:r,isBeginning:!(0,a.le)(i)&&0===i.index}},s.prototype.getSpecialCharactersInfo=function(e,t){var i=[],n=0,r=0,o=0;i=e.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/);for(var l=0;l<i.length;l++)!(0,a.le)(i[l])&&i[l].length>0&&(n=this.documentHelper.textHelper.getWidth(i[l],t)),o=i.length;for(i=e.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/),l=0;l<i.length;l++)!(0,a.le)(i[l])&&i[l].length>0&&(r=this.documentHelper.textHelper.getWidth(i[l],t)),o=i.length;return{beginningWidth:n,endWidth:r,wordLength:o}},s.prototype.getCombinedElement=function(e){for(var t=e;!(0,a.le)(e)&&e instanceof S&&e.istextCombined;)t=e,e=e.previousElement;return t},s.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},s.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(i>0){for(var n=[],r=0;r<i;r++)n.push(e.errorCollection[r]);for(r=0;r<i;r++)-1===e.text.indexOf(n[r].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},s.prototype.getPageContent=function(e){var t="";if(this.documentHelper.owner.sfdtExportModule){var i=this.documentHelper.owner.sfdtExportModule;i.Initialize();var n=i.writePage(e);if(this.documentHelper.owner.textExportModule){var r=this.documentHelper.owner.textExportModule;r.pageContent="",r.setDocument(n),r.writeInternal(),t=r.pageContent}}return t},s.prototype.updateUniqueWords=function(e){if((0,a.le)(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var i=0;i<e.length;i++)this.checkForUniqueWords(e[i]);localStorage.setItem(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},s.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},s.prototype.clearCache=function(){(0,a.le)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},s.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===i?n:3&n|8).toString(16)})},s.prototype.checkSpellingInPageInfo=function(e){var n=JSON.parse(localStorage.getItem(this.uniqueKey));return(0,a.le)(n)||(0,a.le)(n[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:n[e],isElementPresent:!0}},s.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,(0,a.le)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey),this.documentHelper=void 0},s}(),Xi=function(){function s(e){this.documentHelper=e,this.optimizedHeightCollection={}}return s.prototype.getModuleName=function(){return"Optimized"},s.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},s.prototype.getFontInfo=function(e){var t=document.createElement("div");t.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;");var n=1/window.devicePixelRatio;t.style.transform="scale("+n.toString()+","+n.toString()+")",t.innerHTML='<span style="font-size:0; font-family: '+e.fontFamily+'; display: inline-block;">m</span><span style="font-size:288pt; font-family: '+e.fontFamily+";"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',document.body.appendChild(t);var r=t.firstChild.offsetTop/t.lastChild.offsetHeight,o=parseFloat((t.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:o,BaselineFactor:r}},s.prototype.getHeightInternal=function(e){var t=this.getkeyFromCharFormat(e);if((0,a.le)(this.optimizedHeightCollection[t])){var i=this.getFontInfo(e);return this.optimizedHeightCollection[t]=i,{Height:n=i.HeightFactor*e.fontSize,BaselineOffset:i.BaselineFactor*n}}var n,r=this.optimizedHeightCollection[t];return{Height:n=r.HeightFactor*e.fontSize,BaselineOffset:r.BaselineFactor*n}},s.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0},s}(),Ar=function(){function s(e){this.documentHelper=e}return s.prototype.getModuleName=function(){return"Regular"},s.prototype.getHeightInternal=function(e){var t,i,n=document.createElement("span");n.innerText="m";var r=(0,a.az)("iframe");document.body.appendChild(r),(0,a.le)(r.contentDocument)||(r.contentDocument.open(),r.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),r.contentDocument.close()),this.applyStyle(n,e);var l=document.createElement("div");l.setAttribute("style","display:inline-block;position:absolute;");var h=document.createElement("div");return h.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),l.appendChild(n),l.appendChild(h),r.contentDocument.body.appendChild(l),t=n.offsetHeight,i=h.offsetTop-n.offsetTop,document.body.removeChild(r),{Height:t,BaselineOffset:i}},s.prototype.applyStyle=function(e,t){if(!(0,a.le)(e)&&!(0,a.le)(t)){var i="white-space:nowrap;";""!==t.fontFamily&&(i+="font-family:"+t.fontFamily+";");var n=t.fontSize;n<=.5&&(n=.5),i+="font-size:"+n.toString()+"pt;",t.bold&&(i+="font-weight:bold;"),t.italic&&(i+="font-style:italic;"),e.setAttribute("style",i)}},s.prototype.destroy=function(){this.documentHelper=void 0},s}(),Ts=function(){function s(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.isCutPerformed=!1,this.isPaste=!1,this.isHtmlPaste=!1,this.documentHelper=e,this.editableRanges=new U}return Object.defineProperty(s.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),s.prototype.convertJsonToDocument=function(e){this.commentStarts=new U,this.commentEnds=new U,this.commentsCollection=new U,this.revisionCollection=new U,this.referedRevisions=[],this.footnotes=new Ut,this.endnotes=new Ut;var t=[],i=e;i=i instanceof Object?i:JSON.parse(i);var n=(0,a.le)(i.characterFormat)?this.viewer.owner.characterFormat:i.characterFormat;this.parseCharacterFormat(n,this.documentHelper.characterFormat);var r=(0,a.le)(i.paragraphFormat)?this.viewer.owner.paragraphFormat:i.paragraphFormat;return this.parseParagraphFormat(r,this.documentHelper.paragraphFormat),this.parseDocumentProtection(i),(0,a.le)(i.defaultTabWidth)||(this.documentHelper.defaultTabWidth=i.defaultTabWidth),(0,a.le)(i.trackChanges)||(this.documentHelper.owner.enableTrackChanges=i.trackChanges),(0,a.le)(i.dontUseHTMLParagraphAutoSpacing)||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=i.dontUseHTMLParagraphAutoSpacing),(0,a.le)(i.alignTablesRowByRow)||(this.documentHelper.alignTablesRowByRow=i.alignTablesRowByRow),(0,a.le)(i.background)||(this.documentHelper.backgroundColor=this.getColor(i.background.color)),(0,a.le)(i.compatibilityMode)||(this.documentHelper.compatibilityMode=i.compatibilityMode,(0,a.le)(this.documentHelper.owner.documentSettings)||(this.documentHelper.owner.documentSettings.compatibilityMode=i.compatibilityMode)),(0,a.le)(i.abstractLists)||this.parseAbstractList(i,this.documentHelper.abstractLists),(0,a.le)(i.lists)||this.parseList(i,this.documentHelper.lists),(0,a.le)(i.styles)||this.parseStyles(i,this.documentHelper.styles),(0,a.le)(i.comments)||this.parseComments(i,this.documentHelper.comments),(0,a.le)(i.revisions)||this.parseRevisions(i,this.viewer.owner.revisionsInternal.changes),(0,a.le)(i.sections)||this.parseSections(i.sections,t),(0,a.le)(i.customXml)||this.parseCustomXml(i),(0,a.le)(i.formFieldShading)||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=i.formFieldShading),(0,a.le)(i.footnotes)||this.parseFootnotes(i.footnotes,this.documentHelper.footnotes),(0,a.le)(i.endnotes)||this.parseEndtnotes(i.endnotes,this.documentHelper.endnotes),this.generalizeRevisions(),t},s.prototype.generalizeRevisions=function(){var e=this,t=new U,i=[];this.referedRevisions.forEach(function(n){var r=e.documentHelper.revisionsInternal.get(n);-1===i.indexOf(r)&&(i.push(r),t.add(n,r))}),this.viewer.owner.revisionsInternal.changes=i,this.documentHelper.revisionsInternal=t},s.prototype.parseFootnotes=function(e,t){(0,a.le)(e.separator)||this.parseBody(e.separator,t.separator),(0,a.le)(e.continuationNotice)||this.parseBody(e.continuationNotice,t.continuationNotice),(0,a.le)(e.continuationSeparator)||this.parseBody(e.continuationSeparator,t.continuationSeparator)},s.prototype.parseEndtnotes=function(e,t){(0,a.le)(e.separator)||this.parseBody(e.separator,t.separator),(0,a.le)(e.continuationNotice)||this.parseBody(e.continuationNotice,t.continuationNotice),(0,a.le)(e.continuationSeparator)||this.parseBody(e.continuationSeparator,t.continuationSeparator)},s.prototype.parseCustomXml=function(e){for(var t=0;t<e.customXml.length;t++){var i=e.customXml[t];this.revisionCollection.containsKey(i.itemID)||this.documentHelper.customXmlData.add(i.itemID,i.xml)}},s.prototype.parseDocumentProtection=function(e){(0,a.le)(e.formatting)||(this.documentHelper.restrictFormatting=e.formatting),(0,a.le)(e.enforcement)||(this.documentHelper.isDocumentProtected=e.enforcement),(0,a.le)(e.protectionType)||(this.documentHelper.protectionType=e.protectionType),(0,a.le)(e.hashValue)||(this.documentHelper.hashValue=e.hashValue),(0,a.le)(e.saltValue)||(this.documentHelper.saltValue=e.saltValue)},s.prototype.parseStyles=function(e,t){for(var i=0;i<e.styles.length;i++)(0,a.le)(this.documentHelper.styles.findByName(e.styles[i].name))&&this.parseStyle(e,e.styles[i],t)},s.prototype.parseRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];if(!(0,a.le)(n.revisionId)&&!(0,a.le)(n.revisionType)){var r=this.parseRevision(n),o=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===n.revisionType&&this.isPaste&&this.documentHelper.owner.enableTrackChanges)continue;this.revisionCollection.containsKey(n.revisionId)||this.revisionCollection.add(n.revisionId,r)}else this.revisionCollection.add(n.revisionId,r);for(var l=0;l<t.length;l++)t[l].revisionID===r.revisionID&&(o=!1);o&&t.push(r)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},s.prototype.parseRevision=function(e){if(!(0,a.le)(e)){var t=new Ke(this.viewer.owner,e.author,e.date);return t.revisionID=e.revisionId,t.revisionType=e.revisionType,t}},s.prototype.checkAndApplyRevision=function(e,t){if(!(0,a.le)(e.revisionIds)&&e.revisionIds.length>0)for(var i=0;i<e.revisionIds.length;i++){var n=e.revisionIds[i];if(this.revisionCollection.containsKey(n)){this.referedRevisions.push(n);var r=this.revisionCollection.get(n);t instanceof ue||r.range.push(t),t.revisions.push(r)}}},s.prototype.parseComments=function(e,t){for(var i=0,n=0;n<e.comments.length;n++){var r=e.comments[n],o=void 0;for(o=this.parseComment(r,o);i<r.replyComments.length;){var l=void 0;(l=this.parseComment(r.replyComments[i],l)).ownerComment=o,l.isReply=!0,o.replyComments.push(l),this.commentsCollection.add(l.commentId,l),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},s.prototype.parseComment=function(e,t){return(t=new qt(e.date)).author=e.author,t.initial=e.initial,t.commentId=e.commentId,t.isResolved=e.done,t.text=this.parseCommentText(e.blocks),t},s.prototype.parseCommentText=function(e){for(var t="",i=0;i<e.length;i++){0!==i&&(t+="\n");for(var n=0;n<e[i].inlines.length;n++)t+=e[i].inlines[n].text}return t},s.prototype.parseStyle=function(e,t,i){var n;if(!(0,a.le)(t.type)){if("Paragraph"===t.type&&((n=new Xe).type="Paragraph"),"Character"===t.type&&((n=new gt).type="Character"),(0,a.le)(t.name)||(n.name=t.name),i.push(n),!(0,a.le)(t.basedOn)){var r=i.findByName(t.basedOn);if((0,a.le)(r)){var o=this.getStyle(t.basedOn,e),l=void 0;l=(0,a.le)(o)||o.type!==n.type?"Paragraph"===n.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):o,this.parseStyle(e,l,i),n.basedOn=i.findByName(l.name)}else r.type===n.type&&(n.basedOn=r)}if(!(0,a.le)(t.link)){var h=i.findByName(t.link),d=this.getStyle(t.link,e);if(l=void 0,(0,a.le)(h)){if((0,a.le)(d)){var c={};c.characterFormat=t.characterFormat,c.name=t.name+" Char",c.type="Character",c.basedOn="Normal"===t.basedOn?"Default Paragraph Font":t.basedOn+" Char",l=c}else l=d;this.parseStyle(e,l,i),n.link=(0,a.le)(i.findByName(l.name))?t.link:i.findByName(l.name)}else n.link=h}if((0,a.le)(t.characterFormat)||this.parseCharacterFormat(t.characterFormat,n.characterFormat),(0,a.le)(t.paragraphFormat)||this.parseParagraphFormat(t.paragraphFormat,n.paragraphFormat),!(0,a.le)(t.next))if(t.next===t.name)n.next=n;else{var u=i.findByName(t.next);if((0,a.le)(u)||u.type!==n.type){var p=this.getStyle(t.next,e);(0,a.le)(p)?n.next=n:(this.parseStyle(e,p,i),n.next=i.findByName(p.name))}else n.next=u}}},s.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},s.prototype.parseAbstractList=function(e,t){for(var i=0;i<e.abstractLists.length;i++){var n=new et,r=e.abstractLists[i];if(t.push(n),!(0,a.le)(r)&&((0,a.le)(r.abstractListId)||(n.abstractListId=r.abstractListId),!(0,a.le)(r.levels)))for(var o=0;o<r.levels.length;o++){var l=r.levels[o];if(!(0,a.le)(l)){var h=this.parseListLevel(l,n);n.levels.push(h)}}}},s.prototype.parseListLevel=function(e,t){var i=new nt(t);return"Bullet"===e.listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=(0,a.le)(e.numberFormat)?"":e.numberFormat):(i.listLevelPattern=e.listLevelPattern,i.startAt=e.startAt,i.numberFormat=(0,a.le)(e.numberFormat)?"":e.numberFormat,i.restartLevel=e.restartLevel>=0?e.restartLevel:e.levelNumber),i.followCharacter=e.followCharacter,this.parseCharacterFormat(e.characterFormat,i.characterFormat),this.parseParagraphFormat(e.paragraphFormat,i.paragraphFormat),i},s.prototype.parseList=function(e,t){for(var i=0;i<e.lists.length;i++){var n=new ft,r=e.lists[i];(0,a.le)(r.abstractListId)||(n.abstractListId=r.abstractListId,n.abstractList=this.documentHelper.getAbstractListById(r.abstractListId)),t.push(n),(0,a.le)(r.listId)||(n.listId=r.listId),r.hasOwnProperty("levelOverrides")&&this.parseLevelOverride(r.levelOverrides,n)}},s.prototype.parseLevelOverride=function(e,t){if(!(0,a.le)(e))for(var i=0;i<e.length;i++){var n=new It,r=e[i];n.startAt=r.startAt,n.levelNumber=r.levelNumber,(0,a.le)(r.overrideListLevel)||(n.overrideListLevel=this.parseListLevel(r.overrideListLevel,n)),t.levelOverrides.push(n)}},s.prototype.parseSections=function(e,t){for(var i=0;i<e.length;i++){var n=new j;n.sectionFormat=new je(n),n.index=i;var r=e[i];(0,a.le)(r.sectionFormat)||this.parseSectionFormat(r.sectionFormat,n.sectionFormat),(0,a.le)(r.headersFooters)&&(r.headersFooters={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(r.headersFooters,this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(r.blocks,n,i+1<e.length);for(var o=0;o<n.childWidgets.length;o++)n.childWidgets[o].containerWidget=n;t.push(n)}},s.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var i={};if(!(0,a.le)(e.header)){var n=new Ce("OddHeader");i[0]=n,this.parseTextBody(e.header.blocks,n)}if(!(0,a.le)(e.footer)){var r=new Ce("OddFooter");i[1]=r,this.parseTextBody(e.footer.blocks,r)}if(!(0,a.le)(e.evenHeader)){var o=new Ce("EvenHeader");i[2]=o,this.parseTextBody(e.evenHeader.blocks,o)}if(!(0,a.le)(e.evenFooter)){var l=new Ce("EvenFooter");i[3]=l,this.parseTextBody(e.evenFooter.blocks,l)}if(!(0,a.le)(e.firstPageHeader)){var h=new Ce("FirstPageHeader");i[4]=h,this.parseTextBody(e.firstPageHeader.blocks,h)}if(!(0,a.le)(e.firstPageFooter)){var d=new Ce("FirstPageFooter");i[5]=d,this.parseTextBody(e.firstPageFooter.blocks,d)}return i},s.prototype.parseTextBody=function(e,t,i){this.parseBody(e,t.childWidgets,t,i)},s.prototype.addCustomStyles=function(e){if(!(0,a.le)(e.styles))for(var t=0;t<e.styles.length;t++)void 0===this.documentHelper.styles.findByName(e.styles[t].name)&&this.parseStyle(e,e.styles[t],this.documentHelper.styles)},s.prototype.parseBody=function(e,t,i,n,r){if(!(0,a.le)(e))for(var o=0;o<e.length;o++){var l=e[o],h=!1;if(l.hasOwnProperty("inlines")){var c=new I;if(c.characterFormat=new ie(c),c.paragraphFormat=new ue(c),l.inlines.length>0&&(h=this.parseParagraph(l.inlines,c,!1)),n&&l===e[e.length-1]&&!h)n&&1===e.length&&t.push(c);else{this.parseCharacterFormat(l.characterFormat,c.characterFormat),this.parseParagraphFormat(l.paragraphFormat,c.paragraphFormat);var u,p="Normal";!(0,a.le)(l.paragraphFormat)&&!(0,a.le)(l.paragraphFormat.styleName)&&(p=l.paragraphFormat.styleName),u=this.documentHelper.styles.findByName(p,"Paragraph"),(0,a.le)(u)||c.paragraphFormat.applyStyle(u),t.push(c)}c.index=t.length-1,c.containerWidget=i}else if(l.hasOwnProperty("rows"))this.parseTable(l,t,t.length,i);else if(l.hasOwnProperty("contentControlProperties")){var f=new $("Block"),g=new $("Block");this.parseContentControlProperties(l.contentControlProperties,f.contentControlProperties),g.contentControlProperties=f.contentControlProperties,f.type=0,g.type=1,this.parseBody(l.blocks,t,i,n,f.contentControlProperties);for(var m=0;m<2;m++){var v=t.length<l.blocks.length?t[0]:0===m?t[t.length-l.blocks.length]:t[t.length-1],y=void 0;if(v instanceof I?y=v:v instanceof k&&(y=0===m?v.firstChild.firstChild.firstChild:v.lastChild.lastChild.lastChild),!(0,a.le)(y)&&0===y.childWidgets.length){var C=new oe(y);y.childWidgets.push(C)}0===m?(y.firstChild.children.splice(0,0,f),f.line=y.firstChild):(y.lastChild.children.push(g),g.line=y.lastChild)}}(0,a.le)(r)||(t[t.length-1].contentControlProperties=r)}},s.prototype.parseTable=function(e,t,i,n){var r=new k;r.index=i,r.tableFormat=new Oe(r),(0,a.le)(e.tableFormat)||this.parseTableFormat(e.tableFormat,r.tableFormat),r.title=e.title,r.description=e.description,this.parseTablePositioning(e,r);for(var o=0;o<e.rows.length;o++){var l=new Q;l.rowFormat=new De(l);var h=e.rows[o];if((0,a.le)(h.contentControlProperties)||(l.contentControlProperties=new mi("Row"),this.parseContentControlProperties(h.contentControlProperties,l.contentControlProperties)),h.hasOwnProperty("rowFormat")){this.parseRowFormat(h.rowFormat,l.rowFormat),this.parseRowGridValues(h,l.rowFormat),this.parseRowGridValues(h.rowFormat,l.rowFormat),l.index=o;for(var d=0;d<e.rows[o].cells.length;d++){var c=new V;c.cellFormat=new it(c),(0,a.le)(e.rows[o].cells[d].contentControlProperties)||(c.contentControlProperties=new mi("Cell"),this.parseContentControlProperties(e.rows[o].cells[d].contentControlProperties,c.contentControlProperties)),l.childWidgets.push(c),c.containerWidget=l,c.index=d,c.rowIndex=o,c.columnIndex=d,e.rows[o].cells[d].hasOwnProperty("cellFormat")&&this.parseCellFormat(e.rows[o].cells[d].cellFormat,c.cellFormat);for(var u=e.rows[o].cells[d].blocks,p=0;p<u.length;p++)u[p].hasOwnProperty("rows")&&(r.isContainInsideTable=!0);if(this.isPageBreakInsideTable=!0,this.parseTextBody(e.rows[o].cells[d].blocks,c,!1),!(0,a.le)(c.contentControlProperties)){var f=new $("Cell"),g=new $("Cell");if(f.contentControlProperties=c.contentControlProperties,g.contentControlProperties=c.contentControlProperties,f.type=0,g.type=1,0===c.firstChild.childWidgets.length){var m=new oe(c.firstChild);c.firstChild.childWidgets.push(m)}f.line=c.firstChild.firstChild,c.firstChild.firstChild.children.splice(0,0,f),g.line=c.lastChild.lastChild,c.lastChild.lastChild.children.push(g)}if(!(0,a.le)(l.contentControlProperties))if(l.firstChild===c){var v=new $("Row");v.contentControlProperties=l.contentControlProperties,v.type=0,0===c.firstChild.childWidgets.length&&(m=new oe(c.firstChild),c.firstChild.childWidgets.push(m)),v.line=c.firstChild.firstChild,c.firstChild.firstChild.children.splice(0,0,v)}else if(l.lastChild===c){var y=new $("Row");y.contentControlProperties=l.contentControlProperties,y.type=1,0===c.lastChild.childWidgets.length&&(m=new oe(c.lastChild),c.lastChild.childWidgets.push(m)),y.line=c.lastChild.lastChild,c.lastChild.lastChild.children.push(y)}this.isPageBreakInsideTable=!1}}r.childWidgets.push(l),l.containerWidget=r}r.containerWidget=n,t.push(r),r.isGridUpdated=!1},s.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!(0,a.le)(e.wrapTextAround)&&e.wrapTextAround,t.wrapTextAround&&(t.positioning=new Ao,t.positioning.allowOverlap=e.positioning.allowOverlap,t.positioning.distanceBottom=w.convertPointToPixel(e.positioning.distanceBottom),t.positioning.distanceLeft=w.convertPointToPixel(e.positioning.distanceLeft),t.positioning.distanceRight=w.convertPointToPixel(e.positioning.distanceRight),t.positioning.distanceTop=w.convertPointToPixel(e.positioning.distanceTop),(0,a.le)(e.positioning.verticalAlignment)||(t.positioning.verticalAlignment=e.positioning.verticalAlignment),(0,a.le)(e.positioning.verticalOrigin)||(t.positioning.verticalOrigin=e.positioning.verticalOrigin),t.positioning.verticalPosition=e.positioning.verticalPosition,(0,a.le)(e.positioning.horizontalAlignment)||(t.positioning.horizontalAlignment=e.positioning.horizontalAlignment),(0,a.le)(e.positioning.horizontalOrigin)||(t.positioning.horizontalOrigin=e.positioning.horizontalOrigin),t.positioning.horizontalPosition=e.positioning.horizontalPosition)},s.prototype.parseRowGridValues=function(e,t){(0,a.le)(e.gridBefore)||(t.gridBefore=e.gridBefore),(0,a.le)(e.gridBeforeWidth)||(t.gridBeforeWidth=e.gridBeforeWidth),(0,a.le)(e.gridBeforeWidthType)||(t.gridBeforeWidthType=e.gridBeforeWidthType),(0,a.le)(e.gridAfter)||(t.gridAfter=e.gridAfter),(0,a.le)(e.gridAfterWidth)||(t.gridAfterWidth=e.gridAfterWidth),(0,a.le)(e.gridAfterWidthType)||(t.gridAfterWidthType=e.gridAfterWidthType)},s.prototype.parseContentControlProperties=function(e,t){if((0,a.le)(e.lockContentControl)||(t.lockContentControl=e.lockContentControl),(0,a.le)(e.lockContents)||(t.lockContents=e.lockContents),(0,a.le)(e.tag)||(t.tag=e.tag),(0,a.le)(e.color)||(t.color=e.color),(0,a.le)(e.title)||(t.title=e.title),(0,a.le)(e.appearance)||(t.appearance=e.appearance),(0,a.le)(e.type)||(t.type=e.type),(0,a.le)(e.hasPlaceHolderText)||(t.hasPlaceHolderText=e.hasPlaceHolderText),(0,a.le)(e.multiline)||(t.multiline=e.multiline),(0,a.le)(e.isTemporary)||(t.isTemporary=e.isTemporary),(0,a.le)(e.characterFormat)||this.parseCharacterFormat(e.characterFormat,t.characterFormat),"CheckBox"===t.type)(0,a.le)(e.isChecked)||(t.isChecked=e.isChecked),(0,a.le)(e.uncheckedState)||(t.uncheckedState=new zn,t.uncheckedState.font=e.uncheckedState.font,t.uncheckedState.value=e.uncheckedState.value),(0,a.le)(e.checkedState)||(t.checkedState=new zn,t.checkedState.font=e.checkedState.font,t.checkedState.value=e.checkedState.value);else if("Date"===t.type)(0,a.le)(e.dateCalendarType)||(t.dateCalendarType=e.dateCalendarType),(0,a.le)(e.dateStorageFormat)||(t.dateStorageFormat=e.dateStorageFormat),(0,a.le)(e.dateDisplayLocale)||(t.dateDisplayLocale=e.dateDisplayLocale),(0,a.le)(e.dateDisplayFormat)||(t.dateDisplayFormat=e.dateDisplayFormat);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!(0,a.le)(e.contentControlListItems))for(var i=0;i<e.contentControlListItems.length;i++){var n=new Bo;n.displayText=e.contentControlListItems[i].displayText,n.value=e.contentControlListItems[i].value,t.contentControlListItems.push(n)}(0,a.le)(e.xmlMapping)||(t.xmlMapping=new Mo,t.xmlMapping.isMapped=e.xmlMapping.isMapped,t.xmlMapping.isWordMl=e.xmlMapping.isWordMl,(0,a.le)(e.xmlMapping.prefixMapping)||(t.xmlMapping.prefixMapping=e.xmlMapping.prefixMapping),t.xmlMapping.xPath=e.xmlMapping.xPath,t.xmlMapping.storeItemId=e.xmlMapping.storeItemId,(0,a.le)(e.xmlMapping.customXmlPart)||(t.xmlMapping.customXmlPart=new Oo,t.xmlMapping.customXmlPart.id=e.xmlMapping.customXmlPart.id,t.xmlMapping.customXmlPart.xml=e.xmlMapping.customXmlPart.xml))},s.prototype.parseParagraph=function(e,t,i,n){var r=!1;(0,a.le)(n)?n=new oe(t):r=!0;for(var l,o=!1,h=this.viewer.owner.enableTrackChanges,d=0;d<e.length;d++){var c=e[d];if(c.hasOwnProperty("text")){var u=void 0;if(this.documentHelper.isPageField)(u=new st).fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1];else if("\t"===c.text)u=new at;else{if("\f"===c.text&&this.isPageBreakInsideTable)continue;u=new S}if(u.characterFormat=new ie(u),this.parseCharacterFormat(c.characterFormat,u.characterFormat,i),this.applyCharacterStyle(c,u),u.text=c.text,this.isHtmlPaste&&u instanceof S){var p=void 0;n.children.length>0&&(p=n.children[n.children.length-1]),this.documentHelper.textHelper.isRTLText(u.text)?(u.characterFormat.bidi=!0,p instanceof S&&" "===p.text&&(p.characterFormat.bidi=!0)):" "===u.text&&p&&p.characterFormat.bidi&&(u.characterFormat.bidi=!0)}if(this.documentHelper.owner.parser.isPaste&&!this.isCutPerformed){if(!(0,a.le)(c.revisionIds))for(var f=0;f<c.revisionIds.length;f++)if(this.revisionCollection.containsKey(c.revisionIds[f])){if(h&&(l=this.revisionCollection.get(c.revisionIds[f])),!(0,a.le)(l)&&!(0,a.le)(n.children[d-1].revisions[f])&&(!h||h&&"Deletion"===l.revisionType)&&l.revisionID===c.revisionIds[f]){c.revisionIds[f]=n.children[d-1].revisions[f].revisionID,this.checkAndApplyRevision(c,u);continue}h||(l=this.documentHelper.revisionsInternal.get(c.revisionIds[f])),this.documentHelper.owner.editorModule.insertRevision(u,l.revisionType,l.author),c.revisionIds[f]=u.revisions[f].revisionID}}else this.checkAndApplyRevision(c,u);u.line=n,n.children.push(u),o=!0}else if(c.hasOwnProperty("footnoteType")){var g=new Ee;g.line=n,g.footnoteType=c.footnoteType,"Footnote"===g.footnoteType?this.documentHelper.footnoteCollection.push(g):this.documentHelper.endnoteCollection.push(g),g.symbolCode=c.symbolCode,g.symbolFontName=c.symbolFontName,g.customMarker=c.customMarker,g.characterFormat=new ie(g),this.parseCharacterFormat(c.characterFormat,g.characterFormat,i),this.applyCharacterStyle(c,g),this.parseBody(c.blocks,g.bodyWidget.childWidgets,void 0,!1),n.children.push(g),o=!0}else if(c.hasOwnProperty("chartType")){this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.chartType=!0);var m=new _t;m.title=c.chartTitle,m.type=c.chartType,m.chartGapWidth=c.gapWidth,m.chartOverlap=c.overlap,this.parseChartTitleArea(c.chartTitleArea,m.chartTitleArea),this.parseChartArea(c.chartArea,m.chartArea),this.parseChartArea(c.plotArea,m.chartPlotArea),this.parseChartLegend(c.chartLegend,m.chartLegend),this.parseChartData(c,m),this.parseChartCategoryAxis(c.chartPrimaryCategoryAxis,m.chartPrimaryCategoryAxis),this.parseChartCategoryAxis(c.chartPrimaryValueAxis,m.chartPrimaryValueAxis),null!=c.chartDataTable&&this.parseChartDataTable(c.chartDataTable,m.chartDataTable),m.line=n,n.children.push(m),m.height=w.convertPointToPixel(c.height),m.width=w.convertPointToPixel(c.width);var v=new uo;v.chartRender(c),m.officeChart=v,v.chart.appendTo(m.targetElement),o=!0}else if(c.hasOwnProperty("imageString")){var y=new ee(e[d].isInlineImage);y.isMetaFile=e[d].isMetaFile,y.isCompressed=e[d].isCompressed,y.metaFileImageString=e[d].metaFileImageString,y.characterFormat=new ie(y),y.line=n,this.checkAndApplyRevision(c,y),n.children.push(y);var b=w.formatClippedString(c.imageString).formatClippedString,C=this.validateImageUrl(b);y.imageString=C?c.imageString:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC",y.width=w.convertPointToPixel(c.width),y.height=w.convertPointToPixel(c.height),y.top=c.top,y.left=c.left,y.bottom=c.bottom,y.right=c.right,y.cropHeightScale=c.getimageheight,y.cropWidthScale=c.getimagewidth,y.name=c.name,y.alternativeText=c.alternativeText,y.title=c.title,y.visible=c.visible,y.widthScale=c.widthScale,y.heightScale=c.heightScale,y.verticalPosition=w.convertPointToPixel(c.verticalPosition),y.verticalOrigin=c.verticalOrigin,y.verticalAlignment=c.verticalAlignment,y.horizontalPosition=w.convertPointToPixel(c.horizontalPosition),y.horizontalOrigin=c.horizontalOrigin,y.horizontalAlignment=c.horizontalAlignment,y.allowOverlap=c.allowOverlap,y.textWrappingStyle=(0,a.le)(c.textWrappingStyle)?"Inline":c.textWrappingStyle,y.textWrappingType=c.textWrappingType,y.zOrderPosition=c.zOrderPosition,y.layoutInCell=c.layoutInCell,(!(0,a.le)(c.top)&&0!==c.top||!(0,a.le)(c.bottom)&&0!==c.bottom||!(0,a.le)(c.left)&&0!==c.left||!(0,a.le)(c.right)&&0!==c.right)&&(y.isCrop=!0),"Inline"!==y.textWrappingStyle&&t.floatingElements.push(y),this.parseCharacterFormat(c.characterFormat,y.characterFormat),o=!0}else if(c.hasOwnProperty("hasFieldEnd")||c.hasOwnProperty("fieldType")&&0===c.fieldType){var F=new H(0);if(this.parseCharacterFormat(c.characterFormat,F.characterFormat,i),this.applyCharacterStyle(c,F),F.fieldCodeType=c.fieldCodeType,F.hasFieldEnd=c.hasFieldEnd,c.hasOwnProperty("formFieldData")){var T=void 0;c.formFieldData.hasOwnProperty("textInput")?((T=new Re).type=c.formFieldData.textInput.type,T.maxLength=c.formFieldData.textInput.maxLength,T.defaultValue=c.formFieldData.textInput.defaultValue,T.format=c.formFieldData.textInput.format):c.formFieldData.hasOwnProperty("checkBox")?((T=new qe).sizeType=c.formFieldData.checkBox.sizeType,T.size=c.formFieldData.checkBox.size,T.defaultValue=c.formFieldData.checkBox.defaultValue,T.checked=c.formFieldData.checkBox.checked):((T=new Ge).dropdownItems=c.formFieldData.dropDownList.dropDownItems,T.selectedIndex=c.formFieldData.dropDownList.selectedIndex),T.name=c.formFieldData.name,T.enabled=c.formFieldData.enabled,T.helpText=c.formFieldData.helpText,T.statusText=c.formFieldData.statusText,F.formFieldData=T,this.documentHelper.formFields.push(F)}this.documentHelper.fieldStacks.push(F),this.checkAndApplyRevision(c,F),F.line=n,this.documentHelper.fields.push(F),n.children.push(F)}else if(c.hasOwnProperty("fieldType")){var x=void 0;if(2===c.fieldType){if(x=new H(2),this.parseCharacterFormat(c.characterFormat,x.characterFormat,i),this.fieldSeparator=x,this.documentHelper.fieldStacks.length>0&&(x.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],x.fieldBegin.fieldSeparator=x,n.children.length>=2)){var E=this.containsFieldBegin(n);!(0,a.le)(E)&&E instanceof S&&(E.text.match("PAGE")||E.text.match("page"))&&(this.documentHelper.isPageField=!0)}}else 1===c.fieldType&&(x=new H(1),this.parseCharacterFormat(c.characterFormat,x.characterFormat,i),this.applyCharacterStyle(c,x),this.checkAndApplyRevision(c,x),this.documentHelper.fieldStacks.length>0&&(x.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],x.fieldBegin.fieldEnd=x),!(0,a.le)(x.fieldBegin)&&x.fieldBegin.fieldSeparator&&(x.fieldSeparator=x.fieldBegin.fieldSeparator,x.fieldBegin.fieldSeparator.fieldEnd=x,o=!0),this.documentHelper.fieldStacks.splice(this.documentHelper.fieldStacks.length-1,1),this.fieldSeparator=void 0,this.documentHelper.isPageField=!1,this.documentHelper.fieldCollection.push(x.fieldBegin));x.line=n,n.children.push(x)}else if(c.hasOwnProperty("bookmarkType")){var L=void 0;if((L=new O(c.bookmarkType)).name=c.name,this.checkAndApplyRevision(c,L),n.children.push(L),L.line=n,!this.isParseHeader||this.isPaste)if(0===c.bookmarkType){var W=this.isPaste&&!this.documentHelper.bookmarks.containsKey(L.name);!this.isPaste||W?this.documentHelper.bookmarks.add(L.name,L):W||n.children.splice(n.children.indexOf(L),1)}else if(1===c.bookmarkType&&this.documentHelper.bookmarks.containsKey(L.name)){var R=this.documentHelper.bookmarks.get(L.name),N=this.isPaste&&(0,a.le)(R.reference);!this.isPaste||N?(R.reference=L,L.reference=R):N||n.children.splice(n.children.indexOf(L),1)}0!==L.name.indexOf("_")&&(o=!0)}else if(c.hasOwnProperty("editRangeId")){if(c.hasOwnProperty("editableRangeStart")){var B=new He;if(this.editableRanges.containsKey(c.editRangeId)){var q=this.editableRanges.get(c.editRangeId);B.editRangeStart=q,q.editRangeEnd=B,this.editableRanges.remove(c.editRangeId)}n.children.push(B),B.line=n}else{var A=this.parseEditableRangeStart(c);n.children.push(A),A.line=n,this.editableRanges.containsKey(c.editRangeId)||this.editableRanges.add(c.editRangeId,A)}o=!0}else if(c.hasOwnProperty("commentId")){var X=c.commentId,K=void 0;if(this.commentStarts.containsKey(X)&&this.commentStarts.get(X),this.commentEnds.containsKey(X)&&this.commentEnds.get(X),c.hasOwnProperty("commentCharacterType")){if(0===c.commentCharacterType){var ge=new ae(0);ge.commentId=X,this.commentStarts.containsKey(X)||this.commentStarts.add(X,ge),ge.line=n,n.children.push(ge),K=this.commentsCollection.get(X),(0,a.le)(K)||(K.commentStart=ge,ge.comment=K)}else{var te=new ae(1);te.commentId=X,this.commentEnds.containsKey(X)||this.commentEnds.add(X,te),te.line=n,n.children.push(te),K=this.commentsCollection.get(X),(0,a.le)(K)||(K.commentEnd=te,te.comment=K)}!(0,a.le)(K)&&K.isReply&&((0,a.le)(K.ownerComment.commentStart)&&(K.ownerComment.commentStart=K.commentStart),(0,a.le)(K.ownerComment.commentEnd)&&(K.ownerComment.commentEnd=K.commentEnd))}}else if(c.hasOwnProperty("shapeId")){var G=new de;if(G.shapeId=c.shapeId,G.name=c.name,G.alternativeText=c.alternativeText,G.title=c.title,G.visible=c.visible,G.width=w.convertPointToPixel(c.width),G.height=w.convertPointToPixel(c.height),G.widthScale=c.widthScale,G.heightScale=c.heightScale,G.verticalPosition=w.convertPointToPixel(c.verticalPosition),G.verticalOrigin=c.verticalOrigin,G.verticalAlignment=c.verticalAlignment,G.verticalRelativePercent=c.verticalRelativePercent,G.horizontalPosition=w.convertPointToPixel(c.horizontalPosition),G.horizontalOrigin=c.horizontalOrigin,G.horizontalAlignment=c.horizontalAlignment,G.horizontalRelativePercent=c.horizontalRelativePercent,G.zOrderPosition=c.zOrderPosition,G.allowOverlap=c.allowOverlap,G.textWrappingStyle=(0,a.le)(c.textWrappingStyle)?"InFrontOfText":c.textWrappingStyle,G.textWrappingType=c.textWrappingType,G.distanceBottom=w.convertPointToPixel(c.distanceBottom),G.distanceLeft=w.convertPointToPixel(c.distanceLeft),G.distanceRight=w.convertPointToPixel(c.distanceRight),G.distanceTop=w.convertPointToPixel(c.distanceTop),G.layoutInCell=c.layoutInCell,G.lockAnchor=c.lockAnchor,G.autoShapeType=c.autoShapeType,c.hasOwnProperty("lineFormat")){var Ae=new Vo;Ae.line=c.lineFormat.line,Ae.lineFormatType=c.lineFormat.lineFormatType,Ae.color=c.lineFormat.color,Ae.weight=c.lineFormat.weight,Ae.dashStyle=c.lineFormat.lineStyle,G.lineFormat=Ae}if(c.hasOwnProperty("fillFormat")){var pe=new Uo;pe.color=c.fillFormat.color,pe.fill=c.fillFormat.fill,G.fillFormat=pe}if(c.hasOwnProperty("textFrame")){var me=new be;me.textVerticalAlignment=c.textFrame.textVerticalAlignment,me.marginLeft=w.convertPointToPixel(c.textFrame.leftMargin),me.marginRight=w.convertPointToPixel(c.textFrame.rightMargin),me.marginTop=w.convertPointToPixel(c.textFrame.topMargin),me.marginBottom=w.convertPointToPixel(c.textFrame.bottomMargin),this.parseBody(c.textFrame.blocks,me.childWidgets,me),G.textFrame=me,me.containerShape=G}G.line=n,this.checkAndApplyRevision(c,G),n.children.push(G),t.floatingElements.push(G)}else if(c.hasOwnProperty("contentControlProperties")){var ze=new $("Inline"),Be=new $("Inline");this.parseContentControlProperties(c.contentControlProperties,ze.contentControlProperties),Be.contentControlProperties=ze.contentControlProperties,ze.line=n,Be.line=n,ze.type=0,Be.type=1,n.children.push(ze),this.parseParagraph(c.inlines,t,i,n);for(var Me=n.children[n.children.length-1];!(Me instanceof $);)Me.contentControlProperties=ze.contentControlProperties,Me=Me.previousElement;n.children.push(Be),o=!0}}return this.isCutPerformed=!1,r||t.childWidgets.push(n),o},s.prototype.applyCharacterStyle=function(e,t){if(!(0,a.le)(e.characterFormat)&&!(0,a.le)(e.characterFormat.styleName)){var i=this.documentHelper.styles.findByName(e.characterFormat.styleName,"Character");t.characterFormat.applyStyle(i)}},s.prototype.parseEditableRangeStart=function(e){var t=new xe;return(0,a.le)(e.columnFirst)||(t.columnFirst=e.columnFirst),(0,a.le)(e.columnLast)||(t.columnLast=e.columnLast),(0,a.le)(e.user)||(t.user=e.user,-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),!(0,a.le)(e.group)&&""!==e.group&&(t.group=e.group,t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},s.prototype.addEditRangeCollection=function(e,t){if(this.documentHelper.editRanges.containsKey(e))this.documentHelper.editRanges.get(e).push(t);else{var n=[];n.push(t),this.documentHelper.editRanges.add(e,n)}},s.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e.fontName,t.chartFontSize=e.fontSize,this.parseChartDataFormat(e.dataFormat,t.dataFormat),this.parseChartLayout(e.layout,t.layout)},s.prototype.parseChartDataFormat=function(e,t){t.fill.color=e.fill.foreColor,t.fill.rgb=e.fill.rgb,t.line.color=e.line.color,t.line.rgb=e.line.rgb},s.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e.layoutX,t.chartLayoutTop=e.layoutY},s.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e.position,this.parseChartTitleArea(e.chartTitleArea,t.chartTitleArea)},s.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e.categoryType,t.categoryNumberFormat=e.numberFormat,t.interval=e.majorUnit,t.axisFontSize=e.fontSize,t.axisFontName=e.fontName,t.max=e.maximumValue,t.min=e.minimumValue,t.majorGridLines=e.hasMajorGridLines,t.minorGridLines=e.hasMinorGridLines,t.majorTick=e.majorTickMark,t.minorTick=e.minorTickMark,t.tickPosition=e.tickLabelPosition,t.categoryAxisTitle=e.chartTitle,null!=e.chartTitle&&this.parseChartTitleArea(e.chartTitleArea,t.chartTitleArea)},s.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=e.showSeriesKeys,t.hasHorzBorder=e.hasHorzBorder,t.hasVertBorder=e.hasVertBorder,t.hasBorders=e.hasBorders},s.prototype.parseChartArea=function(e,t){t.chartForeColor=e.foreColor},s.prototype.parseChartData=function(e,t){for(var i=0;i<e.chartCategory.length;i++){var n=new _o,r=e.chartCategory[i];r.hasOwnProperty("categoryXName")&&(n.xName=r.categoryXName);for(var o=0;o<r.chartData.length;o++){var l=new qo,h=r.chartData[o];l.yAxisValue=h.yValue,"Bubble"===e.chartType&&(l.bubbleSize=h.size),n.chartData.push(l)}t.chartCategory.push(n)}this.parseChartSeries(e,t)},s.prototype.parseChartSeries=function(e,t){for(var i=e.chartType,n="Pie"===i||"Doughnut"===i,r=0;r<e.chartSeries.length;r++){var o=new Go,l=e.chartSeries[r];if(l.hasOwnProperty("seriesName")){if(o.seriesName=l.seriesName,n&&(l.hasOwnProperty("firstSliceAngle")&&(o.firstSliceAngle=l.firstSliceAngle),"Doughnut"===i&&(o.doughnutHoleSize=l.holeSize)),l.hasOwnProperty("dataLabel")&&this.parseChartDataLabels(l.dataLabel,o),l.hasOwnProperty("seriesFormat")){var h=new Un,d=l.seriesFormat;h.markerStyle=d.markerStyle,h.markerColor=d.markerColor,h.numberValue=d.markerSize,o.seriesFormat=h}if(l.hasOwnProperty("errorBar")){var c=o.errorBar;c.errorType=l.errorBar.type,c.errorDirection=l.errorBar.direction,c.errorEndStyle=l.errorBar.endStyle,c.numberValue=l.errorBar.numberValue}l.hasOwnProperty("trendLines")&&this.parseChartTrendLines(l.trendLines,o),this.parseChartSeriesDataPoints(l.dataPoints,o)}t.chartSeries.push(o)}},s.prototype.parseChartDataLabels=function(e,t){var i=new _n;i.labelPosition=e.position,i.fontName=e.fontName,i.fontColor=e.fontColor,i.fontSize=e.fontSize,i.isLegendKey=e.isLegendKey,i.isBubbleSize=e.isBubbleSize,i.isCategoryName=e.isCategoryName,i.isSeriesName=e.isSeriesName,i.isValue=e.isValue,i.isPercentage=e.isPercentage,i.isLeaderLines=e.isLeaderLines,t.dataLabels=i},s.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var n=new qn;this.parseChartDataFormat(e[i],n),t.chartDataFormat.push(n)}},s.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=new Xo;r.trendLineName=n.name,r.trendLineType=n.type,r.forwardValue=n.forward,r.backwardValue=n.backward,r.interceptValue=n.intercept,r.isDisplayEquation=n.isDisplayEquation,r.isDisplayRSquared=n.isDisplayRSquared,t.trendLines.push(r)}},s.prototype.parseTableFormat=function(e,t){this.parseBorders(e.borders,t.borders),(0,a.le)(e.allowAutoFit)||(t.allowAutoFit=e.allowAutoFit),(0,a.le)(e.cellSpacing)||(t.cellSpacing=e.cellSpacing),(0,a.le)(e.leftMargin)||(t.leftMargin=e.leftMargin),(0,a.le)(e.topMargin)||(t.topMargin=e.topMargin),(0,a.le)(e.rightMargin)||(t.rightMargin=e.rightMargin),(0,a.le)(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),(0,a.le)(e.leftIndent)||(t.leftIndent=e.leftIndent),this.parseShading(e.shading,t.shading),(0,a.le)(e.tableAlignment)||(t.tableAlignment=e.tableAlignment),(0,a.le)(e.preferredWidth)||(t.preferredWidth=e.preferredWidth),(0,a.le)(e.preferredWidthType)||(t.preferredWidthType=e.preferredWidthType),(0,a.le)(e.bidi)||(t.bidi=e.bidi),(0,a.le)(e.horizontalPositionAbs)||(t.horizontalPositionAbs=e.horizontalPositionAbs),(0,a.le)(e.horizontalPosition)||(t.horizontalPosition=e.horizontalPosition),(0,a.le)(e.styleName)||(t.styleName=e.styleName)},s.prototype.parseCellFormat=function(e,t){(0,a.le)(e)||(this.parseBorders(e.borders,t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t),(0,a.le)(e.cellWidth)||(t.cellWidth=e.cellWidth),(0,a.le)(e.columnSpan)||(t.columnSpan=e.columnSpan),(0,a.le)(e.rowSpan)||(t.rowSpan=e.rowSpan),this.parseShading(e.shading,t.shading),(0,a.le)(e.verticalAlignment)||(t.verticalAlignment=e.verticalAlignment),(0,a.le)(e.preferredWidthType)||(t.preferredWidthType=e.preferredWidthType),(0,a.le)(e.preferredWidth)||(t.preferredWidth=e.preferredWidth))},s.prototype.parseCellMargin=function(e,t){(0,a.le)(e.leftMargin)||(t.leftMargin=e.leftMargin),(0,a.le)(e.rightMargin)||(t.rightMargin=e.rightMargin),(0,a.le)(e.topMargin)||(t.topMargin=e.topMargin),(0,a.le)(e.bottomMargin)||(t.bottomMargin=e.bottomMargin)},s.prototype.parseRowFormat=function(e,t){(0,a.le)(e)||((0,a.le)(e.allowBreakAcrossPages)||(t.allowBreakAcrossPages=e.allowBreakAcrossPages),(0,a.le)(e.isHeader)||(t.isHeader=e.isHeader),(0,a.le)(e.heightType)||(t.heightType=e.heightType),(0,a.le)(e.height)||(t.height=e.height),(0,a.le)(e.leftMargin)||(t.leftMargin=e.leftMargin),(0,a.le)(e.topMargin)||(t.topMargin=e.topMargin),(0,a.le)(e.rightMargin)||(t.rightMargin=e.rightMargin),(0,a.le)(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),(0,a.le)(e.leftIndent)||(t.leftIndent=e.leftIndent),!(0,a.le)(e.revisionIds)&&e.revisionIds.length>0&&this.checkAndApplyRevision(e,t),this.parseBorders(e.borders,t.borders))},s.prototype.parseBorders=function(e,t){(0,a.le)(e)||(t.isParsing=!0,this.parseBorder(e.left,t.left),this.parseBorder(e.right,t.right),this.parseBorder(e.top,t.top),this.parseBorder(e.bottom,t.bottom),this.parseBorder(e.vertical,t.vertical),this.parseBorder(e.horizontal,t.horizontal),this.parseBorder(e.diagonalDown,t.diagonalDown),this.parseBorder(e.diagonalUp,t.diagonalUp),t.isParsing=!1)},s.prototype.parseBorder=function(e,t){(0,a.le)(e)||((0,a.le)(e.color)||(t.color=this.getColor(e.color)),(0,a.le)(e.lineStyle)||(t.lineStyle=e.lineStyle),(0,a.le)(e.lineWidth)||(t.lineWidth=e.lineWidth),(0,a.le)(e.hasNoneStyle)||(t.hasNoneStyle=e.hasNoneStyle),(0,a.le)(e.space)||(t.space=e.space),(0,a.le)(e.shadow)||(t.shadow=e.shadow))},s.prototype.parseShading=function(e,t){(0,a.le)(e)||((0,a.le)(e.backgroundColor)||(t.backgroundColor=this.getColor(e.backgroundColor)),(0,a.le)(e.foregroundColor)||(t.foregroundColor=this.getColor(e.foregroundColor)),(!(0,a.le)(e.texture)||!(0,a.le)(e.textureStyle))&&(t.textureStyle=(0,a.le)(e.texture)?e.textureStyle:e.texture))},s.prototype.parseCharacterFormat=function(e,t,i){if(!(0,a.le)(e)){if(i&&e.hasOwnProperty("inlineFormat"))return void this.parseCharacterFormat(e.inlineFormat,t);if((0,a.le)(e.baselineAlignment)||(t.baselineAlignment=e.baselineAlignment),(0,a.le)(e.underline)||(t.underline=e.underline),(0,a.le)(e.strikethrough)||(t.strikethrough=e.strikethrough),!(0,a.le)(e.fontSize)){e.fontSize=parseFloat(e.fontSize);var n=10*e.fontSize;n%10!=0&&(n=10*e.fontSize.toFixed(1),e.fontSize=n%5==0?e.fontSize.toFixed(1):Math.round(e.fontSize));var r=parseFloat(e.fontSize);t.fontSize=r<0?0:r}(0,a.le)(e.fontFamily)||(-1!==e.fontFamily.indexOf('"')&&(e.fontFamily=e.fontFamily.replace('"',"")),t.fontFamily=e.fontFamily),(0,a.le)(e.bold)||(t.bold=e.bold),(0,a.le)(e.italic)||(t.italic=e.italic),(0,a.le)(e.highlightColor)||(t.highlightColor=e.highlightColor),(0,a.le)(e.fontColor)||(t.fontColor=this.getColor(e.fontColor)),(0,a.le)(e.bidi)||(t.bidi=e.bidi),(0,a.le)(e.bdo)||(t.bdo=e.bdo),(0,a.le)(e.fontSizeBidi)||(t.fontSizeBidi=e.fontSizeBidi<0?0:e.fontSizeBidi),(0,a.le)(e.fontFamilyBidi)||(t.fontFamilyBidi=e.fontFamilyBidi),(0,a.le)(e.boldBidi)||(t.boldBidi=e.boldBidi),(0,a.le)(e.italicBidi)||(t.italicBidi=e.italicBidi),!(0,a.le)(e.revisionIds)&&e.revisionIds.length>0&&this.checkAndApplyRevision(e,t),(0,a.le)(e.allCaps)||(t.allCaps=e.allCaps),(0,a.le)(e.localeIdBidi)||(t.localeIdBidi=e.localeIdBidi),(0,a.le)(e.complexScript)||(t.complexScript=e.complexScript)}},s.prototype.getColor=function(e){return e||"#ffffff"},s.prototype.parseParagraphFormat=function(e,t){(0,a.le)(e)||((0,a.le)(e.borders)||this.parseBorders(e.borders,t.borders),(0,a.le)(e.bidi)||(t.bidi=e.bidi),(0,a.le)(e.leftIndent)||(t.leftIndent=e.leftIndent),(0,a.le)(e.rightIndent)||(t.rightIndent=e.rightIndent),(0,a.le)(e.firstLineIndent)||(t.firstLineIndent=e.firstLineIndent),(0,a.le)(e.afterSpacing)||(t.afterSpacing=e.afterSpacing),(0,a.le)(e.beforeSpacing)||(t.beforeSpacing=e.beforeSpacing),(0,a.le)(e.spaceBeforeAuto)||(t.spaceBeforeAuto=e.spaceBeforeAuto),(0,a.le)(e.spaceAfterAuto)||(t.spaceAfterAuto=e.spaceAfterAuto),(0,a.le)(e.lineSpacing)||(t.lineSpacing=e.lineSpacing),(0,a.le)(e.lineSpacingType)?(0,a.le)(e.lineSpacing)||(t.lineSpacingType="Multiple"):t.lineSpacingType=e.lineSpacingType,(0,a.le)(e.textAlignment)||(t.textAlignment=e.textAlignment),(0,a.le)(e.outlineLevel)||(t.outlineLevel=e.outlineLevel),(0,a.le)(e.contextualSpacing)||(t.contextualSpacing=e.contextualSpacing),(0,a.le)(e.keepWithNext)||(t.keepWithNext=e.keepWithNext),(0,a.le)(e.keepLinesTogether)||(t.keepLinesTogether=e.keepLinesTogether),(0,a.le)(e.widowControl)||(t.widowControl=e.widowControl),t.listFormat=new bt(t),e.hasOwnProperty("listFormat")&&this.parseListFormat(e,t.listFormat),e.hasOwnProperty("tabs")&&this.parseTabStop(e.tabs,t.tabs))},s.prototype.parseListFormat=function(e,t){(0,a.le)(e.listFormat)||((0,a.le)(e.listFormat.listId)||(t.listId=e.listFormat.listId,t.list=this.documentHelper.getListById(e.listFormat.listId)),(0,a.le)(e.listFormat.listLevelNumber)||(t.listLevelNumber=e.listFormat.listLevelNumber))},s.prototype.parseSectionFormat=function(e,t){(0,a.le)(e.pageWidth)||(t.pageWidth=e.pageWidth),(0,a.le)(e.pageHeight)||(t.pageHeight=e.pageHeight),(0,a.le)(e.leftMargin)||(t.leftMargin=e.leftMargin),(0,a.le)(e.topMargin)||(t.topMargin=e.topMargin),(0,a.le)(e.rightMargin)||(t.rightMargin=e.rightMargin),(0,a.le)(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),(0,a.le)(e.headerDistance)||(t.headerDistance=e.headerDistance),(0,a.le)(e.footerDistance)||(t.footerDistance=e.footerDistance),(0,a.le)(e.differentFirstPage)||(t.differentFirstPage=e.differentFirstPage),(0,a.le)(e.differentOddAndEvenPages)||(t.differentOddAndEvenPages=e.differentOddAndEvenPages),(0,a.le)(e.bidi)||(t.bidi=e.bidi),(0,a.le)(e.restartPageNumbering)||(t.restartPageNumbering=e.restartPageNumbering),(0,a.le)(e.pageStartingNumber)||(t.pageStartingNumber=e.pageStartingNumber),(0,a.le)(e.endnoteNumberFormat)||(t.endnoteNumberFormat=e.endnoteNumberFormat),(0,a.le)(e.footNoteNumberFormat)||(t.footNoteNumberFormat=e.footNoteNumberFormat),(0,a.le)(e.restartIndexForFootnotes)||(t.restartIndexForFootnotes=e.restartIndexForFootnotes),(0,a.le)(e.pageStartingNumber)||(t.restartIndexForEndnotes=e.restartIndexForEndnotes),(0,a.le)(e.initialFootNoteNumber)||(t.initialFootNoteNumber=e.initialFootNoteNumber),(0,a.le)(e.initialEndNoteNumber)||(t.initialEndNoteNumber=e.initialEndNoteNumber),(0,a.le)(e.pageNumberStyle)||(t.pageNumberStyle=e.pageNumberStyle)},s.prototype.parseTabStop=function(e,t){if(e)for(var i=0;i<e.length;i++){var n=new Rn;n.position=e[i].position,n.tabLeader=e[i].tabLeader,n.deletePosition=e[i].deletePosition,n.tabJustification=e[i].tabJustification,t.push(n)}},s.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},s.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;i>=0;i--){if((t=e.children[i])instanceof H&&t.hasFieldEnd&&t.nextElement instanceof S)return t.nextElement;if(t instanceof H)return}return t},s.prototype.destroy=function(){this.footnotes&&this.footnotes.destroy(),this.footnotes=void 0,this.endnotes&&this.endnotes.destroy(),this.endnotes=void 0,this.editableRanges&&this.editableRanges.destroy(),this.editableRanges=void 0,this.commentEnds&&this.commentEnds.destroy(),this.commentEnds=void 0,this.commentStarts&&this.commentStarts.destroy(),this.commentStarts=void 0,this.commentsCollection&&this.commentsCollection.destroy(),this.commentsCollection=void 0,this.revisionCollection&&this.revisionCollection.destroy(),this.revisionCollection=void 0,this.documentHelper=void 0},s}(),Br=function(){function s(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1}return s.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(s.prototype,"bookmarks",{get:function(){return(0,a.le)(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new U),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new U),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new U),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new U),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new U),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new U),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new U),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new U),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),s.prototype.save=function(e,t){var i=this;this.fileName=t,this.serialize(e);var n=this.serializeExcelFiles();n&&n.length>0?Promise.all(n).then(function(){i.saveInternal(t)}):this.saveInternal(t),this.close()},s.prototype.saveInternal=function(e){this.mArchive.save(e+".docx").then(function(t){t.destroy()})},s.prototype.saveAsBlob=function(e){var t=this;this.serialize(e);var i=this.serializeExcelFiles();return new Promise(function(n,r){i.length>0?Promise.all(i).then(function(){t.mArchive.saveAsBlob().then(function(o){t.mArchive.destroy(),o=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),n(o)})}):t.mArchive.saveAsBlob().then(function(o){t.mArchive.destroy(),o=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),n(o)})})},s.prototype.serializeExcelFiles=function(){var e=this,t=this.excelFiles,i=[];if(t&&t.length>0){for(var n=function(o){var l=t.keys[o],d=t.get(l).saveAsBlob();i.push(d),d.then(function(c){var u=new Ie.eo(c,l);e.mArchive.addItem(u)})},r=0;r<t.length;r++)n(r);this.excelFiles.clear()}return i},s.prototype.saveExcel=function(){this.excelFiles.add(this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx",this.mArchiveExcel),this.mArchiveExcel=void 0},s.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},s.prototype.serialize=function(e){var i,t=e.owner.sfdtExportModule.write();this.setDocument(t),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.revisions=e.owner.revisions.changes,this.mArchive=new Ie.iA,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new U,this.mGridSpans=new U,this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(i),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(i),this.clearDocument()},s.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections,this.mLists=e.lists,this.mAbstractLists=e.abstractLists,this.defCharacterFormat=e.characterFormat,this.defParagraphFormat=e.paragraphFormat,this.defaultTabWidthValue=e.defaultTabWidth,this.dontUseHtmlParagraphAutoSpacing=e.dontUseHTMLParagraphAutoSpacing,this.mStyles=e.styles,this.formatting=e.formatting,this.enforcement=e.enforcement,this.hashValue=e.hashValue,this.saltValue=e.saltValue,this.protectionType=e.protectionType,this.formFieldShading=e.formFieldShading,this.trackChanges=e.trackChanges,this.compatibilityMode=e.compatibilityMode},s.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mSvgImages&&(this.mSvgImages.destroy(),this.mSvgImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages.destroy(),this.mHeaderFooterSvgImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},s.prototype.serializeDocument=function(){var e=new We.L_;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeDocumentBody(e),e.writeEndElement();var t=new Ie.eo(e.buffer,this.documentPath);this.mArchive.addItem(t)},s.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},s.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},s.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},s.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document.sections.length,i=0;i<t;i++)this.section=this.document.sections[i],this.lastSection=i===t-1,this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},s.prototype.serializeSection=function(e,t,i){this.blockOwner=t,this.serializeBodyItems(e,t.blocks,i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},s.prototype.serializeComments=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new We.L_;e.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement();var t=new Ie.eo(e.buffer,this.commentsPath);this.mArchive.addItem(t)}},s.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},s.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[n.commentId].toString()),n.author&&" "!==n.author&&e.writeAttributeString("w","author",this.wNamespace,n.author),n.date&&e.writeAttributeString("w","date",this.wNamespace,n.date),n.initial&&""!==n.initial&&e.writeAttributeString("w","initials",this.wNamespace,n.initial);for(var r=this.retrieveCommentText(n.text),o=0;o<r.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,r[o],!0),this.isInsideComment=!1;0===r.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[n.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),n.replyComments.length>0&&this.serializeCommentInternal(e,n.replyComments)}},s.prototype.retrieveCommentText=function(e){var t=[],i=e.split("\n"),n={};if(0===(i=i.filter(function(r){return""!==r})).length)n.inlines=[{text:""}],t.push(n);else for(;i.length>0;)n.inlines=[{text:i[0]}],t.push(n),i.splice(0,1);return t},s.prototype.serializeCommentsExtended=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new We.L_;e.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement();var t=new Ie.eo(e.buffer,this.commentsExtendedPath);this.mArchive.addItem(t)}},s.prototype.serializeCommentsExInternal=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];e.writeStartElement("w15","commentEx",this.wNamespace);var o=this.commentParaIDInfo[r.commentId];i&&e.writeAttributeString("w15","paraIdParent",this.wNamespace,this.commentParaIDInfo[r.ownerComment.commentId].toString()),e.writeAttributeString("w15","paraId",this.wNamespace,o.toString()),e.writeAttributeString("w15","done",this.wNamespace,(r.done?1:0).toString()),e.writeEndElement(),r.replyComments.length>0&&this.serializeCommentsExInternal(e,r.replyComments,!0)}},s.prototype.serializeSectionProperties=function(e,t){e.writeStartElement("w","sectPr",this.wNamespace),t.headersFooters&&this.serializeHFReference(e,t.headersFooters),this.serializeSectionType(e,"nextPage"),this.serializePageSetup(e,t.sectionFormat),this.serializeColumns(e),this.serializeFootNotesPr(e,t.sectionFormat),this.serializeEndNotesPr(e,t.sectionFormat),void 0!==t.sectionFormat&&t.sectionFormat.differentFirstPage&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!(0,a.le)(t.sectionFormat)&&t.sectionFormat.bidi&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},s.prototype.serializeFootNotesPr=function(e,t){(t.footNoteNumberFormat||t.restartIndexForFootnotes)&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t.footNoteNumberFormat&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.footNoteNumberFormat)),e.writeEndElement()),void 0!==t.restartIndexForFootnotes&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForFootnotes)),e.writeEndElement()),void 0!==t.initialFootNoteNumber&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.initialFootNoteNumber.toString()),e.writeEndElement()),e.writeEndElement())},s.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":t="upperRoman";break;case"LowerCaseRoman":t="lowerRoman";break;case"UpperCaseLetter":t="upperLetter";break;case"LowerCaseLetter":t="lowerLetter";break;default:t="decimal"}return t},s.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":return"eachSect";case"RestartForEachPage":return"eachPage";default:return"continuous"}},s.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},s.prototype.serializeEndNotesPr=function(e,t){(t.endnoteNumberFormat||t.restartIndexForEndnotes)&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t.endnoteNumberFormat&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.endnoteNumberFormat)),e.writeEndElement()),void 0!==t.restartIndexForEndnotes&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForEndnotes)),e.writeEndElement()),void 0!==t.initialEndNoteNumber&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.initialEndNoteNumber.toString()),e.writeEndElement()),e.writeEndElement())},s.prototype.serializeColumns=function(e){e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1"),e.writeAttributeString(void 0,"space",this.wNamespace,"0"),e.writeEndElement()},s.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),t.restartPageNumbering&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t.pageStartingNumber.toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},s.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.pageWidth*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t.pageHeight*this.twentiethOfPoint).toString()),e.writeEndElement()},s.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t.topMargin*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t.rightMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t.bottomMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t.leftMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t.headerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t.footerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},s.prototype.serializePageNumberType=function(e,t){void 0!==t.pageNumberStyle&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t.pageNumberStyle)),e.writeEndElement())},s.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},s.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=this.section.sectionFormat.differentOddAndEvenPages;var n=t.firstPageHeader;n&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageHeader",i),e.writeEndElement()),(n=t.firstPageFooter)&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageFooter",i),e.writeEndElement()),(n=t.evenHeader)&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenHeader",i),e.writeEndElement()),(n=t.evenFooter)&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenFooter",i),e.writeEndElement()),(n=t.header)&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddHeader",i),e.writeEndElement()),(n=t.footer)&&n.blocks&&n.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddFooter",i),e.writeEndElement())}},s.prototype.addHeaderFooter=function(e,t,i){var n=new U;this.headersFooters.add(t,n),this.headersFooters.get(t).add(i,e)},s.prototype.serializeBodyItems=function(e,t,i){for(var n=0;n<t.length;n++)this.serializeBodyItem(e,t[n],i)},s.prototype.serializeContentControl=function(e,t,i,n,r){if((0,a.le)(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),(0,a.le)(t)||this.serializeContentProperties(e,t,i,n,r)},s.prototype.serializeContentProperties=function(e,t,i,n,r){if((0,a.le)(t.title)||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.title),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.tag),e.writeEndElement()),(0,a.le)(t.characterFormat)||this.serializeCharacterFormat(e,i.contentControlProperties.characterFormat),(t.lockContents||t.lockContentControl)&&(e.writeStartElement(void 0,"lock",this.wNamespace),t.lockContentControl&&t.lockContents?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):t.lockContentControl?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):t.lockContents&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),t.hasPlaceHolderText&&(0,a.le)(void 0)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),t.isTemporary&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),(0,a.le)(t.appearance)||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,t.appearance.toLowerCase()),e.writeEndElement()),(0,a.le)(t.color)||(e.writeStartElement("w15","color",void 0),e.writeAttributeString("w","val",void 0,this.getColor(t.color)),e.writeEndElement()),t.multiline&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),(0,a.le)(t.xmlMapping)||t.xmlMapping.isMapped&&(e.writeStartElement("w","dataBinding",this.wNamespace),e.writeAttributeString("w","xpath",void 0,t.xmlMapping.xPath),e.writeAttributeString("w","storeItemID",void 0,t.xmlMapping.storeItemId),e.writeEndElement()),t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),(0,a.le)(t.uncheckedState||t.checkedState)||(e.writeStartElement("w14","checkbox",void 0),t.isChecked?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1"),e.writeEndElement()):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0"),e.writeEndElement()),e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t.uncheckedState.value)),e.writeAttributeString("w14","font",void 0,t.uncheckedState.font),e.writeEndElement(),e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t.checkedState.value)),e.writeAttributeString("w14","font",void 0,t.checkedState.font),e.writeEndElement(),e.writeEndElement()),!(0,a.le)(t.contentControlListItems)&&"DropDownList"===t.type){var l=t.contentControlListItems;e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,l),e.writeEndElement()}if(!(0,a.le)(t.contentControlListItems)&&"ComboBox"===t.type){var h=t.contentControlListItems;e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,h),e.writeEndElement()}if(this.serializeContentControlDate(e,t),(0,a.le)(t.type)||"Picture"===t.type&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!r){if(i.hasOwnProperty("blocks")&&(0,a.le)(i.cellFormat))for(var d=0;d<i.blocks.length;d++){var c=i.blocks[d];if(c.hasOwnProperty("inlines"))this.paragraph=c,this.serializeParagraph(e,c,n),this.paragraph=void 0;else if(c.hasOwnProperty("rowFormat")){var u=new U;this.serializeRow(e,c,u)}else c.hasOwnProperty("contentControlProperties")?this.serializeContentControl(e,c.contentControlProperties,c,n):this.serializeTable(e,c)}else i.hasOwnProperty("rowFormat")?i.cells.length>0&&(u=new U,this.serializeRow(e,i,u)):i.hasOwnProperty("cellFormat")&&(u=new U,this.serializeCell(e,i,u));e.writeEndElement(),e.writeEndElement()}},s.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},s.prototype.serializeContentControlList=function(e,t){for(var i=0;i<t.length;i++)e.writeStartElement(void 0,"listItem",this.wNamespace),(0,a.le)(t[i].displayText)||e.writeAttributeString("w","displayText",this.wNamespace,t[i].displayText),e.writeAttributeString("w","value",this.wNamespace,t[i].value),e.writeEndElement()},s.prototype.serializeContentParagraph=function(e,t){for(var i=0;i<t.blocks.length;i++){var n=t.blocks[i];if(n.hasOwnProperty("inlines"))for(var r=0;r<n.inlines.length;r++){var o=n.inlines[r];(0,a.le)(o.characterFormat)||this.serializeCharacterFormat(e,o.characterFormat)}}},s.prototype.serializeContentControlDate=function(e,t){"Date"===t.type&&(e.writeStartElement("w","date",this.wNamespace),(0,a.le)(t.dateDisplayFormat)||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateCalendarType),e.writeEndElement()),(0,a.le)(t.dateDisplayLocale)||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayLocale),e.writeEndElement()),(0,a.le)(t.dateStorageFormat)||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateStorageFormat),e.writeEndElement()),(0,a.le)(t.dateCalendarType)||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayFormat),e.writeEndElement()),e.writeEndElement())},s.prototype.serializeBodyItem=function(e,t,i){if((0,a.le)(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty("contentControlProperties"))this.serializeContentControl(e,t.contentControlProperties,t,i);else if(t.hasOwnProperty("inlines"))this.paragraph=t,this.serializeParagraph(e,t,i),this.paragraph=void 0;else for(var n=t,r=0;r<n.rows.length;r++)if(n.rows[r].cells.length>0){this.serializeTable(e,n);break}var o=this.blockOwner;!i&&o.hasOwnProperty("sectionFormat")&&o.blocks.indexOf(t)===o.blocks.length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,o),e.writeEndElement(),e.writeEndElement())},s.prototype.serializeParagraph=function(e,t,i){if((0,a.le)(t))throw new Error("Paragraph should not be undefined");e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),(0,a.le)(t.paragraphFormat)||this.serializeParagraphFormat(e,t.paragraphFormat,t),(0,a.le)(t.characterFormat)||this.serializeCharacterFormat(e,t.characterFormat),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t.inlines),e.writeEndElement()},s.prototype.serializeRevisionStart=function(e,t,i){if(t.hasOwnProperty("revisionIds")){if(!(0,a.le)(i)&&i.hasOwnProperty("fieldType")&&0===i.fieldType||t.hasOwnProperty("fieldType")&&1===t.fieldType||!(0,a.le)(i)&&i.hasOwnProperty("bookmarkType")&&0===i.bookmarkType&&!(i.name.indexOf("_Toc")>=0)&&(0,a.le)(t.revisionIds))return;for(var n=t.revisionIds,r=0;r<n.length;r++){var o=this.retrieveRevision(n[r]);"Insertion"===o.revisionType&&this.serializeTrackChanges(e,"ins",o.author,o.date),"Deletion"===o.revisionType&&this.serializeTrackChanges(e,"del",o.author,o.date)}}},s.prototype.serializeTrackChanges=function(e,t,i,n){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,n)},s.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},s.prototype.serializeParagraphItems=function(e,t){for(var i,n=void 0,r=!1,o=0;o<t.length;o++){var l=t[o];l.hasOwnProperty("contentControlProperties")&&(this.serializeContentControl(e,l.contentControlProperties,l,void 0,i=!0),this.serializeParagraphItems(e,l.inlines)),l.hasOwnProperty("inlines")&&this.serializeParagraphItems(e,l),this.serializeRevisionStart(e,l,n);var h=!1;if(l.characterFormat&&(h=!(0,a.le)(l.characterFormat.bdo)&&"None"!==l.characterFormat.bdo)&&!r&&(this.serializeBiDirectionalOverride(e,l.characterFormat),r=!0),r&&!h&&(e.writeEndElement(),r=!1),l.hasOwnProperty("fieldType"))this.serializeFieldCharacter(e,l);else if(l.hasOwnProperty("imageString"))this.serializePicture(e,l);else if(l.hasOwnProperty("shapeId")){var d=this.paragraph;this.serializeShape(e,l),this.paragraph=d}else l.hasOwnProperty("bookmarkType")?this.serializeBookMark(e,l):l.hasOwnProperty("editRangeId")?this.serializeEditRange(e,l):l.hasOwnProperty("chartType")?(this.chart=l,this.serializeChart(e,l),this.serializeChartStructure()):l.hasOwnProperty("commentCharacterType")?this.serializeComment(e,l):l.hasOwnProperty("footnoteType")?this.serializeEFReference(e,l):this.serializeTextRange(e,l,n);this.serializeRevisionEnd(e,l,n),n=l,i&&(e.writeEndElement(),e.writeEndElement(),i=!1)}r&&e.writeEndElement()},s.prototype.serializeEFReference=function(e,t){var i="",n=t.blocks;"Footnote"===t.footnoteType?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document.footnotes.continuationNotice&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"footnote",i),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"endnote",i),e.writeEndElement(),e.writeEndElement())},s.prototype.addFootnotesEndnotes=function(e,t,i){var n=new U;this.endnotesFootnotes.add(t,n),this.endnotesFootnotes.get(t).add(i,e)},s.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var r=this.endnotesFootnotes.get(t),o=void 0,l=0;l<r.keys.length;l++){var h=r.keys[l];o=r.get(h),"endnote"===t?this.serializeInlineEndnotes(e,o,h):this.serializeInlineFootnotes(e,o,h)}},s.prototype.serializeInlineEndnotes=function(e,t,i){this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0},s.prototype.serializeInlineFootnotes=function(e,t,i){this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0},s.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},s.prototype.serializeFootnotes=function(){if(!(0,a.le)(this.document.footnotes)){var e=new We.L_;e.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document.footnotes.separator,!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document.footnotes.continuationSeparator,!0),e.writeEndElement(),this.document.footnotes.continuationNotice&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document.footnotes.continuationNotice,!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement();var t=new Ie.eo(e.buffer,this.footnotesPath);this.mArchive.addItem(t)}},s.prototype.serializeEndnotes=function(){if(!(0,a.le)(this.document.endnotes)){var e=new We.L_;e.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document.endnotes.separator,!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document.endnotes.continuationSeparator,!0),e.writeEndElement(),this.document.endnotes.continuationNotice&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document.endnotes.continuationNotice,!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement();var t=new Ie.eo(e.buffer,this.endnotesPath);this.mArchive.addItem(t)}},s.prototype.serializeRevisionEnd=function(e,t,i){if(t.hasOwnProperty("revisionIds")){if(t.hasOwnProperty("fieldType")&&0===t.fieldType||!(0,a.le)(i)&&i.hasOwnProperty("fieldType")&&(2===i.fieldType||0===i.fieldType&&t.text.indexOf("TOC")>=0))return;for(var n=0;n<t.revisionIds.length;n++){var r=this.retrieveRevision(t.revisionIds[n]);("Insertion"===r.revisionType||"Deletion"===r.revisionType)&&e.writeEndElement()}}},s.prototype.serializeComment=function(e,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t.commentCharacterType?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t.commentCharacterType&&e.writeStartElement("w","commentRangeEnd",this.wNamespace);var i=this.commentId[t.commentId];(0,a.le)(i)&&(i=this.commentId[t.commentId]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement(),1===t.commentCharacterType&&this.serializeCommentItems(e,i)}},s.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.bdo.toLowerCase())},s.prototype.serializeEditRange=function(e,t){t.hasOwnProperty("editableRangeStart")?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t.user&&""!==t.user&&e.writeAttributeString("w","ed",this.wNamespace,t.user),t.group&&""!==t.group&&e.writeAttributeString("w","edGrp",this.wNamespace,t.group.toLowerCase()),t.columnFirst&&-1!==t.columnFirst&&e.writeAttributeString("w","colFirst",this.wNamespace,t.columnFirst.toString()),t.columnLast&&-1!==t.columnLast&&e.writeAttributeString("w","colLast",this.wNamespace,t.columnLast.toString())),e.writeAttributeString("w","id",this.wNamespace,t.editRangeId),e.writeEndElement()},s.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t.name),n=t.name;0===t.bookmarkType?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,n)):1===t.bookmarkType&&e.writeStartElement("w","bookmarkEnd",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},s.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},s.prototype.serializePicture=function(e,t){t.width>=0&&t.height>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement())},s.prototype.serializeShape=function(e,t){t.width>=0&&t.height>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement())},s.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty("chartType")?this.serializeInlineCharts(e,t):"Inline"===t.textWrappingStyle?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},s.prototype.serializeWrappingPictureAndShape=function(e,t){if(e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t.zOrderPosition?Math.abs(t.zOrderPosition).toString():"0"),e.writeAttributeString(void 0,"behindDoc",void 0,t.textWrappingStyle&&"Behind"===t.textWrappingStyle?"1":"0"),e.writeAttributeString(void 0,"locked",void 0,t.LockAnchor?"1":"0"),e.writeAttributeString(void 0,"layoutInCell",void 0,t.layoutInCell?"1":"0"),e.writeAttributeString(void 0,"allowOverlap",void 0,t.allowOverlap?"1":"0"),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace),e.writeAttributeString(void 0,"relativeFrom",void 0,w.formatText("firstlower",t.horizontalOrigin.toString())),"None"===t.horizontalAlignment){e.writeStartElement("wp","posOffset",this.wpNamespace);var l=Math.round(t.horizontalPosition*this.emusPerPoint);e.writeString(l.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var h=t.horizontalAlignment.toString().toLowerCase();e.writeString(h),e.writeEndElement()}if(e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace),e.writeAttributeString(void 0,"relativeFrom",void 0,w.formatText("firstlower",t.verticalOrigin.toString())),"None"===t.verticalAlignment){e.writeStartElement("wp","posOffset",this.wpNamespace);var d=Math.round(t.verticalPosition*this.emusPerPoint);e.writeString(d.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var c=t.verticalAlignment.toString().toLowerCase();e.writeString(c),e.writeEndElement()}e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace);var u=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,u.toString());var p=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,p.toString()),e.writeEndElement(),(0,a.le)(t.imageString)?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},s.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var n=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),(0,a.le)(t.imageString)?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},s.prototype.serializePictureAndShapeDistance=function(e,t){var i=t.distanceTop?Math.round(t.distanceTop*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distT",void 0,i);var n=t.distanceBottom?Math.round(t.distanceBottom*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distB",void 0,n);var r=t.distanceLeft?Math.round(t.distanceLeft*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distL",void 0,r);var o=t.distanceRight?Math.round(t.distanceRight*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distR",void 0,o)},s.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},s.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var n=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},s.prototype.serializeDrawingGraphicsChart=function(e,t){var i;i=this.updatechartId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},s.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement()},s.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},s.prototype.serializeChartXML=function(){var t=new We.L_;t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement();var i=new Ie.eo(t.buffer,this.chartPath+"/chart"+this.chartCount+".xml");this.mArchive.addItem(i)},s.prototype.serializeChartColors=function(){var e=new We.L_,t="";e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement();var i=new Ie.eo(e.buffer,t);this.mArchive.addItem(i),t=""},s.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeChartExcelData=function(){(0,a.le)(this.excelFiles)&&(this.excelFiles=new U),this.mArchiveExcel=new Ie.iA,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart.chartType,t="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(t),this.serializeExcelContentTypes(),this.serializeExcelData(t),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},s.prototype.serializeWorkBook=function(){var e=new We.L_;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var i=new Ie.eo(e.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(i)},s.prototype.serializeExcelStyles=function(){var e=new We.L_;e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement();var i=new Ie.eo(e.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(i)},s.prototype.serializeExcelData=function(e){var i=new We.L_;i.writeStartElement(void 0,"worksheet",void 0),i.writeAttributeString("xmlns","r",void 0,this.rNamespace),i.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),i.writeAttributeString("xmlns","mc",void 0,this.veNamespace),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(i,e),i.writeEndElement();var n=new Ie.eo(i.buffer,"xl/worksheets/sheet1.xml");this.mArchiveExcel.addItem(n)},s.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new We.L_,r=[],o=this.chart.chartType,l=t.chartSeries.length,h=0;h<l;h++){var d=t.chartSeries[h],u=d.seriesName.match(/[a-z]/i);e&&0===h&&r.push("X-Values"),u&&(r.push(d.seriesName),this.chartStringCount++)}"Bubble"===o&&r.push("Size");for(var p=0;p<t.chartCategory.length;p++){var f=t.chartCategory[p],g=t.chartPrimaryCategoryAxis.numberFormat;((u=f.categoryXName.match(/[a-z]/i))||"m/d/yyyy"===g)&&(r.push(f.categoryXName),this.chartStringCount++)}var v=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,v.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,v.toString());for(var y=0;y<=r.length;y++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),y!==r.length?i.writeString(r[y]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement();var b=new Ie.eo(i.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(b)},s.prototype.serializeExcelSheet=function(e,t){var o,i=this.chart,n="s",r="Bubble"===i.chartType,l=i.chartCategory.length+1,h=i.chartPrimaryCategoryAxis.numberFormat,d=i.chartSeries.length+1;r&&(o=d,d+=1);var c=void 0,u=void 0,p=0;e.writeStartElement(void 0,"sheetData",void 0);for(var f=0;f<l;f++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(f+1).toString());for(var g=0;g<d;g++){var m=String.fromCharCode("A".charCodeAt(0)+g)+(f+1).toString();if(e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,m),0!==f&&0===g){var y=(c=i.chartCategory[f-1]).categoryXName.match(/[a-z]/i);n=(0,a.le)(y)&&"m/d/yyyy"===h?"s":!y&&!(0,a.le)(y)||t?"n":"s"}else n=0===f&&0!==g&&g!==o?(y=(u=i.chartSeries[g-1]).seriesName.match(/[a-z]/i))?"s":"n":0===f&&r&&g===o||0===f&&0===g?"s":"n";e.writeAttributeString(void 0,"t",void 0,n),e.writeStartElement(void 0,"v",void 0),0!==f||0!==g||t?"s"===n?(e.writeString(p.toString()),p++):0!==f&&"s"!==n&&0===g&&g!==o?e.writeString(c.categoryXName):0!==g&&"s"!==n&&0===f&&g!==o?e.writeString(u.seriesName):0!==g&&g!==o?e.writeString(c.chartData[g-1].yValue.toString()):r&&g===o&&e.writeString(c.chartData[g-2].size.toString()):e.writeString(this.chartStringCount.toString()),e.writeEndElement(),e.writeEndElement(),n=""}e.writeEndElement()}e.writeEndElement()},s.prototype.serializeExcelContentTypes=function(){var e=new We.L_;e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();var t=new Ie.eo(e.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},s.prototype.serializeExcelRelation=function(){var e=new We.L_;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement();var n=new Ie.eo(e.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(n)},s.prototype.serializeExcelGeneralRelations=function(){var e=new We.L_;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement();var t=new Ie.eo(e.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},s.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},s.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},s.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),(0,a.le)(this.chart.chartTitle)||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart.chartTitleArea,this.chart.chartTitle),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();var i=this.chartType(t),n="pieChart"===i||"doughnutChart"===i,r="scatterChart"===i||"bubbleChart"===i;if(e.writeStartElement("c",i,this.chartNamespace),"barChart"===i){var o;o="Column_Clustered"===t.chartType||"Column_Stacked"===t.chartType||"Column_Stacked_100"===t.chartType?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o),e.writeEndElement()}if(!n&&!r){var l=this.chartGrouping(t.chartType);e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l),e.writeEndElement()}"scatterChart"===i&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement();for(var h="",d=0;d<t.chartSeries.length;d++){var c=t.chartSeries[d];this.seriesCount=d,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace);var u=String.fromCharCode("B".charCodeAt(0)+d);if(e.writeString((h="Sheet1!$"+u)+"$1"),h=h+"$2:$"+u+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(c.seriesName),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t.chartType||"Doughnut"===t.chartType?(this.parseChartDataPoint(e,c),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):r||this.parseChartSeriesColor(e,c.dataPoints,i),"scatterChart"===i){var p=c.dataPoints[0].fill.foreColor;e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,p,!1),e.writeEndElement()}c.dataLabel&&this.parseChartDataLabels(e,c.dataLabel),c.trendLines&&this.parseChartTrendLines(e,c),c.errorBar&&this.serializeChartErrorBar(e,c),"scatterChart"===i?this.serializeDefaultShapeProperties(e):"bubbleChart"===i&&this.serializeShapeProperties(e,c.dataPoints[d].fill.foreColor,!1);var f="cat",g="strRef",m="strCache";"scatterChart"===i&&(f="xVal",g="numRef",m="numCache"),e.writeStartElement("c",f,this.chartNamespace),e.writeStartElement("c",g,this.chartNamespace),this.serializeChartCategory(e,t,m),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,h,i),e.writeEndElement()}if(e.writeStartElement("c","dLbls",this.chartNamespace),n&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),n){var v=0,y=0;(c=this.chart.chartSeries[0]).hasOwnProperty("firstSliceAngle")&&(v=c.firstSliceAngle),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,v.toString()),e.writeEndElement(),"Doughnut"===t.chartType&&(y=c.holeSize,e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,y.toString()),e.writeEndElement())}"lineChart"===i||r?"bubbleChart"!==i&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart.gapWidth.toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart.overlap.toString()),e.writeEndElement()),"bubbleChart"===i&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var b=this.chart.chartType;n||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement();var C="Column_Stacked_100"===b||"Area_Stacked_100"===b||"Bar_Stacked_100"===b||"Line_Stacked_100"===b||"Line_Markers_Stacked_100"===b,F=this.chart.chartPrimaryCategoryAxis.categoryType;if(n||(this.serializeCategoryAxis(e,F,C),this.serializeValueAxis(e,F,C)),this.chart.hasOwnProperty("chartDataTable")){var T=this.chart.chartDataTable,x=0,P=0,E=0,L=0;T.showSeriesKeys&&(L=1),T.hasHorzBorder&&(x=1),T.hasVertBorder&&(P=1),T.hasBorders&&(E=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,x.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,P.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,E.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,L.toString()),e.writeEndElement(),e.writeEndElement()}this.serializeDefaultShapeProperties(e),e.writeEndElement(),(0,a.le)(this.chart.chartLegend.position)||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},s.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart.chartLegend),i=this.chart.chartLegend.chartTitleArea,n=i.dataFormat.fill.foreColor;e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i.fontSize,n,i.fontName),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeChartErrorBar=function(e,t){var i=t.errorBar,n=this.errorBarValueType(i.type),r=0;"Cap"!==i.endStyle&&(r=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.direction.toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.numberValue.toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},s.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":default:t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal"}return t},s.prototype.serializeCategoryAxis=function(e,t,i){var n="catAx",r=this.chart.chartPrimaryCategoryAxis.numberFormat,o=this.chart.chartType,l="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(n="dateAx"),l&&(n="valAx"),e.writeStartElement("c",n,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart.chartPrimaryCategoryAxis,r,i),l||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart.chartType&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},s.prototype.serializeValueAxis=function(e,t,i){var n=this.chart.chartPrimaryValueAxis,r="between";"Time"===t&&(r="midCat"),e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",n,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),0!==n.majorUnit&&!i&&(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.majorUnit.toString()),e.writeEndElement()),e.writeEndElement()},s.prototype.serializeAxis=function(e,t,i,n,r){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0!==i.maximumValue&&!r&&(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.maximumValue.toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.minimumValue.toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"===t?"l":"b"),e.writeEndElement(),i.hasMajorGridLines&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),i.hasMinorGridLines&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i.chartTitle&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i.chartTitleArea,i.chartTitle),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,n),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart.chartType?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i.fontSize,"595959",i.fontName),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},s.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t.trendLines.length;i++){var n=t.trendLines[i],r=this.chartTrendLineType(n.type),o=0,l=0;n.isDisplayEquation?l=1:n.isDisplayRSquared&&(o=1);var h=t.dataPoints[i];e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,h.fill.foreColor,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.forward.toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.backward.toString()),e.writeEndElement(),"NaN"!==n.intercept&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.intercept.toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeEndElement()}},s.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},s.prototype.parseChartDataLabels=function(e,t){var i="",r=0,o=0,l=0,h=0,d=0,c=0,u=0;switch(t.position){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t.fontSize,t.fontColor,t.fontName),e.writeEndElement(),e.writeEndElement(),t.isLegendKey?r=1:t.isBubbleSize?o=1:t.isCategoryName?l=1:t.isSeriesName?h=1:t.isValue?d=1:t.isPercentage?c=1:t.isLeaderLines&&(u=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,h.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,c.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u.toString()),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeShapeProperties=function(e,t,i){var n=this.chart.chartType,r="Scatter_Markers"===n||"Bubble"===n;e.writeStartElement("c","spPr",this.chartNamespace),!r||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===n?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===n&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeTextProperties=function(e,t,i){var n=t.dataFormat.fill.foreColor,r=100*t.fontSize;e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t.fontSize,n,t.fontName),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,r.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,n,!1),this.serializeFont(e,t.fontName),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t.fontSize,n,t.fontName),e.writeEndElement()},s.prototype.serializeChartTitleFont=function(e,t,i,n){var r=100*t;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,r.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,n),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"000000"!==t?t:"595959"),"Bubble"===this.chart.chartType&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},s.prototype.parseChartSeriesColor=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];if(e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),this.serializeChartSolidFill(e,"lineChart"!==i?r.fill.foreColor:r.line.color,!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i){var o="none",l=0;this.chart.chartSeries[n].hasOwnProperty("seriesFormat")&&(o=this.chart.chartSeries[n].seriesFormat.markerStyle,l=this.chart.chartSeries[n].seriesFormat.markerSize),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart.chartSeries[n].hasOwnProperty("seriesFormat")&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement()),e.writeEndElement()}}},s.prototype.parseChartDataPoint=function(e,t){for(var i=t.dataPoints,n=[],r=0;r<i.length;r++)n.push(i[r]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,n,this.chart.chartType),e.writeEndElement(),n=[]},s.prototype.serializeChartCategory=function(e,t,i){var n=t.chartCategory,r=n.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(r+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement();for(var o=0;o<n.length;o++){var l=n[o];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==l.categoryXName&&e.writeString(l.categoryXName),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},s.prototype.serializeChartValue=function(e,t,i){var r="val";("scatterChart"===i||"bubbleChart"===i)&&(r="yVal"),this.serializeChartYValue(e,r,t),"bubbleChart"===i&&this.serializeChartYValue(e,r="bubbleSize",t="Sheet1!$C$2:$C$"),("lineChart"===i||"scatterChart"===i)&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},s.prototype.serializeChartYValue=function(e,t,i){var r=this.chart.chartCategory,o=r.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(o+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement();for(var l=0;l<o;l++)for(var h=r[l],d=0;d<h.chartData.length;d++)if(d===this.seriesCount){var c=h.chartData[this.seriesCount];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,l.toString()),e.writeStartElement("c","v",this.chartNamespace),e.writeString("bubbleSize"!==t?c.yValue.toString():c.size.toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.chartType=function(e){var t=e.chartType;switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return("Area"===t||"Area_Stacked"===t||"Area_Stacked_100"===t)&&(t="areaChart"),("Bar_Stacked_100"===t||"Bar_Stacked"===t||"Bar_Clustered"===t||"Column_Clustered"===t||"Column_Stacked"===t||"Column_Stacked_100"===t)&&(t="barChart"),("Line"===t||"Line_Markers"===t||"Line_Markers_Stacked"===t||"Line_Stacked"===t||"Line_Markers_Stacked_100"===t||"Line_Stacked_100"===t)&&(t="lineChart"),t},s.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":("Bar_Clustered"===e||"Column_Clustered"===e)&&(t="clustered"),t},s.prototype.chartLegendPosition=function(e){var t=e.position;switch(t){case"Top":t="t";break;case"Bottom":default:t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr"}return t},s.prototype.updatechartId=function(e){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,e)),t},s.prototype.addChartRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},s.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},s.prototype.serializeShapeDrawingGraphics=function(e,t){var i=t.autoShapeType;this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t.name),e.writeAttributeString(void 0,"title",void 0,t.title),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var r=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,r.toString());var o=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,o.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"StraightConnector"===i?"straightConnector1":"RoundedRectangle"===i?"roundRect":"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t.fillFormat&&t.fillFormat.color&&t.fillFormat.fill?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t.fillFormat.color)),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement());var l=t.lineFormat.weight?t.lineFormat.weight*this.emusPerPoint:this.emusPerPoint;if(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,l.toString()),!(0,a.le)(t.lineFormat.lineFormatType)&&"None"!==t.lineFormat.lineFormatType||t.lineFormat.line?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t.lineFormat.color)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeEndElement(),e.writeEndElement(),("Rectangle"===i||"RoundedRectangle"===i)&&(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t.textFrame.blocks,!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),!(0,a.le)(t.textFrame)){var h=void 0;t.textFrame.leftMargin>=0&&(h=Math.round(t.textFrame.leftMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,h)),t.textFrame.topMargin>=0&&(h=Math.round(t.textFrame.topMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,h)),t.textFrame.rightMargin>=0&&(h=Math.round(t.textFrame.rightMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,h)),t.textFrame.bottomMargin>=0&&(h=Math.round(t.textFrame.bottomMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,h)),e.writeAttributeString(void 0,"anchor",void 0,"t"),e.writeAttributeString(void 0,"anchorCtr",void 0,"0")}e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeShapeWrapStyle=function(e,t){if("Inline"!==t.textWrappingStyle){var i="wrapNone";if(t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&(i="wrap"+t.textWrappingStyle,"Tight"===t.textWrappingStyle&&(i="wrapSquare")),e.writeStartElement("wp",i,this.wpNamespace),t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&t.textWrappingType){var n="Both"===t.textWrappingType?"bothSides":t.textWrappingType.toLowerCase();e.writeAttributeString(void 0,"wrapText",void 0,n)}e.writeEndElement()}},s.prototype.serializeDrawingGraphics=function(e,t){var i,n;if(t.isMetaFile&&!(0,a.le)(t.metaFileImageString)&&".svg"!==(n=w.formatClippedString(t.metaFileImageString).extension)&&(t.imageString=t.metaFileImageString),i=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),(0,a.le)(t.alternativeText)||e.writeAttributeString(void 0,"descr",void 0,t.alternativeText),e.writeAttributeString(void 0,"name",void 0,(0,a.le)(t.name)?"":t.name),(0,a.le)(t.title)||e.writeAttributeString(void 0,"title",void 0,t.title),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(t.imageString,"data:image")?e.writeAttributeString("r","embed",this.rNamespace,i):this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,t.imageString),e.writeAttributeString(void 0,"link",this.rNamespace,i)),".svg"===n&&this.serializeBlipExtensions(e,t),e.writeEndElement(),t.iscrop){e.writeStartElement("a","srcRect",this.aNamespace);var r=Math.round(1e3*t.left);e.writeAttributeString(void 0,"l",void 0,r.toString());var o=Math.round(1e3*t.top);e.writeAttributeString(void 0,"t",void 0,o.toString());var l=Math.round(1e3*t.right);e.writeAttributeString(void 0,"r",void 0,l.toString());var h=Math.round(1e3*t.bottom);e.writeAttributeString(void 0,"b",void 0,h.toString()),e.writeEndElement()}e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var d=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,d.toString());var c=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,c.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);var i=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},s.prototype.updateShapeId=function(e,t){var i="",n=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(n.hasOwnProperty("sectionFormat")||n.hasOwnProperty("inlines"))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e)),i},s.prototype.addImageRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},s.prototype.updateHFImageRels=function(e,t,i){for(var n="",r="",o=this.headersFooters.keys,l=0;l<o.length;l++)for(var h=this.headersFooters.get(o[l]),d=h.keys,c=0;c<d.length;c++)if(h.get(d[c])===e){r=d[c];var u=void 0;i?this.headerFooterSvgImages.containsKey(r)?(u=this.headerFooterSvgImages.get(r),n=this.addImageRelation(u,t)):(u=new U,n=this.addImageRelation(u,t),this.headerFooterSvgImages.add(r,u)):this.headerFooterImages.containsKey(r)?(u=this.headerFooterImages.get(r),n=this.addImageRelation(u,t)):(u=new U,n=this.addImageRelation(u,t),this.headerFooterImages.add(r,u))}return n},s.prototype.serializeTable=function(e,t){if(!(t.rows.length<=0)){var i=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace),this.serializeTableFormat(e,t.rows[0].rowFormat,t),this.serializeTableGrid(e,t);var r=new U,o=new U,l=new U,h=t.rows;if(h.length>0)for(var d=0;d<h.length;d++){var c=h[d];if(c.cells.length>0){if(c.hasOwnProperty("contentControlProperties")){this.serializeContentControl(e,c.contentControlProperties,c);continue}var u=this.row;this.row=c,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,c);for(var p=c.cells,f=p.length,g=0,m=0;m<f;m++){var v=p[m],y=v.columnIndex;if(v.hasOwnProperty("contentControlProperties"))this.serializeContentControl(e,v.contentControlProperties,v);else{var b=v.cellFormat;if(y-g>0)for(var F=0===m?0:g+1;F<y;F++)if(r.containsKey(F)){var T=this.getMergeCellFormat(b,l.get(F),F<v.columnIndex);this.serializeTableCell(e,v,T,!1),r.set(F,r.get(F)-1),1===r.get(F)&&(r.remove(F),l.remove(F),o.containsKey(F)&&o.remove(F)),o.containsKey(F)&&(g+=o.get(F)-1,(F+=o.get(F))>0&&F--)}g=y,b.rowSpan>1&&(r.add(y,b.rowSpan),l.add(y,b)),this.serializeTableCell(e,v,b,!0),b.columnSpan>1&&b.rowSpan>1&&o.add(y,b.columnSpan);for(var x=y+1;;x++)if(r.containsKey(x)){var P=this.getMergeCellFormat(b,l.get(x),x<v.columnIndex);this.serializeTableCell(e,v,P,!1),r.set(x,r.get(x)-1),g++,1===r.get(x)&&(r.remove(x),l.remove(x),o.containsKey(x)&&o.remove(x)),o.containsKey(x)&&(g+=o.get(x)-1,x+=o.get(x))}else if(!(m===f-1&&x<t.columnCount))break}}e.writeEndElement(),this.row=u}}e.writeEndElement(),this.table=i}},s.prototype.getMergeCellFormat=function(e,t,i){var n=t;return i?n.borders.right=e.borders.left:n.borders.left=e.borders.right,n},s.prototype.serializeTableCell=function(e,t,i,n){var r=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i.borders,8,!1),e.writeEndElement(),this.serializeShading(e,t.cellFormat.shading),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i.verticalAlignment),i.columnSpan>1){var o=i.columnSpan;e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()}if(i.rowSpan>1&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&t.blocks.length>0)for(var l=0;l<t.blocks.length;)this.serializeBodyItem(e,t.blocks[l],!1),l+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement(),this.blockOwner=r},s.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t.grid.length&&this.serializeGridColumns(e,t.grid),e.writeEndElement()},s.prototype.serializeTableRows=function(e,t){var i=new U;if(t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(r.cells.length>0){if(r.hasOwnProperty("contentControlProperties")){this.serializeContentControl(e,r.contentControlProperties,r);continue}this.serializeRow(e,r,i)}}},s.prototype.serializeRow=function(e,t,i){var n=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t.cells,i),e.writeEndElement(),this.row=n},s.prototype.serializeRowFormat=function(e,t){if(this.serializeRowMargins(e,t.rowFormat),e.writeStartElement(void 0,"trPr",this.wNamespace),t.rowFormat.height>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),"Exactly"===t.rowFormat.heightType?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):"AtLeast"===t.rowFormat.heightType&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var i=this.roundToTwoDecimal(t.rowFormat.height*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}var n=t.rowFormat,r=n.gridBefore;r>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.toString()),e.writeEndElement());var o=n.gridAfter;if(o>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()),r>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),n.gridBeforeWidthType){case"Percent":var l=this.roundToTwoDecimal(n.gridBeforeWidth*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,l),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":var h=this.roundToTwoDecimal(n.gridBeforeWidth*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,h),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(o>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),n.gridAfterWidthType){case"Percent":l=this.roundToTwoDecimal(n.gridAfterWidth*this.percentageFactor).toString(),e.writeAttributeString("w","val",this.wNamespace,l),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":h=this.roundToTwoDecimal(n.gridAfterWidth*this.twipsInOnePoint).toString(),e.writeAttributeString("w","val",this.wNamespace,h),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}n.allowBreakAcrossPages||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),n.isHeader&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!(0,a.le)(n.revisionIds)&&n.revisionIds.length>0&&(this.serializeRevisionStart(e,n,void 0),this.serializeRevisionEnd(e,n,void 0)),e.writeEndElement()},s.prototype.serializeCells=function(e,t,i){for(var n=0;n<t.length;n++)t[n].hasOwnProperty("contentControlProperties")?this.serializeContentControl(e,t[n].contentControlProperties,t[n]):this.serializeCell(e,t[n],i)},s.prototype.serializeCell=function(e,t,i){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t.cellFormat,!0,!0,i),t.blocks.length>0)for(var r=0;r<t.blocks.length;)this.serializeBodyItem(e,t.blocks[r],!1),r+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement();var l=1;if(i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+l)&&1===this.row.cells.length)for(var h=i.keys[i.keys.length-1];l<=h;)l=this.createCellForMerge(e,t,i,l),l++;else this.createCellForMerge(e,t,i,l);this.blockOwner=n},s.prototype.createCellForMerge=function(e,t,i,n){for(;i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+n)&&(this.row.cells.indexOf(t)===this.row.cells.length-1||this.row.cells.indexOf(t)===t.columnIndex)&&void 0===t.nextNode;){var r=t.columnIndex+t.cellFormat.columnSpan-1+n;e.writeStartElement(void 0,"tc",this.wNamespace);var o=!0;(0,a.le)(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),o=!1):i=this.serializeCellFormat(e,this.spanCellFormat,!1,o=!1,i),this.serializeColumnSpan(r,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),(0,a.le)(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t.cellFormat.borders,8,!1),e.writeEndElement()),o||e.writeEndElement(),i=this.checkMergeCell(r,i),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),n++}return n},s.prototype.serializeCellFormat=function(e,t,i,n,r){var o=this.blockOwner;return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(r=this.serializeCellMerge(e,t,r),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t.borders,8,!1),e.writeEndElement(),this.serializeShading(e,o.cellFormat.shading),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t.verticalAlignment),n&&e.writeEndElement(),r},s.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),"Percent"===t.preferredWidthType?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.percentageFactor).toString())):"Auto"===t.preferredWidthType?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},s.prototype.serializeCellMerge=function(e,t,i){var o,n=this.blockOwner,r=!1,l=n.columnIndex,h=this.row.cells.indexOf(n),d=h>0?this.row.cells[h-1].columnIndex:n.columnIndex;if(n.columnIndex===h?(o=n.columnIndex,r=!0):r=!1,!r){0===h&&(l=n.columnIndex,d=-1);for(var c=d;c<l;c++)o=d+1,d+=1,0===o&&i.containsKey(o)&&(i=this.createMerge(e,o,n,i))}return t.rowSpan>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(o,t.rowSpan-1),t.columnSpan>1&&this.mGridSpans.add(o,t.columnSpan),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(o)&&r&&(i=this.createMerge(e,o,n,i)),i},s.prototype.createMerge=function(e,t,i,n){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i.cellFormat.borders,8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i.cellFormat),this.checkMergeCell(t,n)},s.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},s.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},s.prototype.serializeGridSpan=function(e,t){if(t.cellFormat.columnSpan>1){var i=t.cellFormat.columnSpan;e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},s.prototype.serializeTableCellDirection=function(e,t){},s.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},s.prototype.serializeGridColumns=function(e,t){for(var i=0,n=t.length;i<n;i++){var r=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeEndElement()}},s.prototype.serializeTableFormat=function(e,t,i){e.writeStartElement(void 0,"tblPr",this.wNamespace),this.serializeTablePositioning(e,i),this.serializeTableWidth(e,i),this.serializeTableAlignment(e,i.tableFormat),this.serializeCellSpacing(e,i.tableFormat),this.serializeTableIndentation(e,i.tableFormat),this.serializeTableMargins(e,i.tableFormat),this.serializeTableBorders(e,i.tableFormat),this.serializeShading(e,i.tableFormat.shading),i.tableFormat.bidi&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,i.tableFormat),(0,a.le)(i)||e.writeEndElement()},s.prototype.serializeTablePositioning=function(e,t){if(t.wrapTextAround){if(e.writeStartElement("w","tblpPr",this.wNamespace),t.positioning.distanceLeft>0){var i=Math.round(t.positioning.distanceLeft*this.twipsInOnePoint).toString();e.writeAttributeString("w","leftFromText",this.wNamespace,i)}if(t.positioning.distanceRight>0){var n=Math.round(t.positioning.distanceRight*this.twipsInOnePoint).toString();e.writeAttributeString("w","rightFromText",this.wNamespace,n)}if(t.positioning.distanceTop>0){var r=Math.round(t.positioning.distanceTop*this.twipsInOnePoint).toString();e.writeAttributeString("w","topFromText",this.wNamespace,r)}if(t.positioning.distanceBottom>0){var o=Math.round(t.positioning.distanceBottom*this.twipsInOnePoint).toString();e.writeAttributeString("w","bottomFromText",this.wNamespace,o)}if(t.positioning.verticalOrigin){var l="Paragraph"===t.positioning.verticalOrigin?"text":t.positioning.verticalOrigin.toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,l)}if(t.positioning.horizontalOrigin&&"Column"!==t.positioning.horizontalOrigin&&e.writeAttributeString("w","horzAnchor",this.wNamespace,t.positioning.horizontalOrigin.toLowerCase()),t.positioning.horizontalAlignment&&"Left"!==t.positioning.horizontalAlignment){var h=t.positioning.horizontalAlignment.toLowerCase();e.writeAttributeString("w","tblpXSpec",this.wNamespace,h)}if(t.positioning.verticalAlignment&&"None"!==t.positioning.verticalAlignment){var d=t.positioning.verticalAlignment.toLowerCase();e.writeAttributeString("w","tblpYSpec",this.wNamespace,d)}if((!(0,a.le)(t.positioning.horizontalAlignment)&&"Left"===t.positioning.horizontalAlignment||!t.positioning.horizontalAlignment)&&t.positioning.horizontalPosition>0){var c=Math.round(t.positioning.horizontalPosition*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpX",this.wNamespace,c)}if(!(0,a.le)(t.positioning.verticalAlignment)&&"None"===t.positioning.verticalAlignment){var u=Math.round(t.positioning.verticalPosition*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpY",this.wNamespace,u)}e.writeEndElement(),t.positioning.allowOverlap||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())}},s.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},s.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},s.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},s.prototype.serializeMargins=function(e,t,i){if(e.writeStartElement(void 0,i,this.wNamespace),!(0,a.le)(t.topMargin)){var n=Math.round(20*t.topMargin);e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.le)(t.leftMargin)){var r=Math.round(20*t.leftMargin);e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.le)(t.bottomMargin)){var o=Math.round(20*t.bottomMargin);e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,o.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.le)(t.rightMargin)){var l=Math.round(20*t.rightMargin);e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,l.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}e.writeEndElement()},s.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),e.writeAttributeString(void 0,"fill",this.wNamespace,t.backgroundColor&&"empty"!==t.backgroundColor?this.getColor(t.backgroundColor):"auto"),"empty"===t.foregroundColor||(0,a.le)(t.foregroundColor)?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.foregroundColor)),(0,a.le)(t.textureStyle)||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t.textureStyle)),e.writeEndElement()},s.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":return"pct5";case"Texture10Percent":return"pct10";case"Texture12Pt5Percent":return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":return"pct30";case"Texture35Percent":return"pct35";case"Texture37Pt5Percent":return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":return"pct55";case"Texture60Percent":return"pct60";case"Texture62Pt5Percent":return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":return"pct80";case"Texture85Percent":return"pct85";case"Texture87Pt5Percent":return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":return"pct95";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":return"horzStripe";case"TextureDarkVertical":return"vertStripe";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":return"thinVertStripe";default:return"clear"}},s.prototype.serializeParagraphBorders=function(e,t){e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t.borders,8,!0),e.writeEndElement()},s.prototype.serializeTableBorders=function(e,t){e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t.borders,8,!1),e.writeEndElement()},s.prototype.serializeBorders=function(e,t,i,n){this.serializeBorder(e,t.top,"top",i),this.serializeBorder(e,t.left,"left",i),this.serializeBorder(e,t.bottom,"bottom",i),this.serializeBorder(e,t.right,"right",i),n?(this.serializeBorder(e,t.horizontal,"between",i),this.serializeBorder(e,t.vertical,"bar",i)):(this.serializeBorder(e,t.horizontal,"insideH",i),this.serializeBorder(e,t.vertical,"insideV",i),this.serializeBorder(e,t.diagonalDown,"tl2br",i),this.serializeBorder(e,t.diagonalUp,"tr2bl",i))},s.prototype.serializeTblLayout=function(e,t){t.allowAutoFit||(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},s.prototype.serializeBorder=function(e,t,i,n){var r=t.lineStyle,o=(t.lineWidth?t.lineWidth:0)*n,l=t.space?t.space:0;if("Cleared"===r)return e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();("None"===r||(0,a.le)(r))&&!t.hasNoneStyle||o<=0||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(r)),t.color&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.color)),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(o).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,l.toString()),t.shadow&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},s.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":return"dotted";case"DashDot":return"dotDash";case"DashLargeGap":return"dashed";case"DashDotDot":return"dotDotDash";case"Double":return"double";case"ThinThickSmallGap":return"thinThickSmallGap";case"ThickThinSmallGap":return"thickThinSmallGap";case"ThinThickThinSmallGap":return"thinThickThinSmallGap";case"ThickThinMediumGap":return"thickThinMediumGap";case"ThinThickMediumGap":return"thinThickMediumGap";case"ThinThickThinMediumGap":return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":return"thinThickLargeGap";case"ThinThickThinLargeGap":return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":return"wave";case"DoubleWavy":return"doubleWave";case"DashDotStroked":return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":return"threeDEmboss";case"Outset":return"outset";case"Inset":return"inset";default:return"single"}},s.prototype.serializeTableIndentation=function(e,t){if(!(0,a.le)(t.leftIndent)){e.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t.leftIndent*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}},s.prototype.serializeCellSpacing=function(e,t){!(0,a.le)(t.cellSpacing)&&t.cellSpacing>0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.cellSpacing/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},s.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),"Percent"===t.tableFormat.preferredWidthType)e.writeAttributeString(void 0,"w",this.wNamespace,(t.tableFormat.preferredWidth*this.percentageFactor).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct");else if("Point"===t.tableFormat.preferredWidthType){var i=Math.round(t.tableFormat.preferredWidth*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},s.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t.tableAlignment){case"Right":e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},s.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t.fieldType?"begin":1===t.fieldType?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),"begin"===i&&!(0,a.le)(t.formFieldData)){var n=t.formFieldData;if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.name),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),n.hasOwnProperty("textInput"))e.writeStartElement(void 0,"textInput",this.wNamespace),e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==n.textInput.type?"calculated":n.textInput.type.toString().toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.textInput.defaultValue),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.textInput.format),e.writeEndElement(),e.writeEndElement();else if(n.hasOwnProperty("checkBox"))e.writeStartElement(void 0,"checkBox",this.wNamespace),"Auto"===n.checkBox.sizeType?(e.writeStartElement(void 0,"sizeAuto",this.wNamespace),e.writeEndElement()):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*n.checkBox.size).toString()),e.writeEndElement()),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.checkBox.defaultValue?"1":"0"),e.writeEndElement(),n.checkBox.checked&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.checkBox.checked?"1":"0"),e.writeEndElement()),e.writeEndElement();else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==n.dropDownList.selectedIndex&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.dropDownList.selectedIndex.toString()),e.writeEndElement());for(var o=0;o<n.dropDownList.dropDownItems.length;o++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.dropDownList.dropDownItems[o].toString()),e.writeEndElement();e.writeEndElement()}e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t.fieldType&&"FieldFormTextInput"===t.fieldCodeType&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},s.prototype.serializeTextRange=function(e,t,i,n){if(e.writeStartElement("w","r",this.wNamespace),(0,a.le)(t.characterFormat)||this.serializeCharacterFormat(e,t.characterFormat),"\t"===t.text)e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t.text)e.writeElementString(void 0,"br",this.wNamespace,void 0);else if("\f"===t.text)e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else if("%02"===encodeURI(t.text))e.writeStartElement(void 0,"footnoteRef",this.wNamespace),e.writeEndElement();else if("%02"===encodeURI(t.text)&&"endnote"===n)e.writeStartElement(void 0,"endnoteRef",this.wNamespace),e.writeEndElement();else if("%03"===encodeURI(t.text))e.writeStartElement(void 0,"separator",this.wNamespace),e.writeEndElement();else if("%04"===encodeURI(t.text))e.writeStartElement(void 0,"continuationSeparator",this.wNamespace),e.writeEndElement();else{var r=this.retrieveDeleteRevision(t),o=!(0,a.le)(i)&&i.hasOwnProperty("fieldType")&&2!==i.fieldType;e.writeStartElement(void 0,o?r?"delInstrText":"instrText":r?"delText":"t",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t.text),e.writeEndElement()}e.writeEndElement()},s.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty("revisionIds")&&e.revisionIds.length>0)for(var t=0;t<e.revisionIds.length;t++)if("Deletion"===this.retrieveRevision(e.revisionIds[t]).revisionType)return!0;return!1},s.prototype.serializeParagraphFormat=function(e,t,i){(0,a.le)(t)||(this.serializeParagraphBorders(e,t),(0,a.le)(t.styleName)||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.styleName),e.writeEndElement()),(0,a.le)(i)?this.serializeListFormat(e,t.listFormat):this.serializeListFormat(e,i.paragraphFormat.listFormat),t.bidi&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),(0,a.le)(t.keepWithNext)||(e.writeStartElement(void 0,"keepNext",this.wNamespace),t.keepWithNext||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.le)(t.keepLinesTogether)||(e.writeStartElement(void 0,"keepLines",this.wNamespace),t.keepLinesTogether||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.le)(t.outlineLevel)||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t.outlineLevel).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),(0,a.le)(t.contextualSpacing)||(e.writeStartElement("w","contextualSpacing",this.wNamespace),t.contextualSpacing||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.le)(t.widowControl)||(e.writeStartElement("w","widowControl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.widowControl?"1":"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t.textAlignment,t.bidi),!(0,a.le)(t.tabs)&&t.tabs.length>0&&this.serializeTabs(e,t.tabs))},s.prototype.getOutlineLevelValue=function(e){if(-1!==e.indexOf("Level")){var t=parseInt(e.substring(5),10);if(t>0)return t-1}return 9},s.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},s.prototype.serializeTab=function(e,t){var i=0;e.writeStartElement("w","tab",this.wNamespace),0===t.position&&0!==t.deletePosition?(i=t.deletePosition*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t.position*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t.tabJustification))),!(0,a.le)(t.tabLeader)&&"None"!==t.tabLeader&&e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t.tabLeader)),isNaN(i)||e.writeAttributeString("w","pos",this.wNamespace,i.toString()+""),e.writeEndElement()},s.prototype.getTabLeader=function(e){switch(e){case"Dot":return"dot";case"Hyphen":return"hyphen";case"Underscore":return"underscore";default:return"none"}},s.prototype.getTabJustification=function(e){switch(e){case"Bar":return"bar";case"Center":return"center";case"Decimal":return"decimal";case"Left":return"left";case"List":return"num";case"Right":return"right";default:return"clear"}},s.prototype.serializeListFormat=function(e,t){if(!(0,a.le)(t.listId)||!(0,a.le)(t.listLevelNumber)){if(e.writeStartElement(void 0,"numPr",this.wNamespace),!(0,a.le)(t.listLevelNumber)&&-1!==t.listLevelNumber&&(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.listLevelNumber.toString()),e.writeEndElement()),!(0,a.le)(t.listId)){e.writeStartElement(void 0,"numId",this.wNamespace);var i=(t.listId+1).toString();-1===t.listId&&(i=""),e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}e.writeEndElement()}},s.prototype.serializeParagraphAlignment=function(e,t,i){if(!(0,a.le)(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var n=void 0;switch(t){case"Center":n="center";break;case"Right":n="right";break;case"Justify":n="both";break;default:n="left"}e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement()}},s.prototype.serializeParagraphSpacing=function(e,t){if(e.writeStartElement(void 0,"spacing",this.wNamespace),(0,a.le)(t.beforeSpacing)||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t.beforeSpacing*this.twentiethOfPoint).toString()),(0,a.le)(t.spaceBeforeAuto)||e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,t.spaceBeforeAuto?"1":"0"),(0,a.le)(t.afterSpacing)||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t.afterSpacing*this.twentiethOfPoint).toString()),(0,a.le)(t.spaceAfterAuto)||e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,t.spaceAfterAuto?"1":"0"),!(0,a.le)(t.lineSpacing)){var n=this.roundToTwoDecimal("AtLeast"===t.lineSpacingType||"Exactly"===t.lineSpacingType?t.lineSpacing*this.twentiethOfPoint:240*t.lineSpacing);e.writeAttributeString(void 0,"line",this.wNamespace,n.toString())}if(!(0,a.le)(t.lineSpacingType)){var r="auto";"AtLeast"===t.lineSpacingType?r="atLeast":"Exactly"===t.lineSpacingType&&(r="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,r)}e.writeEndElement()},s.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),(0,a.le)(t.leftIndent)||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t.leftIndent*this.twipsInOnePoint).toString()),(0,a.le)(t.rightIndent)||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t.rightIndent*this.twipsInOnePoint).toString()),(0,a.le)(t.firstLineIndent)||(t.firstLineIndent<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t.firstLineIndent*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t.firstLineIndent*this.twipsInOnePoint).toString())),e.writeEndElement()},s.prototype.serializeCustomXMLMapping=function(e,t){if(e.length>0)for(var i=e.keys,n=0;n<i.length;n++){var r=new We.L_;r.writeStartElement(void 0,"Relationships",this.rpNamespace);var o=this.mCustomXML.get(i[n]),l=i[n],h=this.getNextRelationShipID(),d=n+1,c=this.createXMLItem(o,h,d),u=this.createXMLItemProps(l,d);this.serializeRelationShip(t,h,this.customXmlRelType,"../"+c),this.customXMLRelation(r,d,u),r.writeEndElement();var p=new Ie.eo(r.buffer,this.customXMLRelPath+d+".xml.rels");this.mArchive.addItem(p)}},s.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},s.prototype.createXMLItem=function(e,t,i){var n=new Blob([e],{type:"text/plain"}),r=this.customXMLItemsPath+i+".xml",o=new Ie.eo(n,r);return this.mArchive.addItem(o),r},s.prototype.createXMLItemProps=function(e,t){var i=new We.L_,n=this.customXMLItemsPropspath+t+".xml",r=this.itemPropsPath+t+".xml";i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(n);var o=new Ie.eo(i.buffer,n);return this.mArchive.addItem(o),r},s.prototype.serializeStyles=function(){var e=new We.L_;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new Ie.eo(e.buffer,this.stylePath);this.mArchive.addItem(t)},s.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),(0,a.le)(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},s.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var i=this.mStyles[t];e.writeStartElement(void 0,"style",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"Paragraph"===i.type?"paragraph":"character"),e.writeAttributeString("w","styleId",this.wNamespace,i.name),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.name),e.writeEndElement(),(0,a.le)(i.basedOn)||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.basedOn),e.writeEndElement()),(0,a.le)(i.next)||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.next),e.writeEndElement()),(0,a.le)(i.link)||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.link),e.writeEndElement()),"Paragraph"===i.type&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i.paragraphFormat,void 0),e.writeEndElement()),this.serializeCharacterFormat(e,i.characterFormat),e.writeEndElement()}},s.prototype.serializeCharacterFormat=function(e,t){if(e.writeStartElement(void 0,"rPr",this.wNamespace),(0,a.le)(t.styleName)||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.styleName),e.writeEndElement()),(0,a.le)(t.fontFamily)||(e.writeStartElement(void 0,"rFonts",this.wNamespace),e.writeAttributeString(void 0,"ascii",this.wNamespace,t.fontFamily),e.writeAttributeString(void 0,"hAnsi",this.wNamespace,t.fontFamily),e.writeAttributeString(void 0,"eastAsia",this.wNamespace,t.fontFamily),e.writeAttributeString(void 0,"cs",this.wNamespace,t.fontFamilyBidi),e.writeEndElement()),(0,a.le)(t.bold)||this.serializeBoolProperty(e,"b",t.bold),t.boldBidi&&this.serializeBoolProperty(e,"bCs",t.boldBidi),(0,a.le)(t.italic)||this.serializeBoolProperty(e,"i",t.italic),(0,a.le)(t.italicBidi)||this.serializeBoolProperty(e,"iCs",t.italicBidi),t.bidi&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),t.allCaps&&this.serializeBoolProperty(e,"caps",t.allCaps),t.complexScript&&this.serializeBoolProperty(e,"cs",t.complexScript),!(0,a.le)(t.strikethrough))switch(t.strikethrough){case"SingleStrike":this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if((0,a.le)(t.fontColor)||(e.writeStartElement(void 0,"color",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"empty"===t.fontColor||"#00000000"===t.fontColor?"auto":this.getColor(t.fontColor)),e.writeEndElement()),(0,a.le)(t.fontSize)||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSize).toString()),e.writeEndElement()),(0,a.le)(t.fontSizeBidi)||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSizeBidi).toString()),e.writeEndElement()),!(0,a.le)(t.highlightColor)&&"NoColor"!==t.highlightColor&&(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t.highlightColor)),e.writeEndElement()),!(0,a.le)(t.revisionIds)&&t.revisionIds.length>0&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),(0,a.le)(t.underline)||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t.underline)),e.writeEndElement()),!(0,a.le)(t.baselineAlignment)){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t.baselineAlignment){case"Subscript":e.writeAttributeString("w","val",this.wNamespace,"subscript");break;case"Superscript":e.writeAttributeString("w","val",this.wNamespace,"superscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},s.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},s.prototype.getUnderlineStyle=function(e){switch(e){case"DotDotDashHeavy":return"dashDotDotHeavy";case"DotDashHeavy":return"dashDotHeavy";case"DashHeavy":return"dashedHeavy";case"DashLong":return"dashLong";case"DashLongHeavy":return"dashLongHeavy";case"DotDash":return"dotDash";case"DotDotDash":return"dotDotDash";case"Dotted":return"dotted";case"DottedHeavy":return"dottedHeavy";case"Double":return"double";case"Single":return"single";case"Thick":return"thick";case"Wavy":return"wave";case"WavyDouble":return"wavyDouble";case"WavyHeavy":return"wavyHeavy";case"Words":return"words";case"None":return"none";default:return"dash"}},s.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":return"green";case"Turquoise":return"cyan";case"Pink":return"magenta";case"Blue":return"blue";case"Red":return"red";case"DarkBlue":return"darkBlue";case"Teal":return"darkCyan";case"Green":return"darkGreen";case"Violet":return"darkMagenta";case"DarkRed":return"darkRed";case"DarkYellow":return"darkYellow";case"Gray50":return"darkGray";case"Gray25":return"lightGray";case"Black":return"black";default:return"yellow"}},s.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},s.prototype.serializeNumberings=function(){if(0!==this.document.lists.length){var e=new We.L_;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document.abstractLists),this.serializeListInstances(e,this.document.lists),e.writeEndElement();var t=new Ie.eo(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},s.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,n.abstractListId.toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),e.writeEndElement();for(var r=0,o=n.levels.length;r<o;r++)this.serializeListLevel(e,n.levels[r],r);e.writeEndElement()}},s.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(n.listId+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n.abstractListId.toString()),e.writeEndElement();for(var r=0,o=n.levelOverrides.length;r<o;r++)this.serializeLevelOverrides(e,n.levelOverrides[r],r);e.writeEndElement()}},s.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},s.prototype.roundToTwoDecimal=function(e){return Math.round(e)},s.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t.listLevelPattern)),e.writeEndElement(),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t.paragraphFormat,void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t.characterFormat),e.writeEndElement()},s.prototype.serializeLevelOverrides=function(e,t,i){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),(0,a.le)(t.startAt)||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString()),e.writeEndElement()),e.writeEndElement()},s.prototype.getLevelPattern=function(e){var t;switch(e){case"Arabic":t="decimal";break;case"UpRoman":t="upperRoman";break;case"LowRoman":t="lowerRoman";break;case"UpLetter":t="upperLetter";break;case"LowLetter":t="lowerLetter";break;default:t="bullet"}return t},s.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.numberFormat),e.writeEndElement()},s.prototype.serializeLevelFollow=function(e,t){var i;i="Tab"===t.followCharacter?"tab":"Space"===t.followCharacter?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},s.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&"NoProtection"!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":t="readOnly";break;case"FormFieldsOnly":t="forms";break;case"CommentsOnly":t="comments";break;case"RevisionsOnly":t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},s.prototype.serializeSettings=function(){var e=new We.L_;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");var i=w.getCompatibilityModeValue(this.compatibilityMode);e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement(),e.writeEndElement(),this.document.footnotes&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document.endnotes&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement();var n=new Ie.eo(e.buffer,this.settingsPath);this.mArchive.addItem(n)},s.prototype.serializeCoreProperties=function(){},s.prototype.serializeAppProperties=function(){},s.prototype.serializeFontTable=function(e){},s.prototype.serializeSettingsRelation=function(){},s.prototype.serializeHeaderFooters=function(){this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader")},s.prototype.serializeHeaderFooter=function(e){var t,i;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(e))for(var n=this.headersFooters.get(e),r=void 0,o=0;o<n.keys.length;o++){var l=n.keys[o];r=n.get(l),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+l.replace("rId","")+".xml",i=this.headerRelationPath+l.replace("rId","")+".xml.rels",this.serializeHeader(r,l,t,i)):(t=this.footerPath+l.replace("rId","")+".xml",i=this.footerRelationPath+l.replace("rId","")+".xml.rels",this.serializeFooter(r,l,t,i))}},s.prototype.serializeHeader=function(e,t,i,n){this.headerFooter=e;var r=new We.L_;r.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(r);var o=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(r,e.blocks,!0),this.blockOwner=o,r.writeEndElement();var l=new Ie.eo(r.buffer,i);this.mArchive.addItem(l),this.serializeHFRelations(t,n),this.headerFooter=void 0},s.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var n=new We.L_;n.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),n,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),n),n.writeEndElement();var r=new Ie.eo(n.buffer,t);this.mArchive.addItem(r)}},s.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},s.prototype.serializeFooter=function(e,t,i,n){this.headerFooter=e;var r=new We.L_;r.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(r),this.serializeBodyItems(r,e.blocks,!0),r.writeEndElement();var o=new Ie.eo(r.buffer,i);this.mArchive.addItem(o),this.serializeHFRelations(t,n)},s.prototype.serializeDocumentRelations=function(){var e=new We.L_;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document.endnotes&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document.footnotes&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),this.document.lists.length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement();var t=new Ie.eo(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},s.prototype.serializeChartDocumentRelations=function(e,t){if(e.length>0)for(var i=e.keys,n=1;n<=i.length;n++)this.serializeRelationShip(t,i[n-1],this.chartRelType,"charts/chart"+n+".xml")},s.prototype.serializeChartRelations=function(){var e=new We.L_;this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace);var t="colors"+this.chartCount+".xml",i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",n="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,n),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement();var r=new Ie.eo(e.buffer,i);this.mArchive.addItem(r)},s.prototype.serializeImagesRelations=function(e,t,i){if(e.length>0)for(var n="",r=void 0,o=e.keys,l=0;l<o.length;l++){var h=e.get(o[l]);if((0,a.le)(r=i?h.metaFileImageString:h.imageString))this.serializeRelationShip(t,o[l],this.imageRelType,(n=this.imagePath+"/0.jpeg").replace("word/",""));else{var d=w.formatClippedString(r),u=d.formatClippedString;this.serializeRelationShip(t,o[l],this.imageRelType,(n=this.imagePath+o[l]+d.extension).replace("word/",""));var p=new Blob([this.encodedString(u)]),f=new Ie.eo(p,n);this.mArchive.addItem(f)}}},s.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},s.prototype.encodedString=function(e){var n,r,o,l,h,d,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=0,p=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===t.charAt(64)&&p--,e.charAt(e.length-2)===t.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var f=new Uint8Array(0|p);c<e.length;)o=t.indexOf(e.charAt(c++)),n=(15&(l=t.indexOf(e.charAt(c++))))<<4|(h=t.indexOf(e.charAt(c++)))>>2,r=(3&h)<<6|(d=t.indexOf(e.charAt(c++))),f[u++]=o<<2|l>>4,64!==h&&(f[u++]=n),64!==d&&(f[u++]=r);return f},s.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},s.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},s.prototype.serializeHFRelation=function(e,t){var n,i="";if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var l=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(i="header"+l.replace("rId","")+".xml",n=this.headerRelType):(i="footer"+l.replace("rId","")+".xml",n=this.footerRelType),this.serializeRelationShip(e,l,n,i)}},s.prototype.serializeRelationShip=function(e,t,i,n){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,n.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(n,"http://")||this.startsWith(n,"https://")||this.startsWith(n,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},s.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},s.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},s.prototype.serializeGeneralRelations=function(){var e=new We.L_;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new Ie.eo(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},s.prototype.serializeContentTypes=function(e){var t=new We.L_;if(t.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(t,"rels",this.relationContentType),this.serializeDefaultContentType(t,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(t,"png","image/png"),this.serializeDefaultContentType(t,"bmp","image/bmp"),this.serializeDefaultContentType(t,"emf","image/x-emf"),this.serializeDefaultContentType(t,"wmf","image/x-wmf"),this.serializeDefaultContentType(t,"gif","image/gif"),this.serializeDefaultContentType(t,"ico","image/x-icon"),this.serializeDefaultContentType(t,"tif","image/tiff"),this.serializeDefaultContentType(t,"tiff","image/tiff"),this.serializeDefaultContentType(t,"jpeg","image/jpeg"),this.serializeDefaultContentType(t,"jpg","image/jpeg"),this.serializeDefaultContentType(t,"svg","image/svg+xml")),this.serializeOverrideContentType(t,this.documentPath,this.documentContentType),this.serializeOverrideContentType(t,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(t,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(t,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(t,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(t,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0){var i=1;for(this.serializeDefaultContentType(t,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");i<=this.chartCount;)this.serializeOverrideContentType(t,"word/charts/chart"+i+".xml",this.chartsContentType),this.serializeOverrideContentType(t,"word/charts/colors"+i+".xml",this.chartColorStyleContentType),i++}if(this.customXMLProps.length>0)for(var n=0;n<this.customXMLProps.length;n++)this.serializeOverrideContentType(t,this.customXMLProps[n],this.customXmlContentType);this.serializeHFContentTypes(t),this.SerializeEFContentTypes(t),t.writeEndElement();var r=new Ie.eo(t.buffer,this.contentTypesPath);this.mArchive.addItem(r)},s.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},s.prototype.serializeHeaderFootersContentType=function(e,t){var i,n;if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var l=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(n=this.headerPath+l.replace("rId","")+".xml",i=this.headerContentType):(n=this.footerPath+l.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,n,i)}},s.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},s.prototype.serializeEFContentType=function(e){this.serializeOverrideContentType(e,this.endnotesPath,this.endnoteContentType),this.serializeOverrideContentType(e,this.footnotesPath,this.footnoteContentType)},s.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},s.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},s.prototype.resetRelationShipID=function(){this.mRelationShipID=0},s.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},s.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},s.prototype.close=function(){},s}(),Mr=function(){function s(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}return s.prototype.getModuleName=function(){return"TextExport"},s.prototype.save=function(e,t){this.serialize(e);var i=new We.LF;this.writeInternal(i),i.save(t+".txt")},s.prototype.saveAsBlob=function(e){this.serialize(e);var t=new We.LF;this.writeInternal(t);var i=t.buffer;return t.destroy(),new Promise(function(n,r){n(i)})},s.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write();this.setDocument(t)},s.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},s.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,n=!1;this.updateLastParagraph();for(var r=0;r<=i;r++)n=r===i,this.writeBody(e,(t=this.document.sections[r]).blocks,!1),this.writeNewLine(e),this.writeSectionEnd(t,n);for(var o=0;o<=i;o++)this.writeHeadersFooters(e,t=this.document.sections[o])},s.prototype.writeBody=function(e,t,i){for(var n=t.length-1,r=void 0,o=0;o<=n;o++)(r=t[o]).hasOwnProperty("inlines")?this.writeParagraph(e,r,r===this.lastPara,i):this.writeTable(e,r)},s.prototype.writeParagraph=function(e,t,i,n){for(var r=0;r<t.inlines.length;r++){var o=t.inlines[r];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}(!n||t.inlines.length>0)&&(i||this.writeNewLine(e))},s.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var n=t.rows[i],r=0;r<n.cells.length;r++)this.writeBody(e,n.cells[r].blocks,!1)},s.prototype.writeHeadersFooters=function(e,t){(0,a.le)(t.headersFooters)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},s.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},s.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},s.prototype.writeNewLine=function(e){(0,a.le)(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},s.prototype.writeText=function(e,t){(0,a.le)(e)?this.pageContent+=t:e.write(t)},s.prototype.updateLastParagraph=function(){var t,e=this.document.sections.length;if(e>0&&(t=this.document.sections[e-1]),!(0,a.le)(t)){for(var i=[],n=0;n<t.blocks.length;n++)t.blocks[n].hasOwnProperty("inlines")&&i.push(t.blocks[n]);var r=i.length;r>0&&(this.lastPara=i[r-1])}},s.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=[],this.sections=void 0,this.pageContent=void 0},s}(),Zi=function(){function s(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.isExport=!0,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}return Object.defineProperty(s.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"SfdtExport"},s.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1},s.prototype.serialize=function(){return JSON.stringify(this.write())},s.prototype.saveAsBlob=function(e){var t=new Blob([this.serialize()],{type:"text/plain"});return new Promise(function(i,n){i(t)})},s.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,n=0;n<i[t].length;n++)for(var r=this.documentHelper.editRanges.get(i[t]),o=0;o<r.length;o++)e++,r[o].editRangeId=e,r[o].editRangeEnd.editRangeId=e},s.prototype.write=function(e,t,i,n,r,o){if(r&&(this.writeInlineStyles=!0),this.Initialize(),this.updateEditRangeId(),e instanceof oe&&i instanceof oe){this.isExport=!1,(0,a.le)(o)||(this.isExport=o);var l=e.paragraph,h=i.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(l),this.endBlock=this.getParentBlock(h));var d=l.associatedCell,c=h.associatedCell,p=this.createSection(e.paragraph.bodyWidget);this.document.sections.push(p);var f=d,g=c;d instanceof V&&(f=this.getParentCell(f)),c instanceof V&&(g=this.getParentCell(g));var m=f instanceof V&&g instanceof V&&g.equals(g);if(m||(0,a.le)(c))this.startLine=e,this.endLine=i,this.endOffset=n;else if(d instanceof V){var v=d.getContainerTable(),y=c.getContainerTable();v.tableFormat===y.tableFormat&&(this.endCell=c,this.endCell.ownerTable!==d.ownerTable&&d.ownerTable.associatedCell&&d.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===d.ownerTable.associatedCell.childWidgets.indexOf(d.ownerTable)&&(d=d.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=d.columnIndex)}else this.endCell=c;var b=void 0;if(m&&!this.isPartialExport||(0,a.le)(d)){var C=this.createParagraph(e.paragraph);p.blocks.push(C);var F=e.paragraph;for(b=this.writeParagraph(e.paragraph,C,p.blocks,e.indexInOwner,t),this.isPartialExport&&(b=this.getNextBlock(b,F),p=this.document.sections[this.document.sections.length-1]);b;)F=b,b=this.writeBlock(b,0,p.blocks),this.isPartialExport&&(0,a.le)(b)&&(b=this.getNextBlock(b,F),p=this.document.sections[this.document.sections.length-1])}else{if((0,a.le)(c)&&d.ownerTable.associatedCell){var T=(v=d.getContainerTable()).childWidgets[v.childWidgets.length-1],x=T.childWidgets[T.childWidgets.length-1];if(x.ownerTable!==d.ownerTable&&d.ownerTable.associatedCell&&0===d.ownerTable.associatedCell.childWidgets.indexOf(d.ownerTable))for(;d.ownerTable!==x.ownerTable;)d=d.ownerTable.associatedCell;this.endColumnIndex=x.columnIndex+x.cellFormat.columnSpan,this.startColumnIndex=d.columnIndex}var P=this.createTable(d.ownerTable);for(p.blocks.push(P),F=d.ownerTable,b=this.writeTable(d.ownerTable,P,d.ownerRow.indexInOwner,p.blocks),this.isPartialExport&&(b=this.getNextBlock(b,F),p=this.document.sections[this.document.sections.length-1]);b;)F=b,b=this.writeBlock(b,0,p.blocks),this.isPartialExport&&(b=this.getNextBlock(b,F),p=this.document.sections[this.document.sections.length-1])}}else this.isExport=!0,this.documentHelper.pages.length>0&&this.writePage(this.documentHelper.pages[0]);this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper);var L=this.document;return this.clear(),L},s.prototype.getNextBlock=function(e,t){if((0,a.le)(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index){var i=this.createSection(e.bodyWidget);this.document.sections.push(i)}else e=void 0;return e},s.prototype.Initialize=function(){this.lists=[],this.document={},this.document.sections=[],this.document.characterFormat=this.writeCharacterFormat(this.documentHelper.characterFormat),this.document.paragraphFormat=this.writeParagraphFormat(this.documentHelper.paragraphFormat),this.document.defaultTabWidth=this.documentHelper.defaultTabWidth,this.document.trackChanges=this.owner.enableTrackChanges,this.document.enforcement=this.documentHelper.isDocumentProtected,this.document.hashValue=this.documentHelper.hashValue,this.document.saltValue=this.documentHelper.saltValue,this.document.formatting=this.documentHelper.restrictFormatting,this.document.protectionType=this.documentHelper.protectionType,this.document.dontUseHTMLParagraphAutoSpacing=this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.document.formFieldShading=this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.document.compatibilityMode=this.documentHelper.compatibilityMode},s.prototype.writePage=function(e){if(e.bodyWidgets.length>0){var t=e.bodyWidgets[0];do{t=this.writeBodyWidget(t,0)}while(!(0,a.le)(t))}return this.document},s.prototype.writeBodyWidget=function(e,t){if(e instanceof j){var i=this.createSection(e);this.document.sections.push(i),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],i);var n=e.childWidgets[t];do{n=this.writeBlock(n,0,i.blocks)}while(n);var r=e;do{e=r,(0,a.le)(r=r.nextRenderedWidget)&&!(0,a.le)(e.page.nextPage)&&!(0,a.le)(e.page.nextPage)&&(r=e.page.nextPage.bodyWidgets[0])}while(r instanceof j&&r.index===e.index);return r}},s.prototype.writeHeaderFooters=function(e,t){(0,a.le)(e)||(t.headersFooters.header=this.writeHeaderFooter(e[0]),t.headersFooters.footer=this.writeHeaderFooter(e[1]),t.headersFooters.evenHeader=this.writeHeaderFooter(e[2]),t.headersFooters.evenFooter=this.writeHeaderFooter(e[3]),t.headersFooters.firstPageHeader=this.writeHeaderFooter(e[4]),t.headersFooters.firstPageFooter=this.writeHeaderFooter(e[5]))},s.prototype.writeHeaderFooter=function(e){if(!(0,a.le)(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&e.childWidgets.length>0){t.blocks=[];var i=e.firstChild;do{i=this.writeBlock(i,0,t.blocks)}while(i)}return t}},s.prototype.createSection=function(e){var t={sectionFormat:{}};return t.sectionFormat.pageWidth=e.sectionFormat.pageWidth,t.sectionFormat.pageHeight=e.sectionFormat.pageHeight,t.sectionFormat.leftMargin=e.sectionFormat.leftMargin,t.sectionFormat.rightMargin=e.sectionFormat.rightMargin,t.sectionFormat.topMargin=e.sectionFormat.topMargin,t.sectionFormat.bottomMargin=e.sectionFormat.bottomMargin,t.sectionFormat.differentFirstPage=e.sectionFormat.differentFirstPage,t.sectionFormat.differentOddAndEvenPages=e.sectionFormat.differentOddAndEvenPages,t.sectionFormat.headerDistance=e.sectionFormat.headerDistance,t.sectionFormat.footerDistance=e.sectionFormat.footerDistance,t.sectionFormat.bidi=e.sectionFormat.bidi,e.sectionFormat.restartPageNumbering&&(t.sectionFormat.restartPageNumbering=e.sectionFormat.restartPageNumbering,t.sectionFormat.pageStartingNumber=e.sectionFormat.pageStartingNumber),(0,a.le)(e.page.endnoteWidget||e.page.footnoteWidget)||(t.sectionFormat.endnoteNumberFormat=e.sectionFormat.endnoteNumberFormat,t.sectionFormat.footNoteNumberFormat=e.sectionFormat.footNoteNumberFormat,t.sectionFormat.restartIndexForFootnotes=e.sectionFormat.restartIndexForFootnotes,t.sectionFormat.restartIndexForEndnotes=e.sectionFormat.restartIndexForEndnotes,t.sectionFormat.initialFootNoteNumber=e.sectionFormat.initialFootNoteNumber,t.sectionFormat.initialEndNoteNumber=e.sectionFormat.initialEndNoteNumber),(0,a.le)(e.sectionFormat.pageNumberStyle)||(t.sectionFormat.pageNumberStyle=e.sectionFormat.pageNumberStyle),t.blocks=[],t.headersFooters={},t},s.prototype.writeBlock=function(e,t,i){if(e instanceof Ve){if(e instanceof I){if(e.hasOwnProperty("contentControlProperties")){var n=this.blockContentControl(e);return this.blockContent=!1,!(0,a.le)(n)&&(this.isBlockClosed||!this.nestedBlockContent)&&(this.nestedBlockEnabled=!1,i.push(n),this.blocks=[]),this.nextBlock}var r=this.createParagraph(e);return i.push(r),this.writeParagraph(e,r,i)}var o=e;if(o.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==o.contentControlProperties.type)return n=this.tableContentControl(o),!(0,a.le)(n)&&this.isBlockClosed&&i.push(n),this.nextBlock;var l=this.createTable(o);return i.push(l),this.writeTable(o,l,0,i)}},s.prototype.writeParagraphs=function(e){var t=this.blocks,i=e.childWidgets[0],n=i.children[0],r=i.children[1];if((n instanceof _||r instanceof _)&&(n=i.children[2],r=i.children[3]),this.nestedBlockEnabled&&(t=[]),n instanceof $&&r instanceof $&&!this.nestedBlockContent||this.blockContent&&n instanceof $&&!this.nestedBlockContent){var o=!1;if(r instanceof $&&"Block"===r.contentControlWidgetType&&(o=!0),o||this.blockContent&&n instanceof $&&!this.nestedBlockContent&&0===n.type&&r instanceof $&&"Block"===n.contentControlWidgetType){this.nestedBlockContent=!0,this.nestedBlockEnabled=!0;var l=this.blockContentControl(e);(0,a.le)(l)||this.blocks.push(l)}else{var h=this.createParagraph(e);t.push(h),this.nextBlock=this.writeParagraph(e,h,t)}}else h=this.createParagraph(e),t.push(h),this.nextBlock=this.writeParagraph(e,h,t);return!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},s.prototype.contentControlProperty=function(e){var t={};return t.lockContentControl=e.lockContentControl,t.lockContents=e.lockContents,t.tag=e.tag,t.color=e.color,t.title=e.title,(0,a.le)(e.appearance)||(t.appearance=e.appearance),t.type=e.type,t.hasPlaceHolderText=e.hasPlaceHolderText,t.multiline=e.multiline,t.isTemporary=e.isTemporary,(0,a.le)(e.isChecked)||(t.isChecked=e.isChecked),(0,a.le)(e.uncheckedState)||(t.uncheckedState=this.tounCheckedState(e.uncheckedState)),(0,a.le)(e.checkedState)||(t.checkedState=this.toCheckedState(e.checkedState)),(0,a.le)(e.dateCalendarType)||(t.dateCalendarType=e.dateCalendarType),(0,a.le)(e.dateStorageFormat)||(t.dateStorageFormat=e.dateStorageFormat),(0,a.le)(e.dateDisplayLocale)||(t.dateDisplayLocale=e.dateDisplayLocale),(0,a.le)(e.dateDisplayFormat)||(t.dateDisplayFormat=e.dateDisplayFormat),(0,a.le)(e.xmlMapping)||(t.xmlMapping=e.xmlMapping),(0,a.le)(e.characterFormat)||(t.characterFormat=this.writeCharacterFormat(e.characterFormat)),t.contentControlListItems=e.contentControlListItems,t},s.prototype.tounCheckedState=function(e){var t={};return t.font=e.font,t.value=e.value,t},s.prototype.toCheckedState=function(e){var t={};return t.font=e.font,t.value=e.value,t},s.prototype.blockContentControl=function(e){var t={};if(0!==e.childWidgets.length){if(t.blocks=this.writeParagraphs(e),!(0,a.le)(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t.blocks;this.isBlockClosed=!0}if(!(0,a.le)(t.blocks)){var i=e.childWidgets[0],n=i.children[0],r=i.children[1];if((n instanceof _||r instanceof _)&&(n=i.children[2],r=i.children[3]),n instanceof $&&r instanceof $&&!this.nestedBlockContent||this.blockContent&&n instanceof $&&!this.nestedBlockContent){if(!(r instanceof $))return t.contentControlProperties=this.contentControlProperty(n.contentControlProperties),t;t.contentControlProperties=this.contentControlProperty("Block"===r.contentControlWidgetType?r.contentControlProperties:e.contentControlProperties)}else t.contentControlProperties=this.contentControlProperty(e.contentControlProperties);return t}}else this.nextBlock=e.nextWidget},s.prototype.tableContentControl=function(e){var t={};if(t.blocks=this.tableContentControls(e),!(0,a.le)(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t.blocks;this.isBlockClosed=!0}return t.contentControlProperties=this.contentControlProperty(e.contentControlProperties),t},s.prototype.tableContentControls=function(e){var t=[];this.isBlockClosed||(t=this.blocks);var i=this.createTable(e);return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},s.prototype.writeParagraph=function(e,t,i,n,r){(0,a.le)(n)&&(n=0),(0,a.le)(r)&&(r=0);for(var o=e;o instanceof I;){if(this.writeLines(o,n,r,t.inlines))return;n=0,r=0,o=(e=o).nextSplitWidget}return(0,a.le)(o=e.nextRenderedWidget)&&e.containerWidget instanceof j&&!(0,a.le)(e.containerWidget.page.nextPage)&&!(0,a.le)(e.containerWidget.page.nextPage.bodyWidgets)&&(o=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),this.isExport?o instanceof Ve&&e.containerWidget.index===o.containerWidget.index?o:void 0:o},s.prototype.writeInlines=function(e,t,i){this.contentInline=[];for(var n=t,r=!1,o=0;o<n.children.length;o++){var l=n.children[o];if(this.isExport&&this.checkboxOrDropdown){if(r&&l instanceof S)continue;l instanceof H&&2===l.fieldType&&(r=!0)}if(!(l instanceof _)){if(l instanceof Ee){i.push(this.writeInlinesFootNote(e,l,t,i));continue}if(l instanceof $||this.startContent||this.blockContent)this.writeInlinesContentControl(l,t,i,o);else{var h=this.writeInline(l);(0,a.le)(h)||i.push(h)}this.isExport&&l instanceof H&&1===l.fieldType&&(r=!1,this.checkboxOrDropdown=!1)}}},s.prototype.inlineContentControl=function(e,t,i){var n={},r=[];if((0,a.le)(i))if(this.nestedContent){n.inlines=this.inlineContentControls(e,void 0,r);var o=this.nestedContentProperty(t,n);(!(0,a.le)(o)||this.multipleLineContent)&&(this.contentInline.push(n),r=[])}else n.inlines=this.inlineContentControls(e,this.contentInline);else this.nestedContent?(n=this.inlineContentControls(e,(i=i[i.length-1].inlines)[i.length-1].inlines),o=this.nestedContentProperty(t,i[i.length-1]),(0,a.le)(o)||(this.contentInline.push(n),r=[])):this.inlineContentControls(e,i[i.length-1].inlines);return t instanceof $&&1===t.type&&!this.nestedContent?this.multipleLineContent?(i[i.length-1].contentControlProperties=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(n.contentControlProperties=this.contentControlProperty(t.contentControlProperties),n):this.startContent?(this.multipleLineContent=!0,n):void 0},s.prototype.nestedContentProperty=function(e,t,i){if((0,a.le)(e)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===e.type)return t.contentControlProperties=this.contentControlProperty(e.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},s.prototype.inlineContentControls=function(e,t,i){var n=this.writeInline(e);return(0,a.le)(i)?(t.push(n),t):(i.push(n),i)},s.prototype.writeInline=function(e){var t={};if(e.removedIds.length>0)for(var i=0;i<e.removedIds.length;i++)e.revisions[i]=this.documentHelper.revisionsInternal.get(e.removedIds[i]);if(t.characterFormat=this.writeCharacterFormat(e.characterFormat),e instanceof H)t.fieldType=e.fieldType,0===e.fieldType&&(t.hasFieldEnd=!0,e.formFieldData&&(t.formFieldData={},t.formFieldData.name=e.formFieldData.name,t.formFieldData.enabled=e.formFieldData.enabled,t.formFieldData.helpText=e.formFieldData.helpText,t.formFieldData.statusText=e.formFieldData.statusText,e.formFieldData instanceof Re?(t.formFieldData.textInput={},t.formFieldData.textInput.type=e.formFieldData.type,t.formFieldData.textInput.maxLength=e.formFieldData.maxLength,t.formFieldData.textInput.defaultValue=e.formFieldData.defaultValue,t.formFieldData.textInput.format=e.formFieldData.format):e.formFieldData instanceof qe?(t.formFieldData.checkBox={},this.checkboxOrDropdown=!0,t.formFieldData.checkBox.sizeType=e.formFieldData.sizeType,t.formFieldData.checkBox.size=e.formFieldData.size,t.formFieldData.checkBox.defaultValue=e.formFieldData.defaultValue,t.formFieldData.checkBox.checked=e.formFieldData.checked):(t.formFieldData.dropDownList={},this.checkboxOrDropdown=!0,t.formFieldData.dropDownList.dropDownItems=e.formFieldData.dropdownItems,t.formFieldData.dropDownList.selectedIndex=e.formFieldData.selectedIndex))),e.fieldCodeType&&""!==e.fieldCodeType&&(t.fieldCodeType=e.fieldCodeType);else if(e instanceof _t)this.writeChart(e,t);else if(e instanceof ee)t.imageString=e.imageString,t.metaFileImageString=e.metaFileImageString,t.isMetaFile=e.isMetaFile,t.isCompressed=e.isCompressed,t.width=w.convertPixelToPoint(e.width),t.height=w.convertPixelToPoint(e.height),t.iscrop=e.isCrop,e.isCrop&&(t.bottom=e.bottom,t.right=e.right,t.left=e.left,t.top=e.top,t.getimagewidth=e.cropWidthScale,t.getimageheight=e.cropHeightScale),t.name=e.name,t.alternativeText=e.alternativeText,t.title=e.title,t.visible=e.visible,t.widthScale=e.widthScale,t.heightScale=e.heightScale,t.verticalPosition=w.convertPixelToPoint(e.verticalPosition),t.verticalOrigin=e.verticalOrigin,t.verticalAlignment=e.verticalAlignment,t.horizontalPosition=w.convertPixelToPoint(e.horizontalPosition),t.horizontalOrigin=e.horizontalOrigin,t.horizontalAlignment=e.horizontalAlignment,t.allowOverlap=e.allowOverlap,t.textWrappingStyle=e.textWrappingStyle,t.textWrappingType=e.textWrappingType,t.layoutInCell=e.layoutInCell,t.zOrderPosition=e.zOrderPosition;else if(e instanceof O)t.bookmarkType=e.bookmarkType,t.name=e.name;else if(e instanceof S)if(-1!==e.text.indexOf(String.fromCharCode(30)))t.text=e.text.replace(/\u001e/g,"-");else if(-1!==e.text.indexOf(String.fromCharCode(31)))t.text=e.text.replace(/\u001f/g,"");else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)t.text=e.text;else{this.copyWithTrackChange=!0;for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n];-1===this.selectedRevisionId.indexOf(r.revisionID)&&this.selectedRevisionId.push(r.revisionID),"Deletion"!==e.revisions[n].revisionType&&(t.text=e.text)}}else t.text=e.text;else e instanceof xe?(t.user=e.user,t.group=e.group,t.columnFirst=e.columnFirst,t.columnLast=e.columnLast,t.editRangeId=e.editRangeId.toString()):e instanceof He?(t.editableRangeStart={user:e.editRangeStart.user,group:e.editRangeStart.group,columnFirst:e.editRangeStart.columnFirst,columnLast:e.editRangeStart.columnLast},t.editRangeId=e.editRangeId.toString()):e instanceof ae?(!this.isExport&&0===e.commentType&&this.selectedCommentsId.push(e.commentId),t.commentCharacterType=e.commentType,t.commentId=e.commentId):e instanceof de?this.writeShape(e,t):t=void 0;if(e.revisions.length>0&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges))for(t.revisionIds=[],n=0;n<e.revisions.length;n++)-1===this.selectedRevisionId.indexOf(e.revisions[n].revisionID)&&this.selectedRevisionId.push(e.revisions[n].revisionID),t.revisionIds.push(e.revisions[n].revisionID);return t},s.prototype.writeShape=function(e,t){if(t.shapeId=e.shapeId,t.name=e.name,t.alternativeText=e.alternativeText,t.title=e.title,t.visible=e.visible,t.width=w.convertPixelToPoint(e.width),t.height=w.convertPixelToPoint(e.height),t.widthScale=e.widthScale,t.heightScale=e.heightScale,t.verticalPosition=w.convertPixelToPoint(e.verticalPosition),t.verticalOrigin=e.verticalOrigin,t.verticalAlignment=e.verticalAlignment,t.verticalRelativePercent=e.verticalRelativePercent,t.horizontalPosition=w.convertPixelToPoint(e.horizontalPosition),t.horizontalOrigin=e.horizontalOrigin,t.horizontalAlignment=e.horizontalAlignment,t.horizontalRelativePercent=e.horizontalRelativePercent,t.zOrderPosition=e.zOrderPosition,t.allowOverlap=e.allowOverlap,t.textWrappingStyle=e.textWrappingStyle,t.textWrappingType=e.textWrappingType,t.distanceBottom=w.convertPixelToPoint(e.distanceBottom),t.distanceLeft=w.convertPixelToPoint(e.distanceLeft),t.distanceRight=w.convertPixelToPoint(e.distanceRight),t.distanceTop=w.convertPixelToPoint(e.distanceTop),t.layoutInCell=e.layoutInCell,t.lockAnchor=e.lockAnchor,t.autoShapeType=e.autoShapeType,e.fillFormat&&(t.fillFormat={},t.fillFormat.color=e.fillFormat.color,t.fillFormat.fill=e.fillFormat.fill),e.lineFormat&&(t.lineFormat={},t.lineFormat.lineFormatType=e.lineFormat.lineFormatType,t.lineFormat.color=e.lineFormat.color,t.lineFormat.weight=e.lineFormat.weight,t.lineFormat.lineStyle=e.lineFormat.dashStyle,t.lineFormat.line=e.lineFormat.line),e.textFrame){t.textFrame={},t.textFrame.textVerticalAlignment=e.textFrame.textVerticalAlignment,t.textFrame.leftMargin=w.convertPixelToPoint(e.textFrame.marginLeft),t.textFrame.rightMargin=w.convertPixelToPoint(e.textFrame.marginRight),t.textFrame.topMargin=w.convertPixelToPoint(e.textFrame.marginTop),t.textFrame.bottomMargin=w.convertPixelToPoint(e.textFrame.marginBottom),t.textFrame.blocks=[];for(var i=0;i<e.textFrame.childWidgets.length;i++)this.writeBlock(e.textFrame.childWidgets[i],0,t.textFrame.blocks)}},s.prototype.writeChart=function(e,t){t.chartLegend={},t.chartTitleArea={},t.chartArea={},t.plotArea={},t.chartCategory=[],t.chartSeries=[],t.chartPrimaryCategoryAxis={},t.chartPrimaryValueAxis={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea),this.writeChartArea(e.chartArea,t.chartArea),this.writeChartArea(e.chartPlotArea,t.plotArea),this.writeChartCategory(e,t.chartCategory),this.createChartSeries(e,t.chartSeries),this.writeChartLegend(e.chartLegend,t.chartLegend),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t.chartPrimaryCategoryAxis),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t.chartPrimaryValueAxis),void 0!==e.chartDataTable.showSeriesKeys&&(t.chartDataTable={},this.writeChartDataTable(e.chartDataTable,t.chartDataTable)),t.chartTitle=e.title,t.chartType=e.type,t.gapWidth=e.chartGapWidth,t.overlap=e.chartOverlap,t.height=w.convertPixelToPoint(e.height),t.width=w.convertPixelToPoint(e.width)},s.prototype.writeChartTitleArea=function(e,t){t.fontName=e.chartfontName,t.fontSize=e.chartFontSize,t.layout={},t.dataFormat=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t.layout)},s.prototype.writeChartDataFormat=function(e){var t={fill:{},line:{}};return(0,a.le)(e.fill.color)||(t.fill.foreColor=e.fill.color.length>6?e.fill.color.substring(2):e.fill.color),t.fill.rgb=e.fill.rgb,t.line.color=e.line.color,t.line.rgb=e.line.rgb,t},s.prototype.writeChartLayout=function(e,t){t.layoutX=e.chartLayoutLeft,t.layoutY=e.chartLayoutTop},s.prototype.writeChartArea=function(e,t){t.foreColor=e.chartForeColor},s.prototype.writeChartLegend=function(e,t){t.position=e.chartLegendPostion,t.chartTitleArea={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea)},s.prototype.writeChartCategoryAxis=function(e,t){t.chartTitle=e.categoryAxisTitle,t.chartTitleArea={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea),t.categoryType=e.categoryAxisType,t.fontSize=e.axisFontSize,t.fontName=e.axisFontName,t.numberFormat=e.categoryNumberFormat,t.maximumValue=e.max,t.minimumValue=e.min,t.majorUnit=e.interval,t.hasMajorGridLines=e.majorGridLines,t.hasMinorGridLines=e.minorGridLines,t.majorTickMark=e.majorTick,t.minorTickMark=e.minorTick,t.tickLabelPosition=e.tickPosition},s.prototype.writeChartDataTable=function(e,t){t.showSeriesKeys=e.showSeriesKeys,t.hasHorzBorder=e.hasHorzBorder,t.hasVertBorder=e.hasVertBorder,t.hasBorders=e.hasBorders},s.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t.chartData=[];for(var n=0;n<i.length;n++){var o=this.createChartCategory(i[n],e.chartType);t.push(o)}},s.prototype.createChartCategory=function(e,t){var i={chartData:[]};return this.writeChartData(e,i.chartData,t),i.categoryXName=e.categoryXName,i},s.prototype.writeChartData=function(e,t,i){for(var n=e.chartData,r=0;r<n.length;r++){var l=this.createChartData(n[r],i);t.push(l)}},s.prototype.createChartData=function(e,t){var i={};return i.yValue=e.yValue,"Bubble"===t&&(i.size=e.size),i},s.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,n=e.chartType,r=0;r<i.length;r++){var l=this.writeChartSeries(i[r],n);t.push(l)}},s.prototype.writeChartSeries=function(e,t){var i="Pie"===t||"Doughnut"===t,n={},r={},o=e.errorBar;if(n.dataPoints=[],n.seriesName=e.seriesName,i&&((0,a.le)(e.firstSliceAngle)||(n.firstSliceAngle=e.firstSliceAngle),"Doughnut"===t&&(n.holeSize=e.doughnutHoleSize)),!(0,a.le)(e.dataLabels.labelPosition)){var l=this.writeChartDataLabels(e.dataLabels);n.dataLabel=l}if(!(0,a.le)(e.seriesFormat.markerStyle)){var h={};h.markerStyle=(d=e.seriesFormat).markerStyle,h.markerSize=d.numberValue,h.markerColor=d.markerColor,n.seriesFormat=h}if((0,a.le)(o.type)||(r.type=o.type,r.direction=o.direction,r.endStyle=o.endStyle,r.numberValue=o.numberValue,n.errorBar=o),e.trendLines.length>0){n.trendLines=[];for(var c=0;c<e.trendLines.length;c++){var u=this.writeChartTrendLines(e.trendLines[c]);n.trendLines.push(u)}}for(c=0;c<e.chartDataFormat.length;c++){var d=this.writeChartDataFormat(e.chartDataFormat[c]);n.dataPoints.push(d)}return n},s.prototype.writeChartDataLabels=function(e){var t={};return t.position=e.position,t.fontName=e.fontName,t.fontColor=w.convertArgbToRgb(e.fontColor),t.fontSize=e.fontSize,t.isLegendKey=e.isLegendKey,t.isBubbleSize=e.isBubbleSize,t.isCategoryName=e.isCategoryName,t.isSeriesName=e.isSeriesName,t.isValue=e.isValue,t.isPercentage=e.isPercentage,t.isLeaderLines=e.isLeaderLines,t},s.prototype.writeChartTrendLines=function(e){var t={};return t.name=e.trendLineName,t.type=e.trendLineType,t.forward=e.forwardValue,t.backward=e.backwardValue,t.intercept=e.interceptValue,t.isDisplayEquation=e.isDisplayEquation,t.isDisplayRSquared=e.isDisplayRSquared,t},s.prototype.writeLines=function(e,t,i,n){for(var o=this.endLine instanceof oe&&this.endLine.paragraph===e,l=o?this.endLine.indexInOwner:e.childWidgets.length-1,h=t;h<=l;h++){var d=e.childWidgets[h];this.endLine===d||t===h&&0!==i?this.writeLine(d,this.startLine!==this.endLine&&d!==this.startLine?0:i,n):this.writeInlines(e,d,n)}return o},s.prototype.writeLine=function(e,t,i){this.contentInline=[];for(var n=!1,r=!1,o=e===this.endLine,l=e,h=!1,d=!1,c=0,u=0;u<l.children.length;u++){var p=l.children[u];if(!(p instanceof _)){var f=void 0;if(h=(c+=p.length)>t,p instanceof $&&(h||(n=0===p.type),r=!0),p instanceof S&&p.hasOwnProperty("contentControlProperties")&&h&&!r&&(n=!0),p instanceof $&&(n&&1===p.type&&(n=!1),r&&1===p.type&&(r=!1)),d=o&&c>=this.endOffset,h&&!n){if(p instanceof $||this.startContent||this.blockContent){if(d){this.startContent=!1;break}this.writeInlinesContentControl(p,e,i,u);continue}if(f=this.writeInline(p),i[i.length]=f,c>t||d){if(f.hasOwnProperty("text")){var g=c-p.length;f.text=f.text.substring(t-g,d?this.endOffset-g:p.length)}t=-1}if(d)break}}}},s.prototype.writeInlinesFootNote=function(e,t,i,n){var r={};r.footnoteType=t.footnoteType,r.characterFormat={},r.characterFormat=this.writeCharacterFormat(t.characterFormat),r.blocks=[];for(var o=0;o<t.bodyWidget.childWidgets.length;o++)this.writeBlock(t.bodyWidget.childWidgets[o],0,r.blocks);return r.symbolCode=t.symbolCode,r.symbolFontName=t.symbolFontName,r.customMarker=t.customMarker,r},s.prototype.writeInlinesContentControl=function(e,t,i,n){if(e instanceof $&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===e.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===e.type,t.children[n-1]instanceof $&&"Block"===t.children[n-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof $){if(this.startContent&&0===e.type)return this.nestedContent=!0,!0;if(this.startContent&&this.nestedContent){if((r={}).inlines=this.contentInline,this.contentInline.length>0){var o=this.nestedContentProperty(t.children[n+1],r);i.push(o),this.contentInline=[]}return this.multipleLineContent&&(this.nestedContentProperty(t.children[n+1],r=i[i.length-1]),this.multipleLineContent=!1),this.nestedContent=!1,!0}return this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0}if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent)this.inlineContentControl(e,t.children[n+1],i),this.contentInline=[];else{var l=this.inlineContentControl(e,t.children[n+1]);if(!(0,a.le)(l)){if(!this.nestedContent||!this.multipleLineContent)return i.push(l),this.contentInline=[],!1;(r={}).inlines=this.contentInline,i.push(r),this.contentInline=[]}}else{var r=this.writeInline(e);(0,a.le)(r)||i.push(r)}},s.prototype.createParagraph=function(e){var t={},i=!1;if(!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport)i=!0;else{var n=this.documentHelper.selection.end;this.documentHelper.selection.isForward||(n=this.documentHelper.selection.start);var r=n.paragraph.childWidgets[n.paragraph.childWidgets.length-1];i=this.documentHelper.selection.isParagraphLastLine(r)&&n.currentWidget===r&&n.offset===this.documentHelper.selection.getLineLength(r)+1}return t.paragraphFormat=this.writeParagraphFormat(i?e.paragraphFormat:new ue(e)),t.characterFormat=this.writeCharacterFormat(i?e.characterFormat:new ie(e)),t.inlines=[],t},s.prototype.writeCharacterFormat=function(e,t){var i={};if(w.writeCharacterFormat(i,t,e),i.boldBidi=t?e.bold:e.getValue("bold"),i.italicBidi=t?e.italic:e.getValue("italic"),i.fontSizeBidi=t?e.fontSize:e.getValue("fontSize"),i.fontFamilyBidi=t?e.fontFamily:e.getValue("fontFamily"),e.revisions.length>0){i.revisionIds=[];for(var n=0;n<e.revisions.length;n++)i.revisionIds.push(e.revisions[n].revisionID)}return this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeCharacterFormat(e,!0)),i},s.prototype.writeParagraphFormat=function(e,t){var i={};return i.borders=this.writeParagraphBorders(e.borders),i.leftIndent=t?e.leftIndent:e.getValue("leftIndent"),i.rightIndent=t?e.rightIndent:e.getValue("rightIndent"),i.firstLineIndent=t?e.firstLineIndent:e.getValue("firstLineIndent"),i.textAlignment=t?e.textAlignment:e.getValue("textAlignment"),i.beforeSpacing=t?e.beforeSpacing:e.getValue("beforeSpacing"),i.afterSpacing=t?e.afterSpacing:e.getValue("afterSpacing"),i.spaceBeforeAuto=t?e.spaceBeforeAuto:e.getValue("spaceBeforeAuto"),i.spaceAfterAuto=t?e.spaceAfterAuto:e.getValue("spaceAfterAuto"),i.lineSpacing=t?e.lineSpacing:e.getValue("lineSpacing"),i.lineSpacingType=t?e.lineSpacingType:e.getValue("lineSpacingType"),i.styleName=(0,a.le)(e.baseStyle)?void 0:e.baseStyle.name,i.outlineLevel=t?e.outlineLevel:e.getValue("outlineLevel"),i.listFormat=this.writeListFormat(e.listFormat,t),i.tabs=this.writeTabs(e.tabs),i.bidi=t?e.bidi:e.getValue("bidi"),i.keepLinesTogether=t?e.keepLinesTogether:e.getValue("keepLinesTogether"),i.keepWithNext=t?e.keepWithNext:e.getValue("keepWithNext"),i.contextualSpacing=t?e.contextualSpacing:e.getValue("contextualSpacing"),i.widowControl=t?e.widowControl:e.getValue("widowControl"),this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeParagraphFormat(e,!0)),i},s.prototype.writeTabs=function(e){if(!((0,a.le)(e)||e.length<1)){for(var t=[],i=0;i<e.length;i++){var n=e[i],r={};r.position=n.position,r.deletePosition=n.deletePosition,r.tabJustification=n.tabJustification,r.tabLeader=n.tabLeader,t.push(r)}return t}},s.prototype.writeListFormat=function(e,t){var i={},n=e.getValue("listId");(0,a.le)(n)||(i.listId=n,this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId));var r=e.getValue("listLevelNumber");return(0,a.le)(r)||(i.listLevelNumber=r),i},s.prototype.writeTable=function(e,t,i,n){var r=e.childWidgets[i];if(!(r instanceof Q&&this.writeRow(r,t.rows))){var o=e;do{o=(e=o).nextSplitWidget}while(o instanceof Ve);return(o=e.nextRenderedWidget)instanceof Ve&&o.containerWidget.index===e.containerWidget.index?o:void 0}},s.prototype.writeRow=function(e,t){var i=e;do{if((e=i)===(i=this.writeRowInternal(i,t)))return!0}while(i instanceof Q);return!1},s.prototype.writeRowInternal=function(e,t){if(!(e instanceof Q))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var i=this.createRow(e);t.push(i);for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof V&&e.index===r.rowIndex&&((0,a.le)(this.startColumnIndex)||r.columnIndex>=this.startColumnIndex)&&((0,a.le)(this.endColumnIndex)||r.columnIndex<this.endColumnIndex)&&this.writeCell(r,i.cells))return e}var o=e;do{o=(e=o).nextRenderedWidget,!(0,a.le)(e.ownerTable.bodyWidget)&&o&&(e.ownerTable.index!==o.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===o.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==o.ownerTable.bodyWidget.sectionIndex)&&(o=void 0)}while(o instanceof Q&&o.index===e.index);return o},s.prototype.writeCell=function(e,t){var i=this.createCell(e);t.push(i);var n=e.firstChild;do{n=this.writeBlock(n,0,i.blocks)}while(n);return this.endCell instanceof V&&this.endCell.cellFormat===e.cellFormat},s.prototype.createTable=function(e){for(var t={rows:[],grid:[]},i=0;i<e.tableHolder.columns.length;i++)t.grid[i]=e.tableHolder.columns[i].preferredWidth;return t.tableFormat=this.writeTableFormat(e.tableFormat),t.description=e.description,t.title=e.title,t.columnCount=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},s.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e.wrapTextAround=t.wrapTextAround,e.positioning={},e.positioning.allowOverlap=t.positioning.allowOverlap,e.positioning.distanceBottom=w.convertPixelToPoint(t.positioning.distanceBottom),e.positioning.distanceLeft=w.convertPixelToPoint(t.positioning.distanceLeft),e.positioning.distanceRight=w.convertPixelToPoint(t.positioning.distanceRight),e.positioning.distanceTop=w.convertPixelToPoint(t.positioning.distanceTop),(0,a.le)(t.positioning.verticalAlignment)||(e.positioning.verticalAlignment=t.positioning.verticalAlignment),(0,a.le)(t.positioning.verticalOrigin)||(e.positioning.verticalOrigin=t.positioning.verticalOrigin),e.positioning.verticalPosition=t.positioning.verticalPosition,(0,a.le)(t.positioning.horizontalAlignment)||(e.positioning.horizontalAlignment=t.positioning.horizontalAlignment),(0,a.le)(t.positioning.horizontalOrigin)||(e.positioning.horizontalOrigin=t.positioning.horizontalOrigin),e.positioning.horizontalPosition=t.positioning.horizontalPosition)},s.prototype.createRow=function(e){var t={cells:[]};return t.rowFormat=this.writeRowFormat(e.rowFormat),e.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(e.contentControlProperties)),t},s.prototype.createCell=function(e){var t={blocks:[]};return t.cellFormat=this.writeCellFormat(e.cellFormat),t.columnIndex=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(e.contentControlProperties)),t},s.prototype.writeShading=function(e){var t={};return t.backgroundColor=e.hasValue("backgroundColor")?e.backgroundColor:void 0,t.foregroundColor=e.hasValue("foregroundColor")?e.foregroundColor:void 0,t.textureStyle=e.hasValue("textureStyle")?e.textureStyle:void 0,t},s.prototype.writeBorder=function(e){var t={};return t.color=e.hasValue("color")?e.color:void 0,t.hasNoneStyle=e.hasValue("hasNoneStyle")?e.hasNoneStyle:void 0,t.lineStyle=e.hasValue("lineStyle")?e.lineStyle:void 0,t.lineWidth=e.hasValue("lineWidth")?e.lineWidth:void 0,t.shadow=e.hasValue("shadow")?e.shadow:void 0,t.space=e.hasValue("space")?e.space:void 0,t},s.prototype.writeParagraphBorders=function(e){var t={};return t.top=this.writeBorder(e.getBorder("top")),t.left=this.writeBorder(e.getBorder("left")),t.right=this.writeBorder(e.getBorder("right")),t.bottom=this.writeBorder(e.getBorder("bottom")),t.horizontal=this.writeBorder(e.getBorder("horizontal")),t.vertical=this.writeBorder(e.getBorder("vertical")),t},s.prototype.writeBorders=function(e){var t={};return t.top=this.writeBorder(e.top),t.left=this.writeBorder(e.left),t.right=this.writeBorder(e.right),t.bottom=this.writeBorder(e.bottom),t.diagonalDown=this.writeBorder(e.diagonalDown),t.diagonalUp=this.writeBorder(e.diagonalUp),t.horizontal=this.writeBorder(e.horizontal),t.vertical=this.writeBorder(e.vertical),t},s.prototype.writeCellFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.preferredWidth=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t.preferredWidthType=e.hasValue("preferredWidthType")?e.preferredWidthType:void 0,t.cellWidth=e.hasValue("cellWidth")?e.cellWidth:void 0,t.columnSpan=e.columnSpan,t.rowSpan=e.rowSpan,t.verticalAlignment=e.hasValue("verticalAlignment")?e.verticalAlignment:void 0,t},s.prototype.writeRowFormat=function(e){var t={},i=[];t.height=e.hasValue("height")?e.height:void 0,t.allowBreakAcrossPages=e.hasValue("allowBreakAcrossPages")?e.allowBreakAcrossPages:void 0,t.heightType=e.hasValue("heightType")?e.heightType:void 0,t.isHeader=e.hasValue("isHeader")?e.isHeader:void 0,t.borders=this.writeBorders(e.borders),t.gridBefore=e.gridBefore,t.gridBeforeWidth=e.hasValue("gridBeforeWidth")?e.gridBeforeWidth:void 0,t.gridBeforeWidthType=e.hasValue("gridBeforeWidthType")?e.gridBeforeWidthType:void 0,t.gridAfter=e.gridAfter,t.gridAfterWidth=e.hasValue("gridAfterWidth")?e.gridAfterWidth:void 0,t.gridAfterWidthType=e.hasValue("gridAfterWidthType")?e.gridAfterWidthType:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.leftIndent=e.hasValue("leftIndent")?e.leftIndent:void 0;for(var n=0;n<e.revisions.length;n++)t.revisionIds=this.writeRowRevisions(e.revisions[n],i);return t},s.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},s.prototype.writeTableFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.cellSpacing=e.hasValue("cellSpacing")?e.cellSpacing:void 0,t.leftIndent=e.hasValue("leftIndent")?e.leftIndent:void 0,t.tableAlignment=e.hasValue("tableAlignment")?e.tableAlignment:void 0,t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.preferredWidth=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t.preferredWidthType=e.hasValue("preferredWidthType")?e.preferredWidthType:void 0,t.bidi=e.hasValue("bidi")?e.bidi:void 0,t.allowAutoFit=e.hasValue("allowAutoFit")?e.allowAutoFit:void 0,t.styleName=(0,a.le)(e.styleName)?void 0:e.styleName,t},s.prototype.footnotes=function(e){for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e)},s.prototype.seprators=function(e){if(e.footnotes.separator.length>0){this.document.footnotes={},this.document.footnotes.separator=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document.footnotes.separator)}if(e.footnotes.continuationSeparator.length>0)for(this.document.footnotes.continuationSeparator=[],t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document.footnotes.continuationSeparator);if(e.footnotes.continuationNotice.length>0)for(this.document.footnotes.continuationNotice=[],t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document.footnotes.continuationNotice)},s.prototype.endnotes=function(e){for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e)},s.prototype.endnoteSeparator=function(e){if(e.endnotes.separator.length>0){this.document.endnotes={},this.document.endnotes.separator=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document.endnotes.separator)}if(e.endnotes.continuationSeparator.length>0)for(this.document.endnotes.continuationSeparator=[],t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document.endnotes.continuationSeparator);if(e.endnotes.continuationNotice.length>0)for(this.document.endnotes.continuationNotice=[],t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document.endnotes.continuationNotice)},s.prototype.writeStyles=function(e){this.document.styles=[];for(var t=0;t<e.styles.length;t++)this.document.styles.push(this.writeStyle(e.styles.getItem(t)))},s.prototype.writeStyle=function(e){var t={};return t.name=e.name,"Paragraph"===e.type&&(t.type="Paragraph",t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.characterFormat=this.writeCharacterFormat(e.characterFormat)),"Character"===e.type&&(t.type="Character",t.characterFormat=this.writeCharacterFormat(e.characterFormat)),(0,a.le)(e.basedOn)||(t.basedOn=e.basedOn.name),(0,a.le)(e.link)||(t.link=e.link.name),(0,a.le)(e.next)||(t.next=e.next.name),t},s.prototype.writeRevisions=function(e){this.document.revisions=[];for(var t=0;t<e.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&!this.owner.enableTrackChanges&&-1!==this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))&&this.document.revisions.push(this.writeRevision(e.owner.revisions.changes[t]))},s.prototype.writeRevision=function(e){var t={};return t.author=e.author,t.date=e.date,t.revisionType=e.revisionType,t.revisionId=e.revisionID,t},s.prototype.writeComments=function(e){this.document.comments=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document.comments.push(this.writeComment(this.documentHelper.comments[t]))},s.prototype.writeCustomXml=function(e){this.document.customXml=[];for(var t=0;t<e.customXmlData.length;t++){var i={},n=e.customXmlData.keys[t];i.itemID=n;var r=this.documentHelper.customXmlData.get(n);i.xml=r,this.document.customXml.push(i)}},s.prototype.writeComment=function(e){var t={};t.commentId=e.commentId,t.author=e.author,t.date=e.date,t.blocks=[],t.blocks.push(this.commentInlines(e.text)),t.done=e.isResolved,t.replyComments=[];for(var i=0;i<e.replyComments.length;i++)t.replyComments.push(this.writeComment(e.replyComments[i]));return t},s.prototype.commentInlines=function(e){var t={};return t.inlines=[{text:e}],t},s.prototype.writeLists=function(e){var t=[];this.document.lists=[];for(var i=0;i<e.lists.length;i++){var n=e.lists[i];this.lists.indexOf(n.listId)>-1&&(this.document.lists.push(this.writeList(n)),t.indexOf(n.abstractListId)<0&&t.push(n.abstractListId))}for(this.document.abstractLists=[],i=0;i<e.abstractLists.length;i++){var r=e.abstractLists[i];t.indexOf(r.abstractListId)>-1&&this.document.abstractLists.push(this.writeAbstractList(r))}},s.prototype.writeAbstractList=function(e){var t={};t.abstractListId=e.abstractListId,t.levels=[];for(var i=0;i<e.levels.length;i++)t.levels[i]=this.writeListLevel(e.levels[i]);return t},s.prototype.writeList=function(e){var t={};t.abstractListId=e.abstractListId,t.levelOverrides=[];for(var i=0;i<e.levelOverrides.length;i++)t.levelOverrides.push(this.writeLevelOverrides(e.levelOverrides[i]));return t.listId=e.listId,t},s.prototype.writeLevelOverrides=function(e){var t={};return t.levelNumber=e.levelNumber,e.overrideListLevel&&(t.overrideListLevel=this.writeListLevel(e.overrideListLevel)),t.startAt=e.startAt,t},s.prototype.writeListLevel=function(e){var t={};return t.characterFormat=this.writeCharacterFormat(e.characterFormat),t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.followCharacter=e.followCharacter,t.listLevelPattern=e.listLevelPattern,t.numberFormat=e.numberFormat,t.restartLevel=e.restartLevel,t.startAt=e.startAt,t},s.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e},s.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},s.prototype.destroy=function(){this.lists=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0},s}(),Ss=function(){function s(e){var t=this;this.list=void 0,this.noteNumberFormat=void 0,this.sectionFormat=void 0,this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus(),t.unWireEventsAndBindings()},this.loadFontDialog=function(){var i,n;if(t.documentHelper.updateFocus(),n=t.sectionFormat?t.sectionFormat:t.documentHelper.owner.selection.sectionFormat,t.documentHelper.selection.isinFootnote){var o=n.initialFootNoteNumber;i=t.reversetype(n.footNoteNumberFormat),t.notesList.value=i,t.startValueTextBox.value=o}else i=t.reversetype(n.endnoteNumberFormat),o=n.initialEndNoteNumber,t.notesList.value=i,t.startValueTextBox.value=o},this.onInsertFootnoteClick=function(){var i=new je(void 0);if(!(0,a.le)(t.notesList)){var n=t.notesList.value.toString(),r=t.types(n),o=t.startValueTextBox.value;(0,a.le)(t.notesList)||(t.documentHelper.selection.isinFootnote?(i.footNoteNumberFormat=r,i.footNoteNumberFormat=r,i.initialFootNoteNumber=o,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,i)):(i.endnoteNumberFormat=r,i.endnoteNumberFormat=r,i.initialEndNoteNumber=o,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,i)))}t.documentHelper.hideDialog()},this.unWireEventsAndBindings=function(){t.notesList.value=void 0},this.documentHelper=e}return s.prototype.getModuleName=function(){return"FootNotesDialog"},s.prototype.notesDialog=function(e,t){this.target=(0,a.az)("div",{id:this.documentHelper.owner.containerId+"_insert_Footnote",className:"e-de-insert-footnote"});var n=(0,a.az)("div"),r=(0,a.az)("div");this.footCount=(0,a.az)("input",{attrs:{type:"text"},id:this.documentHelper.owner.containerId+"row"}),r.appendChild(this.footCount);var o=(0,a.az)("div",{className:"e-de-container-row"}),l=(0,a.az)("select",{id:this.target.id+"_papersize",styles:"padding-bottom: 20px;",innerHTML:'<option value="1, 2, 3, ...">'+e.getConstant("1, 2, 3, ...")+'</option><option value="a, b, c, ...">'+e.getConstant("a, b, c, ...")+'</option><option value="A, B, C, ...">'+e.getConstant("A, B, C, ...")+'</option><option value="I, II, III, ...">'+e.getConstant("I, II, III, ...")+'</option><option value="i, ii, iii, ...">'+e.getConstant("i, ii, iii, ...")+"</option>"});o.appendChild(l),this.notesList=new Te.NB({enableRtl:t,placeholder:e.getConstant("Start at"),floatLabelType:"Always"}),this.notesList.appendTo(l),n.appendChild(o),n.appendChild(r),this.target.appendChild(n),this.startValueTextBox=new J.No({format:"#",min:1,max:99999,enablePersistence:!1,placeholder:e.getConstant("Number format"),floatLabelType:"Always"}),this.startValueTextBox.appendTo(this.footCount)},s.prototype.show=function(){var e=new a.E7("documenteditor",this.documentHelper.owner.defaultLocale);if(e.setLocale(this.documentHelper.owner.locale),this.target||this.notesDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant(this.documentHelper.selection.isinFootnote?"Footnote":"Endnote"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFootnoteClick,buttonModel:{content:e.getConstant("Apply"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.startValueTextBox.value=1,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.documentHelper.selection.isinEndnote){var t=this.endnoteListValue(this.list);this.notesList.index=t}},s.prototype.types=function(e){switch(e){case"1, 2, 3, ...":default:return"Arabic";case"A, B, C, ...":return"UpperCaseLetter";case"a, b, c, ...":return"LowerCaseLetter";case"I, II, III, ...":return"LowerCaseRoman";case"i, ii, iii, ...":return"UpperCaseRoman"}},s.prototype.reversetype=function(e){switch(e){case"Arabic":default:return"1, 2, 3, ...";case"UpperCaseLetter":return"A, B, C, ...";case"LowerCaseLetter":return"a, b, c, ...";case"UpperCaseRoman":return"I, II, III, ...";case"LowerCaseRoman":return"i, ii, iii, ..."}},s.prototype.endnoteListValue=function(e){return"A, B, C, ..."===e?0:"1, 2, 3, ..."===e?1:"a, b, c, ..."===e?2:3},s.prototype.destroy=function(){this.footCount&&(this.footCount.parentElement&&this.footCount.parentElement.removeChild(this.footCount),this.footCount=void 0),this.startValueTextBox&&(this.startValueTextBox.destroy(),this.startValueTextBox=void 0),this.notesList&&(this.notesList.destroy(),this.notesList=void 0),this.footCount=void 0,this.documentHelper=void 0},s}(),Ct=function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),D=function(s,e,t,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(s,e,t,i);else for(var l=s.length-1;l>=0;l--)(o=s[l])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Or=function(s){function e(){return null!==s&&s.apply(this,arguments)||this}return Ct(e,s),D([(0,a.Z9)("#FFE97F")],e.prototype,"searchHighlightColor",void 0),D([(0,a.Z9)(["Algerian","Arial","Calibri","Cambria","Cambria Math","Candara","Courier New","Georgia","Impact","Segoe Print","Segoe Script","Segoe UI","Symbol","Times New Roman","Verdana","Wingdings"])],e.prototype,"fontFamilies",void 0),D([(0,a.Z9)({shadingColor:"#cfcfcf",applyShading:!0,selectionColor:"#cccccc",formFillingMode:"Popup"})],e.prototype,"formFieldSettings",void 0),D([(0,a.Z9)({roomName:"",editableRegionColor:"#22b24b",lockedRegionColor:"#f44336"})],e.prototype,"collaborativeEditingSettings",void 0),D([(0,a.Z9)(1)],e.prototype,"printDevicePixelRatio",void 0),D([(0,a.Z9)(!0)],e.prototype,"enableOptimizedTextMeasuring",void 0),D([(0,a.Z9)(32767)],e.prototype,"maximumRows",void 0),D([(0,a.Z9)(!1)],e.prototype,"showHiddenMarks",void 0),e}(a.rt),zr=function(s){function e(){return null!==s&&s.apply(this,arguments)||this}return Ct(e,s),D([(0,a.Z9)("Word2013")],e.prototype,"compatibilityMode",void 0),e}(a.rt),Ps=function(s){function e(i,n){var r=s.call(this,i,n)||this;return r.enableHeaderFooterIn=!1,r.isShiftingEnabled=!1,r.isLayoutEnabled=!0,r.isPastingContent=!1,r.parser=void 0,r.disableHistoryIn=!1,r.findResultsList=void 0,r.tablePropertiesDialogModule=void 0,r.bordersAndShadingDialogModule=void 0,r.cellOptionsDialogModule=void 0,r.tableOptionsDialogModule=void 0,r.paragraphDialogModule=void 0,r.imageResizerModule=void 0,r.createdTriggered=!1,r.defaultLocale={Table:"Table",Row:"Row",Cell:"Cell",Ok:"OK",Apply:"Apply",Cancel:"Cancel",Size:"Size","Preferred Width":"Preferred width",Points:"Points",Percent:"Percent","Measure in":"Measure in",Alignment:"Alignment",Left:"Left",Center:"Center",Right:"Right",Justify:"Justify","Indent from left":"Indent from left","Borders and Shading":"Borders and Shading",Options:"Options","Specify height":"Specify height","At least":"At least",Exactly:"Exactly","Row height is":"Row height is","Allow row to break across pages":"Allow row to break across pages","Repeat as header row at the top of each page":"Repeat as header row at the top of each page","Vertical alignment":"Vertical alignment",Top:"Top",Bottom:"Bottom","Default cell margins":"Default cell margins","Default cell spacing":"Default cell spacing","Allow spacing between cells":"Allow spacing between cells","Cell margins":"Cell margins","Same as the whole table":"Same as the whole table",Borders:"Borders",None:"None",Style:"Style",Width:"Width",Height:"Height",Letter:"Letter","1, 2, 3, ...":"1, 2, 3, ...","a, b, c, ...":"a, b, c, ...","A, B, C, ...":"A, B, C, ...","I, II, III, ...":"I, II, III, ...","i, ii, iii, ...":"i, ii, iii, ...",Tabloid:"Tabloid",Legal:"Legal",Statement:"Statement",Executive:"Executive",A3:"A3",A4:"A4",A5:"A5",B4:"B4",B5:"B5","Custom Size":"Custom size","Different odd and even":"Different odd and even","Different first page":"Different first page","From edge":"From edge",Header:"Header",Footer:"Footer","First Page Header":"First Page Header","First Page Footer":"First Page Footer","Even Page Header":"Even Page Header","Even Page Footer":"Even Page Footer","Odd Page Header":"Odd Page Header","Odd Page Footer":"Odd Page Footer",Margin:"Margins",Paper:"Paper",Layout:"Layout",Orientation:"Orientation",Landscape:"Landscape",Portrait:"Portrait","Show page numbers":"Show page numbers","Right align page numbers":"Right align page numbers",Nothing:"Nothing","Tab leader":"Tab leader","Show levels":"Show levels","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers","Build table of contents from":"Build table of contents from",Styles:"Styles","Available styles":"Available styles","TOC level":"TOC level",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","List Paragraph":"List Paragraph",Normal:"Normal","Outline levels":"Outline levels","Table entry fields":"Table entry fields",Modify:"Modify",Color:"Color",Setting:"Setting",Box:"Box",All:"All",Custom:"Custom",Preview:"Preview",Shading:"Shading",Fill:"Fill","Apply To":"Apply to","Table Properties":"Table Properties","Cell Options":"Cell Options","Table Options":"Table Options","Insert Table":"Insert Table","Number of columns":"Number of columns","Number of rows":"Number of rows","Text to display":"Text to display","ScreenTip text":"ScreenTip text",Address:"Address","Insert Hyperlink":"Insert Hyperlink","Edit Hyperlink":"Edit Hyperlink",Insert:"Insert",General:"General",Indentation:"Indentation","Before text":"Before text",Special:"Special","First line":"First line",Hanging:"Hanging","After text":"After text",By:"By",Before:"Before","Line Spacing":"Line spacing",After:"After",At:"At",Multiple:"Multiple",Spacing:"Spacing","Define new Multilevel list":"Define new Multilevel list","List level":"List level","Choose level to modify":"Choose level to modify",Level:"Level","Number format":"Number format","Number style for this level":"Number style for this level","Enter formatting for number":"Enter formatting for number","Start at":"Start at","Restart list after":"Restart list after",Position:"Position","Text indent at":"Text indent at","Aligned at":"Aligned at","Follow number with":"Follow number with","Tab character":"Tab character",Space:"Space",Arabic:"Arabic",UpRoman:"UpRoman",LowRoman:"LowRoman",UpLetter:"UpLetter",LowLetter:"LowLetter",Number:"Number","Leading zero":"Leading zero",Bullet:"Bullet",Ordinal:"Ordinal","Ordinal Text":"Ordinal Text","For East":"For East","No Restart":"No Restart",Font:"Font","Font style":"Font style","Underline style":"Underline style","Font color":"Font color",Effects:"Effects",Strikethrough:"Strikethrough",Superscript:"Superscript",Subscript:"Subscript","Double strikethrough":"Double strikethrough",Regular:"Regular",Bold:"Bold",Italic:"Italic",Cut:"Cut",Copy:"Copy",Paste:"Paste",Hyperlink:"Hyperlink","Open Hyperlink":"Open Hyperlink","Copy Hyperlink":"Copy Hyperlink","Remove Hyperlink":"Remove Hyperlink",Paragraph:"Paragraph","Linked Style":"Linked(Paragraph and Character)",Character:"Character","Merge Cells":"Merge Cells","Insert Above":"Insert Above","Insert Below":"Insert Below","Insert Left":"Insert Left","Insert Right":"Insert Right",Delete:"Delete","Delete Table":"Delete Table","Delete Row":"Delete Row","Delete Column":"Delete Column","File Name":"File Name","Format Type":"Format Type",Save:"Save",Navigation:"Navigation",Results:"Results",Replace:"Replace","Replace All":"Replace All","We replaced all":"We replaced all",Find:"Find","No matches":"No matches","All Done":"All Done",Result:"Result",of:"of",instances:"instances",with:"with","Click to follow link":"Click to follow link","Continue Numbering":"Continue Numbering","Bookmark name":"Bookmark name",Close:"Close","Restart At":"Restart At",Properties:"Properties",Name:"Name","Style type":"Style type","Style based on":"Style based on","Style for following paragraph":"Style for following paragraph",Formatting:"Formatting","Numbering and Bullets":"Numbering and Bullets",Numbering:"Numbering","Update Field":"Update Field","Edit Field":"Edit Field",Bookmark:"Bookmark","Page Setup":"Page Setup","No bookmarks found":"No bookmarks found","Number format tooltip information":'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "Chapter %1." will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>\u2026</br>Chapter N. Item</br></br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "%1.%2." will display numbering like</br>1.1. Item</br>1.2. Item</br>\u2026</br>1.N. Item',Format:"Format","Create New Style":"Create New Style","Modify Style":"Modify Style",New:"New",InsertFootnote:"InsertFootnote",InsertEndnote:"InsertEndnote",Footnote:"Footnote",Endnote:"Endnote","Notes Options":"Notes Options",Bullets:"Bullets","Use bookmarks":"Use bookmarks","Table of Contents":"Table of Contents",AutoFit:"AutoFit","AutoFit to Contents":"AutoFit to Contents","AutoFit to Window":"AutoFit to Window","Fixed Column Width":"Fixed Column Width",Reset:"Reset","Match case":"Match case","Whole words":"Whole words",Add:"Add","Go To":"Go To","Search for":"Search for","Replace with":"Replace with","TOC 1":"TOC 1","TOC 2":"TOC 2","TOC 3":"TOC 3","TOC 4":"TOC 4","TOC 5":"TOC 5","TOC 6":"TOC 6","TOC 7":"TOC 7","TOC 8":"TOC 8","TOC 9":"TOC 9","Right-to-left":"Right-to-left","Left-to-right":"Left-to-right",Direction:"Direction","Table direction":"Table direction","Indent from right":"Indent from right","Contextual Spacing":"Don't add space between paragraphs of the same style","Password Mismatch":"The password don't match","Restrict Editing":"Restrict Editing","Formatting restrictions":"Formatting restrictions","Allow formatting":"Allow formatting","Editing restrictions":"Editing restrictions","Read only":"Read only","Exceptions Optional":"Exceptions (optional)","Select Part Of Document And User":"Select parts of the document and choose users who are allowed to freely edit them.",Everyone:"Everyone","More users":"More users","Add Users":"Add Users","Enforcing Protection":"Yes, Start Enforcing Protection","Start Enforcing Protection":"Start Enforcing Protection","Enter User":"Enter User",Users:"Users","Enter new password":"Enter new password","Reenter new password to confirm":"Reenter new password to confirm","Your permissions":"Your permissions","Protected Document":"This document is protected from unintentional editing.",FormFieldsOnly:"You may only fill in forms in this region.",CommentsOnly:"You may only insert comments into this region.",ReadOnlyProtection:"You may edit in this region.","Stop Protection":"Stop Protection",Password:"Password","Spelling Editor":"Spelling Editor",Spelling:"Spelling","Spell Check":"Spell Check","Underline errors":"Underline errors",Ignore:"Ignore","Ignore All":"Ignore All","Add to Dictionary":"Add to Dictionary",Change:"Change","Change All":"Change All",Suggestions:"Suggestions","The password is incorrect":"The password is incorrect","Error in establishing connection with web server":"Error in establishing connection with web server","Highlight the regions I can edit":"Highlight the regions I can edit","Show All Regions I Can Edit":"Show All Regions I Can Edit","Find Next Region I Can Edit":"Find Next Region I Can Edit","Keep source formatting":"Keep source formatting","Match destination formatting":"Match destination formatting",InsertAsRows:"Insert as New Rows",InsertAsColumns:"Insert as New Columns",OverwriteCells:"Overwrite Cells",NestTable:"Nest Table","Text only":"Text only",Comments:"Comments","Type your comment":"Type your comment",Post:"Post",Reply:"Reply","New Comment":"New Comment",Edit:"Edit",Resolve:"Resolve",Reopen:"Reopen","No comments in this document":"No comments in this document",more:"more","Type your comment here":"Type your comment here","Next Comment":"Next Comment","Previous Comment":"Previous Comment","Un-posted comments":"Un-posted comments","Discard Comment":"Added comments not posted. If you continue, that comment will be discarded.","No Headings":"No Heading Found!","Add Headings":"This document has no headings. Please add headings and try again.","More Options":"More Options","Click to see this comment":"Click to see this comment","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box","Drop Down Form Field":"Drop Down Form Field","Dropdown items":"Drop-down items","Items in dropdown list":"Items in drop-down list",ADD:"ADD",REMOVE:"REMOVE","Field settings":"Field settings",Tooltip:"Tooltip","Dropdown enabled":"Drop-down enabled","Check Box Form Field":"Check Box Form Field","Check box size":"Check box size",Auto:"Auto","Default value":"Default value","Not checked":"Not checked",Checked:"Checked","Check box enabled":"Check box enabled","Text Form Field":"Text Form Field",Type:"Type","Default text":"Default text","Maximum length":"Maximum length","Text format":"Text format","Fillin enabled":"Fill-in enabled","Default number":"Default number","Default date":"Default date","Date format":"Date format","Merge Track":"This action wont be marked as change. Do you want to continue?",UnTrack:"Cannot be tracked !",Accept:"Accept",Reject:"Reject","Previous Changes":"Previous Changes","Next Changes":"Next Changes",Inserted:"Inserted",Deleted:"Deleted","Move From":"Move From","Move To":"Move To",Changes:"Changes","Accept all":"Accept all","Reject all":"Reject all","No changes":"No changes","Accept Changes":"Accept Changes","Reject Changes":"Reject Changes",User:"User",View:"View",Insertion:"Insertion",Deletion:"Deletion","All caps":"All caps","This region is locked by":"This region is locked by",Lock:"Lock",Unlock:"Unlock","Already locked":"Selected or part of region is already locked by another user","Click to View/Edit Footnote":"Click to View/Edit Footnote","Click to View/Edit Endnote":"Click to View/Edit Endnote","Multiple Comment":"Please post your comment","No suggestions":"No suggestions","More Suggestion":"More Suggestion","Ignore Once":"Ignore Once","Keep With Next":"Keep with next","Keep Lines Together":"Keep lines together",WidowControl:"Widow/Orphan control","Indents and Spacing":"Indents and Spacing","Line and Page Breaks":"Line and Page Breaks",Pagination:"Pagination",Single:"Single",DashSmallGap:"DashSmallGap",DashDot:"DashDot",Double:"Double",ThinThickSmallGap:"ThinThickSmallGap",ThickThinSmallGap:"ThickThinSmallGap",ThickThinMediumGap:"ThickThinMediumGap",ThickThinLargeGap:"ThickThinLargeGap",SingleWavy:"SingleWavy",DoubleWavy:"DoubleWavy",Inset:"Inset",DashLargeGap:"DashLargeGap",Dot:"Dot",DashDotDot:"DashDotDot",Triple:"Triple",ThinThickThinSmallGap:"ThinThickThinSmallGap",ThinThickThinMediumGap:"ThinThickThinMediumGap",ThinThickThinLargeGap:"ThinThickThinLargeGap",DashDotStroked:"DashDotStroked",Engrave3D:"Engrave3D",Thick:"Thick",Outset:"Outset",Emboss3D:"Emboss3D",ThinThickLargeGap:"ThinThickLargeGap",ThinThickMediumGap:"ThinThickMediumGap","Number of rows must be between 1 and 32767.":"Number of rows must be between 1 and 32767.","Number of columns must be between 1 and 63.":"Number of columns must be between 1 and 63.",Unlimited:"Unlimited","Regular text":"Regular text",Date:"Date",Uppercase:"Uppercase",Lowercase:"Lowercase",FirstCapital:"FirstCapital",TitleCase:"Titlecase","Filling in forms":"Filling in forms",px:"px","Tracked changes":"Tracked changes",TrackChangesOnly:"You may edit in this region, but all change will be tracked.",RemovedIgnoreExceptions:"If you make this change in document protection, Word will ignore all the exceptions in this document.",RemovedIgnore:"Do you want to remove the ignored exceptions?",Information:"Information",Yes:"Yes",No:"No","Page Break":"Page Break","Section Break Next Page":"Section Break (Next Page)","Unsupported format":"The file format you have selected isn't supported. Please choose valid format."},r.initHelper(),r}var t;return Ct(e,s),t=e,Object.defineProperty(e.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(i){this.enableHeaderFooterIn=i,!i&&this.selection&&this.selection.isWebLayout&&(this.selection.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||(0,a.le)(this.viewer)||this.viewer instanceof Se?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextMenu",{get:function(){return this.contextMenuModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellCheckDialog",{get:function(){return this.spellCheckDialogModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){return this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(i){this.isDocumentLoadedIn=i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"revisions",{get:function(){return(0,a.le)(this.revisionsInternal)&&(this.revisionsInternal=new xo(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!(0,a.le)(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentStart",{get:function(){if(!(0,a.le)(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentEnd",{get:function(){if(!(0,a.le)(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||(0,a.le)(this.editorModule)||(0,a.le)(this.selectionModule)||!(0,a.le)(this.editor)&&this.editor.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellChecker.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!(0,a.le)(this.imageResizerModule)},enumerable:!0,configurable:!0}),e.prototype.preRender=function(){t.Inject(this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?Xi:Ar),this.findResultsList=[],!(0,a.le)(this.element)&&""===this.element.id&&(this.element.id=w.getUniqueElementId()),this.refreshing&&this.initHelper()},e.prototype.initHelper=function(){this.documentHelper=new No(this),this.viewer="Pages"===this.layoutType?new ye(this):new Se(this),this.parser=new Ts(this.documentHelper)},e.prototype.render=function(){if(!(0,a.le)(this.element)){var i=this.element;i.style.minHeight="200px",i.style.minWidth="200px",""!==this.height&&(this.element.style.height=(0,a.Ac)(this.height)),""!==this.width&&(this.element.style.width=(0,a.Ac)(this.width))}this.textMeasureHelper=this.optimizedModule?this.optimizedModule:this.regularModule,(0,a.le)(this.textMeasureHelper)&&(this.textMeasureHelper=new Xi(this.documentHelper)),this.documentHelper.initializeComponents(),this.openBlank(),this.renderComplete(),this.createdTriggered=!0},e.prototype.getModuleName=function(){return"DocumentEditor"},e.prototype.onPropertyChanged=function(i,n){for(var r=this,o=0,l=Object.keys(i);o<l.length;o++)switch(l[o]){case"enableTrackChanges":this.documentHelper.isTrackedOnlyMode&&!i.enableTrackChanges&&(this.enableTrackChanges=!0);break;case"zoomFactor":this.viewer&&n.zoomFactor!==i.zoomFactor&&(this.documentHelper.zoomFactor=i.zoomFactor);break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new ye(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new Se(this)),this.selection.start.paragraph.containerWidget instanceof Y&&(this.selection.clearSelectionHighlightInSelectedWidgets(),this.selection.selectContent(this.documentStart,!0)),this.editor.layoutWholeDocument(!0),setTimeout(function(){r.fireViewChange()},200);break;case"locale":this.localizeDialogs();break;case"isReadOnly":!(0,a.le)(this.optionsPaneModule)&&this.optionsPaneModule.isOptionsPaneShow&&this.optionsPaneModule.showHideOptionsPane(!1),this.showComments&&this.commentReviewPane.showHidePane(!0,"Comments"),this.commentReviewPane.enableDisableItems(),this.trackChangesPane.enableDisableButton(!this.isReadOnly&&!this.documentHelper.isDocumentProtected);break;case"currentUser":case"userColor":this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion(),this.viewer.updateScrollBars();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":this.documentHelper.dialog&&(this.documentHelper.dialog.zIndex=i.zIndex+10),this.documentHelper.dialog2&&(this.documentHelper.dialog2.zIndex=i.zIndex);break;case"showComments":this.viewer&&i.showComments!==n.showComments&&this.documentHelper.showComments(i.showComments),this.viewer.updateScrollBars();break;case"enableRtl":this.localizeDialogs(i.enableRtl);break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(i.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?this.documentHelper.showRevisions(!1):this.viewer&&this.documentHelper.showRevisions(i.showRevisions),this.viewer.updateScrollBars();break;case"documentSettings":if(!(0,a.le)(i.documentSettings.compatibilityMode)){var c=n.documentSettings.compatibilityMode,u=i.documentSettings.compatibilityMode;("Word2013"==c&&"Word2013"!=u||"Word2013"!=c&&"Word2013"==u)&&this.documentHelper.compatibilityMode!==u&&(this.documentHelper.compatibilityMode=u,this.editor.layoutWholeDocument(!0))}this.viewer.updateScrollBars();break;case"documentEditorSettings":(0,a.le)(i.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentHelper.heightInfoCollection={},this.textMeasureHelper=i.documentEditorSettings.enableOptimizedTextMeasuring?this.optimizedModule:this.regularModule,this.viewer.updateScrollBars()),!(0,a.le)(i.documentEditorSettings.showHiddenMarks)&&i.documentEditorSettings.showHiddenMarks!==n.documentEditorSettings.showHiddenMarks&&this.viewer.updateScrollBars();break;case"height":this.element.style.height=(0,a.Ac)(this.height),this.resize();break;case"width":this.element.style.width=(0,a.Ac)(this.width),this.resize()}},e.prototype.localizeDialogs=function(i){if(""!==this.locale){var n=new a.E7("documenteditor",this.defaultLocale);n.setLocale(this.locale),(0,a.le)(i)||(this.documentHelper.dialog.enableRtl=i,this.documentHelper.dialog2.enableRtl=i),this.optionsPaneModule&&this.optionsPaneModule.initOptionsPane(n,i),this.paragraphDialogModule&&this.paragraphDialogModule.initParagraphDialog(n),this.footNotesDialogModule&&this.footNotesDialogModule.notesDialog(n,i),this.pageSetupDialogModule&&this.pageSetupDialogModule.initPageSetupDialog(n,i),this.fontDialogModule&&this.fontDialogModule.initFontDialog(n,i),this.hyperlinkDialogModule&&this.hyperlinkDialogModule.initHyperlinkDialog(n,i),this.contextMenuModule&&(this.contextMenuModule.contextMenuInstance.destroy(),this.contextMenuModule.initContextMenu(n,i)),this.listDialogModule&&this.listDialogModule.initListDialog(n,i),this.tablePropertiesDialogModule&&this.tablePropertiesDialogModule.initTablePropertyDialog(n,i),this.bordersAndShadingDialogModule&&this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(n,i),this.cellOptionsDialogModule&&this.cellOptionsDialogModule.initCellMarginsDialog(n,i),this.tableOptionsDialogModule&&this.tableOptionsDialogModule.initTableOptionsDialog(n,i),this.tableDialogModule&&this.tableDialogModule.initTableDialog(n),this.styleDialogModule&&this.styleDialogModule.initStyleDialog(n,i),this.tableOfContentsDialogModule&&this.tableOfContentsDialogModule.initTableOfContentDialog(n,i),this.commentReviewPane&&this.commentReviewPane.parentPaneElement&&(this.enableRtl?(0,a.s1)(this.commentReviewPane.parentPaneElement,["e-rtl"],[]):(0,a.s1)(this.commentReviewPane.parentPaneElement,[],["e-rtl"]))}},e.prototype.setDefaultCharacterFormat=function(i){this.characterFormat=i},e.prototype.setDefaultParagraphFormat=function(i){this.paragraphFormat=i},e.prototype.setDefaultSectionFormat=function(i){this.sectionFormat=i},e.prototype.getPersistData=function(){return"documenteditor"},e.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof fi&&this.documentHelper.clearDocumentItems()},e.prototype.getDocumentEditorElement=function(){return this.element},e.prototype.fireContentChange=function(){this.enableLockAndEdit&&this.collaborativeEditingModule&&this.collaborativeEditingModule.saveContent(),this.trigger(Tn,{source:this})},e.prototype.fireDocumentChange=function(){this.enableLockAndEdit&&this.enableEditor&&this.editor.enforceProtection("",!1,!0),this.trigger(Sn,{source:this})},e.prototype.fireSelectionChange=function(){!this.documentHelper.isCompositionStart&&a.AR.isDevice&&this.editorModule&&this.editorModule.predictText(),this.trigger(Pn,{source:this})},e.prototype.fireZoomFactorChange=function(){var i={source:this};this.trigger("zoomFactorChange",i),this.notify(oi,i)},e.prototype.fireBeformFieldFill=function(){this.trigger("beforeFieldFill",{})},e.prototype.fireAfterFormFieldFill=function(){this.trigger("afterFieldFill",{})},e.prototype.fireServiceFailure=function(i){this.trigger(In,i)},e.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var i=this.viewer.visiblePages,n={startPage:i[0].index+1,endPage:i[i.length-1].index+1,source:this};this.trigger("viewChange",n),this.notify(di,n)}},e.prototype.fireCustomContextMenuSelect=function(i){this.trigger(Ln,{id:i})},e.prototype.fireCustomContextMenuBeforeOpen=function(i){this.trigger(En,{ids:i})},e.prototype.showParagraphDialog=function(i){this.paragraphDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.paragraphDialogModule.show(i)},e.prototype.showPageSetupDialog=function(){this.pageSetupDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.pageSetupDialogModule.show()},e.prototype.showFootNotesDialog=function(){this.footNotesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.footNotesDialogModule.show()},e.prototype.showFontDialog=function(i){this.fontDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.fontDialogModule.showFontDialog(i)},e.prototype.showCellOptionsDialog=function(){this.cellOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.cellOptionsDialogModule.show()},e.prototype.showTableOptionsDialog=function(){this.tableOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOptionsDialogModule.show()},e.prototype.showTableDialog=function(){this.tableDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableDialogModule.show()},e.prototype.showTableOfContentsDialog=function(){this.tableOfContentsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOfContentsDialogModule.show()},e.prototype.showStyleDialog=function(){this.styleDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.styleDialogModule.show()},e.prototype.showHyperlinkDialog=function(){this.hyperlinkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.hyperlinkDialogModule.show()},e.prototype.showBookmarkDialog=function(){this.bookmarkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bookmarkDialogModule.show()},e.prototype.showStylesDialog=function(){this.stylesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.stylesDialogModule.show()},e.prototype.showListDialog=function(){this.listDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.listDialogModule.showListDialog()},e.prototype.showTablePropertiesDialog=function(){this.tablePropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tablePropertiesDialogModule.show()},e.prototype.showBordersAndShadingDialog=function(){this.bordersAndShadingDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bordersAndShadingDialogModule.show()},e.prototype.requiredModules=function(){var i=[];return this.enableLockAndEdit&&i.push({member:"CollaborativeEditing",args:[this]}),this.enablePrint&&i.push({member:"Print",args:[]}),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&i.push({member:"SfdtExport",args:[this.documentHelper]}),this.enableWordExport&&i.push({member:"WordExport",args:[]}),this.enableTextExport&&i.push({member:"TextExport",args:[]}),(this.enableSelection||this.enableSearch||this.enableEditor)&&(i.push({member:"Selection",args:[this]}),this.enableContextMenu&&i.push({member:"ContextMenu",args:[this.documentHelper]})),this.enableSearch&&(i.push({member:"Search",args:[this]}),this.enableOptionsPane&&i.push({member:"OptionsPane",args:[this.documentHelper]})),this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?(t.Inject(Xi),i.push({member:"Optimized",args:[this.documentHelper]})):(t.Inject(Ar),i.push({member:"Regular",args:[this.documentHelper]})),this.enableEditor&&(i.push({member:"Editor",args:[this.documentHelper]}),this.enableImageResizer&&i.push({member:"ImageResizer",args:[this,this.documentHelper]}),this.enableEditorHistory&&i.push({member:"EditorHistory",args:[this]}),this.enableHyperlinkDialog&&i.push({member:"HyperlinkDialog",args:[this.documentHelper]}),this.enableTableDialog&&i.push({member:"TableDialog",args:[this.documentHelper]}),this.enableBookmarkDialog&&i.push({member:"BookmarkDialog",args:[this.documentHelper]}),this.enableTableOfContentsDialog&&i.push({member:"TableOfContentsDialog",args:[this.documentHelper]}),this.enablePageSetupDialog&&i.push({member:"PageSetupDialog",args:[this.documentHelper]}),this.enableFootnoteAndEndnoteDialog&&i.push({member:"FootNotesDialog",args:[this.documentHelper]}),this.enableStyleDialog&&(i.push({member:"StylesDialog",args:[this.documentHelper]}),i.push({member:"StyleDialog",args:[this.documentHelper]}),i.push({member:"BulletsAndNumberingDialog",args:[this.documentHelper]})),this.enableListDialog&&i.push({member:"ListDialog",args:[this.documentHelper]}),this.enableParagraphDialog&&i.push({member:"ParagraphDialog",args:[this.documentHelper]}),this.enableFontDialog&&i.push({member:"FontDialog",args:[this.documentHelper]}),this.enableTablePropertiesDialog&&(i.push({member:"TablePropertiesDialog",args:[this.documentHelper]}),i.push({member:"CellOptionsDialog",args:[this.documentHelper]})),this.enableBordersAndShadingDialog&&i.push({member:"BordersAndShadingDialog",args:[this.documentHelper]}),this.enableTableOptionsDialog&&i.push({member:"TableOptionsDialog",args:[this.documentHelper]}),this.enableSpellCheck&&(i.push({member:"SpellChecker",args:[this.documentHelper]}),i.push({member:"SpellCheckDialog",args:[this.documentHelper]})),this.enableFormField&&(i.push({member:"TextFormFieldDialog",args:[this]}),i.push({member:"DropDownFormFieldDialog",args:[this]}),i.push({member:"CheckBoxFormFieldDialog",args:[this]}))),i},e.prototype.open=function(i){(0,a.le)(this.viewer)||(this.showComments=!1,this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new pi,this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!(0,a.le)(i)&&this.viewer&&(this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(i)),this.editorModule&&this.editorModule.intializeDefaultStyles()),this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1))},e.prototype.scrollToPage=function(i){return!((0,a.le)(this.viewer)||i<1||i>this.documentHelper.pages.length||(this.viewer.scrollToPage(i-1),0))},e.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enableFootnoteAndEndnoteDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableSpellCheck=this.enableComment=this.enableFormField=!0,t.Inject(Wn,Zi,Br,Mr,Nr,kr,Ir,Lr,Hr,dr,Wr,cr,ur,Ss,pr,fr,gr,br,yr,mr,_i,wr,Cr,Fr,xr,qi,Tr,Dr,Sr,es,ts,is)},e.prototype.resize=function(i,n){this.element&&(!(0,a.le)(i)&&i>200&&(this.element.style.width=i+"px"),!(0,a.le)(n)&&n>200&&(this.element.style.height=n+"px"),this.viewer&&this.documentHelper.updateViewerSize(),this.trackChangesPane.toolbar&&this.trackChangesPane.toolbar.refreshOverflow())},e.prototype.getFormFieldNames=function(){for(var i=[],n=this.documentHelper.formFields,r=0;r<n.length;r++)""!==n[r].formFieldData.name&&i.push(n[r].formFieldData.name);return i},e.prototype.getFormFieldInfo=function(i){for(var n=this.documentHelper.formFields,r=0;r<n.length;r++)if(n[r].formFieldData.name===i&&""!==n[r].formFieldData.name)return n[r].formFieldData.getFormFieldInfo()},e.prototype.setFormFieldInfo=function(i,n){for(var r=this.documentHelper.formFields,o=0;o<r.length;o++)if(r[o].formFieldData.name===i&&""!==r[o].formFieldData.name){var l=r[o];return void(this.selection&&(this.selection.selectFieldInternal(l),this.editor&&this.editor.setFormField(l,n)))}},e.prototype.resetFormFields=function(i){for(var n=this.documentHelper.formFields,r=0;r<n.length;r++)((0,a.le)(i)||i===n[r].formFieldData.name)&&(n[r].formFieldData instanceof Re?this.editor.updateFormField(n[r],n[r].formFieldData.defaultValue,!0):n[r].formFieldData instanceof qe?this.editor.toggleCheckBoxFormField(n[r],!0,n[r].formFieldData.defaultValue):n[r].formFieldData instanceof Ge&&this.editor.updateFormField(n[r],0,!0))},e.prototype.importFormData=function(i){for(var n=this.documentHelper.formFields,r=0;r<i.length;r++)for(var o=i[r],l=o.fieldName,h=0;h<n.length;h++)n[h].formFieldData.name===l&&(n[h].formFieldData instanceof qe?this.editor.toggleCheckBoxFormField(n[h],!0,o.value):(n[h].formFieldData instanceof Re||n[h].formFieldData instanceof Ge)&&this.editor.updateFormField(n[h],o.value))},e.prototype.exportFormData=function(){for(var i=[],n=this.documentHelper.formFields,r=0;r<n.length;r++)if(""!==n[r].formFieldData.name){var o={fieldName:"",value:""};if(o.fieldName=n[r].formFieldData.name,n[r].formFieldData instanceof qe)o.value=n[r].formFieldData.checked;else if(n[r].formFieldData instanceof Re){var l="";l=this.documentHelper.isInlineFormFillProtectedMode?this.editorModule.getFieldResultText(n[r]):n[r].resultText;var h=new RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===l.replace(h,"")&&(l=""),o.value=l}else n[r].formFieldData instanceof Ge&&(o.value=n[r].formFieldData.selectedIndex);i.push(o)}return i},e.prototype.updateFields=function(){for(var i=0;i<this.documentHelper.fields.length;i++){var n=this.documentHelper.fields[i];0===this.selection.getFieldCode(n).toLowerCase().trim().indexOf("ref ")&&this.selection.updateRefField(n)}},e.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},e.prototype.fitPage=function(i){(0,a.le)(i)&&(i="None"),this.viewer&&(this.viewer.pageFitType=i)},e.prototype.exportAsImage=function(i,n){if((0,a.le)(this.viewer))throw new Error("Invalid operation.");if(this.printModule)return this.printModule.exportAsImage(this.documentHelper,i,"Png"===n?"image/png":"image/jpeg")},e.prototype.print=function(i){if((0,a.le)(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new ye(this),this.editor.layoutWholeDocument(),this.printModule.print(this.documentHelper,i),this.viewer=new Se(this),this.editor.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,i)},e.prototype.serialize=function(){if(!(this.enableSfdtExport&&this.sfdtExportModule instanceof Zi))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},e.prototype.save=function(i,n){if(i=i||"Untitled",(0,a.le)(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===n&&this.wordExportModule)this.wordExportModule&&this.wordExportModule.save(this.documentHelper,i);else if("Txt"===n&&this.textExportModule)this.textExportModule.save(this.documentHelper,i);else{if("Sfdt"!==n||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");var r=this.serialize(),o=new Blob([r],{type:"application/json"});We.vc.save(i+".sfdt",o)}},e.prototype.saveAsBlob=function(i){var n=this;if((0,a.le)(this.viewer))throw new Error("Invalid operation");return new Promise(function(r){"Docx"===i&&n.wordExportModule?r(n.wordExportModule.saveAsBlob(n.documentHelper)):"Txt"===i&&n.textExportModule?r(n.textExportModule.saveAsBlob(n.documentHelper)):"Sfdt"===i&&n.enableSfdtExport&&n.sfdtExportModule&&r(n.sfdtExportModule.saveAsBlob(n.documentHelper))})},e.prototype.openBlank=function(){var i=new j;i.index=0,i.sectionFormat=new je(i),this.sectionFormat&&this.parser.parseSectionFormat(this.sectionFormat,i.sectionFormat);var n=new I;n.index=0,n.paragraphFormat=new ue(n),n.characterFormat=new ie(n),i.childWidgets.push(n),n.containerWidget=i;var r=[];r.push(i);var o=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer&&(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(o),this.documentHelper.onDocumentChanged(r),this.editorModule)){this.editorModule.intializeDefaultStyles();var l=this.documentHelper.styles.findByName("Normal");n.paragraphFormat.baseStyle=l,n.paragraphFormat.listFormat.baseStyle=l}},e.prototype.getStyleNames=function(i){return this.viewer?this.documentHelper.styles.getStyleNames(i):[]},e.prototype.getStyles=function(i){return this.viewer?this.documentHelper.styles.getStyles(i):[]},e.prototype.getBookmarks=function(){var i=[];return this.viewer&&(i=this.documentHelper.getBookmarks(!0)),i},e.prototype.showDialog=function(i){switch(i){case"Hyperlink":this.showHyperlinkDialog();break;case"Table":this.showTableDialog();break;case"Bookmark":this.showBookmarkDialog();break;case"TableOfContents":this.showTableOfContentsDialog();break;case"PageSetup":this.showPageSetupDialog();break;case"List":this.showListDialog();break;case"Styles":this.showStylesDialog();break;case"Style":this.showStyleDialog();break;case"Paragraph":this.showParagraphDialog();break;case"Font":this.showFontDialog();break;case"TableProperties":this.showTablePropertiesDialog();break;case"BordersAndShading":this.showBordersAndShadingDialog();break;case"TableOptions":this.showTableOptionsDialog();break;case"SpellCheck":this.showSpellCheckDialog()}},e.prototype.toggleShowHiddenMarksInternal=function(){this.documentEditorSettings.showHiddenMarks=!this.documentEditorSettings.showHiddenMarks,this.notify(ui,this.documentEditorSettings)},e.prototype.showOptionsPane=function(){!(0,a.le)(this.optionsPaneModule)&&!(0,a.le)(this.viewer)&&this.optionsPaneModule.showHideOptionsPane(!0)},e.prototype.showRestrictEditingPane=function(i){i=!!(0,a.le)(i)||i,this.documentHelper&&this.documentHelper.restrictEditingPane&&this.documentHelper.restrictEditingPane.showHideRestrictPane(i)},e.prototype.showSpellCheckDialog=function(){if(this.spellCheckDialogModule&&this.spellChecker){var i=this.spellChecker.retriveText();(0,a.le)(i)||this.spellCheckDialogModule.show(i.text,i.element)}},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.destroyDependentModules(),(0,a.le)(this.documentHelper)||this.documentHelper.destroy(),this.viewer=void 0,(0,a.le)(this.element)||(this.element.classList.remove("e-documenteditor"),this.element.innerHTML=""),this.refreshing||(this.element=void 0),this.findResultsList=[],this.findResultsList=void 0,this.documentHelper=void 0},e.prototype.clearSpellCheck=function(){(0,a.le)(this.spellChecker)||((0,a.le)(this.spellChecker.errorWordCollection)||this.spellChecker.errorWordCollection.clear(),(0,a.le)(this.spellChecker.uniqueWordsCollection)||this.spellChecker.uniqueWordsCollection.clear())},e.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule.destroy(),this.optionsPaneModule=void 0),this.commentReviewPane&&(this.commentReviewPane.destroy(),this.commentReviewPane=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),(0,a.le)(this.hyperlinkDialogModule)||(this.hyperlinkDialogModule.destroy(),this.hyperlinkDialogModule=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.contextMenuModule&&(this.contextMenuModule.destroy(),this.contextMenuModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),(0,a.le)(this.paragraphDialogModule)||(this.paragraphDialogModule.destroy(),this.paragraphDialogModule=void 0),this.pageSetupDialogModule&&(this.pageSetupDialogModule.destroy(),this.pageSetupDialogModule=void 0),this.footNotesDialogModule&&(this.footNotesDialogModule.destroy(),this.footNotesDialogModule=void 0),this.fontDialogModule&&(this.fontDialogModule.destroy(),this.fontDialogModule=void 0),this.listDialogModule&&(this.listDialogModule.destroy(),this.listDialogModule=void 0),this.imageResizerModule&&(this.imageResizerModule.destroy(),this.imageResizerModule=void 0),this.tablePropertiesDialogModule&&(this.tablePropertiesDialogModule.destroy(),this.tablePropertiesDialogModule=void 0),this.bordersAndShadingDialogModule&&(this.bordersAndShadingDialogModule.destroy(),this.bordersAndShadingDialogModule=void 0),this.cellOptionsDialogModule&&(this.cellOptionsDialogModule.destroy(),this.cellOptionsDialogModule=void 0),this.tableOptionsDialogModule&&(this.tableOptionsDialogModule.destroy(),this.tableOptionsDialogModule=void 0),this.tableDialogModule&&(this.tableDialogModule.destroy(),this.tableDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule=void 0),this.bookmarkDialogModule&&(this.bookmarkDialogModule.destroy(),this.bookmarkDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule.destroy(),this.styleDialogModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.tableOfContentsDialogModule&&(this.tableOfContentsDialogModule.destroy(),this.tableOfContentsDialogModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0)},D([(0,a.Z9)("KeepSourceFormatting")],e.prototype,"defaultPasteOption",void 0),D([(0,a.Z9)("Pages")],e.prototype,"layoutType",void 0),D([(0,a.Z9)("")],e.prototype,"currentUser",void 0),D([(0,a.Z9)("#FFFF00")],e.prototype,"userColor",void 0),D([(0,a.Z9)(20)],e.prototype,"pageGap",void 0),D([(0,a.Z9)("")],e.prototype,"documentName",void 0),D([(0,a.Z9)("100%")],e.prototype,"width",void 0),D([(0,a.Z9)("200px")],e.prototype,"height",void 0),D([(0,a.Z9)("")],e.prototype,"serviceUrl",void 0),D([(0,a.Z9)(1)],e.prototype,"zoomFactor",void 0),D([(0,a.Z9)(2e3)],e.prototype,"zIndex",void 0),D([(0,a.Z9)(!0)],e.prototype,"isReadOnly",void 0),D([(0,a.Z9)(!1)],e.prototype,"enablePrint",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableSelection",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableEditor",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableEditorHistory",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableSfdtExport",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableWordExport",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTextExport",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableOptionsPane",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableContextMenu",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableHyperlinkDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableBookmarkDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTableOfContentsDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableSearch",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableParagraphDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableListDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTablePropertiesDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableBordersAndShadingDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableFootnoteAndEndnoteDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enablePageSetupDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableStyleDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableFontDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTableOptionsDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTableDialog",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableImageResizer",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableSpellCheck",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableComment",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableTrackChanges",void 0),D([(0,a.Z9)(!0)],e.prototype,"enableFormField",void 0),D([(0,a.Z9)(!1)],e.prototype,"acceptTab",void 0),D([(0,a.Z9)(!0)],e.prototype,"useCtrlClickToFollowHyperlink",void 0),D([(0,a.Z9)("#000000")],e.prototype,"pageOutline",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableCursorOnReadOnly",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableLocalPaste",void 0),D([(0,a.Z9)(!1)],e.prototype,"enableLockAndEdit",void 0),D([(0,a.Zz)({},Or)],e.prototype,"documentEditorSettings",void 0),D([(0,a.Zz)({},zr)],e.prototype,"documentSettings",void 0),D([(0,a.Z9)({systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],e.prototype,"serverActionSettings",void 0),D([(0,a.Z9)([])],e.prototype,"headers",void 0),D([(0,a.Z9)(!1)],e.prototype,"showComments",void 0),D([(0,a.Z9)(!1)],e.prototype,"showRevisions",void 0),D([(0,a.ju)()],e.prototype,"documentChange",void 0),D([(0,a.ju)()],e.prototype,"viewChange",void 0),D([(0,a.ju)()],e.prototype,"zoomFactorChange",void 0),D([(0,a.ju)()],e.prototype,"selectionChange",void 0),D([(0,a.ju)()],e.prototype,"requestNavigate",void 0),D([(0,a.ju)()],e.prototype,"contentChange",void 0),D([(0,a.ju)()],e.prototype,"keyDown",void 0),D([(0,a.ju)()],e.prototype,"searchResultsChange",void 0),D([(0,a.ju)()],e.prototype,"created",void 0),D([(0,a.ju)()],e.prototype,"destroyed",void 0),D([(0,a.ju)()],e.prototype,"customContextMenuSelect",void 0),D([(0,a.ju)()],e.prototype,"customContextMenuBeforeOpen",void 0),D([(0,a.ju)()],e.prototype,"beforePaneSwitch",void 0),D([(0,a.ju)()],e.prototype,"commentBegin",void 0),D([(0,a.ju)()],e.prototype,"commentEnd",void 0),D([(0,a.ju)()],e.prototype,"beforeFileOpen",void 0),D([(0,a.ju)()],e.prototype,"commentDelete",void 0),D([(0,a.ju)()],e.prototype,"beforeCommentAction",void 0),D([(0,a.ju)()],e.prototype,"trackChange",void 0),D([(0,a.ju)()],e.prototype,"beforeFormFieldFill",void 0),D([(0,a.ju)()],e.prototype,"serviceFailure",void 0),D([(0,a.ju)()],e.prototype,"afterFormFieldFill",void 0),D([(0,a.ju)()],e.prototype,"actionComplete",void 0),D([(0,a.ju)()],e.prototype,"contentControl",void 0),D([(0,a.ju)()],e.prototype,"beforeXmlHttpRequestSend",void 0),t=D([a.Zl],e)}(a.wA),ht="_toolbar",Yi="_new",Ji="_open",Xt="_undo",Zt="_redo",Et="_image",Vr="_image_local",Qi="_table",$i="_link",en="_bookmark",kt="_comment",Ft="_track",tn="_toc",nn="_header",rn="_footer",on="_page_setup",sn="_page_number",Yt="_break",Jt="_find",Qt="_use_local_clipboard",Wt="_restrict_edit",Ur="_page_break",_r="_section_break",an="_read_only",ln="_protections",$t="_form_fields",ei="_update_fields",qr="_text_form",jr="_checkbox",Gr="_dropdown",Rt="_footnote",Nt="_endnote",Ls=function(){function s(e){this.isCommentEditing=!1,this.container=e,this.importHandler=new xt}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.getModuleName=function(){return"toolbar"},s.prototype.enableItems=function(e,t){this.toolbar.enableItems(e,t)},s.prototype.initToolBar=function(e){this.toolbarItems=e,this.renderToolBar(),this.wireEvent()},s.prototype.renderToolBar=function(){if(!(0,a.le)(this.container)){var e=this.container.toolbarContainer,t=(0,a.az)("div",{className:"e-de-tlbr-wrapper"}),i=(0,a.az)("div",{className:"e-de-toolbar"});this.initToolbarItems(),t.appendChild(i),e.appendChild(t);var n=(0,a.az)("div",{className:"e-de-ctnr-properties-pane-btn"});this.buttonElement=(0,a.az)("button",{attrs:{type:"button"}}),n.appendChild(this.buttonElement);var r="e-tbar-btn e-tbtn-txt e-control e-btn e-de-showhide-btn",o="e-icons e-de-ctnr-showhide";this.container.enableRtl&&(r+="-rtl",o="e-icons e-de-ctnr-showhide e-de-flip"),this.propertiesPaneButton=new M.zx({cssClass:r,iconCss:o});var l=this.container.localObj;this.container.showPropertiesPane?this.buttonElement.title=l.getConstant("Hide properties pane"):(this.buttonElement.title=l.getConstant("Show properties pane"),n.classList.add("e-de-pane-disable-clr")),this.propertiesPaneButton.appendTo(this.buttonElement),a.bi.add(this.buttonElement,"click",this.showHidePropertiesPane,this),e.appendChild(n),this.toolbar.appendTo(i),this.initToolbarDropdown(i)}},s.prototype.initToolbarDropdown=function(e){var t=this;if(this.container){var i=this.container.localObj,n=this.container.element.id+ht;if(this.toolbarItems.indexOf("Image")>=0&&(this.imgDropDwn=new Ue.uw({items:[{text:i.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",id:n+Vr}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.imgDropDwn.appendTo("#"+n+Et)),this.toolbarItems.indexOf("Break")>=0&&(this.breakDropDwn=new Ue.uw({items:[{text:i.getConstant("Page Break"),iconCss:"e-icons e-de-ctnr-page-break",id:n+Ur},{text:i.getConstant("Section Break"),iconCss:"e-icons e-de-ctnr-section-break",id:n+_r}],cssClass:"e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.breakDropDwn.appendTo("#"+n+Yt)),this.filePicker=(0,a.az)("input",{attrs:{type:"file",accept:".doc,.docx,.rtf,.txt,.htm,.html,.sfdt"},className:"e-de-ctnr-file-picker"}),a.AR.isIE&&document.body.appendChild(this.filePicker),this.imagePicker=(0,a.az)("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),a.AR.isIE&&document.body.appendChild(this.imagePicker),this.toolbarItems.indexOf("LocalClipboard")>=0&&this.toggleButton(n+Qt,this.container.enableLocalPaste),this.toolbarItems.indexOf("TrackChanges")>=0&&this.toggleButton(n+Ft,this.container.enableTrackChanges),this.toolbarItems.indexOf("RestrictEditing")>=0){this.toggleButton(n+Wt,this.container.restrictEditing);var r="";this.container.restrictEditing&&(r=" e-de-selected-item"),this.restrictDropDwn=new Ue.uw({items:[{text:i.getConstant("Read only"),id:n+an,iconCss:"e-icons"+r},{text:i.getConstant("Protections"),id:n+ln,iconCss:"e-icons"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this),beforeItemRender:function(o){t.onBeforeRenderRestrictDropdown(o,n)}}),this.restrictDropDwn.appendTo("#"+n+Wt)}this.toolbarItems.indexOf("FormFields")>=0&&(this.formFieldDropDown=new Ue.uw({items:[{text:i.getConstant("Text Form"),iconCss:"e-icons e-de-textform",id:n+qr},{text:i.getConstant("Check Box"),iconCss:"e-icons e-de-checkbox-form",id:n+jr},{text:i.getConstant("DropDown"),iconCss:"e-icons e-de-dropdownform",id:n+Gr}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.formFieldDropDown.appendTo("#"+n+$t))}},s.prototype.onBeforeRenderRestrictDropdown=function(e,t){var i=e.element.getElementsByClassName("e-menu-icon")[0];if(!(0,a.le)(i)&&(e.item.id===t+an&&this.toggleRestrictIcon(i,this.container.restrictEditing),e.item.id===t+ln)){var n=document.getElementsByClassName("e-de-restrict-pane")[0];(0,a.le)(n)||this.toggleRestrictIcon(i,"none"!==n.style.display)}},s.prototype.toggleRestrictIcon=function(e,t){t?e.classList.add("e-de-selected-item"):e.classList.remove("e-de-selected-item")},s.prototype.showHidePropertiesPane=function(){var e=document.getElementsByClassName("e-de-ctnr-properties-pane-btn")[0],t=this.container.localObj;"none"===this.container.propertiesPaneContainer.style.display?(this.container.showPropertiesPane=!0,e.classList.remove("e-de-pane-disable-clr"),this.buttonElement.title=t.getConstant("Hide properties pane"),(0,a.s1)(e,["e-de-pane-enable-clr"],[]),this.container.trigger(Ot,{type:"PropertiesPane"})):this.container.previousContext.indexOf("Header")>=0||this.container.previousContext.indexOf("Footer")>=0?this.container.showHeaderProperties=!this.container.showHeaderProperties:(this.container.showPropertiesPane=!1,e.classList.remove("e-de-pane-enable-clr"),this.buttonElement.title=t.getConstant("Show properties pane"),(0,a.s1)(e,["e-de-pane-disable-clr"],[])),this.enableDisablePropertyPaneButton(this.container.showPropertiesPane),this.container.showPropertiesPaneOnSelection(),this.documentEditor.focusIn()},s.prototype.onWrapText=function(e){var t="",i=e.lastIndexOf(" ");return-1!==i?(t=e.slice(0,i),e.slice(i),t+='<div class="e-de-text-wrap">'+e.slice(i)+"</div>"):t=e,t},s.prototype.wireEvent=function(){this.propertiesPaneButton.on("click",this.togglePropertiesPane.bind(this)),a.bi.add(this.filePicker,"change",this.onFileChange,this),a.bi.add(this.imagePicker,"change",this.onImageChange,this)},s.prototype.initToolbarItems=function(){this.toolbar=new tt.o8({enableRtl:this.container.enableRtl,clicked:this.clickHandler.bind(this),items:this.getToolbarItems()})},s.prototype.reInitToolbarItems=function(e){for(var t=this,i=0;i<e.length;i++)switch(e[i]){case"RestrictEditing":(0,a.le)(this.restrictDropDwn)||this.restrictDropDwn.destroy();break;case"Break":(0,a.le)(this.breakDropDwn)||this.breakDropDwn.destroy();break;case"Image":(0,a.le)(this.imgDropDwn)||this.imgDropDwn.destroy();break;case"FormFields":(0,a.le)(this.formFieldDropDown)||this.formFieldDropDown.destroy()}this.toolbarItems=e;var n=this.container.toolbarContainer;this.toolbar.items=this.getToolbarItems(),this.toolbarTimer=setTimeout(function(){t.toolbarTimer&&clearTimeout(t.toolbarTimer),t.initToolbarDropdown(n),e.indexOf("Open")>=0&&a.bi.add(t.filePicker,"change",t.onFileChange,t),e.indexOf("Image")>=0&&a.bi.add(t.imagePicker,"change",t.onImageChange,t)},200)},s.prototype.getToolbarItems=function(){for(var n,e=this.container.localObj,t=this.container.element.id+ht,i=[],r=this.toolbarItems,o=0;o<this.toolbarItems.length;o++)switch(n=0===o?"e-de-toolbar-btn-start":"Separator"===r[o+1]&&"Separator"===r[o-1]?"e-de-toolbar-btn":"Separator"===r[o+1]?"e-de-toolbar-btn-last":"Separator"===r[o-1]?"e-de-toolbar-btn-first":o===this.toolbarItems.length-1?"e-de-toolbar-btn-end":"e-de-toolbar-btn-middle",r[o]){case"Separator":i.push({type:"Separator",cssClass:"e-de-separator"});break;case"New":i.push({prefixIcon:"e-de-ctnr-new",tooltipText:e.getConstant("Create a new document"),id:t+Yi,text:e.getConstant("New"),cssClass:n});break;case"Open":i.push({prefixIcon:"e-de-ctnr-open",tooltipText:e.getConstant("Open a document"),id:t+Ji,text:e.getConstant("Open"),cssClass:n});break;case"Undo":i.push({prefixIcon:"e-de-ctnr-undo",tooltipText:e.getConstant("Undo Tooltip"),id:t+Xt,text:e.getConstant("Undo"),cssClass:n});break;case"Redo":i.push({prefixIcon:"e-de-ctnr-redo",tooltipText:e.getConstant("Redo Tooltip"),id:t+Zt,text:e.getConstant("Redo"),cssClass:n});break;case"Comments":i.push({prefixIcon:"e-de-cnt-cmt-add",tooltipText:e.getConstant("Show comments"),id:t+kt,text:e.getConstant("Comments"),cssClass:n});break;case"TrackChanges":i.push({prefixIcon:"e-de-cnt-track",tooltipText:e.getConstant("Track Changes"),id:t+Ft,text:this.onWrapText(e.getConstant("TrackChanges")),cssClass:n});break;case"Image":i.push({template:'<button title="'+e.getConstant("Insert inline picture from a file.")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+t+Et+'"><span class="e-btn-icon e-icons e-de-ctnr-image e-icon-left"></span><span class="e-tbar-btn-text">'+e.getConstant("Image")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:t+Et});break;case"Table":i.push({prefixIcon:"e-de-ctnr-table",tooltipText:e.getConstant("Insert a table into the document"),id:t+Qi,text:e.getConstant("Table"),cssClass:n});break;case"Hyperlink":i.push({prefixIcon:"e-de-ctnr-link",tooltipText:e.getConstant("Create Hyperlink"),id:t+$i,text:e.getConstant("Link"),cssClass:n});break;case"Bookmark":i.push({prefixIcon:"e-de-ctnr-bookmark",tooltipText:e.getConstant("Insert a bookmark in a specific place in this document"),id:t+en,text:e.getConstant("Bookmark"),cssClass:n});break;case"TableOfContents":i.push({prefixIcon:"e-de-ctnr-tableofcontent",tooltipText:e.getConstant("Provide an overview of your document by adding a table of contents"),id:t+tn,text:this.onWrapText(e.getConstant("Table of Contents")),cssClass:n});break;case"Header":i.push({prefixIcon:"e-de-ctnr-header",tooltipText:e.getConstant("Add or edit the header"),id:t+nn,text:e.getConstant("Header"),cssClass:n});break;case"Footer":i.push({prefixIcon:"e-de-ctnr-footer",tooltipText:e.getConstant("Add or edit the footer"),id:t+rn,text:e.getConstant("Footer"),cssClass:n});break;case"PageSetup":i.push({prefixIcon:"e-de-ctnr-pagesetup",tooltipText:e.getConstant("Open the page setup dialog"),id:t+on,text:this.onWrapText(e.getConstant("Page Setup")),cssClass:n});break;case"PageNumber":i.push({prefixIcon:"e-de-ctnr-pagenumber",tooltipText:e.getConstant("Add page numbers"),id:t+sn,text:this.onWrapText(e.getConstant("Page Number")),cssClass:n});break;case"Break":i.push({template:'<button title="'+e.getConstant("Break")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+t+Yt+'"><span class="e-btn-icon e-icons e-de-ctnr-break e-icon-left"></span><span class="e-tbar-btn-text">'+e.getConstant("Break")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:t+Yt});break;case"Find":i.push({prefixIcon:"e-de-ctnr-find",tooltipText:e.getConstant("Find Text"),id:t+Jt,text:e.getConstant("Find"),cssClass:n});break;case"LocalClipboard":i.push({prefixIcon:"e-de-ctnr-paste",tooltipText:e.getConstant("Toggle between the internal clipboard and system clipboard"),id:t+Qt,text:this.onWrapText(e.getConstant("Local Clipboard")),cssClass:n});break;case"RestrictEditing":i.push({template:'<button title="'+e.getConstant("Restrict editing")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+t+Wt+'"><span class="e-btn-icon e-de-ctnr-lock e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(e.getConstant("Restrict Editing"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>'});break;case"FormFields":i.push({template:'<button title="'+e.getConstant("Form Fields")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+t+$t+'"><span class="e-btn-icon e-de-formfield e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(e.getConstant("Form Fields"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:t+$t});break;case"UpdateFields":i.push({prefixIcon:"e-de-update-field",tooltipText:e.getConstant("Update cross reference fields"),id:t+ei,text:this.onWrapText(e.getConstant("Update Fields")),cssClass:n+" e-de-formfields"});break;case"InsertFootnote":i.push({prefixIcon:"e-de-footnote",tooltipText:e.getConstant("Footnote Tooltip"),text:this.onWrapText(e.getConstant("Insert Footnote")),id:t+Rt,cssClass:n});break;case"InsertEndnote":i.push({prefixIcon:"e-de-endnote",tooltipText:e.getConstant("Endnote Tooltip"),text:this.onWrapText(e.getConstant("Insert Endnote")),id:t+Nt,cssClass:n});break;default:i.push(r[o])}return i},s.prototype.clickHandler=function(e){var t=this.container.element.id+ht;switch(e.item.id){case t+Yi:this.container.documentEditor.openBlank();break;case t+Ji:this.filePicker.value="",this.filePicker.click();break;case t+Xt:this.container.documentEditor.editorHistory.undo();break;case t+Zt:this.container.documentEditor.editorHistory.redo();break;case t+Qi:this.container.documentEditor.showDialog("Table");break;case t+$i:this.container.documentEditor.showDialog("Hyperlink");break;case t+en:this.container.documentEditor.showDialog("Bookmark");break;case t+kt:this.documentEditor.editor.isUserInsert=!0,this.documentEditor.editor.insertComment(""),this.documentEditor.editor.isUserInsert=!1;break;case t+Ft:this.toggleTrackChangesInternal(e.item.id);break;case t+nn:this.container.documentEditor.selection.goToHeader(),this.container.statusBar.toggleWebLayout();break;case t+tn:this.onToc();break;case t+rn:this.container.documentEditor.selection.goToFooter(),this.container.statusBar.toggleWebLayout();break;case t+on:this.container.documentEditor.showDialog("PageSetup");break;case t+sn:this.container.documentEditor.editor.insertPageNumber();break;case t+Jt:this.container.documentEditor.showOptionsPane();break;case t+Qt:this.toggleLocalPaste(e.item.id);break;case t+ei:this.documentEditor.updateFields();break;case t+Rt:this.documentEditor.editor.insertFootnote();break;case t+Nt:this.documentEditor.editor.insertEndnote();break;default:this.container.trigger("toolbarClick",e)}e.item.id!==t+Jt&&e.item.id!==t+Et&&this.container.documentEditor.focusIn()},s.prototype.toggleLocalPaste=function(e){this.container.enableLocalPaste=!this.container.enableLocalPaste,this.toggleButton(e,this.container.enableLocalPaste)},s.prototype.toggleEditing=function(){this.container.restrictEditing=!this.container.restrictEditing,this.container.showPropertiesPane=!this.container.restrictEditing},s.prototype.toggleRestrictEditing=function(e){var t=this.container.element.id+ht+Wt;document.getElementById(t)&&this.toggleButton(t,e)},s.prototype.toggleButton=function(e,t){var i=document.getElementById(e);t?(0,a.s1)(i,["e-btn-toggle"],[]):(0,a.s1)(i,[],["e-btn-toggle"])},s.prototype.toggleTrackChangesInternal=function(e,t){(0,a.le)(t)||(this.container.enableTrackChanges=!t),this.container.enableTrackChanges=!this.container.enableTrackChanges,this.toggleButton(e,this.container.enableTrackChanges)},s.prototype.togglePropertiesPane=function(){this.container.showPropertiesPane=!this.container.showPropertiesPane},s.prototype.onDropDownButtonSelect=function(e){var t=this,i=this.container.element.id+ht,n=e.item.id;n===i+Ur?this.container.documentEditor.editorModule.insertPageBreak():n===i+_r?this.container.documentEditor.editorModule.insertSectionBreak():n===i+Vr?(this.imagePicker.value="",this.imagePicker.click()):n===i+"_image_url"||(n===i+an?this.toggleEditing():n===i+ln?this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0):n===i+jr?this.documentEditor.editor.insertFormField("CheckBox"):n===i+Gr?this.documentEditor.editor.insertFormField("DropDown"):n===i+qr&&this.documentEditor.editor.insertFormField("Text")),setTimeout(function(){t.documentEditor.focusIn()},30)},s.prototype.onFileChange=function(){var e=this,t=this.filePicker.files[0],r={fileSize:t.size,isCanceled:void 0};if(this.documentEditor.trigger("beforeFileOpen",r),!r.isCanceled&&t){var o=t.name.substr(t.name.lastIndexOf("."));if(".sfdt"===o){var l=new FileReader;l.onload=function(){e.container.documentEditor.open(l.result)},l.readAsText(t)}else if(this.isSupportedFormatType(o))this.convertToSfdt(t);else{var h=new a.E7("documenteditor",this.documentEditor.defaultLocale);se.hZ.alert({content:h.getConstant("Unsupported format"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}})}this.container.documentEditor.documentName=t.name.substr(0,t.name.lastIndexOf("."))}},s.prototype.isSupportedFormatType=function(e){switch(e){case".dotx":case".docx":case".docm":case".dotm":case".dot":case".doc":case".rtf":case".txt":case".xml":case".html":return!0;default:return!1}},s.prototype.convertToSfdt=function(e){(0,se.yh)(this.container.containerTarget),this.importHandler.url=this.container.serviceUrl+this.container.serverActionSettings.import,this.importHandler.onSuccess=this.successHandler.bind(this),this.importHandler.onFailure=this.failureHandler.bind(this),this.importHandler.onError=this.failureHandler.bind(this),this.importHandler.customHeaders=this.container.headers;var t={serverActionType:"Import",headers:this.container.headers,timeout:0,cancel:!1,withCredentials:!1};this.container.trigger(Tt,t);var i=new FormData;i.append("files",e),t.cancel?(0,se.v3)(this.container.containerTarget):this.importHandler.send(i,t)},s.prototype.failureHandler=function(e){"onError"===e.name?se.hZ.alert({content:this.container.localObj.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}):(alert("Failed to load the file"),this.documentEditor.fireServiceFailure(e)),(0,se.v3)(this.container.containerTarget)},s.prototype.successHandler=function(e){this.container.documentEditor.open(e.data),(0,se.v3)(this.container.containerTarget)},s.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},s.prototype.insertImage=function(e){var t=document.createElement("img"),i=this.container;t.addEventListener("load",function(){i.documentEditor.editor.insertImageInternal(e,!0,this.width,this.height)}),t.src=e},s.prototype.enableDisableFormField=function(e){var t=document.getElementById("container_toolbar_form_fields");(0,a.le)(t)||this.toolbar.enableItems(t.parentElement,e)},s.prototype.enableDisableInsertComment=function(e){this.isCommentEditing=!e;var n=document.getElementById(this.container.element.id+ht+kt);!this.container.enableComment&&n?this.toolbar.removeItems(n.parentElement):n&&(!(0,a.le)(this.documentEditor)&&(this.documentEditor.isReadOnly||this.documentEditor.documentHelper.isDocumentProtected)&&(e=this.documentEditor.documentHelper.isCommentOnlyMode||!this.documentEditor.isReadOnlyMode),this.toolbar.enableItems(n.parentElement,e))},s.prototype.toggleTrackChanges=function(e){var t=this.container.element.id+ht+Ft;document.getElementById(t)&&this.toggleTrackChangesInternal(t,e)},s.prototype.enableDisableToolBarItem=function(e,t){for(var i=this.container.element.id+ht,n=0,r=this.toolbar.items;n<r.length;n++){var o=r[n],l=o.id;if(l!==i+Yi&&l!==i+Ji&&l!==i+Jt&&l!==i+Qt&&l!==i+Wt&&"Separator"!==o.type){if(e&&this.isCommentEditing&&l===i+kt||l!==i+Xt&&l!==i+Zt&&l!==i+Qi&&l!==i+$i&&l!==i+en&&l!==i+kt&&l!==i+nn&&l!==i+tn&&l!==i+rn&&l!==i+on&&l!==i+sn&&l!==i+Et&&l!==i+$t&&l!==i+Yt&&l!==i+Ft&&l!==i+Rt&&l!==i+Nt&&l!==i+ei||t&&this.documentEditor.documentHelper.isFormFillProtectedMode&&l===i+ei)continue;var h=document.getElementById(o.id);!(0,a.le)(h)&&!(0,a.le)(h.parentElement)&&this.toolbar.enableItems(h.parentElement,e)}}(0,a.le)(this.documentEditor)||this.enableDisableFormField(!this.documentEditor.enableHeaderAndFooter&&e&&!this.documentEditor.isReadOnlyMode),(this.documentEditor.selection.isinFootnote||this.documentEditor.selection.isinEndnote||this.documentEditor.enableHeaderAndFooter)&&(this.containsItem(i+Nt)&&this.toolbar.enableItems(document.getElementById(i+Nt).parentElement,!1),this.containsItem(i+Rt)&&this.toolbar.enableItems(document.getElementById(i+Rt).parentElement,!1)),(!t||this.container.showPropertiesPane)&&(t&&(e=this.container.showPropertiesPane),(0,a.s1)(this.propertiesPaneButton.element.parentElement,e?[]:["e-de-overlay"],e?["e-de-overlay"]:[]));var d=this.documentEditor.documentHelper.protectionType;(e||this.documentEditor.documentHelper.isDocumentProtected&&("FormFieldsOnly"===d||"CommentsOnly"===d))&&this.enableDisableUndoRedo(),this.documentEditor.documentHelper.isTrackedOnlyMode&&this.containsItem(i+Ft)&&this.toolbar.enableItems(document.getElementById(i+Ft).parentElement,!1)},s.prototype.containsItem=function(e){for(var t=0,i=this.toolbar.items;t<i.length;t++)if(i[t].id===e)return!0;return!1},s.prototype.enableDisableUndoRedo=function(){var e=this.container.element.id+ht;if(this.toolbarItems.indexOf("Undo")>=0){var t=document.getElementById(e+Xt);(0,a.le)(t)||this.toolbar.enableItems(t.parentElement,this.container.documentEditor.editorHistory.canUndo())}if(this.toolbarItems.indexOf("Redo")>=0){var i=document.getElementById(e+Zt);(0,a.le)(i)||this.toolbar.enableItems(i.parentElement,this.container.documentEditor.editorHistory.canRedo())}},s.prototype.onToc=function(){if("TableOfContents"===this.container.previousContext&&"none"===this.container.propertiesPaneContainer.style.display)return this.container.showPropertiesPane=!1,void this.documentEditor.focusIn();"block"===this.container.headerFooterProperties.element.style.display&&this.documentEditor.selection.closeHeaderFooter(),this.enableDisablePropertyPaneButton(!1),this.container.showProperties("toc")},s.prototype.enableDisablePropertyPaneButton=function(e){e?(0,a.s1)(this.propertiesPaneButton.element.firstChild,["e-pane-enabled"],["e-pane-disabled"]):(0,a.s1)(this.propertiesPaneButton.element.firstChild,["e-pane-disabled"],["e-pane-enabled"])},s.prototype.destroy=function(){if(this.restrictDropDwn&&(this.restrictDropDwn.destroy(),this.restrictDropDwn=void 0),this.imgDropDwn&&(this.imgDropDwn.destroy(),this.imgDropDwn=void 0),this.breakDropDwn&&(this.breakDropDwn.destroy(),this.breakDropDwn=void 0),this.formFieldDropDown&&(this.formFieldDropDown.destroy(),this.formFieldDropDown=void 0),this.toolbar){var e=this.toolbar.element;this.toolbar.destroy(),this.toolbar=void 0,e.parentElement.removeChild(e)}this.container.toolbarContainer&&(this.container.containerTarget.removeChild(this.container.toolbarContainer),this.container.toolbarContainer=void 0),this.container.toolbarModule&&(this.container.toolbarModule=void 0),this.propertiesPaneButton&&this.propertiesPaneButton.destroy(),this.propertiesPaneButton=void 0,this.toolbarItems=[],this.toolbarItems=void 0,this.container=void 0},s}(),Es=function(){function s(e,t){this.isHeaderTopApply=!1,this.isFooterTopApply=!1,this.container=e,this.isRtl=t,this.initHeaderFooterPane(),this.wireEvents()}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),s.prototype.enableDisableElements=function(e){e?(0,a.s1)(this.element,[],["e-de-overlay"]):(0,a.s1)(this.element,["e-de-overlay"],[])},s.prototype.initHeaderFooterPane=function(){this.initializeHeaderFooter(),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element)},s.prototype.showHeaderFooterPane=function(e){e&&(this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.onSelectionChange()),!(!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display)&&(this.element.style.display=e?"block":"none",this.documentEditor.resize())},s.prototype.initializeHeaderFooter=function(){var e=this,t=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),i="header_footer_properties";this.element=(0,a.az)("div",{id:this.documentEditor.element.id+i,className:"e-de-prop-pane"});var n=this.createDivTemplate("_header_footer",this.element,"padding-bottom:0");(0,a.s1)(n,["e-de-cntr-pane-padding"],[]);var r=(0,a.az)("label",{className:"e-de-prop-header-label"});r.innerHTML=t.getConstant("Header And Footer");var l=(0,a.az)("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+(this.isRtl?"float:left;":"float:right;")});l.addEventListener("click",function(){e.onClose()}),n.appendChild(r),n.appendChild(l);var h=this.createDivTemplate(i+"_options",this.element);(0,a.s1)(h,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var d=(0,a.az)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"});d.innerHTML=t.getConstant("Options"),h.appendChild(d);var c=this.createDivTemplate(i+"_optionsDiv",h),u=this.createDivTemplate(i+"_firstPageDiv",c);(0,a.s1)(u,["e-de-hdr-ftr-frst-div"],[]);var p=(0,a.az)("input",{id:"firstPage",className:"e-de-prop-sub-label"});u.appendChild(p),this.firstPage=new M.Jg({label:t.getConstant("Different First Page"),change:this.changeFirstPageOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.firstPage.appendTo(p),u.children[0].setAttribute("title",t.getConstant("Different header and footer for first page"));var f=this.createDivTemplate(i+"_oddOrEvenDiv",c),g=(0,a.az)("input",{id:"oddOrEven",className:"e-de-sub-prop-label"});f.appendChild(g),this.oddOrEven=new M.Jg({label:t.getConstant("Different Odd And Even Pages"),change:this.changeoddOrEvenOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.oddOrEven.appendTo(g),f.children[0].setAttribute("title",t.getConstant("Different header and footer for odd and even pages"));var m=this.createDivTemplate(i+"_positionLabelDiv",this.element);(0,a.s1)(m,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var v=(0,a.az)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"});v.innerHTML=t.getConstant("Position"),m.appendChild(v);var y=this.createDivTemplate(i+"_positionDiv",m),b=this.createDivTemplate(i+"_headerTopDiv",y);(0,a.s1)(b,["e-de-hdr-ftr-top-div"],[]);var C=(0,a.az)("label",{className:"e-de-prop-sub-label",styles:"display:block"});C.innerHTML=t.getConstant("Header from Top"),b.appendChild(C);var F=(0,a.az)("input",{id:this.documentEditor.element.id+"_headerFromTop",className:"e-de-prop-sub-label"});b.appendChild(F),this.headerFromTop=new J.No({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.headerFromTop.appendTo(F),this.headerFromTop.element.parentElement.setAttribute("title",t.getConstant("Distance from top of the page to top of the header"));var T=this.createDivTemplate(i+"_footerBottomDiv",y),x=(0,a.az)("label",{className:"e-de-prop-sub-label",styles:"display:block"});x.innerHTML=t.getConstant("Footer from Bottom"),T.appendChild(x);var P=(0,a.az)("input",{id:this.documentEditor.element.id+"_footerFromTop",className:"e-de-prop-sub-label"});T.appendChild(P),this.footerFromTop=new J.No({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.footerFromTop.appendTo(P),this.footerFromTop.element.parentElement.setAttribute("title",t.getConstant("Distance from bottom of the page to bottom of the footer"))},s.prototype.createDivTemplate=function(e,t,i){var n;return n=(0,a.az)("div",i?{id:e,styles:i}:{id:e}),t.appendChild(n),n},s.prototype.wireEvents=function(){var e=this;this.headerFromTop.element.addEventListener("click",function(){e.isHeaderTopApply=!0}),this.footerFromTop.element.addEventListener("click",function(){e.isFooterTopApply=!0}),this.headerFromTop.element.addEventListener("keydown",this.onHeaderValue.bind(this)),this.footerFromTop.element.addEventListener("keydown",this.onFooterValue.bind(this)),this.headerFromTop.element.addEventListener("blur",function(){e.changeHeaderValue(),e.isHeaderTopApply=!1}),this.footerFromTop.element.addEventListener("blur",function(){e.changeFooterValue(),e.isFooterTopApply=!1})},s.prototype.onClose=function(){this.container.showHeaderProperties=!0,this.container.documentEditor.selection.closeHeaderFooter()},s.prototype.changeFirstPageOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.sectionFormat.differentFirstPage=this.firstPage.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},s.prototype.changeoddOrEvenOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.sectionFormat.differentOddAndEvenPages=this.oddOrEven.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},s.prototype.changeHeaderValue=function(){if(this.isHeaderTopApply&&!this.documentEditor.isReadOnly){var e=this.headerFromTop.value;e>this.headerFromTop.max&&(e=this.headerFromTop.max),this.documentEditor.selection.sectionFormat.headerDistance=e}},s.prototype.onHeaderValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeHeaderValue(),t.isHeaderTopApply=!1},30)},s.prototype.onFooterValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeFooterValue(),t.isFooterTopApply=!1},30)},s.prototype.changeFooterValue=function(){if(this.isFooterTopApply&&!this.documentEditor.isReadOnly){var e=this.footerFromTop.value;e>this.footerFromTop.max&&(e=this.footerFromTop.max),this.documentEditor.selection.sectionFormat.footerDistance=e}},s.prototype.onSelectionChange=function(){this.headerFromTop.value=this.documentEditor.selection.sectionFormat.headerDistance,this.footerFromTop.value=this.documentEditor.selection.sectionFormat.footerDistance,this.firstPage.checked=!!this.documentEditor.selection.sectionFormat.differentFirstPage,this.oddOrEven.checked=!!this.documentEditor.selection.sectionFormat.differentOddAndEvenPages},s.prototype.destroy=function(){this.firstPage&&this.firstPage.destroy(),this.firstPage=void 0,this.oddOrEven&&this.oddOrEven.destroy(),this.oddOrEven=void 0,this.headerFromTop&&(this.headerFromTop.destroy(),this.headerFromTop=void 0),this.footerFromTop&&(this.footerFromTop.destroy(),this.footerFromTop=void 0),this.container=void 0},s}(),ks=function(){function s(e,t){this.isWidthApply=!1,this.isHeightApply=!1,this.container=e,this.elementId=this.documentEditor.element.id,this.isMaintainAspectRatio=!1,this.isRtl=t,this.initializeImageProperties()}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.enableDisableElements=function(e){e?(0,a.s1)(this.element,[],["e-de-overlay"]):(0,a.s1)(this.element,["e-de-overlay"],[])},s.prototype.initializeImageProperties=function(){this.element=(0,a.az)("div",{id:this.elementId+"_imageProperties",className:"e-de-prop-pane"}),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element),this.initImageProp(),this.wireEvents()},s.prototype.initImageProp=function(){var e=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),t=(0,a.az)("div",{id:this.elementId+"_imageDiv",className:"e-de-cntr-pane-padding",styles:"border:0px"});this.element.appendChild(t);var i=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});i.textContent=e.getConstant("Image"),t.appendChild(i);var n=(0,a.az)("div");t.appendChild(n),this.widthElement=this.createImagePropertiesDiv("_widthDiv",n,"_widthInput",e.getConstant("W"),e.getConstant("Width")),this.widthNumericBox=new J.No({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.widthNumericBox.appendTo(this.widthElement),this.heightElement=this.createImagePropertiesDiv("_heightDiv",n,"_heightInput",e.getConstant("H"),e.getConstant("Height")),this.heightNumericBox=new J.No({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.heightNumericBox.appendTo(this.heightElement);var r=(0,a.az)("div",{id:this.elementId+"_aspectRatioDiv"});r.setAttribute("title",e.getConstant("Aspect ratio")),n.appendChild(r);var o=(0,a.az)("input",{id:this.elementId+"_aspectRatio",className:"e-de-ctnr-prop-label"});r.appendChild(o),this.aspectRatioBtn=new M.Jg({label:e.getConstant("Aspect ratio"),enableRtl:this.isRtl},o)},s.prototype.createImagePropertiesDiv=function(e,t,i,n,r){var o=(0,a.az)("div",{id:this.elementId+e,styles:"position: relative;width: 100%;",className:"e-de-ctnr-segment"});o.setAttribute("title",r),t.appendChild(o);var l=(0,a.az)("input",{id:this.elementId+i,className:"e-textbox",styles:"width:100%;"});o.appendChild(l);var h=(0,a.az)("span",{className:"e-de-img-prty-span"});return h.textContent=n,o.appendChild(h),l},s.prototype.wireEvents=function(){var e=this;this.aspectRatioBtn.element.addEventListener("change",this.onAspectRatioBtnClick.bind(this)),this.widthNumericBox.element.addEventListener("click",function(){e.isWidthApply=!0}),this.heightNumericBox.element.addEventListener("click",function(){e.isHeightApply=!0}),this.widthNumericBox.element.addEventListener("keydown",this.onImageWidth.bind(this)),this.heightNumericBox.element.addEventListener("keydown",this.onImageHeight.bind(this)),this.widthNumericBox.element.addEventListener("blur",function(){e.applyImageWidth(),e.isWidthApply=!1}),this.heightNumericBox.element.addEventListener("blur",function(){e.applyImageHeight(),e.isHeightApply=!1})},s.prototype.onImageWidth=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageWidth(),t.isWidthApply=!1},30)},s.prototype.onImageHeight=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageHeight(),t.isHeightApply=!1},30)},s.prototype.applyImageWidth=function(){var e,t;this.isMaintainAspectRatio?this.isMaintainAspectRatio&&((e=this.widthNumericBox.value)>this.widthNumericBox.max&&(e=this.widthNumericBox.max),this.heightNumericBox.value=t=this.heightNumericBox.value*(e/this.documentEditor.selection.imageFormat.width),null===e||null===t||this.documentEditor.selection.imageFormat.resize(e,t)):((e=this.widthNumericBox.value)>this.widthNumericBox.max&&(e=this.widthNumericBox.max),(t=this.heightNumericBox.value)>this.heightNumericBox.max&&(t=this.heightNumericBox.max),null===e||null===t||this.documentEditor.selection.imageFormat.resize(e,t))},s.prototype.applyImageHeight=function(){if(this.isMaintainAspectRatio)this.isMaintainAspectRatio&&(this.widthNumericBox.value=e=this.widthNumericBox.value*((t=this.heightNumericBox.value)/this.documentEditor.selection.imageFormat.height),null===e||null===t||this.documentEditor.selection.imageFormat.resize(e,t));else{var e,t=this.heightNumericBox.value;null===(e=this.widthNumericBox.value)||null===t||this.documentEditor.selection.imageFormat.resize(e,t)}},s.prototype.onAspectRatioBtnClick=function(){this.isMaintainAspectRatio=!this.isMaintainAspectRatio},s.prototype.showImageProperties=function(e){"block"===this.element.style.display&&this.updateImageProperties(),!(!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display)&&(this.element.style.display=e?"block":"none",this.documentEditor.resize())},s.prototype.updateImageProperties=function(){this.widthNumericBox.value=this.documentEditor.selection.imageFormat.width,this.heightNumericBox.value=this.documentEditor.selection.imageFormat.height},s.prototype.destroy=function(){this.container=void 0,this.widthNumericBox&&this.widthNumericBox.destroy(),this.widthNumericBox=void 0,this.heightNumericBox&&this.heightNumericBox.destroy(),this.heightNumericBox=void 0,this.aspectRatioBtn&&this.aspectRatioBtn.destroy(),this.aspectRatioBtn=void 0},s}(),Ws=function(){function s(e,t){this.container=e,this.elementId=this.documentEditor.element.id,this.isRtl=t,this.initializeTocPane()}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),s.prototype.enableDisableElements=function(e){e?(0,a.s1)(this.element,[],["e-de-overlay"]):(0,a.s1)(this.element,["e-de-overlay"],[])},s.prototype.initializeTocPane=function(){this.localObj=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.element=(0,a.az)("div",{id:this.elementId+"_tocProperties",className:"e-de-prop-pane"});var e=(0,a.az)("div",{className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.tocHeaderDiv(e),this.initTemplates(e),e=(0,a.az)("div",{className:"e-de-cntr-pane-padding"}),this.tocOptionsDiv(e),this.contentStylesDropdown(e),this.checkboxContent(e),this.buttonDiv(e),this.wireEvents(),this.updateTocProperties(),this.container.propertiesPaneContainer.appendChild(this.element)},s.prototype.updateTocProperties=function(){this.rightalignPageNumber.checked=!0,this.showPageNumber.checked=!0,this.hyperlink.checked=!0},s.prototype.wireEvents=function(){var e=this;this.cancelBtn.element.addEventListener("click",function(){e.onClose()}),this.updateBtn.element.addEventListener("click",this.onInsertToc.bind(this)),this.closeButton.addEventListener("click",function(){e.onClose()})},s.prototype.onClose=function(){this.container.showPropertiesPane&&"TableOfContents"!==this.container.previousContext?this.container.showPropertiesPaneOnSelection():(this.showTocPane(!1),this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.container.showPropertiesPane=!1)},s.prototype.tocHeaderDiv=function(e){var t,i;this.isRtl?(t="float:left;",i="margin-left:7px;"):(t="float:right;",i="margin-right:7px;");var n=(0,a.az)("div",{id:this.elementId+"toc_id",styles:"display: block;"});e.appendChild(n),this.element.appendChild(e);var r=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});r.textContent=this.localObj.getConstant("Table of Contents"),n.appendChild(r),this.closeButton=(0,a.az)("span",{className:"e-de-ctnr-close e-icons",styles:"cursor: pointer;display:inline-block;color: #4A4A4A;"+t+i}),n.appendChild(this.closeButton)},s.prototype.initTemplates=function(e){this.template1(e)},s.prototype.template1=function(e){this.template1Div=(0,a.az)("div",{className:"e-de-toc-template1"}),this.isRtl&&this.template1Div.classList.add("e-de-rtl"),e.appendChild(this.template1Div);var t=(0,a.az)("div",{className:"e-de-toc-template1-content1"});t.textContent=this.localObj.getConstant("HEADING - - - - 1"),this.template1Div.appendChild(t);var i=(0,a.az)("div",{className:"e-de-toc-template1-content2"});i.textContent=this.localObj.getConstant("HEADING - - - - 2"),this.template1Div.appendChild(i);var n=(0,a.az)("div",{className:"e-de-toc-template1-content3"});n.textContent=this.localObj.getConstant("HEADING - - - - 3"),this.template1Div.appendChild(n)},s.prototype.tocOptionsDiv=function(e){var t=(0,a.az)("div");e.appendChild(t),this.element.appendChild(e),this.isRtl&&t.classList.add("e-de-rtl");var i=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});i.textContent=this.localObj.getConstant("Options"),t.appendChild(i)},s.prototype.createDropDownButton=function(e,t,i,n,r){var o=(0,a.az)("input",{id:e});return t.appendChild(o),new Te.NB({index:r,dataSource:n,popupHeight:"150px",cssClass:"e-de-prop-font-button"},o)},s.prototype.contentStylesDropdown=function(e){var t=this,i=(0,a.az)("div",{id:"contentstyle_div"});i.setAttribute("title",this.localObj.getConstant("Number of heading or outline levels to be shown in table of contents")),e.appendChild(i);var n=(0,a.az)("label",{className:"e-de-prop-sub-label",styles:"display:block"});n.textContent=this.localObj.getConstant("Levels"),i.appendChild(n),e.appendChild(i),this.borderLevelStyle=this.createDropDownButton(this.elementId+"_borderLevelDiv",i,"",["1","2","3","4","5","6","7","8","9"],2),this.borderLevelStyle.change=function(o){t.borderLevelStyle.value=o.item.value},e.appendChild(i)},s.prototype.checkboxContent=function(e){var t=(0,a.az)("div",{id:"toc_checkboxDiv",styles:"margin-bottom:36px;"});e.appendChild(t);var i=(0,a.az)("div",{className:"e-de-toc-checkbox1"});i.setAttribute("title",this.localObj.getConstant("Show page numbers in table of contents")),t.appendChild(i);var n=(0,a.az)("input",{id:"showpagenumber",styles:"width:12px;height:12px;margin-bottom:8px",className:"e-de-prop-sub-label"});i.appendChild(n),this.showPageNumber=new M.Jg({label:this.localObj.getConstant("Show page numbers"),enableRtl:this.isRtl}),this.showPageNumber.appendTo(n);var r=(0,a.az)("div",{className:"e-de-toc-checkbox2"});r.setAttribute("title",this.localObj.getConstant("Right align page numbers in table of contents")),t.appendChild(r);var o=(0,a.az)("input",{id:"rightalignpagenumber",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"});r.appendChild(o),this.rightalignPageNumber=new M.Jg({label:this.localObj.getConstant("Right align page numbers"),enableRtl:this.isRtl}),this.rightalignPageNumber.appendTo(o);var l=(0,a.az)("div",{className:"e-de-toc-checkbox3"});l.setAttribute("title",this.localObj.getConstant("Use hyperlinks instead of page numbers")),t.appendChild(l);var h=(0,a.az)("input",{id:"hyperlinkdiv",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"});l.appendChild(h),this.hyperlink=new M.Jg({label:this.localObj.getConstant("Use hyperlinks"),enableRtl:this.isRtl}),this.hyperlink.appendTo(h)},s.prototype.buttonDiv=function(e){var i=(0,a.az)("div",{id:"footerDiv",styles:this.isRtl?"float:left":"float:right"});e.appendChild(i);var n=(0,a.az)("button",{id:"footerupdatebuttonDiv",attrs:{type:"button"}});i.appendChild(n),this.updateBtn=new M.zx({content:this.localObj.getConstant("Update"),cssClass:"btn-update",isPrimary:!0}),this.updateBtn.appendTo(n);var r=(0,a.az)("button",{id:"footercancelbuttonDiv",attrs:{type:"button"}});i.appendChild(r),this.cancelBtn=new M.zx({content:this.localObj.getConstant("Cancel"),cssClass:this.isRtl?"e-de-btn-cancel-rtl":"e-de-btn-cancel"}),this.cancelBtn.appendTo(r)},s.prototype.showTocPane=function(e,t){!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.updateBtn.content=this.localObj.getConstant("TableOfContents"===this.documentEditor.selection.contextType?"Update":"Insert"),this.prevContext=this.documentEditor.selection.contextType,this.documentEditor.resize(),e&&this.updateBtn.element.focus())},s.prototype.onInsertToc=function(){var e={startLevel:1,endLevel:parseInt(this.borderLevelStyle.value,0),includeHyperlink:this.hyperlink.checked,includePageNumber:this.showPageNumber.checked,rightAlign:this.rightalignPageNumber.checked};e.rightAlign&&(e.tabLeader="Dot"),this.documentEditor.editor.insertTableOfContents(e)},s.prototype.destroy=function(){this.container=void 0,this.showPageNumber&&(this.showPageNumber.destroy(),this.showPageNumber=void 0),this.rightalignPageNumber&&(this.rightalignPageNumber.destroy(),this.rightalignPageNumber=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderLevelStyle&&(this.borderLevelStyle.destroy(),this.borderLevelStyle=void 0),this.hyperlink&&this.hyperlink.destroy(),this.hyperlink=void 0,this.updateBtn&&this.updateBtn.destroy(),this.updateBtn=void 0,this.cancelBtn&&this.cancelBtn.destroy(),this.cancelBtn=void 0},s}(),Rs=function(){function s(e,t){var i=this;this.isRetrieving=!1,this.appliedHighlightColor="rgb(255, 255, 0)",this.createChangecase=function(n){var r=[{text:i.localObj.getConstant("UPPERCASE"),id:"uppercase"}];i.changeCaseDropdown=new Ue.uw({items:r,iconCss:"e-icons e-de-ctnr-change-case",enableRtl:i.isRtl});var o=(0,a.az)("div",{id:n.id+"_changeCase",className:"e-de-ctnr-group-btn"}),l=(0,a.az)("button",{id:o.id+"_dropdownBtn",attrs:{type:"button"}});o.appendChild(l),n.appendChild(o),i.changeCaseDropdown.appendTo(l)},this.changeCase=function(n){i.isRetrieving||"uppercase"!==n.item.id||!i.documentEditor.isReadOnly&&i.documentEditor.editor&&i.documentEditor.editor.changeCase("Uppercase")},this.container=e,this.isRtl=t}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.initializeTextPropertiesDiv=function(e,t){this.localObj=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties",n=this.createDiv(i+"_text",e);(0,a.s1)(n,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var r=this.createDiv(i+"_sizeStyle",n,"display:inline-flex;");(0,a.s1)(r,["e-de-ctnr-segment"],[]),t&&(0,a.s1)(r,["e-de-ctnr-segment-rtl"],[]);var o=this.createDiv(i+"_fontFamilyDiv",r),l=(0,a.az)("input",{id:i+"_fontFamily",className:"e-prop-font-style"});o.appendChild(l),(0,a.s1)(o,["e-de-panel-left-width"],[]),this.createDropDownListForFamily(l);var h=this.createDiv(i+"_fontSizeDiv",r),d="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(d="e-rtl "+d);var c=(0,a.az)("input",{id:i+"_fontSize",innerHTML:"type:number",className:"e-prop-font-style"});h.appendChild(c),(0,a.s1)(h,["e-de-panel-right-width"],[]),this.createDropDownListForSize(c);var u=(0,a.az)("div",{id:i+"_properties",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&(0,a.s1)(u,["e-de-ctnr-segment-rtl"],[]),n.appendChild(u);var p=(0,a.az)("div",{id:i+"_leftDiv",className:d,styles:"display:inline-flex;"});u.appendChild(p),this.bold=this.createButtonTemplate(i+"_bold","e-de-ctnr-bold e-icons",p,"e-de-prop-font-button","40.5","Bold Tooltip"),this.italic=this.createButtonTemplate(i+"_italic","e-de-ctnr-italic e-icons",p,"e-de-prop-font-button","40.5","Italic Tooltip"),this.underline=this.createButtonTemplate(i+"_underline","e-de-ctnr-underline e-icons",p,"e-de-prop-font-button","40.5","Underline Tooltip"),this.strikethrough=this.createButtonTemplate(i+"_strikethrough","e-de-ctnr-strikethrough e-icons",p,"e-de-prop-font-last-button","40.5","Strikethrough"),d="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(d="e-rtl "+d);var f=(0,a.az)("div",{id:i+"_rightDiv",className:d,styles:"display:inline-flex;"});u.appendChild(f),this.superscript=this.createButtonTemplate(i+"_superscript","e-de-ctnr-superscript e-icons",f,"e-de-prop-font-button","38.5","Superscript Tooltip"),this.subscript=this.createButtonTemplate(i+"_subscript","e-de-ctnr-subscript e-icons",f,"e-de-prop-font-last-button","38.5","Subscript Tooltip");var g=(0,a.az)("div",{id:i+"_colorDiv",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&(0,a.s1)(u,["e-de-ctnr-segment-rtl"],[]);var m=(0,a.az)("div",{id:i+"_color",className:"e-de-font-clr-picker e-de-ctnr-group-btn",styles:"display:inline-flex;"});t&&(0,a.s1)(m,["e-rtl"],[]),g.appendChild(m),n.appendChild(g),this.fontColor=this.createFontColorPicker(i+"_textColor",40.5,m,this.localObj.getConstant("Font color")),(0,a.s1)(m.firstElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-fontcolor","e-icons"],["e-caret"]),this.initializeHighlightColorElement(),this.highlightColor=this.createHighlightColorSplitButton(i+"_highlightColor",34.5,m,this.localObj.getConstant("Text highlight color")),(0,a.s1)(this.highlightColor.element.nextElementSibling.firstElementChild,["e-de-ctnr-highlight","e-icons"],["e-caret"]),this.highlightColorInputElement=this.highlightColor.element.firstChild,this.clearFormat=this.createButtonTemplate(i+"_clearFormat","e-de-ctnr-clearall e-icons",m,"e-de-prop-font-last-button","40.5","Clear all formatting");var v=(0,a.az)("div",{id:i+"_rightDiv2",className:d.replace("e-btn-group",""),styles:"display:inline-flex;"});t&&(0,a.s1)(v,["e-rtl"],[]),v.setAttribute("title",this.container.localObj.getConstant("Change case Tooltip")),n.appendChild(v),this.createChangecase(v)},s.prototype.createHighlightColorSplitButton=function(e,t,i,n){var r=this,o=(0,a.az)("button",{id:e,attrs:{type:"button"}});i.appendChild(o);var l=new Ue.aW({cssClass:"e-de-btn-hghlclr",iconCss:"e-de-ctnr-hglt-color",target:this.highlightColorElement,close:this.closePopup.bind(this),beforeOpen:this.openPopup.bind(this),enableRtl:this.isRtl});return l.appendTo(o),l.click=function(){r.applyHighlightColor(r.highlightColorInputElement.style.backgroundColor)},l.element.firstChild.style.backgroundColor="rgb(255, 255, 0)",l.element.parentElement.setAttribute("title",n),l},s.prototype.openPopup=function(){this.highlightColorElement.style.display="block"},s.prototype.closePopup=function(){this.highlightColorElement.style.display="none"},s.prototype.initializeHighlightColorElement=function(){this.highlightColorElement=(0,a.az)("div",{styles:"display:none;width:157px",className:"e-de-cntr-highlight-pane"});var e=this.createHightlighColorPickerDiv("#ffff00","yellowDiv"),t=this.createHightlighColorPickerDiv("#00ff00","brightGreenDiv"),i=this.createHightlighColorPickerDiv("#00ffff","turquoiseDiv"),n=this.createHightlighColorPickerDiv("#ff00ff","hotPinkDiv"),r=this.createHightlighColorPickerDiv("#0000ff","blueDiv"),o=this.createHightlighColorPickerDiv("#ff0000","redDiv"),l=this.createHightlighColorPickerDiv("#000080","darkBlueDiv"),h=this.createHightlighColorPickerDiv("#008080","tealDiv"),d=this.createHightlighColorPickerDiv("#008000","greenDiv"),c=this.createHightlighColorPickerDiv("#800080","violetDiv"),u=this.createHightlighColorPickerDiv("#800000","darkRedDiv"),p=this.createHightlighColorPickerDiv("#808000","darkYellowDiv"),f=this.createHightlighColorPickerDiv("#808080","gray50Div"),g=this.createHightlighColorPickerDiv("#c0c0c0","gray25Div"),m=this.createHightlighColorPickerDiv("#000000","blackDiv"),v=(0,a.az)("div",{className:"e-hglt-no-color"});this.highlightColorElement.appendChild(v);var y=(0,a.az)("div",{styles:"width:24px;height:24px;background-color:#ffffff;margin:3px;",id:"noColorDiv"});v.appendChild(y);var b=(0,a.az)("div",{innerHTML:this.localObj.getConstant("No color"),className:"e-de-ctnr-hglt-no-color"});y.appendChild(b),e.addEventListener("click",this.onHighLightColor.bind(this)),t.addEventListener("click",this.onHighLightColor.bind(this)),i.addEventListener("click",this.onHighLightColor.bind(this)),n.addEventListener("click",this.onHighLightColor.bind(this)),r.addEventListener("click",this.onHighLightColor.bind(this)),o.addEventListener("click",this.onHighLightColor.bind(this)),l.addEventListener("click",this.onHighLightColor.bind(this)),h.addEventListener("click",this.onHighLightColor.bind(this)),d.addEventListener("click",this.onHighLightColor.bind(this)),c.addEventListener("click",this.onHighLightColor.bind(this)),u.addEventListener("click",this.onHighLightColor.bind(this)),p.addEventListener("click",this.onHighLightColor.bind(this)),f.addEventListener("click",this.onHighLightColor.bind(this)),g.addEventListener("click",this.onHighLightColor.bind(this)),m.addEventListener("click",this.onHighLightColor.bind(this)),v.addEventListener("click",this.onHighLightColor.bind(this))},s.prototype.createHightlighColorPickerDiv=function(e,t){var i=(0,a.az)("div",{className:"e-de-ctnr-hglt-btn",id:t});return i.style.backgroundColor=e,this.highlightColorElement.appendChild(i),i},s.prototype.onHighLightColor=function(e){this.documentEditor.selection&&(this.applyHighlightColor(e.currentTarget.style.backgroundColor),this.highlightColor.toggle())},s.prototype.applyHighlightColorAsBackground=function(e){this.removeSelectedColorDiv(),"NoColor"===e?this.highlightColorElement.querySelector("#noColorDiv").classList.add("e-color-selected"):"Yellow"===e?this.highlightColorElement.querySelector("#yellowDiv").classList.add("e-color-selected"):"BrightGreen"===e?this.highlightColorElement.querySelector("#brightGreenDiv").classList.add("e-color-selected"):"Turquoise"===e?this.highlightColorElement.querySelector("#turquoiseDiv").classList.add("e-color-selected"):"Pink"===e?this.highlightColorElement.querySelector("#hotPinkDiv").classList.add("e-color-selected"):"Red"===e?this.highlightColorElement.querySelector("#redDiv").classList.add("e-color-selected"):"DarkBlue"===e?this.highlightColorElement.querySelector("#darkBlueDiv").classList.add("e-color-selected"):"Teal"===e?this.highlightColorElement.querySelector("#tealDiv").classList.add("e-color-selected"):"Green"===e?this.highlightColorElement.querySelector("#greenDiv").classList.add("e-color-selected"):"Violet"===e?this.highlightColorElement.querySelector("#violetDiv").classList.add("e-color-selected"):"DarkRed"===e?this.highlightColorElement.querySelector("#darkRedDiv").classList.add("e-color-selected"):"DarkYellow"===e?this.highlightColorElement.querySelector("#darkYellowDiv").classList.add("e-color-selected"):"Gray50"===e?this.highlightColorElement.querySelector("#gray50Div").classList.add("e-color-selected"):"Gray25"===e?this.highlightColorElement.querySelector("#gray25Div").classList.add("e-color-selected"):"Black"===e?this.highlightColorElement.querySelector("#blackDiv").classList.add("e-color-selected"):"Blue"===e&&this.highlightColorElement.querySelector("#blueDiv").classList.add("e-color-selected")},s.prototype.removeSelectedColorDiv=function(){this.highlightColorElement.querySelector("#noColorDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#yellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#brightGreenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#turquoiseDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#hotPinkDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#redDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkBlueDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#tealDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#greenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#violetDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkRedDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkYellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray50Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray25Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#blackDiv").classList.remove("e-color-selected")},s.prototype.applyHighlightColor=function(e){this.appliedHighlightColor=e;var t=this.getHighLightColor(e);"NoColor"===t&&(this.documentEditor.selection.characterFormat.highlightColor=null),this.documentEditor.selection.characterFormat.highlightColor=t},s.prototype.getHighLightColor=function(e){switch(e){case"rgb(255, 255, 0)":return"Yellow";case"rgb(0, 255, 0)":return"BrightGreen";case"rgb(0, 255, 255)":return"Turquoise";case"rgb(255, 0, 255)":return"Pink";case"rgb(0, 0, 255)":return"Blue";case"rgb(255, 0, 0)":return"Red";case"rgb(0, 0, 128)":return"DarkBlue";case"rgb(0, 128, 128)":return"Teal";case"rgb(0, 128, 0)":return"Green";case"rgb(128, 0, 128)":return"Violet";case"rgb(128, 0, 0)":return"DarkRed";case"rgb(128, 128, 0)":return"DarkYellow";case"rgb(128, 128, 128)":return"Gray50";case"rgb(192, 192, 192)":return"Gray25";case"rgb(0, 0, 0)":return"Black";default:return"NoColor"}},s.prototype.createDiv=function(e,t,i){var n;return n=(0,a.az)("div",i?{id:e,styles:i}:{id:e}),t.appendChild(n),n},s.prototype.createButtonTemplate=function(e,t,i,n,r,o){var l=(0,a.az)("Button",{id:e,attrs:{type:"button"}});i.appendChild(l);var h=new M.zx({cssClass:n,iconCss:t,enableRtl:this.isRtl});switch(h.appendTo(l),l.setAttribute("title",this.localObj.getConstant(o)),o){case"Bold Tooltip":this.boldBtn=h;break;case"Italic Tooltip":this.italicBtn=h;break;case"Underline Tooltip":this.underlineBtn=h;break;case"Strikethrough":this.strikethroughBtn=h;break;case"Superscript Tooltip":this.superscriptBtn=h;break;case"Subscript Tooltip":this.subscriptBtn=h;break;default:this.clearFormatBtn=h}return l},s.prototype.createFontColorPicker=function(e,t,i,n){var r=(0,a.az)("input",{id:e,attrs:{type:"color"}});return r.style.width=t+"px",i.appendChild(r),this.fontColorInputElement=new J.zH({value:"#000000",showButtons:!0,enableRtl:this.isRtl,locale:this.container.locale},r),this.fontColorInputElement.element.parentElement.setAttribute("title",n),r},s.prototype.createDropDownListForSize=function(e){var t=this;this.fontSize=new Te.Ct({dataSource:["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72","96"],popupHeight:"180px",popupWidth:"80px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl}),this.fontSize.focus=function(){t.isRetrieving=!1,t.fontSize.element.select()},this.fontSize.value=this.documentEditor.selection.characterFormat.fontSize.toString(),this.fontSize.appendTo(e),this.fontSize.element.parentElement.setAttribute("title",this.localObj.getConstant("Font Size"))},s.prototype.createDropDownListForFamily=function(e){var t=this,n=!1,r="";this.container.enableCsp||(r='<span style="font-family: ${FontName};">${FontName}</span>',n=!0),this.fontFamily=new Te.Ct({dataSource:void 0,query:(new ri.AE).select(["FontName"]),fields:{text:"FontName",value:"FontValue"},popupHeight:"150px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl,itemTemplate:r}),this.fontFamily.appendTo(e),this.fontFamily.isStringTemplate=n;for(var o=this.container.documentEditorSettings.fontFamilies,l=0;l<o.length;l++){var h=o[l];this.fontFamily.addItem({FontName:h,FontValue:h},l)}this.fontFamily.focus=function(){t.isRetrieving=!1,t.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"))},s.prototype.wireEvent=function(){var e=this;this.fontFamily.addEventListener("change",function(){e.changeFontFamily()}),this.fontSize.addEventListener("change",function(){e.changeFontSize()}),this.bold.addEventListener("click",function(){e.isRetrieving=!1,e.boldAction()}),this.italic.addEventListener("click",function(){e.isRetrieving=!1,e.italicAction()}),this.underline.addEventListener("click",function(){e.isRetrieving=!1,e.underlineAction()}),this.strikethrough.addEventListener("click",function(){e.isRetrieving=!1,e.strikethroughAction()}),this.superscript.addEventListener("click",function(){e.isRetrieving=!1,e.superscriptAction()}),this.subscript.addEventListener("click",function(){e.isRetrieving=!1,e.subscriptAction()}),this.fontColorInputElement.addEventListener("change",function(t){e.isRetrieving=!1,e.changeFontColor(t)}),this.clearFormat.addEventListener("click",function(){e.isRetrieving=!1,e.clearFormatAction()}),this.changeCaseDropdown.addEventListener("select",function(t){e.isRetrieving=!1,e.changeCase(t)})},s.prototype.unwireEvents=function(){this.fontFamily.change=void 0,this.fontSize.change=void 0,this.bold.click=void 0,this.italic.click=void 0,this.underline.click=void 0,this.strikethrough.click=void 0,this.superscript.click=void 0,this.subscript.click=void 0,this.fontColorInputElement.change=void 0,this.highlightColorElement.click=void 0,this.highlightColor.click=void 0,this.clearFormat.click=void 0,this.changeCaseDropdown.select=void 0},s.prototype.boldAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleBold()},s.prototype.italicAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleItalic()},s.prototype.underlineAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleUnderline("Single")},s.prototype.strikethroughAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleStrikethrough()},s.prototype.clearFormatAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.clearFormatting()},s.prototype.subscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleSubscript()},s.prototype.superscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleSuperscript()},s.prototype.changeFontColor=function(e){var t=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&(this.documentEditor.selection.characterFormat.fontColor=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},30))},s.prototype.changeFontFamily=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&""!==this.fontFamily.value&&setTimeout(function(){e.documentEditor.selection.characterFormat.fontFamily=e.fontFamily.value},10)},s.prototype.changeFontSize=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&""!==this.fontSize.value&&setTimeout(function(){e.documentEditor.selection.characterFormat.fontSize=e.fontSize.value},10)},s.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.selection){if(this.documentEditor.selection.characterFormat.fontFamily?(this.fontFamily.value=this.documentEditor.selection.characterFormat.fontFamily,this.fontFamily.dataBind()):this.fontFamily.value="",this.documentEditor.selection.characterFormat.fontSize?(this.fontSize.value=this.documentEditor.selection.characterFormat.fontSize.toString(),this.fontSize.dataBind()):this.fontSize.value="",this.documentEditor.selection.characterFormat.bold?this.bold.classList.contains("e-btn-toggle")||this.bold.classList.add("e-btn-toggle"):this.bold.classList.contains("e-btn-toggle")&&this.bold.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.italic?this.italic.classList.contains("e-btn-toggle")||this.italic.classList.add("e-btn-toggle"):this.italic.classList.contains("e-btn-toggle")&&this.italic.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.underline&&"None"!==this.documentEditor.selection.characterFormat.underline?this.underline.classList.contains("e-btn-toggle")||this.underline.classList.add("e-btn-toggle"):this.underline.classList.contains("e-btn-toggle")&&this.underline.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.strikethrough&&"None"!==this.documentEditor.selection.characterFormat.strikethrough?this.strikethrough.classList.contains("e-btn-toggle")||this.strikethrough.classList.add("e-btn-toggle"):this.strikethrough.classList.contains("e-btn-toggle")&&this.strikethrough.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.baselineAlignment&&"Subscript"===this.documentEditor.selection.characterFormat.baselineAlignment?this.subscript.classList.contains("e-btn-toggle")||this.subscript.classList.add("e-btn-toggle"):this.subscript.classList.contains("e-btn-toggle")&&this.subscript.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.baselineAlignment&&"Superscript"===this.documentEditor.selection.characterFormat.baselineAlignment?this.superscript.classList.contains("e-btn-toggle")||this.superscript.classList.add("e-btn-toggle"):this.superscript.classList.contains("e-btn-toggle")&&this.superscript.classList.remove("e-btn-toggle"),this.documentEditor.selection.characterFormat.fontColor){var e=this.documentEditor.selection.characterFormat.fontColor;("empty"===e||"#00000000"===e)&&(e="#000000"),this.fontColorInputElement.value=e}this.documentEditor.selection.characterFormat.highlightColor&&(this.highlightColorInputElement.style.backgroundColor=this.appliedHighlightColor,this.applyHighlightColorAsBackground(this.documentEditor.selection.characterFormat.highlightColor))}},s.prototype.destroy=function(){this.highlightColor&&(this.highlightColor.destroy(),this.highlightColor=void 0),this.fontColorInputElement&&(this.fontColorInputElement.destroy(),this.fontColorInputElement=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.changeCaseDropdown&&(this.changeCaseDropdown.destroy(),this.changeCaseDropdown=void 0),this.boldBtn&&(this.boldBtn.destroy(),this.boldBtn=void 0),this.italicBtn&&(this.italicBtn.destroy(),this.italicBtn=void 0),this.underlineBtn&&(this.underlineBtn.destroy(),this.underlineBtn=void 0),this.strikethroughBtn&&(this.strikethroughBtn.destroy(),this.strikethroughBtn=void 0),this.subscriptBtn&&(this.subscriptBtn.destroy(),this.subscriptBtn=void 0),this.superscriptBtn&&(this.superscriptBtn.destroy(),this.superscriptBtn=void 0),this.clearFormatBtn&&(this.clearFormatBtn.destroy(),this.clearFormatBtn=void 0),this.container=void 0},s}(),Ns=function(){function s(e){this.isRetrieving=!1,this.appliedBulletStyle="dot",this.appliedNumberingStyle="arabic",this.appliedLineSpacing="",this.splitButtonClass="e-de-prop-splitbutton",this.container=e}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.initializeParagraphPropertiesDiv=function(e,t){this.localObj=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.isRtl=t,this.isRtl&&(this.splitButtonClass="e-rtl "+this.splitButtonClass),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties",n=this.createDivElement(i+"_paragraph",e,"");(0,a.s1)(n,["e-de-cntr-pane-padding"],[]);var r=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});r.innerHTML=this.localObj.getConstant("Paragraph"),n.appendChild(r);var o=this.createDivElement(i+"_styleDiv",n);o.classList.add("e-de-ctnr-segment","e-de-ctnr-style-div");var l=(0,a.az)("input",{id:i+"_style",styles:"width:248px;letter-spacing: 0.05px;"});o.appendChild(l),this.createStyleDropDownList(l);var h=this.createDivElement(i+"_indentWholeDiv",n);h.style.display="flex",h.classList.add("e-de-ctnr-segment"),t&&(0,a.s1)(h,["e-de-ctnr-segment-rtl"],[]);var d=this.createDivElement(i+"_indentDiv",h,"display:flex;"),c="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(c="e-rtl "+c),d.className=c,this.leftAlignment=this.createButtonTemplate(i+"_leftIndent","e-de-ctnr-alignleft e-icons",d,"e-de-prop-indent-button","40.5","Align left Tooltip"),this.centerAlignment=this.createButtonTemplate(i+"_centerIndent","e-de-ctnr-aligncenter e-icons",d,"e-de-prop-indent-button","40.5","Center Tooltip"),this.rightAlignment=this.createButtonTemplate(i+"_rightIndent","e-de-ctnr-alignright e-icons",d,"e-de-prop-indent-button","40.5","Align right Tooltip"),this.justify=this.createButtonTemplate(i+"_justify","e-de-ctnr-justify e-icons",d,"e-de-prop-indent-last-button","40.5","Justify Tooltip");var u="e-de-ctnr-increaseindent e-icons",p="e-de-ctnr-decreaseindent e-icons",f=this.createDivElement(i+"_indentDiv",h,"display:flex;");c="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(c="e-rtl "+c,u+=" e-de-flip",p+=" e-de-flip"),f.className=c,this.decreaseIndent=this.createButtonTemplate(i+"_decreaseIndent",p,f,"e-de-prop-indent-button","37","Decrease indent"),this.increaseIndent=this.createButtonTemplate(i+"_increaseIndent",u,f,"e-de-prop-indent-last-button","37","Increase indent");var g=this.createDivElement(i+"_listDiv",n,"display:flex;"),m=this.createDivElement(i+"_paraDiv",n,"display:flex");(0,a.s1)(g,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),(0,a.s1)(m,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),t&&((0,a.s1)(g,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]),(0,a.s1)(m,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]));var v=(0,a.az)("button",{id:i+"_lineHeight",attrs:{type:"button"}});g.appendChild(v),this.lineSpacing=this.createLineSpacingDropdown(v);var y=this.createDivElement(i+"_listDropDiv",g);(0,a.s1)(y,["de-split-button","e-de-ctnr-segment-list"],[]),t&&(0,a.s1)(y,["e-de-ctnr-segment-list-rtl"],[]);var b=(0,a.az)("button",{id:i+"_bullet",attrs:{type:"button"}});y.appendChild(b);var C=(0,a.az)("button",{id:i+"_numberingList",attrs:{type:"button"}});y.appendChild(C);var F="e-de-ctnr-bullets e-icons",T="e-de-ctnr-numbering e-icons";t&&(F+=" e-de-flip",T+=" e-de-flip"),this.createBulletListDropButton(F,b),this.createNumberListDropButton(T,C),this.borders=this.createButtonTemplate(i+"_borders","e-de-ctnr-borders e-icons",m,"e-de-ctnr-group-btn","37","Borders"),this.showHiddenMarks=this.createButtonTemplate(i+"_paraMark","e-de-e-paragraph-mark e-icons",m,"e-de-ctnr-group-btn","37","ShowHiddenMarks Tooltip")},s.prototype.createSeparator=function(e){var t=(0,a.az)("div",{className:"e-de-prop-vline"});e.appendChild(t)},s.prototype.createDivElement=function(e,t,i){var n;return n=(0,a.az)("div",i?{id:e,styles:i}:{id:e}),t.appendChild(n),n},s.prototype.createButtonTemplate=function(e,t,i,n,r,o){var l=(0,a.az)("Button",{id:e,attrs:{type:"button"}});i.appendChild(l);var h=new M.zx({cssClass:n,iconCss:t});switch(h.appendTo(l),l.setAttribute("title",this.localObj.getConstant(o)),o){case"Align left Tooltip":this.leftAlignmentBtn=h;break;case"Align right Tooltip":this.rightAlignmentBtn=h;break;case"Justify Tooltip":this.justifyBtn=h;break;case"Decrease indent":this.decreaseIndentBtn=h;break;case"Increase indent":this.increaseIndentBtn=h;break;case"Borders":this.bordersBtn=h;break;case"ShowHiddenMarks Tooltip":this.showHiddenMarksBtn=h;break;default:this.centerAlignmentBtn=h}return l},s.prototype.createLineSpacingDropdown=function(e){var t=this,i=[{text:this.localObj.getConstant("Single")},{text:"1.15"},{text:"1.5"},{text:this.localObj.getConstant("Double")}],n=new Ue.uw({items:i,iconCss:"e-de-ctnr-linespacing e-icons",enableRtl:this.isRtl,select:this.lineSpacingAction.bind(this),cssClass:this.splitButtonClass,beforeItemRender:function(r){r.element.innerHTML="<span></span>"+r.item.text;var o=r.element.children[0];r.item.text===t.appliedLineSpacing?(o.style.marginRight="10px",o.setAttribute("class","e-de-selected-item e-icons e-de-linespacing")):(r.element.children[0].style.marginRight="25px",r.element.children[0].classList.remove("e-de-selected-item"))}});return n.appendTo(e),e.setAttribute("title",this.localObj.getConstant("Line spacing")),n},s.prototype.createNumberListDropButton=function(e,t){var i=this,n=(0,a.az)("div",{id:"target",styles:"width: 211px;height: auto;display:none"}),r=(0,a.az)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"});n.appendChild(r),this.noneNumberTag=this.createNumberNoneListTag(r),this.noneNumberTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.numberList=this.createNumberListTag(r,"1.","2.","3."),this.numberList.addEventListener("click",this.numberedNumberDotClick.bind(this)),this.lowLetter=this.createNumberListTag(r,"a.","b.","c."),this.lowLetter.addEventListener("click",this.numberedLowLetterClick.bind(this)),this.upLetter=this.createNumberListTag(r,"A.","B.","C."),this.upLetter.addEventListener("click",this.numberedUpLetterClick.bind(this)),this.lowRoman=this.createNumberListTag(r,"i.","ii.","iii."),this.lowRoman.addEventListener("click",this.numberedLowRomanClick.bind(this)),this.upRoman=this.createNumberListTag(r,"I.","II.","III."),this.upRoman.addEventListener("click",this.numberedUpRomanClick.bind(this)),this.numberedListBtn=new Ue.aW({target:n,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){n.style.display="block";var l="None";if(!(0,a.le)(i.documentEditor.selection.paragraphFormat))if((0,a.le)(i.documentEditor.selection.paragraphFormat.listId)||-1==i.documentEditor.selection.paragraphFormat.listId)l="None";else{var h=i.documentEditor.documentHelper.getListById(i.documentEditor.selection.paragraphFormat.listId);l=i.documentEditor.documentHelper.getAbstractListById(h.abstractListId).levels[i.documentEditor.selection.paragraphFormat.listLevelNumber].listLevelPattern}i.updateSelectedNumberedListType(l)},beforeClose:function(){n.style.display="none",i.removeSelectedList()}}),this.numberedListBtn.click=function(){i.applyLastAppliedNumbering()},this.numberedListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Numbering"))},s.prototype.updateSelectedBulletListType=function(e){switch(e){case String.fromCharCode(61623):this.dotBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61551)+String.fromCharCode(32):this.circleBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61607):this.squareBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61558):this.flowerBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61656):this.arrowBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61692):this.tickBullet.classList.add("de-list-item-selected");break;default:this.noneBulletTag.classList.add("de-list-item-selected")}},s.prototype.updateSelectedNumberedListType=function(e){switch(e){case"Arabic":this.numberList.classList.add("de-list-item-selected");break;case"UpRoman":this.upRoman.classList.add("de-list-item-selected");break;case"UpLetter":this.upLetter.classList.add("de-list-item-selected");break;case"LowLetter":this.lowLetter.classList.add("de-list-item-selected");break;case"LowRoman":this.lowRoman.classList.add("de-list-item-selected");break;default:this.noneNumberTag.classList.add("de-list-item-selected")}},s.prototype.removeSelectedList=function(){var e="de-list-item-selected";this.noneNumberTag.classList.remove(e),this.numberList.classList.remove(e),this.lowLetter.classList.remove(e),this.upLetter.classList.remove(e),this.lowRoman.classList.remove(e),this.upRoman.classList.remove(e),this.noneBulletTag.classList.remove(e),this.dotBullet.classList.remove(e),this.circleBullet.classList.remove(e),this.squareBullet.classList.remove(e),this.flowerBullet.classList.remove(e),this.arrowBullet.classList.remove(e),this.tickBullet.classList.remove(e)},s.prototype.applyLastAppliedNumbering=function(){switch(this.appliedNumberingStyle){case"arabic":this.numberedNumberDotClick();break;case"lowletter":this.numberedLowLetterClick();break;case"upletter":this.numberedUpLetterClick();break;case"lowroman":this.numberedLowRomanClick();break;case"uproman":this.numberedUpRomanClick()}},s.prototype.applyLastAppliedBullet=function(){switch(this.appliedBulletStyle){case"dot":this.bulletDotClick();break;case"circle":this.bulletCircleClick();break;case"square":this.bulletSquareClick();break;case"arrow":this.bulletArrowClick();break;case"tick":this.bulletTickClick();break;case"flower":this.bulletFlowerClick()}},s.prototype.createBulletListDropButton=function(e,t){var i=this,n=(0,a.az)("div",{id:"bullet_list",styles:"width: 196px;height: auto;display:none"}),r=(0,a.az)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"});n.appendChild(r),this.noneBulletTag=this.createBulletListTag(r,"e-de-ctnr-bullet-none e-icons e-de-ctnr-list",!0),this.noneBulletTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.dotBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-dot e-icons e-de-ctnr-list",!1),this.dotBullet.addEventListener("click",this.bulletDotClick.bind(this)),this.circleBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-circle e-icons e-de-ctnr-list",!1),this.circleBullet.addEventListener("click",this.bulletCircleClick.bind(this)),this.squareBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-square e-icons e-de-ctnr-list",!1),this.squareBullet.addEventListener("click",this.bulletSquareClick.bind(this)),this.flowerBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-flower e-icons e-de-ctnr-list",!1),this.flowerBullet.addEventListener("click",this.bulletFlowerClick.bind(this)),this.arrowBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-arrow e-icons e-de-ctnr-list",!1),this.arrowBullet.addEventListener("click",this.bulletArrowClick.bind(this)),this.tickBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-tick e-icons e-de-ctnr-list",!1),this.tickBullet.addEventListener("click",this.bulletTickClick.bind(this)),this.bulletListBtn=new Ue.aW({target:n,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){n.style.display="block",i.updateSelectedBulletListType(i.documentEditor.selection.paragraphFormat.listText)},beforeClose:function(){n.style.display="none",i.removeSelectedList()}}),this.bulletListBtn.click=function(){i.applyLastAppliedBullet()},this.bulletListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Bullets"))},s.prototype.createNumberListTag=function(e,t,i,n){var r=(0,a.az)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(r);var o="<div>"+t+'<span class="e-de-list-line"></span></div><div>'+i+'<span class="e-de-list-line">',l=(0,a.az)("div",{className:"e-de-list-header-presetmenu",innerHTML:o+="</span></div><div>"+n+'<span class="e-de-list-line"> </span></div >'});return r.appendChild(l),r},s.prototype.createNumberNoneListTag=function(e){var t=(0,a.az)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(t);var i='<div><span class="e-de-bullets">'+this.localObj.getConstant("None")+"</span></div>",n=(0,a.az)("div",{className:"e-de-list-header-presetmenu",styles:"position:relative;left:11px;top:13px",innerHTML:i});return t.appendChild(n),t},s.prototype.createBulletListTag=function(e,t,i){var n=(0,a.az)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-bullet-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(n);var r=(0,a.az)("div",{className:"e-de-bullet-list-header-presetmenu"}),o=(0,a.az)("div",{styles:i?"font-size:8px;text-align: center;top: 8px;line-height:normal":""});r.appendChild(o);var l=(0,a.az)("span",{className:i?"":t});return o.appendChild(l),i&&(r.style.display="inline-table",l.textContent=this.localObj.getConstant("None")),n.appendChild(r),n},s.prototype.createStyleDropDownList=function(e){this.style=new Te.NB({dataSource:[{StyleName:"Normal",Class:"e-icons e-edit-font"}],cssClass:"e-de-prop-dropdown",popupHeight:"240px",enableRtl:this.isRtl,query:(new ri.AE).select(["StyleName","Style"]),fields:{text:"StyleName",value:"StyleName"},change:this.selectStyleValue.bind(this)}),this.container.enableCsp||(this.style.open=this.updateOptions.bind(this),this.style.itemTemplate='<span style="${Style}">${StyleName}</span>',this.style.footerTemplate='<span class="e-de-ctnr-dropdown-ftr">'+this.localObj.getConstant("Manage Styles")+"...</span>",this.style.isStringTemplate=!0),this.style.appendTo(e),e.parentElement.setAttribute("title",this.localObj.getConstant("Styles"))},s.prototype.updateOptions=function(e){this.updateStyleNames(),e.popup.element.getElementsByClassName("e-de-ctnr-dropdown-ftr")[0].addEventListener("click",this.createStyle.bind(this))},s.prototype.updateStyleNames=function(){this.styleName=(0,a.le)(this.style.itemData)?void 0:this.style.itemData.StyleName,this.style.dataSource=this.constructStyleDropItems(this.documentEditor.getStyles("Paragraph")),this.style.dataBind(),this.onSelectionChange()},s.prototype.createStyle=function(){this.style.hidePopup(),this.documentEditor.isReadOnly||this.documentEditor.showDialog("Styles")},s.prototype.constructStyleDropItems=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i],o={},l=this.localObj.getConstant(r.name);o.StyleName=""===l?r.name:l,o.Style=this.parseStyle(r.style),t.push(o)}return t},s.prototype.parseStyle=function(e){var t="",i=JSON.parse(e),n="";if(!(0,a.le)(i.characterFormat.baselineAlignment)&&"Normal"!==i.characterFormat.baselineAlignment){var r="";switch(i.characterFormat.baselineAlignment){case"Superscript":r="super";break;case"Subscript":r="sub"}r.length>1&&(t+="vertical-align:"+r+";")}return!(0,a.le)(i.characterFormat.underline)&&"None"!==i.characterFormat.underline&&(n+="underline "),!(0,a.le)(i.characterFormat.strikethrough)&&"None"!==i.characterFormat.strikethrough&&(n+="line-through "),(0,a.le)(i.characterFormat.fontSize)||(t+="font-size:"+i.characterFormat.fontSize+"px;"),(0,a.le)(i.characterFormat.fontFamily)||(t+="font-family:"+i.characterFormat.fontFamily+";"),!(0,a.le)(i.characterFormat.bold)&&i.characterFormat.bold&&(t+="font-weight:bold;"),!(0,a.le)(i.characterFormat.italic)&&i.characterFormat.italic&&(t+="font-style:italic;"),n.length>1&&(t+="text-decoration:"+n+";"),t},s.prototype.wireEvent=function(){var e=this;this.leftAlignment.addEventListener("click",function(){e.leftAlignmentAction()}),this.rightAlignment.addEventListener("click",function(){e.rightAlignmentAction()}),this.centerAlignment.addEventListener("click",function(){e.centerAlignmentAction()}),this.justify.addEventListener("click",function(){e.justifyAction()}),this.increaseIndent.addEventListener("click",function(){e.increaseIndentAction()}),this.showHiddenMarks.addEventListener("click",function(){e.container.documentEditorSettings.showHiddenMarks=!e.container.documentEditorSettings.showHiddenMarks,e.toggleHiddenMarks(),setTimeout(function(){e.documentEditor.focusIn()},30)}),this.decreaseIndent.addEventListener("click",function(){e.decreaseIndentAction()}),this.lineSpacing.addEventListener("select",function(t){e.lineSpacingAction(t)}),this.borders.addEventListener("click",function(){e.documentEditor.showBordersAndShadingDialog()})},s.prototype.unwireEvents=function(){this.leftAlignment.click=void 0,this.rightAlignment.click=void 0,this.centerAlignment.click=void 0,this.justify.click=void 0,this.increaseIndent.click=void 0,this.decreaseIndent.click=void 0,this.lineSpacing.select=void 0,this.style.select=void 0},s.prototype.toggleHiddenMarks=function(){this.container.documentEditorSettings.showHiddenMarks?(0,a.s1)(this.showHiddenMarks,["e-btn-toggle"],[]):(0,a.s1)(this.showHiddenMarks,[],["e-btn-toggle"])},s.prototype.leftAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleTextAlignment("Left")},s.prototype.lineSpacingAction=function(e){var t=this;if(!this.isRetrieving){switch(e.item.text){case this.localObj.getConstant("Single"):this.documentEditor.selection.paragraphFormat.lineSpacing=1;break;case"1.15":this.documentEditor.selection.paragraphFormat.lineSpacing=1.15;break;case"1.5":this.documentEditor.selection.paragraphFormat.lineSpacing=1.5;break;case this.localObj.getConstant("Double"):this.documentEditor.selection.paragraphFormat.lineSpacing=2}setTimeout(function(){t.documentEditor.focusIn()},30)}},s.prototype.setLineSpacing=function(){var e=this.documentEditor.selection.paragraphFormat.lineSpacing;this.appliedLineSpacing=1===e?this.localObj.getConstant("Single"):1.15===e?"1.15":1.5===e?"1.5":2===e?this.localObj.getConstant("Double"):""},s.prototype.selectStyleValue=function(e){var t=this;this.isRetrieving||!e.isInteracted||setTimeout(function(){t.applyStyleValue(e)},10)},s.prototype.applyStyleValue=function(e){!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.localObj.getConstant("Heading 1")===e.itemData.StyleName?e.itemData.StyleName="Heading 1":this.localObj.getConstant("Heading 2")===e.itemData.StyleName?e.itemData.StyleName="Heading 2":this.localObj.getConstant("Heading 3")===e.itemData.StyleName?e.itemData.StyleName="Heading 3":this.localObj.getConstant("Heading 4")===e.itemData.StyleName?e.itemData.StyleName="Heading 4":this.localObj.getConstant("Heading 5")===e.itemData.StyleName?e.itemData.StyleName="Heading 5":this.localObj.getConstant("Heading 6")===e.itemData.StyleName?e.itemData.StyleName="Heading 6":this.localObj.getConstant("Normal")===e.itemData.StyleName&&(e.itemData.StyleName="Normal"),this.documentEditor.editor.applyStyle(e.itemData.StyleName,!0))},s.prototype.rightAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleTextAlignment("Right")},s.prototype.centerAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleTextAlignment("Center")},s.prototype.justifyAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.toggleTextAlignment("Justify")},s.prototype.increaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.increaseIndent()},s.prototype.decreaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.decreaseIndent()},s.prototype.numberedNoneClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.documentEditor.editor.clearList(),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.numberedNumberDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="arabic",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"Arabic"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.numberedUpRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="uproman",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"UpRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.numberedUpLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="upletter",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"UpLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.numberedLowLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="lowletter",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"LowLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.numberedLowRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="lowroman",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"LowRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.getLevelFormatNumber=function(){var e="%";return e+((this.documentEditor.selection.paragraphFormat.listLevelNumber<=0?0:this.documentEditor.selection.paragraphFormat.listLevelNumber)+1)+"."},s.prototype.bulletDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="dot",this.documentEditor.editor.applyBullet(String.fromCharCode(61623),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.bulletCircleClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="circle",this.documentEditor.editor.applyBullet(String.fromCharCode(61551)+String.fromCharCode(32),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.bulletSquareClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="square",this.documentEditor.editor.applyBullet(String.fromCharCode(61607),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.bulletFlowerClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="flower",this.documentEditor.editor.applyBullet(String.fromCharCode(61558),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.bulletArrowClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="arrow",this.documentEditor.editor.applyBullet(String.fromCharCode(61656),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.bulletTickClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="tick",this.documentEditor.editor.applyBullet(String.fromCharCode(61692),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},s.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.editor){var e=this.documentEditor.selection.paragraphFormat.styleName;if(e){var t=this.localObj.getConstant(e);this.style.value=(0,a.le)(t)||""==t?e:t,this.style.dataBind()}else this.style.value=null;(0,a.s1)(this.leftAlignment,[],["e-btn-toggle"]),(0,a.s1)(this.rightAlignment,[],["e-btn-toggle"]),(0,a.s1)(this.centerAlignment,[],["e-btn-toggle"]),(0,a.s1)(this.justify,[],["e-btn-toggle"]),"Left"===this.documentEditor.selection.paragraphFormat.textAlignment?(0,a.s1)(this.leftAlignment,["e-btn-toggle"],[]):"Right"===this.documentEditor.selection.paragraphFormat.textAlignment?(0,a.s1)(this.rightAlignment,["e-btn-toggle"],[]):"Center"===this.documentEditor.selection.paragraphFormat.textAlignment?(0,a.s1)(this.centerAlignment,["e-btn-toggle"],[]):"Justify"===this.documentEditor.selection.paragraphFormat.textAlignment&&(0,a.s1)(this.justify,["e-btn-toggle"],[]),this.toggleHiddenMarks()}this.setLineSpacing(),this.isRetrieving=!1},s.prototype.destroy=function(){this.container=void 0,this.lineSpacing&&(this.lineSpacing.destroy(),this.lineSpacing=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.bulletListBtn&&(this.bulletListBtn.destroy(),this.bulletListBtn=void 0),this.numberedListBtn&&(this.numberedListBtn.destroy(),this.numberedListBtn=void 0),this.leftAlignmentBtn&&(this.leftAlignmentBtn.destroy(),this.leftAlignmentBtn=void 0),this.rightAlignmentBtn&&(this.rightAlignmentBtn.destroy(),this.rightAlignmentBtn=void 0),this.centerAlignmentBtn&&(this.centerAlignmentBtn.destroy(),this.centerAlignmentBtn=void 0),this.justifyBtn&&(this.justifyBtn.destroy(),this.justifyBtn=void 0),this.decreaseIndentBtn&&(this.decreaseIndentBtn.destroy(),this.decreaseIndentBtn=void 0),this.increaseIndentBtn&&(this.increaseIndentBtn.destroy(),this.increaseIndentBtn=void 0),this.bordersBtn&&(this.bordersBtn.destroy(),this.bordersBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0)},s}(),Ds=function(){function s(e,t,i,n){this.isInitial=!0,this.container=e,this.text=new Rs(e,n),this.paragraph=new Ns(e),this.initializeTextProperties(t,i,n),this.wireEvents()}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.enableDisableElements=function(e){e?(0,a.s1)(this.element,[],["e-de-overlay"]):(0,a.s1)(this.element,["e-de-overlay"],[])},s.prototype.updateStyles=function(){this.paragraph.updateStyleNames()},Object.defineProperty(s.prototype,"appliedHighlightColor",{get:function(){return this.text.appliedHighlightColor},set:function(e){this.text.appliedHighlightColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"appliedBulletStyle",{get:function(){return this.paragraph.appliedBulletStyle},set:function(e){this.paragraph.appliedBulletStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"appliedNumberingStyle",{get:function(){return this.paragraph.appliedNumberingStyle},set:function(e){this.paragraph.appliedNumberingStyle=e},enumerable:!0,configurable:!0}),s.prototype.showTextProperties=function(e){e&&this.onSelectionChange(),!(!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display)&&(this.element.style.display=e?"block":"none",this.documentEditor.resize())},s.prototype.initializeTextProperties=function(e,t,i){this.element=(0,a.az)("div",{className:"e-de-prop-pane e-de-scrollbar-hide"}),this.text.initializeTextPropertiesDiv(this.element,i),this.paragraph.initializeParagraphPropertiesDiv(this.element,i),this.paragraph.updateStyleNames(),t||this.container.propertiesPaneContainer.appendChild(this.element)},s.prototype.generateUniqueID=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},s.prototype.wireEvents=function(){this.text.wireEvent(),this.paragraph.wireEvent()},s.prototype.onSelectionChange=function(){this.text.onSelectionChange(),this.paragraph.onSelectionChange()},s.prototype.destroy=function(){this.text&&(this.text.destroy(),this.text=void 0),this.paragraph&&(this.paragraph.destroy(),this.paragraph=void 0),this.container=void 0},s}(),As=function(){function s(e,t,i){this.isTopMarginApply=!1,this.isRightMarginApply=!1,this.isBottomMarginApply=!1,this.isLeftMarginApply=!1,this.borderColor="#000000",this.groupButtonClass="e-de-ctnr-group-btn e-btn-group",this.container=e,this.isRtl=i,this.isRtl&&(this.groupButtonClass="e-rtl "+this.groupButtonClass),this.tableTextProperties=new Ds(e,"textProperties",!0,this.isRtl),this.imageProperty=t,this.elementId=this.documentEditor.element.id,this.initializeTablePropPane(),this.prevContext=this.documentEditor.selection.contextType}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),s.prototype.initializeTablePropPane=function(){this.localObj=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.tableProperties=(0,a.az)("div",{className:"e-de-scrollbar-hide",styles:"overflow: auto"}),this.initFillColorDiv(),this.initBorderStylesDiv(),this.initCellDiv(),this.initInsertOrDelCell(),this.initCellMargin(),this.initAlignText(),this.addTablePropertyTab(),this.wireEvent()},s.prototype.enableDisableElements=function(e){e?(0,a.s1)(this.element,[],["e-de-overlay"]):(0,a.s1)(this.element,["e-de-overlay"],[])},s.prototype.addTablePropertyTab=function(){var e=(0,a.az)("div",{innerHTML:this.localObj.getConstant("Table")}),t=(0,a.az)("div",{innerHTML:this.localObj.getConstant("Text")});this.parentElement=(0,a.az)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-prop-pane"}),this.element=(0,a.az)("div",{id:this.elementId+"_propertyTabDiv",className:"e-de-property-tab"}),this.propertiesTab=new tt.OK({items:[{header:{text:t},content:this.tableTextProperties.element},{header:{text:e},content:this.tableProperties}],animation:{previous:{effect:"None"},next:{effect:"None"}},selected:this.onTabSelection.bind(this)}),this.propertiesTab.isStringTemplate=!0,this.propertiesTab.appendTo(this.element),this.parentElement.appendChild(this.element),this.container.propertiesPaneContainer.appendChild(this.parentElement)},s.prototype.onTabSelection=function(){this.documentEditor.resize(),this.documentEditor.focusIn()},s.prototype.wireEvent=function(){var e=this;this.shadingBtn.addEventListener("change",this.changeBackgroundColor.bind(this)),this.borderBtn.addEventListener("change",function(t){setTimeout(function(){e.borderColor=t.currentValue.hex,e.tableOutlineBorder.element.focus()},10)}),this.tableOutlineBorder.element.addEventListener("click",this.onOutlineBorder.bind(this)),this.tableAllBorder.element.addEventListener("click",this.onAllBorder.bind(this)),this.tableCenterBorder.element.addEventListener("click",this.onInsideBorder.bind(this)),this.tableLeftBorder.element.addEventListener("click",this.onLeftBorder.bind(this)),this.tableCenterVerticalBorder.element.addEventListener("click",this.onVerticalBorder.bind(this)),this.tableRightBorder.element.addEventListener("click",this.onRightBorder.bind(this)),this.tableTopBorder.element.addEventListener("click",this.onTopBorder.bind(this)),this.tableCenterHorizontalBorder.element.addEventListener("click",this.onHorizontalBorder.bind(this)),this.tableBottomBorder.element.addEventListener("click",this.onBottomBorder.bind(this)),this.insertRowAbove.element.addEventListener("click",this.onInsertRowAbove.bind(this)),this.insertRowBelow.element.addEventListener("click",this.onInsertRowBelow.bind(this)),this.insertColumnLeft.element.addEventListener("click",this.onInsertColumnLeft.bind(this)),this.insertColumnRight.element.addEventListener("click",this.onInsertColumnRight.bind(this)),this.deleteRow.element.addEventListener("click",this.onDeleteRow.bind(this)),this.deleteColumn.element.addEventListener("click",this.onDeleteColumn.bind(this)),this.horizontalMerge.element.addEventListener("click",this.onMergeCell.bind(this)),this.alignTop.element.addEventListener("click",this.applyAlignTop.bind(this)),this.alignBottom.element.addEventListener("click",this.applyAlignBottom.bind(this)),this.alignCenterHorizontal.element.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),this.topMargin.element.addEventListener("click",function(){e.isTopMarginApply=!0}),this.rightMargin.element.addEventListener("click",function(){e.isRightMarginApply=!0}),this.leftMargin.element.addEventListener("click",function(){e.isLeftMarginApply=!0}),this.bottomMargin.element.addEventListener("click",function(){e.isBottomMarginApply=!0}),this.topMargin.element.addEventListener("keydown",this.onTopMargin.bind(this)),this.rightMargin.element.addEventListener("keydown",this.onRightMargin.bind(this)),this.leftMargin.element.addEventListener("keydown",this.onLeftMargin.bind(this)),this.bottomMargin.element.addEventListener("keydown",this.onBottomMargin.bind(this)),this.topMargin.element.addEventListener("blur",function(){e.applyTopMargin(),e.isTopMarginApply=!1}),this.rightMargin.element.addEventListener("blur",function(){e.applyRightMargin(),e.isRightMarginApply=!1}),this.leftMargin.element.addEventListener("blur",function(){e.applyLeftMargin(),e.isLeftMarginApply=!1}),this.bottomMargin.element.addEventListener("blur",function(){e.applyBottomMargin(),e.isBottomMarginApply=!1})},s.prototype.getBorder=function(e){var t=this.borderSize.content.indexOf("No Border")>=0?0:parseInt(this.borderSize.content,10);return{type:e,borderColor:this.borderColor,lineWidth:t,borderStyle:0===t?"Cleared":"Single"}},s.prototype.onOutlineBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("OutsideBorders"))},s.prototype.onAllBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("AllBorders"))},s.prototype.onInsideBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideBorders"))},s.prototype.onLeftBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("LeftBorder"))},s.prototype.onVerticalBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideVerticalBorder"))},s.prototype.onRightBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("RightBorder"))},s.prototype.onTopBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("TopBorder"))},s.prototype.onHorizontalBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideHorizontalBorder"))},s.prototype.onBottomBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("BottomBorder"))},s.prototype.onTopMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyTopMargin(),t.isTopMarginApply=!1},30)},s.prototype.onBottomMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyBottomMargin(),t.isBottomMarginApply=!1},30)},s.prototype.onLeftMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyLeftMargin(),t.isLeftMarginApply=!1},30)},s.prototype.onRightMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyRightMargin(),t.isRightMarginApply=!1},30)},s.prototype.applyTopMargin=function(){!this.isTopMarginApply||(this.documentEditor.selection.cellFormat.topMargin=this.topMargin.value>this.topMargin.max?this.topMargin.max:this.topMargin.value)},s.prototype.applyBottomMargin=function(){!this.isBottomMarginApply||(this.documentEditor.selection.cellFormat.bottomMargin=this.bottomMargin.value>this.bottomMargin.max?this.bottomMargin.max:this.bottomMargin.value)},s.prototype.applyLeftMargin=function(){!this.isLeftMarginApply||(this.documentEditor.selection.cellFormat.leftMargin=this.leftMargin.value>this.leftMargin.max?this.leftMargin.max:this.leftMargin.value)},s.prototype.applyRightMargin=function(){!this.isRightMarginApply||(this.documentEditor.selection.cellFormat.rightMargin=this.rightMargin.value>this.rightMargin.max?this.rightMargin.max:this.rightMargin.value)},s.prototype.applyAlignTop=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Top"},s.prototype.applyAlignBottom=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Bottom"},s.prototype.applyAlignCenterHorizontal=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Center"},s.prototype.onMergeCell=function(){this.documentEditor.editor.mergeCells()},s.prototype.onInsertRowAbove=function(){this.documentEditor.editor.insertRow(!0)},s.prototype.onInsertRowBelow=function(){this.documentEditor.editor.insertRow(!1)},s.prototype.onInsertColumnLeft=function(){this.documentEditor.editor.insertColumn(!0)},s.prototype.onInsertColumnRight=function(){this.documentEditor.editor.insertColumn(!1)},s.prototype.onDeleteRow=function(){this.documentEditor.editor.deleteRow()},s.prototype.onDeleteColumn=function(){this.documentEditor.editor.deleteColumn()},s.prototype.onSelectionChange=function(){this.documentEditor.selection&&(this.horizontalMerge.disabled=!this.documentEditor.editor||!this.documentEditor.editor.canMergeCells(),("TableText"===this.documentEditor.selection.contextType||"TableImage"===this.documentEditor.selection.contextType)&&(this.shadingBtn.value=this.documentEditor.selection.cellFormat.background?this.documentEditor.selection.cellFormat.background:""),this.topMargin.value=this.documentEditor.selection.cellFormat.topMargin?this.documentEditor.selection.cellFormat.topMargin:0,this.bottomMargin.value=this.documentEditor.selection.cellFormat.bottomMargin?this.documentEditor.selection.cellFormat.bottomMargin:0,this.rightMargin.value=this.documentEditor.selection.cellFormat.rightMargin?this.documentEditor.selection.cellFormat.rightMargin:0,this.leftMargin.value=this.documentEditor.selection.cellFormat.leftMargin?this.documentEditor.selection.cellFormat.leftMargin:0)},s.prototype.changeBackgroundColor=function(e){var t=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.cellFormat.background=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},10))},s.prototype.initFillColorDiv=function(){var e=(0,a.az)("div",{id:this.elementId+"_fillColorDiv",className:"e-de-property-div-padding de-tbl-fill-clr"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-prop-sub-label"});t.classList.add("e-de-prop-fill-label"),this.isRtl&&t.classList.add("e-de-rtl"),t.textContent=this.localObj.getConstant("Fill"),e.appendChild(t),this.shadingBtn=this.createColorPickerTemplate(this.elementId+"_tableShading",e,this.localObj.getConstant("Fill color"),!1),(0,a.s1)(e.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-cellbg-clr-picker"],["e-caret"])},s.prototype.initBorderStylesDiv=function(){var e=(0,a.az)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Border Style"),e.appendChild(t);var i=(0,a.az)("div",{styles:"display:inline-flex;"}),n=(0,a.az)("div",{styles:"width:min-content;height:126px",className:"e-de-grp-btn-ctnr"}),r=(0,a.az)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-top"});n.appendChild(r);var o=(0,a.az)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-middle"});n.appendChild(o);var l=(0,a.az)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-bottom"});n.appendChild(l),this.isRtl&&(r.classList.add("e-de-rtl"),l.classList.add("e-de-rtl"),i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));var h="";this.tableOutlineBorder=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-outsideborder e-icons",r,"e-de-prop-font-button",h,this.localObj.getConstant("Outside borders")),this.tableAllBorder=this.createButtonTemplate(this.elementId+"_tableAllBorder","e-de-ctnr-allborders e-icons",r,"e-de-prop-font-button",h,this.localObj.getConstant("All borders")),this.tableCenterBorder=this.createButtonTemplate(this.elementId+"_tableCenterBorder","e-de-ctnr-insideborders e-icons",r,"e-de-prop-font-button",h,this.localObj.getConstant("Inside borders")),this.tableLeftBorder=this.createButtonTemplate(this.elementId+"_tableLeftBorder","e-de-ctnr-leftborders e-icons",o,"e-de-prop-font-button",h,this.localObj.getConstant("Left border")),this.tableCenterVerticalBorder=this.createButtonTemplate(this.elementId+"_tableCenterVBorder","e-de-ctnr-insideverticalborder e-icons",o,"e-de-prop-font-button",h,this.localObj.getConstant("Inside vertical border")),this.tableRightBorder=this.createButtonTemplate(this.elementId+"_tableRightBorder","e-de-ctnr-rightborder e-icons",o,"e-de-prop-font-button",h,this.localObj.getConstant("Right border")),this.tableTopBorder=this.createButtonTemplate(this.elementId+"_tableTopBorder","e-de-ctnr-topborder e-icons",l,"e-de-prop-font-button",h,this.localObj.getConstant("Top border")),this.tableCenterHorizontalBorder=this.createButtonTemplate(this.elementId+"_tableCenterHBorder","e-de-ctnr-insidehorizondalborder e-icons",l,"e-de-prop-font-button",h,this.localObj.getConstant("Inside horizontal border")),this.tableBottomBorder=this.createButtonTemplate(this.elementId+"_tableBottomBorder","e-de-ctnr-bottomborder e-icons",l,"e-de-prop-font-button",h,this.localObj.getConstant("Bottom border")),i.appendChild(n);var d=(0,a.az)("div",{className:"de-tbl-fill-clr"});d.classList.add(this.isRtl?"e-de-stylediv-rtl":"e-de-stylediv"),this.borderBtn=this.createColorPickerTemplate(this.elementId+"_tableBorderColor",d,this.localObj.getConstant("Border color"),!0),this.borderBtn.value="#000000",d.firstElementChild.lastElementChild.lastElementChild.style.width="30px",d.firstElementChild.lastElementChild.firstElementChild.firstElementChild.style.width="100%",(0,a.s1)(d.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-highlightcolor"],["e-caret"]);var c=(0,a.az)("button",{id:this.elementId+"_tableBorderSize",className:"e-de-border-size-button",styles:"font-size:10px;padding:0px;",attrs:{type:"button"}});d.appendChild(c),this.borderSize=this.createBorderSizeDropDown("e-de-ctnr-strokesize e-icons",c),i.appendChild(d),this.borderSizeColorElement=document.getElementsByClassName("e-de-border-width"),e.appendChild(i)},s.prototype.initCellDiv=function(){var e=(0,a.az)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell"),e.appendChild(t);var i=(0,a.az)("div",{className:"e-de-ctnr-group-btn"});i.classList.add("e-de-cell-div"),this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")),this.horizontalMerge=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-mergecell e-icons",i,"e-de-prop-font-button","",this.localObj.getConstant("Merge cells")),e.appendChild(i)},s.prototype.initInsertOrDelCell=function(){var e=(0,a.az)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Insert Or Delete"),e.appendChild(t);var i=(0,a.az)("div",{className:"e-de-insert-del-cell",styles:"display:inline-flex"}),n=(0,a.az)("div",{className:this.groupButtonClass});i.appendChild(n);var r=(0,a.az)("div",{className:this.groupButtonClass});this.isRtl?(r.style.marginRight="12px",i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")):r.style.marginLeft="12px",i.appendChild(r);var o="";this.insertColumnLeft=this.createButtonTemplate(this.elementId+"_insertColumnLeft","e-de-ctnr-insertleft e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert columns to the left")),this.insertColumnRight=this.createButtonTemplate(this.elementId+"_insertColumnRight","e-de-ctnr-insertright e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert columns to the right")),this.insertRowAbove=this.createButtonTemplate(this.elementId+"_insertRowAbove","e-de-ctnr-insertabove e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert rows above")),this.insertRowBelow=this.createButtonTemplate(this.elementId+"_insertRowBelow","e-de-ctnr-insertbelow e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert rows below")),this.deleteRow=this.createButtonTemplate(this.elementId+"_deleteRow","e-de-ctnr-deleterows e-icons",r,"e-de-prop-font-button",o,this.localObj.getConstant("Delete rows")),this.deleteColumn=this.createButtonTemplate(this.elementId+"_deleteColumn","e-de-ctnr-deletecolumns e-icons",r,"e-de-prop-font-button",o,this.localObj.getConstant("Delete columns")),e.appendChild(i)},s.prototype.initCellMargin=function(){var e=(0,a.az)("div",{className:"e-de-property-div-padding e-de-cellmargin-text"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell Margin"),e.appendChild(t);var i=(0,a.az)("div",{styles:"display:inline-flex"});this.isRtl&&t.classList.add("e-de-rtl");var n="width:48px",r="width:50px;float:left;";this.topMargin=this.createCellMarginTextBox(this.localObj.getConstant("Top"),this.elementId+"_topMargin",i,n,r,500,this.localObj.getConstant("Top margin")),this.bottomMargin=this.createCellMarginTextBox(this.localObj.getConstant("Bottom"),this.elementId+"_bottomMargin",i,n,r,500,this.localObj.getConstant("Bottom margin")),this.leftMargin=this.createCellMarginTextBox(this.localObj.getConstant("Left"),this.elementId+"_leftMargin",i,n,r,500,this.localObj.getConstant("Left margin")),this.rightMargin=this.createCellMarginTextBox(this.localObj.getConstant("Right"),this.elementId+"_rightMargin",i,n,r,500,this.localObj.getConstant("Right margin"),!0),e.appendChild(i)},s.prototype.initAlignText=function(){var e=(0,a.az)("div",{className:"e-de-property-div-padding",styles:"border-bottom-width:0px"});this.tableProperties.appendChild(e);var t=(0,a.az)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Align Text"),e.appendChild(t);var i=(0,a.az)("div");this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));var n=(0,a.az)("div",{className:this.groupButtonClass});i.appendChild(n),this.alignTop=this.createButtonTemplate(this.elementId+"_alignTop","e-de-ctnr-aligntop e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align top")),this.alignBottom=this.createButtonTemplate(this.elementId+"_alignBottom","e-de-ctnr-alignbottom e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align bottom")),this.alignCenterHorizontal=this.createButtonTemplate(this.elementId+"_alignCenterHorizontal","e-de-ctnr-aligncenter-table e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align center")),this.alignCenterHorizontal.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),e.appendChild(i)},s.prototype.createCellMarginTextBox=function(e,t,i,n,r,o,l,h){var d=(0,a.az)("div",{styles:r});h||d.classList.add("e-de-cell-text-box");var c=(0,a.az)("label",{className:"e-de-prop-sub-label"});c.textContent=e,d.appendChild(c);var u=(0,a.az)("input",{className:"e-textbox",id:t,styles:n});d.appendChild(u);var p=new J.No({showSpinButton:!1,min:0,format:"n0",max:o,enableRtl:this.isRtl},u);return i.appendChild(d),u.setAttribute("title",l),p},s.prototype.createBorderSizeDropDown=function(e,t){var i=this,n=(0,a.az)("div",{id:"borderSizeTarget",styles:"display:none"}),r=(0,a.az)("ul",{styles:"display: block; outline: 0px; width: 126px; height: auto;",id:"borderSizeListMenu"});n.appendChild(r),this.createDropdownOption(r,this.localObj.getConstant("No Border")).addEventListener("click",function(){i.onBorderSizeChange("No Border")});var l=this.localObj.getConstant("px");this.createDropdownOption(r,"1"+l).addEventListener("click",function(){i.onBorderSizeChange("1px")}),this.createDropdownOption(r,"1.5"+l).addEventListener("click",function(){i.onBorderSizeChange("1.5px")}),this.createDropdownOption(r,"2"+l).addEventListener("click",function(){i.onBorderSizeChange("2px")}),this.createDropdownOption(r,"3"+l).addEventListener("click",function(){i.onBorderSizeChange("3px")}),this.createDropdownOption(r,"4"+l).addEventListener("click",function(){i.onBorderSizeChange("4px")}),this.createDropdownOption(r,"5"+l).addEventListener("click",function(){i.onBorderSizeChange("5px")});var m=new Ue.uw({target:n,iconCss:e,cssClass:"e-de-prop-bordersize",enableRtl:this.isRtl,content:"1.5px"});return m.beforeOpen=function(){n.style.display="block";for(var v=0;v<i.borderSizeColorElement.length;v++)i.borderSizeColorElement[v].style.borderBottomColor=i.borderColor},m.beforeClose=function(){n.style.display="none"},m.appendTo(t),m.element.setAttribute("title",this.localObj.getConstant("Border width")),m},s.prototype.onBorderSizeChange=function(e){var t=this;this.borderSize.content=e,setTimeout(function(){t.tableOutlineBorder.element.focus()},10)},s.prototype.createDropdownOption=function(e,t){var i=(0,a.az)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(i);var r=(0,a.az)("div",{className:"e-de-list-header-presetmenu",innerHTML:"No Border"===t?"<div>"+t+"</div>":"1.5px"===t?"<div>"+t+'<span class="e-de-list-line e-de-border-width"  style="margin-left:10px;border-bottom-width:'+t+';"></span></div>':"<div>"+t+'<span class="e-de-list-line e-de-border-width" style="margin-left:20px;border-bottom-width:'+t+';"></span></div>'});return i.appendChild(r),i},s.prototype.createDropDownButton=function(e,t,i,n,r,o,l){var h=(0,a.az)("button",{id:e,styles:t,attrs:{type:"button"}});i.appendChild(h);var d="e-de-prop-splitbutton";this.isRtl&&(d="e-rtl "+d);var c=new Ue.uw({iconCss:n,content:r,enableRtl:this.isRtl,cssClass:d},h);return o&&(c.items=o),l&&(c.target=l),c},s.prototype.createButtonTemplate=function(e,t,i,n,r,o,l,h){var d=(0,a.az)("Button",{id:e,styles:r,attrs:{type:"button"}});i.appendChild(d);var c=new M.zx({cssClass:n,iconCss:t,enableRtl:this.isRtl,iconPosition:h||"Left",content:l||""});return c.appendTo(d),d.setAttribute("title",o),c},s.prototype.createColorPickerTemplate=function(e,t,i,n){var r=(0,a.az)("input",{id:e});t.appendChild(r);var o="e-de-prop-font-button e-de-prop-font-colorpicker";n&&(o+=" e-de-border-clr-picker");var l=new J.zH({showButtons:!0,cssClass:o,enableRtl:this.isRtl,locale:this.container.locale},r);return r.parentElement.setAttribute("title",i),l},s.prototype.showTableProperties=function(e,t){e&&("text"===t?this.propertiesTab.hideTab(1,!0):(this.propertiesTab.hideTab(1,!1),this.prevContext!==this.documentEditor.selection.contextType&&(this.propertiesTab.selectedItem=1)),this.prevContext=this.documentEditor.selection.contextType,this.onSelectionChange(),this.tableTextProperties.onSelectionChange()),!(!e&&"none"===this.parentElement.style.display||e&&"block"===this.parentElement.style.display)&&(this.parentElement.style.display=e?"block":"none",e&&this.updateTabContainerHeight(),this.documentEditor.resize(),this.prevContext=this.documentEditor.selection.contextType)},s.prototype.updateTabContainerHeight=function(){if(this.parentElement&&"block"===this.parentElement.style.display){var e=this.parentElement.getElementsByClassName("e-tab-header")[0];if(e){var t=this.parentElement.offsetHeight-e.offsetHeight;this.tableProperties.style.height=t+"px",this.tableTextProperties.element.style.height=t+"px"}}},s.prototype.destroy=function(){this.container=void 0,this.shadingBtn&&(this.shadingBtn.destroy(),this.shadingBtn=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderSize&&(this.borderSize.destroy(),this.borderSize=void 0),this.topMargin&&(this.topMargin.destroy(),this.topMargin=void 0),this.bottomMargin&&(this.bottomMargin.destroy(),this.bottomMargin=void 0),this.leftMargin&&(this.leftMargin.destroy(),this.leftMargin=void 0),this.rightMargin&&(this.rightMargin.destroy(),this.rightMargin=void 0),this.tableTextProperties&&(this.tableTextProperties.destroy(),this.tableTextProperties=void 0),this.propertiesTab&&(this.propertiesTab.destroy(),this.propertiesTab=void 0),this.imageProperty&&(this.imageProperty.destroy(),this.imageProperty=void 0),this.tableOutlineBorder&&this.tableOutlineBorder.destroy(),this.tableOutlineBorder=void 0,this.tableAllBorder&&this.tableAllBorder.destroy(),this.tableAllBorder=void 0,this.tableCenterBorder&&this.tableCenterBorder.destroy(),this.tableCenterBorder=void 0,this.tableLeftBorder&&this.tableLeftBorder.destroy(),this.tableLeftBorder=void 0,this.tableCenterVerticalBorder&&this.tableCenterVerticalBorder.destroy(),this.tableCenterVerticalBorder=void 0,this.tableRightBorder&&this.tableRightBorder.destroy(),this.tableRightBorder=void 0,this.tableTopBorder&&this.tableTopBorder.destroy(),this.tableTopBorder=void 0,this.tableCenterHorizontalBorder&&this.tableCenterHorizontalBorder.destroy(),this.tableCenterHorizontalBorder=void 0,this.tableBottomBorder&&this.tableBottomBorder.destroy(),this.tableBottomBorder=void 0,this.horizontalMerge&&this.horizontalMerge.destroy(),this.horizontalMerge=void 0,this.insertRowAbove&&this.insertRowAbove.destroy(),this.insertRowAbove=void 0,this.insertRowBelow&&this.insertRowBelow.destroy(),this.insertRowBelow=void 0,this.insertColumnLeft&&this.insertColumnLeft.destroy(),this.insertColumnLeft=void 0,this.insertColumnRight&&this.insertColumnRight.destroy(),this.insertColumnRight=void 0,this.deleteRow&&this.deleteRow.destroy(),this.deleteRow=void 0,this.deleteColumn&&this.deleteColumn.destroy(),this.deleteColumn=void 0,this.alignBottom&&this.alignBottom.destroy(),this.alignBottom=void 0,this.alignCenterHorizontal&&this.alignCenterHorizontal.destroy(),this.alignCenterHorizontal=void 0,this.alignTop&&this.alignTop.destroy(),this.alignTop=void 0,this.groupButtonClass=void 0,this.borderColor=void 0,this.elementId=void 0},s}(),Bs=function(){function s(e,t){this.startPage=1,this.statusBarDiv=e,this.container=t,this.initializeStatusBar(),this.wireEvents()}return Object.defineProperty(s.prototype,"documentEditor",{get:function(){return this.container?this.container.documentEditor:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"editorPageCount",{get:function(){return this.documentEditor?this.documentEditor.pageCount:1},enumerable:!0,configurable:!0}),s.prototype.initializeStatusBar=function(){var e=this,t=this.container.enableRtl;this.documentEditor.enableSpellCheck=!!this.container.enableSpellCheck,this.localObj=new a.E7("documenteditorcontainer",this.container.defaultLocale,this.container.locale);var n=(0,a.az)("div",{className:this.container.enableSpellCheck?"e-de-ctnr-pg-no":"e-de-ctnr-pg-no-spellout",styles:t?"padding-right:16px":"padding-left:16px"});this.statusBarDiv.appendChild(n);var r=(0,a.az)("span");r.textContent=this.localObj.getConstant("Page")+" ",n.appendChild(r),this.pageNumberInput=(0,a.az)("input",{styles:"text-transform:capitalize;white-space:pre;overflow:hidden;user-select:none;cursor:text",attrs:{type:"text"},className:"e-de-pagenumber-input"}),this.editablePageNumber=(0,a.az)("div",{styles:"display: inline-flex",className:"e-input e-de-pagenumber-text"}),this.editablePageNumber.appendChild(this.pageNumberInput);var o="";t?(r.style.marginLeft="6px",this.editablePageNumber.style.marginLeft="6px",o="padding-left:5px"):(r.style.marginRight="6px",this.editablePageNumber.style.marginRight="6px",o="padding-right:5px"),this.updatePageNumber(),n.appendChild(this.editablePageNumber),this.editablePageNumber.setAttribute("title",this.localObj.getConstant("Current Page Number"));var l=(0,a.az)("span",{styles:o});if(l.textContent=" "+this.localObj.getConstant("of")+" ",n.appendChild(l),this.pageCount=(0,a.az)("span"),n.appendChild(this.pageCount),this.updatePageCount(),this.documentEditor.enableSpellCheck){var h=(0,a.az)("div",{className:"e-de-statusbar-separator"});this.statusBarDiv.appendChild(h);var d=this.addSpellCheckElement();this.spellCheckButton.appendTo(d)}this.pageButton=this.createButtonTemplate(this.container.enableSpellCheck?"e-de-statusbar-pageweb e-btn-pageweb-spellcheck":"e-de-statusbar-pageweb","e-de-printlayout e-icons","Print layout",this.statusBarDiv,this.pageButton,"Pages"===this.documentEditor.layoutType),this.webButton=this.createButtonTemplate("e-de-statusbar-pageweb","e-de-weblayout e-icons","Web layout",this.statusBarDiv,this.webButton,"Continuous"===this.documentEditor.layoutType),this.pageButton.addEventListener("click",function(){e.documentEditor.layoutType="Pages",e.addRemoveClass(e.pageButton,e.webButton)}),this.webButton.addEventListener("click",function(){e.documentEditor.layoutType="Continuous",e.addRemoveClass(e.webButton,e.pageButton)});var c=(0,a.az)("button",{className:"e-de-statusbar-zoom",attrs:{type:"button"}});this.statusBarDiv.appendChild(c),c.setAttribute("title",this.localObj.getConstant("ZoomLevelTooltip"));var u=[{text:"200%"},{text:"175%"},{text:"150%"},{text:"125%"},{text:"100%"},{text:"75%"},{text:"50%"},{text:"25%"},{separator:!0},{text:this.localObj.getConstant("Fit one page")},{text:this.localObj.getConstant("Fit page width")}];this.zoom=new Ue.uw({content:"100%",items:u,enableRtl:this.container.enableRtl,select:this.onZoom.bind(this)}),this.zoom.isStringTemplate=!0,this.zoom.appendTo(c)},s.prototype.addSpellCheckElement=function(){var e=this,t=(0,a.az)("button",{className:"e-de-statusbar-spellcheck"});this.statusBarDiv.appendChild(t),t.setAttribute("title","Spell Checker options");var i=[{text:this.localObj.getConstant("Spell Check")},{text:this.localObj.getConstant("Underline errors")}];return this.spellCheckButton=new Ue.uw({content:this.localObj.getConstant("Spelling"),items:i,enableRtl:this.container.enableRtl,select:this.onSpellCheck.bind(this),beforeItemRender:function(n){n.element.innerHTML="<span></span>"+n.item.text,(0,a.le)(e.currentLanguage)&&(e.currentLanguage=e.documentEditor.spellChecker.languageID),(0,a.le)(e.allowSuggestion)&&(e.allowSuggestion=e.documentEditor.spellChecker.allowSpellCheckAndSuggestion);var r=n.element.children[0];n.item.text===e.localObj.getConstant("Spell Check")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellChecker.enableSpellCheck?(r.style.marginRight="10px",r.setAttribute("class","e-de-selected-spellcheck-item")):n.item.text===e.localObj.getConstant("Underline errors")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellChecker.enableSpellCheck&&!e.documentEditor.spellChecker.removeUnderline?(r.style.marginRight="10px",r.setAttribute("class","e-de-selected-underline-item")):(r.style.marginRight="25px",n.element.children[0].classList.remove("e-de-selected-spellcheck-item"),n.element.children[0].classList.remove("e-de-selected-underline-item"))}}),t},s.prototype.onZoom=function(e){this.setZoomValue(e.item.text),this.updateZoomContent()},s.prototype.onSpellCheck=function(e){this.setSpellCheckValue(e.item.text)},s.prototype.updateZoomContent=function(){this.zoom.content=Math.round(100*this.documentEditor.zoomFactor)+"%"},s.prototype.setSpellCheckValue=function(e){this.spellCheckButton.content=this.localObj.getConstant("Spelling"),e.match(this.localObj.getConstant("Spell Check"))?(this.documentEditor.spellChecker.enableSpellCheck=!this.documentEditor.spellChecker.enableSpellCheck,this.documentEditor.documentHelper.triggerSpellCheck=!1,this.documentEditor.documentHelper.triggerElementsOnLoading=!1):e.match(this.localObj.getConstant("Underline errors"))&&this.documentEditor.enableSpellCheck&&this.documentEditor.spellChecker.enableSpellCheck&&(this.documentEditor.spellChecker.removeUnderline=!this.documentEditor.spellChecker.removeUnderline)},s.prototype.setZoomValue=function(e){e.match(this.localObj.getConstant("Fit one page"))?this.documentEditor.fitPage("FitOnePage"):e.match(this.localObj.getConstant("Fit page width"))?this.documentEditor.fitPage("FitPageWidth"):this.documentEditor.zoomFactor=parseInt(e,10)/100},s.prototype.updatePageCount=function(){this.pageCount.textContent=this.editorPageCount.toString()},s.prototype.updatePageNumber=function(){this.pageNumberInput.value=this.startPage.toString(),this.updatePageNumberWidth()},s.prototype.updatePageNumberOnViewChange=function(e){this.startPage=this.documentEditor.selection&&this.documentEditor.selection.startPage>=e.startPage&&this.documentEditor.selection.startPage<=e.endPage?this.documentEditor.selection.startPage:e.startPage,this.updatePageNumber(),this.updatePageCount()},s.prototype.wireEvents=function(){var e=this;this.pageNumberInput.addEventListener("keydown",function(t){13===t.which&&(t.preventDefault(),parseInt(e.pageNumberInput.value,10)>e.editorPageCount?e.updatePageNumber():e.documentEditor.selection?e.documentEditor.selection.goToPage(parseInt(e.pageNumberInput.value,10)):e.documentEditor.scrollToPage(parseInt(e.pageNumberInput.value,10)),e.pageNumberInput.contentEditable="false",""===e.pageNumberInput.value&&e.updatePageNumber()),t.which>64&&t.preventDefault()}),this.pageNumberInput.addEventListener("keyup",function(){e.updatePageNumberWidth()}),this.pageNumberInput.addEventListener("blur",function(){(""===e.pageNumberInput.value||parseInt(e.pageNumberInput.value,10)>e.editorPageCount)&&e.updatePageNumber(),e.pageNumberInput.contentEditable="false"}),this.pageNumberInput.addEventListener("focus",function(){e.pageNumberInput.select()})},s.prototype.updatePageNumberWidth=function(){this.pageNumberInput&&(this.pageNumberInput.style.width=this.pageNumberInput.value.length>=3?"30px":"22px")},s.prototype.toggleWebLayout=function(){this.addRemoveClass(this.pageButton,this.webButton)},s.prototype.togglePageLayout=function(){this.addRemoveClass(this.webButton,this.pageButton)},s.prototype.addRemoveClass=function(e,t){e.classList.add("e-btn-toggle"),t.classList.contains("e-btn-toggle")&&t.classList.remove("e-btn-toggle")},s.prototype.createButtonTemplate=function(e,t,i,n,r,o){r=(0,a.az)("Button",{className:e,attrs:{type:"button"}}),n.appendChild(r);var l=new M.zx({cssClass:e,iconCss:t,enableRtl:this.container.enableRtl});return!0===o&&r.classList.add("e-btn-toggle"),l.appendTo(r),r.setAttribute("title",this.localObj.getConstant(i)),"Web layout"===i?this.webBtn=l:this.pageBtn=l,r},s.prototype.destroy=function(){this.zoom&&(this.zoom.destroy(),this.zoom=void 0),this.spellCheckButton&&(this.spellCheckButton.destroy(),this.spellCheckButton=void 0),this.pageBtn&&(this.pageBtn.destroy(),this.pageBtn=void 0),this.webBtn&&(this.webBtn.destroy(),this.webBtn=void 0),this.pageButton=void 0,this.webButton=void 0,this.pageNumberInput=void 0,this.statusBarDiv=void 0,this.pageCount=void 0,this.editablePageNumber=void 0,this.localObj=void 0,this.container=void 0},s}(),Ms=function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])})(e,t)};return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),we=function(s,e,t,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(s,e,t,i);else for(var l=s.length-1;l>=0;l--)(o=s[l])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Os=function(s){function e(t,i){var n=s.call(this,t,i)||this;return n.previousContext="",n.showHeaderProperties=!0,n.defaultLocale={New:"New","Insert Footnote":"Insert Footnote","Insert Endnote":"Insert Endnote","Footnote Tooltip":"Insert Footnote (Alt+Ctrl+F).","Endnote Tooltip":"Insert Endnote (Alt+Ctrl+D).",Open:"Open",Undo:"Undo",Redo:"Redo",Image:"Image",Table:"Table",Link:"Link",Bookmark:"Bookmark","Table of Contents":"Table of Contents","HEADING - - - - 1":"HEADING - - - - 1","HEADING - - - - 2":"HEADING - - - - 2","HEADING - - - - 3":"HEADING - - - - 3",Header:"Header",Footer:"Footer","Page Setup":"Page Setup","Page Number":"Page Number",Break:"Break",Find:"Find","Local Clipboard":"Local Clipboard","Restrict Editing":"Restrict Editing","Upload from computer":"Upload from computer","By URL":"By URL","Page Break":"Page Break","Show properties pane":"Show properties pane","Hide properties pane":"Hide properties pane","Section Break":"Section Break","Header And Footer":"Header & Footer",Options:"Options",Levels:"Levels","Different First Page":"Different First Page","Different header and footer for odd and even pages":"Different header and footer for odd and even pages.","Different Odd And Even Pages":"Different Odd & Even Pages","Different header and footer for first page":"Different header and footer for first page.",Position:"Position","Header from Top":"Header from Top","Footer from Bottom":"Footer from Bottom","Distance from top of the page to top of the header":"Distance from top of the page to top of the header.","Distance from bottom of the page to bottom of the footer":"Distance from bottom of the page to bottom of the footer.","Aspect ratio":"Aspect ratio",W:"W",H:"H",Width:"Width",Height:"Height",Text:"Text",Paragraph:"Paragraph",Fill:"Fill","Fill color":"Fill color","Border Style":"Border Style","Outside borders":"Outside borders","All borders":"All borders","Inside borders":"Inside borders","Left border":"Left border","Inside vertical border":"Inside vertical border","Right border":"Right border","Top border":"Top border","Inside horizontal border":"Inside horizontal border","Bottom border":"Bottom border","Border color":"Border color","Border width":"Border width",Cell:"Cell","Merge cells":"Merge cells","Insert Or Delete":"Insert / Delete","Insert columns to the left":"Insert columns to the left","Insert columns to the right":"Insert columns to the right","Insert rows above":"Insert rows above","Insert rows below":"Insert rows below","Delete rows":"Delete rows","Delete columns":"Delete columns","Cell Margin":"Cell Margin",Top:"Top",Bottom:"Bottom",Left:"Left",Right:"Right","Align Text":"Align Text","Align top":"Align top","Align bottom":"Align bottom","Align center":"Align center","Number of heading or outline levels to be shown in table of contents":"Number of heading or outline levels to be shown in table of contents.","Show page numbers":"Show page numbers","Show page numbers in table of contents":"Show page numbers in table of contents.","Right align page numbers":"Right align page numbers","Right align page numbers in table of contents":"Right align page numbers in table of contents.","Use hyperlinks":"Use hyperlinks","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers.",Font:"Font","Font Size":"Font Size","Font color":"Font color","Text highlight color":"Text highlight color","Clear all formatting":"Clear all formatting","Bold Tooltip":"Bold (Ctrl+B)","Italic Tooltip":"Italic (Ctrl+I)","Underline Tooltip":"Underline (Ctrl+U)",Strikethrough:"Strikethrough","Superscript Tooltip":"Superscript (Ctrl+Shift++)","Subscript Tooltip":"Subscript (Ctrl+=)","Align left Tooltip":"Align left (Ctrl+L)","Center Tooltip":"Center (Ctrl+E)","Align right Tooltip":"Align right (Ctrl+R)","Justify Tooltip":"Justify (Ctrl+J)","Decrease indent":"Decrease indent","Increase indent":"Increase indent","Line spacing":"Line spacing",Bullets:"Bullets",Numbering:"Numbering",Styles:"Styles","Manage Styles":"Manage Styles",Page:"Page",of:"of","Fit one page":"Fit one page","Spell Check":"Spell Check",Spelling:"Spelling","Underline errors":"Underline errors","Fit page width":"Fit page width",Update:"Update",Cancel:"Cancel",Insert:"Insert","No Border":"No Border","Create a new document":"Create a new document.","Open a document":"Open a document.","Undo Tooltip":"Undo the last operation (Ctrl+Z).","Redo Tooltip":"Redo the last operation (Ctrl+Y).","Insert inline picture from a file":"Insert inline picture from a file.","Insert a table into the document":"Insert a table into the document","Create Hyperlink":"Create a link in your document for quick access to web pages and files (Ctrl+K).","Insert a bookmark in a specific place in this document":"Insert a bookmark in a specific place in this document.","Provide an overview of your document by adding a table of contents":"Provide an overview of your document by adding a table of contents.","Add or edit the header":"Add or edit the header.","Add or edit the footer":"Add or edit the footer.","Open the page setup dialog":"Open the page setup dialog.","Add page numbers":"Add page numbers.","Find Text":"Find text in the document (Ctrl+F).","Toggle between the internal clipboard and system clipboard":"Toggle between the internal clipboard and system clipboard.</br>Access to system clipboard through script is denied due to browsers security policy. Instead, </br> 1. You can enable internal clipboard to cut, copy and paste within the component.</br> 2. You can use the keyboard shortcuts (Ctrl+X, Ctrl+C and Ctrl+V) to cut, copy and paste with system clipboard.","Current Page Number":"The current page number in the document. Click or tap to navigate specific page.","Read only":"Read only",Protections:"Protections","Error in establishing connection with web server":"Error in establishing connection with web server",Single:"Single",Double:"Double","New comment":"New comment",Comments:"Comments","Print layout":"Print layout","Web layout":"Web layout","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box",DropDown:"Drop-Down","Update Fields":"Update Fields","Update cross reference fields":"Update cross reference fields","Track Changes":"Keep track of the changes made in the document",TrackChanges:"Track Changes",AllCaps:"AllCaps","Change case Tooltip":"Change case",UPPERCASE:"UPPERCASE","No color":"No color","Top margin":"Top margin","Bottom margin":"Bottom margin","Left margin":"Left margin","Right margin":"Right margin",Normal:"Normal",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6",ZoomLevelTooltip:"Zoom level. Click or tap to open the Zoom options.",None:"None",Borders:"Borders","ShowHiddenMarks Tooltip":"Show the hidden characters like spaces, tab, paragraph marks, and breaks.(Ctrl + *)"},n}return Ms(e,s),Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.toolbarModule},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"DocumentEditorContainer"},e.prototype.onPropertyChanged=function(t,i){for(var n=0,r=Object.keys(t);n<r.length;n++)switch(r[n]){case"restrictEditing":this.restrictEditingToggleHelper(t.restrictEditing);break;case"showPropertiesPane":this.showHidePropertiesPane(t.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor.documentHelper.isTrackedOnlyMode&&!t.enableTrackChanges&&(this.enableTrackChanges=!0),this.documentEditor&&(this.documentEditor.enableTrackChanges=t.enableTrackChanges,this.toolbarModule&&this.toolbarModule.toggleTrackChanges(t.enableTrackChanges),this.documentEditor.enableTrackChanges&&(this.documentEditor.documentHelper.showRevision=!0),this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=t.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=t.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=t.zIndex);break;case"headers":this.documentEditor&&(this.documentEditor.headers=t.headers);break;case"locale":case"enableRtl":this.refresh();break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=t.enableComment),this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(t.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=t.enableSpellCheck);break;case"documentSettings":this.documentEditor&&(this.documentEditor.documentSettings.compatibilityMode=this.documentSettings.compatibilityMode);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"toolbarItems":this.toolbarModule&&this.toolbarModule.reInitToolbarItems(t.toolbarItems);break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=t.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=t.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=t.layoutType,"Continuous"===t.layoutType?this.statusBar.togglePageLayout():this.statusBar.toggleWebLayout());break;case"enableToolbar":this.createToolbarContainer(this.enableRtl,!0),t.enableToolbar&&this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment),this.toolbarModule.toggleTrackChanges(this.enableTrackChanges)),this.documentEditor&&this.documentEditor.resize();break;case"height":this.element.style.height=(0,a.Ac)(this.height),this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=(0,a.Ac)(this.width),this.documentEditor&&this.documentEditor.resize()}},e.prototype.preRender=function(){this.localObj=new a.E7("documenteditorcontainer",this.defaultLocale,this.locale),!(0,a.le)(this.element)&&""===this.element.id&&(this.element.id=w.getUniqueElementId()),this.initContainerElement()},e.prototype.render=function(){this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment)),""!==this.height&&(this.element.style.height=(0,a.Ac)(this.height)),""!==this.width&&(this.element.style.width=(0,a.Ac)(this.width)),this.element.style.minHeight="320px",this.initializeDocumentEditor(),this.restrictEditing&&this.restrictEditingToggleHelper(this.restrictEditing),this.headerFooterProperties=new Es(this,this.enableRtl),this.imageProperties=new ks(this,this.enableRtl),this.tocProperties=new Ws(this,this.enableRtl),this.tableProperties=new As(this,this.imageProperties,this.enableRtl),this.statusBar=new Bs(this.statusBarElement,this),(0,se.rj)({target:this.containerTarget,cssClass:"e-spin-overlay"}),this.setserverActionSettings(),this.renderComplete()},e.prototype.restrictEditingToggleHelper=function(t){this.documentEditor.isReadOnly=t,this.toolbarModule&&(this.toolbarModule.enableDisableToolBarItem(!t,!1),this.toolbarModule.toggleRestrictEditing(t)),this.showPropertiesPane=!t,this.showHidePropertiesPane(!t),this.documentEditor.trackChangesPane.enableDisableButton(!t&&!this.documentEditor.documentHelper.isDocumentProtected)},e.prototype.setFormat=function(){this.characterFormat&&this.documentEditor.setDefaultCharacterFormat(this.characterFormat),this.paragraphFormat&&this.documentEditor.setDefaultParagraphFormat(this.paragraphFormat),this.sectionFormat&&this.documentEditor.setDefaultSectionFormat(this.sectionFormat)},e.prototype.setserverActionSettings=function(){this.serviceUrl&&(this.documentEditor.serviceUrl=this.serviceUrl),this.serverActionSettings.spellCheck&&(this.documentEditor.serverActionSettings.spellCheck=this.serverActionSettings.spellCheck),this.serverActionSettings.restrictEditing&&(this.documentEditor.serverActionSettings.restrictEditing=this.serverActionSettings.restrictEditing),this.serverActionSettings.systemClipboard&&(this.documentEditor.serverActionSettings.systemClipboard=this.serverActionSettings.systemClipboard),this.headers&&(this.documentEditor.headers=this.headers)},e.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var t=this.documentEditorSettings.formFieldSettings,i=this.documentEditor;(0,a.le)(t.applyShading)||(i.documentEditorSettings.formFieldSettings.applyShading=t.applyShading),(0,a.le)(t.formFillingMode)||(i.documentEditorSettings.formFieldSettings.formFillingMode=t.formFillingMode),(0,a.le)(t.formattingExceptions)||(i.documentEditorSettings.formFieldSettings.formattingExceptions=t.formattingExceptions),(0,a.le)(t.selectionColor)||(i.documentEditorSettings.formFieldSettings.selectionColor=t.selectionColor),(0,a.le)(t.shadingColor)||(i.documentEditorSettings.formFieldSettings.shadingColor=t.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=this.documentEditorSettings.searchHighlightColor),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=this.documentEditorSettings.fontFamilies),this.documentEditorSettings.collaborativeEditingSettings&&(this.documentEditor.documentEditorSettings.collaborativeEditingSettings=this.documentEditorSettings.collaborativeEditingSettings),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),(0,a.le)(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),(0,a.le)(this.documentEditorSettings.maximumRows)||(this.documentEditor.documentEditorSettings.maximumRows=this.documentEditorSettings.maximumRows),(0,a.le)(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks)},e.prototype.getPersistData=function(){return"documenteditor-container"},e.prototype.requiredModules=function(){var t=[];return this.enableToolbar&&t.push({member:"toolbar",args:[this]}),t},e.prototype.initContainerElement=function(){var t=this.enableRtl;this.containerTarget=this.createElement("div",{className:"e-de-ctn"}),this.containerTarget.contentEditable="false",this.createToolbarContainer(t),this.propertiesPaneContainer=this.createElement("div",{className:t?"e-de-pane-rtl":"e-de-pane",styles:"display:none"}),this.editorContainer.appendChild(this.propertiesPaneContainer),this.containerTarget.appendChild(this.editorContainer),this.statusBarElement=this.createElement("div",{className:"e-de-status-bar"}),t&&(this.statusBarElement.style.direction="rtl"),this.containerTarget.appendChild(this.statusBarElement),this.element.appendChild(this.containerTarget)},e.prototype.createToolbarContainer=function(t,i){(0,a.le)(this.editorContainer)&&(this.editorContainer=this.createElement("div",{className:"e-de-tool-ctnr-properties-pane"+(t?" e-de-ctnr-rtl":"")})),this.enableToolbar?(this.toolbarContainer=this.createElement("div",{className:"e-de-ctnr-toolbar"+(t?" e-de-ctnr-rtl":"")}),i?this.containerTarget.insertBefore(this.toolbarContainer,this.containerTarget.firstChild):this.containerTarget.appendChild(this.toolbarContainer),this.editorContainer.classList.remove("e-de-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-tool-ctnr-properties-pane")):(this.editorContainer.classList.remove("e-de-tool-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-ctnr-properties-pane"))},e.prototype.initializeDocumentEditor=function(){var i=this.createElement("div",{id:this.element.id+"_editor",styles:"width:100%;height:100%"});this.documentEditorInternal=new Ps({isReadOnly:!1,enableRtl:this.enableRtl,selectionChange:this.onSelectionChange.bind(this),contentChange:this.onContentChange.bind(this),documentChange:this.onDocumentChange.bind(this),requestNavigate:this.onRequestNavigate.bind(this),viewChange:this.onViewChange.bind(this),customContextMenuSelect:this.onCustomContextMenuSelect.bind(this),customContextMenuBeforeOpen:this.onCustomContextMenuBeforeOpen.bind(this),beforePaneSwitch:this.onBeforePaneSwitch.bind(this),commentBegin:this.onCommentBegin.bind(this),commentEnd:this.onCommentEnd.bind(this),commentDelete:this.onCommentDelete.bind(this),beforeCommentAction:this.onCommentAction.bind(this),trackChange:this.onTrackChange.bind(this),serviceFailure:this.fireServiceFailure.bind(this),beforeXmlHttpRequestSend:this.beforeXmlHttpSend.bind(this),locale:this.locale,acceptTab:!0,zIndex:this.zIndex,enableLocalPaste:this.enableLocalPaste,layoutType:this.layoutType,pageOutline:"#E0E0E0",currentUser:this.currentUser,userColor:this.userColor,height:"100%",width:"100%",enableTrackChanges:this.enableTrackChanges,showRevisions:!0,enableLockAndEdit:this.enableLockAndEdit}),this.wireEvents(),this.customizeDocumentEditorSettings(),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.editorContainer.insertBefore(i,this.editorContainer.firstChild),this.setFormat(),this.documentEditor.appendTo(i),this.documentEditor.resize()},e.prototype.wireEvents=function(){this.documentEditor.on(oi,this.onZoomFactorChange,this),this.documentEditor.on(di,this.onViewChange,this),this.documentEditor.on(ci,this.showPropertiesPaneOnSelection,this),this.documentEditor.on(ui,this.updateShowHiddenMarks,this),this.documentEditor.on(zt,this.updateStyleCollection,this)},e.prototype.unWireEvents=function(){(0,a.le)(this.documentEditor)||this.documentEditor.isDestroyed||(this.documentEditor.off(oi,this.onZoomFactorChange),this.documentEditor.off(di,this.onViewChange),this.documentEditor.off(ui,this.updateShowHiddenMarks),this.documentEditor.off(zt,this.updateStyleCollection))},e.prototype.onCommentBegin=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(!1)},e.prototype.onCommentEnd=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(this.enableComment)},e.prototype.beforeXmlHttpSend=function(t){this.trigger(Tt,t)},e.prototype.onCommentDelete=function(t){this.trigger(kn,t)},e.prototype.onCommentAction=function(t){this.trigger(yt,t)},e.prototype.onTrackChange=function(t){this.trigger(li,t),this.toolbarModule&&this.toolbarModule.toggleTrackChanges(t.isTrackChangesEnabled)},e.prototype.onBeforePaneSwitch=function(t){this.trigger(Ot,t)},e.prototype.fireServiceFailure=function(t){this.trigger(In,t)},e.prototype.showHidePropertiesPane=function(t){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.propertiesPaneContainer.style.display=t?"block":"none",this.toolbarModule&&(this.toolbarModule.propertiesPaneButton.element.style.opacity=t?"1":"0.5"),this.documentEditor.resize()},e.prototype.updateStyleCollection=function(){!(0,a.le)(this.tableProperties)&&!(0,a.le)(this.tableProperties.tableTextProperties)&&!(0,a.le)(this.tableProperties.tableTextProperties.paragraph)&&this.tableProperties.tableTextProperties.paragraph.updateStyleNames()},e.prototype.resize=function(t,i){this.element&&((0,a.le)(i)&&this.element&&this.element.parentElement&&(i=this.element.parentElement.clientHeight),(0,a.le)(t)&&this.element&&this.element.parentElement&&(t=this.element.parentElement.clientWidth),!(0,a.le)(t)&&t>200&&(this.width=t.toString(),this.element.style.width=t+"px"),!(0,a.le)(i)&&i>200&&(this.height=i.toString(),this.element.style.height=i+"px"),this.documentEditor&&this.documentEditor.resize(),this.toolbarModule&&this.toolbarModule.toolbar.refreshOverflow(),this.showPropertiesPane&&this.tableProperties&&this.tableProperties.updateTabContainerHeight())},e.prototype.onContentChange=function(){this.toolbarModule&&this.toolbarModule.enableDisableUndoRedo(),this.statusBar&&this.statusBar.updatePageCount(),this.trigger(Tn,{source:this})},e.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges,!(0,a.le)(this.documentSettings)&&!(0,a.le)(this.documentEditor)&&!(0,a.le)(this.documentEditor.documentSettings)&&(this.documentSettings.compatibilityMode=this.documentEditor.documentSettings.compatibilityMode),this.toolbarModule&&(this.toolbarModule.isCommentEditing=!1,this.toolbarModule.enableDisableInsertComment(!0),this.toolbarModule.enableDisableUndoRedo()),this.statusBar&&this.statusBar.updatePageCount(),this.trigger(Sn,{source:this}),this.updateStyleCollection()},e.prototype.onSelectionChange=function(){var t=this;setTimeout(function(){t.showPropertiesPaneOnSelection(),t.trigger(Pn,{source:t})})},e.prototype.onZoomFactorChange=function(){this.statusBar&&this.statusBar.updateZoomContent()},e.prototype.updateShowHiddenMarks=function(t){this.documentEditorSettings.showHiddenMarks=t.showHiddenMarks,this.tableProperties.tableTextProperties.paragraph.toggleHiddenMarks()},e.prototype.onRequestNavigate=function(t){if("Bookmark"!==t.linkType){var i=t.navigationLink;t.localReference.length>0&&(i+="#"+t.localReference),window.open(i),t.isHandled=!0}},e.prototype.onViewChange=function(t){this.statusBar&&this.statusBar.updatePageNumberOnViewChange(t)},e.prototype.onCustomContextMenuSelect=function(t){this.trigger(Ln,t)},e.prototype.onCustomContextMenuBeforeOpen=function(t){this.trigger(En,t)},e.prototype.showPropertiesPaneOnSelection=function(){if(!(this.restrictEditing&&!this.showPropertiesPane||(0,a.le)(this.tableProperties))){var t="NoProtection"!==this.documentEditor.documentHelper.protectionType,i=t&&this.documentEditor.documentHelper.restrictFormatting,n=this.documentEditor.editor.restrictEditing;t?(this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(!n,!0),this.tableProperties.enableDisableElements(!i&&!n),this.tocProperties.enableDisableElements(!n),this.headerFooterProperties.enableDisableElements(!n),this.imageProperties.enableDisableElements(!n)):(this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(!this.documentEditor.isReadOnly,!0),this.tableProperties.enableDisableElements(!0),this.tocProperties.enableDisableElements(!0),this.headerFooterProperties.enableDisableElements(!0),this.imageProperties.enableDisableElements(!0));var o=this.documentEditor.selection.contextType,l=o.indexOf("Header")>=0||o.indexOf("Footer")>=0;l||(this.showHeaderProperties=!0),this.showPropertiesPane?(this.propertiesPaneContainer.style.display="block",l&&this.showHeaderProperties?this.showProperties("headerfooter"):o.indexOf("List")>=0||o.indexOf("Text")>=0&&o.indexOf("Table")<0?this.showProperties("text"):o.indexOf("Image")>=0?this.showProperties("image"):o.indexOf("TableOfContents")>=0?this.showProperties("toc"):o.indexOf("Table")>=0&&this.showProperties("table")):(this.showHidePropertiesPane(!1),this.propertiesPaneContainer.style.display="none"),this.previousContext=this.documentEditor.selection.contextType,this.toolbarModule&&this.toolbarModule.toolbar&&this.toolbarModule.enableDisableInsertComment(!this.documentEditor.enableHeaderAndFooter&&this.enableComment&&!this.documentEditor.isReadOnlyMode&&!this.documentEditor.selection.isinFootnote&&!this.documentEditor.selection.isinEndnote)}},e.prototype.showProperties=function(t){this.toolbarModule&&"headerfooter"!==t&&"toc"!==t&&this.toolbarModule.enableDisablePropertyPaneButton(!0),this.tableProperties.showTableProperties("table"===t||"text"===t,t),this.imageProperties.showImageProperties("image"===t),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===t),this.tocProperties.showTocPane("toc"===t)},e.prototype.setDefaultCharacterFormat=function(t){this.characterFormat=t},e.prototype.setDefaultParagraphFormat=function(t){this.paragraphFormat=t},e.prototype.setDefaultSectionFormat=function(t){this.sectionFormat=t},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.element&&(this.element.innerHTML=""),this.refreshing||(this.element.classList.remove("e-documenteditorcontainer"),this.element=void 0),this.toolbarContainer&&this.toolbarContainer.parentElement&&(this.toolbarContainer.innerHTML="",this.toolbarContainer.parentElement.removeChild(this.toolbarContainer)),this.toolbarContainer=void 0,this.documentEditorInternal&&(this.unWireEvents(),this.documentEditorInternal.destroy(),this.documentEditorInternal=void 0),this.headerFooterProperties&&this.headerFooterProperties.destroy(),this.headerFooterProperties=void 0,this.imageProperties&&this.imageProperties.destroy(),this.imageProperties=void 0,this.tocProperties&&this.tocProperties.destroy(),this.tocProperties=void 0,this.tableProperties&&this.tableProperties.destroy(),this.tableProperties=void 0,this.statusBar&&this.statusBar.destroy(),this.propertiesPaneContainer&&this.propertiesPaneContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0,this.unWireEvents()},we([(0,a.Z9)(!0)],e.prototype,"showPropertiesPane",void 0),we([(0,a.Z9)(!0)],e.prototype,"enableToolbar",void 0),we([(0,a.Z9)(!1)],e.prototype,"restrictEditing",void 0),we([(0,a.Z9)(!1)],e.prototype,"enableSpellCheck",void 0),we([(0,a.Z9)(!1)],e.prototype,"enableTrackChanges",void 0),we([(0,a.Z9)("Pages")],e.prototype,"layoutType",void 0),we([(0,a.Z9)("")],e.prototype,"currentUser",void 0),we([(0,a.Z9)("#FFFF00")],e.prototype,"userColor",void 0),we([(0,a.Z9)(!1)],e.prototype,"enableLocalPaste",void 0),we([(0,a.Z9)()],e.prototype,"serviceUrl",void 0),we([(0,a.Z9)(2e3)],e.prototype,"zIndex",void 0),we([(0,a.Z9)(!1)],e.prototype,"enableCsp",void 0),we([(0,a.Z9)(!0)],e.prototype,"enableComment",void 0),we([(0,a.Z9)("100%")],e.prototype,"width",void 0),we([(0,a.Z9)("320px")],e.prototype,"height",void 0),we([(0,a.Z9)(!1)],e.prototype,"enableLockAndEdit",void 0),we([(0,a.ju)()],e.prototype,"created",void 0),we([(0,a.ju)()],e.prototype,"destroyed",void 0),we([(0,a.ju)()],e.prototype,"contentChange",void 0),we([(0,a.ju)()],e.prototype,"selectionChange",void 0),we([(0,a.ju)()],e.prototype,"documentChange",void 0),we([(0,a.ju)()],e.prototype,"toolbarClick",void 0),we([(0,a.ju)()],e.prototype,"customContextMenuSelect",void 0),we([(0,a.ju)()],e.prototype,"customContextMenuBeforeOpen",void 0),we([(0,a.ju)()],e.prototype,"beforePaneSwitch",void 0),we([(0,a.ju)()],e.prototype,"commentDelete",void 0),we([(0,a.ju)()],e.prototype,"beforeCommentAction",void 0),we([(0,a.ju)()],e.prototype,"serviceFailure",void 0),we([(0,a.ju)()],e.prototype,"trackChange",void 0),we([(0,a.ju)()],e.prototype,"contentControl",void 0),we([(0,a.ju)()],e.prototype,"beforeXmlHttpRequestSend",void 0),we([(0,a.Zz)({},Or)],e.prototype,"documentEditorSettings",void 0),we([(0,a.Zz)({},zr)],e.prototype,"documentSettings",void 0),we([(0,a.Z9)({import:"Import",systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],e.prototype,"serverActionSettings",void 0),we([(0,a.Z9)(["New","Open","Separator","Undo","Redo","Separator","Image","Table","Hyperlink","Bookmark","TableOfContents","Separator","Header","Footer","PageSetup","PageNumber","Break","InsertFootnote","InsertEndnote","Separator","Find","Separator","Comments","TrackChanges","Separator","LocalClipboard","RestrictEditing","Separator","FormFields","UpdateFields"])],e.prototype,"toolbarItems",void 0),we([(0,a.Z9)([])],e.prototype,"headers",void 0),we([a.Zl],e)}(a.wA);let zs=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=Fe.oAB({type:s}),s.\u0275inj=Fe.cJS({imports:[[ni.ez]]}),s})();const Vs=["beforeCommentAction","beforePaneSwitch","commentDelete","contentChange","contentControl","created","customContextMenuBeforeOpen","customContextMenuSelect","destroyed","documentChange","selectionChange","serviceFailure","toolbarClick","trackChange","beforeXmlHttpRequestSend"],Us=[];let _s=(()=>{let s=class extends Os{constructor(t,i,n,r){super(),this.ngEle=t,this.srenderer=i,this.viewContainerRef=n,this.injector=r,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let o=this.injector.get("DocumentEditorToolbar");-1===this.injectedModules.indexOf(o)&&this.injectedModules.push(o)}catch(o){}this.registerEvents(Vs),this.addTwoWay.call(this,Us),(0,Mt.sO)("currentInstance",this,this.viewContainerRef),this.context=new Mt.VZ}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.context.ngAfterContentChecked(this)}};return s.\u0275fac=function(t){return new(t||s)(Fe.Y36(Fe.SBq),Fe.Y36(Fe.Qsj),Fe.Y36(Fe.s_b),Fe.Y36(Fe.zs3))},s.\u0275cmp=Fe.Xpm({type:s,selectors:[["ejs-documenteditorcontainer"]],inputs:{currentUser:"currentUser",documentEditorSettings:"documentEditorSettings",documentSettings:"documentSettings",enableComment:"enableComment",enableCsp:"enableCsp",enableLocalPaste:"enableLocalPaste",enableLockAndEdit:"enableLockAndEdit",enablePersistence:"enablePersistence",enableRtl:"enableRtl",enableSpellCheck:"enableSpellCheck",enableToolbar:"enableToolbar",enableTrackChanges:"enableTrackChanges",headers:"headers",height:"height",layoutType:"layoutType",locale:"locale",restrictEditing:"restrictEditing",serverActionSettings:"serverActionSettings",serviceUrl:"serviceUrl",showPropertiesPane:"showPropertiesPane",toolbarItems:"toolbarItems",userColor:"userColor",width:"width",zIndex:"zIndex"},outputs:{beforeCommentAction:"beforeCommentAction",beforePaneSwitch:"beforePaneSwitch",commentDelete:"commentDelete",contentChange:"contentChange",contentControl:"contentControl",created:"created",customContextMenuBeforeOpen:"customContextMenuBeforeOpen",customContextMenuSelect:"customContextMenuSelect",destroyed:"destroyed",documentChange:"documentChange",selectionChange:"selectionChange",serviceFailure:"serviceFailure",toolbarClick:"toolbarClick",trackChange:"trackChange",beforeXmlHttpRequestSend:"beforeXmlHttpRequestSend"},features:[Fe.qOj],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),s=(0,lo.gn)([(0,Mt.jm)([Mt.VZ])],s),s})(),qs=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=Fe.oAB({type:s}),s.\u0275inj=Fe.cJS({imports:[[ni.ez]]}),s})();const js={provide:"DocumentEditorToolbar",useValue:Ls};var Gs=Ne(4697),Ks=Ne(6007);const Xs=["document_editor"];let Zs=(()=>{class s{constructor(t,i){this.driveService=t,this.shared=i,this.file=null}ngOnInit(){}onCreated(){this.documentEditorContainer.toolbar.enableItems(0,!1),this.documentEditorContainer.toolbar.enableItems(1,!1),this.loadDoc()}loadDoc(){if(null==localStorage.getItem("localFile"))return;let t=JSON.parse(localStorage.getItem("localFile"));localStorage.removeItem("localFile"),this.file=t,this.documentEditorContainer.documentEditor.isDocumentLoaded&&this.driveService.getSFDT(t).subscribe(i=>{this.documentEditorContainer.documentEditor.open(i.fileUrl)})}saveResult(){null!=this.file&&this.documentEditorContainer.documentEditor.saveAsBlob("Docx").then(t=>{console.log(t),(n=>{const r=new FileReader;return r.readAsDataURL(n),new Promise(o=>{r.onloadend=()=>{o(r.result)}})})(t).then(n=>{this.file.fileUrl=n,this.driveService.editFile(this.file).subscribe(r=>{this.shared.toastr.success("Changes saved")},r=>{this.shared.toastr.error(r.error)})})})}storeResult(){}}return s.\u0275fac=function(t){return new(t||s)(Fe.Y36(Gs.w),Fe.Y36(Ks.F))},s.\u0275cmp=Fe.Xpm({type:s,selectors:[["app-doc-editor"]],viewQuery:function(t,i){if(1&t&&Fe.Gf(Xs,5),2&t){let n;Fe.iGM(n=Fe.CRH())&&(i.documentEditorContainer=n.first)}},features:[Fe._Bn([js])],decls:6,vars:0,consts:[[1,"navbar","navbar-expand-md","navbar-dark","fixed-top"],[1,"btn","btn-success",3,"click"],[1,"doc"],["enableToolbar","true","height","800px","serviceUrl","https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",2,"display","block",3,"created"],["document_editor",""]],template:function(t,i){1&t&&(Fe.TgZ(0,"nav",0),Fe.TgZ(1,"button",1),Fe.NdJ("click",function(){return i.saveResult()}),Fe._uU(2,"Save Changes"),Fe.qZA(),Fe.qZA(),Fe.TgZ(3,"body",2),Fe.TgZ(4,"ejs-documenteditorcontainer",3,4),Fe.NdJ("created",function(){return i.onCreated()}),Fe.qZA(),Fe.qZA())},directives:[_s],styles:["nav[_ngcontent-%COMP%]{background-color:var(--dark-color);height:56px}.doc[_ngcontent-%COMP%]{margin-top:56px}"]}),s})();var Ys=Ne(6901);const Js=[{path:"",component:Zs}];let Qs=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=Fe.oAB({type:s}),s.\u0275inj=Fe.cJS({imports:[[ni.ez,zs,qs,Ys.Bz.forChild(Js)]]}),s})()}}]);