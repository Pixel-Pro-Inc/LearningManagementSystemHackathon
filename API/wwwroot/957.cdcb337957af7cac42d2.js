"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[957],{4957:(ie,P,x)=>{x.d(P,{IE:()=>te});var o,w=x(4295),c=x(1727),p=function(){return function(){this.numFmtId=0,this.backColor="none",this.fontName="Calibri",this.fontSize=10.5,this.fontColor="#000000",this.italic=!1,this.bold=!1,this.underline=!1,this.strikeThrough=!1,this.wrapText=!1,this.hAlign="general",this.vAlign="bottom",this.indent=0,this.rotation=0,this.numberFormat="GENERAL",this.type="datetime",this.borders=new S,this.isGlobalStyle=!1}}(),k=function(){return function(){this.sz=10.5,this.name="Calibri",this.u=!1,this.b=!1,this.i=!1,this.color="FF000000",this.strike=!1}}(),M=function(){return function(){}}(),B=function(){return function(){}}(),W=function(){return function(){}}(),T=function(){return function(){this.name="Normal",this.xfId=0}}(),C=function(){return function(e,t){this.numFmtId=e,this.formatCode=t}}(),v=function(){return function(e,t){this.lineStyle=e,this.color=t}}(),S=function(){return function(){this.left=new v("none","#FFFFFF"),this.right=new v("none","#FFFFFF"),this.top=new v("none","#FFFFFF"),this.bottom=new v("none","#FFFFFF"),this.all=new v("none","#FFFFFF")}}(),G=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),R=function(){return function(){}}(),A=function(o){function e(){var t=null!==o&&o.apply(this,arguments)||this;return t.add=function(n){for(var r=!1,i=0,a=0,l=t;a<l.length;a++)l[a].index===n.index&&(t[i]=n,r=!0),i++;r||t.push(n)},t}return G(e,o),e}(Array),H=function(){return function(){}}(),U=function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),O=function(){return function(){}}(),V=function(o){function e(){var t=null!==o&&o.apply(this,arguments)||this;return t.add=function(n){t.push(n)},t}return U(e,o),e}(Array),$=function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Y=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return $(e,o),e}(Array),_=function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),K=function(){return function(){this.isSummaryRowBelow=!0,this.showGridLines=!0,this.enableRtl=!1}}(),N=function(){return function(){}}(),q=function(){return function(){}}(),Q=function(){return function(){}}(),D=function(){return function(){}}(),Z=function(o){function e(){var t=null!==o&&o.apply(this,arguments)||this;return t.add=function(n){for(var r=!1,i=0,a=0,l=t;a<l.length;a++){var s=l[a];if(e.isIntersecting(s,n)){var d=new D;d.x=Math.min(s.x,n.x),d.y=Math.min(s.Y,n.y),d.width=Math.max(s.Width+s.X,n.width+n.x),d.height=Math.max(s.Height+s.Y,n.height+n.y),d.ref=t[i].ref.split(":")[0]+":"+n.ref.split(":")[1],t[i]=d,n=d,r=!0}i++}return r||t.push(n),n},t}return _(e,o),e.isIntersecting=function(t,n){return t.x<=n.x+n.width&&n.x<=t.x+t.width&&t.y<=n.y+n.height&&n.y<=t.y+t.height},e}(Array),J=function(){return function(){}}(),X=function(){function o(e){this.intl=new c.eC}return o.prototype.getFormatFunction=function(e,t){return e.type?(t&&(e.isServerRendered=!0),this.intl.getDateFormat(e)):this.intl.getNumberFormat(e)},o.prototype.toView=function(e,t){var n=e;return!(0,c.le)(t)&&!(0,c.le)(e)&&(n=t(e)),n},o.prototype.displayText=function(e,t,n){return this.toView(e,this.getFormatFunction(t,n))},o}(),j=function(){function o(e,t){if(this.csvStr="",this.separator=null==t?",":t,this.formatter=new X,this.isMicrosoftBrowser=!!navigator.msSaveBlob,null!=e.isServerRendered&&(this.isServerRendered=e.isServerRendered),null!=e.styles){this.globalStyles=new Map;for(var n=0;n<e.styles.length;n++)void 0!==e.styles[n].name&&void 0!==e.styles[n].numberFormat&&this.globalStyles.set(e.styles[n].name,e.styles[n].numberFormat)}null!=e.worksheets&&this.parseWorksheet(e.worksheets[0])}return o.prototype.parseWorksheet=function(e){null!=e.rows&&this.parseRows(e.rows)},o.prototype.parseRows=function(e){for(var t=1,n=0,r=e;n<r.length;n++){var i=r[n];if(null==i.index)throw Error("Row index is missing.");for(;t<i.index;)this.csvStr+="\n",t++;this.parseRow(i)}},o.prototype.parseRow=function(e){if(null!=e.cells)for(var t=1,n=0,r=e.cells;n<r.length;n++){var i=r[n];if(null==i.index)throw Error("Cell index is missing.");for(;t<i.index;)this.csvStr+=this.separator,t++;this.parseCell(i)}},o.prototype.parseCell=function(e){var t=this.csvStr;if(void 0!==e.value)if(e.value instanceof Date)if(void 0!==e.style&&void 0!==e.style.numberFormat)try{t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",skeleton:e.style.numberFormat},this.isServerRendered))}catch(n){t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",format:e.style.numberFormat},this.isServerRendered))}else if(void 0!==e.style&&void 0!==e.style.name&&this.globalStyles.has(e.style.name))try{t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",skeleton:this.globalStyles.get(e.style.name)},this.isServerRendered))}catch(n){t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",format:this.globalStyles.get(e.style.name)},this.isServerRendered))}else t+=e.value;else"boolean"==typeof e.value?t+=e.value?"TRUE":"FALSE":"number"==typeof e.value?void 0!==e.style&&void 0!==e.style.numberFormat?t+=this.parseCellValue(this.formatter.displayText(e.value,{format:e.style.numberFormat},this.isServerRendered)):void 0!==e.style&&void 0!==e.style.name&&this.globalStyles.has(e.style.name)?t+=this.parseCellValue(this.formatter.displayText(e.value,{format:this.globalStyles.get(e.style.name)},this.isServerRendered)):t+=e.value:t+=this.parseCellValue(e.value);this.csvStr=t},o.prototype.parseCellValue=function(e){for(var t="",n=e.length,r=0;r<n;r++)t+='"'===e[r]?e[r].replace('"','""'):e[r];return-1!==(e=t).indexOf(this.separator)||-1!==e.indexOf("\n")?e='"'+e+'"':e},o.prototype.save=function(e){if(this.buffer=new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"}),this.isMicrosoftBrowser)navigator.msSaveBlob(this.buffer,e);else{var t=window.URL.createObjectURL(this.buffer),n=document.createElementNS("http://www.w3.org/1999/xhtml","a");n.download=e,n.href=t;var r=document.createEvent("MouseEvent");r.initEvent("click",!0,!0),n.dispatchEvent(r),setTimeout(function(){window.URL.revokeObjectURL(t)})}},o.prototype.saveAsBlob=function(){return new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"})},o}(),I=function(){function o(){this.parts=[]}return o.prototype.append=function(e){this.parts.push(e),this.blob=void 0},o.prototype.getBlob=function(){return new Blob(this.parts,{type:"text/plain"})},o}(),ee=function(){return function(){}}(),te=function(){function o(e,t,n,r,i){if(this.sharedStringCount=0,this.unitsProportions=[1.28,.32,96,96/25.4,96/2.54,1,96/72,96/72/12700],this.hyperlinkStyle={fontColor:"#0000FF",underline:!0},this.culture=void 0!==n?n:"en-US",this.currency=void 0!==r?r:"USD",this.intl=new c.eC(this.culture),this.mSaveType=t,"xlsx"===t){if(this.mArchive=new w.iA,this.sharedString=[],this.mFonts=[],this.mBorders=[],this.mStyles=[],this.printTitles=new Map,this.cellStyles=new Map,this.mNumFmt=new Map,this.mFills=new Map,this.mStyles.push(new p),this.mFonts.push(new k),this.cellStyles.set("Normal",new T),this.mCellXfs=[],this.mCellStyleXfs=[],this.drawingCount=0,this.imageCount=0,null!=e.styles){this.globalStyles=new Map;for(var a=0;a<e.styles.length;a++)if(void 0!==e.styles[a].name){if(this.cellStyles.has(e.styles[a].name))throw Error("Style name "+e.styles[a].name+" is already existed");var l=new p;l.isGlobalStyle=!0,this.parserCellStyle(e.styles[a],l,"none");var s=new T;s.name=l.name,s.xfId=l.index-1,this.cellStyles.set(s.name,s);var d={};void 0!==e.styles[a].numberFormat&&(d.format=e.styles[a].numberFormat),d.type=void 0!==e.styles[a].type?e.styles[a].type:"datetime",void 0!==d.format&&this.globalStyles.set(e.styles[a].name,d)}}if(null==e.worksheets)throw Error("Worksheet is expected.");this.parserWorksheets(e.worksheets),null!=e.builtInProperties&&(this.builtInProperties=new re,this.parserBuiltInProperties(e.builtInProperties,this.builtInProperties))}else this.csvHelper=new j(e,i)}return o.prototype.parserBuiltInProperties=function(e,t){null!=e.author&&(t.author=e.author),null!=e.comments&&(t.comments=e.comments),null!=e.category&&(t.category=e.category),null!=e.company&&(t.company=e.company),null!=e.manager&&(t.manager=e.manager),null!=e.subject&&(t.subject=e.subject),null!=e.title&&(t.title=e.title),null!=e.createdDate&&(t.createdDate=e.createdDate),null!=e.modifiedDate&&(t.modifiedDate=e.modifiedDate),null!=e.tags&&(t.tags=e.tags),null!=e.status&&(t.status=e.status)},o.prototype.parserWorksheets=function(e){this.worksheets=new Y;for(var t=e.length,n=0;n<t;n++){var r=e[n],i=new K;this.mergeCells=new Z,this.mergedCellsStyle=new Map,this.mHyperLinks=[],i.name=null!=r.name?r.name:"Sheet"+(n+1).toString(),null!=r.enableRtl&&(i.enableRtl=r.enableRtl),i.index=n+1,null!=r.columns&&this.parserColumns(r.columns,i),null!=r.rows&&this.parserRows(r.rows,i),null!=r.showGridLines&&(i.showGridLines=r.showGridLines),null!=r.freeze&&this.parserFreezePanes(r.freeze,i),null!=r.printTitle&&this.parserPrintTitle(r.printTitle,i),void 0!==r.pageSetup&&void 0!==r.pageSetup.isSummaryRowBelow&&(i.isSummaryRowBelow=r.pageSetup.isSummaryRowBelow),void 0!==r.images&&this.parserImages(r.images,i),null!=r.autoFilters&&this.parseFilters(r.autoFilters,i),i.index=n+1,i.mergeCells=this.mergeCells,i.hyperLinks=this.mHyperLinks,this.worksheets.push(i)}},o.prototype.mergeOptions=function(e,t){var n={};return this.applyProperties(e,n),this.applyProperties(t,n),n},o.prototype.applyProperties=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++)"name"!==n[r]&&(t[n[r]]=e[n[r]])},o.prototype.getCellName=function(e,t){return this.getColumnName(t)+e.toString()},o.prototype.getColumnName=function(e){e--;var t="";do{var n=e%26;e=e/26-1,t=String.fromCharCode(65+n)+t}while(e>=0);return t},o.prototype.parserPrintTitle=function(e,t){var r,l,n="";if(null!=e.fromRow&&(r="$"+e.fromRow+":$"+(null!=e.toRow?e.toRow:e.fromRow)),null!=e.fromColumn){var d;d=null!=e.toColumn?e.toColumn:e.fromColumn,l="$"+this.getColumnName(e.fromColumn)+":$"+this.getColumnName(d)}void 0!==r&&(n+=t.name+"!"+r),void 0!==l&&void 0!==r?n+=","+t.name+"!"+l:void 0!==l&&(n+=t.name+"!"+l),""!==n&&this.printTitles.set(t.index-1,n)},o.prototype.parserFreezePanes=function(e,t){t.freezePanes=new Q,t.freezePanes.row=null!=e.row?e.row:0,t.freezePanes.column=null!=e.column?e.column:0,t.freezePanes.leftCell=this.getCellName(t.freezePanes.row+1,t.freezePanes.column+1)},o.prototype.parserColumns=function(e,t){var n=e.length;t.columns=[];for(var r=0;r<n;r++){var i=new H;if(null==e[r].index)throw Error("Column index is missing.");i.index=e[r].index,null!=e[r].width&&(i.width=e[r].width),t.columns.push(i)}},o.prototype.parserRows=function(e,t){var n=e.length;t.rows=new V;for(var r=0,i=0;i<n;i++){var a=this.parserRow(e[i],r);r=a.index,t.rows.add(a)}this.insertMergedCellsStyle(t)},o.prototype.insertMergedCellsStyle=function(e){var t=this;this.mergeCells.length>0&&this.mergedCellsStyle.forEach(function(n,r){var i=e.rows.filter(function(u){return u.index===n.y})[0];if((0,c.le)(i)){var d=e.rows.filter(function(f){return f.index<=n.y}),h=new O;h.index=n.y,h.cells=new A,h.cells.add(t.createCell(n,r));var s=0;d.length>0&&(s=e.rows.indexOf(d[d.length-1])+1),e.rows.splice(s,0,h)}else{var a=i.cells.filter(function(u){return u.index===n.x})[0];if((0,c.le)(a)){var l=i.cells.filter(function(u){return u.index<=n.x});s=0,l.length>0&&(s=i.cells.indexOf(l[l.length-1])+1),i.cells.splice(s,0,t.createCell(n,r))}else a.styleIndex=n.styleIndex}})},o.prototype.createCell=function(e,t){var n=new R;return n.refName=t,n.index=e.x,n.cellStyle=new p,n.styleIndex=e.styleIndex,n},o.prototype.parserRow=function(e,t){var n=new O;if(null!=e.height&&(n.height=e.height),null==e.index)throw Error("Row index is missing.");return n.index=e.index,null!=e.grouping&&this.parseGrouping(e.grouping,n),this.parseCells(e.cells,n),n},o.prototype.parseGrouping=function(e,t){t.grouping=new q,void 0!==e.outlineLevel&&(t.grouping.outlineLevel=e.outlineLevel),void 0!==e.isCollapsed&&(t.grouping.isCollapsed=e.isCollapsed),void 0!==e.isHidden&&(t.grouping.isHidden=e.isHidden)},o.prototype.parseCells=function(e,t){t.cells=new A;for(var n=void 0!==e?e.length:0,r=1,i=1,a=0;a<n;a++){var l=e[a],s=new R;if(null==l.index)throw Error("Cell index is missing.");if(s.index=l.index,s.index<r?r=s.index:s.index>i&&(i=s.index),s.refName=this.getCellName(t.index,s.index),s.rowSpan=null!=l.rowSpan?l.rowSpan-1:0,s.colSpan=null!=l.colSpan?l.colSpan-1:0,null!=l.hyperlink){var d=new N;void 0!==l.hyperlink.target&&(d.target=l.hyperlink.target,s.value=void 0!==l.hyperlink.displayText?l.hyperlink.displayText:l.hyperlink.target,s.type=this.getCellValueType(s.value),d.ref=s.refName,d.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(d),s.cellStyle=new p,this.parserCellStyle(void 0!==l.style?this.mergeOptions(l.style,this.hyperlinkStyle):this.hyperlinkStyle,s.cellStyle,"string"),s.styleIndex=s.cellStyle.index)}null!=l.formula&&(s.formula=l.formula,s.type="formula"),null!=l.value&&(void 0!==s.formula?s.value=0:(s.value=l.value,s.type=this.getCellValueType(s.value))),null!=l.style&&void 0===s.styleIndex?(s.cellStyle=new p,s.value instanceof Date?this.parserCellStyle(l.style,s.cellStyle,s.type,14):this.parserCellStyle(l.style,s.cellStyle,s.type),s.styleIndex=s.cellStyle.index):s.value instanceof Date&&(s.cellStyle=new p,this.parserCellStyle({},s.cellStyle,s.type,14),s.styleIndex=s.cellStyle.index),this.parseCellType(s),this.mergeCells=this.processMergeCells(s,t.index,this.mergeCells),t.cells.add(s)}t.spans=r+":"+i},o.prototype.GetColors=function(){var e;return(e=new Map).set("WHITE","FFFFFFFF"),e.set("SILVER","FFC0C0C0"),e.set("GRAY","FF808080"),e.set("BLACK","FF000000"),e.set("RED","FFFF0000"),e.set("MAROON","FF800000"),e.set("YELLOW","FFFFFF00"),e.set("OLIVE","FF808000"),e.set("LIME","FF00FF00"),e.set("GREEN","FF008000"),e.set("AQUA","FF00FFFF"),e.set("TEAL","FF008080"),e.set("BLUE","FF0000FF"),e.set("NAVY","FF000080"),e.set("FUCHSIA","FFFF00FF"),e.set("PURPLE","FF800080"),e},o.prototype.processColor=function(e){return 0===e.indexOf("#")?e.replace("#","FF"):(e=e.toUpperCase(),this.rgbColors=this.GetColors(),e=this.rgbColors.has(e)?this.rgbColors.get(e):"FF000000")},o.prototype.processCellValue=function(e,t){var n=e;if(-1!==e.indexOf("<font")||-1!==e.indexOf("<a")||-1!==e.indexOf("<b>")||-1!==e.indexOf("<i>")||-1!==e.indexOf("<u>")){var r="",i=e.indexOf("<",0),a=e.indexOf(">",i+1);if(i>=0&&a>=0){for(0!==i&&(r+='<r><t xml:space="preserve">'+this.processString(e.substring(0,i))+"</t></r>");i>=0&&a>=0;)if((a=e.indexOf(">",i+1))>=0){var l=e.substring(i+1,a);(i=e.indexOf("<",a+1))<0&&(i=n.length);var s=n.substring(a+1,i);if(0!==s.length){var d=l.split(" ");if(d.length>0&&(r+="<r><rPr>"),d.length>1)for(var h=0,u=d;h<u.length;h++){var f=u[h];switch(f.trim().substring(0,5)){case"size=":r+='<sz val="'+f.substring(6,f.length-1)+'"/>';break;case"face=":r+='<rFont val="'+f.substring(6,f.length-1)+'"/>';break;case"color":r+='<color rgb="'+this.processColor(f.substring(7,f.length-1))+'"/>';break;case"href=":var g=new N;g.target=f.substring(6,f.length-1).trim(),g.ref=t.refName,g.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(g),r+='<color rgb="FF0000FF"/><u/><b/>'}}else if(1===d.length)switch(d[0].trim()){case"b":r+="<b/>";break;case"i":r+="<i/>";break;case"u":r+="<u/>"}r+='</rPr><t xml:space="preserve">'+this.processString(s)+"</t></r>"}}return""===r?n:r}return n}return n},o.prototype.applyGlobalStyle=function(e,t){this.cellStyles.has(e.name)&&(t.index=this.mStyles.filter(function(n){return n.name===e.name})[0].index,t.name=e.name)},o.prototype.parserCellStyle=function(e,t,n,r){if(null!=e.name){if(!t.isGlobalStyle)return void this.applyGlobalStyle(e,t);t.name=e.name}null!=e.backColor&&(t.backColor=e.backColor),t.borders=new S,null!=e.borders&&this.parserBorder(e.borders,t.borders.all),null!=e.leftBorder&&this.parserBorder(e.leftBorder,t.borders.left),null!=e.rightBorder&&this.parserBorder(e.rightBorder,t.borders.right),null!=e.topBorder&&this.parserBorder(e.topBorder,t.borders.top),null!=e.bottomBorder&&this.parserBorder(e.bottomBorder,t.borders.bottom),null!=e.fontName&&(t.fontName=e.fontName),null!=e.fontSize&&(t.fontSize=e.fontSize),null!=e.fontColor&&(t.fontColor=e.fontColor),null!=e.italic&&(t.italic=e.italic),null!=e.bold&&(t.bold=e.bold),null!=e.hAlign&&(t.hAlign=e.hAlign.toLowerCase()),null!=e.indent&&(t.indent=e.indent,"left"===t.hAlign||"right"===t.hAlign||(t.hAlign="left")),null!=e.rotation&&(t.rotation=e.rotation),null!=e.vAlign&&(t.vAlign=e.vAlign.toLowerCase()),null!=e.underline&&(t.underline=e.underline),null!=e.strikeThrough&&(t.strikeThrough=e.strikeThrough),null!=e.wrapText&&(t.wrapText=e.wrapText),null!=e.numberFormat?t.numberFormat=this.getNumberFormat(e.numberFormat,null!=e.type?e.type:n):(void 0!==r&&(t.numFmtId=14),t.numberFormat="GENERAL"),t.index=this.processCellStyle(t)},o.prototype.switchNumberFormat=function(e,t){var n=this.getNumberFormat(e,t);if(n!==e){var r=this.mNumFmt.get(e);if(void 0!==r&&(r.formatCode=n,this.mNumFmt.has(n))){for(var i=0,a=this.mCellStyleXfs;i<a.length;i++){var l=a[i];l.numFmtId===r.numFmtId&&(l.numFmtId=this.mNumFmt.get(n).numFmtId)}for(var s=0,d=this.mCellXfs;s<d.length;s++){var h=d[s];h.numFmtId===r.numFmtId&&(h.numFmtId=this.mNumFmt.get(n).numFmtId)}}}},o.prototype.getNumberFormat=function(e,t){var n;switch(t){case"number":try{n=this.intl.getNumberPattern({format:e,currency:this.currency,useGrouping:!0},!0)}catch(r){n=e}break;case"datetime":try{n=this.intl.getDatePattern({skeleton:e,type:"dateTime"},!0)}catch(r){try{n=this.intl.getDatePattern({format:e,type:"dateTime"},!0)}catch(i){n=e}}break;case"date":try{n=this.intl.getDatePattern({skeleton:e,type:"date"},!0)}catch(r){try{n=this.intl.getDatePattern({format:e,type:"date"},!0)}catch(i){n=e}}break;case"time":try{n=this.intl.getDatePattern({skeleton:e,type:"time"},!0)}catch(r){try{n=this.intl.getDatePattern({format:e,type:"time"},!0)}catch(i){n=e}}break;default:n=e}return n},o.prototype.parserBorder=function(e,t){t.color=null!=e.color?e.color:"#000000",t.lineStyle=null!=e.lineStyle?e.lineStyle:"thin"},o.prototype.processCellStyle=function(e){if(e.isGlobalStyle)return this.processNumFormatId(e),this.mStyles.push(e),this.mStyles.length;var t=this.compareStyle(e);return t.result?t.index:(this.processNumFormatId(e),this.mStyles.push(e),this.mStyles.length)},o.prototype.processNumFormatId=function(e){"GENERAL"===e.numberFormat||this.mNumFmt.has(e.numberFormat)||this.mNumFmt.set(e.numberFormat,new C(this.mNumFmt.size+164,e.numberFormat))},o.prototype.isNewFont=function(e){for(var t=!1,n=0,r=0,i=this.mFonts;r<i.length;r++){var a=i[r];n++;var l=void 0;if(void 0!==e.fontColor&&(l="FF"+e.fontColor.replace("#","")),t=a.color===l&&a.b===e.bold&&a.i===e.italic&&a.u===e.underline&&a.strike===e.strikeThrough&&a.name===e.fontName&&a.sz===e.fontSize)break}return{index:n-=1,result:t}},o.prototype.isNewBorder=function(e){var t=new p;return this.isAllBorder(e.borders)?t.borders.all.color===e.borders.all.color&&t.borders.all.lineStyle===e.borders.all.lineStyle:t.borders.left.color===e.borders.left.color&&t.borders.left.lineStyle===e.borders.left.lineStyle&&t.borders.right.color===e.borders.right.color&&t.borders.right.lineStyle===e.borders.right.lineStyle&&t.borders.top.color===e.borders.top.color&&t.borders.top.lineStyle===e.borders.top.lineStyle&&t.borders.bottom.color===e.borders.bottom.color&&t.borders.bottom.lineStyle===e.borders.bottom.lineStyle},o.prototype.isAllBorder=function(e){var t=new p;return t.borders.all.color!==e.all.color&&t.borders.all.lineStyle!==e.all.lineStyle},o.prototype.compareStyle=function(e){for(var t=!0,n=0,r=0,i=this.mStyles;r<i.length;r++){var a=i[r];if(t=!a.isGlobalStyle&&a.backColor===e.backColor&&a.bold===e.bold&&a.numFmtId===e.numFmtId&&a.numberFormat===e.numberFormat&&a.type===e.type&&a.fontColor===e.fontColor&&a.fontName===e.fontName&&a.fontSize===e.fontSize&&a.hAlign===e.hAlign&&a.italic===e.italic&&a.underline===e.underline&&a.strikeThrough===e.strikeThrough&&a.vAlign===e.vAlign&&a.indent===e.indent&&a.rotation===e.rotation&&a.wrapText===e.wrapText&&a.borders.all.color===e.borders.all.color&&a.borders.all.lineStyle===e.borders.all.lineStyle&&a.borders.left.color===e.borders.left.color&&a.borders.left.lineStyle===e.borders.left.lineStyle&&a.borders.right.color===e.borders.right.color&&a.borders.right.lineStyle===e.borders.right.lineStyle&&a.borders.top.color===e.borders.top.color&&a.borders.top.lineStyle===e.borders.top.lineStyle&&a.borders.bottom.color===e.borders.bottom.color&&a.borders.bottom.lineStyle===e.borders.bottom.lineStyle){n=a.index;break}}return{index:n,result:t}},o.prototype.contains=function(e,t){var n=e.indexOf(t);return n>-1&&n<e.length},o.prototype.getCellValueType=function(e){return e instanceof Date?"datetime":"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"},o.prototype.parseCellType=function(e){var n,r=e.value;switch(e.type){case"datetime":if(r=this.toOADate(r),void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)){var i=this.globalStyles.get(e.cellStyle.name);this.switchNumberFormat(i.format,i.type)}n="n";break;case"boolean":r=r?1:0,n="b";break;case"number":n="n",void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)&&this.switchNumberFormat(this.globalStyles.get(e.cellStyle.name).format,"number");break;case"string":this.sharedStringCount++,n="s";var a=this.processCellValue(r,e);this.contains(this.sharedString,a)||this.sharedString.push(a),r=this.sharedString.indexOf(a)}e.saveType=n,e.value=r},o.prototype.parserImages=function(e,t){var n=e.length;t.images=[];for(var r=0;r<n;r++){var i=this.parserImage(e[r]);t.images.push(i)}},o.prototype.parseFilters=function(e,t){if(t.autoFilters=new ee,null==e.row)throw new Error("Argument Null Exception: row null or empty");if(t.autoFilters.row=e.row,null==e.lastRow)throw new Error("Argument Null Exception: lastRow cannot be null or empty");if(t.autoFilters.lastRow=e.lastRow,null==e.column)throw new Error("Argument Null Exception: column cannot be null or empty");if(t.autoFilters.column=e.column,null===e.lastColumn||void 0===e.row)throw new Error("Argument Null Exception: lastColumn cannot be null or empty");t.autoFilters.lastColumn=e.lastColumn},o.prototype.parserImage=function(e){var t=new J;return null!=e.image&&(t.image=e.image),null!=e.row&&(t.row=e.row),null!=e.column&&(t.column=e.column),null!=e.lastRow&&(t.lastRow=e.lastRow),null!=e.lastColumn&&(t.lastColumn=e.lastColumn),null!=e.width&&(t.width=e.width),null!=e.height&&(t.height=e.height),null!=e.horizontalFlip&&(t.horizontalFlip=e.horizontalFlip),null!=e.verticalFlip&&(t.verticalFlip=e.verticalFlip),null!=e.rotation&&(t.rotation=e.rotation),t},o.prototype.saveAsBlob=function(e){var t=this;return new Promise("text/csv"===e?function(n,r){var i={};i.blobData=t.csvHelper.saveAsBlob(),n(i)}:function(n,r){t.saveInternal(),t.mArchive.saveAsBlob().then(function(i){var a={};a.blobData=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n(a)})})},o.prototype.save=function(e,t){var n=this;if(null==e||""===e)throw new Error("Argument Null Exception: fileName cannot be null or empty");var r=e.match(".xlsx$"),i=e.match(".csv$");if(null!==r&&r[0]==="."+this.mSaveType)this.saveInternal(),this.mArchive.save(e).then(function(){n.mArchive.destroy()});else{if(null===i||i[0]!=="."+this.mSaveType)throw Error("Save type and file extension is different.");this.csvHelper.save(e)}},o.prototype.saveInternal=function(){this.saveWorkbook(),this.saveWorksheets(),this.saveSharedString(),this.saveStyles(),this.saveApp(this.builtInProperties),this.saveCore(this.builtInProperties),this.saveContentType(),this.saveTopLevelRelation(),this.saveWorkbookRelation()},o.prototype.saveWorkbook=function(){for(var e='<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',t="<sheets>",n=this.worksheets.length,r=0;r<n;r++){var i=this.worksheets[r].name;t+='<sheet name="'+(i=(i=(i=(i=i.replace("&","&amp;")).replace("<","&lt;")).replace(">","&gt;")).replace('"',"&quot;"))+'" sheetId="'+(r+1).toString()+'" r:id ="rId'+(r+1).toString()+'" />'}if(e+=t+="</sheets>",this.printTitles.size>0){var a="<definedNames>";this.printTitles.forEach(function(l,s){a+='<definedName name="_xlnm.Print_Titles" localSheetId="'+s+'">'+l+"</definedName>"}),e+=a+="</definedNames>"}this.addToArchive(e+"</workbook>","xl/workbook.xml")},o.prototype.saveWorksheets=function(){for(var e=this.worksheets.length,t=0;t<e;t++)this.saveWorksheet(this.worksheets[t],t)},o.prototype.saveWorksheet=function(e,t){var n=new I,r='<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(r+=e.isSummaryRowBelow?"<sheetPr />":'<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>',r+=this.saveSheetView(e),void 0!==e.columns){for(var i="<cols>",a=0,l=e.columns;a<l.length;a++){var s=l[a];i+=void 0!==s.width?'<col min="'+s.index+'" max="'+s.index+'" width="'+this.pixelsToColumnWidth(s.width)+'" customWidth="1" />':'<col min="'+s.index+'" max="'+s.index+'" width="8.43" customWidth="1" />'}r+=i+"</cols>"}if(n.append(r+="<sheetData>"),r="",void 0!==e.rows)for(var d=0,h=e.rows;d<h.length;d++){var u=h[d],f='<row r="'+u.index+'" ';(0,c.le)(u.spans)||(f+='spans="'+u.spans+'" '),void 0!==u.height&&(f+='ht="'+this.pixelsToRowHeight(u.height)+'" customHeight="1" '),void 0!==u.grouping&&(u.grouping.isHidden&&(f+='hidden="1" '),void 0!==u.grouping.outlineLevel&&(f+='outlineLevel="'+u.grouping.outlineLevel+'" '),u.grouping.isCollapsed&&(f+='collapsed="1" ')),f+=">";for(var y=0,g=u.cells;y<g.length;y++){var m=g[y];void 0!==m&&(void 0!==m.value||void 0!==m.cellStyle)&&(f+='<c r="'+m.refName+'" ',void 0!==m.saveType&&(f+='t="'+m.saveType+'" '),void 0!==m.styleIndex&&(f+='s="'+m.styleIndex+'" '),f+=" >",void 0!==m.formula&&(f+="<f>"+m.formula+"</f>"),f+=void 0!==m.value?"<v>"+m.value+"</v></c>":"</c>")}n.append(f+="</row>")}if(r+="</sheetData>",null!=e.autoFilters&&(r+='<autoFilter ref="'+this.getCellName(e.autoFilters.row,e.autoFilters.column)+":"+this.getCellName(e.autoFilters.lastRow,e.autoFilters.lastColumn)+'"/>'),e.mergeCells.length>0){r+='<mergeCells count="'+e.mergeCells.length+'">';for(var F=0,E=e.mergeCells;F<E.length;F++)r+='<mergeCell ref="'+E[F].ref+'" />';r+="</mergeCells>"}if(e.hyperLinks.length>0){r+="<hyperlinks>";for(var b=0,z=e.hyperLinks;b<z.length;b++){var L=z[b];r+='<hyperlink ref="'+L.ref+'" r:id="rId'+L.rId+'" />'}r+="</hyperlinks>"}r+='<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" />',null!=e.images&&e.images.length>0&&(this.drawingCount++,this.saveDrawings(e,e.index),r+='<drawing r:id="rId'+(e.hyperLinks.length+1)+'"/>'),this.addToArchive(this.saveSheetRelations(e),"xl/worksheets/_rels/sheet"+e.index+".xml.rels"),n.append(r+"</worksheet>"),this.addToArchive(n.getBlob(),"xl/worksheets/sheet"+(t+1)+".xml")},o.prototype.saveDrawings=function(e,t){var n=new I,r='<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';if(void 0!==e.images){for(var i=0,a=0,l=e.images;a<l.length;a++){var s=l[a];void 0!==s.height&&void 0!==s.width?(this.updatelastRowOffset(e,s),this.updatelastColumnOffSet(e,s),s.lastRow-=1,s.lastColumn-=1):void 0!==s.lastRow&&void 0!==s.lastColumn&&(s.lastRowOffset=0,s.lastColOffset=0),i++,r+='<xdr:twoCellAnchor editAs="oneCell">',r+="<xdr:from><xdr:col>",r+=s.column-1,r+="</xdr:col><xdr:colOff>",r+=0,r+="</xdr:colOff><xdr:row>",r+=s.row-1,r+="</xdr:row><xdr:rowOff>",r+=0,r+="</xdr:rowOff></xdr:from>",r+="<xdr:to><xdr:col>",r+=s.lastColumn,r+="</xdr:col><xdr:colOff>",r+=s.lastColOffset,r+="</xdr:colOff><xdr:row>",r+=s.lastRow,r+="</xdr:row><xdr:rowOff>",r+=s.lastRowOffset,r+="</xdr:rowOff></xdr:to>",r+="<xdr:pic>",r+="<xdr:nvPicPr>",r+='<xdr:cNvPr id="'+i+'" name="Picture '+i+'"> </xdr:cNvPr>',r+='<xdr:cNvPicPr><a:picLocks noChangeAspect="1"/></xdr:cNvPicPr> </xdr:nvPicPr>',r+="<xdr:blipFill>",r+='<a:blip xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:embed="rId'+i+'" cstate="print">',r+="</a:blip><a:stretch><a:fillRect /></a:stretch></xdr:blipFill>",r+="<xdr:spPr>",r+="<a:xfrm",null!=s.rotation&&s.rotation<=3600&&s.rotation>=-3600&&(r+=' rot="'+6e4*s.rotation+'"'),null!=s.verticalFlip&&0!=s.verticalFlip&&(r+=' flipV="1"'),null!=s.horizontalFlip&&0!=s.horizontalFlip&&(r+=' flipH="1"'),r+="/>",r+='<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></xdr:spPr>',r+="</xdr:pic><xdr:clientData /></xdr:twoCellAnchor>";var d=this.convertBase64toImage(s.image);this.imageCount+=1,this.addToArchive(d,"xl/media/image"+this.imageCount+".png")}n.append(r),n.append("</xdr:wsDr>"),this.saveDrawingRelations(e),this.addToArchive(n.getBlob(),"xl/drawings/drawing"+this.drawingCount+".xml")}},o.prototype.updatelastRowOffset=function(e,t){for(var n=t.height,r=t.row,i=0;n>=0;){var a,l=(a=this.convertToPixels(void 0!==e.rows&&void 0!==e.rows[r-1]?void 0===e.rows[r-1].height?15:e.rows[r-1].height:15))-i*a/256;if(l>n){t.lastRow=r,t.lastRowOffset=i+256*n/a;var s;s=this.convertToPixels(void 0!==e.rows&&void 0!==e.rows[r-1]?void 0===e.rows[r-1].height?15:e.rows[r-1].height:15),t.lastRowOffset=s*t.lastRowOffset/256,t.lastRowOffset=Math.round(t.lastRowOffset/this.unitsProportions[7]);break}n-=l,r++,i=0}},o.prototype.updatelastColumnOffSet=function(e,t){for(var n=t.width,r=t.column,i=0;n>=0;){var a,l=(a=this.ColumnWidthToPixels(void 0!==e.columns&&void 0!==e.columns[r-1]?void 0===e.columns[r-1].width?8.43:e.columns[r-1].width:8.43))-i*a/1024;if(l>n){t.lastColumn=r,t.lastColOffset=i+1024*n/a;var s;s=this.ColumnWidthToPixels(void 0!==e.columns&&void 0!==e.columns[r-1]?void 0===e.columns[r-1].width?8.43:e.columns[r-1].width:8.43),t.lastColOffset=s*t.lastColOffset/1024,t.lastColOffset=Math.round(t.lastColOffset/this.unitsProportions[7]);break}n-=l,r++,i=0}},o.prototype.convertToPixels=function(e){return e*this.unitsProportions[6]},o.prototype.convertBase64toImage=function(e){for(var t=window.atob(e),n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:"image/png"})},o.prototype.saveDrawingRelations=function(e){for(var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',n=e.images.length,r=this.imageCount-e.images.length,i=1;i<=n;i++)t+='<Relationship Id="rId'+i+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/image'+ ++r+'.png" />';this.addToArchive(t+"</Relationships>","xl/drawings/_rels/drawing"+this.drawingCount+".xml.rels")},o.prototype.pixelsToColumnWidth=function(e){var n=e>12?this.trunc((e-5)/7*100+.5)/100:e/12;return n>1?(7*n+5)/7*256/256:12*n/7*256/256},o.prototype.ColumnWidthToPixels=function(e){return this.trunc((256*(e>1?(7*e+5)/7*256/256:12*e/7*256/256)+this.trunc(128/7))/256*7)},o.prototype.trunc=function(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!=1/0)?-0:t},o.prototype.pixelsToRowHeight=function(e){return e*this.unitsProportions[5]/this.unitsProportions[6]},o.prototype.saveSheetRelations=function(e){for(var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',n=0,r=e.hyperLinks;n<r.length;n++){var i=r[n];t+='<Relationship Id="rId'+i.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+this.processString(i.target)+'" TargetMode="External" />'}return null!=e.images&&e.images.length>0&&(t+='<Relationship Id="rId'+(e.hyperLinks.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing'+this.drawingCount+'.xml" />'),t+"</Relationships>"},o.prototype.saveSheetView=function(e){var t='<sheetViews><sheetView workbookViewId="0" ';return!0===e.enableRtl&&(t+='rightToLeft="1"'),t+=!1===e.showGridLines?'showGridLines="0" >':">",void 0!==e.freezePanes&&(t+='<pane state="frozen" topLeftCell="'+e.freezePanes.leftCell+'" ',0!==e.freezePanes.row&&(t+='ySplit="'+e.freezePanes.row+'" '),0!==e.freezePanes.column&&(t+='xSplit="'+e.freezePanes.column+'" '),t+="/>"),t+"</sheetView></sheetViews > "},o.prototype.saveSharedString=function(){var e=this.sharedString.length;if(e>0){for(var t='<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="'+e+'" count="'+this.sharedStringCount+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',n="",r=0;r<e;r++)0!==this.sharedString[r].indexOf("<r>")?(n+="<si><t>",n+=this.processString(this.sharedString[r]),n+="</t></si>"):(n+="<si>",n+=this.sharedString[r],n+="</si>");this.addToArchive(t+(n+="</sst>"),"xl/sharedStrings.xml")}},o.prototype.processString=function(e){return-1!==e.indexOf("&")&&(e=e.replace(/&/g,"&amp;")),-1!==e.indexOf("<")&&(e=e.replace(/</g,"&lt;")),-1!==e.indexOf(">")&&(e=e.replace(/>/g,"&gt;")),e},o.prototype.saveStyles=function(){this.updateCellXfsStyleXfs();var e='<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';e+=this.saveNumberFormats(),e+=this.saveFonts(),e+=this.saveFills(),e+=this.saveBorders(),e+=this.saveCellStyleXfs(),e+=this.saveCellXfs(),e+=this.saveCellStyles(),this.addToArchive(e+"</styleSheet>","xl/styles.xml")},o.prototype.updateCellXfsStyleXfs=function(){for(var e=0,t=this.mStyles;e<t.length;e++){var n=t[e],r=void 0;n.isGlobalStyle?(r=new W).xfId=n.index-1:(r=new M).xfId=0;var i=this.isNewFont(n);if(i.result)r.fontId=i.index;else{var a=new k;a.b=n.bold,a.i=n.italic,a.name=n.fontName,a.sz=n.fontSize,a.u=n.underline,a.strike=n.strikeThrough,a.color="FF"+n.fontColor.replace("#",""),this.mFonts.push(a),r.fontId=this.mFonts.length-1}if("none"!==n.backColor){var l="FF"+n.backColor.replace("#","");if(this.mFills.has(l)){var s=this.mFills.get(l);r.fillId=s}else this.mFills.set(l,s=this.mFills.size+2),r.fillId=s}else r.fillId=0;if(this.isNewBorder(n)?r.borderId=0:(this.mBorders.push(n.borders),r.borderId=this.mBorders.length),"GENERAL"!==n.numberFormat)if(this.mNumFmt.has(n.numberFormat)){var d=this.mNumFmt.get(n.numberFormat);r.numFmtId=d.numFmtId}else{var h=this.mNumFmt.size+164;this.mNumFmt.set(n.numberFormat,new C(h,n.numberFormat)),r.numFmtId=h}else r.numFmtId="GENERAL"===n.numberFormat&&14===n.numFmtId?14:0;n.isGlobalStyle||(r.applyAlignment=1),r.alignment=new B,r.alignment.indent=n.indent,r.alignment.horizontal=n.hAlign,r.alignment.vertical=n.vAlign,r.alignment.wrapText=n.wrapText?1:0,r.alignment.rotation=n.rotation,n.isGlobalStyle?(this.mCellStyleXfs.push(r),this.mCellXfs.push(r)):this.mCellXfs.push(r)}},o.prototype.saveNumberFormats=function(){if(this.mNumFmt.size>=1){var e='<numFmts count="'+this.mNumFmt.size+'">';return this.mNumFmt.forEach(function(t,n){e+='<numFmt numFmtId="'+t.numFmtId+'" formatCode="'+t.formatCode.replace(/"/g,"&quot;")+'" />'}),e+="</numFmts>"}return""},o.prototype.saveFonts=function(){var e='<fonts count="'+this.mFonts.length+'">';if(this.mFonts.length>=1)for(var t=0,n=this.mFonts;t<n.length;t++){var r=n[t];e+="<font>",r.b&&(e+="<b />"),r.i&&(e+="<i />"),r.u&&(e+="<u />"),r.strike&&(e+="<strike />"),e+='<sz val="'+r.sz+'" />',e+='<color rgb="'+r.color+'" />',e+='<name val="'+r.name+'" /></font>'}return e+"</fonts>"},o.prototype.saveFills=function(){var e='<fills count="'+(this.mFills.size+2)+'"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';return this.mFills.size>=1&&this.mFills.forEach(function(t,n){e+='<fill><patternFill patternType="solid"><fgColor rgb="'+n+'" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>'}),e+"</fills>"},o.prototype.saveBorders=function(){var e='<borders count="'+(this.mBorders.length+1)+'"><border><left /><right /><top /><bottom /><diagonal /></border>';if(this.mBorders.length>=1)for(var t=0,n=this.mBorders;t<n.length;t++){var r=n[t];if(this.isAllBorder(r)){var i=r.all.color.replace("#",""),a=r.all.lineStyle;e+='<border><left style="'+a+'"><color rgb="FF'+i+'" /></left><right style="'+a+'"><color rgb="FF'+i+'" /></right><top style="'+a+'"><color rgb="FF'+i+'" /></top><bottom style="'+a+'"><color rgb="FF'+i+'" /></bottom></border>'}else e+='<border><left style="'+r.left.lineStyle+'"><color rgb="FF'+r.left.color.replace("#","")+'" /></left><right style="'+r.right.lineStyle+'"><color rgb="FF'+r.right.color.replace("#","")+'" /></right><top style="'+r.top.lineStyle+'"><color rgb="FF'+r.top.color.replace("#","")+'" /></top><bottom style="'+r.bottom.lineStyle+'"><color rgb="FF'+r.bottom.color.replace("#","")+'" /></bottom></border>'}return e+"</borders>"},o.prototype.saveCellStyles=function(){var e=this,t='<cellStyles  count="'+this.cellStyles.size+'">';return this.cellStyles.forEach(function(n,r){t+='<cellStyle name="'+r+'" xfId="'+e.cellStyles.get(r).xfId+'"',"Normal"===r&&(t+=' builtinId="0"'),t+=" />"}),t+="</cellStyles>"},o.prototype.saveCellStyleXfs=function(){var e='<cellStyleXfs count="'+(this.mCellStyleXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';if(this.mCellStyleXfs.length>=1)for(var t=0,n=this.mCellStyleXfs;t<n.length;t++){var r=n[t];e+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" ',e+=void 0!==r.alignment?">"+this.saveAlignment(r)+"</xf>":" />"}return e+"</cellStyleXfs>"},o.prototype.saveCellXfs=function(){var e='<cellXfs count="'+(this.mCellXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';if(this.mCellXfs.length>=1)for(var t=0,n=this.mCellXfs;t<n.length;t++){var r=n[t];e+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" xfId="'+r.xfId+'" ',1===r.applyAlignment&&(e+='applyAlignment="1"'),e+=">"+this.saveAlignment(r)+"</xf>"}return e+"</cellXfs>"},o.prototype.saveAlignment=function(e){var t="<alignment ";return void 0!==e.alignment.horizontal&&(t+='horizontal="'+e.alignment.horizontal+'" '),void 0!==e.alignment.indent&&0!==e.alignment.indent?t+='indent="'+e.alignment.indent+'" ':void 0!==e.alignment.rotation&&0!==e.alignment.rotation&&(t+='textRotation="'+e.alignment.rotation+'" '),void 0!==e.alignment.vertical&&(t+='vertical="'+e.alignment.vertical+'" '),t+'wrapText="'+e.alignment.wrapText+'" />'},o.prototype.saveApp=function(e){var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';void 0!==e&&(void 0!==e.manager&&(t+="<Manager>"+e.manager+"</Manager>"),void 0!==e.company&&(t+="<Company>"+e.company+"</Company>")),this.addToArchive(t+"</Properties>","docProps/app.xml")},o.prototype.saveCore=function(e){var t=new Date,n='<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';void 0!==this.builtInProperties?(void 0!==e.author&&(n+="<dc:creator>"+e.author+"</dc:creator>"),void 0!==e.subject&&(n+="<dc:subject>"+e.subject+"</dc:subject>"),void 0!==e.category&&(n+="<cp:category>"+e.category+"</cp:category>"),void 0!==e.comments&&(n+="<dc:description>"+e.comments+"</dc:description>"),void 0!==e.title&&(n+="<dc:title>"+e.title+"</dc:title>"),void 0!==e.tags&&(n+="<cp:keywords>"+e.tags+"</cp:keywords>"),void 0!==e.status&&(n+="<cp:contentStatus>"+e.status+"</cp:contentStatus>"),n+=void 0!==e.createdDate?'<dcterms:created xsi:type="dcterms:W3CDTF">'+e.createdDate.toISOString()+"</dcterms:created>":'<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>",n+=void 0!==e.modifiedDate?'<dcterms:modified xsi:type="dcterms:W3CDTF">'+e.modifiedDate.toISOString()+"</dcterms:modified>":'<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>"):(n+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>",n+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>"),this.addToArchive(n+="</cp:coreProperties>","docProps/core.xml")},o.prototype.saveTopLevelRelation=function(){this.addToArchive('<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>',"_rels/.rels")},o.prototype.saveWorkbookRelation=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',t=this.worksheets.length,n=0,r=0;r<t;r++,n++)e+='<Relationship Id="rId'+(r+1).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(r+1).toString()+'.xml" />';e+='<Relationship Id="rId'+(++n).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />',this.sharedStringCount>0&&(e+='<Relationship Id="rId'+(++n).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />'),this.addToArchive(e+"</Relationships>","xl/_rels/workbook.xml.rels")},o.prototype.saveContentType=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',t="",n=this.worksheets.length,r=0,i=0;i<n;i++)t+='<Override PartName="/xl/worksheets/sheet'+(i+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />',null!=this.worksheets[i].images&&this.worksheets[i].images.length>0&&(t+='<Override PartName="/xl/drawings/drawing'+(++r).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml" />');this.imageCount>0&&(t+='<Default Extension="png" ContentType="image/png" />'),this.sharedStringCount>0&&(e+='<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />'),this.addToArchive(e+t+"</Types>","[Content_Types].xml")},o.prototype.addToArchive=function(e,t){if("string"==typeof e){var n=new Blob([e],{type:"text/plain"}),r=new w.eo(n,t);this.mArchive.addItem(r)}else r=new w.eo(e,t),this.mArchive.addItem(r)},o.prototype.processMergeCells=function(e,t,n){if(0!==e.rowSpan||0!==e.colSpan){var r=new D;r.x=e.index,r.width=e.colSpan,r.y=t,r.height=e.rowSpan;var i=this.getCellName(r.y,r.x),a=this.getCellName(t+r.height,e.index+r.width);r.ref=i+":"+a,n.add(r),this.updatedMergedCellStyles({x:r.x,y:r.y},{x:e.index+r.width,y:t+r.height},e)}return n},o.prototype.updatedMergedCellStyles=function(e,t,n){for(var r=e.x;r<=t.x;r++)for(var i=e.y;i<=t.y;i++)this.mergedCellsStyle.set(this.getCellName(i,r),{x:r,y:i,styleIndex:n.styleIndex})},o.prototype.dateToTicks=function(e,t,n){if(e>=1&&e<=9999&&t>=1&&t<=12){var s=e-1;return 864e9*(365*s+(s/4|0)-(s/100|0)+(s/400|0)+(this.isLeapYear(e)?[0,31,60,91,121,152,182,213,244,274,305,335,366]:[0,31,59,90,120,151,181,212,243,273,304,334,365])[t-1]+n-1)}throw new Error("Not a valid date")},o.prototype.timeToTicks=function(e,t,n){if(e>=0&&e<24&&t>=0&&t<60&&n>=0&&n<60)return 1e4*(3600*e+60*t+n)*1e3;throw new Error("Not valid time")},o.prototype.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},o.prototype.toOADate=function(e){var t;if(0===(t=this.dateToTicks(e.getFullYear(),e.getMonth()+1,e.getDate())+this.timeToTicks(e.getHours(),e.getMinutes(),e.getSeconds())))return 0;if(t<31241376e9)throw new Error("Arg_OleAutDateInvalid");return(t-599264352e9)/1e4/864e5},o}(),re=function(){return function(){}}()}}]);