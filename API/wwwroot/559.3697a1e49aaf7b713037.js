"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[559],{3559:(is,Li,mt)=>{mt.d(Li,{wVQ:()=>Ke,ZlO:()=>Ve,kdh:()=>Kr,Ik0:()=>tn,f2l:()=>on,fuO:()=>b,EA8:()=>S,Z_c:()=>w,SAZ:()=>le,oG9:()=>_,qve:()=>g,YBF:()=>Y,RYn:()=>pe,rNm:()=>E,RGI:()=>q,ihD:()=>Qe,haZ:()=>ye,nP$:()=>Hn,bjq:()=>Je,xjJ:()=>Ce,r_9:()=>zt,iD:()=>Un,jyB:()=>ne,xyW:()=>ct,EsS:()=>Q});var Vi=mt(4295),nt=mt(3041);function ki(i){return"[object String]"===Object.prototype.toString.call(i)?"$s"+i:"$o"+i.toString()}var _e,i,D=function(){function i(e){this.table={},this.nElements=0,this.toStr=e||ki}return i.prototype.getValue=function(e){var t=this.table["$"+this.toStr(e)];if(void 0!==t)return t.value},i.prototype.setValue=function(e,t){var n="$"+this.toStr(e);return this.nElements++,void(this.table[n]={key:e,value:t})},i.prototype.remove=function(e){var t="$"+this.toStr(e),r=this.table[t];return delete this.table[t],this.nElements--,r.value},i.prototype.keys=function(){for(var e=[],t=Object.keys(this.table),r=0;r<t.length;r++)e.push(this.table[t[r]].key);return e},i.prototype.values=function(){for(var e=[],t=Object.keys(this.table),r=0;r<t.length;r++)e.push(this.table[t[r]].value);return e},i.prototype.containsKey=function(e){return!(void 0===this.getValue(e))},i.prototype.clear=function(){this.table={},this.nElements=0},i.prototype.size=function(){return this.nElements},i}(),O=function(){function i(e){this.stringStartMark="/",this.internalValue="",this.isSaving6=!1,this.position6=-1,this.internalValue=this.normalizeValue(e)}return Object.defineProperty(i.prototype,"status",{get:function(){return this.status6},set:function(e){this.status6=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving6},set:function(e){this.isSaving6=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index6},set:function(e){this.index6=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position6},set:function(e){this.position6=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.internalValue},set:function(e){var t=e;this.internalValue=null!==e&&e.length>0?this.normalizeValue(t=e):t},enumerable:!0,configurable:!0}),i.prototype.save=function(e){e.write(this.toString())},i.prototype.toString=function(){return this.stringStartMark+this.escapeString(this.value)},i.prototype.clone=function(e){var t=new i;return t.value=this.internalValue,t},i.prototype.escapeString=function(e){for(var t="",r=0,n=e.length;r<n;r++){var s=e[r];i.delimiters.indexOf(s),t+=s}return t},i.prototype.normalizeValue=function(e,t){return e},i.delimiters="()<>[]{}/%}",i.replacements=[" ","\t","\n","\r"],i}(),m=function(){function i(){this.forTest="test",this.forTest=i.obj}return i.obj="obj",i.endObj="endobj",i.r="R",i.whiteSpace=" ",i.slash="/",i.newLine="\r\n",i.stream="stream",i.endStream="endstream",i.xref="xref",i.f="f",i.n="n",i.trailer="trailer",i.startxref="startxref",i.eof="%%EOF",i.header="%PDF-1.5",i.beginText="BT",i.endText="ET",i.beginPath="m",i.appendLineSegment="l",i.stroke="S",i.fill="f",i.fillEvenOdd="f*",i.fillStroke="B",i.fillStrokeEvenOdd="B*",i.appendbeziercurve="c",i.appendRectangle="re",i.saveState="q",i.restoreState="Q",i.paintXObject="Do",i.modifyCtm="cm",i.modifyTM="Tm",i.setLineWidth="w",i.setLineCapStyle="J",i.setLineJoinStyle="j",i.setDashPattern="d",i.setFlatnessTolerance="i",i.closePath="h",i.closeStrokePath="s",i.closeFillStrokePath="b",i.setCharacterSpace="Tc",i.setWordSpace="Tw",i.setHorizontalScaling="Tz",i.setTextLeading="TL",i.setFont="Tf",i.setRenderingMode="Tr",i.setTextRise="Ts",i.setTextScaling="Tz",i.setCoords="Td",i.goToNextLine="T*",i.setText="Tj",i.setTextWithFormatting="TJ",i.setTextOnNewLine="'",i.selectcolorspaceforstroking="CS",i.selectcolorspacefornonstroking="cs",i.setrbgcolorforstroking="RG",i.setrbgcolorfornonstroking="rg",i.setcmykcolorforstroking="K",i.setcmykcolorfornonstroking="k",i.setgraycolorforstroking="G",i.setgraycolorfornonstroking="g",i.clipPath="W",i.clipPathEvenOdd="W*",i.endPath="n",i.setGraphicsState="gs",i.comment="%",i.evenOdd="*",i.setMiterLimit="M",i.setColorAndPattern="scn",i.setColorAndPatternStroking="SCN",i}(),M=function(){return function(){this.pages="Pages",this.kids="Kids",this.count="Count",this.resources="Resources",this.type="Type",this.size="Size",this.mediaBox="MediaBox",this.parent="Parent",this.root="Root",this.decodeParms="DecodeParms",this.filter="Filter",this.font="Font",this.type1="Type1",this.baseFont="BaseFont",this.encoding="Encoding",this.subtype="Subtype",this.contents="Contents",this.procset="ProcSet",this.colorSpace="ColorSpace",this.extGState="ExtGState",this.pattern="Pattern",this.xObject="XObject",this.length="Length",this.width="Width",this.height="Height",this.bitsPerComponent="BitsPerComponent",this.image="Image",this.dctdecode="DCTDecode",this.columns="Columns",this.blackIs1="BlackIs1",this.k="K",this.s="S",this.predictor="Predictor",this.deviceRgb="DeviceRGB",this.next="Next",this.action="Action",this.link="Link",this.a="A",this.annot="Annot",this.p="P",this.c="C",this.rect="Rect",this.uri="URI",this.annots="Annots",this.ca="ca",this.CA="CA",this.xyz="XYZ",this.fit="Fit",this.dest="Dest",this.BM="BM",this.flatedecode="FlateDecode",this.rotate="Rotate",this.bBox="BBox",this.form="Form",this.w="W",this.cIDFontType2="CIDFontType2",this.cIDToGIDMap="CIDToGIDMap",this.identity="Identity",this.dw="DW",this.fontDescriptor="FontDescriptor",this.cIDSystemInfo="CIDSystemInfo",this.fontName="FontName",this.flags="Flags",this.fontBBox="FontBBox",this.missingWidth="MissingWidth",this.stemV="StemV",this.italicAngle="ItalicAngle",this.capHeight="CapHeight",this.ascent="Ascent",this.descent="Descent",this.leading="Leading",this.avgWidth="AvgWidth",this.fontFile2="FontFile2",this.maxWidth="MaxWidth",this.xHeight="XHeight",this.stemH="StemH",this.registry="Registry",this.ordering="Ordering",this.supplement="Supplement",this.type0="Type0",this.identityH="Identity-H",this.toUnicode="ToUnicode",this.descendantFonts="DescendantFonts",this.background="Background",this.shading="Shading",this.matrix="Matrix",this.antiAlias="AntiAlias",this.function="Function",this.extend="Extend",this.shadingType="ShadingType",this.coords="Coords",this.domain="Domain",this.range="Range",this.functionType="FunctionType",this.bitsPerSample="BitsPerSample",this.patternType="PatternType",this.paintType="PaintType",this.tilingType="TilingType",this.xStep="XStep",this.yStep="YStep"}}(),F=function(){function i(e){if(this.position7=-1,this.primitiveItems=new D,this.prefix="<<",this.suffix=">>",this.resources=[],this.object=null,this.archive=!0,this.isFont=!1,void 0===e)this.primitiveItems=new D,this.encrypt=!0,this.dictionaryProperties=new M;else{this.primitiveItems=new D;for(var t=e.items.keys(),r=e.items.values(),n=0;n<e.items.size();n++)this.primitiveItems.setValue(t[n],r[n]);this.status=e.status,this.freezeChanges(this),this.encrypt=!0,this.dictionaryProperties=new M}}return Object.defineProperty(i.prototype,"items",{get:function(){return this.primitiveItems},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"status",{get:function(){return this.status7},set:function(e){this.status7=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving7},set:function(e){this.isSaving7=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index7},set:function(e){this.index7=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position7},set:function(e){this.position7=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Count",{get:function(){return this.primitiveItems.size()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Dictionary",{get:function(){return this},enumerable:!0,configurable:!0}),i.prototype.getArchive=function(){return this.archive},i.prototype.setArchive=function(e){this.archive=e},i.prototype.setEncrypt=function(e){this.encrypt=e,this.modify()},i.prototype.getEncrypt=function(){return this.encrypt},i.prototype.freezeChanges=function(e){this.bChanged=!1},i.prototype.clone=function(e){return new i},i.prototype.modify=function(){this.bChanged=!0},i.prototype.remove=function(e){"string"!=typeof e?(this.primitiveItems.remove(e.value),this.modify()):this.remove(new O(e))},i.prototype.containsKey=function(e){return this.primitiveItems.containsKey(e.toString())},i.prototype.onBeginSave=function(){this.beginSave.sender.beginSave()},i.prototype.onFontDictionaryBeginSave=function(){this.fontDictionaryBeginSave.sender.fontDictionaryBeginSave()},i.prototype.onDescendantFontBeginSave=function(){this.descendantFontBeginSave.sender.descendantFontBeginSave()},i.prototype.onTemplateBeginSave=function(){this.pageBeginDrawTemplate.sender.pageBeginSave()},i.prototype.onBeginAnnotationSave=function(){this.annotationBeginSave.sender.beginSave()},i.prototype.onSectionBeginSave=function(e){var t=this.sectionBeginSave;t.sender.beginSave(t.state,e)},i.prototype.save=function(e,t){void 0===t?this.save(e,!0):(e.write(this.prefix),void 0!==this.beginSave&&this.onBeginSave(),void 0!==this.descendantFontBeginSave&&this.onDescendantFontBeginSave(),void 0!==this.fontDictionaryBeginSave&&this.onFontDictionaryBeginSave(),void 0!==this.annotationBeginSave&&this.onBeginAnnotationSave(),void 0!==this.sectionBeginSave&&this.onSectionBeginSave(e),void 0!==this.pageBeginDrawTemplate&&this.onTemplateBeginSave(),this.Count>0&&this.saveItems(e),e.write(this.suffix),e.write(m.newLine))},i.prototype.saveItems=function(e){e.write(m.newLine);for(var t=this.primitiveItems.keys(),r=this.primitiveItems.values(),n=0;n<t.length;n++)new O(t[n]).save(e),e.write(m.whiteSpace),r[n].save(e),e.write(m.newLine)},i}(),Fi=function(){return function(e){this.sender=e}}(),ji=function(){return function(e){this.sender=e}}(),Ei=function(){return function(e){this.sender=e}}(),Ti=function(){return function(e){this.sender=e}}(),Ri=function(){return function(e,t){this.sender=e,this.state=t}}(),Ni=function(){return function(e){this.sender=e}}(),B=function(){function i(e){this.position5=-1,this.value=e}return Object.defineProperty(i.prototype,"intValue",{get:function(){return this.value},set:function(e){this.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInteger",{get:function(){return this.integer},set:function(e){this.integer=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"status",{get:function(){return this.status5},set:function(e){this.status5=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving5},set:function(e){this.isSaving5=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index5},set:function(e){this.index5=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position5},set:function(e){this.position5=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),i.prototype.save=function(e){e.write(this.intValue.toString())},i.prototype.clone=function(e){return new i(this.value)},i.floatToString=function(e){var t=e.toFixed(2);return"0.00"===t&&(t=".00"),t},i.min=function(e,t,r){var n=Math.min(e,t);return Math.min(r,n)},i}(),j=function(){function i(e){if(this.startMark="[",this.endMark="]",this.position9=-1,this.clonedObject9=null,this.isFont=!1,void 0===e)this.internalElements=[];else if(void 0===e||e instanceof i){var s=e;for(this.internalElements=[],r=0;r<s.elements.length;r++)this.internalElements.push(s.elements[r])}else for(var t=e,r=0;r<t.length;r++){var n=new B(t[r]);this.add(n)}}return i.prototype.items=function(e){return this.internalElements[e]},Object.defineProperty(i.prototype,"count",{get:function(){return this.internalElements.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"status",{get:function(){return this.status9},set:function(e){this.status9=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving9},set:function(e){this.isSaving9=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return this.clonedObject9},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position9},set:function(e){this.position9=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index9},set:function(e){this.index9=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CrossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"elements",{get:function(){return this.internalElements},enumerable:!0,configurable:!0}),i.prototype.add=function(e){void 0===this.internalElements&&(this.internalElements=[]),this.internalElements.push(e),this.markedChange()},i.prototype.markedChange=function(){this.bChanged=!0},i.prototype.contains=function(e){for(var r=0;r<this.internalElements.length;r++){var n=this.internalElements[r];if(null!=n&&void 0!==n&&null!=e&&void 0!==e&&n.value===e.value)return!0}return!1},i.prototype.getItems=function(e){return this.internalElements[e]},i.prototype.save=function(e){e.write(this.startMark);for(var t=0,r=this.count;t<r;t++)this.getItems(t).save(e),t+1!==r&&e.write(m.whiteSpace);e.write(this.endMark)},i.prototype.clone=function(e){this.clonedObject9=null;for(var t=new i,r=0;r<this.internalElements.length;r++)t.add(this.internalElements[r].clone(e));return t.pdfCrossTable=e,this.clonedObject9=t,t},i.fromRectangle=function(e){return new i([e.x,e.y,e.width,e.height])},i.prototype.insert=function(e,t){if(e<this.internalElements.length&&e>0){for(var r=[],n=0;n<e;n++)r.push(this.internalElements[n]);for(r.push(t),n=e;n<this.internalElements.length;n++)r.push(this.internalElements[n]);this.internalElements=r}else this.internalElements.push(t);this.markChanged()},i.prototype.indexOf=function(e){return this.internalElements.indexOf(e)},i.prototype.remove=function(e){var t=this.internalElements.indexOf(e);this.internalElements[t]=null,this.markChanged()},i.prototype.removeAt=function(e){if(this.internalElements.length>e){for(var t=[],r=0;r<e;r++)t.push(this.internalElements[r]);for(r=e+1;r<this.internalElements.length;r++)t.push(this.internalElements[r]);this.internalElements=t}this.markChanged()},i.prototype.clear=function(){this.internalElements=[],this.markChanged()},i.prototype.markChanged=function(){this.bChanged=!0},i}(),Ai=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),J=function(i){function e(t,r){var n=i.call(this,t)||this;return n.dicPrefix="stream",n.dicSuffix="endstream",n.clonedObject2=null,n.bCompress=!0,n.isImageStream=!1,n.isFontStream=!1,void 0!==t||void 0!==r?(n.dataStream2=[],n.dataStream2=r,n.bCompress2=!1):(n.dataStream2=[],n.bCompress2=!0),n}return Ai(e,i),Object.defineProperty(e.prototype,"internalStream",{get:function(){return this.dataStream2},set:function(t){this.dataStream2=[],this.dataStream2=t,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isImage",{get:function(){return this.isImageStream},set:function(t){this.isImageStream=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFont",{get:function(){return this.isFontStream},set:function(t){this.isFontStream=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compress",{get:function(){return this.bCompress},set:function(t){this.bCompress=t,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.dataStream2},set:function(t){this.dataStream2=[],this.dataStream2=t,this.modify()},enumerable:!0,configurable:!0}),e.prototype.clearStream=function(){this.internalStream=[],this.items.containsKey(this.dictionaryProperties.filter)&&this.remove(this.dictionaryProperties.filter),this.bCompress=!0,this.modify()},e.prototype.write=function(t){if(null==t)throw new Error("ArgumentNullException:text");if(t.length<=0)throw new Error("ArgumentException: Can not write an empty string, text");this.dataStream2.push(t),this.modify()},e.prototype.writeBytes=function(t){if(null===t)throw new Error("ArgumentNullException:data");if(t.length<=0)throw new Error("ArgumentException: Can not write an empty bytes, data");for(var r="",n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);this.dataStream2.push(r),this.modify()},e.prototype.onCmapBeginSave=function(){this.cmapBeginSave.sender.cmapBeginSave()},e.prototype.onFontProgramBeginSave=function(){this.fontProgramBeginSave.sender.fontProgramBeginSave()},e.prototype.compressContent=function(t,r){if(this.bCompress){for(var n=[],s=0;s<t.length;s++)n.push(t.charCodeAt(s));var o=new Uint8Array(n),a=new Vi.Uj;a.write(o,0,o.length),a.close(),t=a.getCompressedString,this.addFilter(this.dictionaryProperties.flatedecode)}return t},e.prototype.addFilter=function(t){var r=this.items.getValue(this.dictionaryProperties.filter);r instanceof N&&(r=r.object);var s=r,o=r;null!=o&&((s=new j).insert(0,o),this.items.setValue(this.dictionaryProperties.filter,s)),o=new O(t),null==s?this.items.setValue(this.dictionaryProperties.filter,o):s.insert(0,o)},e.prototype.save=function(t){void 0!==this.cmapBeginSave&&this.onCmapBeginSave(),void 0!==this.fontProgramBeginSave&&this.onFontProgramBeginSave();for(var r="",n=0;n<this.data.length;n++)r+=this.data[n];r.length>1&&!this.isImage&&!this.isFont&&(r="q\r\n"+r+"Q\r\n"),r=this.compressContent(r,t),this.items.setValue(this.dictionaryProperties.length,new B(r.length)),i.prototype.save.call(this,t,!1),t.write(this.dicPrefix),t.write(m.newLine),r.length>0&&t.write(r),t.write(m.newLine),t.write(this.dicSuffix),t.write(m.newLine)},e.bytesToString=function(t){for(var r="",n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r},e}(F),Di=function(){return function(e){this.sender=e}}(),Mi=function(){return function(e){this.sender=e}}();!function(i){var r;(r=i.ForceEncoding||(i.ForceEncoding={}))[r.None=0]="None",r[r.Ascii=1]="Ascii",r[r.Unicode=2]="Unicode"}(_e||(_e={}));var U=function(){function i(e){if(this.bHex=!1,this.position1=-1,this.clonedObject1=null,this.bDecrypted=!1,this.isParentDecrypted=!1,this.isPacked=!1,this.isFormField=!1,this.isColorSpace=!1,this.isHexString=!0,void 0===e)this.bHex=!1;else if(!(e.length>0&&"0xfeff"===e[0])){this.stringValue=e,this.data=[];for(var t=0;t<e.length;++t)this.data.push(e.charCodeAt(t))}}return Object.defineProperty(i.prototype,"hex",{get:function(){return this.bHex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.stringValue},set:function(e){this.stringValue=e,this.data=null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"status",{get:function(){return this.status1},set:function(e){this.status1=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving1},set:function(e){this.isSaving1=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index1},set:function(e){this.index1=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return this.clonedObject1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position1},set:function(e){this.position1=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CrossTable",{get:function(){return this.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"converted",{get:function(){return this.bConverted},set:function(e){this.bConverted=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"encode",{get:function(){return this.bForceEncoding},set:function(e){this.bForceEncoding=e},enumerable:!0,configurable:!0}),i.bytesToHex=function(e){return""},i.prototype.save=function(e){if(null===e)throw new Error("ArgumentNullException : writer");e.write(void 0!==this.encode&&this.encode===_e.ForceEncoding.Ascii?this.pdfEncode():i.stringMark[0]+this.value+i.stringMark[1])},i.prototype.pdfEncode=function(){var e="";if(void 0!==this.encode&&this.encode===_e.ForceEncoding.Ascii){for(var t=this.escapeSymbols(this.value),r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);e=i.stringMark[0]+e+i.stringMark[1]}else e=this.value;return e},i.prototype.escapeSymbols=function(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);switch(n){case 40:case 41:case 92:t.push(92),t.push(n);break;case 13:t.push(92),t.push(114);break;default:t.push(n)}}return t},i.prototype.clone=function(e){if(null!==this.clonedObject1&&this.clonedObject1.CrossTable===e)return this.clonedObject1;this.clonedObject1=null;var t=new i(this.stringValue);return t.bHex=this.bHex,t.crossTable=e,t.isColorSpace=this.isColorSpace,this.clonedObject1=t,t},i.toUnicodeArray=function(e,t){if(null==e)throw new Error("Argument Null Exception : value");for(var r=[],n=0;n<e.length;n++){var s=e.charCodeAt(n);r.push(s/256>>>0),r.push(255&s)}return r},i.byteToString=function(e){if(null==e)throw new Error("Argument Null Exception : stream");for(var t="",r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t},i.stringMark="()",i.hexStringMark="<>",i.hexFormatPattern="{0:X2}",i}(),bt=function(){function i(e,t){this.index3=-1,this.position3=-1,this.objNumber=0,this.genNumber=0,"number"==typeof e&&"number"==typeof t?(this.objNumber=e,this.genNumber=t):(this.objNumber=Number(e),this.genNumber=Number(t))}return Object.defineProperty(i.prototype,"status",{get:function(){return this.status3},set:function(e){this.status3=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving3},set:function(e){this.isSaving3=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index3},set:function(e){this.index3=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position3},set:function(e){this.position3=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),i.prototype.save=function(e){e.write(this.toString())},i.prototype.toString=function(){return this.objNumber.toString()+" "+this.genNumber.toString()+" R"},i.prototype.clone=function(e){return null},i}(),N=function(){function i(e,t){this.index4=-1,this.position4=-1,this.objectIndex=-1,this.dictionaryProperties=new M,this.initialize(e)}return Object.defineProperty(i.prototype,"status",{get:function(){return this.status4},set:function(e){this.status4=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.isSaving4},set:function(e){this.isSaving4=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index4},set:function(e){this.index4=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.position4},set:function(e){this.position4=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"object",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"index",{get:function(){return this.objectIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),i.prototype.initialize=function(e){e instanceof j||e instanceof F||e instanceof O||e instanceof B||e instanceof J||e instanceof bt||e instanceof U?this.primitiveObject=e:this.initialize(e.element)},i.prototype.save=function(e){var r=e.document.crossTable;this.object.isSaving=!0,r.getReference(this.object).save(e)},i.prototype.clone=function(e){return null},i}(),Ii=function(){function i(){this.action=null,this.dictionaryProperties=new M,this.initialize()}return Object.defineProperty(i.prototype,"next",{get:function(){return this.action},set:function(e){this.action=e,this.dictionary.items.setValue(this.dictionaryProperties.next,new N(this.action))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dictionary",{get:function(){return void 0===this.pdfDictionary&&(this.pdfDictionary=new F),this.pdfDictionary},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.dictionary.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.action))},Object.defineProperty(i.prototype,"element",{get:function(){return this.dictionary},enumerable:!0,configurable:!0}),i}(),Gi=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),_i=function(i){function e(t){var r=i.call(this)||this;return r.uniformResourceIdentifier="",r}return Gi(e,i),Object.defineProperty(e.prototype,"uri",{get:function(){return this.uniformResourceIdentifier},set:function(t){this.uniformResourceIdentifier=t,this.dictionary.items.setValue(this.dictionaryProperties.uri,new U(this.uniformResourceIdentifier))},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){i.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.s,new O(this.dictionaryProperties.uri))},e}(Ii),le=(()=>(function(i){i[i.Top=0]="Top",i[i.Middle=1]="Middle",i[i.Bottom=2]="Bottom"}(le||(le={})),le))(),_=(()=>(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right",i[i.Justify=3]="Justify"}(_||(_={})),_))(),ce=(()=>(function(i){i[i.Fill=0]="Fill",i[i.Stroke=1]="Stroke",i[i.FillStroke=2]="FillStroke",i[i.None=3]="None",i[i.ClipFlag=4]="ClipFlag",i[i.ClipFill=4]="ClipFill",i[i.ClipStroke=5]="ClipStroke",i[i.ClipFillStroke=6]="ClipFillStroke",i[i.Clip=7]="Clip"}(ce||(ce={})),ce))(),ke=(()=>(function(i){i[i.Flat=0]="Flat",i[i.Round=1]="Round",i[i.Square=2]="Square"}(ke||(ke={})),ke))(),W=(()=>(function(i){i[i.Solid=0]="Solid",i[i.Dash=1]="Dash",i[i.Dot=2]="Dot",i[i.DashDot=3]="DashDot",i[i.DashDotDot=4]="DashDotDot",i[i.Custom=5]="Custom"}(W||(W={})),W))(),we=(()=>(function(i){i[i.Winding=0]="Winding",i[i.Alternate=1]="Alternate"}(we||(we={})),we))(),x=(()=>(function(i){i[i.Rgb=0]="Rgb",i[i.Cmyk=1]="Cmyk",i[i.GrayScale=2]="GrayScale",i[i.Indexed=3]="Indexed"}(x||(x={})),x))(),ze=(()=>(function(i){i[i.Normal=0]="Normal",i[i.Multiply=1]="Multiply",i[i.Screen=2]="Screen",i[i.Overlay=3]="Overlay",i[i.Darken=4]="Darken",i[i.Lighten=5]="Lighten",i[i.ColorDodge=6]="ColorDodge",i[i.ColorBurn=7]="ColorBurn",i[i.HardLight=8]="HardLight",i[i.SoftLight=9]="SoftLight",i[i.Difference=10]="Difference",i[i.Exclusion=11]="Exclusion",i[i.Hue=12]="Hue",i[i.Saturation=13]="Saturation",i[i.Color=14]="Color",i[i.Luminosity=15]="Luminosity"}(ze||(ze={})),ze))(),Fe=(()=>(function(i){i[i.Centimeter=0]="Centimeter",i[i.Pica=1]="Pica",i[i.Pixel=2]="Pixel",i[i.Point=3]="Point",i[i.Inch=4]="Inch",i[i.Document=5]="Document",i[i.Millimeter=6]="Millimeter"}(Fe||(Fe={})),Fe))(),te=(()=>(function(i){i[i.None=0]="None",i[i.LeftToRight=1]="LeftToRight",i[i.RightToLeft=2]="RightToLeft"}(te||(te={})),te))(),g=function(){function i(e,t,r,n){void 0===e?void 0!==t&&void 0!==r&&void 0!==n?this.assignRGB(t,r,n):this.filled=!1:e instanceof i?(this.redColor=e.r,this.greenColor=e.g,this.blueColor=e.b,this.grayColor=e.gray,this.alpha=e.alpha,this.filled=0!==this.alpha):"number"==typeof e&&void 0===t&&void 0===r&&void 0===n?(e<0&&(e=0),e>1&&(e=1),this.redColor=e*i.maxColourChannelValue,this.greenColor=e*i.maxColourChannelValue,this.blueColor=e*i.maxColourChannelValue,this.cyanColor=e,this.magentaColor=e,this.yellowColor=e,this.blackColor=e,this.grayColor=e,this.alpha=i.maxColourChannelValue,this.filled=!0):void 0===n?this.assignRGB(e,t,r):this.assignRGB(t,r,n,e)}return i.prototype.assignRGB=function(e,t,r,n){void 0===e||void 0===t||void 0===r?this.filled=!1:(this.cyanColor=0,this.magentaColor=0,this.yellowColor=0,this.blackColor=0,this.grayColor=0,this.redColor=e,this.greenColor=t,this.blueColor=r,this.alpha=void 0===n?i.maxColourChannelValue:n,this.filled=!0,this.assignCMYK(e,t,r))},i.prototype.assignCMYK=function(e,t,r){var n=e/i.maxColourChannelValue,s=t/i.maxColourChannelValue,o=r/i.maxColourChannelValue,a=B.min(1-n,1-s,1-o),h=1===a?0:(1-n-a)/(1-a),l=1===a?0:(1-s-a)/(1-a),c=1===a?0:(1-o-a)/(1-a);this.blackColor=a,this.cyanColor=h,this.magentaColor=l,this.yellowColor=c},Object.defineProperty(i.prototype,"r",{get:function(){return this.redColor},set:function(e){this.redColor=e,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"red",{get:function(){return this.r/i.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"b",{get:function(){return this.blueColor},set:function(e){this.blueColor=e,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"blue",{get:function(){return this.b/i.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c",{get:function(){return this.cyanColor},set:function(e){this.cyanColor=e<0?0:e>1?1:e,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"k",{get:function(){return this.blackColor},set:function(e){this.blackColor=e<0?0:e>1?1:e,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"m",{get:function(){return this.magentaColor},set:function(e){this.magentaColor=e<0?0:e>1?1:e,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.yellowColor},set:function(e){this.yellowColor=e<0?0:e>1?1:e,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"g",{get:function(){return this.greenColor},set:function(e){this.greenColor=e,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"green",{get:function(){return this.g/i.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gray",{get:function(){return(this.redColor+this.greenColor+this.blueColor)/(3*i.maxColourChannelValue)},set:function(e){this.grayColor=e<0?0:e>1?1:e,this.r=this.grayColor*i.maxColourChannelValue,this.g=this.grayColor*i.maxColourChannelValue,this.b=this.grayColor*i.maxColourChannelValue,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isEmpty",{get:function(){return!this.filled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"a",{get:function(){return this.alpha},set:function(e){this.alpha=e<0?0:e,this.filled=!0},enumerable:!0,configurable:!0}),i.prototype.toString=function(e,t){if(this.isEmpty)return"";var r="";switch(e){case x.Rgb:r=this.rgbToString(t);break;case x.GrayScale:r=this.grayScaleToString(t);break;case x.Cmyk:r=this.cmykToString(t)}return r},i.prototype.grayScaleToString=function(e){var t=this.gray,r="",n=null;return null==(n=e?i.grayStringsSroke.containsKey(t)?i.grayStringsSroke.getValue(t):null:i.grayStringsFill.containsKey(t)?i.grayStringsFill.getValue(t):null)?e&&(r=t.toString()+" G",i.grayStringsSroke.setValue(t,r)):r=n.toString(),r+m.newLine},i.prototype.rgbToString=function(e){var t=this.r,r=this.g,n=this.b,s=(t<<16)+(r<<8)+n;e&&(s+=1<<24);var o="",a=null;if(i.rgbStrings.containsKey(s)&&(a=i.rgbStrings.getValue(s)),null==a){var h=t/i.maxColourChannelValue,l=r/i.maxColourChannelValue,c=n/i.maxColourChannelValue;o=e?h.toString()+" "+l.toString()+" "+c.toString()+" RG":h.toString()+" "+l.toString()+" "+c.toString()+" rg",i.rgbStrings.setValue(s,o)}else o=a.toString();return o+m.newLine},i.prototype.cmykToString=function(e){var r=this.m,n=this.y,s=this.b;return this.c.toString()+" "+r.toString()+" "+n.toString()+" "+s.toString()+" K"+m.newLine},i.prototype.toArray=function(e){var t=new j;return e===x.Rgb&&(t.add(new B(this.red)),t.add(new B(this.green)),t.add(new B(this.blue))),t},i.rgbStrings=new D,i.grayStringsSroke=new D,i.grayStringsFill=new D,i.maxColourChannelValue=255,i}(),b=function(){return function(e,t){void 0===e?(this.x=0,this.y=0):(this.x=null!==e?e:0,this.y=null!==t?t:0)}}(),S=function(){return function(e,t){void 0===t?(this.height=0,this.width=0):(this.height=null!==t?t:0,this.width=null!==e?e:0)}}(),w=function(){return function(e,t,r,n){if(typeof e==typeof e&&void 0===e)this.x=0,this.y=0,this.height=0,this.width=0;else if(e instanceof b&&t instanceof S&&void 0===r){var s=e;this.x=s.x,this.y=s.y;var o=t;this.height=o.height,this.width=o.width}else{var h=t,l=r,c=n;this.x=e,this.y=h,this.height=c,this.width=l}}}(),st=function(){function i(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n}return Object.defineProperty(i.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topLeft",{get:function(){return new b(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return new S(this.width,this.height)},enumerable:!0,configurable:!0}),i.prototype.toString=function(){return this.topLeft+"x"+this.size},i}(),oe=function(){function i(){}return i.prototype.clone=function(){return this},i}(),zi=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),pe=function(i){function e(t){var r=i.call(this)||this;return r.pdfColor=t,r}return zi(e,i),Object.defineProperty(e.prototype,"color",{get:function(){return this.pdfColor},set:function(t){this.pdfColor=t},enumerable:!0,configurable:!0}),e.prototype.monitorChanges=function(t,r,n,s,o){if(null==r)throw new Error("ArgumentNullException:streamWriter");return!0,r.setColorAndSpace(this.pdfColor,o,!1),true},e.prototype.resetChanges=function(t){t.setColorAndSpace(new g(0,0,0),x.Rgb,!1)},e}(oe),E=(()=>(function(i){i[i.Regular=0]="Regular",i[i.Bold=1]="Bold",i[i.Italic=2]="Italic",i[i.Underline=4]="Underline",i[i.Strikeout=8]="Strikeout"}(E||(E={})),E))(),q=(()=>(function(i){i[i.Helvetica=0]="Helvetica",i[i.Courier=1]="Courier",i[i.TimesRoman=2]="TimesRoman",i[i.Symbol=3]="Symbol",i[i.ZapfDingbats=4]="ZapfDingbats"}(q||(q={})),q))(),ae=(()=>(function(i){i[i.None=0]="None",i[i.Word=1]="Word",i[i.WordOnly=2]="WordOnly",i[i.Character=3]="Character"}(ae||(ae={})),ae))(),ge=(()=>(function(i){i[i.None=0]="None",i[i.SuperScript=1]="SuperScript",i[i.SubScript=2]="SubScript"}(ge||(ge={})),ge))(),ot=(()=>(function(i){i[i.Unknown=0]="Unknown",i[i.StandardEncoding=1]="StandardEncoding",i[i.MacRomanEncoding=2]="MacRomanEncoding",i[i.MacExpertEncoding=3]="MacExpertEncoding",i[i.WinAnsiEncoding=4]="WinAnsiEncoding",i[i.PdfDocEncoding=5]="PdfDocEncoding",i[i.IdentityH=6]="IdentityH"}(ot||(ot={})),ot))(),Ne=(()=>(function(i){i[i.Apple=0]="Apple",i[i.Microsoft=4]="Microsoft",i[i.Trimmed=6]="Trimmed"}(Ne||(Ne={})),Ne))(),$=(()=>(function(i){i[i.Unknown=0]="Unknown",i[i.Symbol=1]="Symbol",i[i.Unicode=2]="Unicode",i[i.Macintosh=3]="Macintosh"}($||($={})),$))(),Se=(()=>(function(i){i[i.AppleUnicode=0]="AppleUnicode",i[i.Macintosh=1]="Macintosh",i[i.Iso=2]="Iso",i[i.Microsoft=3]="Microsoft"}(Se||(Se={})),Se))(),We=(()=>(function(i){i[i.Undefined=0]="Undefined",i[i.Unicode=1]="Unicode"}(We||(We={})),We))(),at=(()=>(function(i){i[i.Roman=0]="Roman",i[i.Japanese=1]="Japanese",i[i.Chinese=2]="Chinese"}(at||(at={})),at))(),Pe=(()=>(function(i){i[i.FixedPitch=1]="FixedPitch",i[i.Serif=2]="Serif",i[i.Symbolic=4]="Symbolic",i[i.Script=8]="Script",i[i.Nonsymbolic=32]="Nonsymbolic",i[i.Italic=64]="Italic",i[i.ForceBold=262144]="ForceBold"}(Pe||(Pe={})),Pe))(),Be=(()=>(function(i){i[i.Arg1And2AreWords=1]="Arg1And2AreWords",i[i.ArgsAreXyValues=2]="ArgsAreXyValues",i[i.RoundXyToGrid=4]="RoundXyToGrid",i[i.WeHaveScale=8]="WeHaveScale",i[i.Reserved=16]="Reserved",i[i.MoreComponents=32]="MoreComponents",i[i.WeHaveAnXyScale=64]="WeHaveAnXyScale",i[i.WeHaveTwoByTwo=128]="WeHaveTwoByTwo",i[i.WeHaveInstructions=256]="WeHaveInstructions",i[i.UseMyMetrics=512]="UseMyMetrics"}(Be||(Be={})),Be))(),ye=function(){function i(e,t){this.scalingFactor=100,this.wordWrapType=ae.Word,this.internalLineLimit=!0,this.wordWrapType=ae.Word,void 0!==e&&"string"!=typeof e&&(this.textAlignment=e),void 0!==t&&(this.verticalAlignment=t)}return Object.defineProperty(i.prototype,"alignment",{get:function(){return this.textAlignment},set:function(e){this.textAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineAlignment",{get:function(){return void 0===this.verticalAlignment||null==this.verticalAlignment?le.Top:this.verticalAlignment},set:function(e){this.verticalAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightToLeft",{get:function(){return void 0!==this.isRightToLeft&&null!=this.isRightToLeft&&this.isRightToLeft},set:function(e){this.isRightToLeft=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"characterSpacing",{get:function(){return void 0===this.internalCharacterSpacing||null==this.internalCharacterSpacing?0:this.internalCharacterSpacing},set:function(e){this.internalCharacterSpacing=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wordSpacing",{get:function(){return void 0===this.internalWordSpacing||null==this.internalWordSpacing?0:this.internalWordSpacing},set:function(e){this.internalWordSpacing=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return void 0===this.leading||null==this.leading?0:this.leading},set:function(e){this.leading=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clipPath",{get:function(){return void 0!==this.clip&&null!=this.clip&&this.clip},set:function(e){this.clip=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"subSuperScript",{get:function(){return void 0===this.pdfSubSuperScript||null==this.pdfSubSuperScript?ge.None:this.pdfSubSuperScript},set:function(e){this.pdfSubSuperScript=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paragraphIndent",{get:function(){return void 0===this.internalParagraphIndent||null==this.internalParagraphIndent?0:this.internalParagraphIndent},set:function(e){this.internalParagraphIndent=e,this.firstLineIndent=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineLimit",{get:function(){return this.internalLineLimit},set:function(e){this.internalLineLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"measureTrailingSpaces",{get:function(){return void 0!==this.trailingSpaces&&null!=this.trailingSpaces&&this.trailingSpaces},set:function(e){this.trailingSpaces=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"noClip",{get:function(){return void 0!==this.isNoClip&&null!=this.isNoClip&&this.isNoClip},set:function(e){this.isNoClip=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this.wordWrapType},set:function(e){this.wordWrapType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalScalingFactor",{get:function(){return this.scalingFactor},set:function(e){if(e<=0)throw new Error("ArgumentOutOfRangeException:The scaling factor cant be less of equal to zero, ScalingFactor");this.scalingFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"firstLineIndent",{get:function(){return void 0===this.initialLineIndent||null==this.initialLineIndent?0:this.initialLineIndent},set:function(e){this.initialLineIndent=e},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return this},i}(),ee=function(){function i(e){if(this.currentPosition=0,null==e)throw new Error("ArgumentNullException:text");this.text=e}return Object.defineProperty(i.prototype,"length",{get:function(){return this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"end",{get:function(){return this.currentPosition===this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.currentPosition},set:function(e){this.currentPosition=e},enumerable:!0,configurable:!0}),i.getCharsCount=function(e,t){if("string"==typeof t){if(null==e)throw new Error("ArgumentNullException:wholeText");for(var r=0,n=0;-1!==(n=e.indexOf(t,n));)r++,n++;return r}if(null==e)throw new Error("ArgumentNullException:text");if(null==t)throw new Error("ArgumentNullException:symbols");for(var s=0,o=0,a=e.length;o<a;o++)this.contains(t,e[o])&&s++;return s},i.prototype.readLine=function(){for(var e=this.currentPosition;e<this.length;){var t=this.text[e];switch(t){case"\r":case"\n":var r=this.text.substr(this.currentPosition,e-this.currentPosition);return this.currentPosition=e+1,"\r"===t&&this.currentPosition<this.length&&"\n"===this.text[this.currentPosition]&&this.currentPosition++,r}e++}if(e>this.currentPosition){var n=this.text.substr(this.currentPosition,e-this.currentPosition);return this.currentPosition=e,n}return null},i.prototype.peekLine=function(){var e=this.currentPosition,t=this.readLine();return this.currentPosition=e,t},i.prototype.readWord=function(){for(var e=this.currentPosition;e<this.length;){var t=this.text[e];switch(t){case"\r":case"\n":var r=this.text.substr(this.currentPosition,e-this.currentPosition);return this.currentPosition=e+1,"\r"===t&&this.currentPosition<this.length&&"\n"===this.text[this.currentPosition]&&this.currentPosition++,r;case" ":case"\t":e===this.currentPosition&&e++;var n=this.text.substr(this.currentPosition,e-this.currentPosition);return this.currentPosition=e,n}e++}if(e>this.currentPosition){var s=this.text.substr(this.currentPosition,e-this.currentPosition);return this.currentPosition=e,s}return null},i.prototype.peekWord=function(){var e=this.currentPosition,t=this.readWord();return this.currentPosition=e,t},i.prototype.read=function(e){if(void 0===e){var t="0";return this.end||(t=this.text[this.currentPosition],this.currentPosition++),t}for(var r=0,n="";!this.end&&r<e;)n+=t=this.read(),r++;return n},i.prototype.peek=function(){var e="0";return this.end||(e=this.text[this.currentPosition]),e},i.prototype.close=function(){this.text=null},i.prototype.readToEnd=function(){var e;return e=0===this.currentPosition?this.text:this.text.substr(this.currentPosition,this.length-this.currentPosition),this.currentPosition=this.length,e},i.contains=function(e,t){for(var r=!1,n=0;n<e.length;n++)if(e[n]===t){r=!0;break}return r},i.spaces=[i.whiteSpace=" ",i.tab="\t"],i.whiteSpacePattern="^[ \t]+$",i}(),me=function(){function i(){this.isOverloadWithPosition=!1}return i.prototype.layout=function(e,t,r,n,s,o,a){if(n instanceof w){this.initialize(e,t,r,n,s),this.isOverloadWithPosition=o,this.clientSize=a;var h=this.doLayout();return this.clear(),h}return this.initialize(e,t,r,n),this.isOverloadWithPosition=s,this.clientSize=o,h=this.doLayout(),this.clear(),h},i.prototype.initialize=function(e,t,r,n,s){if("number"==typeof s){if(null==e)throw new Error("ArgumentNullException:text");if(null==t)throw new Error("ArgumentNullException:font");this.text=e,this.font=t,this.format=r,this.size=new S(n.width,n.height),this.rectangle=n,this.pageHeight=s,this.reader=new ee(e)}else this.initialize(e,t,r,new w(new b(0,0),n),0)},i.prototype.clear=function(){this.font=null,this.format=null,this.reader.close(),this.reader=null,this.text=null},i.prototype.doLayout=function(){for(var e=new vt,t=new vt,r=[],n=this.reader.peekLine(),s=this.getLineIndent(!0);null!=n;){if(null!==(t=this.layoutLine(n,s))||void 0!==t){var o=0,a=this.copyToResult(e,t,r,o);if(o=a.numInserted,!a.success){this.reader.read(o);break}}this.reader.readLine(),n=this.reader.peekLine(),s=this.getLineIndent(!1)}return this.finalizeResult(e,r),e},i.prototype.getLineIndent=function(e){var t=0;return null!=this.format&&(t=e?this.format.firstLineIndent:this.format.paragraphIndent,t=this.size.width>0?Math.min(this.size.width,t):t),t},i.prototype.getLineHeight=function(){var e=this.font.height;return null!=this.format&&0!==this.format.lineSpacing&&(e=this.format.lineSpacing+this.font.height),e},i.prototype.getLineWidth=function(e){return this.font.getLineWidth(e,this.format)},i.prototype.layoutLine=function(e,t){var r=new vt;r.layoutLineHeight=this.getLineHeight();var n=[],s=this.size.width,o=this.getLineWidth(e)+t,a=ie.FirstParagraphLine,h=!0;if(s<=0||Math.round(o)<=Math.round(s))this.addToLineResult(r,n,e,o,ie.NewLineBreak|a);else{var l="",c="";o=t;var f=t,d=new ee(e),p=d.peekWord();for(p.length!==d.length&&" "===p&&(c+=p,l+=p,d.position+=1,p=d.peekWord());null!=p;){var v=this.getLineWidth((c+=p).toString())+f;if(" "===c.toString()&&(c="",v=0),v>s){if(this.getWrapType()===ae.None)break;if(c.length===p.length){if(this.getWrapType()===ae.WordOnly){r.textRemainder=e.substring(d.position);break}if(1===c.length){l+=p;break}h=!1,c="",p=d.peek().toString();continue}this.getLineWidth(p.toString())>s?this.format.wordWrap=ae.Character:null!=this.format&&(this.format.wordWrap=ae.Word),this.getWrapType()===ae.Character&&h?(h=!1,c="",c+=l.toString(),p=d.peek().toString()):(" "!==(y=l.toString())&&this.addToLineResult(r,n,y,o,ie.LayoutBreak|a),this.isOverloadWithPosition&&(s=this.clientSize.width),c="",l="",o=0,f=0,v=0,a=ie.None,p=h?p:d.peekWord(),h=!0)}else l+=p,o=v,h?(d.readWord(),p=d.peekWord()):(d.read(),p=d.peek().toString())}if(l.length>0){var y=l.toString();this.addToLineResult(r,n,y,o,ie.NewLineBreak|ie.LastParagraphLine)}d.close()}r.layoutLines=[];for(var P=0;P<n.length;P++)r.layoutLines.push(n[P]);return n=[],r},i.prototype.addToLineResult=function(e,t,r,n,s){var o=new Wi;o.text=r,o.width=n,o.lineType=s,t.push(o);var a=e.actualSize;a.height+=this.getLineHeight(),a.width=Math.max(a.width,n),e.size=a},i.prototype.copyToResult=function(e,t,r,n){var s=!0,o=null!=this.format&&!this.format.lineLimit,a=e.actualSize.height,h=this.size.height;if(this.pageHeight>0&&h+this.rectangle.y>this.pageHeight&&(h=this.rectangle.y-this.pageHeight,h=Math.max(h,-h)),n=0,null!=t.lines)for(var l=0,c=t.lines.length;l<c;l++){var f=a+t.lineHeight;if(!(f<=h||h<=0||o)){s=!1;break}var d=t.lines[l];n+=d.text.length,d=this.trimLine(d,0===r.length),r.push(d);var p=e.actualSize;p.width=Math.max(p.width,d.width),e.size=p,a=f}if(a!=e.size.height){var v=e.actualSize;v.height=a,e.size=v}return{success:s,numInserted:n}},i.prototype.finalizeResult=function(e,t){e.layoutLines=[];for(var r=0;r<t.length;r++)e.layoutLines.push(t[r]);e.layoutLineHeight=this.getLineHeight(),this.reader.end||(e.textRemainder=this.reader.readToEnd()),t=[]},i.prototype.trimLine=function(e,t){var r=e.text,n=e.width;return(r=r.trim()).length!==e.text.length&&(n=this.getLineWidth(r),(e.lineType&ie.FirstParagraphLine)>0&&(n+=this.getLineIndent(t))),e.text=r,e.width=n,e},i.prototype.getWrapType=function(){return null!=this.format?this.format.wordWrap:ae.Word},i}(),vt=function(){function i(){}return Object.defineProperty(i.prototype,"remainder",{get:function(){return this.textRemainder},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualSize",{get:function(){return void 0===this.size&&(this.size=new S(0,0)),this.size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lines",{get:function(){return this.layoutLines},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineHeight",{get:function(){return this.layoutLineHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"empty",{get:function(){return null==this.layoutLines||0===this.layoutLines.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineCount",{get:function(){return this.empty?0:this.layoutLines.length},enumerable:!0,configurable:!0}),i}(),Wi=function(){function i(){}return Object.defineProperty(i.prototype,"lineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.content},set:function(e){this.content=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.lineWidth},set:function(e){this.lineWidth=e},enumerable:!0,configurable:!0}),i}(),ie=(()=>(function(i){i[i.None=0]="None",i[i.NewLineBreak=1]="NewLineBreak",i[i.LayoutBreak=2]="LayoutBreak",i[i.FirstParagraphLine=4]="FirstParagraphLine",i[i.LastParagraphLine=8]="LastParagraphLine"}(ie||(ie={})),ie))(),re=function(){function i(e,t){this.fontStyle=E.Regular,"number"==typeof e&&void 0===t?this.fontSize=e:(this.fontSize=e,this.setStyle(t))}return Object.defineProperty(i.prototype,"name",{get:function(){return this.metrics.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.metrics.getHeight(null)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return this.fontStyle},set:function(e){this.fontStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bold",{get:function(){return(this.style&E.Bold)>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"italic",{get:function(){return(this.style&E.Italic)>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strikeout",{get:function(){return(this.style&E.Strikeout)>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"underline",{get:function(){return(this.style&E.Underline)>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"metrics",{get:function(){return this.fontMetrics},set:function(e){this.fontMetrics=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.pdfFontInternals},enumerable:!0,configurable:!0}),i.prototype.measureString=function(e,t,r,n,s){if("string"==typeof e&&void 0===t)return this.measureString(e,null);if("string"==typeof e&&(t instanceof ye||null==t)&&void 0===r&&void 0===n)return this.measureString(e,o=t,0,0);if("string"==typeof e&&(t instanceof ye||null==t)&&"number"==typeof r&&"number"==typeof n)return this.measureString(e,0,o=t,r,n);if("string"==typeof e&&"number"==typeof t&&(r instanceof ye||null==r)&&"number"==typeof n&&"number"==typeof s){var l=new S(t,0);return this.measureString(e,l,c=r,n,s)}if(null==e)throw Error('ArgumentNullException("text")');var o=t,c=r,d=(new me).layout(e,this,c,o,!1,new S(0,0));return n=e.length,s=d.empty?0:d.lines.length,d.actualSize},i.prototype.equalsTo=function(e){return this.equalsToFont(e)},i.prototype.getInternals=function(){return this.pdfFontInternals},i.prototype.setInternals=function(e){if(null==e)throw new Error("ArgumentNullException:internals");this.pdfFontInternals=e},i.prototype.setStyle=function(e){this.fontStyle=e},i.prototype.applyFormatSettings=function(e,t,r){var n=r;return null!=t&&r>0&&(0!==t.characterSpacing&&(n+=(e.length-1)*t.characterSpacing),0!==t.wordSpacing)&&(n+=ee.getCharsCount(e,ee.spaces)*t.wordSpacing),n},i.charSizeMultiplier=.001,i.syncObject=new Object,i}(),Hi=function(){function i(e){this.streamWriter=e}return Object.defineProperty(i.prototype,"document",{get:function(){return this.pdfDocument},set:function(e){this.pdfDocument=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stream",{get:function(){return this.streamWriter},enumerable:!0,configurable:!0}),i.prototype.write=function(e){this.streamWriter.write(e)},i}(),Ae=(()=>(function(i){i[i.None=0]="None",i[i.Registered=1]="Registered"}(Ae||(Ae={})),Ae))(),Ui=function(){function i(){this.objectCollections=[],this.mainObjectCollection=new D,this.primitiveObjectCollection=new D}return Object.defineProperty(i.prototype,"count",{get:function(){return this.objectCollections.length},enumerable:!0,configurable:!0}),i.prototype.items=function(e){return this.objectCollections[e]},Object.defineProperty(i.prototype,"outIsNew",{get:function(){return this.isNew},enumerable:!0,configurable:!0}),i.prototype.add=function(e){var t=new qi(e);this.objectCollections.push(t),this.primitiveObjectCollection.containsKey(e)||this.primitiveObjectCollection.setValue(e,this.objectCollections.length-1),e.position=this.index=this.objectCollections.length-1,e.status=Ae.Registered},i.prototype.lookFor=function(e){var t=-1;if(-1!==e.position)return e.position;if(this.primitiveObjectCollection.containsKey(e)&&this.count===this.primitiveObjectCollection.size())t=this.primitiveObjectCollection.getValue(e);else for(var r=this.count-1;r>=0;r--)if(this.objectCollections[r].object===e){t=r;break}return t},i.prototype.getReference=function(e,t){return this.index=this.lookFor(e),this.isNew=!1,{reference:this.objectCollections[this.index].reference,wasNew:t}},i.prototype.trySetReference=function(e,t,r){return this.index=this.lookFor(e),this.objectCollections[this.index].setReference(t),!0},i.prototype.destroy=function(){for(var e=0,t=this.objectCollections;e<t.length;e++){var r=t[e];void 0!==r&&(r.pdfObject.position=-1,r.pdfObject.isSaving=void 0,r.pdfObject.objectCollectionIndex=void 0,r.pdfObject.position=void 0)}this.objectCollections=[],this.mainObjectCollection=new D,this.primitiveObjectCollection=new D},i}(),qi=function(){function i(e,t){this.pdfObject=e,this.pdfReference=t}return Object.defineProperty(i.prototype,"object",{get:function(){return this.pdfObject},set:function(e){this.pdfObject=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),i.prototype.setReference=function(e){this.pdfReference=e},i}(),Yi=function(){function i(e){this.isStreamCopied=!1,e instanceof Ve&&(this.document=e)}return Object.defineProperty(i.prototype,"pdfObjects",{get:function(){return this.objects},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"crossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentSavingObj",{get:function(){return this.currentSavingObject},set:function(e){this.currentSavingObject=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"catalog",{get:function(){return this.pdfCatalog},set:function(e){this.pdfCatalog=e},enumerable:!0,configurable:!0}),i.prototype.setMainObjectCollection=function(e){this.objects=e},i.prototype.setCrossTable=function(e){this.pdfCrossTable=e},i.prototype.setCatalog=function(e){this.pdfCatalog=e},i.prototype.save=function(e){var t=this,r=new nt.ez(!0),n=new nt.LF(r);if(void 0===e){var s=new nt.ez(!0),o=new nt.LF(s);return new Promise(function(a,h){var l={};l.blobData=new Blob([t.document.docSave(o,!0)],{type:"application/pdf"}),a(l)})}this.document.docSave(n,e,!0)},i.prototype.clone=function(){return this.document},i}(),De=(()=>(function(i){i[i.Free=0]="Free",i[i.Normal=1]="Normal",i[i.Packed=2]="Packed"}(De||(De={})),De))(),Ji=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),It=function(i){function e(){var t=i.call(this)||this;return t.sections=null,t.tempDictionaryProperties=new M,t.items.setValue((new M).type,new O("Catalog")),t}return Ji(e,i),Object.defineProperty(e.prototype,"pages",{get:function(){return this.sections},set:function(t){this.sections=t,this.items.setValue(this.tempDictionaryProperties.pages,new N(t))},enumerable:!0,configurable:!0}),e}(F),Gt=function(){function i(){this.objects=new D,this.maxGenNumIndex=0,this.objectCount=0,this.dictionaryProperties=new M}return Object.defineProperty(i.prototype,"isMerging",{get:function(){return this.merging},set:function(e){this.merging=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"trailer",{get:function(){return null==this.internalTrailer&&(this.internalTrailer=new J),this.internalTrailer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"document",{get:function(){return this.pdfDocument},set:function(e){this.pdfDocument=e,this.items=this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pdfObjects",{get:function(){return this.items},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollection",{get:function(){return this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"count",{get:function(){return this.objectCount},set:function(e){this.objectCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextObjNumber",{get:function(){return this.count=this.count+1,this.count},enumerable:!0,configurable:!0}),i.prototype.save=function(e,t){this.saveHead(e),this.mappedReferences=null,this.objects.clear(),this.markTrailerReferences(),this.saveObjects(e);var r=this.count,n=e.position;this.registerObject(0,new bt(0,-1),!0),e.write(m.xref),e.write(m.newLine),this.saveSections(e),this.saveTrailer(e,this.count,0),this.saveTheEndess(e,n),this.count=r;for(var o=0;o<this.objectCollection.count;++o)this.objectCollection.items(o).object.isSaving=!1;if(void 0===t)return e.stream.buffer;e.stream.save(t)},i.prototype.saveTheEndess=function(e,t){e.write(m.newLine+m.startxref+m.newLine),e.write(t.toString()+m.newLine),e.write(m.eof+m.newLine)},i.prototype.saveTrailer=function(e,t,r){e.write(m.trailer+m.newLine);var n=this.trailer;n.items.setValue(this.dictionaryProperties.size,new B(this.objectCount+1)),(n=new F(n)).setEncrypt(!1),n.save(e)},i.prototype.saveSections=function(e){var t=0,r=0;do{r=this.prepareSubsection(t),this.saveSubsection(e,t,r),t+=r}while(0!==r)},i.prototype.saveSubsection=function(e,t,r){if(!(r<=0||t>=this.count)){e.write(t+" "+(r+1)+m.newLine);for(var n=t;n<=t+r;++n){var o,s=this.objects.getValue(n);o=s.type===De.Free?this.getItem(s.offset,65535,!0):this.getItem(s.offset,s.generation,!1),e.write(o)}}},i.prototype.getItem=function(e,t,r){var n="",s=10-e.toString().length;t<=0&&(t=0);for(var o=5-t.toString().length<=0?0:5-t.toString().length,a=0;a<s;a++)n+="0";for(n=n+e.toString()+" ",a=0;a<o;a++)n+="0";return(n=n+t.toString()+" ")+(r?m.f:m.n)+m.newLine},i.prototype.prepareSubsection=function(e){for(var r,t=0,n=this.count,s=0;s<this.document.pdfObjects.count;s++)this.document.pdfObjects.items(s).reference.toString().split(" ");if(e>=n)return t;for(e=r=e;r<n;++r)++t;return t},i.prototype.markTrailerReferences=function(){this.trailer.items.keys(),this.trailer.items.values()},i.prototype.saveHead=function(e){var t=this.generateFileVersion(e.document);e.write("%PDF-"+t),e.write(m.newLine)},i.prototype.generateFileVersion=function(e){return"1."+4..toString()},i.prototype.getReference=function(e,t){return void 0===t?this.getReference(e,!1):this.getSubReference(e,t)},i.prototype.getSubReference=function(e,t){var n,s=null;if(this.items.count>0&&e.objectCollectionIndex>0&&this.items.count>e.objectCollectionIndex-1){var o=this.document.pdfObjects.getReference(e,n);s=o.reference,n=o.wasNew}if(n=null==s&&e.status!==Ae.Registered,null==s){s=new bt(this.nextObjNumber,0);var h=void 0;n?(this.document.pdfObjects.add(e),this.document.pdfObjects.trySetReference(e,s,h),this.document.pdfObjects.mainObjectCollection.setValue(this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1].reference.objNumber,this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1]),e.position=-1):this.document.pdfObjects.trySetReference(e,s,h),e.objectCollectionIndex=s.objNumber,e.status=Ae.None,!0}return s},i.prototype.saveObjects=function(e){for(var t=this.objectCollection,r=0;r<t.count;++r){var s=t.items(r).object;s.isSaving=!0,this.saveIndirectObject(s,e)}},i.prototype.saveIndirectObject=function(e,t){var r=this.getReference(e);e instanceof It&&this.trailer.items.setValue(this.dictionaryProperties.root,r),this.pdfDocument.currentSavingObj=r,e.getArchive(),this.registerObject(t.position,r),this.doSaveObject(e,r,t)},i.prototype.doSaveObject=function(e,t,r){r.write(t.objNumber.toString()),r.write(m.whiteSpace),r.write(t.genNumber.toString()),r.write(m.whiteSpace),r.write(m.obj),r.write(m.newLine),e.save(r),r.write(m.endObj),r.write(m.newLine)},i.prototype.registerObject=function(e,t,r){"boolean"==typeof r?(this.objects.setValue(t.objNumber,new _t(e,t,r)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,t.genNumber)):void 0===r&&(this.objects.setValue(t.objNumber,new _t(e,t)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,t.genNumber))},i.dereference=function(e){return null!=e&&(e=e.object),e},i}(),_t=function(){function i(e,t,r){this.offsetNumber=e;var s=t;this.generation=s.genNumber,this.object=s.objNumber,this.type=void 0===r?De.Normal:De.Free}return Object.defineProperty(i.prototype,"objectNumber",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offset",{get:function(){return this.offsetNumber},enumerable:!0,configurable:!0}),i}(),$i=function(){function i(){}return i.letter=new S(612,792),i.note=new S(540,720),i.legal=new S(612,1008),i.a0=new S(2380,3368),i.a1=new S(1684,2380),i.a2=new S(1190,1684),i.a3=new S(842,1190),i.a4=new S(595,842),i.a5=new S(421,595),i.a6=new S(297,421),i.a7=new S(210,297),i.a8=new S(148,210),i.a9=new S(105,148),i.a10=new S(74,105),i.b0=new S(2836,4008),i.b1=new S(2004,2836),i.b2=new S(1418,2004),i.b3=new S(1002,1418),i.b4=new S(709,1002),i.b5=new S(501,709),i.archE=new S(2592,3456),i.archD=new S(1728,2592),i.archC=new S(1296,1728),i.archB=new S(864,1296),i.archA=new S(648,864),i.flsa=new S(612,936),i.halfLetter=new S(396,612),i.letter11x17=new S(792,1224),i.ledger=new S(1224,792),i}(),Ce=(()=>(function(i){i[i.Portrait=0]="Portrait",i[i.Landscape=1]="Landscape"}(Ce||(Ce={})),Ce))(),He=(()=>(function(i){i[i.RotateAngle0=0]="RotateAngle0",i[i.RotateAngle90=1]="RotateAngle90",i[i.RotateAngle180=2]="RotateAngle180",i[i.RotateAngle270=3]="RotateAngle270"}(He||(He={})),He))(),ue=(()=>(function(i){i[i.None=0]="None",i[i.Numeric=1]="Numeric",i[i.LowerLatin=2]="LowerLatin",i[i.LowerRoman=3]="LowerRoman",i[i.UpperLatin=4]="UpperLatin",i[i.UpperRoman=5]="UpperRoman"}(ue||(ue={})),ue))(),I=(()=>(function(i){i[i.None=0]="None",i[i.Bottom=1]="Bottom",i[i.Top=2]="Top",i[i.Left=3]="Left",i[i.Right=4]="Right",i[i.Fill=5]="Fill"}(I||(I={})),I))(),L=(()=>(function(i){i[i.None=0]="None",i[i.TopLeft=1]="TopLeft",i[i.TopCenter=2]="TopCenter",i[i.TopRight=3]="TopRight",i[i.MiddleLeft=4]="MiddleLeft",i[i.MiddleCenter=5]="MiddleCenter",i[i.MiddleRight=6]="MiddleRight",i[i.BottomLeft=7]="BottomLeft",i[i.BottomCenter=8]="BottomCenter",i[i.BottomRight=9]="BottomRight"}(L||(L={})),L))(),k=(()=>(function(i){i[i.None=0]="None",i[i.Top=1]="Top",i[i.Bottom=2]="Bottom",i[i.Left=3]="Left",i[i.Right=4]="Right"}(k||(k={})),k))(),Xi=function(){function i(){this.pdfMargin=40,this.setMargins(this.pdfMargin)}return Object.defineProperty(i.prototype,"left",{get:function(){return this.leftMargin},set:function(e){this.leftMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.topMargin},set:function(e){this.topMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.rightMargin},set:function(e){this.rightMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.bottomMargin},set:function(e){this.bottomMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"all",{set:function(e){this.setMargins(e)},enumerable:!0,configurable:!0}),i.prototype.setMargins=function(e,t,r,n){void 0===t?this.leftMargin=this.topMargin=this.rightMargin=this.bottomMargin=e:void 0===r?(this.leftMargin=this.rightMargin=e,this.bottomMargin=this.topMargin=t):(this.leftMargin=e,this.topMargin=t,this.rightMargin=r,this.bottomMargin=n)},i.prototype.clone=function(){return this},i}(),zt=function(){function i(e){this.pageMargins=new Xi,this.pageSize=$i.a4,this.rotateAngle=He.RotateAngle0,this.pageOrientation=Ce.Portrait,this.pageOrigin=new b(0,0),this.isRotation=!1,"number"==typeof e&&this.pageMargins.setMargins(e)}return Object.defineProperty(i.prototype,"size",{get:function(){return this.pageSize},set:function(e){this.setSize(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(e){this.pageOrientation!==e&&(this.pageOrientation=e,this.updateSize(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"margins",{get:function(){return this.pageMargins},set:function(e){this.pageMargins=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.pageSize.width},set:function(e){this.pageSize.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.pageSize.height},set:function(e){this.pageSize.height=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"origin",{get:function(){return this.pageOrigin},set:function(e){this.pageOrigin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotate",{get:function(){return this.rotateAngle},set:function(e){this.rotateAngle=e,this.isRotation=!0},enumerable:!0,configurable:!0}),i.prototype.updateSize=function(e){var t=Math.min(this.pageSize.width,this.pageSize.height),r=Math.max(this.pageSize.width,this.pageSize.height);switch(e){case Ce.Portrait:this.pageSize=new S(t,r);break;case Ce.Landscape:this.pageSize=new S(r,t)}},i.prototype.clone=function(){return this.pageMargins=this.pageMargins.clone(),this},i.prototype.getActualSize=function(){return new S(this.width-(this.margins.left+this.margins.right),this.height-(this.margins.top+this.margins.bottom))},i.prototype.setSize=function(e){var t=Math.min(e.width,e.height),r=Math.max(e.width,e.height);this.pageSize=this.orientation===Ce.Portrait?new S(t,r):new S(r,t)},i}(),Wt=function(){function i(e){if(null==e)throw new Error("ArgumentNullException:stream");this.stream=e}return i.prototype.clear=function(){this.stream.clearStream()},i.prototype.setGraphicsState=function(e){e instanceof O?(this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.setGraphicsState)):(this.stream.write(m.slash),this.stream.write(e),this.stream.write(m.whiteSpace),this.writeOperator(m.setGraphicsState))},i.prototype.executeObject=function(e){this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.paintXObject),this.stream.write(m.newLine)},i.prototype.closePath=function(){this.writeOperator(m.closePath)},i.prototype.clipPath=function(e){this.stream.write(m.clipPath),e&&this.stream.write(m.evenOdd),this.stream.write(m.whiteSpace),this.stream.write(m.endPath),this.stream.write(m.newLine)},i.prototype.closeFillStrokePath=function(e){this.stream.write(m.closeFillStrokePath),e?(this.stream.write(m.evenOdd),this.stream.write(m.newLine)):this.stream.write(m.newLine)},i.prototype.fillStrokePath=function(e){this.stream.write(m.fillStroke),e?(this.stream.write(m.evenOdd),this.stream.write(m.newLine)):this.stream.write(m.newLine)},i.prototype.fillPath=function(e){this.stream.write(m.fill),e?(this.stream.write(m.evenOdd),this.stream.write(m.newLine)):this.stream.write(m.newLine)},i.prototype.endPath=function(){this.writeOperator(m.n)},i.prototype.closeFillPath=function(e){this.writeOperator(m.closePath),this.stream.write(m.fill),e?(this.stream.write(m.evenOdd),this.stream.write(m.newLine)):this.stream.write(m.newLine)},i.prototype.closeStrokePath=function(){this.writeOperator(m.closeStrokePath)},i.prototype.setTextScaling=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.writeOperator(m.setTextScaling)},i.prototype.strokePath=function(){this.writeOperator(m.stroke)},i.prototype.restoreGraphicsState=function(){this.writeOperator(m.restoreState)},i.prototype.saveGraphicsState=function(){this.writeOperator(m.saveState)},i.prototype.startNextLine=function(e,t){void 0===e?this.writeOperator(m.goToNextLine):e instanceof b?(this.writePoint(e),this.writeOperator(m.setCoords)):(this.writePoint(e,t),this.writeOperator(m.setCoords))},i.prototype.showText=function(e){this.checkTextParam(e),this.writeText(e),this.writeOperator(m.setText)},i.prototype.setLeading=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.writeOperator(m.setTextLeading)},i.prototype.beginPath=function(e,t){this.writePoint(e,t),this.writeOperator(m.beginPath)},i.prototype.beginText=function(){this.writeOperator(m.beginText)},i.prototype.endText=function(){this.writeOperator(m.endText)},i.prototype.appendRectangle=function(e,t,r,n){e instanceof w?this.appendRectangle(e.x,e.y,e.width,e.height):(this.writePoint(e,t),this.writePoint(r,n),this.writeOperator(m.appendRectangle))},i.prototype.appendLineSegment=function(e,t){e instanceof b?this.appendLineSegment(e.x,e.y):(this.writePoint(e,t),this.writeOperator(m.appendLineSegment))},i.prototype.setTextRenderingMode=function(e){this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.setRenderingMode)},i.prototype.setCharacterSpacing=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.stream.write(m.setCharacterSpace),this.stream.write(m.newLine)},i.prototype.setWordSpacing=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.writeOperator(m.setWordSpace)},i.prototype.showNextLineText=function(e,t){e instanceof U?(this.checkTextParam(e),this.writeText(e),this.writeOperator(m.setTextOnNewLine)):(this.checkTextParam(e),this.writeText(e,t),this.writeOperator(m.setTextOnNewLine))},i.prototype.setColorSpace=function(e,t){if(e instanceof O&&"boolean"==typeof t){var s=(n=t)?m.selectcolorspaceforstroking:m.selectcolorspacefornonstroking;this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.stream.write(s),this.stream.write(m.newLine)}else{var n=t;this.setColorSpace(new O(e),n)}},i.prototype.modifyCtm=function(e){if(null==e)throw new Error("ArgumentNullException:matrix");this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.modifyCtm)},i.prototype.setFont=function(e,t,r){if("string"==typeof t)this.setFont(e,new O(t),r);else{if(null==e)throw new Error("ArgumentNullException:font");this.stream.write(t.toString()),this.stream.write(m.whiteSpace),this.stream.write(B.floatToString(r)),this.stream.write(m.whiteSpace),this.writeOperator(m.setFont)}},i.prototype.writeOperator=function(e){this.stream.write(e),this.stream.write(m.newLine)},i.prototype.checkTextParam=function(e){if(null==e)throw new Error("ArgumentNullException:text");if("string"==typeof e&&""===e)throw new Error("ArgumentException:The text can not be an empty string, text")},i.prototype.writeText=function(e,t){if(e instanceof U&&void 0===t)this.stream.write(e.pdfEncode());else{var r=void 0,n=void 0;t?(r=U.hexStringMark[0],n=U.hexStringMark[1]):(r=U.stringMark[0],n=U.stringMark[1]),this.stream.write(r),this.stream.write(e),this.stream.write(n)}},i.prototype.writePoint=function(e,t){e instanceof b&&void 0===t?this.writePoint(e.x,e.y):(this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),t=this.updateY(t),this.stream.write(B.floatToString(t)),this.stream.write(m.whiteSpace))},i.prototype.updateY=function(e){return-e},i.prototype.write=function(e){var t="";t+=e,this.writeOperator(t+=m.newLine)},i.prototype.writeComment=function(e){if(!(null!=e&&e.length>0))throw new Error("Invalid comment");var t="";t+=m.comment,t+=m.whiteSpace,this.writeOperator(t+=e)},i.prototype.setColorAndSpace=function(e,t,r){e.isEmpty||(this.stream.write(e.toString(t,r)),this.stream.write(m.newLine))},i.prototype.setLineDashPattern=function(e,t){this.setLineDashPatternHelper(e,t)},i.prototype.setLineDashPatternHelper=function(e,t){var r="[";if(e.length>1)for(var n=0;n<e.length;n++)r+=n===e.length-1?e[n].toString():e[n].toString()+" ";r+="] ",r+=t.toString(),this.stream.write(r+=" "+m.setDashPattern),this.stream.write(m.newLine)},i.prototype.setMiterLimit=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.writeOperator(m.setMiterLimit)},i.prototype.setLineWidth=function(e){this.stream.write(B.floatToString(e)),this.stream.write(m.whiteSpace),this.writeOperator(m.setLineWidth)},i.prototype.setLineCap=function(e){this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.setLineCapStyle)},i.prototype.setLineJoin=function(e){this.stream.write(e.toString()),this.stream.write(m.whiteSpace),this.writeOperator(m.setLineJoinStyle)},Object.defineProperty(i.prototype,"position",{get:function(){return this.stream.position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){var e=0;if(0!==this.stream.data.length&&-1!==this.stream.data.length)for(var t=0;t<this.stream.data.length;t++)e+=this.stream.data[t].length;return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"document",{get:function(){return null},enumerable:!0,configurable:!0}),i.prototype.appendBezierSegment=function(e,t,r,n,s,o){e instanceof b&&t instanceof b&&r instanceof b?(this.writePoint(e.x,e.y),this.writePoint(t.x,t.y),this.writePoint(r.x,r.y)):(this.writePoint(e,t),this.writePoint(r,n),this.writePoint(s,o)),this.writeOperator(m.appendbeziercurve)},i.prototype.setColourWithPattern=function(e,t,r){if(null!=e){var n=e.length,s=0;for(s=0;s<n;++s)this.stream.write(e[s].toString()),this.stream.write(m.whiteSpace)}null!=t&&(this.stream.write(t.toString()),this.stream.write(m.whiteSpace)),this.writeOperator(r?m.setColorAndPatternStroking:m.setColorAndPattern)},i}(),Y=function(){function i(e,t){this.pdfColor=new g(0,0,0),this.dashOffsetValue=0,this.penDashPattern=[0],this.pdfDashStyle=W.Solid,this.pdfLineCap=0,this.pdfLineJoin=0,this.penWidth=1,this.internalMiterLimit=0,this.colorSpace=x.Rgb,e instanceof oe?this.setBrush(e):e instanceof g&&(this.color=e),"number"==typeof t&&(this.width=t)}return Object.defineProperty(i.prototype,"color",{get:function(){return this.pdfColor},set:function(e){this.pdfColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dashOffset",{get:function(){return void 0===this.dashOffsetValue||null==this.dashOffsetValue?0:this.dashOffsetValue},set:function(e){this.dashOffsetValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dashPattern",{get:function(){return this.penDashPattern},set:function(e){this.penDashPattern=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dashStyle",{get:function(){return this.pdfDashStyle},set:function(e){if(this.pdfDashStyle!==e)switch(this.pdfDashStyle=e,this.pdfDashStyle){case W.Custom:break;case W.Dash:this.penDashPattern=[3,1];break;case W.Dot:this.penDashPattern=[1,1];break;case W.DashDot:this.penDashPattern=[3,1,1,1];break;case W.DashDotDot:this.penDashPattern=[3,1,1,1,1,1];break;case W.Solid:break;default:this.pdfDashStyle=W.Solid,this.penDashPattern=[0]}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineCap",{get:function(){return this.pdfLineCap},set:function(e){this.pdfLineCap=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineJoin",{get:function(){return this.pdfLineJoin},set:function(e){this.pdfLineJoin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"miterLimit",{get:function(){return this.internalMiterLimit},set:function(e){this.internalMiterLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.penWidth},set:function(e){this.penWidth=e},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return this},i.prototype.setBrush=function(e){var t=e;null!=t&&t instanceof pe&&(this.color=t.color,this.pdfBrush=t),this.color=t.color,this.pdfBrush=t},i.prototype.monitorChanges=function(e,t,r,n,s,o){this.dashControl(e,!0,t),t.setLineWidth(this.width),t.setLineJoin(this.lineJoin),t.setLineCap(this.lineCap);var h=this.miterLimit;return h>0&&t.setMiterLimit(h),t.setColorAndSpace(this.color,s,!0),!0},i.prototype.dashControl=function(e,t,r){var n=this.width,s=this.getPattern();return r.setLineDashPattern(s,this.dashOffset*n),!0},i.prototype.getPattern=function(){for(var e=this.dashPattern,t=0;t<e.length;++t)e[t]*=this.width;return e},i}(),Oe=function(){function i(e){this.radDegFactor=180/Math.PI,this.transformationMatrix=new Ht(1,0,0,void 0===e?1:-1,0,0)}return Object.defineProperty(i.prototype,"matrix",{get:function(){return this.transformationMatrix},set:function(e){this.transformationMatrix=e},enumerable:!0,configurable:!0}),i.prototype.translate=function(e,t){this.transformationMatrix.translate(e,t)},i.prototype.scale=function(e,t){this.transformationMatrix.elements[0]=e,this.transformationMatrix.elements[3]=t},i.prototype.rotate=function(e){e=e*Math.PI/180,this.transformationMatrix.elements[0]=Math.cos(e),this.transformationMatrix.elements[1]=Math.sin(e),this.transformationMatrix.elements[2]=-Math.sin(e),this.transformationMatrix.elements[3]=Math.cos(e)},i.prototype.toString=function(){for(var e="",r=0,n=this.transformationMatrix.elements.length;r<n;r++)e+=B.floatToString(this.transformationMatrix.elements[r]),e+=" ";return e},i.prototype.multiply=function(e){this.transformationMatrix.multiply(e.matrix)},i.degreesToRadians=function(e){return this.degRadFactor*e},i.prototype.radiansToDegrees=function(e){return this.radDegFactor*e},i.prototype.clone=function(){return this},i.degRadFactor=Math.PI/180,i}(),Ht=function(){function i(e,t,r,n,s,o){void 0===e?this.metrixElements=[]:"number"==typeof e?(this.metrixElements=[],this.metrixElements.push(e),this.metrixElements.push(t),this.metrixElements.push(r),this.metrixElements.push(n),this.metrixElements.push(s),this.metrixElements.push(o)):this.metrixElements=e}return Object.defineProperty(i.prototype,"elements",{get:function(){return this.metrixElements},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offsetX",{get:function(){return this.metrixElements[4]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offsetY",{get:function(){return this.metrixElements[5]},enumerable:!0,configurable:!0}),i.prototype.translate=function(e,t){this.metrixElements[4]=e,this.metrixElements[5]=t},i.prototype.transform=function(e){var t=e.x,r=e.y;return new b(t*this.elements[0]+r*this.elements[2]+this.offsetX,t*this.elements[1]+r*this.elements[3]+this.offsetY)},i.prototype.multiply=function(e){var t=[];t.push(this.elements[0]*e.elements[0]+this.elements[1]*e.elements[2]),t[1]=this.elements[0]*e.elements[1]+this.elements[1]*e.elements[3],t[2]=this.elements[2]*e.elements[0]+this.elements[3]*e.elements[2],t[3]=this.elements[2]*e.elements[1]+this.elements[3]*e.elements[3],t[4]=this.offsetX*e.elements[0]+this.offsetY*e.elements[2]+e.offsetX,t[5]=this.offsetX*e.elements[1]+this.offsetY*e.elements[3]+e.offsetY;for(var r=0;r<t.length;r++)this.elements[r]=t[r]},i.prototype.dispose=function(){this.metrixElements=null},i.prototype.clone=function(){return new i(this.metrixElements)},i}(),Zi=function(){return function(){this.pdf="PDF",this.text="Text",this.imageB="ImageB",this.imageC="ImageC",this.imageI="ImageI"}}(),Ue=function(){function i(){this.mKeys=[],this.mValues=[]}return i.prototype.size=function(){return this.mKeys.length},i.prototype.add=function(e,t){if(null==e||null==t)throw new ReferenceError("Provided key or value is not valid.");if(this.mKeys.indexOf(e)<0)return this.mKeys.push(e),this.mValues.push(t),1;throw new RangeError("An item with the same key has already been added.")},i.prototype.keys=function(){return this.mKeys},i.prototype.values=function(){return this.mValues},i.prototype.getValue=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");var t=this.mKeys.indexOf(e);if(t<0)throw new RangeError("No item with the specified key has been added.");return this.mValues[t]},i.prototype.setValue=function(e,t){if(null==e)throw new ReferenceError("Provided key is not valid.");var r=this.mKeys.indexOf(e);r<0?(this.mKeys.push(e),this.mValues.push(t)):this.mValues[r]=t},i.prototype.remove=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");var t=this.mKeys.indexOf(e);if(t<0)throw new RangeError("No item with the specified key has been added.");return this.mKeys.splice(t,1),this.mValues.splice(t,1),!0},i.prototype.containsKey=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");return!(this.mKeys.indexOf(e)<0)},i.prototype.clear=function(){this.mKeys=[],this.mValues=[]},i}(),wt=function(){function i(e,t,r){this.dictionary=new F,this.dictionaryProperties=new M,this.dictionary.items.setValue(this.dictionaryProperties.CA,new B(e)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new B(t)),this.dictionary.items.setValue(this.dictionaryProperties.BM,new O(r.toString()))}return Object.defineProperty(i.prototype,"element",{get:function(){return this.dictionary},enumerable:!0,configurable:!0}),i}(),Qi=function(){function i(){this.automaticFieldsInformation=[]}return Object.defineProperty(i.prototype,"automaticFields",{get:function(){return this.automaticFieldsInformation},enumerable:!0,configurable:!0}),i.prototype.add=function(e){return this.automaticFields.push(e)},i}(),Ki=function(){function i(){}return i.prototype.drawHelper=function(e,t,r){var n=0!==t||0!==r,s=null;n&&(s=e.save(),e.translateTransform(t,r)),this.drawInternal(e),n&&e.restore(s)},i}(),er=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),St=function(i){function e(){var t=i.call(this)||this;return t.internalBounds=new w(0,0,0,0),t.internalTemplateSize=new S(0,0),t}return er(e,i),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.internalBounds},set:function(t){this.internalBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return new S(this.bounds.width,this.bounds.height)},set:function(t){this.bounds.width=t.width,this.bounds.height=t.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"location",{get:function(){return new b(this.bounds.x,this.bounds.y)},set:function(t){this.bounds.x=t.x,this.bounds.y=t.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this.internalFont},set:function(t){this.internalFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"brush",{get:function(){return this.internalBrush},set:function(t){this.internalBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pen",{get:function(){return this.internalPen},set:function(t){this.internalPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.internalStringFormat},set:function(t){this.internalStringFormat=t},enumerable:!0,configurable:!0}),e.prototype.performDrawHelper=function(t,r,n,s){if(0===this.bounds.height||0===this.bounds.width){var o=this.getValue(t);this.internalTemplateSize=this.getFont().measureString(o,this.size,this.stringFormat)}},e.prototype.draw=function(t,r,n){if(void 0===r){var s=new b(0,0);this.draw(t,s)}else if(r instanceof b)this.draw(t,r.x,r.y);else{this.drawHelper(t,r,n);var o=new Ut(this,new b(r,n));t.automaticFields.add(o)}},e.prototype.getSize=function(){return 0===this.bounds.height||0===this.bounds.width?this.internalTemplateSize:this.size},e.prototype.drawInternal=function(t){},e.prototype.getBrush=function(){return void 0===this.internalBrush||null==this.internalBrush?new pe(new g(0,0,0)):this.internalBrush},e.prototype.getFont=function(){return void 0===this.internalFont||null==this.internalFont?Ve.defaultFont:this.internalFont},e.prototype.getPageFromGraphics=function(t){return null!=t.page?t.page:t.currentPage},e}(Ki),Ut=function(){function i(e,t,r,n){this.pageNumberFieldLocation=new b,this.pageNumberField=null,this.scaleX=1,this.scaleY=1,void 0===t&&e instanceof i?(this.pageNumberField=e.field,this.pageNumberFieldLocation=e.location,this.scaleX=e.scalingX,this.scaleY=e.scalingY):void 0===r&&t instanceof b&&e instanceof St?(this.pageNumberField=e,this.pageNumberFieldLocation=t):(this.pageNumberField=e,this.pageNumberFieldLocation=t,this.scaleX=r,this.scaleY=n)}return Object.defineProperty(i.prototype,"location",{get:function(){return this.pageNumberFieldLocation},set:function(e){this.pageNumberFieldLocation=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"field",{get:function(){return this.pageNumberField},set:function(e){this.pageNumberField=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scalingX",{get:function(){return this.scaleX},set:function(e){this.scaleX=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scalingY",{get:function(){return this.scaleY},set:function(e){this.scaleY=e},enumerable:!0,configurable:!0}),i}(),qe=function(){function i(e){this.mPosition=0,this.buffer=new Uint8Array(e),this.dataView=new DataView(this.buffer.buffer)}return Object.defineProperty(i.prototype,"position",{get:function(){return this.mPosition},set:function(e){this.mPosition=e},enumerable:!0,configurable:!0}),i.prototype.read=function(e,t,r){for(var n=t;n<r;n++)e.buffer[n]=this.readByte(this.position),this.position++},i.prototype.getBuffer=function(e){return this.buffer[e]},i.prototype.writeFromBase64String=function(e){var t=this.encodedString(e);this.buffer=t},i.prototype.encodedString=function(e){var n,s,o,a,h,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,f=0,d=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;e.charAt(e.length-1)===t.charAt(64)&&d--;for(var p=new Uint8Array(0|d);c<e.length;)o=t.indexOf(e.charAt(c++)),n=(15&(a=t.indexOf(e.charAt(c++))))<<4|(h=t.indexOf(e.charAt(c++)))>>2,s=(3&h)<<6|t.indexOf(e.charAt(c++)),p[f++]=o<<2|a>>4,p[f++]=n,p[f++]=s;return p},i.prototype.readByte=function(e){return this.buffer[e]},Object.defineProperty(i.prototype,"internalBuffer",{get:function(){return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"count",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0}),i.prototype.readNextTwoBytes=function(e){var t=e.readByte(this.position);return this.position++,t<<=8,t|=e.readByte(this.position),this.position++,t},i}(),je=function(){function i(e){this.currentPosition=-1,this.value=e}return Object.defineProperty(i.prototype,"status",{get:function(){return this.objectStatus},set:function(e){this.objectStatus=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSaving",{get:function(){return this.saving},set:function(e){this.saving=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectCollectionIndex",{get:function(){return this.index},set:function(e){this.index=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.currentPosition},set:function(e){this.currentPosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),i.prototype.save=function(e){e.write(this.boolToStr(this.value))},i.prototype.clone=function(e){return new i(this.value)},i.prototype.boolToStr=function(e){return e?"true":"false"},i}(),Ee=(()=>(function(i){i[i.Unknown=0]="Unknown",i[i.Bmp=1]="Bmp",i[i.Emf=2]="Emf",i[i.Gif=3]="Gif",i[i.Jpeg=4]="Jpeg",i[i.Png=5]="Png",i[i.Wmf=6]="Wmf",i[i.Icon=7]="Icon"}(Ee||(Ee={})),Ee))(),tr=function(){function i(e){this.sof1Marker=193,this.sof2Marker=194,this.sof3Marker=195,this.sof5Marker=197,this.sof6Marker=198,this.sof7Marker=199,this.sof9Marker=201,this.sof10Marker=202,this.sof11Marker=203,this.sof13Marker=205,this.sof14Marker=206,this.sof15Marker=207,this.mFormat=Ee.Unknown,this.mbitsPerComponent=8,this.dictionaryProperties=new M,this.mStream=e,this.initialize()}return Object.defineProperty(i.prototype,"height",{get:function(){return this.mHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.mWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bitsPerComponent",{get:function(){return this.mbitsPerComponent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.mImageData.count},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"imageData",{get:function(){return this.mImageData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"imageDataAsNumberArray",{get:function(){return this.mImageData.internalBuffer.buffer},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.mFormat===Ee.Unknown&&this.checkIfJpeg()&&(this.mFormat=Ee.Jpeg,this.parseJpegImage()),this.reset(),this.mImageData=new qe(this.mStream.count),this.mStream.read(this.mImageData,0,this.mImageData.count)},i.prototype.reset=function(){this.mStream.position=0},i.prototype.parseJpegImage=function(){this.reset();var e=new qe(this.mStream.count);this.mStream.read(e,0,e.count);for(var t=4,r=!1,n=256*e.getBuffer(t)+e.getBuffer(t+1);t<e.count;){if(!((t+=n)<e.count)){r=!0;break}if(192===e.getBuffer(t+1))return this.mHeight=256*e.getBuffer(t+5)+e.getBuffer(t+6),void(this.mWidth=256*e.getBuffer(t+7)+e.getBuffer(t+8));n=256*e.getBuffer(t+=2)+e.getBuffer(t+1)}r&&(this.mStream.position=0,this.skip(this.mStream,2),this.readExceededJPGImage(this.mStream))},Object.defineProperty(i.prototype,"format",{get:function(){return this.mFormat},enumerable:!0,configurable:!0}),i.prototype.checkIfJpeg=function(){this.reset();for(var e=0;e<i.mJpegHeader.length;e++){if(i.mJpegHeader[e]!==this.mStream.readByte(e))return!1;this.mStream.position++}return!0},i.prototype.getImageDictionary=function(){if(this.mFormat===Ee.Jpeg){this.imageStream=new J,this.imageStream.isImage=!0;for(var t="",r="",n=0;n<this.imageDataAsNumberArray.byteLength;n++)t+=String.fromCharCode(null,this.mStream.readByte(n));for(n=0;n<t.length;n++)n%2!=0&&(r+=t[n]);return this.imageStream.data=[r],this.imageStream.compress=!1,this.imageStream.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.xObject)),this.imageStream.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.image)),this.imageStream.items.setValue(this.dictionaryProperties.width,new B(this.width)),this.imageStream.items.setValue(this.dictionaryProperties.height,new B(this.height)),this.imageStream.items.setValue(this.dictionaryProperties.bitsPerComponent,new B(this.bitsPerComponent)),this.imageStream.items.setValue(this.dictionaryProperties.filter,new O(this.dictionaryProperties.dctdecode)),this.imageStream.items.setValue(this.dictionaryProperties.colorSpace,new O(this.getColorSpace())),this.imageStream.items.setValue(this.dictionaryProperties.decodeParms,this.getDecodeParams()),this.imageStream}return this.imageStream},i.prototype.getColorSpace=function(){return this.dictionaryProperties.deviceRgb},i.prototype.getDecodeParams=function(){var e=new F;return e.items.setValue(this.dictionaryProperties.columns,new B(this.width)),e.items.setValue(this.dictionaryProperties.blackIs1,new je(!0)),e.items.setValue(this.dictionaryProperties.k,new B(-1)),e.items.setValue(this.dictionaryProperties.predictor,new B(15)),e.items.setValue(this.dictionaryProperties.bitsPerComponent,new B(this.bitsPerComponent)),e},i.prototype.readExceededJPGImage=function(e){this.mStream=e;for(var t=!0;t;)switch(this.getMarker(e)){case this.sof1Marker:case this.sof2Marker:case this.sof3Marker:case this.sof5Marker:case this.sof6Marker:case this.sof7Marker:case this.sof9Marker:case this.sof10Marker:case this.sof11Marker:case this.sof13Marker:case this.sof14Marker:case this.sof15Marker:e.position+=3,this.mHeight=this.mStream.readNextTwoBytes(e),this.mWidth=this.mStream.readNextTwoBytes(e),t=!1;break;default:this.skipStream(e)}},i.prototype.skip=function(e,t){this.mStream=e;var r=new qe(t);this.mStream.read(r,0,r.count)},i.prototype.getMarker=function(e){var t=32;for(t=e.readByte(this.mStream.position),e.position++;255!==t;)t=e.readByte(this.mStream.position),e.position++;do{t=e.readByte(this.mStream.position),e.position++}while(255===t);return t},i.prototype.skipStream=function(e){var t=this.mStream.readNextTwoBytes(e)-2;t>0&&(e.position+=t)},i.mPngHeader=[137,80,78,71,13,10,26,10],i.mJpegHeader=[255,216],i.GIF_HEADER="G,I,F,8",i.BMP_HEADER="B,M",i}(),ut=function(){function i(e){this.updateProportionsHelper(e)}return i.prototype.convertUnits=function(e,t,r){return this.convertFromPixels(this.convertToPixels(e,t),r)},i.prototype.convertToPixels=function(e,t){return e*this.proportions[t]},i.prototype.convertFromPixels=function(e,t){return e/this.proportions[t]},i.prototype.updateProportionsHelper=function(e){this.proportions=[e/2.54,e/6,1,e/72,e,e/300,e/25.4]},i.horizontalResolution=96,i.verticalResolution=96,i}(),Ye=function(){function i(){}return Object.defineProperty(i.prototype,"width",{get:function(){return this.imageWidth},set:function(e){this.imageWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.imageHeight},set:function(e){this.imageHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{set:function(e){this.width=e.width,this.height=e.height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"physicalDimension",{get:function(){return this.imagePhysicalDimension=this.getPointSize(this.width,this.height,this.horizontalResolution,this.verticalResolution),new S(this.width,this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.imageStream},enumerable:!0,configurable:!0}),i.prototype.getPointSize=function(e,t,r,n){if(void 0===r)return this.getPointSize(e,t,ut.horizontalResolution,ut.verticalResolution);var h=new ut(r),l=new ut(n),c=h.convertUnits(e,Fe.Pixel,Fe.Point),f=l.convertUnits(t,Fe.Pixel,Fe.Point);return new S(c,f)},i}(),ir=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Je=function(i){function e(t){var r=i.call(this)||this;return r.imageStatus=!0,r.dictionaryProperties=new M,r.loadImage(t),r}return ir(e,i),e.prototype.loadImage=function(t){this.initializeAsync(t)},e.prototype.initializeAsync=function(t){var r=new qe(t.length);r.writeFromBase64String(t),this.decoder=new tr(r),this.height=this.decoder.height,this.width=this.decoder.width,this.bitsPerComponent=this.decoder.bitsPerComponent},e.prototype.save=function(){this.imageStatus=!0,this.imageStream=this.decoder.getImageDictionary()},e}(Ye),qt=function(){function i(){}return Object.defineProperty(i.prototype,"empty",{get:function(){return this.offset===this.length&&this.length===this.checksum&&0===this.checksum},enumerable:!0,configurable:!0}),i}(),rr=function(){return function(){}}(),nr=function(){return function(){}}(),sr=function(){return function(){}}(),Yt=function(){function i(){}return Object.defineProperty(i.prototype,"isItalic",{get:function(){return 0!=(2&this.macStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isBold",{get:function(){return 0!=(1&this.macStyle)},enumerable:!0,configurable:!0}),i}(),or=function(){return function(){}}(),ar=function(){return function(){}}(),ur=function(){return function(){}}(),hr=function(){return function(){}}(),lr=function(){return function(){}}(),cr=function(){return function(){}}(),$e=function(){function i(){}return Object.defineProperty(i.prototype,"empty",{get:function(){return this.index===this.width&&this.width===this.charCode&&0===this.charCode},enumerable:!0,configurable:!0}),i.prototype.compareTo=function(e){return this.index-e.index},i}(),fr=function(){return function(){}}(),dr=function(){return function(){}}(),pr=function(){return function(){}}(),gr=function(){return function(){}}(),yr=function(){return function(){}}(),Jt=function(){function i(e){this.int32Size=4,this.int16Size=2,this.int64Size=8,this.bufferLength=e,this.buffer=[]}return Object.defineProperty(i.prototype,"data",{get:function(){if(this.buffer.length<this.bufferLength)for(var e=this.bufferLength-this.buffer.length,t=0;t<e;t++)this.buffer.push(0);return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return null==this.internalPosition&&(this.internalPosition=0),this.internalPosition},enumerable:!0,configurable:!0}),i.prototype.writeShort=function(e){this.flush([(65280&e)>>8,255&e])},i.prototype.writeInt=function(e){this.flush([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])},i.prototype.writeUInt=function(e){this.flush([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])},i.prototype.writeString=function(e){if(null==e)throw new Error("Argument Null Exception : value");for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r));this.flush(t)},i.prototype.writeBytes=function(e){this.flush(e)},i.prototype.flush=function(e){if(null===e)throw new Error("Argument Null Exception : buff");for(var t=this.position,r=0;r<e.length;r++)this.buffer[t]=e[r],t++;this.internalPosition+=e.length},i}(),mr=function(){function i(e){this.int32Size=4,this.isTtcFont=!1,this.isMacTtf=!1,this.metricsName="",this.isMacTTF=!1,this.missedGlyphs=0,this.tableNames=["cvt ","fpgm","glyf","head","hhea","hmtx","loca","maxp","prep"],this.entrySelectors=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4],this.fontData=e,this.initialize()}return Object.defineProperty(i.prototype,"macintosh",{get:function(){return null==this.macintoshDictionary&&(this.macintoshDictionary=new D),this.macintoshDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"microsoft",{get:function(){return null==this.microsoftDictionary&&(this.microsoftDictionary=new D),this.microsoftDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"macintoshGlyphs",{get:function(){return null==this.internalMacintoshGlyphs&&(this.internalMacintoshGlyphs=new D),this.internalMacintoshGlyphs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"microsoftGlyphs",{get:function(){return null==this.internalMicrosoftGlyphs&&(this.internalMicrosoftGlyphs=new D),this.internalMicrosoftGlyphs},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){void 0===this.metrics&&(this.metrics=new Yt),this.readFontDictionary();var e=this.readNameTable(),t=this.readHeadTable();this.initializeFontName(e),this.metrics.macStyle=t.macStyle},i.prototype.readFontDictionary=function(){this.offset=0,this.checkPreambula();var t=this.readInt16(this.offset);this.readInt16(this.offset),this.readInt16(this.offset),this.readInt16(this.offset),void 0===this.tableDirectory&&(this.tableDirectory=new D);for(var o=0;o<t;++o){var a=new qt,h=this.readString(this.int32Size);a.checksum=this.readInt32(this.offset),a.offset=this.readInt32(this.offset),a.length=this.readInt32(this.offset),this.tableDirectory.setValue(h,a)}this.lowestPosition=this.offset,this.isTtcFont||this.fixOffsets()},i.prototype.fixOffsets=function(){for(var e=Number.MAX_VALUE,t=this.tableDirectory.keys(),r=0;r<t.length;r++){var s=(n=this.tableDirectory.getValue(t[r])).offset;if(e>s&&(e=s)<=this.lowestPosition)break}var o=e-this.lowestPosition;if(0!==o){var a=new D;for(r=0;r<t.length;r++){var n;(n=this.tableDirectory.getValue(t[r])).offset-=o,a.setValue(t[r],n)}this.tableDirectory=a}},i.prototype.checkPreambula=function(){var e=this.readInt32(this.offset);if(this.isMacTtf=1953658213===e,65536!==e&&1953658213!==e&&1330926671!==e){if(this.isTtcFont=!0,this.offset=0,"ttcf"!==this.readString(4))throw new Error("Can not read TTF font data");if(this.offset+=4,this.readInt32(this.offset)<0)throw new Error("Can not read TTF font data");this.offset=this.readInt32(this.offset),e=this.readInt32(this.offset)}return e},i.prototype.readNameTable=function(){var e=this.getTable("name");this.offset=e.offset;var t=new rr;t.formatSelector=this.readUInt16(this.offset),t.recordsCount=this.readUInt16(this.offset),t.offset=this.readUInt16(this.offset),t.nameRecords=[];for(var n=this.offset,s=0;s<t.recordsCount;s++){this.offset=n;var o=new nr;o.platformID=this.readUInt16(this.offset),o.encodingID=this.readUInt16(this.offset),o.languageID=this.readUInt16(this.offset),o.nameID=this.readUInt16(this.offset),o.length=this.readUInt16(this.offset),o.offset=this.readUInt16(this.offset),this.offset=e.offset+t.offset+o.offset,o.name=this.readString(o.length,0===o.platformID||3===o.platformID),t.nameRecords[s]=o,n+=12}return t},i.prototype.readHeadTable=function(){var e=this.getTable("head");this.offset=e.offset;var t=new sr;return t.version=this.readFixed(this.offset),t.fontRevision=this.readFixed(this.offset),t.checkSumAdjustment=this.readUInt32(this.offset),t.magicNumber=this.readUInt32(this.offset),t.flags=this.readUInt16(this.offset),t.unitsPerEm=this.readUInt16(this.offset),t.created=this.readInt64(this.offset),t.modified=this.readInt64(this.offset),t.xMin=this.readInt16(this.offset),t.yMin=this.readInt16(this.offset),t.xMax=this.readInt16(this.offset),t.yMax=this.readInt16(this.offset),t.macStyle=this.readUInt16(this.offset),t.lowestReadableSize=this.readUInt16(this.offset),t.fontDirectionHint=this.readInt16(this.offset),t.indexToLocalFormat=this.readInt16(this.offset),t.glyphDataFormat=this.readInt16(this.offset),t},i.prototype.readHorizontalHeaderTable=function(){var e=this.getTable("hhea");this.offset=e.offset;var t=new or;return t.version=this.readFixed(this.offset),t.ascender=this.readInt16(this.offset),t.descender=this.readInt16(this.offset),t.lineGap=this.readInt16(this.offset),t.advanceWidthMax=this.readUInt16(this.offset),t.minLeftSideBearing=this.readInt16(this.offset),t.minRightSideBearing=this.readInt16(this.offset),t.xMaxExtent=this.readInt16(this.offset),t.caretSlopeRise=this.readInt16(this.offset),t.caretSlopeRun=this.readInt16(this.offset),this.offset+=10,t.metricDataFormat=this.readInt16(this.offset),t.numberOfHMetrics=this.readUInt16(this.offset),t},i.prototype.readOS2Table=function(){var e=this.getTable("OS/2");this.offset=e.offset;var t=new ar;return t.version=this.readUInt16(this.offset),t.xAvgCharWidth=this.readInt16(this.offset),t.usWeightClass=this.readUInt16(this.offset),t.usWidthClass=this.readUInt16(this.offset),t.fsType=this.readInt16(this.offset),t.ySubscriptXSize=this.readInt16(this.offset),t.ySubscriptYSize=this.readInt16(this.offset),t.ySubscriptXOffset=this.readInt16(this.offset),t.ySubscriptYOffset=this.readInt16(this.offset),t.ySuperscriptXSize=this.readInt16(this.offset),t.ySuperscriptYSize=this.readInt16(this.offset),t.ySuperscriptXOffset=this.readInt16(this.offset),t.ySuperscriptYOffset=this.readInt16(this.offset),t.yStrikeoutSize=this.readInt16(this.offset),t.yStrikeoutPosition=this.readInt16(this.offset),t.sFamilyClass=this.readInt16(this.offset),t.panose=this.readBytes(10),t.ulUnicodeRange1=this.readUInt32(this.offset),t.ulUnicodeRange2=this.readUInt32(this.offset),t.ulUnicodeRange3=this.readUInt32(this.offset),t.ulUnicodeRange4=this.readUInt32(this.offset),t.vendorIdentifier=this.readBytes(4),t.fsSelection=this.readUInt16(this.offset),t.usFirstCharIndex=this.readUInt16(this.offset),t.usLastCharIndex=this.readUInt16(this.offset),t.sTypoAscender=this.readInt16(this.offset),t.sTypoDescender=this.readInt16(this.offset),t.sTypoLineGap=this.readInt16(this.offset),t.usWinAscent=this.readUInt16(this.offset),t.usWinDescent=this.readUInt16(this.offset),t.ulCodePageRange1=this.readUInt32(this.offset),t.ulCodePageRange2=this.readUInt32(this.offset),t.version>1?(t.sxHeight=this.readInt16(this.offset),t.sCapHeight=this.readInt16(this.offset),t.usDefaultChar=this.readUInt16(this.offset),t.usBreakChar=this.readUInt16(this.offset),t.usMaxContext=this.readUInt16(this.offset)):(t.sxHeight=0,t.sCapHeight=0,t.usDefaultChar=0,t.usBreakChar=0,t.usMaxContext=0),t},i.prototype.readPostTable=function(){var e=this.getTable("post");this.offset=e.offset;var t=new ur;return t.formatType=this.readFixed(this.offset),t.italicAngle=this.readFixed(this.offset),t.underlinePosition=this.readInt16(this.offset),t.underlineThickness=this.readInt16(this.offset),t.isFixedPitch=this.readUInt32(this.offset),t.minType42=this.readUInt32(this.offset),t.maxType42=this.readUInt32(this.offset),t.minType1=this.readUInt32(this.offset),t.maxType1=this.readUInt32(this.offset),t},i.prototype.readWidthTable=function(e,t){var r=this.getTable("hmtx");this.offset=r.offset;for(var n=[],s=0;s<e;s++){var o=new hr;o.advanceWidth=this.readUInt16(this.offset),o.lsb=this.readInt16(this.offset),n.push(Math.floor(1e3*o.advanceWidth/t))}return n},i.prototype.readCmapTable=function(){var e=this.getTable("cmap");this.offset=e.offset;var t=new cr;t.version=this.readUInt16(this.offset),t.tablesCount=this.readUInt16(this.offset);for(var r=this.offset,n=[],s=0;s<t.tablesCount;s++){this.offset=r;var o=new lr;o.platformID=this.readUInt16(this.offset),o.encodingID=this.readUInt16(this.offset),o.offset=this.readUInt32(this.offset),r=this.offset,this.readCmapSubTable(o),n[s]=o}return n},i.prototype.readCmapSubTable=function(e){var t=this.getTable("cmap");this.offset=t.offset+e.offset;var r=this.readUInt16(this.offset),n=this.getCmapEncoding(e.platformID,e.encodingID);if(n!==$.Unknown)switch(r){case Ne.Apple:this.readAppleCmapTable(e,n);break;case Ne.Microsoft:this.readMicrosoftCmapTable(e,n);break;case Ne.Trimmed:this.readTrimmedCmapTable(e,n)}},i.prototype.readAppleCmapTable=function(e,t){var r=this.getTable("cmap");this.offset=r.offset+e.offset;var n=new dr;n.format=this.readUInt16(this.offset),n.length=this.readUInt16(this.offset),n.version=this.readUInt16(this.offset),null==this.maxMacIndex&&(this.maxMacIndex=0);for(var s=0;s<256;++s){var o=new $e;o.index=this.readByte(this.offset),o.width=this.getWidth(o.index),o.charCode=s,this.macintosh.setValue(s,o),this.addGlyph(o,t),this.maxMacIndex=Math.max(s,this.maxMacIndex)}},i.prototype.readMicrosoftCmapTable=function(e,t){var r=this.getTable("cmap");this.offset=r.offset+e.offset;var n=t===$.Unicode?this.microsoft:this.macintosh,s=new pr;s.format=this.readUInt16(this.offset),s.length=this.readUInt16(this.offset),s.version=this.readUInt16(this.offset),s.segCountX2=this.readUInt16(this.offset),s.searchRange=this.readUInt16(this.offset),s.entrySelector=this.readUInt16(this.offset),s.rangeShift=this.readUInt16(this.offset);var o=s.segCountX2/2;s.endCount=this.readUshortArray(o),s.reservedPad=this.readUInt16(this.offset),s.startCount=this.readUshortArray(o),s.idDelta=this.readUshortArray(o),s.idRangeOffset=this.readUshortArray(o),s.glyphID=this.readUshortArray(s.length/2-8-4*o);for(var h=0,l=0,c=0;c<o;c++)for(var f=s.startCount[c];f<=s.endCount[c]&&65535!==f;f++){if(0===s.idRangeOffset[c])h=f+s.idDelta[c]&65535;else{if((l=c+s.idRangeOffset[c]/2-o+f-s.startCount[c])>=s.glyphID.length)continue;h=s.glyphID[l]+s.idDelta[c]&65535}var d=new $e;d.index=h,d.width=this.getWidth(d.index);var p=t===$.Symbol&&61440==(65280&f)?255&f:f;d.charCode=p,n.setValue(p,d),this.addGlyph(d,t)}},i.prototype.readTrimmedCmapTable=function(e,t){var r=this.getTable("cmap");this.offset=r.offset+e.offset;var n=new gr;n.format=this.readUInt16(this.offset),n.length=this.readUInt16(this.offset),n.version=this.readUInt16(this.offset),n.firstCode=this.readUInt16(this.offset),n.entryCount=this.readUInt16(this.offset);for(var s=0;s<n.entryCount;++s){var o=new $e;o.index=this.readUInt16(this.offset),o.width=this.getWidth(o.index),o.charCode=s+n.firstCode,this.macintosh.setValue(s,o),this.addGlyph(o,t),this.maxMacIndex=Math.max(s,this.maxMacIndex)}},i.prototype.initializeFontName=function(e){for(var t=0;t<e.recordsCount;t++){var r=e.nameRecords[t];if(1===r.nameID?this.metrics.fontFamily=r.name:6===r.nameID&&(this.metrics.postScriptName=r.name),null!=this.metrics.fontFamily&&null!=this.metrics.postScriptName)break}},i.prototype.getTable=function(e){var r,t=new qt;return this.tableDirectory.containsKey(e)&&(r=this.tableDirectory.getValue(e)),null!=r&&(t=r),t},i.prototype.getWidth=function(e){return this.width[e=e<this.width.length?e:this.width.length-1]},i.prototype.getCmapEncoding=function(e,t){var r=$.Unknown;return e==Se.Microsoft&&t==We.Undefined?r=$.Symbol:e==Se.Microsoft&&t==We.Unicode?r=$.Unicode:e==Se.Macintosh&&t==at.Roman&&(r=$.Macintosh),r},i.prototype.addGlyph=function(e,t){var r=null;switch(t){case $.Unicode:r=this.microsoftGlyphs;break;case $.Macintosh:case $.Symbol:r=this.macintoshGlyphs}r.setValue(e.index,e)},i.prototype.initializeMetrics=function(e,t,r,n,s,o){this.initializeFontName(e);for(var a=!1,h=0;h<o.length;h++){var l=o[h];if(this.getCmapEncoding(l.platformID,l.encodingID)===$.Symbol){a=!0;break}}this.metrics.isSymbol=a,this.metrics.macStyle=t.macStyle,this.metrics.isFixedPitch=0!==s.isFixedPitch,this.metrics.italicAngle=s.italicAngle;var f=1e3/t.unitsPerEm;this.metrics.winAscent=n.sTypoAscender*f,this.metrics.macAscent=r.ascender*f,this.metrics.capHeight=0!==n.sCapHeight?n.sCapHeight:.7*t.unitsPerEm*f,this.metrics.winDescent=n.sTypoDescender*f,this.metrics.macDescent=r.descender*f,this.metrics.leading=(n.sTypoAscender-n.sTypoDescender+n.sTypoLineGap)*f,this.metrics.lineGap=Math.ceil(r.lineGap*f);var d=t.xMin*f,p=Math.ceil(this.metrics.macAscent+this.metrics.lineGap);this.metrics.fontBox=new st(d,p,t.xMax*f,this.metrics.macDescent),this.metrics.stemV=80,this.metrics.widthTable=this.updateWidth(),this.metrics.contains=this.tableDirectory.containsKey("CFF"),this.metrics.subScriptSizeFactor=t.unitsPerEm/n.ySubscriptYSize,this.metrics.superscriptSizeFactor=t.unitsPerEm/n.ySuperscriptYSize},i.prototype.updateWidth=function(){var t=[];if(this.metrics.isSymbol)for(var r=0;r<256;r++){var n=this.getGlyph(String.fromCharCode(r));t[r]=n.empty?0:n.width}else{var s=[],a=String.fromCharCode(32);for(r=0;r<256;r++){s[0]=r;var h=this.getString(s,0,s.length);(n=this.getGlyph(h.length>0?h[0]:"?")).empty?(n=this.getGlyph(a),t[r]=n.empty?0:n.width):t[r]=n.width}}return t},i.prototype.getDefaultGlyph=function(){return this.getGlyph(ee.whiteSpace)},i.prototype.getString=function(e,t,r){for(var n="",s=0;s<r;s++)n+=String.fromCharCode(e[s+t]);return n},i.prototype.readLocaTable=function(e){var t=this.getTable("loca");this.offset=t.offset;var r=new fr,n=null;if(e){var s=t.length/2;n=[];for(var o=0;o<s;o++)n[o]=2*this.readUInt16(this.offset)}else for(s=t.length/4,n=[],o=0;o<s;o++)n[o]=this.readUInt32(this.offset);return r.offsets=n,r},i.prototype.updateGlyphChars=function(e,t){e.containsKey(0)||e.setValue(0,0);for(var r=new D,n=e.keys(),s=0;s<n.length;s++)r.setValue(n[s],e.getValue(n[s]));for(s=0;s<n.length;s++)this.processCompositeGlyph(e,n[s],t)},i.prototype.processCompositeGlyph=function(e,t,r){if(t<r.offsets.length-1){var n=r.offsets[t];if(n!==r.offsets[t+1]){var s=this.getTable("glyf");this.offset=s.offset+n;var o=new yr;if(o.numberOfContours=this.readInt16(this.offset),o.xMin=this.readInt16(this.offset),o.yMin=this.readInt16(this.offset),o.xMax=this.readInt16(this.offset),o.yMax=this.readInt16(this.offset),o.numberOfContours<0)for(var a=0;;){var l=this.readUInt16(this.offset),c=this.readUInt16(this.offset);if(e.containsKey(c)||e.setValue(c,0),0==(l&Be.MoreComponents))break;a=0!=(l&Be.Arg1And2AreWords)?4:2,0!=(l&Be.WeHaveScale)?a+=2:0!=(l&Be.WeHaveAnXyScale)?a+=4:0!=(l&Be.WeHaveTwoByTwo)&&(a+=8),this.offset+=a}}}},i.prototype.generateGlyphTable=function(e,t,r,n){r=[];var s=e.keys();s.sort(function(P,V){return P-V});for(var o=0,a=0;a<s.length;a++){var h=s[a];t.offsets.length>0&&(o+=t.offsets[h+1]-t.offsets[h])}var l=this.align(o);for(n=[],a=0;a<l;a++)n.push(0);var c=0,f=0,d=this.getTable("glyf");for(a=0;a<t.offsets.length;a++)if(r.push(c),f<s.length&&s[f]===a){++f,r[a]=c;var p=t.offsets[a],v=t.offsets[a+1]-p;v>0&&(this.offset=d.offset+p,n=this.read(n,c,v).buffer,c+=v)}return{glyphTableSize:o,newLocaTable:r,newGlyphTable:n}},i.prototype.updateLocaTable=function(e,t,r){if(null===e)throw new Error("Argument Null Exception : newLocaTable");for(var n=t?2*e.length:4*e.length,s=this.align(n),o=new Jt(s),a=0;a<e.length;a++){var h=e[a];t?o.writeShort(h/=2):o.writeInt(h)}return{newLocaUpdated:o.data,newLocaSize:n}},i.prototype.align=function(e){return e+3&-4},i.prototype.getFontProgram=function(e,t,r,n){if(null===e)throw new Error("Argument Null Exception : newLocaTableOut");if(null===t)throw new Error("Argument Null Exception : newGlyphTable");var o=this.getFontProgramLength(e,t,0),h=o.numTables,l=new Jt(o.fontProgramLength);l.writeInt(65536),l.writeShort(h);var c=this.entrySelectors[h];return l.writeShort(16*(1<<(31&c))),l.writeShort(c),l.writeShort(16*(h-(1<<(31&c)))),this.writeCheckSums(l,h,e,t,r,n),this.writeGlyphs(l,e,t),l.data},i.prototype.getFontProgramLength=function(e,t,r){if(null===e)throw new Error("Argument Null Exception : newLocaTableOut");if(null===t)throw new Error("Argument Null Exception : newGlyphTable");r=2;for(var n=this.tableNames,s=0,o=0;o<n.length;o++){var a=n[o];if("glyf"!==a&&"loca"!==a){var h=this.getTable(a);h.empty||(++r,s+=this.align(h.length))}}return s+=e.length,s+=t.length,{fontProgramLength:s+=16*r+12,numTables:r}},i.prototype.writeCheckSums=function(e,t,r,n,s,o){if(null===e)throw new Error("Argument Null Exception : writer");if(null===r)throw new Error("Argument Null Exception : newLocaTableOut");if(null===n)throw new Error("Argument Null Exception : newGlyphTable");for(var a=this.tableNames,h=16*t+12,l=0,c=0;c<a.length;c++){var f=a[c],d=this.getTable(f);if(!d.empty){if(e.writeString(f),"glyf"===f){var p=this.calculateCheckSum(n);e.writeInt(p),l=s}else"loca"===f?(p=this.calculateCheckSum(r),e.writeInt(p),l=o):(e.writeInt(d.checksum),l=d.length);e.writeUInt(h),e.writeUInt(l),h+=this.align(l)}}},i.prototype.calculateCheckSum=function(e){if(null===e)throw new Error("Argument Null Exception : bytes");for(var t=0,r=0,n=0,s=0,o=0,a=0;a<(e.length+1)/4;a++)o+=255&e[t++],s+=255&e[t++],n+=255&e[t++],r+=255&e[t++];var h=r;return h+=n<<8,(h+=s<<16)+(o<<24)},i.prototype.writeGlyphs=function(e,t,r){if(null===e)throw new Error("Argument Null Exception : writer");if(null===t)throw new Error("Argument Null Exception : newLocaTableOut");if(null===r)throw new Error("Argument Null Exception : newGlyphTable");for(var n=this.tableNames,s=0;s<n.length;s++){var o=n[s],a=this.getTable(o);if(!a.empty)if("glyf"===o)e.writeBytes(r);else if("loca"===o)e.writeBytes(t);else{for(var h=this.align(a.length),l=[],c=0;c<h;c++)l.push(0);this.offset=a.offset;var f=this.read(l,0,a.length);e.writeBytes(f.buffer)}}},i.prototype.setOffset=function(e){this.offset=e},i.prototype.createInternals=function(){this.metrics=new Yt;var e=this.readNameTable(),t=this.readHeadTable();this.bIsLocaShort=0===t.indexToLocalFormat;var r=this.readHorizontalHeaderTable(),n=this.readOS2Table(),s=this.readPostTable();this.width=this.readWidthTable(r.numberOfHMetrics,t.unitsPerEm);var o=this.readCmapTable();this.initializeMetrics(e,t,r,n,s,o)},i.prototype.getGlyph=function(e){if("number"==typeof e){var t=null;return this.metrics.isSymbol||null==this.microsoftGlyphs?this.metrics.isSymbol&&null!=this.macintoshGlyphs&&this.macintoshGlyphs.containsKey(e)&&(t=this.macintoshGlyphs.getValue(e)):this.microsoftGlyphs.containsKey(e)&&(t=this.microsoftGlyphs.getValue(e)),null!=t?t:this.getDefaultGlyph()}var n=null,s=e.charCodeAt(0);return this.metrics.isSymbol||null===this.microsoft?(this.metrics.isSymbol&&null!==this.macintosh||this.isMacTTF)&&(0!==this.maxMacIndex?s%=this.maxMacIndex+1:s=61440==(65280&s)?255&s:s,this.macintosh.containsKey(s)&&(n=this.macintosh.getValue(s),this.isFontPresent=!0)):this.microsoft.containsKey(s)?(n=this.microsoft.getValue(s),s!==ee.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!0)):s!==ee.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!1),e===ee.whiteSpace&&null===n&&(n=new $e),null!==n?n:this.getDefaultGlyph()},i.prototype.getGlyphChars=function(e){if(null==e)throw new Error("Argument Null Exception : chars");for(var t=new D,r=e.keys(),n=0;n<r.length;n++){var s=r[n],o=this.getGlyph(s);o.empty||t.setValue(o.index,s.charCodeAt(0))}return t},i.prototype.getAllGlyphs=function(){for(var e=[],t=new $e,r=0,n=0;n<this.width.length;n++){var s=this.width[n];t.index=r,t.width=s,e.push(t),r++}return e},i.prototype.readFontProgram=function(e){var t=this.getGlyphChars(e),r=this.readLocaTable(this.bIsLocaShort);t.size()<e.size()&&(this.missedGlyphs=e.size()-t.size()),this.updateGlyphChars(t,r);var n=this.generateGlyphTable(t,r,null,null),s=n.glyphTableSize,a=n.newGlyphTable,h=this.updateLocaTable(n.newLocaTable,this.bIsLocaShort,null);return this.getFontProgram(h.newLocaUpdated,a,s,h.newLocaSize)},i.prototype.convertString=function(e){if(null===e)throw new Error("Argument Null Exception : text");for(var t="",r=0;r<e.length;r++){var s=this.getGlyph(e[r]);s.empty||(t+=String.fromCharCode(s.index))}return t},i.prototype.getCharWidth=function(e){var t=this.getGlyph(e);return(t=t.empty?this.getDefaultGlyph():t).empty?0:t.width},i.prototype.readString=function(e,t){if(void 0===t)return this.readString(e,!1);var r="";if(t)for(var n=0;n<e;n++)n%2!=0&&(r+=String.fromCharCode(this.fontData[this.offset])),this.offset+=1;else for(n=0;n<e;n++)r+=String.fromCharCode(this.fontData[this.offset]),this.offset+=1;return r},i.prototype.readFixed=function(e){return this.readInt16(e)+this.readInt16(e+2)/16384},i.prototype.readInt32=function(e){var t=this.fontData[e+3],r=this.fontData[e+2],n=this.fontData[e+1],s=this.fontData[e];return this.offset+=4,t+(r<<8)+(n<<16)+(s<<24)},i.prototype.readUInt32=function(e){var t=this.fontData[e+3],r=this.fontData[e+2],n=this.fontData[e+1],s=this.fontData[e];return this.offset+=4,t|r<<8|n<<16|s<<24},i.prototype.readInt16=function(e){var t=(this.fontData[e]<<8)+this.fontData[e+1];return t=32768&t?t-65536:t,this.offset+=2,t},i.prototype.readInt64=function(e){var t=this.readInt32(e+4),r=4294967296*this.readInt32(e)+t;return t<0&&(r+=4294967296),r},i.prototype.readUInt16=function(e){var t=this.fontData[e]<<8|this.fontData[e+1];return this.offset+=2,t},i.prototype.readUshortArray=function(e){for(var t=[],r=0;r<e;r++)t[r]=this.readUInt16(this.offset);return t},i.prototype.readBytes=function(e){for(var t=[],r=0;r<e;r++)t.push(this.fontData[this.offset]),this.offset+=1;return t},i.prototype.readByte=function(e){var t=this.fontData[e];return this.offset+=1,t},i.prototype.read=function(e,t,r){if(null===e)throw new Error("Argument Null Exception : buffer");var n=0,s=0;do{for(var o=0;o<r-n&&this.offset+o<this.fontData.length;o++)e[t+o]=this.fontData[this.offset+o];this.offset+=s=r-n,n+=s}while(n<r);return{buffer:e,written:n}},i}(),br=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Me=function(){function i(){this.lineGap=0}return i.prototype.getAscent=function(e){return this.ascent*re.charSizeMultiplier*this.getSize(e)},i.prototype.getDescent=function(e){return this.descent*re.charSizeMultiplier*this.getSize(e)},i.prototype.getLineGap=function(e){return this.lineGap*re.charSizeMultiplier*this.getSize(e)},i.prototype.getHeight=function(e){for(var r=["cambria","candara","constantia","corbel","cariadings"],n=[],s=0;s<r.length;s++)n.push(r[s]);return this.getDescent(e)<0?this.getAscent(e)-this.getDescent(e)+this.getLineGap(e):this.getAscent(e)+this.getDescent(e)+this.getLineGap(e)},i.prototype.getSize=function(e){var t=this.size;if(null!=e)switch(e.subSuperScript){case ge.SubScript:t/=this.subScriptSizeFactor;break;case ge.SuperScript:t/=this.superscriptSizeFactor}return t},i.prototype.clone=function(){return this.widthTable=$t.clone(),this},Object.defineProperty(i.prototype,"widthTable",{get:function(){return this.internalWidthTable},set:function(e){this.internalWidthTable=e},enumerable:!0,configurable:!0}),i}(),$t=function(){function i(){}return i.clone=function(){return null},i}(),X=function(i){function e(t){var r=i.call(this)||this;if(null==t)throw new Error("ArgumentNullException:widths");return r.widths=t,r}return br(e,i),e.prototype.items=function(t){if(t<0||t>=this.widths.length)throw new Error("ArgumentOutOfRangeException:index, The character is not supported by the font.");return this.widths[t]},Object.defineProperty(e.prototype,"length",{get:function(){return this.widths.length},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return this.widths=this.widths,this},e.prototype.toArray=function(){return new j(this.widths)},e}($t),Pt=function(){function i(e,t){if(this.nameString="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.dictionaryProperties=new M,this.isCompress=!1,this.isEmbedFont=!1,this.cmapPrefix="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap"+m.newLine+"/CIDSystemInfo << /Registry (Adobe)/Ordering (UCS)/Supplement 0>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange"+m.newLine,this.cmapEndCodespaceRange="endcodespacerange"+m.newLine,this.cmapBeginRange="beginbfrange"+m.newLine,this.cmapEndRange="endbfrange"+m.newLine,this.cmapSuffix="endbfrange\nendcmap\nCMapName currentdict /CMap defineresource pop\nend end"+m.newLine,null==e)throw new Error("ArgumentNullException:base64String");this.fontSize=t,this.fontString=e,this.Initialize()}return i.prototype.getCharWidth=function(e){return this.ttfReader.getCharWidth(e)},i.prototype.getLineWidth=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=this.getCharWidth(e[r]);return t},i.prototype.Initialize=function(){var e=new qe(this.fontString.length);e.writeFromBase64String(this.fontString),this.fontData=e.internalBuffer,this.ttfReader=new mr(this.fontData),this.ttfMetrics=this.ttfReader.metrics},i.prototype.createInternals=function(){this.fontDictionary=new F,this.fontProgram=new J,this.cmap=new J,this.descendantFont=new F,this.metrics=new Me,this.ttfReader.createInternals(),this.ttfMetrics=this.ttfReader.metrics,this.initializeMetrics(),this.subsetName=this.getFontName(),this.createDescendantFont(),this.createCmap(),this.createFontDictionary(),this.createFontProgram()},i.prototype.getInternals=function(){return this.fontDictionary},i.prototype.initializeMetrics=function(){var e=this.ttfReader.metrics;this.metrics.ascent=e.macAscent,this.metrics.descent=e.macDescent,this.metrics.height=e.macAscent-e.macDescent+e.lineGap,this.metrics.name=e.fontFamily,this.metrics.postScriptName=e.postScriptName,this.metrics.size=this.fontSize,this.metrics.widthTable=new X(e.widthTable),this.metrics.lineGap=e.lineGap,this.metrics.subScriptSizeFactor=e.subScriptSizeFactor,this.metrics.superscriptSizeFactor=e.superscriptSizeFactor,this.metrics.isBold=e.isBold},i.prototype.getFontName=function(){for(var t,e="",r=0;r<6;r++){var n=Math.floor(26*Math.random())+0;e+=this.nameString[n]}return e+="+",t=(e+=this.ttfReader.metrics.postScriptName).toString(),this.formatName(t)},i.prototype.formatName=function(e){var t=e.replace("(","#28");return(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(")","#29")).replace("[","#5B")).replace("]","#5D")).replace("<","#3C")).replace(">","#3E")).replace("{","#7B")).replace("}","#7D")).replace("/","#2F")).replace("%","#25")).replace(" ","#20")},i.prototype.createDescendantFont=function(){this.descendantFont.isFont=!0,this.descendantFont.descendantFontBeginSave=new ji(this),this.descendantFont.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.font)),this.descendantFont.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.cIDFontType2)),this.descendantFont.items.setValue(this.dictionaryProperties.baseFont,new O(this.subsetName)),this.descendantFont.items.setValue(this.dictionaryProperties.cIDToGIDMap,new O(this.dictionaryProperties.identity)),this.descendantFont.items.setValue(this.dictionaryProperties.dw,new B(1e3)),this.fontDescriptor=this.createFontDescriptor(),this.descendantFont.items.setValue(this.dictionaryProperties.fontDescriptor,new N(this.fontDescriptor));var e=this.createSystemInfo();this.descendantFont.items.setValue(this.dictionaryProperties.cIDSystemInfo,e)},i.prototype.createFontDescriptor=function(){var e=new F,t=this.ttfReader.metrics;return e.isFont=!0,e.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.fontDescriptor)),e.items.setValue(this.dictionaryProperties.fontName,new O(this.subsetName)),e.items.setValue(this.dictionaryProperties.flags,new B(this.getDescriptorFlags())),e.items.setValue(this.dictionaryProperties.fontBBox,j.fromRectangle(this.getBoundBox())),e.items.setValue(this.dictionaryProperties.missingWidth,new B(t.widthTable[32])),e.items.setValue(this.dictionaryProperties.stemV,new B(t.stemV)),e.items.setValue(this.dictionaryProperties.italicAngle,new B(t.italicAngle)),e.items.setValue(this.dictionaryProperties.capHeight,new B(t.capHeight)),e.items.setValue(this.dictionaryProperties.ascent,new B(t.winAscent)),e.items.setValue(this.dictionaryProperties.descent,new B(t.winDescent)),e.items.setValue(this.dictionaryProperties.leading,new B(t.leading)),e.items.setValue(this.dictionaryProperties.avgWidth,new B(t.widthTable[32])),e.items.setValue(this.dictionaryProperties.fontFile2,new N(this.fontProgram)),e.items.setValue(this.dictionaryProperties.maxWidth,new B(t.widthTable[32])),e.items.setValue(this.dictionaryProperties.xHeight,new B(0)),e.items.setValue(this.dictionaryProperties.stemH,new B(0)),e},i.prototype.createCmap=function(){this.cmap.cmapBeginSave=new Di(this)},i.prototype.createFontDictionary=function(){this.fontDictionary.isFont=!0,this.fontDictionary.fontDictionaryBeginSave=new Ei(this),this.fontDictionary.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.font)),this.fontDictionary.items.setValue(this.dictionaryProperties.baseFont,new O(this.subsetName)),this.fontDictionary.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.type0)),this.fontDictionary.items.setValue(this.dictionaryProperties.encoding,new O(this.dictionaryProperties.identityH));var e=new j,t=new N(this.descendantFont);e.isFont=!0,e.add(t),this.fontDictionary.items.setValue(this.dictionaryProperties.descendantFonts,e)},i.prototype.createFontProgram=function(){this.fontProgram.fontProgramBeginSave=new Mi(this)},i.prototype.createSystemInfo=function(){var e=new F;return e.items.setValue(this.dictionaryProperties.registry,new U("Adobe")),e.items.setValue(this.dictionaryProperties.ordering,new U(this.dictionaryProperties.identity)),e.items.setValue(this.dictionaryProperties.supplement,new B(0)),e},i.prototype.descendantFontBeginSave=function(){if(null!=this.usedChars&&this.usedChars.size()>0){var e=this.getDescendantWidth();null!==e&&this.descendantFont.items.setValue(this.dictionaryProperties.w,e)}},i.prototype.cmapBeginSave=function(){this.generateCmap()},i.prototype.fontDictionaryBeginSave=function(){null!=this.usedChars&&this.usedChars.size()>0&&!this.fontDictionary.containsKey(this.dictionaryProperties.toUnicode)&&this.fontDictionary.items.setValue(this.dictionaryProperties.toUnicode,new N(this.cmap))},i.prototype.fontProgramBeginSave=function(){this.isCompress=!0,this.generateFontProgram()},i.prototype.getDescendantWidth=function(){var e=new j;if(null!=this.usedChars&&this.usedChars.size()>0){for(var t=[],r=this.usedChars.keys(),n=0;n<r.length;n++)(o=this.ttfReader.getGlyph(r[n])).empty||t.push(o);t.sort(function(f,d){return f.index-d.index});var a=0,h=0,l=!1,c=new j;for(n=0;n<t.length;n++){var o=t[n];l||(l=!0,a=o.index,h=o.index-1),(h+1!==o.index||n+1===t.length)&&t.length>1&&(e.add(new B(a)),0!==n&&e.add(c),a=o.index,c=new j),c.add(new B(o.width)),n+1===t.length&&(e.add(new B(a)),e.add(c)),h=o.index}}return e},i.prototype.generateCmap=function(){if(null!=this.usedChars&&this.usedChars.size()>0){var e=this.ttfReader.getGlyphChars(this.usedChars);if(e.size()>0){var t=e.keys().sort(),n=t[t.length-1],s=this.toHexString(t[0],!1)+this.toHexString(n,!1)+m.newLine,o="";o+=this.cmapPrefix,o+=s,o+=this.cmapEndCodespaceRange;for(var a=0,h=0;h<t.length;h++){0===a&&(0!==h&&(o+=this.cmapEndRange),o+=a=Math.min(100,t.length-h),o+=m.whiteSpace,o+=this.cmapBeginRange),a-=1;var l=t[h];o+=this.toHexString(l,!0)+this.toHexString(l,!0)+this.toHexString(e.getValue(l),!0)+"\n"}o+=this.cmapSuffix,this.cmap.clearStream(),this.cmap.isFont=!0,this.cmap.write(o)}}},i.prototype.generateFontProgram=function(){var e;this.usedChars=null==this.usedChars?new D:this.usedChars,this.ttfReader.setOffset(0),e=this.ttfReader.readFontProgram(this.usedChars),this.fontProgram.clearStream(),this.fontProgram.isFont=!0,this.fontProgram.writeBytes(e)},i.prototype.getDescriptorFlags=function(){var e=0,t=this.ttfReader.metrics;return t.isFixedPitch&&(e|=Pe.FixedPitch),e|=t.isSymbol?Pe.Symbolic:Pe.Nonsymbolic,t.isItalic&&(e|=Pe.Italic),t.isBold&&(e|=Pe.ForceBold),e},i.prototype.getBoundBox=function(){var e=this.ttfReader.metrics.fontBox,t=Math.abs(e.right-e.left),r=Math.abs(e.top-e.bottom);return new w(e.left,e.bottom,t,r)},i.prototype.toHexString=function(e,t){var r=e.toString(16);return t&&(r=r.toUpperCase()),"<0000".substring(0,5-r.length)+r+">"},i.prototype.setSymbols=function(e){if(null===e)throw new Error("Argument Null Exception : text");null==this.usedChars&&(this.usedChars=new D);for(var t=0;t<e.length;t++)this.usedChars.setValue(e[t],String.fromCharCode(0));!1===this.isEmbedFont&&this.getDescendantWidth()},i}(),Xt=function(){function i(){this.arabicCharTable=[["\u0621","\ufe80"],["\u0622","\ufe81","\ufe82"],["\u0623","\ufe83","\ufe84"],["\u0624","\ufe85","\ufe86"],["\u0625","\ufe87","\ufe88"],["\u0626","\ufe89","\ufe8a","\ufe8b","\ufe8c"],["\u0627","\ufe8d","\ufe8e"],["\u0628","\ufe8f","\ufe90","\ufe91","\ufe92"],["\u0629","\ufe93","\ufe94"],["\u062a","\ufe95","\ufe96","\ufe97","\ufe98"],["\u062b","\ufe99","\ufe9a","\ufe9b","\ufe9c"],["\u062c","\ufe9d","\ufe9e","\ufe9f","\ufea0"],["\u062d","\ufea1","\ufea2","\ufea3","\ufea4"],["\u062e","\ufea5","\ufea6","\ufea7","\ufea8"],["\u062f","\ufea9","\ufeaa"],["\u0630","\ufeab","\ufeac"],["\u0631","\ufead","\ufeae"],["\u0632","\ufeaf","\ufeb0"],["\u0633","\ufeb1","\ufeb2","\ufeb3","\ufeb4"],["\u0634","\ufeb5","\ufeb6","\ufeb7","\ufeb8"],["\u0635","\ufeb9","\ufeba","\ufebb","\ufebc"],["\u0636","\ufebd","\ufebe","\ufebf","\ufec0"],["\u0637","\ufec1","\ufec2","\ufec3","\ufec4"],["\u0638","\ufec5","\ufec6","\ufec7","\ufec8"],["\u0639","\ufec9","\ufeca","\ufecb","\ufecc"],["\u063a","\ufecd","\ufece","\ufecf","\ufed0"],["\u0640","\u0640","\u0640","\u0640","\u0640"],["\u0641","\ufed1","\ufed2","\ufed3","\ufed4"],["\u0642","\ufed5","\ufed6","\ufed7","\ufed8"],["\u0643","\ufed9","\ufeda","\ufedb","\ufedc"],["\u0644","\ufedd","\ufede","\ufedf","\ufee0"],["\u0645","\ufee1","\ufee2","\ufee3","\ufee4"],["\u0646","\ufee5","\ufee6","\ufee7","\ufee8"],["\u0647","\ufee9","\ufeea","\ufeeb","\ufeec"],["\u0648","\ufeed","\ufeee"],["\u0649","\ufeef","\ufef0","\ufbe8","\ufbe9"],["\u064a","\ufef1","\ufef2","\ufef3","\ufef4"],["\u0671","\ufb50","\ufb51"],["\u0679","\ufb66","\ufb67","\ufb68","\ufb69"],["\u067a","\ufb5e","\ufb5f","\ufb60","\ufb61"],["\u067b","\ufb52","\ufb53","\ufb54","\ufb55"],["\u067e","\ufb56","\ufb57","\ufb58","\ufb59"],["\u067f","\ufb62","\ufb63","\ufb64","\ufb65"],["\u0680","\ufb5a","\ufb5b","\ufb5c","\ufb5d"],["\u0683","\ufb76","\ufb77","\ufb78","\ufb79"],["\u0684","\ufb72","\ufb73","\ufb74","\ufb75"],["\u0686","\ufb7a","\ufb7b","\ufb7c","\ufb7d"],["\u0687","\ufb7e","\ufb7f","\ufb80","\ufb81"],["\u0688","\ufb88","\ufb89"],["\u068c","\ufb84","\ufb85"],["\u068d","\ufb82","\ufb83"],["\u068e","\ufb86","\ufb87"],["\u0691","\ufb8c","\ufb8d"],["\u0698","\ufb8a","\ufb8b"],["\u06a4","\ufb6a","\ufb6b","\ufb6c","\ufb6d"],["\u06a6","\ufb6e","\ufb6f","\ufb70","\ufb71"],["\u06a9","\ufb8e","\ufb8f","\ufb90","\ufb91"],["\u06ad","\ufbd3","\ufbd4","\ufbd5","\ufbd6"],["\u06af","\ufb92","\ufb93","\ufb94","\ufb95"],["\u06b1","\ufb9a","\ufb9b","\ufb9c","\ufb9d"],["\u06b3","\ufb96","\ufb97","\ufb98","\ufb99"],["\u06ba","\ufb9e","\ufb9f"],["\u06bb","\ufba0","\ufba1","\ufba2","\ufba3"],["\u06be","\ufbaa","\ufbab","\ufbac","\ufbad"],["\u06c0","\ufba4","\ufba5"],["\u06c1","\ufba6","\ufba7","\ufba8","\ufba9"],["\u06c5","\ufbe0","\ufbe1"],["\u06c6","\ufbd9","\ufbda"],["\u06c7","\ufbd7","\ufbd8"],["\u06c8","\ufbdb","\ufbdc"],["\u06c9","\ufbe2","\ufbe3"],["\u06cb","\ufbde","\ufbdf"],["\u06cc","\ufbfc","\ufbfd","\ufbfe","\ufbff"],["\u06d0","\ufbe4","\ufbe5","\ufbe6","\ufbe7"],["\u06d2","\ufbae","\ufbaf"],["\u06d3","\ufbb0","\ufbb1"]],this.alef="\u0627",this.alefHamza="\u0623",this.alefHamzaBelow="\u0625",this.alefMadda="\u0622",this.lam="\u0644",this.hamza="\u0621",this.zeroWidthJoiner="\u200d",this.hamzaAbove="\u0654",this.hamzaBelow="\u0655",this.wawHamza="\u0624",this.yehHamza="\u0626",this.waw="\u0648",this.alefMaksura="\u0649",this.yeh="\u064a",this.farsiYeh="\u06cc",this.shadda="\u0651",this.madda="\u0653",this.lwa="\ufefb",this.lwawh="\ufef7",this.lwawhb="\ufef9",this.lwawm="\ufef5",this.bwhb="\u06d3",this.fathatan="\u064b",this.superScriptalef="\u0670",this.vowel=1,this.arabicMapTable=new D;for(var e=0;e<this.arabicCharTable.length;e++)this.arabicMapTable.setValue(this.arabicCharTable[e][0],this.arabicCharTable[e])}return i.prototype.getCharacterShape=function(e,t){if(e>=this.hamza&&e<=this.bwhb){if(this.arabicMapTable.getValue(e))return this.arabicMapTable.getValue(e)[t+1]}else if(e>=this.lwawm&&e<=this.lwa)return e;return e},i.prototype.shape=function(e,t){for(var r="",n="",s=0;s<e.length;s++){var o=e[s];o>="\u0600"&&o<="\u06ff"?n+=o:(n.length>0&&(r+=this.doShape(n.toString(),0),n=""),r+=o)}return n.length>0&&(r+=this.doShape(n.toString(),0)),r.toString()},i.prototype.doShape=function(e,t){for(var r="",s=0,o=0,a="",h=new Bt,l=new Bt;o<e.length;)if(a=e[o++],0===this.ligature(a,l)){var c=this.getShapeCount(a);s=1===c?0:2,h.Shapes>2&&(s+=1),l.Value=this.getCharacterShape(l.Value,s%=l.Shapes),r=this.append(r,h,t),h=l,(l=new Bt).Value=a,l.Shapes=c,l.Ligature++}return s=h.Shapes>2?1:0,l.Value=this.getCharacterShape(l.Value,s%=l.Shapes),r=this.append(r,h,t),(r=this.append(r,l,t)).toString()},i.prototype.append=function(e,t,r){return""!==t.Value&&(e+=t.Value,t.Ligature-=1,""!==t.Type&&(0==(r&this.vowel)&&(e+=t.Type),t.Ligature-=1),""!==t.vowel&&(0==(r&this.vowel)&&(e+=t.vowel),t.Ligature-=1)),e},i.prototype.ligature=function(e,t){if(""!==t.Value){var r=0;if(e>=this.fathatan&&e<=this.hamzaBelow||e===this.superScriptalef){if(r=1,""!==t.vowel&&e!==this.shadda&&(r=2),e===this.shadda){if(null!=t.Type)return 0;t.Type=this.shadda}else e===this.hamzaBelow?t.Value===this.alef?(t.Value=this.alefHamzaBelow,r=2):e===this.lwa?(t.Value=this.lwawhb,r=2):t.Type=this.hamzaBelow:e===this.hamzaAbove?t.Value===this.alef?(t.Value=this.alefHamza,r=2):t.Value===this.lwa?(t.Value=this.lwawh,r=2):t.Value===this.waw?(t.Value=this.wawHamza,r=2):t.Value===this.yeh||t.Value===this.alefMaksura||t.Value===this.farsiYeh?(t.Value=this.yehHamza,r=2):t.Type=this.hamzaAbove:e===this.madda?t.Value===this.alef&&(t.Value=this.alefMadda,r=2):t.vowel=e;return 1===r&&t.Ligature++,r}return""!==t.vowel?0:(t.Value===this.lam&&(e===this.alef?(t.Value=this.lwa,t.Shapes=2,r=3):e===this.alefHamza?(t.Value=this.lwawh,t.Shapes=2,r=3):e===this.alefHamzaBelow?(t.Value=this.lwawhb,t.Shapes=2,r=3):e===this.alefMadda&&(t.Value=this.lwawm,t.Shapes=2,r=3)),r)}return 0},i.prototype.getShapeCount=function(e){if(e>=this.hamza&&e<=this.bwhb&&!(e>=this.fathatan&&e<=this.hamzaBelow||e===this.superScriptalef)){if(this.arabicMapTable.getValue(e))return this.arabicMapTable.getValue(e).length-1}else if(e===this.zeroWidthJoiner)return 4;return 1},i}(),Bt=function(){function i(){this.shapeValue="",this.shapeType="",this.shapeVowel="",this.shapeLigature=0,this.shapeShapes=1}return Object.defineProperty(i.prototype,"Value",{get:function(){return this.shapeValue},set:function(e){this.shapeValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Type",{get:function(){return this.shapeType},set:function(e){this.shapeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vowel",{get:function(){return this.shapeVowel},set:function(e){this.shapeVowel=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Ligature",{get:function(){return this.shapeLigature},set:function(e){this.shapeLigature=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shapes",{get:function(){return this.shapeShapes},set:function(e){this.shapeShapes=e},enumerable:!0,configurable:!0}),i}(),vr=function(){function i(){this.indexes=[],this.indexLevels=[],this.mirroringShapeCharacters=new D,this.update()}return i.prototype.doMirrorShaping=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=1==(1&this.indexLevels[r])&&this.mirroringShapeCharacters.containsKey(e[r].charCodeAt(0))?String.fromCharCode(this.mirroringShapeCharacters.getValue(e[r].charCodeAt(0))):e[r].toString();for(var n="",s=0;s<t.length;s++)n+=t[s];return n},i.prototype.getLogicalToVisualString=function(e,t){var r=new wr;this.indexLevels=r.getVisualOrder(e,t),this.setDefaultIndexLevel(),this.doOrder(0,this.indexLevels.length-1);for(var n=this.doMirrorShaping(e),s="",o=0;o<this.indexes.length;o++)s+=n[this.indexes[o]];return s.toString()},i.prototype.setDefaultIndexLevel=function(){for(var e=0;e<this.indexLevels.length;e++)this.indexes[e]=e},i.prototype.doOrder=function(e,t){for(var r=this.indexLevels[e],n=r,s=r,o=r,a=e+1;a<=t;++a){var h=this.indexLevels[a];h>r?r=h:h<n&&(n=h),s&=h,o|=h}if(0!=(1&o)){if(1==(1&s))return void this.reArrange(e,t+1);for(n|=1;r>=n;){for(var l=e;;){for(;l<=t&&!(this.indexLevels[l]>=r);)l+=1;if(l>t)break;for(var c=l+1;c<=t&&!(this.indexLevels[c]<r);)c+=1;this.reArrange(l,c),l=c+1}r-=1}}},i.prototype.reArrange=function(e,t){var r=(e+t)/2;for(--t;e<r;++e,--t){var n=this.indexes[e];this.indexes[e]=this.indexes[t],this.indexes[t]=n}},i.prototype.update=function(){this.mirroringShapeCharacters.setValue(40,41),this.mirroringShapeCharacters.setValue(41,40),this.mirroringShapeCharacters.setValue(60,62),this.mirroringShapeCharacters.setValue(62,60),this.mirroringShapeCharacters.setValue(91,93),this.mirroringShapeCharacters.setValue(93,91),this.mirroringShapeCharacters.setValue(123,125),this.mirroringShapeCharacters.setValue(125,123),this.mirroringShapeCharacters.setValue(171,187),this.mirroringShapeCharacters.setValue(187,171),this.mirroringShapeCharacters.setValue(8249,8250),this.mirroringShapeCharacters.setValue(8250,8249),this.mirroringShapeCharacters.setValue(8261,8262),this.mirroringShapeCharacters.setValue(8262,8261),this.mirroringShapeCharacters.setValue(8317,8318),this.mirroringShapeCharacters.setValue(8318,8317),this.mirroringShapeCharacters.setValue(8333,8334),this.mirroringShapeCharacters.setValue(8334,8333),this.mirroringShapeCharacters.setValue(8712,8715),this.mirroringShapeCharacters.setValue(8713,8716),this.mirroringShapeCharacters.setValue(8714,8717),this.mirroringShapeCharacters.setValue(8715,8712),this.mirroringShapeCharacters.setValue(8716,8713),this.mirroringShapeCharacters.setValue(8717,8714),this.mirroringShapeCharacters.setValue(8725,10741),this.mirroringShapeCharacters.setValue(8764,8765),this.mirroringShapeCharacters.setValue(8765,8764),this.mirroringShapeCharacters.setValue(8771,8909),this.mirroringShapeCharacters.setValue(8786,8787),this.mirroringShapeCharacters.setValue(8787,8786),this.mirroringShapeCharacters.setValue(8788,8789),this.mirroringShapeCharacters.setValue(8789,8788),this.mirroringShapeCharacters.setValue(8804,8805),this.mirroringShapeCharacters.setValue(8805,8804),this.mirroringShapeCharacters.setValue(8806,8807),this.mirroringShapeCharacters.setValue(8807,8806),this.mirroringShapeCharacters.setValue(8808,8809),this.mirroringShapeCharacters.setValue(8809,8808),this.mirroringShapeCharacters.setValue(8810,8811),this.mirroringShapeCharacters.setValue(8811,8810),this.mirroringShapeCharacters.setValue(8814,8815),this.mirroringShapeCharacters.setValue(8815,8814),this.mirroringShapeCharacters.setValue(8816,8817),this.mirroringShapeCharacters.setValue(8817,8816),this.mirroringShapeCharacters.setValue(8818,8819),this.mirroringShapeCharacters.setValue(8819,8818),this.mirroringShapeCharacters.setValue(8820,8821),this.mirroringShapeCharacters.setValue(8821,8820),this.mirroringShapeCharacters.setValue(8822,8823),this.mirroringShapeCharacters.setValue(8823,8822),this.mirroringShapeCharacters.setValue(8824,8825),this.mirroringShapeCharacters.setValue(8825,8824),this.mirroringShapeCharacters.setValue(8826,8827),this.mirroringShapeCharacters.setValue(8827,8826),this.mirroringShapeCharacters.setValue(8828,8829),this.mirroringShapeCharacters.setValue(8829,8828),this.mirroringShapeCharacters.setValue(8830,8831),this.mirroringShapeCharacters.setValue(8831,8830),this.mirroringShapeCharacters.setValue(8832,8833),this.mirroringShapeCharacters.setValue(8833,8832),this.mirroringShapeCharacters.setValue(8834,8835),this.mirroringShapeCharacters.setValue(8835,8834),this.mirroringShapeCharacters.setValue(8836,8837),this.mirroringShapeCharacters.setValue(8837,8836),this.mirroringShapeCharacters.setValue(8838,8839),this.mirroringShapeCharacters.setValue(8839,8838),this.mirroringShapeCharacters.setValue(8840,8841),this.mirroringShapeCharacters.setValue(8841,8840),this.mirroringShapeCharacters.setValue(8842,8843),this.mirroringShapeCharacters.setValue(8843,8842),this.mirroringShapeCharacters.setValue(8847,8848),this.mirroringShapeCharacters.setValue(8848,8847),this.mirroringShapeCharacters.setValue(8849,8850),this.mirroringShapeCharacters.setValue(8850,8849),this.mirroringShapeCharacters.setValue(8856,10680),this.mirroringShapeCharacters.setValue(8866,8867),this.mirroringShapeCharacters.setValue(8867,8866),this.mirroringShapeCharacters.setValue(8870,10974),this.mirroringShapeCharacters.setValue(8872,10980),this.mirroringShapeCharacters.setValue(8873,10979),this.mirroringShapeCharacters.setValue(8875,10981),this.mirroringShapeCharacters.setValue(8880,8881),this.mirroringShapeCharacters.setValue(8881,8880),this.mirroringShapeCharacters.setValue(8882,8883),this.mirroringShapeCharacters.setValue(8883,8882),this.mirroringShapeCharacters.setValue(8884,8885),this.mirroringShapeCharacters.setValue(8885,8884),this.mirroringShapeCharacters.setValue(8886,8887),this.mirroringShapeCharacters.setValue(8887,8886),this.mirroringShapeCharacters.setValue(8905,8906),this.mirroringShapeCharacters.setValue(8906,8905),this.mirroringShapeCharacters.setValue(8907,8908),this.mirroringShapeCharacters.setValue(8908,8907),this.mirroringShapeCharacters.setValue(8909,8771),this.mirroringShapeCharacters.setValue(8912,8913),this.mirroringShapeCharacters.setValue(8913,8912),this.mirroringShapeCharacters.setValue(8918,8919),this.mirroringShapeCharacters.setValue(8919,8918),this.mirroringShapeCharacters.setValue(8920,8921),this.mirroringShapeCharacters.setValue(8921,8920),this.mirroringShapeCharacters.setValue(8922,8923),this.mirroringShapeCharacters.setValue(8923,8922),this.mirroringShapeCharacters.setValue(8924,8925),this.mirroringShapeCharacters.setValue(8925,8924),this.mirroringShapeCharacters.setValue(8926,8927),this.mirroringShapeCharacters.setValue(8927,8926),this.mirroringShapeCharacters.setValue(8928,8929),this.mirroringShapeCharacters.setValue(8929,8928),this.mirroringShapeCharacters.setValue(8930,8931),this.mirroringShapeCharacters.setValue(8931,8930),this.mirroringShapeCharacters.setValue(8932,8933),this.mirroringShapeCharacters.setValue(8933,8932),this.mirroringShapeCharacters.setValue(8934,8935),this.mirroringShapeCharacters.setValue(8935,8934),this.mirroringShapeCharacters.setValue(8936,8937),this.mirroringShapeCharacters.setValue(8937,8936),this.mirroringShapeCharacters.setValue(8938,8939),this.mirroringShapeCharacters.setValue(8939,8938),this.mirroringShapeCharacters.setValue(8940,8941),this.mirroringShapeCharacters.setValue(8941,8940),this.mirroringShapeCharacters.setValue(8944,8945),this.mirroringShapeCharacters.setValue(8945,8944),this.mirroringShapeCharacters.setValue(8946,8954),this.mirroringShapeCharacters.setValue(8947,8955),this.mirroringShapeCharacters.setValue(8948,8956),this.mirroringShapeCharacters.setValue(8950,8957),this.mirroringShapeCharacters.setValue(8951,8958),this.mirroringShapeCharacters.setValue(8954,8946),this.mirroringShapeCharacters.setValue(8955,8947),this.mirroringShapeCharacters.setValue(8956,8948),this.mirroringShapeCharacters.setValue(8957,8950),this.mirroringShapeCharacters.setValue(8958,8951),this.mirroringShapeCharacters.setValue(8968,8969),this.mirroringShapeCharacters.setValue(8969,8968),this.mirroringShapeCharacters.setValue(8970,8971),this.mirroringShapeCharacters.setValue(8971,8970),this.mirroringShapeCharacters.setValue(9001,9002),this.mirroringShapeCharacters.setValue(9002,9001),this.mirroringShapeCharacters.setValue(10088,10089),this.mirroringShapeCharacters.setValue(10089,10088),this.mirroringShapeCharacters.setValue(10090,10091),this.mirroringShapeCharacters.setValue(10091,10090),this.mirroringShapeCharacters.setValue(10092,10093),this.mirroringShapeCharacters.setValue(10093,10092),this.mirroringShapeCharacters.setValue(10094,10095),this.mirroringShapeCharacters.setValue(10095,10094),this.mirroringShapeCharacters.setValue(10096,10097),this.mirroringShapeCharacters.setValue(10097,10096),this.mirroringShapeCharacters.setValue(10098,10099),this.mirroringShapeCharacters.setValue(10099,10098),this.mirroringShapeCharacters.setValue(10100,10101),this.mirroringShapeCharacters.setValue(10101,10100),this.mirroringShapeCharacters.setValue(10197,10198),this.mirroringShapeCharacters.setValue(10198,10197),this.mirroringShapeCharacters.setValue(10205,10206),this.mirroringShapeCharacters.setValue(10206,10205),this.mirroringShapeCharacters.setValue(10210,10211),this.mirroringShapeCharacters.setValue(10211,10210),this.mirroringShapeCharacters.setValue(10212,10213),this.mirroringShapeCharacters.setValue(10213,10212),this.mirroringShapeCharacters.setValue(10214,10215),this.mirroringShapeCharacters.setValue(10215,10214),this.mirroringShapeCharacters.setValue(10216,10217),this.mirroringShapeCharacters.setValue(10217,10216),this.mirroringShapeCharacters.setValue(10218,10219),this.mirroringShapeCharacters.setValue(10219,10218),this.mirroringShapeCharacters.setValue(10627,10628),this.mirroringShapeCharacters.setValue(10628,10627),this.mirroringShapeCharacters.setValue(10629,10630),this.mirroringShapeCharacters.setValue(10630,10629),this.mirroringShapeCharacters.setValue(10631,10632),this.mirroringShapeCharacters.setValue(10632,10631),this.mirroringShapeCharacters.setValue(10633,10634),this.mirroringShapeCharacters.setValue(10634,10633),this.mirroringShapeCharacters.setValue(10635,10636),this.mirroringShapeCharacters.setValue(10636,10635),this.mirroringShapeCharacters.setValue(10637,10640),this.mirroringShapeCharacters.setValue(10638,10639),this.mirroringShapeCharacters.setValue(10639,10638),this.mirroringShapeCharacters.setValue(10640,10637),this.mirroringShapeCharacters.setValue(10641,10642),this.mirroringShapeCharacters.setValue(10642,10641),this.mirroringShapeCharacters.setValue(10643,10644),this.mirroringShapeCharacters.setValue(10644,10643),this.mirroringShapeCharacters.setValue(10645,10646),this.mirroringShapeCharacters.setValue(10646,10645),this.mirroringShapeCharacters.setValue(10647,10648),this.mirroringShapeCharacters.setValue(10648,10647),this.mirroringShapeCharacters.setValue(10680,8856),this.mirroringShapeCharacters.setValue(10688,10689),this.mirroringShapeCharacters.setValue(10689,10688),this.mirroringShapeCharacters.setValue(10692,10693),this.mirroringShapeCharacters.setValue(10693,10692),this.mirroringShapeCharacters.setValue(10703,10704),this.mirroringShapeCharacters.setValue(10704,10703),this.mirroringShapeCharacters.setValue(10705,10706),this.mirroringShapeCharacters.setValue(10706,10705),this.mirroringShapeCharacters.setValue(10708,10709),this.mirroringShapeCharacters.setValue(10709,10708),this.mirroringShapeCharacters.setValue(10712,10713),this.mirroringShapeCharacters.setValue(10713,10712),this.mirroringShapeCharacters.setValue(10714,10715),this.mirroringShapeCharacters.setValue(10715,10714),this.mirroringShapeCharacters.setValue(10741,8725),this.mirroringShapeCharacters.setValue(10744,10745),this.mirroringShapeCharacters.setValue(10745,10744),this.mirroringShapeCharacters.setValue(10748,10749),this.mirroringShapeCharacters.setValue(10749,10748),this.mirroringShapeCharacters.setValue(10795,10796),this.mirroringShapeCharacters.setValue(10796,10795),this.mirroringShapeCharacters.setValue(10797,10796),this.mirroringShapeCharacters.setValue(10798,10797),this.mirroringShapeCharacters.setValue(10804,10805),this.mirroringShapeCharacters.setValue(10805,10804),this.mirroringShapeCharacters.setValue(10812,10813),this.mirroringShapeCharacters.setValue(10813,10812),this.mirroringShapeCharacters.setValue(10852,10853),this.mirroringShapeCharacters.setValue(10853,10852),this.mirroringShapeCharacters.setValue(10873,10874),this.mirroringShapeCharacters.setValue(10874,10873),this.mirroringShapeCharacters.setValue(10877,10878),this.mirroringShapeCharacters.setValue(10878,10877),this.mirroringShapeCharacters.setValue(10879,10880),this.mirroringShapeCharacters.setValue(10880,10879),this.mirroringShapeCharacters.setValue(10881,10882),this.mirroringShapeCharacters.setValue(10882,10881),this.mirroringShapeCharacters.setValue(10883,10884),this.mirroringShapeCharacters.setValue(10884,10883),this.mirroringShapeCharacters.setValue(10891,10892),this.mirroringShapeCharacters.setValue(10892,10891),this.mirroringShapeCharacters.setValue(10897,10898),this.mirroringShapeCharacters.setValue(10898,10897),this.mirroringShapeCharacters.setValue(10899,10900),this.mirroringShapeCharacters.setValue(10900,10899),this.mirroringShapeCharacters.setValue(10901,10902),this.mirroringShapeCharacters.setValue(10902,10901),this.mirroringShapeCharacters.setValue(10903,10904),this.mirroringShapeCharacters.setValue(10904,10903),this.mirroringShapeCharacters.setValue(10905,10906),this.mirroringShapeCharacters.setValue(10906,10905),this.mirroringShapeCharacters.setValue(10907,10908),this.mirroringShapeCharacters.setValue(10908,10907),this.mirroringShapeCharacters.setValue(10913,10914),this.mirroringShapeCharacters.setValue(10914,10913),this.mirroringShapeCharacters.setValue(10918,10919),this.mirroringShapeCharacters.setValue(10919,10918),this.mirroringShapeCharacters.setValue(10920,10921),this.mirroringShapeCharacters.setValue(10921,10920),this.mirroringShapeCharacters.setValue(10922,10923),this.mirroringShapeCharacters.setValue(10923,10922),this.mirroringShapeCharacters.setValue(10924,10925),this.mirroringShapeCharacters.setValue(10925,10924),this.mirroringShapeCharacters.setValue(10927,10928),this.mirroringShapeCharacters.setValue(10928,10927),this.mirroringShapeCharacters.setValue(10931,10932),this.mirroringShapeCharacters.setValue(10932,10931),this.mirroringShapeCharacters.setValue(10939,10940),this.mirroringShapeCharacters.setValue(10940,10939),this.mirroringShapeCharacters.setValue(10941,10942),this.mirroringShapeCharacters.setValue(10942,10941),this.mirroringShapeCharacters.setValue(10943,10944),this.mirroringShapeCharacters.setValue(10944,10943),this.mirroringShapeCharacters.setValue(10945,10946),this.mirroringShapeCharacters.setValue(10946,10945),this.mirroringShapeCharacters.setValue(10947,10948),this.mirroringShapeCharacters.setValue(10948,10947),this.mirroringShapeCharacters.setValue(10949,10950),this.mirroringShapeCharacters.setValue(10950,10949),this.mirroringShapeCharacters.setValue(10957,10958),this.mirroringShapeCharacters.setValue(10958,10957),this.mirroringShapeCharacters.setValue(10959,10960),this.mirroringShapeCharacters.setValue(10960,10959),this.mirroringShapeCharacters.setValue(10961,10962),this.mirroringShapeCharacters.setValue(10962,10961),this.mirroringShapeCharacters.setValue(10963,10964),this.mirroringShapeCharacters.setValue(10964,10963),this.mirroringShapeCharacters.setValue(10965,10966),this.mirroringShapeCharacters.setValue(10966,10965),this.mirroringShapeCharacters.setValue(10974,8870),this.mirroringShapeCharacters.setValue(10979,8873),this.mirroringShapeCharacters.setValue(10980,8872),this.mirroringShapeCharacters.setValue(10981,8875),this.mirroringShapeCharacters.setValue(10988,10989),this.mirroringShapeCharacters.setValue(10989,10988),this.mirroringShapeCharacters.setValue(10999,11e3),this.mirroringShapeCharacters.setValue(11e3,10999),this.mirroringShapeCharacters.setValue(11001,11002),this.mirroringShapeCharacters.setValue(11002,11001),this.mirroringShapeCharacters.setValue(12296,12297),this.mirroringShapeCharacters.setValue(12297,12296),this.mirroringShapeCharacters.setValue(12298,12299),this.mirroringShapeCharacters.setValue(12299,12298),this.mirroringShapeCharacters.setValue(12300,12301),this.mirroringShapeCharacters.setValue(12301,12300),this.mirroringShapeCharacters.setValue(12302,12303),this.mirroringShapeCharacters.setValue(12303,12302),this.mirroringShapeCharacters.setValue(12304,12305),this.mirroringShapeCharacters.setValue(12305,12304),this.mirroringShapeCharacters.setValue(12308,12309),this.mirroringShapeCharacters.setValue(12309,12308),this.mirroringShapeCharacters.setValue(12310,12311),this.mirroringShapeCharacters.setValue(12311,12310),this.mirroringShapeCharacters.setValue(12312,12313),this.mirroringShapeCharacters.setValue(12313,12312),this.mirroringShapeCharacters.setValue(12314,12315),this.mirroringShapeCharacters.setValue(12315,12314),this.mirroringShapeCharacters.setValue(65288,65289),this.mirroringShapeCharacters.setValue(65289,65288),this.mirroringShapeCharacters.setValue(65308,65310),this.mirroringShapeCharacters.setValue(65310,65308),this.mirroringShapeCharacters.setValue(65339,65341),this.mirroringShapeCharacters.setValue(65341,65339),this.mirroringShapeCharacters.setValue(65371,65373),this.mirroringShapeCharacters.setValue(65373,65371),this.mirroringShapeCharacters.setValue(65375,65376),this.mirroringShapeCharacters.setValue(65376,65375),this.mirroringShapeCharacters.setValue(65378,65379),this.mirroringShapeCharacters.setValue(65379,65378)},i}(),wr=function(){function i(){this.types=[],this.textOrder=-1,this.rtlCharacterTypes=new Array(65536),this.L=0,this.LRE=1,this.LRO=2,this.R=3,this.AL=4,this.RLE=5,this.RLO=6,this.PDF=7,this.EN=8,this.ES=9,this.ET=10,this.AN=11,this.CS=12,this.NSM=13,this.BN=14,this.B=15,this.S=16,this.WS=17,this.ON=18,this.charTypes=[this.L,this.EN,this.BN,this.ES,this.ES,this.S,this.ET,this.ET,this.B,this.AN,this.AN,this.S,this.CS,this.CS,this.WS,this.NSM,this.NSM,this.B,this.BN,27,this.BN,28,30,this.B,31,31,this.S,32,32,this.WS,33,34,this.ON,35,37,this.ET,38,42,this.ON,43,43,this.ET,44,44,this.CS,45,45,this.ET,46,46,this.CS,47,47,this.CS,48,57,this.EN,58,58,this.CS,59,64,this.ON,65,90,this.L,91,96,this.ON,97,122,this.L,123,126,this.ON,127,132,this.BN,133,133,this.B,134,159,this.BN,160,160,this.CS,161,161,this.ON,162,165,this.ET,166,169,this.ON,170,170,this.L,171,175,this.ON,176,177,this.ET,178,179,this.EN,180,180,this.ON,181,181,this.L,182,184,this.ON,185,185,this.EN,186,186,this.L,187,191,this.ON,192,214,this.L,215,215,this.ON,216,246,this.L,247,247,this.ON,248,696,this.L,697,698,this.ON,699,705,this.L,706,719,this.ON,720,721,this.L,722,735,this.ON,736,740,this.L,741,749,this.ON,750,750,this.L,751,767,this.ON,768,855,this.NSM,856,860,this.L,861,879,this.NSM,880,883,this.L,884,885,this.ON,886,893,this.L,894,894,this.ON,895,899,this.L,900,901,this.ON,902,902,this.L,903,903,this.ON,904,1013,this.L,1014,1014,this.ON,1015,1154,this.L,1155,1158,this.NSM,1159,1159,this.L,1160,1161,this.NSM,1162,1417,this.L,1418,1418,this.ON,1419,1424,this.L,1425,1441,this.NSM,1442,1442,this.L,1443,1465,this.NSM,1466,1466,this.L,1467,1469,this.NSM,1470,1470,this.R,1471,1471,this.NSM,1472,1472,this.R,1473,1474,this.NSM,1475,1475,this.R,1476,1476,this.NSM,1477,1487,this.L,1488,1514,this.R,1515,1519,this.L,1520,1524,this.R,1525,1535,this.L,1536,1539,this.AL,1540,1547,this.L,1548,1548,this.CS,1549,1549,this.AL,1550,1551,this.ON,1552,1557,this.NSM,1558,1562,this.L,1563,1563,this.AL,1564,1566,this.L,1567,1567,this.AL,1568,1568,this.L,1569,1594,this.AL,1595,1599,this.L,1600,1610,this.AL,1611,1624,this.NSM,1625,1631,this.L,1632,1641,this.AN,1642,1642,this.ET,1643,1644,this.AN,1645,1647,this.AL,1648,1648,this.NSM,1649,1749,this.AL,1750,1756,this.NSM,1757,1757,this.AL,1758,1764,this.NSM,1765,1766,this.AL,1767,1768,this.NSM,1769,1769,this.ON,1770,1773,this.NSM,1774,1775,this.AL,1776,1785,this.EN,1786,1805,this.AL,1806,1806,this.L,1807,1807,this.BN,1808,1808,this.AL,1809,1809,this.NSM,1810,1839,this.AL,1840,1866,this.NSM,1867,1868,this.L,1869,1871,this.AL,1872,1919,this.L,1920,1957,this.AL,1958,1968,this.NSM,1969,1969,this.AL,1970,2304,this.L,2305,2306,this.NSM,2307,2363,this.L,2364,2364,this.NSM,2365,2368,this.L,2369,2376,this.NSM,2377,2380,this.L,2381,2381,this.NSM,2382,2384,this.L,2385,2388,this.NSM,2389,2401,this.L,2402,2403,this.NSM,2404,2432,this.L,2433,2433,this.NSM,2434,2491,this.L,2492,2492,this.NSM,2493,2496,this.L,2497,2500,this.NSM,2501,2508,this.L,2509,2509,this.NSM,2510,2529,this.L,2530,2531,this.NSM,2532,2545,this.L,2546,2547,this.ET,2548,2560,this.L,2561,2562,this.NSM,2563,2619,this.L,2620,2620,this.NSM,2621,2624,this.L,2625,2626,this.NSM,2627,2630,this.L,2631,2632,this.NSM,2633,2634,this.L,2635,2637,this.NSM,2638,2671,this.L,2672,2673,this.NSM,2674,2688,this.L,2689,2690,this.NSM,2691,2747,this.L,2748,2748,this.NSM,2749,2752,this.L,2753,2757,this.NSM,2758,2758,this.L,2759,2760,this.NSM,2761,2764,this.L,2765,2765,this.NSM,2766,2785,this.L,2786,2787,this.NSM,2788,2800,this.L,2801,2801,this.ET,2802,2816,this.L,2817,2817,this.NSM,2818,2875,this.L,2876,2876,this.NSM,2877,2878,this.L,2879,2879,this.NSM,2880,2880,this.L,2881,2883,this.NSM,2884,2892,this.L,2893,2893,this.NSM,2894,2901,this.L,2902,2902,this.NSM,2903,2945,this.L,2946,2946,this.NSM,2947,3007,this.L,3008,3008,this.NSM,3009,3020,this.L,3021,3021,this.NSM,3022,3058,this.L,3059,3064,this.ON,3065,3065,this.ET,3066,3066,this.ON,3067,3133,this.L,3134,3136,this.NSM,3137,3141,this.L,3142,3144,this.NSM,3145,3145,this.L,3146,3149,this.NSM,3150,3156,this.L,3157,3158,this.NSM,3159,3259,this.L,3260,3260,this.NSM,3261,3275,this.L,3276,3277,this.NSM,3278,3392,this.L,3393,3395,this.NSM,3396,3404,this.L,3405,3405,this.NSM,3406,3529,this.L,3530,3530,this.NSM,3531,3537,this.L,3538,3540,this.NSM,3541,3541,this.L,3542,3542,this.NSM,3543,3632,this.L,3633,3633,this.NSM,3634,3635,this.L,3636,3642,this.NSM,3643,3646,this.L,3647,3647,this.ET,3648,3654,this.L,3655,3662,this.NSM,3663,3760,this.L,3761,3761,this.NSM,3762,3763,this.L,3764,3769,this.NSM,3770,3770,this.L,3771,3772,this.NSM,3773,3783,this.L,3784,3789,this.NSM,3790,3863,this.L,3864,3865,this.NSM,3866,3892,this.L,3893,3893,this.NSM,3894,3894,this.L,3895,3895,this.NSM,3896,3896,this.L,3897,3897,this.NSM,3898,3901,this.ON,3902,3952,this.L,3953,3966,this.NSM,3967,3967,this.L,3968,3972,this.NSM,3973,3973,this.L,3974,3975,this.NSM,3976,3983,this.L,3984,3991,this.NSM,3992,3992,this.L,3993,4028,this.NSM,4029,4037,this.L,4038,4038,this.NSM,4039,4140,this.L,4141,4144,this.NSM,4145,4145,this.L,4146,4146,this.NSM,4147,4149,this.L,4150,4151,this.NSM,4152,4152,this.L,4153,4153,this.NSM,4154,4183,this.L,4184,4185,this.NSM,4186,5759,this.L,5760,5760,this.WS,5761,5786,this.L,5787,5788,this.ON,5789,5905,this.L,5906,5908,this.NSM,5909,5937,this.L,5938,5940,this.NSM,5941,5969,this.L,5970,5971,this.NSM,5972,6001,this.L,6002,6003,this.NSM,6004,6070,this.L,6071,6077,this.NSM,6078,6085,this.L,6086,6086,this.NSM,6087,6088,this.L,6089,6099,this.NSM,6100,6106,this.L,6107,6107,this.ET,6108,6108,this.L,6109,6109,this.NSM,6110,6127,this.L,6128,6137,this.ON,6138,6143,this.L,6144,6154,this.ON,6155,6157,this.NSM,6158,6158,this.WS,6159,6312,this.L,6313,6313,this.NSM,6314,6431,this.L,6432,6434,this.NSM,6435,6438,this.L,6439,6443,this.NSM,6444,6449,this.L,6450,6450,this.NSM,6451,6456,this.L,6457,6459,this.NSM,6460,6463,this.L,6464,6464,this.ON,6465,6467,this.L,6468,6469,this.ON,6470,6623,this.L,6624,6655,this.ON,6656,8124,this.L,8125,8125,this.ON,8126,8126,this.L,8127,8129,this.ON,8130,8140,this.L,8141,8143,this.ON,8144,8156,this.L,8157,8159,this.ON,8160,8172,this.L,8173,8175,this.ON,8176,8188,this.L,8189,8190,this.ON,8191,8191,this.L,8192,8202,this.WS,8203,8205,this.BN,8206,8206,this.L,8207,8207,this.R,8208,8231,this.ON,8232,8232,this.WS,8233,8233,this.B,8234,8234,this.LRE,8235,8235,this.RLE,8236,8236,this.PDF,8237,8237,this.LRO,8238,8238,this.RLO,8239,8239,this.WS,8240,8244,this.ET,8245,8276,this.ON,8277,8278,this.L,8279,8279,this.ON,8280,8286,this.L,8287,8287,this.WS,8288,8291,this.BN,8292,8297,this.L,8298,8303,this.BN,8304,8304,this.EN,8305,8307,this.L,8308,8313,this.EN,8314,8315,this.ET,8316,8318,this.ON,8319,8319,this.L,8320,8329,this.EN,8330,8331,this.ET,8332,8334,this.ON,8335,8351,this.L,8352,8369,this.ET,8370,8399,this.L,8400,8426,this.NSM,8427,8447,this.L,8448,8449,this.ON,8450,8450,this.L,8451,8454,this.ON,8455,8455,this.L,8456,8457,this.ON,8458,8467,this.L,8468,8468,this.ON,8469,8469,this.L,8470,8472,this.ON,8473,8477,this.L,8478,8483,this.ON,8484,8484,this.L,8485,8485,this.ON,8486,8486,this.L,8487,8487,this.ON,8488,8488,this.L,8489,8489,this.ON,8490,8493,this.L,8494,8494,this.ET,8495,8497,this.L,8498,8498,this.ON,8499,8505,this.L,8506,8507,this.ON,8508,8511,this.L,8512,8516,this.ON,8517,8521,this.L,8522,8523,this.ON,8524,8530,this.L,8531,8543,this.ON,8544,8591,this.L,8592,8721,this.ON,8722,8723,this.ET,8724,9013,this.ON,9014,9082,this.L,9083,9108,this.ON,9109,9109,this.L,9110,9168,this.ON,9169,9215,this.L,9216,9254,this.ON,9255,9279,this.L,9280,9290,this.ON,9291,9311,this.L,9312,9371,this.EN,9372,9449,this.L,9450,9450,this.EN,9451,9751,this.ON,9752,9752,this.L,9753,9853,this.ON,9854,9855,this.L,9856,9873,this.ON,9874,9887,this.L,9888,9889,this.ON,9890,9984,this.L,9985,9988,this.ON,9989,9989,this.L,9990,9993,this.ON,9994,9995,this.L,9996,10023,this.ON,10024,10024,this.L,10025,10059,this.ON,10060,10060,this.L,10061,10061,this.ON,10062,10062,this.L,10063,10066,this.ON,10067,10069,this.L,10070,10070,this.ON,10071,10071,this.L,10072,10078,this.ON,10079,10080,this.L,10081,10132,this.ON,10133,10135,this.L,10136,10159,this.ON,10160,10160,this.L,10161,10174,this.ON,10175,10191,this.L,10192,10219,this.ON,10220,10223,this.L,10224,11021,this.ON,11022,11903,this.L,11904,11929,this.ON,11930,11930,this.L,11931,12019,this.ON,12020,12031,this.L,12032,12245,this.ON,12246,12271,this.L,12272,12283,this.ON,12284,12287,this.L,12288,12288,this.WS,12289,12292,this.ON,12293,12295,this.L,12296,12320,this.ON,12321,12329,this.L,12330,12335,this.NSM,12336,12336,this.ON,12337,12341,this.L,12342,12343,this.ON,12344,12348,this.L,12349,12351,this.ON,12352,12440,this.L,12441,12442,this.NSM,12443,12444,this.ON,12445,12447,this.L,12448,12448,this.ON,12449,12538,this.L,12539,12539,this.ON,12540,12828,this.L,12829,12830,this.ON,12831,12879,this.L,12880,12895,this.ON,12896,12923,this.L,12924,12925,this.ON,12926,12976,this.L,12977,12991,this.ON,12992,13003,this.L,13004,13007,this.ON,13008,13174,this.L,13175,13178,this.ON,13179,13277,this.L,13278,13279,this.ON,13280,13310,this.L,13311,13311,this.ON,13312,19903,this.L,19904,19967,this.ON,19968,42127,this.L,42128,42182,this.ON,42183,64284,this.L,64285,64285,this.R,64286,64286,this.NSM,64287,64296,this.R,64297,64297,this.ET,64298,64310,this.R,64311,64311,this.L,64312,64316,this.R,64317,64317,this.L,64318,64318,this.R,64319,64319,this.L,64320,64321,this.R,64322,64322,this.L,64323,64324,this.R,64325,64325,this.L,64326,64335,this.R,64336,64433,this.AL,64434,64466,this.L,64467,64829,this.AL,64830,64831,this.ON,64832,64847,this.L,64848,64911,this.AL,64912,64913,this.L,64914,64967,this.AL,64968,65007,this.L,65008,65020,this.AL,65021,65021,this.ON,65022,65023,this.L,65024,65039,this.NSM,65040,65055,this.L,65056,65059,this.NSM,65060,65071,this.L,65072,65103,this.ON,65104,65104,this.CS,65105,65105,this.ON,65106,65106,this.CS,65107,65107,this.L,65108,65108,this.ON,65109,65109,this.CS,65110,65118,this.ON,65119,65119,this.ET,65120,65121,this.ON,65122,65123,this.ET,65124,65126,this.ON,65127,65127,this.L,65128,65128,this.ON,65129,65130,this.ET,65131,65131,this.ON,65132,65135,this.L,65136,65140,this.AL,65141,65141,this.L,65142,65276,this.AL,65277,65278,this.L,65279,65279,this.BN,65280,65280,this.L,65281,65282,this.ON,65283,65285,this.ET,65286,65290,this.ON,65291,65291,this.ET,65292,65292,this.CS,65293,65293,this.ET,65294,65294,this.CS,65295,65295,this.ES,65296,65305,this.EN,65306,65306,this.CS,65307,65312,this.ON,65313,65338,this.L,65339,65344,this.ON,65345,65370,this.L,65371,65381,this.ON,65382,65503,this.L,65504,65505,this.ET,65506,65508,this.ON,65509,65510,this.ET,65511,65511,this.L,65512,65518,this.ON,65519,65528,this.L,65529,65531,this.BN,65532,65533,this.ON,65534,65535,this.L];for(var e=0;e<this.charTypes.length;++e)for(var t=this.charTypes[e],r=this.charTypes[++e],n=this.charTypes[++e];t<=r;)this.rtlCharacterTypes[t++]=n}return i.prototype.getVisualOrder=function(e,t){this.types=this.getCharacterCode(e),this.textOrder=t?this.LRE:this.L,this.doVisualOrder();for(var r=[],n=0;n<this.levels.length;n++)r[n]=this.levels[n];return r},i.prototype.getCharacterCode=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=this.rtlCharacterTypes[e[r].charCodeAt(0)];return t},i.prototype.setDefaultLevels=function(){for(var e=0;e<this.length;e++)this.levels[e]=this.textOrder},i.prototype.setLevels=function(){this.setDefaultLevels();for(var e=0;e<this.length;++e){var t=this.levels[e];0!=(128&t)&&(this.result[e]=0==(1&(t&=127))?this.L:this.R),this.levels[e]=t}},i.prototype.updateLevels=function(e,t,r){if(0==(1&t))for(var n=e;n<r;++n)this.result[n]===this.R?this.levels[n]+=1:this.result[n]!==this.L&&(this.levels[n]+=2);else for(n=e;n<r;++n)this.result[n]!==this.R&&(this.levels[n]+=1)},i.prototype.doVisualOrder=function(){this.length=this.types.length,this.result=this.types,this.levels=[],this.setLevels(),this.length=this.getEmbeddedCharactersLength();for(var e=this.textOrder,t=0;t<this.length;){for(var r=this.levels[t],n=0==(1&Math.max(e,r))?this.L:this.R,s=t+1;s<this.length&&this.levels[s]===r;)++s;var a=0==(1&Math.max(s<this.length?this.levels[s]:this.textOrder,r))?this.L:this.R;this.checkNSM(t,s,r,n,a),this.updateLevels(t,r,s),e=r,t=s}this.checkEmbeddedCharacters(this.length)},i.prototype.getEmbeddedCharactersLength=function(){for(var e=0,t=0;t<this.length;++t)this.types[t]===this.LRE||this.types[t]===this.RLE||this.types[t]===this.LRO||this.types[t]===this.RLO||this.types[t]===this.PDF||this.types[t]===this.BN||(this.result[e]=this.result[t],this.levels[e]=this.levels[t],e++);return e},i.prototype.checkEmbeddedCharacters=function(e){for(var t=this.types.length-1;t>=0;--t)this.types[t]===this.LRE||this.types[t]===this.RLE||this.types[t]===this.LRO||this.types[t]===this.RLO||this.types[t]===this.PDF||this.types[t]===this.BN?(this.result[t]=this.types[t],this.levels[t]=-1):(this.result[t]=this.result[e-=1],this.levels[t]=this.levels[e]);for(t=0;t<this.types.length;t++)-1===this.levels[t]&&(this.levels[t]=0===t?this.textOrder:this.levels[t-1])},i.prototype.checkNSM=function(e,t,r,n,s){for(var o=n,a=e;a<t;++a)this.result[a]===this.NSM?this.result[a]=o:o=this.result[a];this.checkEuropeanDigits(e,t,r,n,s)},i.prototype.checkEuropeanDigits=function(e,t,r,n,s){for(var o=e;o<t;++o)if(this.result[o]===this.EN)for(var a=o-1;a>=e;--a)if(this.result[a]===this.L||this.result[a]===this.R||this.result[a]===this.AL){this.result[a]===this.AL&&(this.result[o]=this.AN);break}this.checkArabicCharacters(e,t,r,n,s)},i.prototype.checkArabicCharacters=function(e,t,r,n,s){for(var o=e;o<t;++o)this.result[o]===this.AL&&(this.result[o]=this.R);this.checkEuropeanNumberSeparator(e,t,r,n,s)},i.prototype.checkEuropeanNumberSeparator=function(e,t,r,n,s){for(var o=e+1;o<t-1;++o)if(this.result[o]===this.ES||this.result[o]===this.CS){var a=this.result[o-1],h=this.result[o+1];a===this.EN&&h===this.EN?this.result[o]=this.EN:this.result[o]===this.CS&&a===this.AN&&h===this.AN&&(this.result[o]=this.AN)}this.checkEuropeanNumberTerminator(e,t,r,n,s)},i.prototype.checkEuropeanNumberTerminator=function(e,t,r,n,s){for(var o=e;o<t;++o)if(this.result[o]===this.ET){var a=o,h=[];h.push(this.ET);var l=this.getLength(a,t,h),c=a===e?n:this.result[a-1];if(c!==this.EN&&(c=l===t?s:this.result[l]),c===this.EN)for(var f=a;f<l;++f)this.result[f]=this.EN;o=l}this.checkOtherNeutrals(e,t,r,n,s)},i.prototype.checkOtherNeutrals=function(e,t,r,n,s){for(var o=e;o<t;++o)(this.result[o]===this.ES||this.result[o]===this.ET||this.result[o]===this.CS)&&(this.result[o]=this.ON);this.checkOtherCharacters(e,t,r,n,s)},i.prototype.checkOtherCharacters=function(e,t,r,n,s){for(var o=e;o<t;++o)if(this.result[o]===this.EN){for(var a=n,h=o-1;h>=e;--h)if(this.result[h]===this.L||this.result[h]===this.R){a=this.result[h];break}a===this.L&&(this.result[o]=this.L)}this.checkCommanCharacters(e,t,r,n,s)},i.prototype.getLength=function(e,t,r){for(--e;++e<t;){for(var n=this.result[e],s=0;s<r.length;++s)n===r[s]&&(e=this.getLength(++e,t,r));return e}return t},i.prototype.checkCommanCharacters=function(e,t,r,n,s){for(var o=e;o<t;++o)if(this.result[o]===this.WS||this.result[o]===this.ON||this.result[o]===this.B||this.result[o]===this.S){var d,a=o,l=this.getLength(a,t,[this.B,this.S,this.WS,this.ON]),c=0,f=0;a===e?c=n:((c=this.result[a-1])===this.AN||c===this.EN)&&(c=this.R),l===t?f=s:((f=this.result[l])===this.AN||f===this.EN)&&(f=this.R),d=c===f?c:0==(1&r)?this.L:this.R;for(var p=a;p<l;++p)this.result[p]=d;o=l}},i}(),Zt=function(){function i(){this.openBracket="(",this.closeBracket=")"}return i.prototype.layout=function(e,t,r,n,s){if(null==e)throw new Error("ArgumentNullException : line");if(null==t)throw new Error("ArgumentNullException : font");var o=[];return t.Unicode?o=this.customLayout(e,r,s,t,n):(o=[])[0]=e,o},i.prototype.splitLayout=function(e,t,r,n,s){if(null==e)throw new Error("ArgumentNullException : line");if(null==t)throw new Error("ArgumentNullException : font");return this.customSplitLayout(e,t,r,n,s)},i.prototype.getGlyphIndex=function(e,t,r,n,s){if(null==e)throw new Error("ArgumentNullException : line");if(null==t)throw new Error("ArgumentNullException : font");if(n=null,0===e.length)return{success:!1,glyphs:n};var l=(new Xt).shape(e,0),f=t.fontInternal.ttfReader;n=new Uint16Array(l.length);for(var d=0,p=0,v=l.length;p<v;p++){var P=f.getGlyph(l[p]);null!=P&&(n[d++]=P.index)}return{success:!0,glyphs:n}},i.prototype.customLayout=function(e,t,r,n,s){if(null==s){if(null==e)throw new Error("ArgumentNullException : line");var o=null;return null!=r&&r.textDirection!==te.None&&(o=(new vr).getLogicalToVisualString(e,t)),o}if(null==e)throw new Error("ArgumentNullException : line");if(null==n)throw new Error("ArgumentNullException : font");var h=null;if(null!=r&&r.textDirection!==te.None){var c=(new Xt).shape(e,0);h=this.customLayout(c,t,r)}if(o=[],s){for(var f=h.split(""),d=f.length,p=0;p<d;p++)f[p]=this.addChars(n,f[p]);o=f}else(o=[])[0]=this.addChars(n,h);return o},i.prototype.addChars=function(e,t){var r=t;if(null==e)throw new Error("ArgumentNullException : font");if(null==r)throw new Error("ArgumentNullException : line");var n=r,o=e.fontInternal.ttfReader;e.setSymbols(n),n=o.convertString(n);var a=U.toUnicodeArray(n,!1);return U.byteToString(a)},i.prototype.customSplitLayout=function(e,t,r,n,s){if(null==e)throw new Error("ArgumentNullException : line");if(null==t)throw new Error("ArgumentNullException : font");return this.customLayout(e,r,s).split("")},i}(),fe=(()=>(function(i){i[i.Paginate=0]="Paginate",i[i.OnePage=1]="OnePage"}(fe||(fe={})),fe))(),xe=(()=>(function(i){i[i.FitPage=0]="FitPage",i[i.FitElement=1]="FitElement",i[i.FitColumnsToPage=2]="FitColumnsToPage"}(xe||(xe={})),xe))(),G=(()=>(function(i){i[i.Start=0]="Start",i[i.Line=1]="Line",i[i.Bezier3=3]="Bezier3",i[i.Bezier=3]="Bezier",i[i.PathTypeMask=7]="PathTypeMask",i[i.DashMode=16]="DashMode",i[i.PathMarker=32]="PathMarker",i[i.CloseSubpath=128]="CloseSubpath"}(G||(G={})),G))(),Sr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Le=function(i){function e(t){var r=i.call(this)||this;return r.mbackground=new g(255,255,255),r.mbStroking=!1,r.mfunction=null,r.dictionaryProperties=new M,r.mpatternDictionary=new F,r.mpatternDictionary.items.setValue(r.dictionaryProperties.type,new O(r.dictionaryProperties.pattern)),r.mpatternDictionary.items.setValue(r.dictionaryProperties.patternType,new B(2)),r.shading=t,r.colorSpace=x.Rgb,r}return Sr(e,i),Object.defineProperty(e.prototype,"background",{get:function(){return this.mbackground},set:function(t){this.mbackground=t;var r=this.shading;t.isEmpty?r.remove(this.dictionaryProperties.background):r.items.setValue(this.dictionaryProperties.background,t.toArray(this.colorSpace))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAlias",{get:function(){return this.shading.items.getValue(this.dictionaryProperties.antiAlias).value},set:function(t){var r=this.shading,n=r.items.getValue(this.dictionaryProperties.antiAlias);null==n&&void 0===n?(n=new je(t),r.items.setValue(this.dictionaryProperties.antiAlias,n)):n.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"function",{get:function(){return this.mfunction},set:function(t){this.mfunction=t,null!=t&&void 0!==t?this.shading.items.setValue(this.dictionaryProperties.function,new N(this.mfunction)):this.shading.remove(this.dictionaryProperties.function)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bBox",{get:function(){return this.shading.items.getValue(this.dictionaryProperties.bBox)},set:function(t){var r=this.shading;null==t&&void 0===t?r.remove(this.dictionaryProperties.bBox):r.items.setValue(this.dictionaryProperties.bBox,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorSpace",{get:function(){return this.mcolorSpace},set:function(t){var r=this.shading.items.getValue(this.dictionaryProperties.colorSpace);if(t!==this.mcolorSpace||null==r){this.mcolorSpace=t;var n=this.colorSpaceToDeviceName(t);this.shading.items.setValue(this.dictionaryProperties.colorSpace,new O(n))}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroking",{get:function(){return this.mbStroking},set:function(t){this.mbStroking=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"patternDictionary",{get:function(){return null==this.mpatternDictionary&&(this.mpatternDictionary=new F),this.mpatternDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shading",{get:function(){return this.mshading},set:function(t){if(null==t)throw new Error("ArgumentNullException : Shading");t!==this.mshading&&(this.mshading=t,this.patternDictionary.items.setValue(this.dictionaryProperties.shading,new N(this.mshading)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this.mmatrix},set:function(t){if(null==t)throw new Error("ArgumentNullException : Matrix");if(t!==this.mmatrix){this.mmatrix=t.clone();var r=new j(this.mmatrix.matrix.elements);this.mpatternDictionary.items.setValue(this.dictionaryProperties.matrix,r)}},enumerable:!0,configurable:!0}),e.prototype.monitorChanges=function(t,r,n,s,o){var a=!1;if(t instanceof e){this.colorSpace!==o&&(this.colorSpace=o,this.resetFunction()),r.setColorSpace("Pattern",this.mbStroking);var l=n.getResources().getName(this);r.setColourWithPattern(null,l,this.mbStroking),a=!0}return a},e.prototype.resetChanges=function(t){},e.prototype.colorSpaceToDeviceName=function(t){var r;return t===x.Rgb&&(r="DeviceRGB"),r},e.prototype.resetPatternDictionary=function(t){this.mpatternDictionary=t},e.prototype.cloneAntiAliasingValue=function(t){if(null==t)throw new Error("ArgumentNullException : brush");var n=this.shading.items.getValue(this.dictionaryProperties.antiAlias);null!=n&&t.shading.items.setValue(this.dictionaryProperties.antiAlias,new je(n.value))},e.prototype.cloneBackgroundValue=function(t){var r=this.background;r.isEmpty||(t.background=r)},Object.defineProperty(e.prototype,"element",{get:function(){return this.patternDictionary},enumerable:!0,configurable:!0}),e}(oe),Xe=function(){function i(e,t){if(this.dictionaryProperties=new M,this.writeTransformation=!0,void 0!==e)if(e instanceof S&&void 0===t){this.content=new J;var r=new S(e.width,e.height);this.setSize(r),this.initialize()}else this.content=new J,this.setSize(new S(e,t)),this.initialize()}return Object.defineProperty(i.prototype,"size",{get:function(){return this.templateSize},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"graphics",{get:function(){if(null==this.pdfGraphics||void 0===this.pdfGraphics){var e=new Ot(this),t=new Ct(this.size,e,this.content);this.pdfGraphics=t,this.pdfGraphics.initializeCoordinates()}return this.pdfGraphics},enumerable:!0,configurable:!0}),i.prototype.getResources=function(){return null==this.resources&&(this.resources=new Ze,this.content.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},i.prototype.initialize=function(){this.addType(),this.addSubType()},i.prototype.addType=function(){var e=new O(this.dictionaryProperties.xObject);this.content.items.setValue(this.dictionaryProperties.type,e)},i.prototype.addSubType=function(){var e=new O(this.dictionaryProperties.form);this.content.items.setValue(this.dictionaryProperties.subtype,e)},i.prototype.reset=function(e){void 0===e?(null!=this.resources&&(this.resources=null,this.content.remove(this.dictionaryProperties.resources)),null!=this.graphics&&this.graphics.reset(this.size)):(this.setSize(e),this.reset())},i.prototype.setSize=function(e){var t=new w(new b(0,0),e),r=j.fromRectangle(t);this.content.items.setValue(this.dictionaryProperties.bBox,r),this.templateSize=e},Object.defineProperty(i.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),i}(),Pr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ze=function(i){function e(t){var r=i.call(this,t)||this;return r.properties=new F,r}return Pr(e,i),Object.defineProperty(e.prototype,"names",{get:function(){return this.getNames()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t},enumerable:!0,configurable:!0}),e.prototype.getName=function(t){var r=t.element,n=null;if(this.names.containsKey(r)&&(n=this.names.getValue(r)),null==n){var s=this.generateName();n=new O(s),this.names.setValue(r,n),(t instanceof re||t instanceof Xe||t instanceof Le||t instanceof Te||t instanceof wt||t instanceof Ye||t instanceof Je)&&this.add(t,n)}return n},e.prototype.getNames=function(){null==this.pdfNames&&(this.pdfNames=new Ue);var t=this.items.getValue(this.dictionaryProperties.font);return null!=t&&Gt.dereference(t),this.pdfNames},e.prototype.requireProcedureSet=function(t){if(null==t)throw new Error("ArgumentNullException:procedureSetName");var r=this.items.getValue(this.dictionaryProperties.procset);null==r&&(r=new j,this.items.setValue(this.dictionaryProperties.procset,r));var n=new O(t);r.contains(n)||r.add(n)},e.prototype.removeFont=function(t){for(var r=null,n=this.pdfNames.keys(),s=0;s<this.pdfNames.size();s++)if(this.pdfNames.getValue(n[s])===new O(t)){r=n[s];break}null!=r&&this.pdfNames.remove(r)},e.prototype.generateName=function(){return Br.getNewGuidString()},e.prototype.add=function(t,r){if(t instanceof re){var n=null,s=this.items.getValue(this.dictionaryProperties.font);if(null!=s){var o=s;n=s,n=s}else n=new F,this.items.setValue(this.dictionaryProperties.font,n);n.items.setValue(r.value,new N(t.element))}else if(t instanceof Xe){var a=void 0;null==(a=this.items.getValue(this.dictionaryProperties.xObject))&&(a=new F,this.items.setValue(this.dictionaryProperties.xObject,a)),a.items.setValue(r.value,new N(t.element))}else if(t instanceof oe){if((t instanceof Le||t instanceof Te)&&null!=(h=t.element)){var l=this.items.getValue(this.dictionaryProperties.pattern);null==l&&(l=new F,this.items.setValue(this.dictionaryProperties.pattern,l)),l.items.setValue(r.value,new N(h))}}else if(t instanceof wt){var h=t.element,c=null;null==(c=this.items.getValue(this.dictionaryProperties.extGState))&&(c=new F,this.items.setValue(this.dictionaryProperties.extGState,c)),c.items.setValue(r.value,new N(h))}else{a=this.Dictionary.items.getValue(this.dictionaryProperties.xObject);var f=void 0;void 0!==this.pdfDocument&&(f=this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.getValue(this.dictionaryProperties.xObject)),this.Dictionary.items.values();var p=!1,v=void 0;if(void 0===this.pdfDocument||void 0!==typeof f&&null!=f){if(void 0!==this.pdfDocument)for(var y=f.items.values(),P=0;P<y.length;P++)void 0!==y[P]&&void 0!==y[P].element&&y[P].element.data[0]===t.element.data[0]&&(v=y[P],p=!0)}else f=new F,this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.setValue(this.dictionaryProperties.xObject,f);null==a&&(a=new F,this.Dictionary.items.setValue(this.dictionaryProperties.xObject,a)),p&&void 0!==v?a.items.setValue(r.value,v):(o=new N(t.element),a.items.setValue(r.value,o),void 0!==this.pdfDocument&&f.items.setValue(r.value,o))}},e}(F),Br=function(){function i(){}return i.getNewGuidString=function(){return"aaaaaaaa-aaaa-4aaa-baaa-aaaaaaaaaaaa".replace(/[ab]/g,function(e){var t=16*Math.random()|0;return("a"===e?t:3&t|8).toString(16)})},i}(),Cr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Te=function(i){function e(t,r){var n=i.call(this)||this;n.mStroking=!1,n.mLocation=new b(0,0),n.mDictionaryProperties=new M;var s=null;return t instanceof st?s=t:t instanceof S&&(s=new st(0,0,t.width,t.height)),null!==r&&r instanceof de&&(n.mPage=r),n.brushStream=new J,n.mResources=new Ze,n.brushStream.items.setValue(n.mDictionaryProperties.resources,n.mResources),n.setBox(s),n.setObligatoryFields(),null!==r&&r instanceof de&&(n.mPage=r,n.graphics.colorSpace=r.document.colorSpace),n}return Cr(e,i),e.prototype.initialize=function(t,r,n,s){this.mPage=r,this.mLocation=n,this.mTransformationMatrix=s,this.tempBrushStream=this.brushStream,this.brushStream=new J;var o=new Ze;return this.brushStream.items.setValue(this.mDictionaryProperties.resources,o),this.setBox(t),this.setObligatoryFields(),this},Object.defineProperty(e.prototype,"location",{get:function(){return this.mLocation},set:function(t){this.mLocation=t},enumerable:!0,configurable:!0}),e.prototype.setObligatoryFields=function(){if(this.brushStream.items.setValue(this.mDictionaryProperties.patternType,new B(1)),this.brushStream.items.setValue(this.mDictionaryProperties.paintType,new B(1)),this.brushStream.items.setValue(this.mDictionaryProperties.tilingType,new B(1)),this.brushStream.items.setValue(this.mDictionaryProperties.xStep,new B(this.mBox.right-this.mBox.left)),this.brushStream.items.setValue(this.mDictionaryProperties.yStep,new B(this.mBox.bottom-this.mBox.top)),null!=this.mPage&&null!=this.mLocation)if(null==this.mTransformationMatrix&&void 0===this.mTransformationMatrix)this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new j([1,0,0,1,this.mLocation.x,this.mPage.size.height%this.rectangle.size.height-this.mLocation.y]));else{var r=this.mTransformationMatrix.matrix.elements;this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new j([r[0],r[1],r[2],r[3],r[4],this.mPage.size.height>this.rectangle.size.height?this.mTransformationMatrix.matrix.offsetY-this.mPage.size.height%this.rectangle.size.height:this.mPage.size.height%this.rectangle.size.height+this.mTransformationMatrix.matrix.offsetY]))}},e.prototype.setBox=function(t){this.mBox=t;var r=new w(this.mBox.left,this.mBox.top,this.mBox.right,this.mBox.bottom);this.brushStream.items.setValue(this.mDictionaryProperties.bBox,j.fromRectangle(r))},Object.defineProperty(e.prototype,"rectangle",{get:function(){return this.mBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.mBox.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){if(null==this.mGraphics&&void 0===this.mGraphics){var t=new Ot(this),r=new Ct(this.size,t,this.brushStream);this.mGraphics=r,this.mResources=this.getResources(),this.mGraphics.initializeCoordinates()}return this.mGraphics},enumerable:!0,configurable:!0}),e.prototype.getResources=function(){return this.mResources},Object.defineProperty(e.prototype,"stroking",{get:function(){return this.mStroking},set:function(t){this.mStroking=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=this.initialize(this.rectangle,this.mPage,this.location,this.mTransformationMatrix);return null!=this.mTransformationMatrix&&null!=this.mTransformationMatrix.matrix&&t.brushStream.items.setValue(this.mDictionaryProperties.matrix,new j(this.mTransformationMatrix.matrix.elements)),t.brushStream.data=this.tempBrushStream.data,t.mResources=new Ze(this.mResources),t.brushStream.items.setValue(this.mDictionaryProperties.resources,t.mResources),t},e.prototype.monitorChanges=function(t,r,n,s,o){var a=!1;if(t!==this){r.setColorSpace("Pattern",this.mStroking);var l=n.getResources().getName(this);r.setColourWithPattern(null,l,this.mStroking),a=!0}else if(t instanceof e){r.setColorSpace("Pattern",this.mStroking);var f=n.getResources().getName(this);r.setColourWithPattern(null,f,this.mStroking),a=!0}return a},e.prototype.resetChanges=function(t){},Object.defineProperty(e.prototype,"element",{get:function(){return this.brushStream},enumerable:!0,configurable:!0}),e}(oe),Ct=function(){function i(e,t,r){this.currentColorSpace=x.Rgb,this.previousTextRenderingMode=ce.Fill,this.previousCharacterSpacing=0,this.previousWordSpacing=0,this.previousTextScaling=100,this.procedureSets=new Zi,this.isNormalRender=!0,this.isUseFontSize=!1,this.isItalic=!1,this.isEmfTextScaled=!1,this.isEmf=!1,this.isEmfPlus=!1,this.isBaselineFormat=!0,this.emfScalingFactor=new S(0,0),this.colorSpaceChanged=!1,this.dictionaryProperties=new M,this.isOverloadWithPosition=!1,this.isPointOverload=!1,this.currentColorSpaces=["RGB","CMYK","GrayScale","Indexed"],this.isImageOptimized=!1,this.graphicsState=[],this.istransparencySet=!1,this.internalAutomaticFields=null,this.startCutIndex=-1,this.getResources=t,this.canvasSize=e,this.pdfStreamWriter=r instanceof Wt?r:new Wt(r),this.initialize()}return Object.defineProperty(i.prototype,"stringLayoutResult",{get:function(){return this.pdfStringLayoutResult},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.canvasSize},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mediaBoxUpperRightBound",{get:function(){return void 0===this.internalMediaBoxUpperRightBound&&(this.internalMediaBoxUpperRightBound=0),this.internalMediaBoxUpperRightBound},set:function(e){this.internalMediaBoxUpperRightBound=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clientSize",{get:function(){return new S(this.clipBounds.width,this.clipBounds.height)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colorSpace",{get:function(){return this.currentColorSpace},set:function(e){this.currentColorSpace=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"streamWriter",{get:function(){return this.pdfStreamWriter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrix",{get:function(){return null==this.transformationMatrix&&(this.transformationMatrix=new Oe),this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layer",{get:function(){return this.pageLayer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"page",{get:function(){return this.pageLayer.page},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"automaticFields",{get:function(){return(null==this.internalAutomaticFields||void 0===this.internalAutomaticFields)&&(this.internalAutomaticFields=new Qi),this.internalAutomaticFields},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.bStateSaved=!1,this.currentPen=null,this.currentBrush=null,this.currentFont=null,this.currentColorSpace=x.Rgb,this.bCSInitialized=!1,this.transformationMatrix=null,this.previousTextRenderingMode=-1,this.previousCharacterSpacing=-1,this.previousWordSpacing=-1,this.previousTextScaling=-100,this.currentStringFormat=null,this.clipBounds=new w(new b(0,0),this.size),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)},i.prototype.drawPdfTemplate=function(e,t,r){if(void 0===r){if(null==e)throw Error("ArgumentNullException-template");this.drawPdfTemplate(e,t,e.size)}else{if(null==e)throw Error("ArgumentNullException-template");var n=e.width>0?r.width/e.width:1,s=e.height>0?r.height/e.height:1,o=!(1===n&&1===s),a=this.save(),h=new Oe;null!=this.pageLayer&&this.getTranslateTransform(t.x,t.y+r.height,h),o&&this.getScaleTransform(n,s,h),this.pdfStreamWriter.modifyCtm(h);var c=this.getResources.getResources().getName(e);this.pdfStreamWriter.executeObject(c),this.restore(a);var f=e.graphics;if(null!=f)for(var d=0;d<f.automaticFields.automaticFields.length;d++){var p=f.automaticFields.automaticFields[d],v=new b(p.location.x+t.x,p.location.y+t.y);this.automaticFields.add(new Ut(p.field,v,0==e.size.width?0:r.width/e.size.width,0==e.size.height?0:r.height/e.size.height)),this.page.dictionary.modify()}this.getResources.getResources().requireProcedureSet(this.procedureSets.imageB),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageC),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageI),this.getResources.getResources().requireProcedureSet(this.procedureSets.text)}},i.prototype.drawString=function(e,t,r,n,s,o,a,h,l){if("string"==typeof e&&t instanceof re&&(r instanceof Y||null===r)&&(n instanceof oe||null===n)&&"number"==typeof s&&"number"==typeof o&&(a instanceof ye||null===a)&&void 0===h)this.isOverloadWithPosition=!0,this.drawString(e,t,r,n,s,o,this.clientSize.width-s,0,a);else{var c=r,f=n,d=s,p=o,v=a,y=h,P=l,R=(new me).layout(e,t,P,new S(v,y),this.isOverloadWithPosition,this.clientSize);if(!R.empty){var C=this.checkCorrectLayoutRectangle(R.actualSize,d,p,P);v<=0&&(d=C.x,v=C.width),y<=0&&(p=C.y,y=C.height),this.drawStringLayoutResult(R,t,c,f,new w(d,p,v,y),P),this.isEmfTextScaled=!1,this.emfScalingFactor=new S(0,0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),this.isNormalRender=!0,this.pdfStringLayoutResult=R,this.isUseFontSize=!1}},i.prototype.drawLine=function(e,t,r,n,s){if(t instanceof b)this.drawLine(e,(o=t).x,o.y,(a=r).x,a.y);else{var o=t,a=r,h=n,l=s;this.stateControl(e,null,null);var c=this.streamWriter;c.beginPath(o,a),c.appendLineSegment(h,l),c.strokePath(),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)}},i.prototype.drawRectangle=function(e,t,r,n,s,o){if(e instanceof Y&&"number"==typeof t)this.drawRectangle(e,null,t,a=r,n,s);else if(e instanceof oe&&"number"==typeof t)this.drawRectangle(null,e,t,a=r,n,s);else{var a=r,h=n,l=s,c=o;t instanceof Te?(this.bCSInitialized=!1,t.location=new b(this.matrix.matrix.offsetX+a,null!=this.layer&&null!=this.layer.page?this.layer.page.size.height-this.matrix.matrix.offsetY+h:this.clientSize.height-this.matrix.matrix.offsetY+h),t.graphics.colorSpace=this.colorSpace):t instanceof Le&&(t.colorSpace=this.colorSpace),t instanceof pe&&t.color.isEmpty&&(t=null);var p=e,v=t;this.stateControl(p,v,null),this.streamWriter.appendRectangle(a,h,l,c),this.drawPathHelper(p,v,!1)}},i.prototype.drawPathHelper=function(e,t,r,n){if("boolean"==typeof r)this.drawPathHelper(e,t,we.Winding,r);else{var o=null!=e,a=null!=t,h=r===we.Alternate;o&&a?this.streamWriter.fillStrokePath(h):o||a?o?this.streamWriter.strokePath():this.streamWriter.fillPath(h):this.streamWriter.endPath()}},i.prototype.drawImage=function(e,t,r,n,s){if("number"==typeof t&&"number"==typeof r&&void 0===n){var o=e.physicalDimension;this.drawImage(e,t,r,o.width,o.height)}else{var a=t,h=r,l=s;e.save();var c=new Oe;this.getTranslateTransform(a,h+l,c),this.getScaleTransform(n,s,c),this.pdfStreamWriter.write("q"),this.pdfStreamWriter.modifyCtm(c);var f=this.getResources.getResources();void 0!==this.pageLayer&&null!=this.page&&(f.document=this.page.document);var d=f.getName(e);void 0!==this.pageLayer&&this.page.setResources(f),this.pdfStreamWriter.executeObject(d),this.pdfStreamWriter.write(m.restoreState),this.pdfStreamWriter.write(m.newLine);var p=this.getResources.getResources();p.requireProcedureSet(this.procedureSets.imageB),p.requireProcedureSet(this.procedureSets.imageC),p.requireProcedureSet(this.procedureSets.imageI),p.requireProcedureSet(this.procedureSets.text)}},i.prototype.getLineBounds=function(e,t,r,n,s){var o;if(!t.empty&&e<t.lineCount&&e>=0){var a=t.lines[e],l=this.getTextVerticalAlignShift(t.actualSize.height,n.height,s)+n.y+t.lineHeight*e,c=a.width,f=this.getHorizontalAlignShift(c,n.width,s),d=this.getLineIndent(a,s,n,0===e);f+=this.rightToLeft(s)?0:d;var p=n.x+f,v=this.shouldJustify(a,n.width,s)?n.width-d:c-d;o=new w(p,l,v,t.lineHeight)}else o=new w(0,0,0,0);return o},i.prototype.checkCorrectLayoutRectangle=function(e,t,r,n){var s=new w(t,r,e.width,e.width);if(null!=n){switch(n.alignment){case _.Center:s.x-=s.width/2;break;case _.Right:s.x-=s.width}switch(n.lineAlignment){case le.Middle:s.y-=s.height/2;break;case le.Bottom:s.y-=s.height}}return s},i.prototype.setLayer=function(e){this.pageLayer=e;var t=e.page;null!=t&&void 0!==t&&(t.beginSave=this.pageSave)},i.prototype.pageSave=function(e){if(null!=e.graphics.automaticFields)for(var t=0;t<e.graphics.automaticFields.automaticFields.length;t++){var r=e.graphics.automaticFields.automaticFields[t];r.field.performDraw(e.graphics,r.location,r.scalingX,r.scalingY)}},i.prototype.drawStringLayoutResult=function(e,t,r,n,s,o){if(e.empty)throw new Error("ArgumentNullException:result");this.applyStringSettings(t,r,n,o,s);var a=null!=o?o.horizontalScalingFactor:100;a!==this.previousTextScaling&&!this.isEmfTextScaled&&(this.pdfStreamWriter.setTextScaling(a),this.previousTextScaling=a);var c,h=null==o||0===o.lineSpacing?t.height:o.lineSpacing+t.height;c=null!=o&&o.subSuperScript===ge.SubScript?h-(t.height+t.metrics.getDescent(o)):h-t.metrics.getAscent(o),this.shift=c,this.pdfStreamWriter.startNextLine(s.x,s.y-c),this.pdfStreamWriter.setLeading(+h);for(var f=0,d="",p=0;p<e.lines.length;p++)if(s.y+(f+=e.lineHeight)>this.clientSize.height){this.startCutIndex=p;break}for(var v=this.startCutIndex;v<e.lines.length&&v>=0;v++)d+=e.lines[v].text;var y=new w(s.x,s.y,s.width,s.height);this.drawLayoutResult(e,t,o,s),this.underlineStrikeoutText(r,n,e,t,y,o),this.isEmfPlus=!1,this.isUseFontSize=!1,-1!==this.startCutIndex&&this.getNextPage().graphics.drawString(d,t,r,n,s.x,0,s.width,0,o)},i.prototype.getNextPage=function(){var e=this.currentPage.section,r=e.indexOf(this.currentPage);return r===e.count-1?e.add():e.getPages()[r+1]},i.prototype.setClip=function(e,t){void 0===t?this.setClip(e,we.Winding):(this.pdfStreamWriter.appendRectangle(e),this.pdfStreamWriter.clipPath(t===we.Alternate))},i.prototype.applyStringSettings=function(e,t,r,n,s){r instanceof Te?(this.bCSInitialized=!1,r.graphics.colorSpace=this.colorSpace):r instanceof Le&&(this.bCSInitialized=!1,r.colorSpace=this.colorSpace);var o=this.getTextRenderingMode(t,r,n);this.stateControl(t,r,e,n),this.pdfStreamWriter.beginText(),o!==this.previousTextRenderingMode&&(this.pdfStreamWriter.setTextRenderingMode(o),this.previousTextRenderingMode=o);var a=null!=n?n.characterSpacing:0;a!==this.previousCharacterSpacing&&!this.isEmfTextScaled&&(this.pdfStreamWriter.setCharacterSpacing(a),this.previousCharacterSpacing=a);var h=null!=n?n.wordSpacing:0;h!==this.previousWordSpacing&&(this.pdfStreamWriter.setWordSpacing(h),this.previousWordSpacing=h)},i.prototype.getTextVerticalAlignShift=function(e,t,r){var n=0;if(t>=0&&null!=r&&r.lineAlignment!==le.Top)switch(r.lineAlignment){case le.Middle:n=(t-e)/2;break;case le.Bottom:n=t-e}return n},i.prototype.drawLayoutResult=function(e,t,r,n){var s=this.getTextVerticalAlignShift(e.actualSize.height,n.height,r);0!==s&&this.pdfStreamWriter.startNextLine(0,s);for(var a=null!=t&&t.isUnicode,l=e.lines,c=0,f=l.length;c<f&&c!==this.startCutIndex;c++){var d=l[c],y=this.getHorizontalAlignShift(d.width,n.width,r),P=this.getLineIndent(d,r,n,0===c);0!==(y+=this.rightToLeft(r)?0:P)&&!this.isEmfTextScaled&&this.pdfStreamWriter.startNextLine(y,0),a?this.drawUnicodeLine(d,n,t,r):this.drawAsciiLine(d,n,t,r),0!==y&&!this.isEmfTextScaled&&this.pdfStreamWriter.startNextLine(-y,0),this.isOverloadWithPosition&&l.length>1&&(this.pdfStreamWriter.startNextLine(-n.x,0),n.x=0,n.width=this.clientSize.width,this.isOverloadWithPosition=!1,this.isPointOverload=!0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),0!==s&&this.pdfStreamWriter.startNextLine(0,-(s-e.lineHeight)),this.pdfStreamWriter.endText()},i.prototype.drawAsciiLine=function(e,t,r,n){this.justifyLine(e,t.width,n);var s="";if(-1!==e.text.indexOf("(")||-1!==e.text.indexOf(")"))for(var o=0;o<e.text.length;o++)s+="("===e.text[o]?"\\(":")"===e.text[o]?"\\)":e.text[o];""===s&&(s=e.text),this.pdfStreamWriter.showNextLineText(new U("("+s+")"))},i.prototype.drawUnicodeLine=function(e,t,r,n){var s=e.text,a=null!=n&&n.rightToLeft,h=null!=n&&(0!==n.wordSpacing||n.alignment===_.Justify),l=r,c=this.justifyLine(e,t.width,n),f=new Zt;if(a||null!=n&&n.textDirection!==te.None){var d=null,p=null!=n&&n.alignment===_.Right,v=null;v=(d=f.layout(s,l,null!=n&&n.textDirection!==te.None?n.textDirection===te.RightToLeft:p,h,n)).length>1?f.splitLayout(s,l,null!=n&&n.textDirection!==te.None?n.textDirection===te.RightToLeft:p,h,n):[s],this.drawUnicodeBlocks(d,v,l,n,c)}else if(h){var y=this.breakUnicodeLine(s,l,null);this.drawUnicodeBlocks(d=y.tokens,v=y.words,l,n,c)}else{var P=this.convertToUnicode(s,l),V=this.getUnicodeString(P);this.streamWriter.showNextLineText(V)}},i.prototype.drawUnicodeBlocks=function(e,t,r,n,s){if(null==e)throw new Error("Argument Null Exception : blocks");if(null==t)throw new Error("Argument Null Exception : words");if(null==r)throw new Error("Argument Null Exception : font");this.streamWriter.startNextLine();var o=0,a=0,h=0,l=0;try{null!=n&&(h=n.firstLineIndent,l=n.paragraphIndent,n.firstLineIndent=0,n.paragraphIndent=0);var c=r.getCharWidth(ee.whiteSpace,n)+s,f=null!=n?n.characterSpacing:0;c+=f+(null!=n&&0===s?n.wordSpacing:0);for(var p=0;p<e.length;p++){var v=e[p],y=t[p],P=0;if(0!==o&&this.streamWriter.startNextLine(o,0),y.length>0){P+=r.measureString(y,n).width,P+=f;var V=this.getUnicodeString(v);this.streamWriter.showText(V)}p!==e.length-1&&(a+=o=P+c)}a>0&&this.streamWriter.startNextLine(-a,0)}finally{null!=n&&(n.firstLineIndent=h,n.paragraphIndent=l)}},i.prototype.breakUnicodeLine=function(e,t,r){if(null===e)throw new Error("Argument Null Exception : line");r=e.split(null);for(var n=[],s=0;s<r.length;s++){var a=this.convertToUnicode(r[s],t);n[s]=a}return{tokens:n,words:r}},i.prototype.getUnicodeString=function(e){if(null===e)throw new Error("Argument Null Exception : token");var t=new U(e);return t.converted=!0,t.encode=_e.ForceEncoding.Ascii,t},i.prototype.convertToUnicode=function(e,t){var r=null;if(null==e)throw new Error("Argument Null Exception : text");if(null==t)throw new Error("Argument Null Exception : ttfFont");if(t.fontInternal instanceof Pt){var n=t.fontInternal.ttfReader;t.setSymbols(e),r=n.convertString(e);var s=U.toUnicodeArray(r,!1);r=U.byteToString(s)}return r},i.prototype.justifyLine=function(e,t,r){var n=e.text,s=e.width,o=this.shouldJustify(e,t,r),a=null!=r&&0!==r.wordSpacing,l=ee.getCharsCount(n,ee.spaces),c=0;return o?(a&&(s-=l*r.wordSpacing),this.pdfStreamWriter.setWordSpacing(c=(t-s)/l)):this.pdfStreamWriter.setWordSpacing(a?r.wordSpacing:0),c},i.prototype.reset=function(e){this.canvasSize=e,this.streamWriter.clear(),this.initialize(),this.initializeCoordinates()},i.prototype.shouldJustify=function(e,t,r){var n=e.text,o=null!=r&&r.alignment===_.Justify,a=t>=0&&e.width<t,l=ee.getCharsCount(n,ee.spaces);return o&&a&&l>0&&n[0]!==ee.whiteSpace&&((e.lineType&ie.LayoutBreak)>0||r.alignment===_.Justify)},i.prototype.underlineStrikeoutText=function(e,t,r,n,s,o){if(n.underline||n.strikeout){var a=this.createUnderlineStikeoutPen(e,t,n,o);if(null!=a){var h=this.getTextVerticalAlignShift(r.actualSize.height,s.height,o),l=0;l=s.y+h+n.metrics.getAscent(o)+1.5*a.width;for(var c=s.y+h+n.metrics.getHeight(o)/2+1.5*a.width,f=r.lines,d=0,p=r.lineCount;d<p;d++){var v=f[d],P=v.width,V=this.getHorizontalAlignShift(P,s.width,o),R=this.getLineIndent(v,o,s,0===d);V+=this.rightToLeft(o)?0:R;var T,C=s.x+V,H=this.shouldJustify(v,s.width,o)?C+s.width-R:C+P-R;n.underline&&(this.drawLine(a,C,T=l,H,T),l+=r.lineHeight),n.strikeout&&(this.drawLine(a,C,T=c,H,T),c+=r.lineHeight),this.isPointOverload&&f.length>1&&(s.x=0,s.width=this.clientSize.width)}this.isPointOverload=!1}}},i.prototype.createUnderlineStikeoutPen=function(e,t,r,n){var s=r.metrics.getSize(n)/20,o=null;return null!=e?o=new Y(e.color,s):null!=t&&(o=new Y(t,s)),o},i.prototype.getTextRenderingMode=function(e,t,r){var n=ce.None;return n=null!=e&&null!=t?ce.FillStroke:null!=e?ce.Stroke:ce.Fill,null!=r&&r.clipPath&&(n|=ce.ClipFlag),n},i.prototype.getLineIndent=function(e,t,r,n){var s=0;return null!=t&&(e.lineType&ie.FirstParagraphLine)>0&&(s=n?t.firstLineIndent:t.paragraphIndent,s=r.width>0?Math.min(r.width,s):s),s},i.prototype.getHorizontalAlignShift=function(e,t,r){var n=0;if(t>=0&&null!=r&&r.alignment!==_.Left)switch(r.alignment){case _.Center:n=(t-e)/2;break;case _.Right:n=t-e}return n},i.prototype.rightToLeft=function(e){var t=null!=e&&e.rightToLeft;return null!=e&&e.textDirection!==te.None&&void 0!==e.textDirection&&(t=!0),t},i.prototype.stateControl=function(e,t,r,n){if(void 0===n)this.stateControl(e,t,r,null);else{t instanceof Le&&(this.bCSInitialized=!1,t.colorSpace=this.colorSpace),t instanceof Te&&(this.bCSInitialized=!1,t.graphics.colorSpace=this.colorSpace);var s=!1;null!==t?(void 0!==this.pageLayer&&null!=this.pageLayer&&!1===this.colorSpaceChanged&&(this.lastDocumentCS=this.pageLayer.page.document.colorSpace,this.lastGraphicsCS=this.pageLayer.page.graphics.colorSpace,this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace,this.colorSpaceChanged=!0),this.initCurrentColorSpace(this.currentColorSpace)):null!=e&&(void 0!==this.pageLayer&&null!=this.pageLayer&&(this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace),this.initCurrentColorSpace(this.currentColorSpace)),this.penControl(e,s),this.brushControl(t,s),this.fontControl(r,n,s)}},i.prototype.initCurrentColorSpace=function(e){this.getResources.getResources(),this.bCSInitialized||(this.currentColorSpace!=x.GrayScale?(this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!0),this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!1),this.bCSInitialized=!0):(this.pdfStreamWriter.setColorSpace("DeviceGray",!0),this.pdfStreamWriter.setColorSpace("DeviceGray",!1),this.bCSInitialized=!0))},i.prototype.penControl=function(e,t){null!=e&&(this.currentPen=e,e.monitorChanges(this.currentPen,this.pdfStreamWriter,this.getResources,t,this.colorSpace,this.matrix.clone()),this.currentPen=e.clone())},i.prototype.brushControl=function(e,t){if(null!=e&&void 0!==e){var r=e.clone(),n=r;if(!(null==n||e instanceof pe||e instanceof Te)){var s=n.matrix,o=this.matrix.clone();null!=s&&(s.multiply(o),o=s),n.matrix=o}this.currentBrush=n,r.monitorChanges(this.currentBrush,this.pdfStreamWriter,this.getResources,t,this.colorSpace),this.currentBrush=e,e=null}},i.prototype.fontControl=function(e,t,r){if(null!=e&&(r||e!==this.currentFont||(null!=t?t.subSuperScript:ge.None)!==(null!=this.currentStringFormat?this.currentStringFormat.subSuperScript:ge.None))){var o=this.getResources.getResources();this.currentFont=e,this.currentStringFormat=t;var a=e.metrics.getSize(t);this.isEmfTextScaled=!1;var h=o.getName(e);this.pdfStreamWriter.setFont(e,h,a)}},i.prototype.setTransparency=function(e,t,r){if(void 0===t)this.istransparencySet=!0,this.setTransparency(e,e,ze.Normal);else if("number"==typeof t&&void 0===r)this.setTransparency(e,t,ze.Normal);else{null==this.trasparencies&&(this.trasparencies=new Ue);var n=null,s=new xr(e,t,r);this.trasparencies.containsKey(s)&&(n=this.trasparencies.getValue(s)),null==n&&(n=new wt(e,t,r),this.trasparencies.setValue(s,n));var a=this.getResources.getResources().getName(n);this.streamWriter.setGraphicsState(a)}},i.prototype.clipTranslateMargins=function(e,t,r,n,s,o){if(e instanceof w&&void 0===t)this.clipBounds=e,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(e),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(e.x,e.y);else if("number"==typeof e){var a=new w(r,n,this.size.width-r-s,this.size.height-n-o);this.clipBounds=a,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(a),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(e,t)}},i.prototype.updateY=function(e){return-e},i.prototype.translateTransform=function(e,t){var r=new Oe;this.getTranslateTransform(e,t,r),this.pdfStreamWriter.modifyCtm(r),this.matrix.multiply(r)},i.prototype.getTranslateTransform=function(e,t,r){return r.translate(e,this.updateY(t)),r},i.prototype.scaleTransform=function(e,t){var r=new Oe;this.getScaleTransform(e,t,r),this.pdfStreamWriter.modifyCtm(r),this.matrix.multiply(r)},i.prototype.getScaleTransform=function(e,t,r){return null==r&&(r=new Oe),r.scale(e,t),r},i.prototype.rotateTransform=function(e){var t=new Oe;this.getRotateTransform(e,t),this.pdfStreamWriter.modifyCtm(t),this.matrix.multiply(t)},i.prototype.initializeCoordinates=function(){this.pdfStreamWriter.writeComment("Change co-ordinate system to left/top."),this.mediaBoxUpperRightBound!==-this.size.height&&null==this.cropBox&&this.translateTransform(0,this.updateY(this.mediaBoxUpperRightBound===this.size.height||0===this.mediaBoxUpperRightBound?this.size.height:this.mediaBoxUpperRightBound))},i.prototype.getRotateTransform=function(e,t){return(null==t||void 0===t)&&(t=new Oe),t.rotate(this.updateY(e)),t},i.prototype.save=function(){var e=new Or(this,this.matrix.clone());return e.brush=this.currentBrush,e.pen=this.currentPen,e.font=this.currentFont,e.colorSpace=this.currentColorSpace,e.characterSpacing=this.previousCharacterSpacing,e.wordSpacing=this.previousWordSpacing,e.textScaling=this.previousTextScaling,e.textRenderingMode=this.previousTextRenderingMode,this.graphicsState.push(e),this.pdfStreamWriter.saveGraphicsState(),e},i.prototype.restore=function(e){if(void 0===e)this.graphicsState.length>0&&this.doRestoreState();else if(-1!==this.graphicsState.indexOf(e))for(;0!==this.graphicsState.length&&this.doRestoreState()!==e;);},i.prototype.doRestoreState=function(){var e=this.graphicsState.pop();return this.transformationMatrix=e.matrix,this.currentBrush=e.brush,this.currentPen=e.pen,this.currentFont=e.font,this.currentColorSpace=e.colorSpace,this.previousCharacterSpacing=e.characterSpacing,this.previousWordSpacing=e.wordSpacing,this.previousTextScaling=e.textScaling,this.previousTextRenderingMode=e.textRenderingMode,this.pdfStreamWriter.restoreGraphicsState(),e},i.prototype.drawPath=function(e,t,r){t instanceof Te?(this.bCSInitialized=!1,t.graphics.colorSpace=this.colorSpace):t instanceof Le&&(this.bCSInitialized=!1,t.colorSpace=this.colorSpace),this.stateControl(e,t,null),this.buildUpPath(r.pathPoints,r.pathTypes),this.drawPathHelper(e,t,r.fillMode,!1)},i.prototype.drawArc=function(e,t,r,n,s,o,a){t instanceof w?this.drawArc(e,t.x,t.y,t.width,t.height,r,n):0!==a&&(this.stateControl(e,null,null),this.constructArcPath(t,r,t+n,r+s,o,a),this.drawPathHelper(e,null,!1))},i.prototype.buildUpPath=function(e,t){for(var r=e.length,n=0;n<r;++n){var o=e[n];switch(t[n]&i.pathTypesValuesMask){case G.Start:this.pdfStreamWriter.beginPath(o.x,o.y);break;case G.Bezier3:var a=new b(0,0),h=new b(0,0),l=this.getBezierPoints(e,t,n,a,h);this.pdfStreamWriter.appendBezierSegment(o,l.p2,l.p3),n=l.i;break;case G.Line:this.pdfStreamWriter.appendLineSegment(o);break;default:throw new Error("ArithmeticException - Incorrect path formation.")}this.checkFlags(t[n])}},i.prototype.getBezierPoints=function(e,t,r,n,s){if((t[++r]&i.pathTypesValuesMask)!==G.Bezier3)throw new Error("ArgumentException : errorMsg");if(n=e[r],(t[++r]&i.pathTypesValuesMask)!==G.Bezier3)throw new Error("ArgumentException : errorMsg");return{i:r,p2:n,p3:e[r]}},i.prototype.checkFlags=function(e){(e&G.CloseSubpath)===G.CloseSubpath&&this.pdfStreamWriter.closePath()},i.prototype.constructArcPath=function(e,t,r,n,s,o){var a=this.getBezierArc(e,t,r,n,s,o);if(0!==a.length){var h=[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];this.pdfStreamWriter.beginPath(h[0],h[1]);var l=0;for(l=0;l<a.length;l+=8)this.pdfStreamWriter.appendBezierSegment((h=[a[l],a[l+1],a[l+2],a[l+3],a[l+4],a[l+5],a[l+6],a[l+7]])[2],h[3],h[4],h[5],h[6],h[7])}},i.prototype.getBezierArc=function(e,t,r,n,s,o){if(e>r){var a=void 0;a=e,e=r,r=a}var h,l;n>t&&(a=void 0,a=t,t=n,n=a),Math.abs(o)<=90?(h=o,l=1):h=o/(l=Math.ceil(Math.abs(o)/90));for(var c=(e+r)/2,f=(t+n)/2,d=(r-e)/2,p=(n-t)/2,v=h*(Math.PI/360),y=Math.abs(4/3*(1-Math.cos(v))/Math.sin(v)),P=[],V=0;V<l;V++){var R=(s+V*h)*(Math.PI/180),C=(s+(V+1)*h)*(Math.PI/180),H=Math.cos(R),T=Math.cos(C),A=Math.sin(R),z=Math.sin(C);h>0?P.push(c+d*H,f-p*A,c+d*(H-y*A),f-p*(A+y*H),c+d*(T+y*z),f-p*(z-y*T),c+d*T,f-p*z):P.push(c+d*H,f-p*A,c+d*(H+y*A),f-p*(A-y*H),c+d*(T-y*z),f-p*(z+y*T),c+d*T,f-p*z)}return P},i.pathTypesValuesMask=15,i.transparencyObject=!1,i}(),Ot=function(){function i(e){this.sender=e}return i.prototype.getResources=function(){return this.sender.getResources()},i}(),Or=function(){function i(e,t){this.internalTextRenderingMode=ce.Fill,this.internalCharacterSpacing=0,this.internalWordSpacing=0,this.internalTextScaling=100,this.pdfColorSpace=x.Rgb,void 0!==e&&(this.pdfGraphics=e,this.transformationMatrix=t)}return Object.defineProperty(i.prototype,"graphics",{get:function(){return this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrix",{get:function(){return this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"characterSpacing",{get:function(){return this.internalCharacterSpacing},set:function(e){this.internalCharacterSpacing=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wordSpacing",{get:function(){return this.internalWordSpacing},set:function(e){this.internalWordSpacing=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textScaling",{get:function(){return this.internalTextScaling},set:function(e){this.internalTextScaling=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pen",{get:function(){return this.pdfPen},set:function(e){this.pdfPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"brush",{get:function(){return this.pdfBrush},set:function(e){this.pdfBrush=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"font",{get:function(){return this.pdfFont},set:function(e){this.pdfFont=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(e){this.pdfColorSpace=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textRenderingMode",{get:function(){return this.internalTextRenderingMode},set:function(e){this.internalTextRenderingMode=e},enumerable:!0,configurable:!0}),i}(),xr=function(){return function(e,t,r){this.alphaPen=e,this.alphaBrush=t,this.blendMode=r}}(),ht=function(){function i(e,t){if(this.pdfColorSpace=x.Rgb,this.isVisible=!0,this.sublayer=!1,this.contentLength=0,this.dictionaryProperties=new M,null===e)throw new Error("ArgumentNullException:page");if(this.pdfPage=e,this.clipPageTemplates=!0,void 0===t)this.content=new J;else if(t instanceof J||null===t){if(null===t)throw new Error("ArgumentNullException:stream");this.content=t}else this.content=new J,this.clipPageTemplates=t}return Object.defineProperty(i.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(e){this.pdfColorSpace=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layerId",{get:function(){return this.layerid},set:function(e){this.layerid=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this.layerName},set:function(e){this.layerName=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this.isVisible},set:function(e){this.isVisible=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"graphics",{get:function(){return null==this.pdfGraphics&&this.initializeGraphics(this.page),this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layers",{get:function(){return null==this.layer?(this.layer=new Qt(this.page),this.layer.sublayer=!0,this.layer):this.layer},enumerable:!0,configurable:!0}),i.prototype.add=function(){var e=new i(this.pdfPage);return e.name="",e},i.prototype.sign=function(e){return 0===e?0:e>0?1:-1},i.prototype.initializeGraphics=function(e){var t=e,r=new Ot(this.page);if(this.pdfGraphics=new Ct(e.size,r,this.content),this.pdfGraphics.mediaBoxUpperRightBound=0,null!=t){var n=t.section.parent;null!=n&&(this.pdfGraphics.colorSpace=n.document.colorSpace,this.colorSpace=n.document.colorSpace)}var s=this.sign(e.origin.y)===this.sign(e.origin.x);(e.origin.x>=0&&e.origin.y>=0||!s)&&this.pdfGraphics.initializeCoordinates();var o=t.section.getActualBounds(t,!0),a=t.section.pageSettings.margins;this.clipPageTemplates?e.origin.x>=0&&e.origin.y>=0&&this.pdfGraphics.clipTranslateMargins(o):this.graphics.clipTranslateMargins(o.x,o.y,a.left,a.top,a.right,a.bottom),this.pdfGraphics.setLayer(this)},Object.defineProperty(i.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),i}(),Lr=function(){function i(){}return Object.defineProperty(i.prototype,"count",{get:function(){return void 0===this.collection&&(this.collection=[]),this.collection.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"list",{get:function(){return void 0===this.collection&&(this.collection=[]),this.collection},enumerable:!0,configurable:!0}),i}(),Vr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Qt=function(i){function e(t){var r=i.call(this)||this;return r.parentLayerCount=0,r.sublayer=!1,r.optionalContent=new F,t instanceof Kt&&(r.page=t,r.parseLayers(t)),r}return Vr(e,i),e.prototype.items=function(t,r){if("number"==typeof t&&void 0===r)return this.list[t];if(null==r)throw new Error("ArgumentNullException: layer");if(r.page!==this.page)throw new Error("ArgumentException: The layer belongs to another page")},e.prototype.add=function(t,r){if(void 0===t){var n=new ht(this.page);return n.name="",this.add(n),n}if(t instanceof ht){var s=this.list.push(t);return this.addLayer(s,t),s}return 0},e.prototype.addLayer=function(t,r){var n=new N(r);this.page.contents.add(n)},e.prototype.insert=function(t,r){for(var n=[],s=this.list.length,o=t;o<s;o++)n.push(this.list.pop());for(this.list.push(r),o=0;o<n.length;o++)this.list.push(n[o]);this.insertLayer(t,r)},e.prototype.insertLayer=function(t,r){if(null==r)throw new Error("ArgumentNullException:layer");var n=new N(r);this.page.contents.insert(t,n)},e.prototype.parseLayers=function(t){var r=this.page.contents;this.page.getResources();var o=new J,a=new J,c=[];c.push("q"),o.data=c,r.insert(0,new N(o)),(c=[]).push("Q"),a.data=c,r.insert(r.count,new N(a))},e.prototype.indexOf=function(t){if(null==t)throw new Error("ArgumentNullException: layer");return this.list.indexOf(t)},e}(Lr),Kt=function(){function i(e){this.defLayerIndex=-1,this.modified=!1,this.dictionaryProperties=new M,this.pageDictionary=e}return Object.defineProperty(i.prototype,"section",{get:function(){return this.pdfSection},set:function(e){this.pdfSection=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dictionary",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultLayer",{get:function(){return this.layers.items(this.defaultLayerIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultLayerIndex",{get:function(){if(0===this.layerCollection.count||-1===this.defLayerIndex){var e=this.layerCollection.add();this.defLayerIndex=this.layerCollection.indexOf(e)}return this.defLayerIndex},set:function(e){if(e<0||e>this.layers.count-1)throw new Error("ArgumentOutOfRangeException : value, Index can not be less 0 and greater Layers.Count - 1");this.defLayerIndex=e,this.modified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layers",{get:function(){return(null==this.layerCollection||void 0===this.layerCollection)&&(this.layerCollection=new Qt(this)),this.layerCollection},enumerable:!0,configurable:!0}),i.prototype.getResources=function(){return null==this.resources&&(this.resources=new Ze,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},Object.defineProperty(i.prototype,"contents",{get:function(){var t=this.pageDictionary.items.getValue(this.dictionaryProperties.contents);return null==t&&(t=new j,this.pageDictionary.items.setValue(this.dictionaryProperties.contents,t)),t},enumerable:!0,configurable:!0}),i.prototype.setResources=function(e){this.resources=e,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources),this.modified=!0},i}(),kr=function(){function i(e){this.alreadyExistsAnnotationError="This annotatation had been already added to page",this.missingAnnotationException="Annotation is not contained in collection.",this.dictionaryProperties=new M,this.internalAnnotations=new j,this.lists=[],void 0!==e&&(this.page=e)}return Object.defineProperty(i.prototype,"annotations",{get:function(){return this.internalAnnotations},set:function(e){this.internalAnnotations=e},enumerable:!0,configurable:!0}),i.prototype.add=function(e){this.doAdd(e)},i.prototype.doAdd=function(e){if(void 0===e.destination)return e.setPage(this.page),this.internalAnnotations.add(new N(e)),this.lists.push(e);var r=(new me).layout(e.text,e.font,e.stringFormat,new S(e.bounds.width,0),!1,new S(0,0)),n=e.bounds.y;if(1===r.lines.length){var s=e.font.measureString(r.lines[0].text);e.bounds=new w(new b(e.bounds.x,n),s),e.text=r.lines[0].text,this.page.graphics.drawString(e.text,e.font,null,e.brush,e.bounds.x,e.bounds.y,e.bounds.width,e.bounds.height,null),e.setPage(this.page),this.setColor(e),this.internalAnnotations.add(new N(e)),this.lists.push(e)}else for(var o=0;o<r.lines.length;o++)if(s=e.font.measureString(r.lines[o].text),0===o)e.bounds=new w(e.bounds.x,n,s.width,s.height),e.text=r.lines[o].text,this.page.graphics.drawString(e.text,e.font,null,e.brush,e.bounds.x,n,s.width,s.height,null),e.setPage(this.page),this.setColor(e),this.internalAnnotations.add(new N(e)),this.lists.push(e),n+=e.bounds.height;else{var a=e.clone();a.bounds=new w(new b(e.bounds.x,n),s),a.text=r.lines[o].text,this.page.graphics.drawString(a.text,a.font,null,a.brush,a.bounds.x,a.bounds.y,a.bounds.width,a.bounds.height,null),a.setPage(this.page),this.setColor(a),this.internalAnnotations.add(new N(a)),this.lists.push(a),n+=a.bounds.height}},i.prototype.setColor=function(e){var r=e.color.toArray(x.Rgb);e.dictionary.items.setValue(this.dictionaryProperties.c,r)},Object.defineProperty(i.prototype,"element",{get:function(){return this.internalAnnotations},enumerable:!0,configurable:!0}),i}(),Fr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),de=function(i){function e(){var t=i.call(this,new F)||this;return t.annotationCollection=null,t.beginSave=null,t.initialize(),t}return Fr(e,i),Object.defineProperty(e.prototype,"document",{get:function(){return null!==this.section&&null!==this.section.parent?this.section.parent.document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){var t=this.defaultLayer.graphics;return t.currentPage=this,t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crossTable",{get:function(){if(null===this.section)throw new Error("PdfDocumentException : Page is not created");return null===this.section.parent?this.section.parentDocument.crossTable:this.section.parent.document.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.section.pageSettings.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this.section.pageSettings.origin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"annotations",{get:function(){return null==this.annotationCollection&&(this.annotationCollection=new kr(this),this.dictionary.items.setValue(this.dictionaryProperties.annots,this.annotationCollection.element),this.annotationCollection.annotations=this.dictionary.items.getValue(this.dictionaryProperties.annots)),this.annotationCollection},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.dictionary.items.setValue(this.dictionaryProperties.type,new O("Page")),this.dictionary.pageBeginDrawTemplate=new Ni(this)},e.prototype.setSection=function(t){this.section=t,this.dictionary.items.setValue(this.dictionaryProperties.parent,new N(t))},e.prototype.resetProgress=function(){this.isProgressOn=!1},e.prototype.getClientSize=function(){var t=this.section.getActualBounds(this,!0);return new S(t.width,t.height)},e.prototype.pageBeginSave=function(){var t=this.document;void 0!==typeof t&&null!=t&&this.drawPageTemplates(t),null!=this.beginSave&&void 0!==this.beginSave&&this.beginSave(this)},e.prototype.drawPageTemplates=function(t){if(this.section.containsTemplates(t,this,!1)){var n=new ht(this,!1);if(this.layers.insert(0,n),this.section.drawTemplates(this,n,t,!1),null!=n.graphics)for(var s=0;s<n.graphics.automaticFields.automaticFields.length;s++){var o=n.graphics.automaticFields.automaticFields[s];o.field.performDraw(n.graphics,o.location,o.scalingX,o.scalingY)}}if(this.section.containsTemplates(t,this,!0)){var h=new ht(this,!1);this.layers.add(h),this.section.drawTemplates(this,h,t,!0)}},e}(Kt),ei=function(){function i(e){this.pdfPage=void 0!==e?e:null}return Object.defineProperty(i.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),i}(),jr=function(){function i(e){if(this.pdfSection=null,null==e)throw Error('ArgumentNullException("section")');this.section=e}return Object.defineProperty(i.prototype,"section",{get:function(){return this.pdfSection},set:function(e){this.pdfSection=e},enumerable:!0,configurable:!0}),i.prototype.contains=function(e){return this.section.contains(e)},i.prototype.remove=function(e){this.section.remove(e)},i.prototype.add=function(){return this.section.add()},i}(),ti=function(){function i(){}return Object.defineProperty(i.prototype,"left",{get:function(){return this.leftTemplate},set:function(e){this.leftTemplate=this.checkElement(e,k.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.topTemplate},set:function(e){this.topTemplate=this.checkElement(e,k.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.rightTemplate},set:function(e){this.rightTemplate=this.checkElement(e,k.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.bottomTemplate},set:function(e){this.bottomTemplate=this.checkElement(e,k.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenLeft",{get:function(){return this.evenLeft},set:function(e){this.evenLeft=this.checkElement(e,k.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenTop",{get:function(){return this.evenTop},set:function(e){this.evenTop=this.checkElement(e,k.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenRight",{get:function(){return this.evenRight},set:function(e){this.evenRight=this.checkElement(e,k.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenBottom",{get:function(){return this.evenBottom},set:function(e){this.evenBottom=this.checkElement(e,k.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OddLeft",{get:function(){return this.oddLeft},set:function(e){this.oddLeft=this.checkElement(e,k.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OddTop",{get:function(){return this.oddTop},set:function(e){this.oddTop=this.checkElement(e,k.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OddRight",{get:function(){return this.oddRight},set:function(e){this.oddRight=this.checkElement(e,k.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OddBottom",{get:function(){return this.oddBottom},set:function(e){this.oddBottom=this.checkElement(e,k.Bottom)},enumerable:!0,configurable:!0}),i.prototype.getLeft=function(e){if(null==e)throw new Error("ArgumentNullException:page");return this.isEven(e)?null!=this.EvenLeft?this.EvenLeft:this.left:null!=this.OddLeft?this.OddLeft:this.left},i.prototype.getTop=function(e){if(null==e)throw new Error("ArgumentNullException:page");return this.isEven(e)?null!=this.EvenTop?this.EvenTop:this.top:null!=this.OddTop?this.OddTop:this.top},i.prototype.getRight=function(e){if(null==e)throw new Error("ArgumentNullException:page");return this.isEven(e)?null!=this.EvenRight?this.EvenRight:this.right:null!=this.OddRight?this.OddRight:this.right},i.prototype.getBottom=function(e){if(null==e)throw new Error("ArgumentNullException:page");return this.isEven(e)?null!=this.EvenBottom?this.EvenBottom:this.bottom:null!=this.OddBottom?this.OddBottom:this.bottom},i.prototype.isEven=function(e){var t=e.section.document.pages;return(t.pageCollectionIndex.containsKey(e)?t.pageCollectionIndex.getValue(e)+1:t.indexOf(e)+1)%2==0},i.prototype.checkElement=function(e,t){if(null!=e){if(void 0!==e.type&&e.type!==k.None)throw new Error("NotSupportedException:Can not reassign the template element. Please, create new one.");e.type=t}return e},i}(),Er=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Tr=function(i){function e(){var t=i.call(this)||this;return t.leftValue=t.topValue=t.rightValue=t.bottomValue=t.stampValue=!0,t}return Er(e,i),Object.defineProperty(e.prototype,"applyDocumentLeftTemplate",{get:function(){return this.leftValue},set:function(t){this.leftValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentTopTemplate",{get:function(){return this.topValue},set:function(t){this.topValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentRightTemplate",{get:function(){return this.rightValue},set:function(t){this.rightValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentBottomTemplate",{get:function(){return this.bottomValue},set:function(t){this.bottomValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentStamps",{get:function(){return this.stampValue},set:function(t){this.stampValue=t},enumerable:!0,configurable:!0}),e}(ti),Rr=function(){function i(e,t){this.pageAdded=new ei,this.pdfPages=[],this.dictionaryProperties=new M,this.pdfDocument=e,void 0===t?(this.settings=e.pageSettings.clone(),this.initialSettings=this.settings.clone()):(this.settings=t.clone(),this.initialSettings=this.settings.clone()),this.initialize()}return Object.defineProperty(i.prototype,"parent",{get:function(){return this.sectionCollection},set:function(e){this.sectionCollection=e,this.section.items.setValue(this.dictionaryProperties.parent,new N(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentDocument",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageSettings",{get:function(){return this.settings},set:function(e){if(null==e)throw Error("Value can not be null.");this.settings=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.section},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"count",{get:function(){return this.pagesReferences.count},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"template",{get:function(){return null==this.pageTemplate&&(this.pageTemplate=new Tr),this.pageTemplate},set:function(e){this.pageTemplate=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"document",{get:function(){return this.sectionCollection.document},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pages",{get:function(){return(null==this.pagesCollection||void 0===this.pagesCollection)&&(this.pagesCollection=new jr(this)),this.pagesCollection},enumerable:!0,configurable:!0}),i.prototype.getPages=function(){return this.pdfPages},i.prototype.pointToNativePdf=function(e,t){var r=this.getActualBounds(e,!0);return t.x+=r.x,t.y=this.pageSettings.height-t.y,t},i.prototype.setPageSettings=function(e){this.settings=e,this.state.orientation=e.orientation,this.state.rotate=e.rotate,this.state.size=e.size,this.state.origin=e.origin},i.prototype.initialize=function(){this.pagesReferences=new j,this.section=new F,this.state=new Nr(this.pdfDocument),this.section.sectionBeginSave=new Ri(this,this.state),this.pageCount=new B(0),this.section.items.setValue(this.dictionaryProperties.count,this.pageCount),this.section.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.pages)),this.section.items.setValue(this.dictionaryProperties.kids,this.pagesReferences)},i.prototype.containsTemplates=function(e,t,r){var n=this.getDocumentTemplates(e,t,r),s=this.getSectionTemplates(t,r);return n.length>0||s.length>0},i.prototype.getDocumentTemplates=function(e,t,r){var n=[];return this.template.applyDocumentTopTemplate&&null!=e.template.getTop(t)&&(!(e.template.getTop(t).foreground||r)||e.template.getTop(t).foreground&&r)&&n.push(e.template.getTop(t)),this.template.applyDocumentBottomTemplate&&null!=e.template.getBottom(t)&&(!(e.template.getBottom(t).foreground||r)||e.template.getBottom(t).foreground&&r)&&n.push(e.template.getBottom(t)),this.template.applyDocumentLeftTemplate&&null!=e.template.getLeft(t)&&(!(e.template.getLeft(t).foreground||r)||e.template.getLeft(t).foreground&&r)&&n.push(e.template.getLeft(t)),this.template.applyDocumentRightTemplate&&null!=e.template.getRight(t)&&(!(e.template.getRight(t).foreground||r)||e.template.getRight(t).foreground&&r)&&n.push(e.template.getRight(t)),n},i.prototype.getSectionTemplates=function(e,t){var n,r=[];return null!=this.template.getTop(e)&&(!(n=this.template.getTop(e)).foreground&&!t||n.foreground&&t)&&r.push(n),null!=this.template.getBottom(e)&&(!(n=this.template.getBottom(e)).foreground&&!t||n.foreground&&t)&&r.push(n),null!=this.template.getLeft(e)&&(!(n=this.template.getLeft(e)).foreground&&!t||n.foreground&&t)&&r.push(n),null!=this.template.getRight(e)&&(!(n=this.template.getRight(e)).foreground&&!t||n.foreground&&t)&&r.push(n),r},i.prototype.add=function(e){if(void 0===e){var t=new de;return this.add(t),t}var r=this.checkPresence(e);this.pdfPages.push(e),this.pagesReferences.add(r),e.setSection(this),e.resetProgress(),this.pageAddedMethod(e)},i.prototype.checkPresence=function(e){for(var t=new N(e),r=!1,n=this.parent,s=0;s<n.section.length;s++)r=r||n.section[s].contains(e);return t},i.prototype.contains=function(e){return 0<=this.indexOf(e)},i.prototype.indexOf=function(e){for(var t=0;t<this.pdfPages.length;t++)if(this.pdfPages[t]===e)return this.pdfPages.indexOf(e);var r=new N(e);return this.pagesReferences.indexOf(r)},i.prototype.pageAddedMethod=function(e){var t=new ei(e);this.onPageAdded(t),this.parent.document.pages.onPageAdded(t),this.pageCount.intValue=this.count},i.prototype.onPageAdded=function(e){},i.prototype.getActualBounds=function(e,t,r){if(e instanceof de&&"boolean"==typeof t)return this.getActualBounds(this.parent.document,e,t);var o=new w(0,0,0,0);o.height=r?this.pageSettings.size.height:this.pageSettings.getActualSize().height,o.width=r?this.pageSettings.size.width:this.pageSettings.getActualSize().width;var a=this.getLeftIndentWidth(e,t,r),h=this.getTopIndentHeight(e,t,r),l=this.getRightIndentWidth(e,t,r),c=this.getBottomIndentHeight(e,t,r);return o.x+=a,o.y+=h,o.width-=a+l,o.height-=h+c,o},i.prototype.getLeftIndentWidth=function(e,t,r){if(null==e)throw new Error("ArgumentNullException:document");if(null==t)throw new Error("ArgumentNullException:page");var n=r?this.pageSettings.margins.left:0,s=null!=this.template.getLeft(t)?this.template.getLeft(t).width:0,o=null!=e.template.getLeft(t)?e.template.getLeft(t).width:0;return n+(this.template.applyDocumentLeftTemplate?Math.max(s,o):s)},i.prototype.getTopIndentHeight=function(e,t,r){if(null==e)throw new Error("ArgumentNullException:document");if(null==t)throw new Error("ArgumentNullException:page");var n=r?this.pageSettings.margins.top:0,s=null!=this.template.getTop(t)?this.template.getTop(t).height:0,o=null!=e.template.getTop(t)?e.template.getTop(t).height:0;return n+(this.template.applyDocumentTopTemplate?Math.max(s,o):s)},i.prototype.getRightIndentWidth=function(e,t,r){if(null==e)throw new Error("ArgumentNullException:document");if(null==t)throw new Error("ArgumentNullException:page");var n=r?this.pageSettings.margins.right:0,s=null!=this.template.getRight(t)?this.template.getRight(t).width:0,o=null!=e.template.getRight(t)?e.template.getRight(t).width:0;return n+(this.template.applyDocumentRightTemplate?Math.max(s,o):s)},i.prototype.getBottomIndentHeight=function(e,t,r){if(null==e)throw new Error("ArgumentNullException:document");if(null==t)throw new Error("ArgumentNullException:page");var n=r?this.pageSettings.margins.bottom:0,s=null!=this.template.getBottom(t)?this.template.getBottom(t).height:0,o=null!=e.template.getBottom(t)?e.template.getBottom(t).height:0;return n+(this.template.applyDocumentBottomTemplate?Math.max(s,o):s)},i.prototype.remove=function(e){if(null==e)throw Error('ArgumentNullException("page")');var t=this.pdfPages.indexOf(e);this.pagesReferences.removeAt(t);for(var r=[],n=0;n<t;n++)r.push(this.pdfPages[n]);for(n=t+1;n<this.pdfPages.length;n++)r.push(this.pdfPages[n]);this.pdfPages=r},i.prototype.applyPageSettings=function(e,t,r){var n=new w(r.origin,r.size);e.items.setValue(this.dictionaryProperties.mediaBox,j.fromRectangle(n));var o=new B(ii.rotateFactor*r.rotate);e.items.setValue(this.dictionaryProperties.rotate,o)},i.prototype.beginSave=function(e,t){this.applyPageSettings(this.section,t.document.pageSettings,e)},i.prototype.drawTemplates=function(e,t,r,n){var s=this.getDocumentTemplates(r,e,n),o=this.getSectionTemplates(e,n);this.drawTemplatesHelper(t,r,s),this.drawTemplatesHelper(t,r,o)},i.prototype.drawTemplatesHelper=function(e,t,r){if(null!=r&&r.length>0)for(var n=r.length,s=0;s<n;s++)r[s].draw(e,t)},i}(),Nr=function(){function i(e){this.pageOrientation=e.pageSettings.orientation,this.pageRotate=e.pageSettings.rotate,this.pageSize=e.pageSettings.size,this.pageOrigin=e.pageSettings.origin}return Object.defineProperty(i.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(e){this.pageOrientation=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotate",{get:function(){return this.pageRotate},set:function(e){this.pageRotate=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.pageSize},set:function(e){this.pageSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"origin",{get:function(){return this.pageOrigin},set:function(e){this.pageOrigin=e},enumerable:!0,configurable:!0}),i}(),ii=function(){function i(e){this.sections=[],this.dictionaryProperties=new M,this.pdfDocument=e.clone(),this.initialize()}return Object.defineProperty(i.prototype,"section",{get:function(){return this.sections},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"document",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"count",{get:function(){return this.sections.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.pages},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.sectionCount=new B(0),this.sectionCollection=new j,this.pages=new F,this.pages.beginSave=new Fi(this),this.pages.items.setValue(this.dictionaryProperties.type,new O("Pages")),this.pages.items.setValue(this.dictionaryProperties.kids,this.sectionCollection),this.pages.items.setValue(this.dictionaryProperties.count,this.sectionCount),this.pages.items.setValue(this.dictionaryProperties.resources,new F),this.setPageSettings(this.pages,this.pdfDocument.pageSettings)},i.prototype.pdfSectionCollection=function(e){if(e<0||e>=this.count)throw new Error("IndexOutOfRangeException()");return this.sections[e]},i.prototype.setPageSettings=function(e,t){var r=new w(new b,t.size);e.items.setValue(this.dictionaryProperties.mediaBox,j.fromRectangle(r))},i.prototype.add=function(e){if(void 0===e){var t=new Rr(this.pdfDocument);return this.add(t),t}var r=this.checkSection(e);return this.sections.push(e),e.parent=this,this.sectionCollection.add(r),this.sections.indexOf(e)},i.prototype.checkSection=function(e){var t=new N(e);return this.sectionCollection.contains(t),t},i.prototype.countPages=function(){var e=0;return this.sections.forEach(function(t){return e+=t.count}),e},i.prototype.beginSave=function(){this.sectionCount.intValue=this.countPages()},i.rotateFactor=90,i}(),Ar=function(){function i(e){this.pdfPageCollectionIndex=new D,this.document=e}return Object.defineProperty(i.prototype,"count",{get:function(){return this.countPages()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageCollectionIndex",{get:function(){return this.pdfPageCollectionIndex},enumerable:!0,configurable:!0}),i.prototype.add=function(e){if(void 0===e){var t=new de;return this.add(t),t}this.getLastSection().add(e)},i.prototype.getLastSection=function(){var e=this.document.sections;return 0===e.section.length&&e.add(),e.section[e.section.length-1]},i.prototype.onPageAdded=function(e){},i.prototype.countPages=function(){for(var e=this.document.sections,t=0,r=0;r<e.section.length;r++)t+=e.section[r].count;return t},i.prototype.getPageByIndex=function(e){return this.getPage(e)},i.prototype.getPage=function(e){if(e<0||e>=this.count)throw Error('ArgumentOutOfRangeException("index", "Value can not be less 0")');for(var t=null,r=0,n=0,s=0,o=this.document.sections.count,a=0;a<o;a++){var h=this.document.sections.section[a];if(n=h.count,s=e-r,e>=r&&s<n){t=h.getPages()[s];break}r+=n}return t},i.prototype.indexOf=function(e){var t=-1;if(null==e)throw new Error("ArgumentNullException: page");for(var r=0,n=0,s=this.document.sections.count;n<s;n++){var o=this.document.sections.pdfSectionCollection(n);if((t=o.indexOf(e))>=0){t+=r;break}t=-1,r+=o.count}return t},i.prototype.remove=function(e){if(null==e)throw Error('ArgumentNullException("page")');for(var t=null,r=0,n=this.document.sections.count;r<n;r++)if((t=this.document.sections.pdfSectionCollection(r)).pages.contains(e)){t.pages.remove(e);break}return t},i}(),ri=function(){function i(){this.referenceObjects=[],this.pdfFontCollection=new D}return i.prototype.search=function(e){var t=null,r=this.getGroup(e);return null==r?r=this.createNewGroup():r.length>0&&(t=r[0]),r.push(e),t},i.prototype.createNewGroup=function(){var e=[];return this.referenceObjects.push(e),e},i.prototype.getGroup=function(e){var t=null;if(null!==e)for(var r=this.referenceObjects.length,n=0;n<r;n++){if(this.referenceObjects.length>0){var s=this.referenceObjects[n];if(s.length>0){if(e.equalsTo(s[0])){t=s;break}}else this.removeGroup(s)}r=this.referenceObjects.length}return t},i.prototype.removeGroup=function(e){if(null!==e){var t=this.referenceObjects.indexOf(e);this.referenceObjects.slice(t,t+1)}},i.prototype.destroy=function(){this.pdfFontCollection=void 0,this.referenceObjects=void 0},i}(),Dr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ve=function(i){function e(t){var r=i.call(this)||this;r.defaultMargin=40,r.streamWriter=null,r.document=r;var n=!1;void 0===t?(e.cacheCollection=new ri,n=!1):n=t;var s=new Ui;r.setMainObjectCollection(s);var o=new Gt;o.isMerging=n,o.document=r,r.setCrossTable(o);var a=new It;return r.setCatalog(a),s.add(a),a.position=-1,r.sectionCollection=new ii(r),r.documentPageCollection=new Ar(r),a.pages=r.sectionCollection,r}return Dr(e,i),Object.defineProperty(e,"defaultFont",{get:function(){return null==this.defaultStandardFont&&(this.defaultStandardFont=new Qe(q.Helvetica,8)),this.defaultStandardFont},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sections",{get:function(){return this.sectionCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSettings",{get:function(){return null==this.settings&&(this.settings=new zt(this.defaultMargin)),this.settings},set:function(t){this.settings=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pages",{get:function(){return this.documentPageCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cache",{get:function(){return void 0===e.cacheCollection||null==e.cacheCollection?new ri:e.cacheCollection},set:function(t){this.cacheCollection=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"enableCache",{get:function(){return this.isCacheEnabled},set:function(t){this.isCacheEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorSpace",{get:function(){return this.pdfColorSpace===x.Rgb||this.pdfColorSpace===x.Cmyk||this.pdfColorSpace===x.GrayScale?this.pdfColorSpace:x.Rgb},set:function(t){this.pdfColorSpace=t===x.Rgb||t===x.Cmyk||t===x.GrayScale?t:x.Rgb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return null==this.pageTemplate&&(this.pageTemplate=new ti),this.pageTemplate},set:function(t){this.pageTemplate=t},enumerable:!0,configurable:!0}),e.prototype.docSave=function(t,r,n){if(this.checkPagesPresence(),null===t)throw new Error("ArgumentNullException : stream");this.streamWriter=t;var s=new Hi(t);if(s.document=this,"boolean"==typeof r&&void 0===n)return this.crossTable.save(s);this.crossTable.save(s,r)},e.prototype.checkPagesPresence=function(){0===this.pages.count&&this.pages.add()},e.prototype.destroy=function(){this.catalog=void 0,this.colorSpace=void 0,this.currentSavingObj=void 0,this.documentPageCollection=void 0,this.isStreamCopied=void 0,this.pageSettings=void 0,this.pageTemplate=void 0,this.pdfColorSpace=void 0,this.sectionCollection=void 0,e.cache.destroy(),this.crossTable.pdfObjects.destroy(),e.cache=void 0,this.streamWriter.destroy()},e.defaultStandardFont=null,e.isCacheEnabled=!0,e}(Yi),Mr=function(){function i(){}return i.getMetrics=function(e,t,r){var n=null;switch(e){case q.Helvetica:n=this.getHelveticaMetrics(e,t,r);break;case q.Courier:n=this.getCourierMetrics(e,t,r);break;case q.TimesRoman:n=this.getTimesMetrics(e,t,r);break;case q.Symbol:n=this.getSymbolMetrics(e,t,r);break;case q.ZapfDingbats:n=this.getZapfDingbatsMetrics(e,t,r);break;default:n=this.getHelveticaMetrics(q.Helvetica,t,r)}return n.name=e.toString(),n.subScriptSizeFactor=this.subSuperScriptFactor,n.superscriptSizeFactor=this.subSuperScriptFactor,n},i.getHelveticaMetrics=function(e,t,r){var n=new Me;return(t&E.Bold)>0&&(t&E.Italic)>0?(n.ascent=this.helveticaBoldItalicAscent,n.descent=this.helveticaBoldItalicDescent,n.postScriptName=this.helveticaBoldItalicName,n.size=r,n.widthTable=new X(this.arialBoldWidth),n.height=n.ascent-n.descent):(t&E.Bold)>0?(n.ascent=this.helveticaBoldAscent,n.descent=this.helveticaBoldDescent,n.postScriptName=this.helveticaBoldName,n.size=r,n.widthTable=new X(this.arialBoldWidth),n.height=n.ascent-n.descent):(t&E.Italic)>0?(n.ascent=this.helveticaItalicAscent,n.descent=this.helveticaItalicDescent,n.postScriptName=this.helveticaItalicName,n.size=r,n.widthTable=new X(this.arialWidth),n.height=n.ascent-n.descent):(n.ascent=this.helveticaAscent,n.descent=this.helveticaDescent,n.postScriptName=this.helveticaName,n.size=r,n.widthTable=new X(this.arialWidth),n.height=n.ascent-n.descent),n},i.getCourierMetrics=function(e,t,r){var n=new Me;return(t&E.Bold)>0&&(t&E.Italic)>0?(n.ascent=this.courierBoldItalicAscent,n.descent=this.courierBoldItalicDescent,n.postScriptName=this.courierBoldItalicName,n.size=r,n.widthTable=new X(this.fixedWidth),n.height=n.ascent-n.descent):(t&E.Bold)>0?(n.ascent=this.courierBoldAscent,n.descent=this.courierBoldDescent,n.postScriptName=this.courierBoldName,n.size=r,n.widthTable=new X(this.fixedWidth),n.height=n.ascent-n.descent):(t&E.Italic)>0?(n.ascent=this.courierItalicAscent,n.descent=this.courierItalicDescent,n.postScriptName=this.courierItalicName,n.size=r,n.widthTable=new X(this.fixedWidth),n.height=n.ascent-n.descent):(n.ascent=this.courierAscent,n.descent=this.courierDescent,n.postScriptName=this.courierName,n.size=r,n.widthTable=new X(this.fixedWidth),n.height=n.ascent-n.descent),n},i.getTimesMetrics=function(e,t,r){var n=new Me;return(t&E.Bold)>0&&(t&E.Italic)>0?(n.ascent=this.timesBoldItalicAscent,n.descent=this.timesBoldItalicDescent,n.postScriptName=this.timesBoldItalicName,n.size=r,n.widthTable=new X(this.timesRomanBoldItalicWidths),n.height=n.ascent-n.descent):(t&E.Bold)>0?(n.ascent=this.timesBoldAscent,n.descent=this.timesBoldDescent,n.postScriptName=this.timesBoldName,n.size=r,n.widthTable=new X(this.timesRomanBoldWidth),n.height=n.ascent-n.descent):(t&E.Italic)>0?(n.ascent=this.timesItalicAscent,n.descent=this.timesItalicDescent,n.postScriptName=this.timesItalicName,n.size=r,n.widthTable=new X(this.timesRomanItalicWidth),n.height=n.ascent-n.descent):(n.ascent=this.timesAscent,n.descent=this.timesDescent,n.postScriptName=this.timesName,n.size=r,n.widthTable=new X(this.timesRomanWidth),n.height=n.ascent-n.descent),n},i.getSymbolMetrics=function(e,t,r){var n=new Me;return n.ascent=this.symbolAscent,n.descent=this.symbolDescent,n.postScriptName=this.symbolName,n.size=r,n.widthTable=new X(this.symbolWidth),n.height=n.ascent-n.descent,n},i.getZapfDingbatsMetrics=function(e,t,r){var n=new Me;return n.ascent=this.zapfDingbatsAscent,n.descent=this.zapfDingbatsDescent,n.postScriptName=this.zapfDingbatsName,n.size=r,n.widthTable=new X(this.zapfDingbatsWidth),n.height=n.ascent-n.descent,n},i.subSuperScriptFactor=1.52,i.helveticaAscent=931,i.helveticaDescent=-225,i.helveticaName="Helvetica",i.helveticaBoldAscent=962,i.helveticaBoldDescent=-228,i.helveticaBoldName="Helvetica-Bold",i.helveticaItalicAscent=931,i.helveticaItalicDescent=-225,i.helveticaItalicName="Helvetica-Oblique",i.helveticaBoldItalicAscent=962,i.helveticaBoldItalicDescent=-228,i.helveticaBoldItalicName="Helvetica-BoldOblique",i.courierAscent=805,i.courierDescent=-250,i.courierName="Courier",i.courierBoldAscent=801,i.courierBoldDescent=-250,i.courierBoldName="Courier-Bold",i.courierItalicAscent=805,i.courierItalicDescent=-250,i.courierItalicName="Courier-Oblique",i.courierBoldItalicAscent=801,i.courierBoldItalicDescent=-250,i.courierBoldItalicName="Courier-BoldOblique",i.timesAscent=898,i.timesDescent=-218,i.timesName="Times-Roman",i.timesBoldAscent=935,i.timesBoldDescent=-218,i.timesBoldName="Times-Bold",i.timesItalicAscent=883,i.timesItalicDescent=-217,i.timesItalicName="Times-Italic",i.timesBoldItalicAscent=921,i.timesBoldItalicDescent=-218,i.timesBoldItalicName="Times-BoldItalic",i.symbolAscent=1010,i.symbolDescent=-293,i.symbolName="Symbol",i.zapfDingbatsAscent=820,i.zapfDingbatsDescent=-143,i.zapfDingbatsName="ZapfDingbats",i.arialWidth=[278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,222,222,333,333,350,556,1e3,333,1e3,500,333,944,0,500,667,0,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,333,333,333,556,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500],i.arialBoldWidth=[278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,278,278,500,500,350,556,1e3,333,1e3,556,333,944,0,500,667,0,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,333,333,333,611,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556],i.fixedWidth=[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],i.timesRomanWidth=[250,333,408,500,500,833,778,180,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,0,500,0,333,500,444,1e3,500,500,333,1e3,556,333,889,0,611,0,0,333,333,444,444,350,500,1e3,333,980,389,333,722,0,444,722,0,333,500,500,500,500,200,500,333,760,276,500,564,0,760,333,400,564,300,300,333,500,453,250,333,300,310,500,750,750,750,444,722,722,722,722,722,722,889,667,611,611,611,611,333,333,333,333,722,722,722,722,722,722,722,564,722,722,722,722,722,722,556,500,444,444,444,444,444,444,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,564,500,500,500,500,500,500,500,500],i.timesRomanBoldWidth=[250,333,555,500,500,1e3,833,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1e3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,1e3,0,667,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,444,722,0,333,500,500,500,500,220,500,333,747,300,500,570,0,747,333,400,570,300,300,333,556,540,250,333,300,330,500,750,750,750,500,722,722,722,722,722,722,1e3,722,667,667,667,667,389,389,389,389,722,722,778,778,778,778,778,570,778,722,722,722,722,722,611,556,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,500,556,500],i.timesRomanItalicWidth=[250,333,420,500,500,833,778,214,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,0,500,0,333,500,556,889,500,500,333,1e3,500,333,944,0,556,0,0,333,333,556,556,350,500,889,333,980,389,333,667,0,389,556,0,389,500,500,500,500,275,500,333,760,276,500,675,0,760,333,400,675,300,300,333,500,523,250,333,300,310,500,750,750,750,500,611,611,611,611,611,611,889,667,611,611,611,611,333,333,333,333,722,667,722,722,722,722,722,675,722,722,722,722,722,556,611,500,500,500,500,500,500,500,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,675,500,500,500,500,500,444,500,444],i.timesRomanBoldItalicWidths=[250,389,555,500,500,833,778,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,944,0,611,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,389,611,0,389,500,500,500,500,220,500,333,747,266,500,606,0,747,333,400,570,300,300,333,576,500,250,333,300,300,500,750,750,750,500,667,667,667,667,667,667,944,667,667,667,667,667,389,389,389,389,722,722,722,722,722,722,722,570,722,722,722,722,722,611,611,500,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,444,500,444],i.symbolWidth=[250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1e3,603,1e3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,329,274,686,686,686,384,384,384,384,384,384,494,494,494,-1],i.zapfDingbatsWidth=[278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,390,390,317,317,276,276,509,509,410,410,234,234,334,334,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,874,760,946,771,865,771,888,967,888,831,873,927,970,918],i}(),Ir=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Qe=function(i){function e(t,r,n){var s=i.call(this,r,void 0===n?t instanceof e?t.style:E.Regular:n)||this;return s.dictionaryProperties=new M,s.encodings=["Unknown","StandardEncoding","MacRomanEncoding","MacExpertEncoding","WinAnsiEncoding","PDFDocEncoding","IdentityH"],s.pdfFontFamily=void 0===t?q.Helvetica:t instanceof e?t.fontFamily:t,s.checkStyle(),s.initializeInternals(),s}return Ir(e,i),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.pdfFontFamily},enumerable:!0,configurable:!0}),e.prototype.checkStyle=function(){if(this.fontFamily===q.Symbol||this.fontFamily===q.ZapfDingbats){var t=this.style;this.setStyle(t&=~(E.Bold|E.Italic))}},e.prototype.getLineWidth=function(t,r){if(null==t)throw new Error("ArgumentNullException:line");for(var n=0,o=0,a=(t=e.convert(t)).length;o<a;o++)n+=this.getCharWidthInternal(t[o],r);var c=this.metrics.getSize(r);return this.applyFormatSettings(t,r,n*=re.charSizeMultiplier*c)},e.prototype.equalsToFont=function(t){var r=!1;if(null!=t){var o=~(E.Underline|E.Strikeout);r=this.fontFamily===t.fontFamily&&(this.style&o)==(t.style&o)}return r},e.prototype.initializeInternals=function(){Ve.cache.search(this);var r,n=Mr.getMetrics(this.pdfFontFamily,this.style,this.size);this.metrics=n,r=this.createInternals(),this.setInternals(r)},e.prototype.createInternals=function(){var t=new F;return t.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.font)),t.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.type1)),t.items.setValue(this.dictionaryProperties.baseFont,new O(this.metrics.postScriptName)),this.fontFamily!==q.Symbol&&this.fontFamily!==q.ZapfDingbats&&t.items.setValue(this.dictionaryProperties.encoding,new O(this.encodings[ot.WinAnsiEncoding])),t},e.prototype.getCharWidthInternal=function(t,r){var s=0;return s=t.charCodeAt(0),("0"===this.name||"1"===this.name||"2"===this.name||"3"===this.name||"4"===this.name)&&(s-=e.charOffset),this.metrics.widthTable.items(s=s>=0&&128!==s?s:0)},e.convert=function(t){return t},e.charOffset=32,e}(re),Gr=function(){function i(e){this.dictionaryProperties=new M,this.pdfColor=new g(255,255,255),this.rectangle=new w(0,0,0,0),this.pdfPage=null,this.textBrush=new pe(new g(0,0,0)),this.textFont=new Qe(q.TimesRoman,10),this.format=new ye(_.Left),this.content="",this.pdfDictionary=new F,this.internalColor=new g,this.darkness=1,void 0===e?this.initialize():(this.initialize(),this.bounds=e)}return Object.defineProperty(i.prototype,"color",{get:function(){return this.pdfColor},set:function(e){this.pdfColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"innerColor",{get:function(){return this.internalColor},set:function(e){this.internalColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return this.rectangle},set:function(e){this.rectangle=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"font",{get:function(){return this.textFont},set:function(e){this.textFont=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stringFormat",{get:function(){return this.format},set:function(e){this.format=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"brush",{get:function(){return this.textBrush},set:function(e){this.textBrush=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.content},set:function(e){this.content=e,this.dictionary.items.setValue(this.dictionaryProperties.contents,new U(this.content))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dictionary",{get:function(){return this.pdfDictionary},set:function(e){this.pdfDictionary=e},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.pdfDictionary.annotationBeginSave=new Ti(this),this.pdfDictionary.items.setValue(this.dictionaryProperties.type,new O(this.dictionaryProperties.annot))},i.prototype.setPage=function(e){this.pdfPage=e,this.pdfDictionary.items.setValue(this.dictionaryProperties.p,new N(this.pdfPage))},i.prototype.beginSave=function(){this.save()},i.prototype.save=function(){var e=new w(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),r=e.height,n=this.pdfPage.section.pointToNativePdf(this.page,new b(e.x,e.y));e.x=n.x,e.width=n.x+e.width,e.y=n.y-this.page.document.pageSettings.margins.top,e.height=e.y-r,this.pdfDictionary.items.setValue(this.dictionaryProperties.rect,j.fromRectangle(e)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new B(this.darkness))},Object.defineProperty(i.prototype,"element",{get:function(){return this.pdfDictionary},enumerable:!0,configurable:!0}),i}(),_r=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ni=function(i){function e(t){return i.call(this,t)||this}return _r(e,i),e.prototype.initialize=function(){i.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.link))},e}(Gr),zr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Wr=function(i){function e(t){var r=i.call(this,t)||this;return r.pdfAction=null,r}return zr(e,i),e.prototype.getSetAction=function(t){if(void 0===t)return this.pdfAction;this.pdfAction=t},e}(ni),xt=function(){function i(e){this.layoutElement=e}return Object.defineProperty(i.prototype,"elements",{get:function(){return this.layoutElement},enumerable:!0,configurable:!0}),i.prototype.getElement=function(){return this.layoutElement},i.prototype.layout=function(e){return this.layoutInternal(e)},i.prototype.Layouter=function(e){return this.layoutInternal(e)},i.prototype.getNextPage=function(e){return e.section.add()},i.prototype.getPaginateBounds=function(e){if(null==e)throw new Error("ArgumentNullException : param");return e.format.usePaginateBounds?e.format.paginateBounds:new w(e.bounds.x,0,e.bounds.width,e.bounds.height)},i}(),Z=function(){function i(e){void 0===e||(this.break=e.break,this.layout=e.layout,this.paginateBounds=e.paginateBounds,this.boundsSet=e.usePaginateBounds)}return Object.defineProperty(i.prototype,"layout",{get:function(){return this.layoutType},set:function(e){this.layoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"break",{get:function(){return this.breakType},set:function(e){this.breakType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paginateBounds",{get:function(){return void 0===this.layoutPaginateBounds&&null==this.layoutPaginateBounds&&(this.layoutPaginateBounds=new w(0,0,0,0)),this.layoutPaginateBounds},set:function(e){this.layoutPaginateBounds=e,this.boundsSet=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"usePaginateBounds",{get:function(){return this.boundsSet},enumerable:!0,configurable:!0}),i}(),lt=function(){function i(){}return Object.defineProperty(i.prototype,"page",{get:function(){return this.pdfPage},set:function(e){this.pdfPage=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return new w(this.layoutBounds.x,this.layoutBounds.y,this.layoutBounds.width,this.layoutBounds.height)},set:function(e){this.layoutBounds=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"format",{get:function(){return this.layoutFormat},set:function(e){this.layoutFormat=e},enumerable:!0,configurable:!0}),i}(),Lt=function(){function i(e,t){this.pdfPage=e,this.layoutBounds=t}return Object.defineProperty(i.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return this.layoutBounds},enumerable:!0,configurable:!0}),i}(),ne=function(){function i(){var e=new Y(new g(0,0,0));e.dashStyle=W.Solid;var t=new Y(new g(0,0,0));t.dashStyle=W.Solid;var r=new Y(new g(0,0,0));r.dashStyle=W.Solid;var n=new Y(new g(0,0,0));n.dashStyle=W.Solid,this.leftPen=e,this.rightPen=t,this.topPen=r,this.bottomPen=n}return Object.defineProperty(i.prototype,"left",{get:function(){return this.leftPen},set:function(e){this.leftPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.rightPen},set:function(e){this.rightPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.topPen},set:function(e){this.topPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.bottomPen},set:function(e){this.bottomPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"all",{set:function(e){this.leftPen=this.rightPen=this.topPen=this.bottomPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isAll",{get:function(){return this.leftPen===this.rightPen&&this.leftPen===this.topPen&&this.leftPen===this.bottomPen},enumerable:!0,configurable:!0}),Object.defineProperty(i,"default",{get:function(){return new i},enumerable:!0,configurable:!0}),i}(),ct=function(){function i(e,t,r,n){this.hasLeftPad=!1,this.hasRightPad=!1,this.hasTopPad=!1,this.hasBottomPad=!1,void 0===e?(this.leftPad=this.rightPad=5.76,this.bottomPad=this.topPad=.5):(this.leftPad=e,this.rightPad=t,this.topPad=r,this.bottomPad=n,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0)}return Object.defineProperty(i.prototype,"left",{get:function(){return this.leftPad},set:function(e){this.leftPad=e,this.hasLeftPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.rightPad},set:function(e){this.rightPad=e,this.hasRightPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.topPad},set:function(e){this.topPad=e,this.hasTopPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.bottomPad},set:function(e){this.bottomPad=e,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"all",{set:function(e){this.leftPad=this.rightPad=this.topPad=this.bottomPad=e,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),i}(),Vt=function(){function i(){}return Object.defineProperty(i.prototype,"raiseBeginPageLayout",{get:function(){return void 0!==this.beginPageLayout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"raiseEndPageLayout",{get:function(){return void 0!==this.endPageLayout},enumerable:!0,configurable:!0}),i.prototype.onBeginPageLayout=function(e){this.beginPageLayout&&this.beginPageLayout(this,e)},i.prototype.onEndPageLayout=function(e){this.endPageLayout&&this.endPageLayout(this,e)},i.prototype.drawHelper=function(e,t,r,n){if(t instanceof b&&void 0===t.width&&void 0===r)return this.drawHelper(e,t.x,t.y);if("number"==typeof t&&"number"==typeof r&&void 0===n)return this.drawHelper(e,t,r,null);if(t instanceof w&&void 0!==t.width&&void 0===r)return this.drawHelper(e,t,null);if(t instanceof b&&void 0===t.width&&r instanceof Z)return this.drawHelper(e,t.x,t.y,r);if("number"==typeof t&&"number"==typeof r&&(n instanceof Z||null==n)){var o=new w(t,r,e.graphics.clientSize.width-t,0);return this.drawHelper(e,o,n)}if(t instanceof w&&void 0!==t.width&&"boolean"==typeof r)return this.bEmbedFonts=r,this.drawHelper(e,t,null);var a=new lt,h=t,l=r;if(a.page=e,a.bounds=h,null!=a){var c=a.bounds.x,f=a.bounds.y;0===a.bounds.x&&(c=ne.default.right.width/2),0===a.bounds.y&&(f=ne.default.top.width/2);var d=new w(c,f,a.bounds.width,a.bounds.height);a.bounds=d}return a.format=null!=l?l:new Z,this.layout(a)},i}(),si=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ur=function(i){function e(t){return i.call(this,t)||this}return si(e,i),Object.defineProperty(e.prototype,"element",{get:function(){return i.prototype.getElement.call(this)},enumerable:!0,configurable:!0}),e.prototype.layoutInternal=function(t){this.format=null!=this.element.stringFormat?this.element.stringFormat:null;var r=t.page,n=t.bounds,s=this.element.value,o=null,a=new oi;for(a.page=r,a.remainder=s;;){a=this.layoutOnPage(s,r,n,t),o=this.getLayoutResult(a);break}return o},e.prototype.getLayoutResult=function(t){return new qr(t.page,t.bounds,t.remainder,t.lastLineBounds)},e.prototype.layoutOnPage=function(t,r,n,s){var o=new oi;o.remainder=t,o.page=r,n=this.checkCorrectBounds(r,n);var h=(new me).layout(t,this.element.font,this.format,n,r.getClientSize().height,!1,new S(0,0)),l=null==h.remainder,d=r.graphics,p=this.element.getBrush();return this.element instanceof Ke&&(p.color=new g(0,0,255)),d.drawStringLayoutResult(h,this.element.font,this.element.pen,p,n,this.format),o.lastLineBounds=d.getLineBounds(h.lineCount-1,h,this.element.font,n,this.format),o.bounds=this.getTextPageBounds(r,n,h),o.remainder=h.remainder,o.end=l,o},e.prototype.checkCorrectBounds=function(t,r){return r.height=r.height>0?r.height:t.graphics.clientSize.height-r.y,r},e.prototype.getTextPageBounds=function(t,r,n){var o,s=n.actualSize,a=r.y,h=r.width>0?r.width:s.width,l=s.height;o=t.graphics.checkCorrectLayoutRectangle(s,r.x,r.y,this.format).x;var f=t.graphics.getTextVerticalAlignShift(s.height,r.height,this.format);return new w(o,a+=f,h,l)},e}(xt),oi=function(){return function(){}}(),qr=function(i){function e(t,r,n,s){var o=i.call(this,t,r)||this;return o.remainderText=n,o.lastLineTextBounds=s,o}return si(e,i),Object.defineProperty(e.prototype,"remainder",{get:function(){return this.remainderText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastLineBounds",{get:function(){return this.lastLineTextBounds},enumerable:!0,configurable:!0}),e}(Lt),Yr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Jr=function(i){function e(t,r,n,s,o){var a=i.call(this)||this;return a.content="",a.elementValue="",a.hasPointOverload=!1,a.isPdfTextElement=!1,void 0===t||("string"==typeof t&&void 0===r?(a.content=t,a.elementValue=t):"string"==typeof t&&r instanceof re&&void 0===n?(a.content=t,a.elementValue=t,a.pdfFont=r):"string"==typeof t&&r instanceof re&&n instanceof Y&&void 0===s?(a.content=t,a.elementValue=t,a.pdfFont=r,a.pdfPen=n):"string"==typeof t&&r instanceof re&&n instanceof oe&&void 0===s?(a.content=t,a.elementValue=t,a.pdfFont=r,a.pdfBrush=n):(a.content=t,a.elementValue=t,a.pdfFont=r,a.pdfPen=n,a.pdfBrush=s,a.format=o)),a}return Yr(e,i),Object.defineProperty(e.prototype,"text",{get:function(){return this.content},set:function(t){this.elementValue=t,this.content=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.elementValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pen",{get:function(){return this.pdfPen},set:function(t){this.pdfPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"brush",{get:function(){return this.pdfBrush},set:function(t){this.pdfBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this.pdfFont},set:function(t){this.pdfFont=t,this.elementValue=this.pdfFont instanceof Qe&&null!=this.content?Qe.convert(this.content):this.content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),e.prototype.getBrush=function(){return null==this.pdfBrush||void 0===this.pdfBrush?new pe(new g(0,0,0)):this.pdfBrush},e.prototype.layout=function(t){return new Ur(this).layout(t)},e.prototype.drawText=function(t,r,n,s){if(r instanceof b&&void 0===r.width&&void 0===n)return this.hasPointOverload=!0,this.drawText(t,r.x,r.y);if("number"==typeof r&&"number"==typeof n&&void 0===s)return this.hasPointOverload=!0,this.drawText(t,r,n,null);if(r instanceof w&&void 0!==r.width&&void 0===n)return this.drawText(t,r,null);if(r instanceof b&&void 0===r.width&&n instanceof Z)return this.hasPointOverload=!0,this.drawText(t,r.x,r.y,n);if("number"==typeof r&&"number"==typeof n&&(s instanceof Z||null==s)){this.hasPointOverload=!0;var a=new w(r,n,t.graphics.clientSize.width-r,0);return this.drawText(t,a,s)}if(r instanceof w&&void 0!==r.width&&"boolean"==typeof n)return this.drawText(t,r,null);var h=new me;if(this.hasPointOverload){var l=h.layout(this.value,this.font,this.stringFormat,new S(t.graphics.clientSize.width-r.x,0),!0,t.graphics.clientSize),c=void 0,d=r,p=n;if((f=new lt).page=t,f.bounds=d,f.format=null!=p?p:new Z,l.lines.length>1){if(this.text=l.layoutLines[0].text,f.bounds.y<=f.page.graphics.clientSize.height){var v=new b(f.bounds.x,f.bounds.y);c=this.layout(f);for(var y=new w(0,c.bounds.y+l.lineHeight,t.graphics.clientSize.width,l.lineHeight),P=1;P<l.lines.length;P++)if(f.page=c.page,f.bounds=new w(new b(y.x,y.y),new S(y.width,y.height)),this.text=l.layoutLines[P].text,y.y+l.lineHeight>c.page.graphics.clientSize.height&&(f.page=f.page.graphics.getNextPage(),y=new w(0,v.y>c.page.graphics.clientSize.height-c.bounds.height?c.bounds.height:0,c.page.graphics.clientSize.width,l.lineHeight),f.bounds=y),c=this.layout(f),P!==l.lines.length-1)y=new w(0,c.bounds.y+l.lineHeight,c.page.graphics.clientSize.width,l.lineHeight);else{var V=this.font.measureString(this.text,this.format).width;c=this.calculateResultBounds(c,V,c.page.graphics.clientSize.width,0)}}return c}var R=this.font.measureString(this.text,this.format);return f.bounds.y<=f.page.graphics.clientSize.height&&(c=this.layout(f),c=this.calculateResultBounds(c,R.width,c.page.graphics.clientSize.width,0)),c}c=h.layout(this.value,this.font,this.stringFormat,new S(r.width,0),!1,t.graphics.clientSize);var f,C=void 0;if(d=r,p=n,(f=new lt).page=t,f.bounds=d,f.format=null!=p?p:new Z,c.lines.length>1){if(this.text=c.layoutLines[0].text,f.bounds.y<=f.page.graphics.clientSize.height)for(v=new b(f.bounds.x,f.bounds.y),C=this.layout(f),y=new w(d.x,C.bounds.y+c.lineHeight,d.width,c.lineHeight),P=1;P<c.lines.length;P++)f.page=C.page,f.bounds=new w(y.x,y.y,y.width,y.height),this.text=c.layoutLines[P].text,y.y+c.lineHeight>C.page.graphics.clientSize.height&&(f.page=f.page.graphics.getNextPage(),y=new w(d.x,v.y>C.page.graphics.clientSize.height-C.bounds.height?c.lineHeight:0,d.width,c.lineHeight),f.bounds=y),C=this.layout(f),P!==c.lines.length-1?y=new w(d.x,C.bounds.y+c.lineHeight,d.width,c.lineHeight):(V=this.font.measureString(this.text,this.format).width,C=this.calculateResultBounds(C,V,d.width,d.x));return C}return R=this.font.measureString(this.text,this.format),f.bounds.y<=f.page.graphics.clientSize.height&&(C=this.layout(f),C=this.calculateResultBounds(C,R.width,d.width,d.x)),C},e.prototype.calculateResultBounds=function(t,r,n,s){return null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Center?(t.bounds.x=s+(n-r)/2,t.bounds.width=r):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Right?(t.bounds.x=s+(n-r),t.bounds.width=r):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Justify?(t.bounds.x=s,t.bounds.width=n):(t.bounds.width=s,t.bounds.width=r),t},e}(Vt),$r=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ft=function(i){function e(t,r){var n=i.call(this,t)||this;return void 0!==r&&(n.uri=r),n}return $r(e,i),Object.defineProperty(e.prototype,"uriAction",{get:function(){return void 0===this.pdfUriAction&&(this.pdfUriAction=new _i),this.pdfUriAction},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uri",{get:function(){return this.uriAction.uri},set:function(t){this.uriAction.uri!==t&&(this.uriAction.uri=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.getSetAction()},set:function(t){this.getSetAction(t),this.uriAction.next=t},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){i.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new O(this.dictionaryProperties.link)),this.dictionary.items.setValue(this.dictionaryProperties.a,this.uriAction.element)},e}(Wr),Xr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ke=function(i){function e(){var t=i.call(this)||this;t.uniformResourceLocator="",t.uriAnnotation=null,t.recalculateBounds=!1,t.defaultBorder=new j;for(var r=0;r<3;r++)t.defaultBorder.add(new B(0));return t}return Xr(e,i),Object.defineProperty(e.prototype,"url",{get:function(){return this.uniformResourceLocator},set:function(t){if(0===t.length)throw new Error("ArgumentException : Url - string can not be empty");this.uniformResourceLocator=t},enumerable:!0,configurable:!0}),e.prototype.draw=function(t,r){if(t instanceof de){var n=new me,s=this.font.style;if(r instanceof b){if(this.recalculateBounds=!0,this.font.style=E.Underline,1===(o=n.layout(this.value,this.font,this.stringFormat,new S(t.graphics.clientSize.width-r.x,0),!0,t.graphics.clientSize)).lines.length){var a=this.font.measureString(this.value),h=new w(r,a);h=this.calculateBounds(h,a.width,t.graphics.clientSize.width,r.x),this.uriAnnotation=new ft(h,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),t.annotations.add(this.uriAnnotation);var l=this.drawText(t,r);return this.font.style=s,l}return l=this.drawMultipleLineWithPoint(o,t,r),this.font.style=s,l}var o=n.layout(this.value,this.font,this.stringFormat,new S(r.width,0),!1,new S(0,0));if(this.font.style=E.Underline,1===o.lines.length){a=this.font.measureString(this.value),h=new w(new b(r.x,r.y),a),h=this.calculateBounds(h,a.width,r.width,r.x),this.uriAnnotation=new ft(h,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),t.annotations.add(this.uriAnnotation);var c=this.drawText(t,r);return this.font.style=s,c}return c=this.drawMultipleLineWithBounds(o,t,r),this.font.style=s,c}return new de,this.draw(t.page,r)},e.prototype.drawMultipleLineWithPoint=function(t,r,n){for(var s,o=0;o<t.layoutLines.length;o++){var a=this.font.measureString(t.lines[o].text),h=new w(n,a);if(0!==o&&(h.x=0),this.text=t.lines[o].text,h.y+a.height>r.graphics.clientSize.height){if(0===o)break;r=r.graphics.getNextPage(),h=new w(0,0,r.graphics.clientSize.width,a.height),n.y=0}h=this.calculateBounds(h,a.width,r.graphics.clientSize.width,h.x),this.uriAnnotation=new ft(h,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),r.annotations.add(this.uriAnnotation),s=0!==o?this.drawText(r,new b(0,h.y)):this.drawText(r,h.x,h.y),n.y+=a.height}return s},e.prototype.drawMultipleLineWithBounds=function(t,r,n){for(var s,o=0;o<t.layoutLines.length;o++){var a=this.font.measureString(t.lines[o].text),h=new w(new b(n.x,n.y),a);if(h=this.calculateBounds(h,a.width,n.width,n.x),this.text=t.lines[o].text,n.y+a.height>r.graphics.clientSize.height){if(0===o)break;r=r.graphics.getNextPage(),n=new w(n.x,0,n.width,a.height),h.y=0}this.uriAnnotation=new ft(h,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),r.annotations.add(this.uriAnnotation),s=this.drawText(r,n),n.y+=a.height}return s},e.prototype.calculateBounds=function(t,r,n,s){return null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Center?(t.x=s+(n-r)/2,t.width=r):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Right?(t.x=s+(n-r),t.width=r):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===_.Justify?(t.x=s,t.width=n):(t.width=s,t.width=r),t},e}(Jr),ai=function(){function i(){}return i.convert=function(e,t){var r="";switch(t){case ue.None:r="";break;case ue.Numeric:r=e.toString();break;case ue.LowerLatin:r=this.arabicToLetter(e).toLowerCase();break;case ue.LowerRoman:r=this.arabicToRoman(e).toLowerCase();break;case ue.UpperLatin:r=this.arabicToLetter(e);break;case ue.UpperRoman:r=this.arabicToRoman(e)}return r},i.arabicToRoman=function(e){var t="",r=this.generateNumber(e,1e3,"M");t+=r.returnValue;var n=this.generateNumber(e=r.intArabic,900,"CM");t+=n.returnValue;var s=this.generateNumber(e=n.intArabic,500,"D");t+=s.returnValue;var o=this.generateNumber(e=s.intArabic,400,"CD");t+=o.returnValue;var a=this.generateNumber(e=o.intArabic,100,"C");t+=a.returnValue;var h=this.generateNumber(e=a.intArabic,90,"XC");t+=h.returnValue;var l=this.generateNumber(e=h.intArabic,50,"L");t+=l.returnValue;var c=this.generateNumber(e=l.intArabic,40,"XL");t+=c.returnValue;var f=this.generateNumber(e=c.intArabic,10,"X");t+=f.returnValue;var d=this.generateNumber(e=f.intArabic,9,"IX");t+=d.returnValue;var p=this.generateNumber(e=d.intArabic,5,"V");t+=p.returnValue;var v=this.generateNumber(e=p.intArabic,4,"IV");t+=v.returnValue;var y=this.generateNumber(e=v.intArabic,1,"I");return e=y.intArabic,(t+=y.returnValue).toString()},i.arabicToLetter=function(e){for(var t=this.convertToLetter(e),r="";t.length>0;){var n=t.pop();r=this.appendChar(r,n)}return r.toString()},i.generateNumber=function(e,t,r){for(var n="";e>=t;)e-=t,n+=r;return{returnValue:n.toString(),intArabic:e}},i.convertToLetter=function(e){if(e<=0)throw Error("ArgumentOutOfRangeException-arabic, Value can not be less 0");for(var t=[];e>this.letterLimit;){var r=e%this.letterLimit;0===r?(e=e/this.letterLimit-1,r=this.letterLimit):e/=this.letterLimit,t.push(r)}return t.push(e),t},i.appendChar=function(e,t){return e+String.fromCharCode(i.acsiiStartIndex+t)},i.letterLimit=26,i.acsiiStartIndex=64,i}(),ui=function(){function i(e,t){this.pdfTemplate=null,this.content="",void 0===e||(this.template=e,this.value=t)}return Object.defineProperty(i.prototype,"template",{get:function(){return this.pdfTemplate},set:function(e){this.pdfTemplate=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.content},set:function(e){this.content=e},enumerable:!0,configurable:!0}),i}(),Zr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),hi=function(i){function e(){var t=i.call(this)||this;return t.list=new Ue,t}return Zr(e,i),e.prototype.performDraw=function(t,r,n,s){i.prototype.performDrawHelper.call(this,t,r,n,s);var o=this.getValue(t),a=new Xe(this.getSize());this.list.setValue(t,new ui(a,o));var h=this.getSize();a.graphics.drawString(o,this.getFont(),this.pen,this.getBrush(),0,0,h.width,h.height,this.stringFormat);var l=new b(r.x+this.location.x,r.y+this.location.y);t.drawPdfTemplate(a,l,new S(a.width*n,a.height*s))},e}(St),Qr=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Kr=function(i){function e(t,r){var n=i.call(this)||this;return n.internalNumberStyle=ue.Numeric,void 0===r?n.font=t:r instanceof oe?(n.font=t,n.brush=r):(n.font=t,n.bounds=r),n}return Qr(e,i),Object.defineProperty(e.prototype,"numberStyle",{get:function(){return this.internalNumberStyle},set:function(t){this.internalNumberStyle=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var n=this.getPageFromGraphics(t);return this.internalGetValue(n)},e.prototype.internalGetValue=function(t){var n=t.document.pages.indexOf(t)+1;return ai.convert(n,this.numberStyle)},e}(hi),en=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),tn=function(i){function e(t,r,n){for(var s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];var a=i.call(this)||this;return a.internalAutomaticFields=null,a.internalText="",a.font=t,a.brush=r,a.text=n,a.automaticFields=s,a}return en(e,i),Object.defineProperty(e.prototype,"text",{get:function(){return this.internalText},set:function(t){this.internalText=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"automaticFields",{get:function(){return this.internalAutomaticFields},set:function(t){this.internalAutomaticFields=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var r=this.text.toString();if(void 0!==this.automaticFields&&null!=this.automaticFields&&this.automaticFields.length>0)for(var n=0;n<this.automaticFields.length;n++)r=r.replace("{"+n+"}",this.automaticFields[n].getValue(t));return r},e}(hi),rn=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),nn=function(i){function e(){var t=i.call(this)||this;return t.list=new Ue,t.painterGraphics=[],t}return rn(e,i),e.prototype.performDraw=function(t,r,n,s){i.prototype.performDrawHelper.call(this,t,r,n,s);var a=this.getPageFromGraphics(t).document,h=this.getValue(t);if(this.list.containsKey(a)){var l=this.list.getValue(a),c=new b(r.x+this.location.x,r.y+this.location.y);t.drawPdfTemplate(l.template,c,new S(l.template.width*n,l.template.height*s)),this.painterGraphics.push(t)}else{var f=this.getSize(),d=new Xe(f);this.list.setValue(a,new ui(d,h)),d.graphics.drawString(h,this.getFont(),this.pen,this.getBrush(),0,0,f.width,f.height,this.stringFormat),c=new b(r.x+this.location.x,r.y+this.location.y),t.drawPdfTemplate(d,c,new S(d.width*n,d.height*s)),this.painterGraphics.push(t)}},e}(St),sn=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),on=function(i){function e(t,r){var n=i.call(this)||this;return n.internalNumberStyle=ue.Numeric,void 0===r?n.font=t:r instanceof oe?(n.font=t,n.brush=r):(n.font=t,n.bounds=r),n}return sn(e,i),Object.defineProperty(e.prototype,"numberStyle",{get:function(){return this.internalNumberStyle},set:function(t){this.internalNumberStyle=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var n=this.getPageFromGraphics(t);return ai.convert(n.section.parent.document.pages.count,this.numberStyle)},e}(nn),it=(()=>(function(i){i[i.Overlap=0]="Overlap",i[i.Inside=1]="Inside"}(it||(it={})),it))(),li=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ci=function(){function i(){}return Object.defineProperty(i.prototype,"backgroundBrush",{get:function(){return this.gridBackgroundBrush},set:function(e){this.gridBackgroundBrush=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textBrush",{get:function(){return this.gridTextBrush},set:function(e){this.gridTextBrush=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textPen",{get:function(){return this.gridTextPen},set:function(e){this.gridTextPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"font",{get:function(){return this.gridFont},set:function(e){this.gridFont=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"backgroundImage",{get:function(){return this.gridBackgroundImage},set:function(e){this.gridBackgroundImage=e},enumerable:!0,configurable:!0}),i}(),pn=function(i){function e(){var t=i.call(this)||this;return t.gridBorderOverlapStyle=it.Overlap,t.bAllowHorizontalOverflow=!1,t.gridHorizontalOverflowType=rt.LastPage,t}return li(e,i),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return void 0===this.gridCellSpacing&&(this.gridCellSpacing=0),this.gridCellSpacing},set:function(t){this.gridCellSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalOverflowType",{get:function(){return this.gridHorizontalOverflowType},set:function(t){this.gridHorizontalOverflowType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowHorizontalOverflow",{get:function(){return this.bAllowHorizontalOverflow},set:function(t){this.bAllowHorizontalOverflow=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellPadding",{get:function(){return void 0===this.gridCellPadding&&(this.gridCellPadding=new ct),this.gridCellPadding},set:function(t){void 0===this.gridCellPadding?(this.gridCellPadding=new ct,this.gridCellPadding=t):this.gridCellPadding=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderOverlapStyle",{get:function(){return this.gridBorderOverlapStyle},set:function(t){this.gridBorderOverlapStyle=t},enumerable:!0,configurable:!0}),e}(ci),gn=function(i){function e(){var t=i.call(this)||this;return t.gridCellBorders=ne.default,t}return li(e,i),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borders",{get:function(){return this.gridCellBorders},set:function(t){this.gridCellBorders=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellPadding",{get:function(){return this.gridCellPadding},set:function(t){(null==this.gridCellPadding||void 0===this.gridCellPadding)&&(this.gridCellPadding=new ct),this.gridCellPadding=t},enumerable:!0,configurable:!0}),e}(ci),yn=function(){function i(){}return Object.defineProperty(i.prototype,"backgroundBrush",{get:function(){return this.gridRowBackgroundBrush},enumerable:!0,configurable:!0}),i.prototype.setBackgroundBrush=function(e){if(this.gridRowBackgroundBrush=e,void 0!==this.parent)for(var t=0;t<this.parent.cells.count;t++)this.parent.cells.getCell(t).style.backgroundBrush=e},Object.defineProperty(i.prototype,"textBrush",{get:function(){return this.gridRowTextBrush},enumerable:!0,configurable:!0}),i.prototype.setTextBrush=function(e){if(this.gridRowTextBrush=e,void 0!==this.parent)for(var t=0;t<this.parent.cells.count;t++)this.parent.cells.getCell(t).style.textBrush=e},Object.defineProperty(i.prototype,"textPen",{get:function(){return this.gridRowTextPen},enumerable:!0,configurable:!0}),i.prototype.setTextPen=function(e){if(this.gridRowTextPen=e,void 0!==this.parent)for(var t=0;t<this.parent.cells.count;t++)this.parent.cells.getCell(t).style.textPen=e},Object.defineProperty(i.prototype,"font",{get:function(){return this.gridRowFont},enumerable:!0,configurable:!0}),i.prototype.setFont=function(e){if(this.gridRowFont=e,void 0!==this.parent)for(var t=0;t<this.parent.cells.count;t++)this.parent.cells.getCell(t).style.font=e},Object.defineProperty(i.prototype,"border",{get:function(){return void 0===this.gridRowBorder&&this.setBorder(new ne),this.gridRowBorder},enumerable:!0,configurable:!0}),i.prototype.setBorder=function(e){if(this.gridRowBorder=e,void 0!==this.parent)for(var t=0;t<this.parent.cells.count;t++)this.parent.cells.getCell(t).style.borders=e},i.prototype.setParent=function(e){this.parent=e},Object.defineProperty(i.prototype,"backgroundImage",{get:function(){return this.gridRowBackgroundImage},enumerable:!0,configurable:!0}),i.prototype.setBackgroundImage=function(e){this.gridRowBackgroundImage=e},i}(),rt=(()=>(function(i){i[i.NextPage=0]="NextPage",i[i.LastPage=1]="LastPage"}(rt||(rt={})),rt))(),dt=function(){function i(e){this.cellWidth=0,this.cellHeight=0,this.tempval=0,this.fontSpilt=!1,this.finsh=!0,this.rowSpanRemainingHeight=0,this.hasRowSpan=!1,this.hasColSpan=!1,this.isFinish=!0,this.present=!1,this.gridRowSpan=1,this.colSpan=1,void 0!==e&&(this.gridRow=e)}return Object.defineProperty(i.prototype,"isCellMergeContinue",{get:function(){return this.internalIsCellMergeContinue},set:function(e){this.internalIsCellMergeContinue=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isRowMergeContinue",{get:function(){return this.internalIsRowMergeContinue},set:function(e){this.internalIsRowMergeContinue=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCellMergeStart",{get:function(){return this.internalIsCellMergeStart},set:function(e){this.internalIsCellMergeStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isRowMergeStart",{get:function(){return this.internalIsRowMergeStart},set:function(e){this.internalIsRowMergeStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"remainingString",{get:function(){return this.remaining},set:function(e){this.remaining=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FinishedDrawingCell",{get:function(){return this.isFinish},set:function(e){this.isFinish=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stringFormat",{get:function(){return null==this.format&&(this.format=new ye),this.format},set:function(e){this.format=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"row",{get:function(){return this.gridRow},set:function(e){this.gridRow=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.objectValue},set:function(e){if(this.objectValue=e,this.objectValue instanceof Q){this.row.grid.isSingleGrid=!1,this.objectValue.ParentCell=this,this.objectValue.isChildGrid=!0;for(var r=this.row.grid.rows.count,n=0;n<r;n++)for(var s=this.row.grid.rows.getRow(n),o=s.cells.count,a=0;a<o;a++)s.cells.getCell(a).parent=this}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowSpan",{get:function(){return this.gridRowSpan},set:function(e){if(e<1)throw new Error("ArgumentException : Invalid span specified, must be greater than or equal to 1");this.gridRowSpan=e,this.row.rowSpanExists=!0,this.row.grid.hasRowSpanSpan=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return null==this.cellStyle&&(this.cellStyle=new gn),this.cellStyle},set:function(e){this.cellStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return 0===this.cellHeight&&(this.cellHeight=this.measureHeight()),this.cellHeight},set:function(e){this.cellHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnSpan",{get:function(){return this.colSpan},set:function(e){if(e<1)throw Error("Invalid span specified, must be greater than or equal to 1");this.colSpan=e,this.row.columnSpanExists=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return(0===this.cellWidth||this.row.grid.isComplete)&&(this.cellWidth=this.measureWidth()),Math.round(this.cellWidth)},set:function(e){this.cellWidth=e},enumerable:!0,configurable:!0}),i.prototype.measureWidth=function(){var e=0,t=new me;if("string"==typeof this.objectValue)e+=t.layout(this.objectValue,this.getTextFont(),this.stringFormat,new S(Number.MAX_VALUE,Number.MAX_VALUE),!1,new S(0,0)).actualSize.width,e+=2*(this.style.borders.left.width+this.style.borders.right.width);else if(this.objectValue instanceof Q)e=this.objectValue.size.width;else if(this.objectValue instanceof Ye||this.objectValue instanceof Je)e+=this.objectValue.width;else if(this.objectValue instanceof Ke){var n=this.objectValue;e+=t.layout(n.text,n.font,n.stringFormat,new S(0,0),!1,new S(0,0)).actualSize.width,e+=2*(this.style.borders.left.width+this.style.borders.right.width)}return this.objectValue instanceof Q?null!=this.style.cellPadding||void 0!==this.style.cellPadding?(void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(e+=this.style.cellPadding.left),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(e+=this.style.cellPadding.right)):(void 0!==this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(e+=this.row.grid.style.cellPadding.left),void 0!==this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(e+=this.row.grid.style.cellPadding.right)):e+=null!=this.style.cellPadding?this.style.cellPadding.left+this.style.cellPadding.right:this.row.grid.style.cellPadding.left+this.row.grid.style.cellPadding.right,e+this.row.grid.style.cellSpacing},i.prototype.drawCellBackground=function(e,t){var r=this.getBackgroundBrush();null!=r&&(e.save(),e.drawRectangle(r,t.x,t.y,t.width,t.height),e.restore()),null!=this.style.backgroundImage&&(this.getBackgroundImage(),e.drawImage(this.style.backgroundImage,t.x,t.y,t.width,t.height))},i.prototype.adjustContentLayoutArea=function(e){var t=new w(e.x,e.y,e.width,e.height);return this.objectValue instanceof Q?(null==this.style.cellPadding||void 0===this.style.cellPadding?(void 0!==this.gridRow.grid.style.cellPadding.left&&this.gridRow.grid.style.cellPadding.hasLeftPad&&(t.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,t.width-=this.gridRow.grid.style.cellPadding.left),void 0!==this.gridRow.grid.style.cellPadding.top&&this.gridRow.grid.style.cellPadding.hasTopPad&&(t.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,t.height-=this.gridRow.grid.style.cellPadding.top),void 0!==this.gridRow.grid.style.cellPadding.right&&this.gridRow.grid.style.cellPadding.hasRightPad&&(t.width-=this.gridRow.grid.style.cellPadding.right),void 0!==this.gridRow.grid.style.cellPadding.bottom&&this.gridRow.grid.style.cellPadding.hasBottomPad&&(t.height-=this.gridRow.grid.style.cellPadding.bottom)):(void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(t.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,t.width-=this.style.cellPadding.left),void 0!==this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(t.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,t.height-=this.style.cellPadding.top),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(t.width-=this.style.cellPadding.right),void 0!==this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(t.height-=this.style.cellPadding.bottom)),t.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,t.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):void 0===this.style.cellPadding||null==this.style.cellPadding?(t.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,t.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,t.width-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left,t.height-=this.gridRow.grid.style.cellPadding.bottom+this.gridRow.grid.style.cellPadding.top,t.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):(t.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,t.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,t.width-=this.style.cellPadding.right+this.style.cellPadding.left,t.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,t.height-=this.style.cellPadding.bottom+this.style.cellPadding.top,t.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width,1===this.rowSpan&&(t.width-=this.style.borders.left.width)),t},i.prototype.draw=function(e,t,r){var n=null;if(this.internalIsCellMergeContinue||this.internalIsRowMergeContinue){if(!this.internalIsCellMergeContinue||!this.row.grid.style.allowHorizontalOverflow)return n;if(this.row.rowOverflowIndex>0&&this.row.cells.indexOf(this)!=this.row.rowOverflowIndex+1||0==this.row.rowOverflowIndex&&this.internalIsCellMergeContinue)return n}t=this.adjustOuterLayoutArea(t,e),this.drawCellBackground(e,t);var s=this.getTextPen(),o=this.getTextBrush();void 0===s&&void 0===o&&(o=new pe(new g(0,0,0)));var a=this.getTextFont(),h=this.getStringFormat(),l=t;if(l.height>=e.clientSize.height&&this.row.grid.allowRowBreakAcrossPages&&(l.height-=l.y),l=this.adjustContentLayoutArea(l),"string"==typeof this.objectValue||"string"==typeof this.remaining){var f=void 0;if(f=l.height<a.height?new w(l.x,l.y,l.width,a.height):l,l.height<a.height&&this.row.grid.isChildGrid&&null!=this.row.grid.ParentCell){var d=f.height-this.row.grid.ParentCell.row.grid.style.cellPadding.bottom-this.row.grid.style.cellPadding.bottom;-1!=this.row.grid.splitChildRowIndex&&(this.fontSpilt=!0,this.row.rowFontSplit=!0),d>0&&d<a.height&&(f.height=d)}0!=this.gridRow.grid.style.cellSpacing&&(f.width-=this.gridRow.grid.style.cellSpacing,t.width-=this.gridRow.grid.style.cellSpacing),this.isFinish?(e.drawString(""===this.remaining?this.remaining:this.objectValue,a,s,o,f.x,f.y,f.width,f.height,h),-1!=this.row.grid.splitChildRowIndex&&!this.row.grid.isChildGrid&&void 0===this.remaining&&(this.remaining="")):(null==this.remaining&&(this.remaining=""),this.row.repeatFlag&&e.drawString(this.remaining,a,s,o,f.x,f.y,f.width,f.height,h),this.isFinish=!0),n=e.stringLayoutResult}else if(this.objectValue instanceof Q){var v,p=this.objectValue;p.isChildGrid=!0,p.ParentCell=this,v=l,0!=this.gridRow.grid.style.cellSpacing&&(t.width-=this.gridRow.grid.style.cellSpacing);var y=new di(p),P=new Cn;null!=this.row.grid.LayoutFormat?P=this.row.grid.LayoutFormat:P.layout=fe.Paginate;var V=new lt;if(null!=e.layer){V.page=e.page,V.bounds=v,V.format=P,p.setSpan(),p.checkSpan();var R=y.Layouter(V);this.value=p,-1!==this.row.grid.splitChildRowIndex&&(this.height=this.row.rowBreakHeightValue),V.page!=R.page&&(R.bounds.height=this.row.rowBreakHeightValue,0==this.row.rowBreakHeight?this.row.NestedGridLayoutResult=R:this.row.rowBreakHeight=this.row.rowBreakHeightValue)}}else if(this.objectValue instanceof Ye||this.objectValue instanceof Je){var C;C=this.objectValue.width<=l.width?new w(l.x,l.y,this.objectValue.width,l.height):l,e.drawImage(this.objectValue,C.x,C.y,C.width,C.height)}else this.objectValue instanceof Ke?this.objectValue.draw(e.currentPage,l):void 0===this.objectValue&&(this.objectValue="",e.drawString(this.objectValue,a,s,o,l.x,l.y,l.width,l.height,h),null!=this.style.cellPadding&&0==this.style.cellPadding.bottom&&0==this.style.cellPadding.left&&0==this.style.cellPadding.right&&0==this.style.cellPadding.top&&(t.width-=this.style.borders.left.width+this.style.borders.right.width),0!=this.gridRow.grid.style.cellSpacing&&(t.width-=this.gridRow.grid.style.cellSpacing));return null!=this.style.borders&&(this.fontSpilt?-1!=this.row.grid.ParentCell.row.grid.splitChildRowIndex&&(this.row.rowFontSplit=!1,this.drawCellBorders(e,t)):this.drawCellBorders(e,t)),n},i.prototype.drawCellBorders=function(e,t){this.row.grid.style.borderOverlapStyle===it.Inside&&(t.x+=this.style.borders.left.width,t.y+=this.style.borders.top.width,t.width-=this.style.borders.right.width,t.height-=this.style.borders.bottom.width);var r=new b(t.x,t.y+t.height),n=new b(t.x,t.y),s=this.cellStyle.borders.left;this.cellStyle.borders.left.dashStyle===W.Solid&&(s.lineCap=ke.Square),0!==s.width&&e.drawLine(s,r,n),r=new b(t.x+t.width,t.y),n=new b(t.x+t.width,t.y+t.height),t.x+t.width>e.clientSize.width-(s=this.cellStyle.borders.right).width/2&&(r=new b(e.clientSize.width-s.width/2,t.y),n=new b(e.clientSize.width-s.width/2,t.y+t.height)),this.cellStyle.borders.right.dashStyle===W.Solid&&(s.lineCap=ke.Square),0!==s.width&&e.drawLine(s,r,n),r=new b(t.x,t.y),n=new b(t.x+t.width,t.y),s=this.cellStyle.borders.top,this.cellStyle.borders.top.dashStyle===W.Solid&&(s.lineCap=ke.Square),0!==s.width&&e.drawLine(s,r,n),r=new b(t.x+t.width,t.y+t.height),n=new b(t.x,t.y+t.height),t.y+t.height>e.clientSize.height-(s=this.cellStyle.borders.bottom).width/2&&(r=new b(t.x+t.width,e.clientSize.height-s.width/2),n=new b(t.x,e.clientSize.height-s.width/2)),this.cellStyle.borders.bottom.dashStyle===W.Solid&&(s.lineCap=ke.Square),0!==s.width&&e.drawLine(s,r,n)},i.prototype.adjustOuterLayoutArea=function(e,t){var r=!1,n=this.row.grid.style.cellSpacing;n>0&&(e=new w(e.x+n,e.y+n,e.width-n,e.height-n));var s=this.row.cells.indexOf(this);if(this.columnSpan>1||this.row.rowOverflowIndex>0&&s==this.row.rowOverflowIndex+1&&this.isCellMergeContinue){if(1==(o=this.columnSpan)&&this.isCellMergeContinue)for(var a=s+1;a<this.row.grid.columns.count&&this.row.cells.getCell(a).isCellMergeContinue;a++)o++;for(var h=0,l=s;l<s+o;l++){if(this.row.grid.style.allowHorizontalOverflow){var f=this.row.grid.size.width<t.clientSize.width?this.row.grid.size.width:t.clientSize.width;if((this.row.grid.size.width>t.clientSize.width?e.x+h+this.row.grid.columns.getColumn(l).width:h+this.row.grid.columns.getColumn(l).width)>f)break}h+=this.row.grid.columns.getColumn(l).width}e.width=h-=this.row.grid.style.cellSpacing}if(this.rowSpan>1||this.row.rowSpanExists){var o=this.rowSpan,d=this.row.grid.rows.rowCollection.indexOf(this.row);-1==d&&-1!=(d=this.row.grid.headers.indexOf(this.row))&&(r=!0);var p=0;for(l=d;l<d+o;l++){p+=r?this.row.grid.headers.getHeader(l).height:this.row.grid.rows.getRow(l).height;var v=this.row.grid.rows.getRow(l);this.row.grid.rows.rowCollection.indexOf(v)}this.row.cells.indexOf(this),e.height=p-=this.row.grid.style.cellSpacing,this.row.rowMergeComplete||(e.height=p)}return e},i.prototype.getTextFont=function(){return void 0!==this.style.font&&null!=this.style.font?this.style.font:void 0!==this.row.style.font&&null!=this.row.style.font?this.row.style.font:void 0!==this.row.grid.style.font&&null!=this.row.grid.style.font?this.row.grid.style.font:Ve.defaultFont},i.prototype.getTextBrush=function(){return void 0!==this.style.textBrush&&null!=this.style.textBrush?this.style.textBrush:void 0!==this.row.style.textBrush&&null!=this.row.style.textBrush?this.row.style.textBrush:this.row.grid.style.textBrush},i.prototype.getTextPen=function(){return void 0!==this.style.textPen&&null!=this.style.textPen?this.style.textPen:void 0!==this.row.style.textPen&&null!=this.row.style.textPen?this.row.style.textPen:this.row.grid.style.textPen},i.prototype.getBackgroundBrush=function(){return void 0!==this.style.backgroundBrush&&null!=this.style.backgroundBrush?this.style.backgroundBrush:void 0!==this.row.style.backgroundBrush&&null!=this.row.style.backgroundBrush?this.row.style.backgroundBrush:this.row.grid.style.backgroundBrush},i.prototype.getBackgroundImage=function(){return void 0!==this.style.backgroundImage&&null!=this.style.backgroundImage?this.style.backgroundImage:void 0!==this.row.style.backgroundImage&&null!=this.row.style.backgroundImage?this.row.style.backgroundImage:this.row.grid.style.backgroundImage},i.prototype.getStringFormat=function(){return void 0!==this.style.stringFormat&&null!=this.style.stringFormat?this.style.stringFormat:this.stringFormat},i.prototype.measureHeight=function(){var e=this.calculateWidth();null==this.style.cellPadding||void 0===this.style.cellPadding?e-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(e-=this.style.cellPadding.right+this.style.cellPadding.left,e-=this.style.borders.left.width+this.style.borders.right.width);var t=0,r=new me;if("string"==typeof this.objectValue||"string"==typeof this.remaining){var n=this.objectValue;this.isFinish||(n=null===this.remaining||""===this.remaining||void 0===this.remaining?this.objectValue:this.remaining);var o=this.row.cells.indexOf(this);0!=this.gridRow.grid.style.cellSpacing&&(e-=2*this.gridRow.grid.style.cellSpacing),!this.row.cells.getCell(o).hasColSpan&&!this.row.cells.getCell(o).hasRowSpan&&(this.gridRow.grid.isChildGrid?(e<0?(this.tempval=e,null==this.style.cellPadding||void 0===this.style.cellPadding?this.tempval+=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(this.tempval+=this.style.cellPadding.right+this.style.cellPadding.left,this.tempval+=this.style.borders.left.width+this.style.borders.right.width)):this.tempval=e,t+=r.layout(n,this.getTextFont(),this.stringFormat,new S(this.tempval,0),!1,new S(0,0)).actualSize.height):t+=r.layout(n,this.getTextFont(),this.stringFormat,new S(e,0),!1,new S(0,0)).actualSize.height),t+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else if(this.objectValue instanceof Q){o=this.row.cells.indexOf(this);var a=0;null!=this.style.cellPadding||void 0!==this.style.cellPadding?(a=this.calculateWidth(),void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(a-=this.style.cellPadding.left),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(a-=this.style.cellPadding.right)):null!=this.row.grid.style.cellPadding||void 0!==this.row.grid.style.cellPadding?(a=this.calculateWidth(),void 0!==this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(a-=this.row.grid.style.cellPadding.left),void 0!==this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(a-=this.row.grid.style.cellPadding.right)):a=this.calculateWidth(),this.objectValue.tempWidth=a,this.row.cells.getCell(o).hasColSpan||this.row.cells.getCell(o).hasRowSpan?t+=2*(this.style.borders.top.width+this.style.borders.bottom.width):t=this.objectValue.size.height,0!==this.gridRow.grid.style.cellSpacing&&(e-=2*this.gridRow.grid.style.cellSpacing),(null!=this.style.cellPadding||void 0!==this.style.cellPadding)&&(void 0!==this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(t+=this.row.grid.style.cellPadding.top),this.row.grid.style.cellPadding.hasBottomPad&&void 0!==this.row.grid.style.cellPadding.bottom&&(t+=this.row.grid.style.cellPadding.bottom)),t+=this.objectValue.style.cellSpacing}else if(this.objectValue instanceof Ye||this.objectValue instanceof Je)t+=this.objectValue.height;else if(this.objectValue instanceof Ke){var h=this.objectValue;t+=r.layout(h.text,h.font,h.stringFormat,new S(e,0),!1,new S(0,0)).actualSize.height,t+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else void 0===this.objectValue&&(null==this.style.cellPadding||void 0===this.style.cellPadding?e-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(e-=this.style.cellPadding.right+this.style.cellPadding.left,e-=this.style.borders.left.width+this.style.borders.right.width),t+=2*(this.style.borders.top.width+this.style.borders.bottom.width));return this.objectValue instanceof Q?null==this.style.cellPadding||void 0===this.style.cellPadding?(void 0!==this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(t+=this.row.grid.style.cellPadding.top),void 0!==this.row.grid.style.cellPadding.bottom&&this.row.grid.style.cellPadding.hasBottomPad&&(t+=this.row.grid.style.cellPadding.bottom)):(void 0!==this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(t+=this.style.cellPadding.top),void 0!==this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(t+=this.style.cellPadding.bottom)):t+=null==this.style.cellPadding||void 0===this.style.cellPadding?this.row.grid.style.cellPadding.top+this.row.grid.style.cellPadding.bottom:this.style.cellPadding.top+this.style.cellPadding.bottom,t+this.row.grid.style.cellSpacing},i.prototype.calculateWidth=function(){var e=this.row.cells.indexOf(this),r=(this.row.grid.rows.rowCollection.indexOf(this.row),this.columnSpan),n=0;if(1===r)for(var s=0;s<r;s++)n+=this.row.grid.columns.getColumn(e+s).width;else if(r>1)for(s=0;s<r;s++)n+=this.row.grid.columns.getColumn(e+s).width,s+1<r&&(this.row.cells.getCell(e+s+1).hasColSpan=!0);if(null!=this.parent&&this.parent.row.width>0&&this.row.grid.isChildGrid&&null!=this.parent&&this.row.width>this.parent.row.width){n=0;for(var o=0;o<this.parent.columnSpan;o++)n+=this.parent.row.grid.columns.getColumn(o).width;n/=this.row.cells.count}return n},i}(),mn=function(){function i(e){this.cells=[],this.gridRow=e}return i.prototype.getCell=function(e){if(e<0||e>=this.count)throw new Error("IndexOutOfRangeException");return this.cells[e]},Object.defineProperty(i.prototype,"count",{get:function(){return this.cells.length},enumerable:!0,configurable:!0}),i.prototype.add=function(e){if(void 0===e){var t=new dt;return this.add(t),e}e.row=this.gridRow,this.cells.push(e)},i.prototype.indexOf=function(e){return this.cells.indexOf(e)},i}(),bn=function(){function i(e){this.columnWidth=0,this.grid=e}return Object.defineProperty(i.prototype,"width",{get:function(){return this.columnWidth},set:function(e){this.isCustomWidth=!0,this.columnWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"format",{get:function(){return null==this.stringFormat&&(this.stringFormat=new ye),this.stringFormat},set:function(e){this.stringFormat=e},enumerable:!0,configurable:!0}),i}(),vn=function(){function i(e){this.internalColumns=[],this.columnWidth=0,this.grid=e,this.internalColumns=[]}return i.prototype.add=function(e){for(var t=0;t<e;t++){this.internalColumns.push(new bn(this.grid));for(var r=0;r<this.grid.rows.count;r++){var n=this.grid.rows.getRow(r),s=new dt;s.value="",n.cells.add(s)}}},Object.defineProperty(i.prototype,"count",{get:function(){return this.internalColumns.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return 0===this.columnWidth&&(this.columnWidth=this.measureColumnsWidth()),0!==this.grid.initialWidth&&this.columnWidth!==this.grid.initialWidth&&!this.grid.style.allowHorizontalOverflow&&(this.columnWidth=this.grid.initialWidth,this.grid.isPageWidth=!0),this.columnWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columns",{get:function(){return this.internalColumns},enumerable:!0,configurable:!0}),i.prototype.getColumn=function(e){if(e>=0&&e<=this.columns.length)return this.columns[e];throw Error("can not get the column from the index: "+e)},i.prototype.measureColumnsWidth=function(){var e=0;this.grid.measureColumnsWidth();for(var t=0,r=this.internalColumns.length;t<r;t++)e+=this.internalColumns[t].width;return e},i.prototype.getDefaultWidths=function(e){for(var t=[],r=this.count,n=0;n<this.count;n++)this.grid.isPageWidth&&e>=0&&!this.internalColumns[n].isCustomWidth?this.internalColumns[n].width=0:(t[n]=this.internalColumns[n].width,this.internalColumns[n].width>0&&this.internalColumns[n].isCustomWidth?(e-=this.internalColumns[n].width,r--):t[n]=0);for(n=0;n<this.count;n++)t[n]<=0&&(t[n]=e/r);return t},i}(),fi=function(){function i(e){this.gridRowOverflowIndex=0,this.rowHeight=0,this.rowWidth=0,this.isrowFinish=!1,this.isRowSpanRowHeightSet=!1,this.noOfPageCount=0,this.isRowHeightSet=!1,this.isPageBreakRowSpanApplied=!1,this.isRowMergeComplete=!0,this.repeatFlag=!1,this.rowFontSplit=!1,this.isHeaderRow=!1,this.pdfGrid=e}return Object.defineProperty(i.prototype,"rowSpanExists",{get:function(){return this.bRowSpanExists},set:function(e){this.bRowSpanExists=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cells",{get:function(){return null==this.gridCells&&(this.gridCells=new mn(this)),this.gridCells},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"grid",{get:function(){return this.pdfGrid},set:function(e){this.pdfGrid=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return void 0===this.rowStyle&&(this.rowStyle=new yn,this.rowStyle.setParent(this)),this.rowStyle},set:function(e){this.rowStyle=e;for(var t=0;t<this.cells.count;t++)this.cells.getCell(t).style.borders=e.border,void 0!==e.font&&(this.cells.getCell(t).style.font=e.font),void 0!==e.backgroundBrush&&(this.cells.getCell(t).style.backgroundBrush=e.backgroundBrush),void 0!==e.backgroundImage&&(this.cells.getCell(t).style.backgroundImage=e.backgroundImage),void 0!==e.textBrush&&(this.cells.getCell(t).style.textBrush=e.textBrush),void 0!==e.textPen&&(this.cells.getCell(t).style.textPen=e.textPen)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowBreakHeight",{get:function(){return void 0===this.gridRowBreakHeight&&(this.gridRowBreakHeight=0),this.gridRowBreakHeight},set:function(e){this.gridRowBreakHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowOverflowIndex",{get:function(){return this.gridRowOverflowIndex},set:function(e){this.gridRowOverflowIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.isRowHeightSet||(this.rowHeight=this.measureHeight()),this.rowHeight},set:function(e){this.rowHeight=e,this.isRowHeightSet=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return(0===this.rowWidth||void 0===this.rowWidth)&&(this.rowWidth=this.measureWidth()),this.rowWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NestedGridLayoutResult",{get:function(){return this.gridResult},set:function(e){this.gridResult=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnSpanExists",{get:function(){return this.bColumnSpanExists},set:function(e){this.bColumnSpanExists=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowMergeComplete",{get:function(){return this.isRowMergeComplete},set:function(e){this.isRowMergeComplete=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowIndex",{get:function(){return this.grid.rows.rowCollection.indexOf(this)},enumerable:!0,configurable:!0}),i.prototype.measureHeight=function(){var t,e=0,r=0;t=this.cells.getCell(0).rowSpan>1?0:this.cells.getCell(0).height;for(var n=0;n<this.cells.count;n++){var s=this.cells.getCell(n);if(s.rowSpanRemainingHeight>e&&(e=s.rowSpanRemainingHeight),this.rowMergeComplete=!1,s.rowSpan>1){for(var o=n,a=this.isHeaderRow?this.grid.headers.indexOf(this):this.grid.rows.rowCollection.indexOf(this),h=0;h<s.rowSpan;h++)h+1<s.rowSpan&&((this.isHeaderRow?this.grid.headers.getHeader(a+h+1):this.grid.rows.getRow(a+h+1)).cells.getCell(o).hasRowSpan=!0);r<s.height&&(r=s.height)}else t=Math.max(t,s.height)}return r>t&&(t=r),0===t?t=r:e>0&&(t+=e),t},i.prototype.measureWidth=function(){for(var e=0,t=0;t<this.grid.columns.count;t++)e+=this.grid.columns.getColumn(t).width;return e},i}(),wn=function(){function i(e){this.rows=[],this.grid=e}return Object.defineProperty(i.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rowCollection",{get:function(){return this.rows},enumerable:!0,configurable:!0}),i.prototype.addRow=function(e){if(void 0===e){var t=new fi(this.grid);return this.addRow(t),t}if(e.style.setBackgroundBrush(this.grid.style.backgroundBrush),e.style.setFont(this.grid.style.font),e.style.setTextBrush(this.grid.style.textBrush),e.style.setTextPen(this.grid.style.textPen),0===e.cells.count)for(var r=0;r<this.grid.columns.count;r++)e.cells.add(new dt);this.rows.push(e)},i.prototype.getRow=function(e){return this.rows[e]},i}(),Sn=function(){function i(e){this.rows=[],this.grid=e,this.rows=[]}return i.prototype.getHeader=function(e){return this.rows[e]},Object.defineProperty(i.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),i.prototype.add=function(e){if("number"==typeof e){for(var t=void 0,r=0;r<e;r++){(t=new fi(this.grid)).isHeaderRow=!0;for(var n=0;n<this.grid.columns.count;n++)t.cells.add(new dt);this.rows.push(t)}return this.rows}this.rows.push(e)},i.prototype.indexOf=function(e){return this.rows.indexOf(e)},i}(),Pn=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Q=function(i){function e(){var t=i.call(this)||this;return t.gridSize=new S(0,0),t.isGridSplit=!1,t.isRearranged=!1,t.pageBounds=new w,t.listOfNavigatePages=[],t.parentCellIndex=0,t.tempWidth=0,t.breakRow=!0,t.splitChildRowIndex=-1,t.hasRowSpanSpan=!1,t.hasColumnSpan=!1,t.isSingleGrid=!0,t}return Pn(e,i),Object.defineProperty(e.prototype,"raiseBeginCellDraw",{get:function(){return void 0!==this.beginCellDraw&&null!==typeof this.beginCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"raiseEndCellDraw",{get:function(){return void 0!==this.endCellDraw&&null!==typeof this.endCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatHeader",{get:function(){return(null==this.bRepeatHeader||void 0===this.bRepeatHeader)&&(this.bRepeatHeader=!1),this.bRepeatHeader},set:function(t){this.bRepeatHeader=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowRowBreakAcrossPages",{get:function(){return this.breakRow},set:function(t){this.breakRow=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return(null==this.gridColumns||void 0===this.gridColumns)&&(this.gridColumns=new vn(this)),this.gridColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return null==this.gridRows&&(this.gridRows=new wn(this)),this.gridRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return(null==this.gridHeaders||void 0===this.gridHeaders)&&(this.gridHeaders=new Sn(this)),this.gridHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialWidth",{get:function(){return this.gridInitialWidth},set:function(t){this.gridInitialWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return null==this.gridStyle&&(this.gridStyle=new pn),this.gridStyle},set:function(t){null==this.gridStyle&&(this.gridStyle=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPageWidth",{get:function(){return this.ispageWidth},set:function(t){this.ispageWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChildGrid",{get:function(){return this.ischildGrid},set:function(t){this.ischildGrid=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return(0===this.gridSize.width||void 0===this.gridSize.width)&&0===this.gridSize.height&&(this.gridSize=this.measure()),this.gridSize},set:function(t){this.gridSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentCell",{get:function(){return this.parentCell},set:function(t){this.parentCell=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LayoutFormat",{get:function(){return this.layoutFormat},enumerable:!0,configurable:!0}),e.prototype.draw=function(t,r,n,s){if(r instanceof b&&void 0===r.width&&void 0===n)return this.drawHelper(t,r.x,r.y);if("number"==typeof r&&"number"==typeof n&&void 0===s)return this.drawHelper(t,r,n,null);if(r instanceof w&&void 0!==r.width&&void 0===n)return this.drawHelper(t,r,null);if(r instanceof b&&void 0===r.width&&n instanceof Z)return this.drawHelper(t,r.x,r.y,n);if("number"==typeof r&&"number"==typeof n&&(s instanceof Z||null==s)){var a=new w(r,n,t.graphics.clientSize.width-r,0);return this.drawHelper(t,a,s)}return this.drawHelper(t,r,r instanceof w&&void 0!==r.width&&"boolean"==typeof n?null:n)},e.prototype.measure=function(){for(var t=0,r=this.columns.width,n=0;n<this.headers.count;n++)t+=this.headers.getHeader(n).height;for(n=0;n<this.rows.count;n++)t+=this.rows.getRow(n).height;return new S(r,t)},e.prototype.onBeginCellDraw=function(t){this.raiseBeginCellDraw&&this.beginCellDraw(this,t)},e.prototype.onEndCellDraw=function(t){this.raiseEndCellDraw&&this.endCellDraw(this,t)},e.prototype.layout=function(t){var r=t.bounds.width,n=t.bounds.height,s=!1;if((void 0===t.bounds.width||0===t.bounds.width)&&(r=t.page.getClientSize().width-t.bounds.x,s=!0),(void 0===t.bounds.height||0===t.bounds.height)&&(n=t.page.getClientSize().height-t.bounds.y,s=!0),s&&(t.bounds=new w(t.bounds.x,t.bounds.y,r,n)),0!==this.rows.count){var o=this.rows.getRow(0).cells.getCell(0).style;if(null!=o.borders&&(null!=o.borders.left&&1!==o.borders.left.width||null!=o.borders.top&&1!==o.borders.top.width)&&t.bounds.x===ne.default.right.width/2&&t.bounds.y===ne.default.right.width/2){var l=new w(o.borders.left.width/2,o.borders.top.width/2,this.gridSize.width,this.gridSize.height);t.bounds=l}}return this.setSpan(),this.checkSpan(),this.layoutFormat=t.format,this.gridLocation=t.bounds,new di(this).Layouter(t)},e.prototype.setSpan=function(){for(var t=1,r=1,n=0,s=0,o=0,a=this.headers.count,h=0;h<a;h++){var l=this.headers.getHeader(h);o=0;for(var c=l.cells.count,f=0;f<c;f++){var d=l.cells.getCell(f);if(o=Math.max(o,d.rowSpan),!d.isCellMergeContinue&&!d.isRowMergeContinue&&(d.columnSpan>1||d.rowSpan>1)){if(d.columnSpan+f>l.cells.count)throw new Error("Invalid span specified at row "+f.toString()+" column "+h.toString());if(d.rowSpan+h>this.headers.count)throw new Error("Invalid span specified at Header "+f.toString()+" column "+h.toString());if(d.columnSpan>1&&d.rowSpan>1){for(t=d.columnSpan,r=d.rowSpan,n=f,s=h,d.isCellMergeStart=!0,d.isRowMergeStart=!0;t>1;)n++,l.cells.getCell(n).isCellMergeContinue=!0,l.cells.getCell(n).isRowMergeContinue=!0,l.cells.getCell(n).rowSpan=r,t--;for(n=f,t=d.columnSpan;r>1;){for(s++,this.headers.getHeader(s).cells.getCell(f).isRowMergeContinue=!0,this.headers.getHeader(s).cells.getCell(n).isRowMergeContinue=!0,r--;t>1;)n++,this.headers.getHeader(s).cells.getCell(n).isCellMergeContinue=!0,this.headers.getHeader(s).cells.getCell(n).isRowMergeContinue=!0,t--;t=d.columnSpan,n=f}}else if(d.columnSpan>1&&1===d.rowSpan)for(t=d.columnSpan,n=f,d.isCellMergeStart=!0;t>1;)n++,l.cells.getCell(n).isCellMergeContinue=!0,t--;else if(1===d.columnSpan&&d.rowSpan>1)for(r=d.rowSpan,s=h;r>1;)s++,this.headers.getHeader(s).cells.getCell(f).isRowMergeContinue=!0,r--}}l.maximumRowSpan=o}},e.prototype.checkSpan=function(){var t,s,r=1,n=0,o=0;if(t=r=1,s=o=0,this.hasRowSpanSpan||this.hasColumnSpan)for(var a=this.rows.count,h=0;h<a;h++){var l=this.rows.getRow(h);n=0;for(var c=l.cells.count,f=0;f<c;f++){var d=l.cells.getCell(f);if(n=Math.max(n,d.rowSpan),!d.isCellMergeContinue&&!d.isRowMergeContinue&&(d.columnSpan>1||d.rowSpan>1)){if(d.columnSpan+f>l.cells.count)throw new Error("Invalid span specified at row  "+f.toString()+" column "+h.toString());if(d.rowSpan+h>this.rows.count)throw new Error("Invalid span specified at row  "+f.toString()+" column "+h.toString());if(d.columnSpan>1&&d.rowSpan>1){for(t=d.columnSpan,r=d.rowSpan,s=f,o=h,d.isCellMergeStart=!0,d.isRowMergeStart=!0;t>1;)s++,l.cells.getCell(s).isCellMergeContinue=!0,l.cells.getCell(s).isRowMergeContinue=!0,t--;for(s=f,t=d.columnSpan;r>1;){for(o++,this.rows.getRow(o).cells.getCell(f).isRowMergeContinue=!0,this.rows.getRow(o).cells.getCell(s).isRowMergeContinue=!0,r--;t>1;)s++,this.rows.getRow(o).cells.getCell(s).isCellMergeContinue=!0,this.rows.getRow(o).cells.getCell(s).isRowMergeContinue=!0,t--;t=d.columnSpan,s=f}}else if(d.columnSpan>1&&1===d.rowSpan)for(t=d.columnSpan,s=f,d.isCellMergeStart=!0;t>1;)s++,l.cells.getCell(s).isCellMergeContinue=!0,t--;else if(1===d.columnSpan&&d.rowSpan>1)for(r=d.rowSpan,o=h;r>1;)o++,this.rows.getRow(o).cells.getCell(f).isRowMergeContinue=!0,r--}}l.maximumRowSpan=n}},e.prototype.measureColumnsWidth=function(t){if(void 0!==t){this.isPageWidth=!1;for(var r=this.columns.getDefaultWidths(t.width-t.x),n=0,s=this.columns.count;n<s;n++)this.columns.getColumn(n).columnWidth=r[n],this.tempWidth=r[n];if(null!=this.ParentCell&&0==this.style.allowHorizontalOverflow&&0==this.ParentCell.row.grid.style.allowHorizontalOverflow){var o=0,a=0,h=this.columns.count,l=0;for((null!=this.ParentCell.style.cellPadding||void 0!==this.ParentCell.style.cellPadding)&&(void 0!==this.ParentCell.style.cellPadding.left&&this.ParentCell.style.cellPadding.hasLeftPad&&(o+=this.ParentCell.style.cellPadding.left),void 0!==this.ParentCell.style.cellPadding.right&&this.ParentCell.style.cellPadding.hasRightPad&&(o+=this.ParentCell.style.cellPadding.right)),n=0;n<this.ParentCell.columnSpan;n++)a+=this.ParentCell.row.grid.columns.getColumn(this.parentCellIndex+n).width;for(var c=0;c<this.columns.count;c++)this.gridColumns.getColumn(c).width>0&&this.gridColumns.getColumn(c).isCustomWidth&&(a-=this.gridColumns.getColumn(c).width,h--);if((null!=this.ParentCell.row.grid.style.cellPadding||void 0!==this.ParentCell.row.grid.style.cellPadding)&&(void 0!==this.ParentCell.row.grid.style.cellPadding.top&&this.ParentCell.row.grid.style.cellPadding.hasTopPad&&(o+=this.ParentCell.row.grid.style.cellPadding.top),void 0!==this.ParentCell.row.grid.style.cellPadding.bottom&&this.ParentCell.row.grid.style.cellPadding.hasBottomPad&&(o+=this.ParentCell.row.grid.style.cellPadding.bottom)),0!=this.ParentCell.row.grid.style.cellSpacing&&(a-=2*this.ParentCell.row.grid.style.cellSpacing),a>o&&(this.tempWidth=l=(a-o)/h,null!=this.ParentCell))for(c=0;c<this.columns.count;c++)this.columns.getColumn(c).isCustomWidth||(this.columns.getColumn(c).columnWidth=l)}}else{r=[this.columns.count];for(var f=0;f<this.columns.count;f++)r[f]=0;var d=0;if((void 0===this.isChildGrid&&void 0!==this.gridLocation||null===this.isChildGrid&&void 0!==this.gridLocation)&&(this.initialWidth=this.gridLocation.width),this.headers.count>0){var p=this.headers.getHeader(0).cells.count,v=this.headers.count;for(n=0;n<p;n++){for(d=0,c=0;c<v;c++){var y=Math.min(this.initialWidth,this.headers.getHeader(c).cells.getCell(n).width);d=Math.max(d,y)}r[n]=d}}d=0,n=0;for(var P=this.columns.count;n<P;n++){for(c=0,v=this.rows.count;c<v;c++)(1==this.rows.getRow(c).cells.getCell(n).columnSpan&&!this.rows.getRow(c).cells.getCell(n).isCellMergeContinue||null!=this.rows.getRow(c).cells.getCell(n).value)&&(null==this.rows.getRow(c).cells.getCell(n).value||this.rows.getRow(c).grid.style.allowHorizontalOverflow||(this.rows.getRow(c),this.rows.getRow(c),this.rows.getRow(c).cells.getCell(n)),y=0,y=this.initialWidth>0?Math.min(this.initialWidth,this.rows.getRow(c).cells.getCell(n).width):this.rows.getRow(c).cells.getCell(n).width,d=Math.max(r[n],Math.max(d,y)),d=Math.max(this.columns.getColumn(n).width,d));0!=this.rows.count&&(r[n]=d),d=0}n=0;for(var R=this.rows.count;n<R;n++){c=0;for(var C=this.columns.count;c<C;c++)if(this.rows.getRow(n).cells.getCell(c).columnSpan>1)for(var T=1;T<this.rows.getRow(n).cells.getCell(c).columnSpan;T++);}for(n=0,s=this.columns.count;n<s;n++)(this.columns.getColumn(n).width<=0||this.columns.getColumn(n).width>0&&!this.columns.getColumn(n).isCustomWidth)&&(this.columns.getColumn(n).columnWidth=r[n]);o=0;var A=0,z=this.columns.count,se=0;for(A=this.tempWidth,c=0;c<this.columns.count;c++)this.gridColumns.getColumn(c).width>0&&this.gridColumns.getColumn(c).isCustomWidth&&(A-=this.gridColumns.getColumn(c).width,z--);if(A>0&&0!=this.ParentCell.row.grid.style.cellSpacing&&(A-=2*this.ParentCell.row.grid.style.cellSpacing),A>o&&(se=A/z,null!=this.ParentCell))for(c=0;c<this.columns.count;c++)this.columns.getColumn(c).isCustomWidth||(this.columns.getColumn(c).columnWidth=se)}},e}(Vt),ve=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),di=function(i){function e(t){var r=i.call(this,t)||this;return r.gridInitialWidth=0,r.gridSize=new S(0,0),r.parentCellIndex=0,r.tempWidth=0,r.childheight=0,r.isChildGrid=!1,r.hasRowSpanSpan=!1,r.isRearranged=!1,r.pageBounds=new w,r.listOfNavigatePages=[],r.flag=!0,r.columnRanges=[],r.currentLocation=new b(0,0),r.breakRow=!0,r.slr=null,r.remainderText=null,r.isPaginate=!1,r.isOverloadWithPosition=!1,r}return ve(e,i),Object.defineProperty(e.prototype,"Grid",{get:function(){return this.elements},enumerable:!0,configurable:!0}),e.prototype.getFormat=function(t){return t},e.prototype.layoutInternal=function(t){var o,r=this.getFormat(t.format);if(this.gridLayoutFormat=this.getFormat(t.format),this.currentPage=t.page,null===this.currentPage)throw Error("Can not set page as null");if(this.currentPage.getClientSize(),this.currentPage.getClientSize(),this.currentPageBounds=this.currentPage.getClientSize(),this.currentGraphics=this.currentPage.graphics,o=this.currentGraphics.page.section.indexOf(this.currentGraphics.page),this.listOfNavigatePages.push(o),this.currentBounds=new w(new b(t.bounds.x,t.bounds.y),null!=r&&r.break===xe.FitColumnsToPage?new S(this.Grid.columns.width,this.currentGraphics.clientSize.height):this.currentGraphics.clientSize),0!==this.Grid.rows.count)this.currentBounds.width=t.bounds.width>0?t.bounds.width:this.currentBounds.width-this.Grid.rows.getRow(0).cells.getCell(0).style.borders.left.width/2;else{if(0===this.Grid.headers.count)throw Error("Please add row or header into grid");this.currentBounds.width=t.bounds.width}if(this.startLocation=new b(t.bounds.x,t.bounds.y),t.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=t.bounds.height),this.Grid.isChildGrid||(this.hType=this.Grid.style.horizontalOverflowType),this.Grid.style.allowHorizontalOverflow?(this.Grid.measureColumnsWidth(),this.determineColumnDrawRanges()):(this.columnRanges=[],this.Grid.measureColumnsWidth(void 0!==this.Grid.isChildGrid?this.currentBounds:new w(this.currentBounds.x,this.currentBounds.y,this.currentBounds.x+this.currentBounds.width,this.currentBounds.height)),this.columnRanges.push([0,this.Grid.columns.count-1])),this.Grid.hasRowSpanSpan)for(var a=0;a<this.Grid.rows.count;a++)-1!==this.Grid.rows.getRow(a).height&&!this.Grid.rows.getRow(a).isRowHeightSet&&(this.Grid.rows.getRow(a).isRowHeightSet=!0);return this.layoutOnPage(t)},e.prototype.determineColumnDrawRanges=function(){for(var t=0,r=0,n=0,s=this.currentGraphics.clientSize.width-this.currentBounds.x,o=0;o<this.Grid.columns.count;o++)if((n+=this.Grid.columns.getColumn(o).width)>=s){for(var a=0,h=t;h<=o&&!((a+=this.Grid.columns.getColumn(h).width)>s);h++)r=h;this.columnRanges.push([t,r]),n=(r=t=r+1)<=o?this.Grid.columns.getColumn(o).width:0}this.columnRanges.push([t,this.Grid.columns.count-1])},e.prototype.layoutOnPage=function(t){this.pageBounds.x=t.bounds.x,this.pageBounds.y=t.bounds.y,this.pageBounds.height=t.bounds.height;for(var s,r=this.getFormat(t.format),o=new Ue,a=t.page,l=[],c=0;c<this.columnRanges.length;c++){var f=this.columnRanges[c];this.cellStartIndex=f[0],this.cellEndIndex=f[1];var d=this.raiseBeforePageLayout(this.currentPage,this.currentBounds,this.currentRowIndex);this.currentBounds=d.currentBounds,this.currentRowIndex=d.currentRowIndex;for(var p=void 0,v=0;v<this.Grid.headers.count;v++){var y=this.Grid.headers.getHeader(v),P=this.currentBounds.y;if(this.isHeader=!0,a!=this.currentPage)for(var V=this.cellStartIndex;V<=this.cellEndIndex;V++)y.cells.getCell(V).isCellMergeContinue&&(y.cells.getCell(V).isCellMergeContinue=!1,y.cells.getCell(V).value="");var R=this.drawRow(y);P===this.currentBounds.y?(p=!0,-1===e.repeatRowIndex&&(e.repeatRowIndex=v)):p=!1,!R.isFinish&&null!==a&&r.layout!==fe.OnePage&&p&&(this.startLocation.x=this.currentBounds.x,this.currentPage=this.getNextPageformat(r),this.startLocation.y=this.currentBounds.y,void 0!==r.paginateBounds&&0===r.paginateBounds.x&&0===r.paginateBounds.y&&0===r.paginateBounds.width&&0===r.paginateBounds.height&&(this.currentBounds.x+=this.startLocation.x),this.drawRow(y)),this.isHeader=!1}var C=0,T=void 0,A=!0;l=[];for(var z=0;z<this.Grid.rows.count;z++){y=this.Grid.rows.getRow(z),C++,this.currentRowIndex=C-1;var se=this.currentBounds.y;a=this.currentPage,e.repeatRowIndex=-1,A&&y.grid.isChildGrid&&(A=!1);var Re=null;if(-1==this.Grid.splitChildRowIndex)Re=this.drawRow(y),y.isrowFinish=!0;else{if(!(y.grid.ParentCell.row.grid.isGridSplit&&this.Grid.splitChildRowIndex<=y.rowIndex)){if(y.isrowFinish)continue;break}Re=this.drawRow(y),y.isrowFinish=!0}for(l.push(Re.bounds.width),se===this.currentBounds.y?(T=!0,e.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(y)):(T=!1,e.repeatRowIndex=-1);!Re.isFinish&&null!=a;){var qn=this.getLayoutResult();if(this.raisePageLayouted(qn).cancel||T)break;if(this.Grid.allowRowBreakAcrossPages){this.currentPage=this.getNextPageformat(r),se=this.currentBounds.y;var wi=new b(ne.default.right.width/2,ne.default.top.width/2);if(0===r.paginateBounds.x&&0===r.paginateBounds.y&&0===r.paginateBounds.width&&0===r.paginateBounds.height&&this.startLocation.x===wi.x&&this.startLocation.y===wi.y&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y),this.isPaginate&&(this.startLocation.y=this.currentBounds.y,this.isPaginate=!1),this.Grid.isChildGrid&&null!=y.grid.ParentCell&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&y.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top<this.currentBounds.height&&(this.currentBounds.y=this.Grid.ParentCell.row.grid.style.cellPadding.top),null!=y.grid.ParentCell){y.grid.ParentCell.row.isRowBreaksNextPage=!0,y.grid.ParentCell.row.rowBreakHeightValue=y.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top+this.Grid.ParentCell.row.grid.style.cellPadding.bottom;for(var kt=y.rowIndex+1;kt<y.grid.rows.count;kt++)y.grid.ParentCell.row.rowBreakHeightValue+=y.grid.rows.getRow(kt).height}if(y.grid.isChildGrid){y.isrowFinish=!1,y.grid.splitChildRowIndex=y.rowIndex,y.grid.ParentCell.row.grid.splitChildRowIndex=y.grid.ParentCell.row.rowIndex,y.grid.ParentCell.row.grid.isGridSplit&&(y.grid.ParentCell.row.noOfPageCount+=1,y.grid.ParentCell.row.grid.isGridSplit=!1);break}if(y.noOfPageCount<1){if(-1!=y.grid.splitChildRowIndex&&(y.grid.isGridSplit=!0),null!=y.style.border&&(null!=y.style.border.left&&1!==y.style.border.left.width||null!=y.style.border.top&&1!==y.style.border.top.width)&&this.currentBounds.x===ne.default.right.width/2&&this.currentBounds.y===ne.default.right.width/2){var $n=new w(y.style.border.left.width/2,y.style.border.top.width/2,this.currentBounds.width,this.currentBounds.height);this.currentBounds=$n}if(this.Grid.repeatHeader)for(var Ft=0;Ft<this.Grid.headers.count;Ft++){var Xn=this.Grid.headers.getHeader(Ft);this.drawRow(Xn)}if(Re=this.drawRow(y),y.noOfPageCount>=1)for(var Si=0;Si<y.noOfPageCount;Si++){var Zn=this.getLayoutResult();if(this.raisePageLayouted(Zn),this.currentPage=this.getNextPageformat(r),se=this.currentBounds.y,-1!=y.grid.splitChildRowIndex&&(y.grid.isGridSplit=!0),this.currentBounds.y=.5,this.Grid.repeatHeader)for(var jt=0;jt<this.Grid.headers.count;jt++){var Et=this.Grid.headers.getHeader(jt);this.drawRow(Et)}this.drawRow(y)}y.grid.splitChildRowIndex=-1,y.grid.isGridSplit=!1,Re.isFinish=this.checkIsFisished(y);for(var pt=0;pt<y.cells.count;pt++)y.cells.getCell(pt).value instanceof Q&&(y.cells.getCell(pt).value.splitChildRowIndex=-1)}}}if(!Re.isFinish&&null!==a&&r.layout!==fe.OnePage&&T){if(this.startLocation.x=this.currentBounds.x,this.currentPage=this.getNextPageformat(r),this.raiseBeforePageLayout(this.currentPage,this.currentBounds,this.currentRowIndex).returnValue)break;if(null!==t.format&&!t.format.usePaginateBounds&&null!==t.bounds&&t.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=t.bounds.height),void 0===t.format||null==t.format||void 0===t.format.usePaginateBounds||t.format.usePaginateBounds||0===t.format.paginateBounds.x&&0===t.format.paginateBounds.y&&0===t.format.paginateBounds.width&&0===t.format.paginateBounds.height||0!==t.format.paginateBounds.y?(this.currentBounds.y=null==r?0:r.paginateBounds.y,null!=r&&(0!==r.paginateBounds.x||0!==r.paginateBounds.y||0!==r.paginateBounds.height||0!==r.paginateBounds.width)&&(this.currentBounds.x=r.paginateBounds.x,this.currentBounds.width=r.paginateBounds.width,this.currentBounds.height=r.paginateBounds.height)):this.currentBounds.y=ne.default.top.width/2,null!=t.format&&void 0!==t.format.usePaginateBounds&&!t.format.usePaginateBounds&&null!==t.bounds&&t.bounds.y>0&&!this.Grid.isChildGrid&&(this.currentBounds.y=t.bounds.y),this.startLocation.y=this.currentBounds.y,r.paginateBounds.x===r.paginateBounds.y&&r.paginateBounds.y===r.paginateBounds.height&&r.paginateBounds.height===r.paginateBounds.width&&0===r.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x),this.currentBounds.x===ne.default.left.width/2&&(this.currentBounds.y+=this.startLocation.x),this.Grid.repeatHeader)for(var Tt=0;Tt<this.Grid.headers.count;Tt++)Et=this.Grid.headers.getHeader(Tt),this.drawRow(Et);this.drawRow(y),null!==this.currentPage&&!o.containsKey(this.currentPage)&&o.add(this.currentPage,f)}if(null!=y.NestedGridLayoutResult){this.currentPage=y.NestedGridLayoutResult.page,this.currentGraphics=this.currentPage.graphics,this.startLocation=new b(y.NestedGridLayoutResult.bounds.x,y.NestedGridLayoutResult.bounds.y);var Qn=this.ReCalculateHeight(y,y.NestedGridLayoutResult.bounds.height);if(this.currentBounds.y=Qn,a!=this.currentPage){for(var Pi=this.currentPage.section,Kn=Pi.indexOf(a)+1,Bi=Pi.indexOf(this.currentPage),Rt=Kn;Rt<Bi+1;Rt++){var Ci=this.currentPage.graphics,gt=new b(r.paginateBounds.x,r.paginateBounds.y),Nt=Rt==Bi?y.NestedGridLayoutResult.bounds.height-t.bounds.y:this.currentBounds.height-gt.y;Nt<=Ci.clientSize.height&&(Nt+=t.bounds.y),gt.y=null==r?.5:r.paginateBounds.y;for(var K=0;K<y.cells.count;K++){var At,Ge=y.cells.getCell(K),Dt=0;if(Ge.value instanceof Q)for(var Mt=0;Mt<Ge.value.columns.count;Mt++)Dt+=Ge.value.columns.getColumn(Mt).columnWidth;else Dt=Ge.width;At=Math.max(Dt,y.grid.columns.getColumn(K).width),Ge.drawCellBorders(Ci,new w(gt,new S(At,Nt))),gt.x+=At,K+=Ge.columnSpan-1}}a=this.currentPage}}}var Oi=!1,yt=0;l.length>0&&(yt=l[0]);var xi=[[1,2]];for(K=0;K<this.Grid.rows.count;K++)if(-1!=this.cellEndIndex&&this.Grid.rows.getRow(K).cells.getCell(this.cellEndIndex).value instanceof Q){var es=this.Grid.rows.getRow(K).cells.getCell(this.cellEndIndex).value;this.rowLayoutBoundsWidth=es.rowLayoutBoundsWidth,Oi=!0}if(!Oi&&l.length>0){for(K=0;K<C-1;K++)yt<l[K]&&(yt=l[K]);this.rowLayoutBoundsWidth=yt}else this.rowLayoutBoundsWidth=xi[0][1];this.columnRanges.indexOf(f)<this.columnRanges.length-1&&null!=a&&r.layout!=fe.OnePage&&(0!=xi[0][0]?(this.currentPage.section.indexOf(this.currentPage),this.currentGraphics=this.currentPage.graphics,this.currentBounds=new w(new b(0,0),this.currentPage.getClientSize()),this.currentGraphics.page.section.indexOf(this.currentGraphics.page)):this.currentPage=this.getNextPageformat(r)),this.columnRanges.length-1!==c&&this.columnRanges.length>1&&r.layout!==fe.OnePage&&(this.currentPage=this.getNextPageformat(r),r.paginateBounds.x===r.paginateBounds.y&&r.paginateBounds.y===r.paginateBounds.height&&r.paginateBounds.height===r.paginateBounds.width&&0===r.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y))}return s=this.getLayoutResult(),this.Grid.style.allowHorizontalOverflow&&this.Grid.style.horizontalOverflowType==rt.NextPage&&this.reArrangePages(o),this.raisePageLayouted(s),s},e.prototype.checkIsFisished=function(t){for(var r=!0,n=0;n<t.cells.count;n++)t.cells.getCell(n).FinishedDrawingCell||(r=!1);return r},e.prototype.getNextPageformat=function(t){var r=this.currentPage.section,n=null,s=r.indexOf(this.currentPage);this.flag=!1,n=s===r.count-1?r.add():r.getPages()[s+1],this.currentGraphics=n.graphics;var o=this.currentGraphics.page.section.indexOf(this.currentGraphics.page);return-1===this.listOfNavigatePages.indexOf(o)&&this.listOfNavigatePages.push(o),this.currentBounds=new w(new b(0,0),n.getClientSize()),void 0!==t&&null!=t&&t.usePaginateBounds&&void 0!==t.paginateBounds&&null!=t.paginateBounds&&t.paginateBounds.x!==t.paginateBounds.y&&t.paginateBounds.y!==t.paginateBounds.height&&t.paginateBounds.height!==t.paginateBounds.width&&0!==t.paginateBounds.width&&(this.currentBounds.x=t.paginateBounds.x,this.currentBounds.y=t.paginateBounds.y,this.currentBounds.height=t.paginateBounds.height),n},e.prototype.CheckIfDefaultFormat=function(t){var r=new ye;return t.alignment===r.alignment&&t.characterSpacing===r.characterSpacing&&t.clipPath===r.clipPath&&t.firstLineIndent===r.firstLineIndent&&t.horizontalScalingFactor===r.horizontalScalingFactor&&t.lineAlignment===r.lineAlignment&&t.lineLimit===r.lineLimit&&t.lineSpacing===r.lineSpacing&&t.measureTrailingSpaces===r.measureTrailingSpaces&&t.noClip===r.noClip&&t.paragraphIndent===r.paragraphIndent&&t.rightToLeft===r.rightToLeft&&t.subSuperScript===r.subSuperScript&&t.wordSpacing===r.wordSpacing&&t.wordWrap===r.wordWrap},e.prototype.RaiseBeforeCellDraw=function(t,r,n,s,o,a){var h=null;return this.Grid.raiseBeginCellDraw&&(h=new On(t,r,n,s,o,a),this.Grid.onBeginCellDraw(h),a=h.style),a},e.prototype.raiseAfterCellDraw=function(t,r,n,s,o,a){var h=null;this.Grid.raiseEndCellDraw&&(h=new xn(t,r,n,s,o,a),this.Grid.onEndCellDraw(h))},e.prototype.reArrangePages=function(t){for(var r=this.currentPage.document,n=[],s=t.keys(),a=(t.values(),0);a<s.length;a++)(h=s[a]).section=null,n.push(h),r.pages.remove(h);for(a=0;a<t.size();a++)for(var l=a,c=t.size()/this.columnRanges.length;l<t.size();l+=c){var h;void 0!==(h=n[l])&&-1===r.pages.indexOf(h)&&r.pages.add(h)}},e.prototype.getLayoutResult=function(){if(this.Grid.isChildGrid&&this.Grid.allowRowBreakAcrossPages)for(var t=0;t<this.Grid.rows.count;t++){var r=this.Grid.rows.getRow(t);r.rowBreakHeight>0&&r.repeatFlag&&(this.startLocation.y=this.currentPage.origin.y)}var n;return this.isChanged||(n=new w(this.startLocation,new S(this.currentBounds.width,this.currentBounds.y-this.startLocation.y))),new Bn(this.currentPage,n)},e.prototype.ReCalculateHeight=function(t,r){for(var n=0,s=this.cellStartIndex;s<=this.cellEndIndex;s++)null===t.cells.getCell(s).remainingString||""===t.cells.getCell(s).remainingString||void 0===t.cells.getCell(s).remainingString||(n=Math.max(n,t.cells.getCell(s).measureHeight()));return Math.max(r,n)},e.prototype.raiseBeforePageLayout=function(t,r,n){var s=!1;if(this.Grid.raiseBeginPageLayout){var o=new Ln(r,t,n);this.Grid.onBeginPageLayout(o),s=void 0!==o.cancel&&o.cancel,r=o.bounds,n=o.startRowIndex}return{returnValue:s,currentBounds:r,currentRowIndex:n}},e.prototype.raisePageLayouted=function(t){var r=new Vn(t);return this.Grid.raiseEndPageLayout&&this.Grid.onEndPageLayout(r),r},e.prototype.drawRow=function(t,r,n){if(void 0===r){var s=new kn,o=0,a=new S(0,0),h=!1;if(t.rowSpanExists){var l=0,c=this.Grid.rows.rowCollection.indexOf(t);-1===c&&-1!==(c=this.Grid.headers.indexOf(t))&&(h=!0);for(var f=0;f<t.cells.count;f++){var d=t.cells.getCell(f);l=Math.max(l,d.rowSpan)}for(f=c;f<c+l;f++)o+=h?this.Grid.headers.getHeader(f).height:this.Grid.rows.getRow(f).height}var p=t.rowBreakHeight>0?t.rowBreakHeight:t.height;if(void 0!==this.Grid.isChildGrid&&this.Grid.isChildGrid&&void 0!==this.Grid.ParentCell&&null!=this.Grid.ParentCell)this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+p>this.currentPageBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+p>this.currentBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+o>this.currentPageBounds.height?(void 0!==this.Grid.ParentCell.row.grid.LayoutFormat&&this.Grid.ParentCell.row.grid.LayoutFormat.break===xe.FitPage&&(e.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(t),this.Grid.splitChildRowIndex=this.Grid.rows.rowCollection.indexOf(t)),e.repeatRowIndex>-1&&e.repeatRowIndex===t.rowIndex&&this.Grid.allowRowBreakAcrossPages&&(s.isFinish=!0,s.bounds=this.currentBounds,this.drawRowWithBreak(s,t,p),t.repeatFlag=!0,t.repeatRowNumber=e.repeatRowIndex)):(s.isFinish=!0,t.grid.ParentCell.row.rowBreakHeightValue>0?t.repeatFlag=!0:(t.repeatFlag=!1,p=t.height),this.Grid.isChildGrid&&t.rowBreakHeight>0&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&(p+=this.Grid.ParentCell.row.grid.style.cellPadding.bottom),this.drawRow(t,s,p));else if(p>this.currentPageBounds.height)this.Grid.allowRowBreakAcrossPages&&(s.isFinish=!0,this.drawRowWithBreak(s,t,p),t.isrowFinish=!0,t.repeatFlag=!0,-1!==t.grid.splitChildRowIndex&&(s.isFinish=!1));else if(this.currentBounds.y+p>this.currentPageBounds.height||this.currentBounds.y+p>this.currentBounds.height+this.startLocation.y||this.currentBounds.y+o>this.currentPageBounds.height){var v=!1;!this.Grid.allowRowBreakAcrossPages||this.Grid.repeatHeader||t.isRowHeightSet||t.rowMergeComplete?this.Grid.allowRowBreakAcrossPages&&null!=this.Grid.LayoutFormat&&this.Grid.LayoutFormat.layout==fe.Paginate&&this.Grid.LayoutFormat.break!=xe.FitElement&&t.isRowHeightSet&&this.currentBounds.y+n>this.currentPageBounds.height&&((v=this.isFitToCell(this.currentPageBounds.height-this.currentBounds.y,this.Grid,t))||(v=!(null!==this.slr&&0==this.slr.actualSize.height&&null!=this.slr.remainder&&this.slr.remainder.length>0&&this.remainderText==this.slr.remainder)),v&&null!=this.slr&&this.slr.lineCount>1&&(v=!1),this.remainderText=null):(v=this.isFitToCell(null!==this.Grid.LayoutFormat&&this.Grid.LayoutFormat.paginateBounds.height>0?this.currentBounds.height+this.startLocation.y-this.currentBounds.y:this.currentPageBounds.height-this.currentBounds.y,this.Grid,t))&&(this.isPaginate=!0),e.repeatRowIndex>-1&&e.repeatRowIndex===t.rowIndex||v?this.Grid.allowRowBreakAcrossPages?(s.isFinish=!0,this.drawRowWithBreak(s,t,p),t.repeatFlag=!0,t.repeatRowNumber=e.repeatRowIndex,-1!==t.grid.splitChildRowIndex&&(s.isFinish=!1)):(s.isFinish=!1,this.drawRow(t,s,p)):s.isFinish=!1}else s.isFinish=!0,this.drawRow(t,s,p),t.repeatFlag=!1;return s}var P=new b(this.currentBounds.x,this.currentBounds.y);for(r.bounds=new w(P,new S(0,0)),n=this.ReCalculateHeight(t,n),f=this.cellStartIndex;f<=this.cellEndIndex;f++){var V=f>this.cellEndIndex+1&&t.cells.getCell(f).columnSpan>1;if(!V)for(var R=1;R<t.cells.getCell(f).columnSpan;R++)t.cells.getCell(f+R).isCellMergeContinue=!0;a=new S(this.Grid.columns.getColumn(f).width,n),!this.CheckIfDefaultFormat(this.Grid.columns.getColumn(f).format)&&this.CheckIfDefaultFormat(t.cells.getCell(f).stringFormat)&&(t.cells.getCell(f).stringFormat=this.Grid.columns.getColumn(f).format);var C=t.cells.getCell(f).style,H="string"==typeof t.cells.getCell(f).value&&null!==t.cells.getCell(f).value?t.cells.getCell(f).value:"";t.cells.getCell(f).style=this.RaiseBeforeCellDraw(this.currentGraphics,this.currentRowIndex,f,new w(P,a),H,C),t.cells.getCell(f).value instanceof Q&&((T=t.cells.getCell(f).value).parentCellIndex=f);var A=t.cells.getCell(f).draw(this.currentGraphics,new w(P,a),V);if(t.grid.style.allowHorizontalOverflow&&(t.cells.getCell(f).columnSpan>this.cellEndIndex||f+t.cells.getCell(f).columnSpan>this.cellEndIndex+1)&&this.cellEndIndex<t.cells.count-1&&(t.rowOverflowIndex=this.cellEndIndex),t.grid.style.allowHorizontalOverflow&&t.rowOverflowIndex>0&&(t.cells.getCell(f).columnSpan>this.cellEndIndex||f+t.cells.getCell(f).columnSpan>this.cellEndIndex+1)&&t.cells.getCell(f).columnSpan-this.cellEndIndex+f-1>0&&(t.cells.getCell(t.rowOverflowIndex+1).value=null!==A&&void 0!==A.remainder?A.remainder:"",t.cells.getCell(t.rowOverflowIndex+1).stringFormat=t.cells.getCell(f).stringFormat,t.cells.getCell(t.rowOverflowIndex+1).style=t.cells.getCell(f).style,t.cells.getCell(t.rowOverflowIndex+1).columnSpan=t.cells.getCell(f).columnSpan-this.cellEndIndex+f-1),H="string"==typeof t.cells.getCell(f).value&&null!==t.cells.getCell(f).value?t.cells.getCell(f).value:"",V||this.raiseAfterCellDraw(this.currentGraphics,this.currentRowIndex,f,new w(P,a),H,t.cells.getCell(f).style),t.cells.getCell(f).value instanceof Q){var T=t.cells.getCell(f).value;this.Grid.columns.getColumn(f).width>=this.currentGraphics.clientSize.width?(P.x=T.rowLayoutBoundsWidth,P.x+=T.style.cellSpacing):P.x+=this.Grid.columns.getColumn(f).width}else P.x+=this.Grid.columns.getColumn(f).width}(!t.rowMergeComplete||t.isRowHeightSet)&&(this.currentBounds.y+=n),r.bounds=new w(new b(r.bounds.x,r.bounds.y),new S(P.x,P.y))},e.prototype.isFitToCell=function(t,r,n){for(var s=!1,o=new me,a=0;a<n.cells.count;a++){var h=n.cells.getCell(a);if(null!=h.value&&"string"==typeof h.value){var l;l=void 0!==h.style.font&&null!=h.style.font?h.style.font:void 0!==h.row.style.font&&null!=h.row.style.font?h.row.style.font:void 0!==h.row.grid.style.font&&null!=h.row.grid.style.font?h.row.grid.style.font:Ve.defaultFont,this.remainderText=n.cells.getCell(a).value;var c=n.cells.getCell(a).width;r.columns.getColumn(a).isCustomWidth&&n.cells.getCell(a).width>r.columns.getColumn(a).width&&(c=r.columns.getColumn(a).width),this.slr=o.layout(n.cells.getCell(a).value,l,n.cells.getCell(a).stringFormat,new S(c,t),!1,this.currentPageBounds);var f=this.slr.actualSize.height;if(0==f){s=!1;break}if(null!=n.cells.getCell(a).style&&null!=n.cells.getCell(a).style.borders&&null!=n.cells.getCell(a).style.borders.top&&null!=n.cells.getCell(a).style.borders.bottom&&(f+=2*(n.cells.getCell(a).style.borders.top.width+n.cells.getCell(a).style.borders.bottom.width)),this.slr.lineCount>1&&null!=n.cells.getCell(a).stringFormat&&0!=n.cells.getCell(a).stringFormat.lineSpacing&&(f+=(this.slr.lineCount-1)*n.cells.getCell(a).style.stringFormat.lineSpacing),n.cells.getCell(a),f+=r.style.cellPadding.top+r.style.cellPadding.bottom,t>(f+=r.style.cellSpacing)||null!=this.slr.remainder){s=!0;break}}}return s},e.prototype.drawRowWithBreak=function(t,r,n){var s=new b(this.currentBounds.x,this.currentBounds.y);r.grid.isChildGrid&&r.grid.allowRowBreakAcrossPages&&this.startLocation.x!==this.currentBounds.x&&(s.x=this.startLocation.x),t.bounds=new w(s,new S(0,0)),this.gridHeight=r.rowBreakHeight>0?this.currentPageBounds.height:0,r.grid.style.cellPadding.top+this.currentBounds.y+r.grid.style.cellPadding.bottom<this.currentPageBounds.height&&(r.rowBreakHeight=this.currentBounds.y+n-this.currentPageBounds.height);for(var o=0;o<r.cells.count;o++){var a=r.cells.getCell(o);a.measureHeight()===n&&a.value instanceof Q&&(r.rowBreakHeight=0)}for(o=this.cellStartIndex;o<=this.cellEndIndex;o++){var l=r.cells.getCell(o).columnSpan+o>this.cellEndIndex+1&&r.cells.getCell(o).columnSpan>1,c=new S(this.Grid.columns.getColumn(o).width,this.gridHeight>0?this.gridHeight:this.currentPageBounds.height),f=r.cells.getCell(o).style;r.cells.getCell(o).style=f;var p;if(p=r.cells.getCell(o).draw(this.currentGraphics,new w(s,c),l),r.rowBreakHeight>0&&null!=p&&void 0!==p.remainder&&(r.cells.getCell(o).FinishedDrawingCell=!1,r.cells.getCell(o).remainingString=null==p.remainder?" ":p.remainder,r.rowBreakHeight=n-p.actualSize.height),t.isFinish=t.isFinish?r.cells.getCell(o).FinishedDrawingCell:t.isFinish,r.cells.getCell(o).value instanceof Q){var v=r.cells.getCell(o).value;this.rowBreakPageHeightCellIndex=o,this.Grid.columns.getColumn(o).width>=this.currentGraphics.clientSize.width?(s.x=this.rowLayoutBoundsWidth,s.x+=v.style.cellSpacing):s.x+=this.Grid.columns.getColumn(o).width}else s.x+=this.Grid.columns.getColumn(o).width}this.currentBounds.y+=this.gridHeight>0?this.gridHeight:n,t.bounds=new w(new b(t.bounds.x,t.bounds.y),new S(s.x,s.y))},e.repeatRowIndex=-1,e}(xt),Bn=function(i){function e(t,r){return i.call(this,t,r)||this}return ve(e,i),e}(Lt),Cn=function(i){function e(t){return i.call(this,t)||this}return ve(e,i),e}(Z),pi=function(){function i(e,t,r,n,s){this.gridRowIndex=t,this.gridCellIndex=r,this.internalValue=s,this.gridBounds=n,this.pdfGraphics=e}return Object.defineProperty(i.prototype,"rowIndex",{get:function(){return this.gridRowIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellIndex",{get:function(){return this.gridCellIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.internalValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return this.gridBounds},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.pdfGraphics},enumerable:!0,configurable:!0}),i}(),On=function(i){function e(t,r,n,s,o,a){var h=i.call(this,t,r,n,s,o)||this;return h.style=a,h}return ve(e,i),Object.defineProperty(e.prototype,"skip",{get:function(){return this.bSkip},set:function(t){this.bSkip=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this.cellStyle},set:function(t){this.cellStyle=t},enumerable:!0,configurable:!0}),e}(pi),xn=function(i){function e(t,r,n,s,o,a){var h=i.call(this,t,r,n,s,o)||this;return h.cellStyle=a,h}return ve(e,i),Object.defineProperty(e.prototype,"style",{get:function(){return this.cellStyle},enumerable:!0,configurable:!0}),e}(pi),gi=function(){function i(){}return Object.defineProperty(i.prototype,"cancel",{get:function(){return this.isCancel},set:function(e){this.isCancel=e},enumerable:!0,configurable:!0}),i}(),yi=function(i){function e(t,r){var n=i.call(this)||this;return n.bounds=t,n.pdfPage=r,n}return ve(e,i),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.cellBounds},set:function(t){this.cellBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),e}(gi),mi=function(i){function e(t){var r=i.call(this)||this;return r.layoutResult=t,r}return ve(e,i),Object.defineProperty(e.prototype,"result",{get:function(){return this.layoutResult},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){return this.nextPdfPage},set:function(t){this.nextPdfPage=t},enumerable:!0,configurable:!0}),e}(gi),Ln=function(i){function e(t,r,n){var s=i.call(this,t,r)||this;return s.startRow=n,s}return ve(e,i),Object.defineProperty(e.prototype,"startRowIndex",{get:function(){return this.startRow},enumerable:!0,configurable:!0}),e}(yi),Vn=function(i){function e(t){return i.call(this,t)||this}return ve(e,i),e}(mi),kn=function(){function i(){this.layoutedBounds=new w(0,0,0,0)}return Object.defineProperty(i.prototype,"isFinish",{get:function(){return this.bIsFinished},set:function(e){this.bIsFinished=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return this.layoutedBounds},set:function(e){this.layoutedBounds=e},enumerable:!0,configurable:!0}),i}(),Wn=function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Hn=function(i){function e(t,r,n){var s=i.call(this,r)||this;return s.isEmbedFont=!1,s.isUnicode=!0,s.createFontInternal(t,void 0!==n?n:E.Regular),s}return Wn(e,i),e.prototype.equalsToFont=function(t){return!1},e.prototype.getLineWidth=function(t,r){var n=0;n=null!=r&&r.textDirection!==te.None?this.getUnicodeLineWidth(t,n,r).width:this.fontInternal.getLineWidth(t);var o=this.metrics.getSize(r);return this.applyFormatSettings(t,r,n*=re.charSizeMultiplier*o)},e.prototype.getCharWidth=function(t,r){return this.fontInternal.getCharWidth(t)*(.001*this.metrics.getSize(r))},e.prototype.createFontInternal=function(t,r){this.fontInternal=new Pt(t,this.size),this.calculateStyle(r),this.initializeInternals()},e.prototype.calculateStyle=function(t){var r=this.fontInternal.ttfMetrics.macStyle;0!=(t&E.Underline)&&(r|=E.Underline),0!=(t&E.Strikeout)&&(r|=E.Strikeout),this.setStyle(r)},e.prototype.initializeInternals=function(){var t=null;Ve.enableCache&&(t=Ve.cache.search(this));var r=null;if(null!=t){r=t.getInternals();var n=t.metrics;(n=n.clone()).size=this.size,this.metrics=n,this.fontInternal=t.fontInternal}else null==t&&(this.fontInternal instanceof Pt&&(this.fontInternal.isEmbed=this.isEmbedFont),this.fontInternal.createInternals(),r=this.fontInternal.getInternals(),this.metrics=this.fontInternal.metrics);this.metrics.isUnicodeFont=!0,this.setInternals(r)},e.prototype.setSymbols=function(t){var r=this.fontInternal;null!=r&&r.setSymbols(t)},Object.defineProperty(e.prototype,"Unicode",{get:function(){return this.isUnicode},enumerable:!0,configurable:!0}),e.prototype.getUnicodeLineWidth=function(t,r,n){r=0;var s=null,a=(new Zt).getGlyphIndex(t,this,n.textDirection===te.RightToLeft,s,!0),h=a.success;if(s=a.glyphs,h&&null!==s)for(var l=this.fontInternal.ttfReader,c=0,f=s.length;c<f;c++){var p=l.getGlyph(s[c]);null!=p&&(r+=p.width)}return{success:h,width:r}},e}(re),Un=function(){function i(e,t,r,n,s){e instanceof w&&void 0===t?this.InitiateBounds(e.x,e.y,e.width,e.height,null):e instanceof w&&t instanceof de&&void 0===r?this.InitiateBounds(e.x,e.y,e.width,e.height,t):e instanceof b&&t instanceof S&&void 0===r?this.InitiateBounds(e.x,e.y,t.width,t.height,null):e instanceof b&&t instanceof S&&r instanceof de&&void 0===n?this.InitiateBounds(e.x,e.y,t.width,t.height,r):e instanceof S&&void 0===t?this.InitiateBounds(0,0,e.width,e.height,null):"number"==typeof e&&"number"==typeof t&&void 0===r?this.InitiateBounds(0,0,e,t,null):"number"==typeof e&&"number"==typeof t&&r instanceof de&&void 0===n?this.InitiateBounds(0,0,e,t,r):this.InitiateBounds(e,t,r,n,null)}return Object.defineProperty(i.prototype,"dock",{get:function(){return this.dockStyle},set:function(e){this.dockStyle=e,this.resetAlignment()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alignment",{get:function(){return this.alignmentStyle},set:function(e){this.setAlignment(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"foreground",{get:function(){return this.isForeground},set:function(e){this.isForeground=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"background",{get:function(){return!this.isForeground},set:function(e){this.isForeground=!e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"location",{get:function(){return this.currentLocation},set:function(e){this.type===k.None&&(this.currentLocation=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return void 0!==this.currentLocation?this.currentLocation.x:0},set:function(e){this.type===k.None&&(this.currentLocation.x=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return void 0!==this.currentLocation?this.currentLocation.y:0},set:function(e){this.type===k.None&&(this.currentLocation.y=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.template.size},set:function(e){this.type===k.None&&this.template.reset(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.template.width},set:function(e){if(this.template.width!==e&&this.type===k.None){var t=this.template.size;t.width=e,this.template.reset(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.template.height},set:function(e){if(this.template.height!==e&&this.type===k.None){var t=this.template.size;t.height=e,this.template.reset(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.template.graphics},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"template",{get:function(){return this.pdfTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this.templateType},set:function(e){this.updateDocking(e),this.templateType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bounds",{get:function(){return new w(new b(this.x,this.y),this.size)},set:function(e){this.type===k.None&&(this.location=new b(e.x,e.y),this.size=new S(e.width,e.height))},enumerable:!0,configurable:!0}),i.prototype.InitiateBounds=function(e,t,r,n,s){this.x=e,this.y=t,this.pdfTemplate=new Xe(r,n)},i.prototype.updateDocking=function(e){if(e!==k.None){switch(e){case k.Top:this.dock=I.Top;break;case k.Bottom:this.dock=I.Bottom;break;case k.Left:this.dock=I.Left;break;case k.Right:this.dock=I.Right}this.resetAlignment()}},i.prototype.resetAlignment=function(){this.alignment=L.None},i.prototype.setAlignment=function(e){if(this.dock===I.None)this.alignmentStyle=e;else{var t=!1;switch(this.dock){case I.Left:t=e===L.TopLeft||e===L.MiddleLeft||e===L.BottomLeft||e===L.None;break;case I.Top:t=e===L.TopLeft||e===L.TopCenter||e===L.TopRight||e===L.None;break;case I.Right:t=e===L.TopRight||e===L.MiddleRight||e===L.BottomRight||e===L.None;break;case I.Bottom:t=e===L.BottomLeft||e===L.BottomCenter||e===L.BottomRight||e===L.None;break;case I.Fill:t=e===L.MiddleCenter||e===L.None}t&&(this.alignmentStyle=e)}},i.prototype.draw=function(e,t){var n=this.calculateBounds(e.page,t);-0===n.x&&(n.x=0),e.graphics.drawPdfTemplate(this.template,new b(n.x,n.y),new S(n.width,n.height))},i.prototype.calculateBounds=function(e,t){var r=this.bounds;return this.alignmentStyle!==L.None?r=this.getAlignmentBounds(e,t):this.dockStyle!==I.None&&(r=this.getDockBounds(e,t)),r},i.prototype.getAlignmentBounds=function(e,t){return this.type===k.None?this.getSimpleAlignmentBounds(e,t):this.getTemplateAlignmentBounds(e,t)},i.prototype.getSimpleAlignmentBounds=function(e,t){var r=this.bounds,s=e.section.getActualBounds(t,e,!1),o=this.x,a=this.y;switch(this.alignmentStyle){case L.TopLeft:o=0,a=0;break;case L.TopCenter:o=(s.width-this.width)/2,a=0;break;case L.TopRight:o=s.width-this.width,a=0;break;case L.MiddleLeft:o=0,a=(s.height-this.height)/2;break;case L.MiddleCenter:o=(s.width-this.width)/2,a=(s.height-this.height)/2;break;case L.MiddleRight:o=s.width-this.width,a=(s.height-this.height)/2;break;case L.BottomLeft:o=0,a=s.height-this.height;break;case L.BottomCenter:o=(s.width-this.width)/2,a=s.height-this.height;break;case L.BottomRight:o=s.width-this.width,a=s.height-this.height}return r.x=o,r.y=a,r},i.prototype.getTemplateAlignmentBounds=function(e,t){var r=this.bounds,n=e.section,s=n.getActualBounds(t,e,!1),o=this.x,a=this.y;switch(this.alignmentStyle){case L.TopLeft:this.type===k.Left?(o=-s.x,a=0):this.type===k.Top&&(o=-s.x,a=-s.y);break;case L.TopCenter:o=(s.width-this.width)/2,a=-s.y;break;case L.TopRight:this.type===k.Right?(o=s.width+n.getRightIndentWidth(t,e,!1)-this.width,a=0):this.type===k.Top&&(o=s.width+n.getRightIndentWidth(t,e,!1)-this.width,a=-s.y);break;case L.MiddleLeft:o=-s.x,a=(s.height-this.height)/2;break;case L.MiddleCenter:o=(s.width-this.width)/2,a=(s.height-this.height)/2;break;case L.MiddleRight:o=s.width+n.getRightIndentWidth(t,e,!1)-this.width,a=(s.height-this.height)/2;break;case L.BottomLeft:this.type===k.Left?(o=-s.x,a=s.height-this.height):this.type===k.Bottom&&(o=-s.x,a=s.height+n.getBottomIndentHeight(t,e,!1)-this.height);break;case L.BottomCenter:o=(s.width-this.width)/2,a=s.height+n.getBottomIndentHeight(t,e,!1)-this.height;break;case L.BottomRight:this.type===k.Right?(o=s.width+n.getRightIndentWidth(t,e,!1)-this.width,a=s.height-this.height):this.type===k.Bottom&&(o=s.width+n.getRightIndentWidth(t,e,!1)-this.width,a=s.height+n.getBottomIndentHeight(t,e,!1)-this.height)}return r.x=o,r.y=a,r},i.prototype.getDockBounds=function(e,t){return this.type===k.None?this.getSimpleDockBounds(e,t):this.getTemplateDockBounds(e,t)},i.prototype.getSimpleDockBounds=function(e,t){var s=e.section.getActualBounds(t,e,!1),o=this.x,a=this.y,h=this.width,l=this.height;switch(this.dockStyle){case I.Left:o=0,a=0,h=this.width,l=s.height;break;case I.Top:o=0,a=0,h=s.width,l=this.height;break;case I.Right:o=s.width-this.width,a=0,h=this.width,l=s.height;break;case I.Bottom:o=0,a=s.height-this.height,h=s.width,l=this.height;break;case I.Fill:o=0,o=0,h=s.width,l=s.height}return new w(o,a,h,l)},i.prototype.getTemplateDockBounds=function(e,t){var n=e.section,s=n.getActualBounds(t,e,!1),o=n.pageSettings.getActualSize(),a=this.x,h=this.y,l=this.width,c=this.height;switch(this.dockStyle){case I.Left:a=-s.x,h=0,l=this.width,c=s.height;break;case I.Top:a=-s.x,h=-s.y,l=o.width,c=this.height,s.height<0&&(h=-s.y+o.height);break;case I.Right:a=s.width+n.getRightIndentWidth(t,e,!1)-this.width,h=0,l=this.width,c=s.height;break;case I.Bottom:a=-s.x,h=s.height+n.getBottomIndentHeight(t,e,!1)-this.height,l=o.width,c=this.height,s.height<0&&(h-=o.height);break;case I.Fill:a=0,a=0,l=s.width,c=s.height}return new w(a,h,l,c)},i}()}}]);